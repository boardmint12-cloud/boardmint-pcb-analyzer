==========================================
FILE: 00924b.pdf
==========================================

                                                       Analog and Interface




Analog and Interface Guide – Volume 1
A Compilation of Technical Articles and Design Notes
Analog and Interface Guide – Volume 1
    Table of Contents




Contents
An Intuitive Approach To Mixed Signal Layout
    Part 1 – The Art Of Laying Out Two Layer Boards ....................................................................................1
    Part 2 – Could It Be Possible That Analog Layout Differs From Digital Layout Techniques? .........................5
    Part 3 – Where the Board and Component Parasitics Can Do The Most Damage.......................................8
    Part 4 – Layout Techniques To Use As The ADC Accuracy And Resolution Increases ................................11
    Part 5 – The Trouble With Troubleshooting Your Layout Without The Right Tools.......................................13
    Part 6 – Layout Tricks For A 12-Bit Sensing System ..............................................................................15
Miscellaneous
    Keeping Power Hungry Circuits Under Thermal Control ..........................................................................19
    Instrumentation Electronics At A Juncture ............................................................................................21
    Select The Right Operational Ampliﬁer For Your Filtering Circuits ............................................................23
    Ease Into The Flexible CANbus Network ...............................................................................................25




All articles presented here are authored by Bonnie C. Baker, Mixed Signal/Analog Applications Manager, Microchip Technology Inc.
                                                                                     Analog and Interface Guide – Volume 1
    An Intuitive Approach to Mixed Signal Layout – Part 1

The Art of Laying Out Two Layer Boards
In this highly competitive, battery-powered marketplace, cost
objective usually dictates that a designer uses two layer boards
in the design. Although the multi-layer board (4-, 6- and 8-layers)
allows the designer to build cleaner solutions in terms of size,
noise and performance, ﬁnancial pressures force the engineer to
rethink his layout strategies with the two-layer board in mind. In
this article we will discuss the use or misuse of auto routing, the
concept of current return paths with and without ground planes,
and recommendations for component placement where two layer
boards are concerned.
Pay Now Or Pay Later With The Auto
Router And Analog Circuits
It is tempting to use the auto router when designing a printed
circuit board (PCB). More often than not, a purely digital board,
(especially if the signals are relatively slow, and the circuit
density is low) will work just ﬁne. But as you try to lay out analog,
mixed signal or high-speed circuits with the auto routing tool that
is available with your layout software there may be some issues.
The probability of creating serious circuit performance problems
is very real.
                                                                        Figure 1: Top layer of an auto-routed layout of circuit diagram
For instance, the auto routed top layer of a two-layer board is         shown in Figure 3.
shown in Figure 1. The bottom layer of this board is in Figure 2,
and the circuit diagram for these layout layers is in Figure 3a and
Figure 3b. For the layout of this mixed-signal circuit, the devices
were manually placed on the board with careful thought to
separating the digital and analog devices.
With this layout there are several areas of concern, but the
most troubling issue is the grounding strategy. If the ground
traces are followed on the top layer, every device is connected
through traces on that layer. A second ground connection for
every device uses the bottom layer with vias at the far right-
hand side of the board. The immediate red ﬂag that one should
see when examining this layout strategy would be the existence
of several ground loops. Additionally, the ground return paths
on the bottom side are interrupted with horizontal signal lines.
The saving grace with this grounding scheme is that the analog
devices (MCP3202, 12-bit A/D converter and MCP4125, 2.5V
voltage reference) are at the far right hand side of the board. This
placement ensures that digital ground signals do not pass under
these analog chips.


                                                                        Figure 2: Bottom layer of an auto-routed layout of circuit
                                                                        diagram shown in Figure 3.




                                                                                                                                          1
Analog and Interface Guide – Volume 1
     An Intuitive Approach to Mixed Signal Layout – Part 1

The manual layout of the circuit shown, in Figure 3a and Figure
3b, is given in Figure 4 and Figure 5. With this manual layout, a
few general guidelines are followed to ensure positive results.
These guidelines are:
1. Use the ground plane as a current return path as much as
    possible.
2. Separate the analog ground plane from the digital ground
    plane with a break.
3. If interruptions from signal traces are required on the
    ground-plane side, make them vertical to reduce the
    interference with the ground current return paths.
4. Place analog circuitry at the far end of the board and digital
    circuitry closest to the power connects. This reduces the           Figure 3b: Analog section of circuit diagram for layouts in Figures
    effects of di/dt from digital switching.                            1, 2, 4 and 5. This is the circuit diagram from Microchip’s MXDEV®
                                                                        evaluation board for the 10- and 12-bit ADCs (MCP300X and
                                                                        MCP320X).

                                                                        Note that with both of these two layer boards there is a ground
                                                                        plane on the bottom. This is only done so that an engineer
                                                                        working on the board can quickly see the layout when trouble
                                                                        shooting. This strategy is typically found with a manufacturer’s
                                                                        demo and evaluation boards. But more typically, the ground
                                                                        plane is on the top of board, thereby reducing electromagnetic
                                                                        interference (EMI).




                                                                        Figure 4: Top layer of a manual routed layout of circuit diagram
                                                                        shown in Figure 3.




Figure 3a: Circuit diagram for layouts in Figures 1, 2, 4 and 5. This
is the circuit diagram from Microchip’s MXDEV® evaluation board
for the 10- and 12-bit ADCs (MCP300X and MCP320X).




 2
                                                                                   Analog and Interface Guide – Volume 1
    An Intuitive Approach to Mixed Signal Layout – Part 1




Figure 5: Bottom layer of a manual routed layout of circuit           Figure 6: If a ground plane is not feasible, current return paths
diagram shown in Figure 3.                                            can be handled with a “star” layout strategy.

Current Return Paths With Or Without A Ground Plane                   4. Digital currents should not pass across analog devices.
The fundamental issues that should be considered when dealing            During switching, digital currents in the return path are
with current return paths are:                                           fairly large, but only brieﬂy. This phenomenon occurs due
1. If traces are used, they should be as wide as possible. In            to the effective inductance and resistance of the ground.
    the event that you are considering using traces for your             With the inductance portion of the ground plane or trace,
    ground connects on your PCB, they should be designed to              the governing formula is V = Ldi/dt, where V is the resulting
    be as wide as possible. This is a good rule of thumb, but            voltage, L is the inductance of the ground plane or trace, di
    also understand that the thinnest width in your ground trace         is the change in current from the digital device and dt is the
    will be the effective width of the trace from that point to the      time span considered for the event. To calculate the effects
    end, where the “end” is deﬁned as the point furthest from the        of the resistance portion of the ground plane, changes in the
    power connection.                                                    voltage simply change because of V = RI, again where V is the
                                                                         resulting voltage, R is the ground plane or trace resistance
2. Ground loops should be avoided.                                       and I is the current change caused by the digital device. These
3. If no ground plane is available, star connection strategies           changes in the voltage of the ground plane or trace across the
    should be used.                                                      analog device will change the relationship between ground and
A graphical example of a star connection strategy is shown in            the signal in the signal chain.
Figure 6.                                                             5. High-speed current should not pass across lower speed
With this type of approach, the ground currents return to the            devices.
power connection independently. You will note that in Figure 6 all       Ground-return signals of high-speed circuits have a
of the devices do not have their own return path. With U1 and            similar effect on changes to the ground plane. Again the
U2, the return path is shared. This can be done if guidelines 4          more important formulas that determine the effects of
and 5 are used.                                                          this interference are V = Ldi/dt for the ground plane or
                                                                         trace inductance and V = RI for the ground plane or trace
                                                                         resistance. And as with digital currents, high-speed circuits
                                                                         that ground activity on the ground plane or that trace across
                                                                         the analog device change the relationship between ground
                                                                         and the signal in the signal chain.




                                                                                                                                          3
Analog and Interface Guide – Volume 1
     An Intuitive Approach to Mixed Signal Layout – Part 1

6. Regardless of the technique used, the ground return paths            Conclusion
    must be designed to have a minimum resistance and                   At every layout-related presentation that I give in a seminar
    inductance.                                                         setting, the question always asked in one form or another is,
7. If a ground plane is used, breaks in plane can improve or            “What if management tells me I can’t have two layers or a ground
    degrade circuit performance. Use with care.                         plane, and I still need to reduce noise in the circuit? How do I
A clean way of separating analog and digital ground planes is           design my circuit to work around the need for a ground plane?”
shown in Figure 7.                                                      Typically, I instruct the person asking the question to inform their
In Figure 7, the precision analog is closer to the connector,           management that a ground plane is simply required if they want
however it is isolated from the activity in the digital network as      reliable circuit performance. The primary reason for using ground
well as the switching currents from the power supply circuit.           planes is lower ground impedance. They also provide a degree of
This is a very effective way of keeping the ground return paths         EMI reduction.
separated. This technique was also used in the layout previously        But, if you are unable to win that battle because of cost
discussed in Figure 4 and 5.                                            constraints, this article offers some suggestions such as star
                                                                        networks and current return paths which if used properly will give
                                                                        a little relief with the circuit noise.




Figure 7: Sometimes a continuous ground plane is less effective than if the ground plane was separated. In this Figure (a) shows a less
desirable grounding layout strategy than is shown in (b).




 4
                                                                                  Analog and Interface Guide – Volume 1
    An Intuitive Approach to Mixed Signal Layout – Part 2

Could It Be Possible That Analog Layout Differs
From Digital Layout Techniques?
The increasing percentage of digital designers and digital layout    For digital devices, such as controllers and processors,
experts in the engineering population reflects the directions that   decoupling capacitors are required, but for a different reason.
our industry is headed. Although the emphasis on digital design      One of the functions of these capacitors serves as a “mini”
is providing significant advances in electronics end products,       charge reservoir. Frequently in digital circuits, a great deal of
there is still and will always be a portion of circuit design        current is required to execute the transitions of the changing
that interfaces with the analog or real world. There is some         gate states. Because of the switching transient currents that
similarity in layout strategies between these two domains, but       occur on the chip and throughout the circuit board, having
the differences can make an easy circuit layout design less than     additional charge “on call” is advantageous. The consequence
optimum when trying to achieve good results. In this article, we     of not having enough charge locally to execute this switching
will discuss the fundamental similarities and differences between    action could result in a significant change in the power supply
analog and digital layout with respect to bypass capacitors, power   voltage. When the voltage change is too large, it will cause the
supply and ground layout, voltage errors, and electromagnetic        digital signal level to go into the indeterminate state, more than
interference (EMI) due to PCB layout.                                likely resulting in erroneous operation of the state machines
                                                                     in the digital device. The switching current passing through the
The Similarities Of Analog And                                       circuit board traces would cause this change in voltage. The
Digital Layout Practices                                             circuit board traces have parasitic inductance, and the change in
Bypass Or Decoupling Capacitors                                      voltage results can be calculated using the formula:
In terms of layout, analog devices and digital devices all require   V = LdI/dt
these types of capacitors. In both cases, these devices require      Where: V = voltage change
a capacitor as close to the power supply pin(s) with a common                 L = board trace inductance
value for this capacitor of 0.1 micro-farads (μF). A second class             dI = change in current through the trace
of capacitor in the system is required at the power supply source.
The value of this capacitor is usually about 10 μF.                           dt = the time it takes for the current to change
The position of these capacitors is shown in Figure 1. The values    So for multiple reasons, it is a good idea to bypass (or decouple)
of these capacitors can vary by being ten times higher or lower,     the power supply at the power supply and at the power supply pin
but they are both required to have short leads and be as close       of active devices.
to the devices (in the case with the 0.1 μF capacitor) or power      The Power And Ground Should Be Routed Together
supply source (in the case with the 10 μF capacitor) as possible.    When power and ground traces are well matched with respect
Bypass or decoupling capacitors and their placement on the           to location, the opportunities for EMI is lessened. If power
board are just common sense for both types of designs, but           and ground are not matched, system loops are designed into
interesting enough, for different reasons. In the analog layout      the layout and the possibility of seeing “noisy” results without
design, bypass capacitors generally serve the purpose of             explanation is possible. An example of a PCB designed with the
redirecting high frequency signals on the power supply that would    power and ground traces not matched is shown in Figure 2.
otherwise enter into the sensitive analog chip through the power     The loop area that is designed into this board is 697cm2. The
supply pin. Generally speaking, these high frequency signals         opportunity for induced voltages in the loop because of radiated
occur at frequencies beyond the analog device’s capability to        noise off the board and in the board is decreased dramatically
reject those signals. The possible consequences of not using a       using the approach shown in Figure 3.
bypass capacitor in your analog circuit results in the addition of
undue noise to the signal path and worse yet, oscillation.




Figure 1: In analog and digital PCB design, the bypass or decouple
capacitors (1 μF) should be positioned as close to the device as     Figure 2: The power and ground traces are laid out using different
possible. The power supply decoupling capacitor (10 μF) should       routes to the device on this board. This mismatch opens the
be positioned where the power bus enters the board. In all cases,    opportunity for EMI into the electronics of this board.
these capacitors should have short leads.



                                                                                                                                     5
Analog and Interface Guide – Volume 1
     An Intuitive Approach to Mixed Signal Layout – Part 2

                                                                            Location of Components
                                                                            In every PCB design, the noisy and quiet portions of the circuit
                                                                            should be separated as mentioned above. Generally speaking,
                                                                            the digital circuitry is “rich” with noise and in turn less sensitive
                                                                            to this type of noise (because of the larger voltage noise
                                                                            margins). In contrast the voltage noise margins of the analog
                                                                            circuitry are much smaller. Of the two domains, the analog
                                                                            domain is most sensitive to switching noise. In the layout of a
                                                                            mixed signal system, the two domains should be separated. This
                                                                            is graphically shown in Figure 4.
                                                                            Parasitics Designed Into The PCB
                                                                            There are two fundamental parasitic components that can easily
                                                                            be designed into the PCB that might create problems; a capacitor
                                                                            and an inductor. A capacitor is designed into a board simply
                                                                            by placing two traces close to each other. This can be done by
                                                                            placing the two traces, one on top of the other with two layers or
Figure 3: In this one layer board, the power trace and ground trace         by placing them beside each other on the same layer, as shown
are laid next to each other on their way to the device on this board.       in Figure 5. In both trace configurations, changes in voltage with
This board is better matched than that shown in Figure 2. The               time (dV/dt) on one trace could generate a current on a second
opportunity for EMI into the electronics of this board is lessened by       trace. If the second trace is high impedance, the current that is
679/12.8 or ~54x.                                                           created by the e-field of this event will convert into a voltage.
                                                                            Fast voltage transients are most typically found on the digital
Where The Domains Differ                                                    side of the mixed signal design. If the traces that have these
Ground Planes Can Be A Problem                                              fast voltage transients are in close proximity of high impedance
The fundamentals of circuit board layout apply to analog circuits           analog traces, this type of error will be very disruptive with analog
as well as digital circuits. One fundamental rule of thumb is to            circuitry accuracy. Analog circuitry has two strikes against it in
use uninterrupted ground planes. This common practice reduces               this environment. The noise margins are much lower than digital
the effects of dI/dt (change in current with time) in digital               and it is not unusual to have high impedance traces.
circuits, which changes the potential of ground and noise being             This type of phenomena can be easily minimized using one of
injected into the analog circuits. But when comparing digital and           two techniques. The most commonly used technique is to change
analog circuits, the layout techniques are essentially the same             the dimensions between the traces as the capacitor equation
with one exception. The added precaution that should be taken               suggests. The most effect dimension to change is the distance
with analog circuits is to keep the digital signal lines and return         between the two offending traces. It should be noted that the
paths in the ground plane as far away from the analog circuitry             variable, “d”, is in the denominator of the capacitor equation. As
as possible. This can be done by connecting the analog ground               “d” is increased, the capacitance will decrease. Another variable
plane separately to the system ground connect or having the                 that can be changed is the length of the two traces. In this case,
analog circuitry at the farthest side of the board, i.e., at the end        if the length (“L”) is reduced the capacitance between the two
of the line. This is done in order to maintain signal paths that            traces will also be reduced.
have a minimal amount of interference from external sources.                Another technique used is the lay a ground trace between the
The opposite is not true for digital circuitry. The digital circuitry       two offending traces. Not only is the ground trace low impedance,
can tolerate a great deal of noise on the ground plane before               but an additional trace like this will break up the e-fields that are
problems start to appear.                                                   causing the disturbance shown in Figure 5.

                                    a) Separate the Digital and                           b) High Frequency Components
                                        Analog Portions of                                    Should be Placed Near
                                            the Circuit                                           the Connectors


                                                                           high
                                                                              frequency




                                                                           low


Figure 4: If possible, (a) the digital and analog portion of circuits should be separated in order to separate the digital switching activity from
the analog circuitry. Additionally, (b) the high frequency should be separated from the low frequency where possible, keeping the higher
frequency components closer to the board connector.

 6
                                                                                                         Analog and Interface Guide – Volume 1
    An Intuitive Approach to Mixed Signal Layout – Part 2

                                                                     w = thickness of PCB trace
                                                                     L = length of PCB trace
                                         w • L • eo • er             d = distance between the two PCB traces
                                   C =                     pF
                                               d                     eo = dielectric constant of air = 8.85 x 10-12 F/m
                                                                     er = dielectric constant of substrate coating relative to air

                                                                                              Guard Trace



                                    Voltage IN

                                                                                                                        Coupled
                                                                                                                        Current




                                                                I = C dV (amps)
                                                                      dt

Figure 5: Capacitors can easily be fabricated into a PCB by laying out two traces in close proximity. With this type of capacitor, fast voltage
changes on one trace can initiate a current signal in the other trace.

The way that an inductor is designed into a board is similar to
the construction of a capacitor. Again this is done by placing two                                                                                        Voltage
traces, one on top of the other with two layers or by placing them                          Current IN
beside each other on the same layer, as shown in Figure 6. In
                                                                                                                              L       M       L
both trace configurations, changes in current with time (dI/dt)
on one trace could generate a voltage in the same trace due to
the inductance on that trace and initiate a proportional current                                                             V = L    dl   (volts)
on the second trace due to the mutual inductance. If the voltage                                                                      dt
change is high enough on the primary trace, the disturbance can
reduce the voltage margin of the digital circuitry enough to cause                                                      L = x (0.01) In(1+2π h/w) uH/in

errors. This phenomena is not necessary reserved for digital                                                            M = x (0.01) In(1+2π h/w) uH/in

circuits, but more common in that environment because of the
larger, seemingly instantaneous switching currents.
                                                                                                         Signal Trace
To eliminate potential noise for EMI sources it is best to separate
quiet analog lines versus noisy I/O ports. Try to implement low
impedance power and ground networks, minimize inductance in                                      Current Return Path
conductors for digital circuits and minimize capacitive coupling in
analog circuits.
Conclusion
When the domains meet, careful layout is critical if a designer
intends to have a successful final PCB implementation. Layout                       Figure 6: If little attention is paid to the placement of traces, line
strategies usually are presented as rules of thumb because                          inductance and mutual inductance can be created with the traces
it is difficult to test the success of your final product in a lab                  in a PCB. This kind of parasitic element is most detrimental to the
environment. So, generally speaking, although there are some                        circuit operation where digital switching circuits reside.
similarity in layout strategies between the digital and analog
domain, the differences should be recognized and worked with.
In this article we briefly talked about bypass capacitors, power
supply and ground layout, voltage errors and EMI because of PCB
layout.
For more information refer to:
[1] Henry W. Ott, Noise Reduction Techniques in Electronic
    Systems, 2nd ed., Wiley, 1998
[2] Ralph Morrison, Noise and Other Interfering Signals, Wiley and
    Sons, 1992




                                                                                                                                                                    7
Analog and Interface Guide – Volume 1
     An Intuitive Approach to Mixed Signal Layout – Part 3

Where The Board And Component
Parasitics Can Do the Most Damage
The major classes of parasitics generated by the PC board                           To quickly explain the circuit operation in Figure 2, a 16-bit
layout come in the form of resistors, capacitors and inductors.                     DAC is built using three 8-bit digital potentiometers and three
For instance, PCB resistors are formed as a result of traces                        CMOS operational amplifiers. To the left side of this figure, two
from component to component. Unintentional capacitors can                           digital potentiometers (U3a and U3b) span across VDD to ground
be built into the board with traces, soldering pads and parallel                    with the wiper output connected to the non-inverting input of
traces. Circumstances that surround where inductors are built                       two amplifiers (U4a and U4b). The digital potentiometers, U2
come in the form of loop inductance, mutual inductance and                          and U3 are programmed using an SPI™ interface between
vias. All of these parasitics stand a chance of interfering with                    the microcontroller, U1. In this configuration, each digital
the effectiveness of your circuit as you transition from the circuit                potentiometer is configured to operate as an 8-bit multiplying
diagram to the actual PCB. This article quantifies the most                         DAC. If VDD is equal to 5V, the LSB size of these DACs is equal to
troublesome class of board parasitics, the board capacitor, and                     19.61 mV.
gives an example of where the effects on circuit performance can                    The wipers of each of these two digital potentiometers are
be clearly seen.                                                                    connected to the non-inverting inputs of two buffer configured
Feeling the Pain of Those Unnecessary Capacitors                                    operational amplifiers. In this configuration, the inputs to
                                                                                    the amplifiers are high impedance, which isolates the digital
In Part 2 of this series we discussed how capacitors could                          potentiometers from the rest of the circuit. These two amplifiers
inadvertently be built into your board. To quickly review this                      are also configured so that the output swing restrictions on the
concept, most layout capacitors are built by placing two parallel                   amplifiers in the second stage are not violated.
traces close together. The value of this type of capacitor can be
calculated using the formulas shown in Figure 1 (note that this                     To have this circuit perform as a 16-bit DAC (U2a), a third digital
figure is the same as Figure 5 in Part 2 of this series).                           potentiometer spans across the output of these two amplifiers,
                                                                                    U4a and U4b. The programmed setting of U3a and U3b sets the
This type of capacitor can cause problems in mixed signal                           voltage across the digital potentiometer. Again, if VDD is 5V
circuits where sensitive, high impedance analog traces are in                       it is possible to program the output of U3a and U3b 19.61 mV
close proximity to digital traces. For example, the circuit in                      apart. With this size of voltage across the third 8-bit digital
Figure 2 has the potential to have this type of problem.                            potentiometer, R3, the LSB size of this circuit from left to right is
                                                                                    76.3 mV. The critical device specifications that will give optimum
                                                                                    performance with this circuit are given in Table 1.

                                                                     w = thickness of PCB trace
                                                                     L = length of PCB trace
                                         w • L • eo • er             d = distance between the two PCB traces
                                   C =                     pF
                                               d                     eo = dielectric constant of air = 8.85 x 10-12 F/m
                                                                     er = dielectric constant of substrate coating relative to air

                                                                                              Guard Trace



                                    Voltage IN

                                                                                                                   Coupled
                                                                                                                   Current




                                                                I = C dV (amps)
                                                                      dt

Figure 1: Capacitors can easily be fabricated into a PCB by laying out two traces in close proximity. With this type of capacitor, fast voltage
changes on one trace can initiate a current signal in the other trace. (Also found in Part 2, Could It Be Possible That Analog Layout Differs
From Digital Layout Techniques, Figure 5.)




 8
                                                                                      Analog and Interface Guide – Volume 1
    An Intuitive Approach to Mixed Signal Layout – Part 3




Figure 2: A 16-bit DAC can be built using three 8-bit digital potentiometers and three amplifiers to provide 65,536 different output
voltages. If VDD is 5V in this system the resolution or LSB size of this DAC is 76.3 mV.

This circuit can be used in two basic modes of operation. The            The first pass layout of the circuit in Figure 2 is shown in Figure
first mode would be if you wanted a programmable, adjustable,            3. This circuit was quickly designed in our lab without attention
DC reference. In this mode the digital portion of the circuit is         to detail. The consequences of placing digital traces next to high
only used occasionally and certainly not during normal operation.        impedance analog lines were overlooked in the layout review.
The second mode would be if you used the circuit as an arbitrary         This speaks strongly to doing it right the first time, but to our
wave generator. In this mode, the digital portion of the circuit is      benefit this article will illustrate how to identify the problem and
an intimate part of the circuit operation. In this mode, the risk of     make significant improvements.
capacitive coupling may occur.

 Device                                       Specification                   Purpose
 Digital Potentiometers     Number of bits               8-bits               Determines the overall LSB size and resolution of the
 (MCP42010)                                                                   circuit.
                            Nominal resistance           10 kΩ (typ)          The lower this resistance is the lower the noise
                            (resistive element)                               contribution will be to the overall circuit. The trade off is
                                                                              that the current consumption of the circuit is high with
                                                                              these lower resistances.
                            DNL                          ± 1 LSB (max)        Good Differential Non-Linearity is needed to insure no
                                                                              missing codes occur in this circuit which allows for a
                                                                              possible 16-bit operation.
                            Voltage Noise Density        9 nV / √Hz           If the noise contribution of these devices is too high it
                            (for half of the resistive   @ 1 kHz (typ)        will take away from the ability to get 16-bit noise free
                            element)                                          performance. Selecting lower resistive elements can
                                                                              reduce the digital potentiometer noise.
 Operational Amplifiers     Input Bias Current, IB       1 pA @ 25°C (max)    Higher IB will cause a DC error across the potentiometer.
 (MCP6022)                                                                    CMOS amplifiers were chosen for this circuit for that
                                                                              reason.
                            Input Offset Voltage         500 mV (max)         A difference in amplifier offset error between A1 and A2
                                                                              could compromise the DNL of the overall system.
                            Voltage Noise Density        8.7 nV / √Hz         If the noise contribution of these devices is too high
                                                         @10 kHz (typ)        it will take away from the ability to get 16-bit accurate
                                                                              performance. Selecting lower noise amplifiers can reduce
                                                                              amplifier noise.
 Table 1: From the long list of specifications that each of the devices has, there are a handful of key specifications that make this
 circuit more successful when it is used to provide DC reference voltages or arbitrary wave forms.




                                                                                                                                              9
Analog and Interface Guide – Volume 1
      An Intuitive Approach to Mixed Signal Layout – Part 3

                                                                       What is the solution to this problem? Basically we separated the
                                                                       traces. Figure 5 shows an improved layout solution.
                                                                       The results of the layout change are shown in Figure 6. With
                                                                       the analog and digital traces carefully kept apart, this circuit
                                                                       becomes a very clean 16-bit DAC. A single code transition of the
                                                                       third digital potentiometer 76.29 mV is shown with the green
                                                                       trace. You may notice that the oscilloscope scale is
                                                                       80 mV/div and that the amplitude of this code change is shown
                                                                       to be approximately 80 mV. In the lab, we were forced by the
                                                                       equipment to gain the output of the 16-bit DAC by 1000x.




Figure 3: This is the first attempt at the layout for the circuit
in Figure 2. In this figure it can quickly be seen that a critical
high impedance analog line is very close to a digital trace. This
configuration produces inconsistent noise on the analog line
because the data input code on that particular digital trace
changes, dependent on the programming requirements for the
digital potentiometer.

Taking a look at the color-coding in this layout it is obvious where
a potential problem is. The analog trace (blue) that is pointed out
goes from the wiper of U3a to the high impedance amplifier input
of U4a. The digital trace (green) that is pointed out carries the      Figure 5: With this new layout the analog lines have been
digital word that programs the digital potentiometer settings.         separated from the digital lines. This distance has essentially
On the bench, it is found that the digital signal on the green trace   eliminated the digital noise that was causing interference in the
is coupled into the sensitive blue trace. This is illustrated in the   previous layout.
scope photo below (Figure 4).
The digital signal that is programming the digital potentiometers
in the system has transmitted from trace to trace onto an analog
line that is being held at a DC voltage. This noise propagates
through the analog portion of the circuit all the way out to the
third digital potentiometer (U5a). The third digital potentiometer
is toggling between two output states.




                                                                       Figure 6: The 16-bit DAC in this new layout is showing a single
                                                                       code transition with no digital noise from the communication to
                                                                       the digital potentiometers.

                                                                       Conclusion
                                                                       Once again, when the digital and analog domains meet, careful
Figure 4: In this scope photo, the top trace was taken at JP1          layout is critical if you intend to have a successful final PCB
(digital word to the digital potentiometers), the second trace on      implementation. In particular, active digital traces close to high
JP5 (noise on the adjacent analog trace) and the bottom yellow         impedance analog traces will cause serious coupling noise that
trace is taken at -TP10 (noise at the output of the 16-bit DAC).       can only be avoided with distance between traces.


 10
                                                                                        Analog and Interface Guide – Volume 1
     An Intuitive Approach to Mixed Signal Layout – Part 4

Layout Techniques To Use As The
ADC Accuracy and Resolution Increase
Initially, analog-to-digital (A/D) converters rose from an analog          These types of converters can have several pins for the ground
paradigm where a large percentage of the physical silicon was              and power connections. The pin names are often misleading in
analog. As the progression of new design topologies evolves,               that the analog and digital connections can be differentiated with
this paradigm shifted to where slower speed A/D converters                 the pin label. These labels are not meant to describe the system
were predominately digital. Even with this on-chip shift from              connections to the PCB, but rather they identify how the digital
analog to digital, the PCB layout practices have not changed.              and analog currents come off the chip. Knowing this information
Now as always, when the layout designer is working with mixed              and understanding that the primary real estate consumed on the
signal circuits, key layout knowledge is still needed in order to          chip is analog, it makes sense to connect the power and ground
implement an effective layout. This article will look at the PCB           pins on the same planes, e.g., analog planes.
layout strategies required for A/D converters using successive             For instance, the pinout for a representative sample of 10-bit and
approximation register (SAR) and Sigma-Delta topologies.                   12-bit converters are shown in Figure 2.
SAR Converter Layout                                                       With these devices, the ground is usually directed off the
SAR A/D converters can be found with 8-bit, 10-bit, 12-bit, 16-            chip with two pins: AGND and DGND. The power is taken for
bit and sometimes 18-bit resolution. Originally, the process and           a single pin. When implementing the PCB layout using these
architecture for these converters was bipolar with R-2R ladders.           chips, the AGND and DGND should be connected to the analog
But recently these devices have migrated to a CMOS process                 ground plane. The analog and digital power pins should also be
with a capacitive charge distribution topology. Needless to say,           connected to the analog power plane or at least connected to
the system layout strategy for these converters has not changed            the analog power train with proper by-pass capacitors as close to
with this migration. The basic approach to layout is consistent            each pin as possible. The only reason that these devices would
except for higher resolution devices. These devices require more           have only one ground pin and one positive supply pin, as with the
attention to the prevention digital feedback from the serial or            MCP3201, is due to package pin limitations. However, separate
parallel output interface of the converter.                                grounds enhance the probability of getting good and repeatable
                                                                           accuracy from the converter.
The SAR converter is predominately analog in terms of circuitry
and the amount of real estate dedicated to the different domains           With all of the converters, the power supply strategy should
on the chip. In Figure 1, a block diagram of a 12-bit CMOS SAR             be to connect all grounds, positive supply and negative supply
converter is shown.                                                        pins to the analog plane. In addition, the ‘COM’ pin or ‘IN’ pin
                                                                           associated with the input signal should be connected as close to
Within this block diagram the Sample/Hold, comparator, most                the signal ground as possible.
of the digital-to-convert (DAC) and 12-bit SAR are analog. The
remaining portions of the circuit are digital. As a consequence,
most of the power and current needed for this converter is used
for the internal analog circuitry. There is very little digital currents
coming from the device with the exception of the small amount of
switching that occurs in the DAC and at the digital interface.




                                                                           Figure 2: The SAR converter, regardless of resolution, usually has
                                                                           at least two ground connects: AGND and DGND. The converters
                                                                           illustrated here are the MCP3201 and MCP3008 from Microchip.


Figure 1: A block diagram of a 12-bit CMOS SAR A/D converter.
This converter uses a charge distribution across a capacitive array.



                                                                                                                                          11
Analog and Interface Guide – Volume 1
      An Intuitive Approach to Mixed Signal Layout – Part 4
Higher resolution SAR converters (16- and 18-bit converters)         Precision Sigma-Delta Layout Strategies
require a little more consideration in terms of separating           The silicon area of the precision Sigma-Delta A/D converter
the digital noise from the quiet analog converter and power          is predominately digital. In the early days, when this type
planes. When these devices are interfaced to a microcontroller,      of converter was being produced, this shift in the paradigm
external digital buffers should be used in order to achieve clean    prompted users to separate the digital noise from the analog
operation. Although these types of SAR converters typically have     noise by using the PCB planes. As with the SAR A/D Converter,
internal double buffers at the digital output, external buffers      these types of A/D converters can have multiple analog- and
are used to further isolate the digital bus noise from the analog    digital ground and power pins. Once again, the common tendency
circuitry in the converter. An appropriate power strategy for this   of a digital or analog design engineer is to try separating these
type of system is shown in Figure 3.                                 pins into separate planes.
                                                                     Unfortunately, this tendency is misguided, particularly if you
                                                                     intend to solve critical noise problems with the 16-bit to 24-bit
                                                                     accuracy devices.
                                                                     With high-resolution Sigma-Delta converters that have a 10 Hz
                                                                     data rate, the clock (internal or external) to the converter could
                                                                     be as high as 10 MHz or 20 MHz. This high frequency clock is
                                                                     used for switching the modulator and running the oversampling
                                                                     engine. With these circuits, the AGND and DGND pins are
                                                                     connected together on the same ground plane, as is the case
                                                                     with the SAR converter. Additionally, the analog and digital power
                                                                     pins are connected together, preferably on the same plane. The
                                                                     requirements on the analog and digital power planes are the
                                                                     same as with the high-resolution SAR converters.
                                                                     A ground plane is mandatory, which implies that a double-sided
                                                                     board is needed at minimum. On this double-sided board,
                                                                     the ground plane should cover at least 75% of the area if not
                                                                     more. The purpose of this ground plane layer is to reduce
                                                                     grounding resistance and inductance as well as provide a shield
                                                                     against electro-magnetic interference (EMI) and radio-frequency
                                                                     interference (RFI). If circuit interconnect traces need to be put on
                                                                     the ground-plane side of the board, they should be as short as
                                                                     possible and perpendicular to the ground current return paths.
                                                                     Conclusion
                                                                     You can get away without separating the analog and digital pins
                                                                     of low precision A/D converters, such as 6-, 8- or maybe even
                                                                     10-bit converters. But as the resolution/accuracy increases with
                                                                     your converter selection, the layout requirements also become
Figure 3: With high-resolution SAR A/D converters, the converter     more stringent. In both cases, with high resolution SAR A/D
power and ground should be connected to the analog planes. The       converters and Sigma-Delta converters these devices need to be
digital output of the A/D converter should then be buffered, using   connected directly to the lower noise analog ground and power
external 3-state output buffers. These buffers provide isolation     planes.
between the analog and digital side, in addition to high-drive
capability.




 12
                                                                                     Analog and Interface Guide – Volume 1
    An Intuitive Approach to Mixed Signal Layout – Part 5

The Trouble With Troubleshooting Your Layout
Without The Right Tools
When you’re trying to solve a signal integrity problem, the best of     Further investigations into the circuit shows that the source of
all worlds is to have more than one tool to examine the behavior        the noise seen on the time plot comes from the switching power
of a system. If there is an A/D converter in the signal path, there     supply. An inductive choke is added to the circuit along with
are three fundamental issues that can easily be examined when           bypass capacitors. One 10 μF is positioned at the power supply
assessing the circuit’s performance. All three of these methods         and three 0.1 μF capacitors are placed as close to the supply
evaluate the conversion process as well as its interaction with         pins of the active elements as possible. Now the generation of
the layout and other portions of the circuit. The three areas of        a new time plot seems to produce a solid DC output and this
concern encompass the use of frequency analysis (FFTs), time            is verified with the Histogram results, shown in Figure 3. The
analysis, and DC analysis techniques. This article will explore the     data shows these changes eliminated the noise source from the
use of these tools to identify the source of problems as it relates     signal path of the circuit.
to the layout implementation of circuits. We will explore how you
decide what to look for, where to look, how to verify problems
through testing and how to solve the problems that are identified.
The circuit that was built and is used in the following discussion
is shown in Figure 1.
Power Supply Noise
A common source of interference in circuit applications is from
the power supply. This interference signal is typically injected
through the power supply pins of the active devices. For instance,
a time based plot of the output of the A/D converter in Figure 1
is given in Figure 2. In this figure, the sample speed for the A/D
converter was 40 ksps and 4096 samples were taken.
In this case, the instrumentation amplifier, voltage reference
and A/D converter do not have by-pass capacitors installed.
Additionally, the inputs to the circuit are both referenced to a low
noise, DC voltage source of 2.5V.
                                                                        Figure 2: The time domain representation of this data from the
                                                                        3201, 12-bit A/D converter produces an interesting periodic signal.
                                                                        This signal source was traced back to the power supply.




Figure 1: The voltage at the output of the SCX015 pressure sensor is gained by the instrumentation amplifier (A1 and A2). Following the
instrumentation amplifier a low pass filter (A3) is inserted to eliminate aliased noise from the 12-bit A/D converter conversion.

                                                                                                                                      13
Analog and Interface Guide – Volume 1
      An Intuitive Approach to Mixed Signal Layout – Part 5

                                                                           Improper Use of Amplifiers
                                                                           Returning to the circuit shown in Figure 1, a 1 kHz AC signal is
                                                                           injected at the positive input to the instrumentation amplifier.
                                                                           This signal would not be characteristic of this pressure sensing,
                                                                           however, this example is used to illustrate the influence of
                                                                           devices in the analog signal path.
                                                                           The performance of this circuit with the above conditions is
                                                                           shown in the FFT plot in Figure 5. It should be noticed that the
                                                                           fundamental seems to be distorted and there are numerous
                                                                           harmonics with the same distortion. The distortion is caused by
                                                                           overdriving the amplifier slightly into the rails. The solution to this
                                                                           problem is to lower the amplifier gain.




Figure 3: Once the power supply noise has been sufficiently
reduced, the output code of the MCP3201 is consistently one
code, 2108

Interfering External Clocks
Another source of systematic noise can come from clock sources
or digital switching in the circuit. If this type of noise is correlated
with the conversion process, it won’t appear as interference
in the conversion process. However, if it is uncorrelated, it can
easily be found with an FFT analysis.
An example of clocking signal interference is shown in the FFT
plot in Figure 4. With this plot, the circuit shown in Figure 1 is
used with the by-pass capacitors installed. The spurs seen in the          Figure 5: Slightly overdriving an amplifier can generate a distortion
FFT plot shown in Figure 4 are generated by a 19.84 MHz clock              in the signal. The FFT plot of this type of conversion quickly points
signal on the board. In this instance, layout has been done with           out that the signal is distorted.
little regard for trace to trace coupling. The negligence to this
detail appears in the FFT plot.
This problem can be solved by changing the layout to keep high
                                                                           Conclusion
impedance analog traces away from digital switching traces or              Solving signal integrity problems can take a great deal of time
implementing an anti-aliasing filter in the analog signal path             particularly if you don’t have the tools to tackle the tough issues.
prior to the A/D converter. Random trace to trace coupling is              The three best analysis tools to have in your “box of tricks” are
somewhat more difficult to find. In these instances, time domain           the frequency analysis (FFT), time analysis (scope photo) and
analysis can be more productive.                                           DC analysis (Histogram) tools. We used many of these tools
                                                                           to identify the power supply noise, external clock noise and
                                                                           overdriven amplifier distortion.




Figure 4: Digital noise coupled into analog traces is sometimes
misunderstood as broadband noise. An FFT plot easily pulls out
this so called “noise” into an identifiable frequency so the source
can be identified.




 14
                                                                                        Analog and Interface Guide – Volume 1
    An Intuitive Approach to Mixed Signal Layout – Part 6

Layout Tricks For A 12-Bit Sensing System
When I started writing this article I thought a “cookbook”                 One Major Step Towards Disaster
approach would be appropriate when describing the
implementation of a good 12-bit layout. My assumption behind               As I look at this complete circuit diagram I am tempted to use an
this type of approach is that a reference design could be                  auto router tool in my layout software. This is my first mistake. I
provided, which would make the layout implementation easy. But             have found that when I use this type of tool I often will go back
I struggled with this topic long enough to find that this notion was       and make significant changes to the layout. If the tool is capable
fairly unrealistic.                                                        of implementing layout restrictions, I may have a fighting chance.
                                                                           If my auto-routing tool does not have a restriction option, the best
Because of the complexity of this problem, I am going to                   approach is to not use it at all.
provide basic guidelines ending with a review of issues to be
aware of while implementing your layout design. Throughout                 General Layout Guidelines
this discussion I will offer examples of good and bad layout               Device Placement
implementations. I am doing this in the spirit of discussing
concepts and not with the intent of recommending one layout as             Now that I am working on this layout manually, my first step
the only one to use.                                                       is to place the devices on the board. This critical step is done
                                                                           effectively because I am keeping track of my noise-sensitive
The application circuit that I’m going to use is a load cell circuit       devices and noise-creator devices. There are two guidelines that I
that accurately measures the weight applied to the sensor,                 use to accomplish this task:
then displays the results on an LCD display screen. The circuit
diagram for this system is shown in Figure 1. The load cell that           1. Separate the circuit devices into two categories: high speed
I used can be purchased from Omega (LCL-816G). My sensor                       (>40 MHz) and low speed. When you can, place the higher
model for the LCL-816G is a four element resistive bridge                      speed devices closer to the board connector/power supply.
that requires voltage excitation. With a 5V excitation voltage             2. Separate the above categories into three subcategories: pure
applied to the high side of the sensor, the full scale output                  digital, pure analog and mixed signal. With this delineation,
swing is a ±10 mV differential signal with a 32 ounce maximum                  place the digital devices closer to the board connector/power
excitation. This small differential signal is gained by a two-op               supply.
amp instrumentation amplifier. I chose a 12-bit converter to               The board layout strategy should map the diagram shown in
match the required precision of this circuit. Once the converter           Figure 2. Notice Figure 2a, the relationship of high speed versus
digitizes the voltage presented at its input, the digital code is          slower speeds to the board connector/power supply. In Figure 2b,
sent to a microcontroller using the converter’s SPI™ port. The             the digital and analog circuit is shown as being separate from the
microcontroller then uses a look-up table to convert the digital           digital devices, which are closest to the board connector/power
signal from the ADC into weight. Linearization and calibration             supply. The pure analog devices are furthest away from the digital
activities can be implemented with controller code at this point           devices to insure that switching noise is not coupled into the
if need be. Once this is done the results are sent to the LCD              analog signal path. The layout treatment of the A/D converters
display. As a final step, I wrote the firmware for the controller.         is discussed in detail in part 4 of this 6-part series (Layout
Now the design is ready to go to board layout.                             Techniques To Use As The ADC Accuracy And Resolution Increase).




Figure 1: The signal at the output of the load-cell sensor is gained by a two-op amp instrumentation amplifier, filtered and digitized with a
12-bit A/D Converter, MCP3201. The result of each conversion is displayed on the LCD display



                                                                                                                                           15
Analog and Interface Guide – Volume 1
      An Intuitive Approach to Mixed Signal Layout – Part 6

                                            a) High Frequency Components       b) Digital Devices Should
                                              Should Be Placed Near The           Be Placed Near The
                                               Connector/Power Source          Connector/Power Source


                             high

                                frequency




                             low



Figure 2: The placement of active components on a PCB is critical in precision 12-bit+ circuits. This is done by placing higher frequency
components (a) closer to the connector and digital devices (b) closer to the connector.

Ground and Power Supply Strategy                                           Does my “no ground plane is required” theory play out? The proof
Once I determine the general location of the devices, my ground            is in the pudding, or data. In Figure 4, 4096 samples were taken
planes and power planes are defined. My strategy of the                    from the A/D converter and logged. No excitation is applied to
implementation of these planes is a bit tricky.                            the sensor when this data is taken. With this circuit layout, the
                                                                           controller is dedicated to inter facing with the converter and
First of all, it is dangerous for me not to use a ground plane in          sending the converter’s results to the LCD display.
a PCB implementation. This is true particularly in analog and/or
mixed-signal designs. One issue is that ground noise problems              Figure 5 shows the same device layout shown in Figure 3
are more difficult to deal with than power supply noise problems           but a ground plane on the bottom layer is added. The ground
because analog signals are referenced to ground. For instance, in          plane (Figure 5b) has a few breaks due to signal. These breaks
the circuit shown in Figure 1, the A/D converter’s inverting input         should be kept to a minimum. Current return paths should not
pin (MCP3201) is connected to ground. Secondly, the ground                 be “pinched” as a consequence of these traces restricting the
plane also serves as a shield against emitted noise. Both of               easy flow of current from the device to the power connector.
these problems are easy to resolve with a ground plane and                 The histogram for the A/D converter output is shown in Figure
nearly impossible to overcome if there is no ground plane.                 6. Compared to Figure 4, the output codes are much tighter.
                                                                           The same active devices were used for both tests. The passive
However, with my small design, I assume that I won’t need a                devices were different causing a slight offset difference.
ground plane. A ground plane-less layout implementation of the
circuit in Figure 1 is shown in Figure 3.




Figure 3: Layout of the top (a) and bottom (b) layers of the circuit in Figure 1. Note that this layout does not have a ground or power plane.
Note that the power traces are made considerably wider than the signal traces in order to reduce power supply trace inductance.




 16
                                                                                       Analog and Interface Guide – Volume 1
    An Intuitive Approach to Mixed Signal Layout – Part 6

                                                                         The inclusion of a power plane in a 12-bit system is not as
                                                                         critical as the required ground plane. Although a power plane can
                                                                         solve many problems, power noise can be reduced by making the
                                                                         power traces two or three times wider than other traces on the
                                                                         board and by using by-pass capacitors effectively.
                                                                         Signal Traces
                                                                         My signal traces on the board (both digital and analog) should
                                                                         be as short as possible. This basic guideline will minimize the
                                                                         opportunities for extraneous signals to couple into the signal
                                                                         path. One area to be particularly cautious of is with the input
                                                                         terminals of analog devices. These terminals normally have a
                                                                         higher impedance than the output or power supply pins. As an
                                                                         example, the voltage reference input pin to the A/D converter is
                                                                         most sensitive while a conversion is occurring. With the type of
                                                                         12-bit converter I have in Figure 1, my input terminals (IN+ and
                                                                         IN-) are also sensitive to injected noise. Another potential for
Figure 4: This is a histogram of 4096 samples from the output            noise injection into my signal path is the input terminals of an
of the A/D converter from a PCB that does not have a ground or           operational amplifier. These terminals have typically 109 to
power plane as shown in the PCB layout in Figure 3. The code of          1013Ω input impedance.
the noise from the circuit is 15 codes wide.                             My high impedance input terminals are sensitive to injected
                                                                         currents. This can occur if the trace from a high impedance input
It is clear from my data that a ground plane does have an effect         is next to a trace that has fast changing voltages, such as a
on the circuit noise. When my circuit did not have a ground plane,       digital or clock signal. When a high impedance trace is in close
the width of the noise was ~15 codes. When I added a ground              proximity to a trace with these types of voltage changes, charge
plane, I improved the performance by almost 1.5X or 15/11. It            is capacitively coupled into the high impedance trace.
should be noted that my test set up was in the lab where EMI             The relationship between two traces is shown in Figure 7. In
interference is relatively low.                                          this diagram the value of the capacitance between two traces
Because of the noise shown with the A/D converter my digital             is primarily dependent on the distance (d) between the traces
code is assignable to the op-amp noise and the absence of an             and the distance that the two traces are in parallel (L). From this
anti-aliasing filter. If my circuit has a “minimum” amount of digital    model, the amount of current generated into the high impedance
circuitry on board, a single ground plane and a single power plane       trace is equal to:
may be appropriate. My qualifier “minimum” is defined by the
                                                                         I = C dV/dt
board designer. The danger of connecting the digital and analog
ground planes together is that my analog circuitry can pick-up           Where: I = current that appears on the high impedance trace
the noise on the supply pins and couple it into the signal path.                C = value of capacitance between the two PCB traces
In either case, my analog and digital grounds and power supplies                dV = change in voltage of the trace that is switching
should be connected together at one or more points in the circuit               dt = amount of time that the voltage change took to
to insure that my power supply, input and output ratings of all of                   get from one level to the next
the devices are not violated.




Figure 5: Layout of the top and bottom layers of the circuit in Figure 1. Note that this layout DOES have a ground plane.




                                                                                                                                        17
Analog and Interface Guide – Volume 1
      An Intuitive Approach to Mixed Signal Layout – Part 6
                                                                      Every active device on the board requires a by-pass capacitor. It
                                                                      must be placed as close as possible to the power supply pin of
                                                                      the device as shown in Figure 5. If two by-pass capacitors are
                                                                      used for one device, the smaller one should be closest to the
                                                                      device pin. Finally, the lead length of the by-pass capacitor should
                                                                      be as short as possible.
                                                                      Anti-Aliasing Filters
                                                                      You will note that the circuit in Figure 1 does not have an anti-
                                                                      aliasing filter. As the data shows, this oversight has caused
                                                                      noise problems in the circuit. When this board has a 4th order,
                                                                      10 Hz, anti-aliasing filter inserted between the output of the
                                                                      instrumentation amplifier and the input of the A/D converter,
                                                                      the conversion response improves dramatically. This is shown in
                                                                      Figure 8.
                                                                      Analog filtering can remove noise superimposed on the analog
                                                                      signal before it reaches the A/D converter. In particular, this
Figure 6: This is a histogram of 4096 samples from the output of      includes extraneous noise peaks. Analog-to-Digital converters will
the A/D converter on the PCB that has a ground plane as shown in      convert the signal that is present on its input. This signal could
the PCB layout in Figure 5. The code width of the noise is now 11     include that sensor voltage signal or noise. The anti-aliasing filter
codes wide.                                                           removes the higher frequency noise from the conversion process.

Did I Say By-pass And Use An Anti-Aliasing Filter?
Although this article is about layout practices, I thought it would
be a good idea to cover some of the basics in circuit design.
A good rule concerning by-pass capacitors is to always include
them in the circuit. If they are not included the power supply
noise may very well eliminate any chance for 12-bit precision.
By-pass Capacitors
By-pass capacitors belong in two locations on the board: one at
the power supply (10 μF to 100 μF or both) and one for every
active device (digital and analog). The value of the device’s
by-pass capacitor is dependent on the device in question. If the
bandwidth of the device is less than or equal to ~1 MHz, a 1 μF
will reduce injected noise dramatically. If the bandwidth of the
device is above ~10 MHz, a 0.1 μF capacitor is probably
appropriate. In between these two frequencies, both or either
one could be used. Refer to the manufacturer’s guidelines for         Figure 8: This diagram shows the conversion results of the circuit
specifics.                                                            in Figure 1 plus a 4th order, anti-aliasing filter. Additionally, the
                                                                      board layout includes a ground plane.

                                                                      PCB Design Check List
                                                                      Good 12-bit layout techniques are not difficult to master as long
                                                                      as you follow a few guidelines:
                                                                      1. Check device placement versus connectors. Make sure that
                                                                         high-speed devices and digital devices are closest to the
                                                                         connector.
                                                                      2. Always have at least one ground plane in the circuit.
                                                                      3. Make power traces wider than other traces on the board.
                                                                      4. Review current return paths and look for possible noise
                                                                         sources on ground connects. This is done by determining the
                                                                         current density at all points of the ground plane and the
                                                                         amount of possible noise present.
                                                                      5. By-pass all devices properly. Place the capacitors as close to
                                                                         the power pins of the device as possible.
                                                                      6. Keep all traces as short as possible.
                                                                      7. Follow all high impedance traces looking for possible
                                                                         capacitive coupling problems from trace to trace.
                                                                      8. Make sure your signals in a mixed-signal circuit are properly
Figure 7: A capacitor can be constructed on a PCB by placing two
                                                                         filtered.
traces in close proximity. With this PCB capacitor, signals can be
coupled between the traces.


 18
                                                                                     Analog and Interface Guide – Volume 1
    Analog Design Notes

Keeping Power Hungry Circuits Under Thermal Control
Projectors, large power supplies, datacom switches and routers,         For a one-fan circuit, the stand-alone fan controller IC is the
pose an interesting heat dissipation problem. These applications        better choice. The stand-alone IC has fault detect circuitry that
consume enough power to prompt a designer to cool off the               can notify the system when the fan has failed, so that the power
electronics with a fan. If the appropriate airflow across the           consuming part of the system can be shut down. The stand-alone
electronics is equal to or less than six to seven Cubic Feet per        IC fan fault detection capability rejects glitches, ensuring that
Minute (CFM), a good choice of fan would be the DC brushless            false alarms are filtered. It can economically be used to sense
fan.                                                                    remote temperature with a NTC thermistor or with the internal
The fan speed of a DC brushless fan can be driven and controlled        temperature sensor on-chip. As an added benefit, the stand-alone
by the electronics in a discrete solution, a microprocessor circuit     IC can be used to detect the fan faults of a two-wire fan, which is
or a stand-alone fan controller IC. A discrete solution can be          more economical than its three-wire counterpart.
highly customized but can be real-estate hungry. Although this          Regardless of the circuit option that is used, there are three
solution is a low cost alternative, it is challenging to implement      primary design issues to be considered in fan control circuits,
“smart” features, such as predictive fan failure or false fan           once the proper location of the fan is determined. These three
failure alarm rejection. Additionally, the hardware troubleshooting     design issues are: fan excitation, temperature monitoring and fan
phase for this system can be intensive as the feature set               noise.
increases.                                                              The circuit in Figure 1 illustrates how a two-wire fan can be driven
If you have a multiple fan application, the best circuit to use         with a stand-alone IC. In this circuit, the TC647B performs the
is a microcontroller-based system. With the microcontroller, all        task of varying the fan speed based on the temperature that is
the fans and temperatures of the various environments can be            sensed from the NTC thermistor. The TC647B is also able to
economically controlled with this one chip solution and a few           sense fan operation, enabling it to indicate when a fan fault has
external components. The “smart” features that are difficult to         occurred.
implement with discrete solutions are easily executed with the
                                                                         The speed of a brushless DC fan can be controlled by either
microcontroller. The firmware of the microcontroller can be used
                                                                        varying the voltage applied to it linearly or by pulse width
to set threshold temperatures and fan diagnostics for an array
                                                                        modulating (PWM) the voltage. The TC647B shown in Figure 1,
of fans. Since the complexity of this system goes beyond the
                                                                        drives the base of transistor Q1 with a PWM waveform, which in
control of one fan, the firmware overhead and firmware debugging
                                                                        turn drives the voltage that is applied to the fan.
can be an issue.




Figure 1: A two-wire fan can easily be driven and controlled by a thermistor-connected TC647B.




                                                                                                                                       19
Analog and Interface Guide – Volume 1
      Analog Design Notes
By varying the pulse width of the PWM waveform, the speed             The TC647B also uses Microchip’s FanSense™ technology,
of the fan can be increased or decreased. The pulse width             which improves system reliability. All of these features included
modulation method of fan speed control is more efficient than         in a single chip, gives the designer a leg up in a single fan
the linear regulation method.                                         implementation.
The voltage across RSENSE and the voltage at the SENSE pin
during PWM mode operation are shown in Figure 2. The voltage
at the sense resistor has both DC and AC content. The AC
content is generated by the commutation of the current in the
fan motor windings. These voltage transients across RSENSE
are coupled through CSENSE to the SENSE pin of the TC647B.
This removes the DC content of the sense resistor voltage.
There is an internal resistor, 10 kΩ to ground, on the SENSE
pin. The SENSE pin senses voltage pulses, which communicate
fan operation to the TC647B. If pulses are not detected by the
SENSE pin for one second, a fault condition is indicated by the
TC647B.




Figure 2: The fan response (across RSENSE) to the PWM signal at
VOUT, is shown in the bottom trace. The capacitively coupled signal
to the SENSE pin of the TC647B is shown in the top trace.

The temperature can easily be measured with an economic
solution, such as a thermistor. The thermistor is fast, small,
requires a two-wire interface and has a wide range of outputs.
As an added benefit, the layout flexibility is enhanced by being
able to place the thermistor remote from the TC647B. Although
thermistors are non-linear, they can be linearized over a smaller
temperature range (±25°C) with the circuits shown in Figure 3.
This linearization and level shifting is done using standard, 1%
resistors.
Although temperature proportional fan speed control and fan
fault detection for two-wire fans can be implemented in a discrete
circuit or the microcontroller version, it requires a degree of
attention from the designer. The TC647B is a switch mode two-
wire brushless DC fan speed controller. Pulse Width Modulation
(PWM) is used to control the speed of the fan in relation to the      Figure 3: A thermistor can be linearized over 50°C with a standard
thermistor temperature. Minimum fan speed is set by a simple          resistor (A and B) as well as level shifted (C) to match the input
resistor divider on VMIN. An integrated Start-up Timer ensures        requirements of the TC647B.
reliable motor start-up at turn-on, coming out of shutdown mode
or following a transient fault with auto-fan restart capability.




 20
                                                                                      Analog and Interface Guide – Volume 1
    Analog Design Notes

Instrumentation Electronics At A Juncture
Process control and instrumentation solutions rose out of the           At the input of this device there is a multiplexer, which allows
1970s/1980s revolution in electronics. From that endeavor               the user to interface to multiple inputs. This multiplexer is
the well-known instrumentation amplifier came into existence.           directly connected to the non-inverting input of a wide bandwidth
Structures like a three op amp design, followed by a two-op amp         amplifier. The programmable closed loop gain of this amplifier
version were built discretely with a few resistors and op amps.         is implemented using an on-chip resistor ladder. The eight
This solution was later made available on an integrated chip. It        programmable gains are, 1, 2, 4, 5, 8, 10, 16 and 32.
may seem that things haven’t changed much since then, but not           The multiplexer and high-speed conversion response of the
so. The digital revolution, that is just coming into its own, is now    PGA and A/D combination allows a differential input signal
encroaching on that traditional analog territory.                       to be quickly sampled and converted into their 12-bit digital
Instrumentation amplifiers are good for gaining differential input      representation. The PIC® microcontroller subtracts the two
signals and rejecting common mode noise, but fall short when            signals from CH0 and CH1. While the subtraction of the two
there are multiple sensor inputs that need to be integrated             signals is implemented to calculate the sensor response, the
into the system. For instance, a pressure sensor or load cell           lower frequency common mode noise is also eliminated.
require an instrumentation amplifier to change their differential       Although it is simple to measure temperature in a stand-alone
output signal into a single voltage. But often these systems            system without the help of the PGA, a variety of problems can
need temperature data for calibration. This temperature data is         be eliminated by implementing temperature sensing capability in
acquired through a separate signal path.                                a multiplexed environment. One of the main advantages is that
An alternative to having two separate signal paths is to use a          a second signal path to the microcontroller can be eliminated,
single-ended input/output Programmable Gain Amplifier (PGA).            while still maintaining the accuracy of the sensing system. The
With this device, the signal subtraction, common mode noise             multiplexed versions of PGAs are the MCP6S22 (two channel),
rejection and some filtering of the differential input signal is        MCP6S26 (six channel) and MCP6S28 (eight channel). The
performed inside the microcontroller. The PGA also allows for           most common sensors for temperature measurements are the
multiple input channels, which is configurable using the SPI™           thermistor, silicon temperature sensor, RTD and thermocouple.
port. A large number of sensors can be configured to the PGA            Microchip’s PGAs are best suited to inter face to the thermistor
inputs. An example is shown in Figure 1.                                or silicon temperature sensor. Photo sensors bridge the gap
The type of resistive sensor bridge, shown in Figure 1, is primarily    between light and electronics. The PGA is not well suited for
used to sense pressure, temperature or load. An external                precision applications such as, CT scanners, but they can be
A/D converter and the PGA can easily be used to convert the             effectively used in position photo sensing applications. The
difference voltage from these resistor bridge sensors to usable         multiplexer and high-speed conversion response of the PGA
digital words. A block diagram of Microchip’s PGA is shown in           and A/D combination allows the photo sensor input signal to
Figure 2.                                                               be sampled and converted in the analog domain and quickly
                                                                        converted to the digital domain. This photo sensing circuit is
                                                                        appropriate for signal responses from DC to ~100 kHz.




Figure 1: The PGA device can be used to gain signals from a variety of sensors, such as a resistive bridge, an NTC temperature sensor, a
silicon photo sensor or a silicon temperature sensor.




                                                                                                                                       21
Analog and Interface Guide – Volume 1
      Analog Design Notes
The MCP6S2X is a PGA family that uses a precision, wide                   Recommended References
bandwidth internal amplifier. This precision device not only offers
excellent offset voltage performance, but the configurations in           AN248 “Interfacing MCP6S2X PGAs to PICmicro®
these sensing circuits are easily designed without the headaches          Microcontroller”, Ezana Haile, Microchip Technology Inc.
of stability that the stand-alone amplifier circuits present to the       AN251 “Bridge Sensing with the MCP6S2X PGAs”, Bonnie C.
designer. Stability with these programmable gain amplifiers has           Baker, Microchip Technology Inc.
been built-in.                                                            AN865 “Sensing Light with a Programmable Gain Amplifier”,
For more information, access the following list of references at:         Bonnie C. Baker, Microchip Technology Inc.
www.microchip.com.                                                        AN867 “Temperature Sensing with a Programmable Gain
                                                                          Amplifier”, Bonnie C. Baker, Microchip Technology Inc.




Figure 2: Programmable Gain Amplifier (PGA) Block Diagram. The PGA has an internal amplifier that is surrounded by a programmable
resistor ladder. This ladder is used to change the gain through the SPI™ port. An analog multiplexer precedes the non-inverting input of the
amplifier to allow the user to configure this device from multiple inputs.




 22
                                                                                    Analog and Interface Guide – Volume 1
    Analog Design Notes

Select The Right Operational Amplifier For Your Filtering Circuits
Analog filters can be found in almost every electronic circuit.        In Figure 1, the non-inverting Sallen-Key is designed so that the
Audio systems use them for preamplification and equalization.          input signal is not inverted. A gain option is implemented with R3
In communication systems, filters are used for tuning specific         and R4. If you want a DC gain of +1 V/V, R3 should be removed
frequencies and eliminating others. But if an analog signal is         and R4 should be shorted. A second order, Multiple Feedback
digitized, low-pass filters are always used to prevent aliasing        configuration is shown in Figure 2. With this circuit topology, the
errors from out-of-band noise and interference.                        input signal is inverted around the reference voltage, VREF. If a
Analog filtering can remove higher frequency noise superimposed        higher order filter is needed, both of these topologies can be
on the analog signal before it reaches the Analog-to-Digital           cascaded.
converter. In particular, this includes low-level noise as well as
extraneous noise peaks. Any signal that enters the Analog-to-
Digital converter is digitized. If the signal is beyond half of the
sampling frequency of the converter, the magnitude of that signal
is converted reliably, but the frequency is modified as it aliases
back into the digital output. You can use a digital filter to reduce
the noise after digitizing the signal, but keep in mind the rule of
thumb: “Garbage in will give you garbage out”.
The task of selecting the correct single supply operational
amplifier (op amp) for an active low-pass filter circuit can appear
overwhelming, as you read any op amp data sheet and view all
of the specifications. For instance, the number of DC and AC
Electrical Specifications in Microchip’s 5 MHz, single supply,
MCP6281/2/3/4 data sheet is twenty-four. But in reality, there
are only two important specifications that you should initially
consider when selecting an op amp for your active, low-pass
filter. Once you have chosen your amplifier, based on these two
specifications, there are two additional specifications that you
should consider before reaching your final decision. The most
common topologies for second order, active low-pass filters are
shown in Figure 1 and Figure 2.                                        Figure 2: Second order, Multiple Feedback, Low-pass filter.

                                                                       The two key specifications that you should initially consider when
                                                                       designing with either of these topologies is Gain Bandwidth
                                                                       Product and Slew Rate. Prior to the selection of the op amp, you
                                                                       need to determine the filter cutoff frequency (fC), also known as
                                                                       the frequency where your filter starts to attenuate the signal.
                                                                       Sometimes, in literature, you will find that this is called the
                                                                       passband frequency. Once this is done, the filter design software
                                                                       program, FilterLab® (available at www.microchip.com), can be
                                                                       used to determine the capacitor and resistor values.
                                                                       Since you have already defined your cutoff frequency, selecting
                                                                       an amplifier with the right bandwidth is easy. The closed-loop
                                                                       bandwidth of the amplifier must be at least 100 times higher
                                                                       than the cutoff frequency of the filter. If you are using the
                                                                       Sallen-Key configuration and your filter gain is +1 V/V, the Gain
                                                                       Bandwidth Product (GBWP) of your amplifier should be equal to
                                                                       or greater than 100 fC. If your closed loop gain is larger than +1
                                                                       V/V, your GBWP should be equal to or greater than 100 GCLNfC,
                                                                       where GCLN is equal to the non-inverting closed-loop gain of your
                                                                       filter. If you are using the Multiple Feedback configuration, the
                                                                       GBWP of your amplifier should be equal to or greater than 100*
Figure 1: Second order, Sallen-Key, Low-pass filter.                   (-GCLI + 1)fC, where GCLI is equal to the inverting gain of your
                                                                       closed-loop system.
                                                                       Microchip’s gain bandwidth op amp products are shown in
                                                                       Table 1.




                                                                                                                                      23
Analog and Interface Guide – Volume 1
      Analog Design Notes
In addition to paying attention to the bandwidth of your amplifier,      The voltage drop caused by this error will appear as an input
the Slew Rate should be evaluated in order to ensure that your           offset voltage and input noise source. But more critical, high
filter does not create signal distortions. The Slew Rate of an           input bias currents in the nano or micro ampere range may
amplifier is determined by internal currents and capacitances.           motivate you to lower your resistors in your circuit. When you do
When large signals are sent through the amplifier, the appropriate       this, you will increase the capacitors in order to meet your filter
currents charge these internal capacitors. The speed of this             cutoff frequency requirements. Large capacitors may not be a
charge is dependent on the value of the amplifier’s internal             very good option because of cost, accuracy and size. Also, be
resistances, capacitances and currents. In order to ensure that          aware that this current will increase with temperature. Notice
your active filter does not enter into a slew condition you need to      that most of the devices in Table 1 have Input Bias Current
select an amplifier such that the Slew Rate (2πVOUT P-P fC), where       specifications in the pA range, therefore, higher value resistors
VOUT P-P is the expected peak-to-peak output voltage swing below         are permissible.
fC of your filter.                                                       If you follow these simple guidelines you will find that designing a
There are two, second order specifications that affect your filter       successful low-pass filter is not that difficult and you will quickly
circuit. These are Input Common Mode Voltage Range (VCMR),               have a working circuit.
for the Sallen-Key circuit and Input Bias Current (IB). In the           Recommended References
Sallen-Key configuration, VCMR will limit the range of your input
signal. The power supply current may or may not be a critical            AN699 “Anti-Aliasing, Analog Filters for Data Acquisition
specification unless you have an application on a power budget.          Systems”, Bonnie C. Baker, Microchip Technology Inc.
Another second order specification to consider is the Input Bias         FilterLab® Analog Filtering Software tool is available at:
Current. This specification describes the amount of current going        www.microchip.com
in or out of the input pins of the amplifier. If you are using the
Sallen-Key filter configuration, as shown in Figure 1, the input
bias current of the amplifier will conduct through R2.

                                                                             Input Common                      Input Bias Current
                                GBWP                 Slew Rate
 Device                                                                       Mode Voltage                   at Room Temperature
                                (Typ)               (V/μs, Typ)
                                                                            with VDD = 5V (V)                         (Typ)
 MCP6041/2/3/4                  14 kHz                 0.003                    -0.3V to 5.3V                            1 pA
 TC1029/30/34/35                90 kHz                 0.035                    -0.2V to 5.2V                            50 pA
 MCP6141/2/3/4                  100 kHz                0.024                    -0.3V to 5.3V                            1 pA
 MCP606/7/8/9                   155 kHz                 0.08                    -0.3V to 3.9V                            1 pA
 MCP616/7/8/9                   190 kHz                 0.08                    -0.3V to 4.1V                            -15 nA
 MCP6001/2/4                     1 MHz                   0.6                    -0.3V to 5.3V                            1 pA
 TC913                          1.5 MHz                  2.5                 4.5V (VDD = 6.5V)                      90 pA (max)
 MCP6271/2/3/4                   2 MHz                   0.9                    -0.3V to 5.3V                            1 pA
 MCP601/2/3/4                   2.8 MHz                  2.3                    -0.3V to 3.8V                            1 pA
 MCP6281/2/3/4                   5 MHz                   2.5                    -0.3V to 5.3V                            1 pA
 MCP6021/2/3/4                  10 MHz                   7.0                    -0.3V to 5.3V                            1 pA
 MCP6291/2/3/4                  10 MHz                   7.0                    -0.3V to 5.3V                            1 pA
 Table 1: The four basic specifications shown will guide you in selecting the correct op amp for your low-pass filter.




 24
                                                                                       Analog and Interface Guide – Volume 1
    Analog Design Notes

Ease Into The Flexible CANbus Network
CANbus networks have been around for over 15 years. Initially            The winning transmitter will continue to send its message as
this bus was targeted at automotive applications, requiring              if nothing happened. Response time to collision resolution is
predictable, error-free communications. Recent falling prices of         faster because the correction occurs at the beginning of the
CAN (Controller Area Network) system technologies have made              transmission during arbitration of a message and the high priority
it a commodity item. The CANbus network has expanded past                message is not destroyed.
automotive applications. It is now migrating into systems like           The CANbus network specification, written by Bosch, has been
industrial networks, medical equipment, railway signaling and            standardized by ISO and SAE. The entire CAN specification
controlling building services (to name a few). These applications        is standardized in ISO 11898-1. ISO 11898-2 contains the
are utilizing the CANbus network, not only because of the lower          CAN physical layer specification. The CAN specification is not
cost, but because the communication that is achieved through             completely standardized in the SAE specification.
this network is robust, at a bit rate of up to 1 Mbits/sec.
                                                                         CANbus communication is achieved using message frames. The
A CANbus network features a multi-master system that                     three types of frames are data, remote and error. Each frame
broadcasts transmissions to all of the nodes in the system. In           has internal fields that define the type of frame that is being
this type of network, each node filters out unwanted messages.           sent and then provides the pertinent information. For instance,
A classical client/server network (such as Ethernet) relies on           a data frame is constructed with 6 fields: arbitration, control,
network addressing to deliver data to a single node. If multiple         data, CRC (Cyclic Redundancy Check), acknowledge and end-of-
nodes exist in this network, a star configuration implements a           frame. During transmission, the arbitration field is used by every
centralized control (Figure 1). Fewer microcontrollers are needed        node on the network to identify and/or resolve collisions. The
to perform the varied tasks, but the MCUs are usually more               arbitration field is also used to identify the message type and
complex with higher pin counts.                                          destination. The control frame defines the data frame length. The
In contrast, every node in a CAN system receives the same                data frame contains data and has the specified number of bytes
data at the same time. By default, CAN is message-based, not             per the control frame. The CRC frame is used to check for data
address-based. Multiple nodes are integrated in the system               errors. And finally, every transmission requires an acknowledge
using a distributed control implementation (Figure 1). One of the        frame from all of the receivers on the CAN network.
advantages of this topology is that nodes can easily be added            In the CAN network multi-master environment, nodes can be
or removed with minimal software impact. The CAN network                 added or removed without significant consequence to the
requires intelligence on each node, but the level of intelligence        operation and reliability of the system. An example of a single
can be tailored to the task at that node. Consequently, these            node for a CAN network is shown in Figure 2. In this diagram,
individual controllers are usually simpler, with lower pin counts.       pressure is measured using a Motorola® pressure sensor,
The CAN network also has higher reliability by using distributed         MPX2100AP. The differential output voltage of this sensor is
intelligence and fewer wires.                                            gained by a discrete instrumentation amplifier and filtered by a
Ethernet differs from CAN in that Ethernet uses collision                fourth order, low pass, active filter. The signal is then converted
detection at the end of the transmission. At the beginning of the        to a digital code with a 12-bit A/D converter, MCP3201. The
transmission, CAN uses collision detection with resolution. When         receiving microcontroller sends the data to the CAN controller.
a collision occurs during arbitration between two or more CAN            The common language between the nodes is generated and
nodes that transmit at the same time, the node(s) with the lower         maintained by the CAN controller and the voltage compliance to
priority message(s) will detect the collision. The lower priority        the network is managed by the CAN driver.
node(s) will then switch to receiver mode and wait for the next
bus idle to attempt transmission again.




Figure 1: For multi-task networks, a Centralized Network is usually used for Ethernet systems. If a node is added to this system, the system
MCU could require significant modifications. With CAN networks, the Distributed Network is implemented. A node can easily be added or
taken out of the system with minimal firmware changes.




                                                                                                                                         25
Analog and Interface Guide – Volume 1
      Analog Design Notes
Each node in a CAN network can perform a unique function.               This serial communications protocol supports distributed
Although Figure 2 illustrates a pressure sensing system, other          real-time control with a sophisticated level of security. The
types of systems can complement your application. Additionally,         CANbus time-proven performance ensures predictable error-free
this block diagram of a CAN node can be implemented                     communications for safety conscious application environments.
in a variety of ways. For instance, in the initial build, the           It is able, through arbitration, to prioritize messages. The
microcontroller could have the CAN controller integrated on-chip.       configuration is flexible at the hardware, as well as the data link
At a later date, nodes can easily be added with minimal software        layer, where many of the transmission details can be modified
impact. When you are ready to add, enhance or build a small             by the designer. This is done, while at the same time there is
stand-alone network, the combination of an MCP2515 with a               system-wide data consistency.
simple microcontroller would be a good choice.
                                                                        Recommended References
The MCP2515 stand-alone CAN controller implements version
2.0B of the CAN specification. It is capable of transmitting and        AN212 “SmartSensor® CAN Node Using the MCP2510 and
receiving both standard and extended data and remote frames.            PIC16F876”, Stanczyk, Mike, Microchip Technology Inc.
The MCP2515 has two acceptance masks and six acceptance                 AN228 “A Physical Layer Discussion”, Richards, Pat, Microchip
filters that are used to remove unwanted messages. The 4-wire           Technology Inc.
interface between the MCP2515 and the controller is SPI™.               AN754 “Understanding Microchip’s CAN Module Bit Timing”,
The MCU pins used for SPI can be recovered if the MCP2515               Richards, Pat, Microchip Technology Inc.
RXnBF pins are configured as GP output and the TXnRTS pins are
configured as GP input.                                                 “High-Speed CAN Transceiver”, Microchip MCP2551 product data
                                                                        sheet, DS21667
The MCP2515 has three main blocks:
                                                                        “Stand-Alone CAN Controller with SPI™ Interface”, Microchip
1. The CAN module, which includes the CAN protocol engine,              MCP2515 product data sheet, DS21801
masks, filters, transmits and receives buffers
                                                                        “Wireless CAN Yard Lamp Control”, Dammeyer, John, Circuit
2. The control logic and registers that are used to configure the       Cellar, August 2003, page 12
device and its operation
3. The SPI protocol block
Typically, each node in a CAN system must have a device to
convert the digital signals generated by a CAN controller, to
signals suitable for transmission over the bus cabling. The device
also provides a buffer between the CAN controller and the high-
voltage spikes that can be generated on the CANbus by outside
sources (EMI, ESD, electrical transients, etc.). The MCP2551
high-speed CAN, fault-tolerant device provides the interface
between a CAN protocol controller and the physical bus. The
MCP2551 has differential transmit and receive capability
for the CAN protocol controller and is fully compatible with the
ISO 11898 standard, including 24V requirements. It will also
operate at speeds of up to 1 Mbits/sec.




Figure 2: This is an example of a single node for a CAN network. All of the elements for appropriate communication on the network are
implemented through the CAN driver (MCP2551), CAN controller (MCP2515) and the microcontroller.




 26
                         Analog and Interface Guide – Volume 1
   Analog Design Notes

Notes:




                                                           27
Analog and Interface Guide – Volume 1
     Analog Design Notes

Notes:




28
                                                                               Analog and Interface Guide – Volume 1
   Analog Design Notes

Analog and Interface Attributes
Robustness                                                         Space Savings
 MOSFET Drivers lead the industry in latch-up                      Resets and LDOs in SC70, A/D converters in a 5-lead
   immunity/stability                                                SOT-23 package
Low Power/Low Voltage                                               CAN and IrDA® Standard protocol stack embedded in an
 Op Amp family with the lowest power for a given gain               18-pin package
   bandwidth                                                       Accuracy
 600 nA/1.4V/14 kHz bandwidth Op Amps                              Offset trimmed after packaging using non-volatile
 1.8V charge pumps and comparators                                  memory
 Lowest power 12-bit ADC in a SOT-23 package                      Innovation
Integration                                                         Low pin-count embedded IrDA Standard stack,
                                                                     FanSense™ technology
 One of the first to market with integrated LDO with
   Reset and Fan Controller with temperature sensor                 Select Mode™ operation
 PGA integrates MUX, resistive ladder, gain switches,             For more information, visit the Microchip web site at:
   high-performance amplifier, SPI™ interface                      www.microchip.com/analogtools


Analog and Interface Products
                 Thermal         Power
                 Management      Management            Interface               Mixed-Signal      Linear
                  Temperature     LDO & Switching        CAN Peripherals        A/D Converter     Op Amps
                  Sensors         Regulators                                    Families
                                                         Infrared                                 Programmable
                  Fan Speed       Charge Pump            Peripherals            Digital           Gain
                  Controllers/    DC/DC Converters                              Potentiometers    Amplifiers
                  Fan Fault                              LIN Transceiver
                  Detectors       Power MOSFET                                  D/A Converters    Comparators
                                  Drivers                Serial Peripherals
                                                                                V/F and F/V       Linear
                                  PWM Controllers        Ethernet Controller    Converters        Integrated
                                  System Supervisors                            Energy            Devices
                                                                                Measurement
                                  Voltage Dectectors                            ICs
                                  Voltage References

                                 Battery
                                 Management
                                  Li-Ion/Li-Polymer
                                  Battery Chargers
                                  Smart Battery
                                  Managers




                                                                                                                     29
Worldwide Sales and Service
At Microchip, we know that it takes more than product specifications to
create loyal customers. In addition to a broad product portfolio, we understand
the value of a complete design solution. That’s why we maintain a worldwide
network of sales and support. Our global network of experienced field application
engineers and technical support personnel are ready to provide product and
system assistance to help you further streamline your design, prototype and
production activities.




Sales Office Listing
Technical Support: http://support.microchip.com

AMERICAS                                             ASIA/PACIFIC                                              ASIA/PACIFIC                                          EUROPE
Atlanta                                              Australia - Sydney                                        India - Bangalore                                     Austria - Weis
Tel: 770-640-0034                                    Tel: 61-2-9868-6733                                       Tel: 91-80-2229-0061                                  Tel: 43-7242-2244-399
Boston                                               China - Beijing                                           India - New Delhi                                     Denmark - Copenhagen
Tel: 774-760-0087                                    Tel: 86-10-8528-2100                                      Tel: 91-11-5160-8631                                  Tel: 45-4450-2828
Chicago                                                                                                                                                              France - Paris
                                                     China - Chengdu                                           India - Pune
Tel: 630-285-0071                                                                                                                                                    Tel: 33-1-69-53-63-20
                                                     Tel: 86-28-8676-6200                                      Tel: 91-20-2566-1512
Dallas
Tel: 972-818-7423                                    China - Fuzhou                                            Japan - Yokohama                                      Germany - Munich
Detroit                                              Tel: 86-591-8750-3506                                     Tel: 81-45-471- 6166                                  Tel: 49-89-627-144-0
Tel: 248-538-2250                                    China - Hong Kong SAR                                     Korea - Gumi                                          Italy - Milan
Kokomo                                               Tel: 852-2401-1200                                        Tel: 82-54-473-4301                                   Tel: 39-0331-742611
Tel: 765-864-8360                                    China - Qingdao                                           Korea - Seoul                                         Netherlands - Drunen
Los Angeles                                          Tel: 86-532-8502-7355                                     Tel: 82-2-554-7200                                    Tel: 31-416-690399
Tel: 949-462-9523                                    China - Shanghai                                          Malaysia - Penang                                     Spain - Madrid
San Jose                                             Tel: 86-21-5407-5533                                      Tel: 604-646-8870                                     Tel: 34-91-352-30-52
Tel: 650-215-1444                                                                                                                                                    UK - Wokingham
                                                     China - Shenyang                                          Philippines - Manila
Toronto                                                                                                                                                              Tel: 44-118-921-5869
                                                     Tel: 86-24-2334-2829                                      Tel: 632-634-9065
Mississauga, Ontario
Tel: 905-673-0699                                    China - Shenzhen                                          Singapore
                                                     Tel: 86-755-8203-2660                                     Tel: 65-6334-8870
                                                     China - Shunde                                            Taiwan - Hsin Chu
                                                     Tel: 86-757-2839-5507                                     Tel: 886-3-572-9526
                                                     China - Wuhan                                             Taiwan - Kaohsiung
                                                     Tel: 86-27-5980-5300                                      Tel: 886-7-536-4818
                                                     China - Xian                                              Taiwan - Taipei
                                                     Tel: 86-29-8833-7250                                      Tel: 886-2-2500-6610
                                                                                                               Thailand - Bangkok
                                                                                                               Tel: 66-2-694-1351




                                                                             www.microchip.com
                                         Microchip Technology Inc. • 2355 W. Chandler Blvd. • Chandler, AZ 85224-6199



The Microchip name and logo, the Microchip logo, PIC and PICmicro are registered trademarks of Microchip Technology Incorporated in the U.S.A. and other countries. FilterLab is a registered trademark of
Microchip Technology Incorporated in the U.S.A. FanSense and Select Mode are trademarks of Microchip Technology Incorporated in the U.S.A. and other countries. All other trademarks mentioned herein
are property of their respective companies. © 2005, Microchip Technology Incorporated, All Rights Reserved. Printed in the U.S.A. 9/05                                                           DS00924B


                                                                                                                                                                  *DS00924B*


==========================================
FILE: 2023_Signal-Power-Integrity-Guide.pdf
==========================================

PRESENTED BY
                                                  2023
                                                  SIGNAL & POWER
                                                  INTEGRITY GUIDE




  INTERFERENCE TECHNOLOGY GUIDE SERIES | interferencetechnology.com

                          © Copyright 2023 Interference Technology
This is How You Reduce
Testing Time by More Than 50%
With regulatory adoption of multiple signal
radiated immunity test methods (IEC-61000-
4-3:2020, 4th edition), AR’s Multi-Tone System
enables you to vastly reduce your test times
in accordance with automotive, commercial,
and aviation EMC RI standards. Included is AR’s
proprietary emcware® software, offering users
numerous test and calibration routines utilizing
multiple signal methodology, to meet
these standards.
For example, AR’s Multi-Tone System can reduce
the typical time to run traditional tests such as IEC
61000-4-3, ISO 11451, and ISO 11452, by over 50%.
In the event of an EUT failure, margin investigation
and traditional single tone testing is easily
performed through AR’s emcware® software.


      Duration of Typical Radiated Immunity Testing

            8 Hours




                                                                   Radiated
                                                                   Immunity
                                                                   Testing
                                                                   Set up
                                         3.5 Hours

            6 Hours                      1.5 Hours



            2 Hours                       2 Hours


  Traditional Testing Method      AR Multi-Tone System



Multiple full sweeps are often required during
mitigation efforts, which is where the multiple
signal approach will pay dividends.
This is a creative way to help your company
be more profitable by using your assets
more efficiently.

Visit us at www.arworld.us or call 215-723-8181.
Talk to an applications engineer at 800.933.8181.




ar rf/microwave instrumentation   ar modular rf      sunar   ar europe        We’re with you all the way
TABLE OF CONTENTS

       4          TECHNICAL EDITORIAL BOARD MEMBERS


       6          FEATURED ARTICLES

                  6    Top Three EMI and Power Integrity Problems with On-Board
                       DC-DC Converters and LDO Regulators
                       KENNETH WYATT
                       Wyatt Technical Services LLC

                       STEVE SANDLER
                       Picotest Systems, Inc.

                  12 Power Integrity Overview for PCB Designers
                     ZACH PETERSON
                     Northwest Engineering Solutions


       16         INDEX OF ADVERTISERS




interferencetechnology.com                      | 3 |   Interference Technology Guide Series
TECHNICAL EDITORIAL BOARD MEMBERS
Meet the 2023 Editorial Board

                     GHERY PETTIT | PRESIDENT, PETTIT EMC CONSULTING LLC

                     Ghery S. Pettit received the BSEE degree from Washington State University in 1975. He has
                     worked in the areas of TEMPEST and EMC for the past 47 years. Employers were the US Navy,
                     Martin Marietta Denver Aerospace, Tandem Computers and Intel Corporation, prior to retiring
                     from industry in 2015 and becoming an independent consultant.

                      Mr. Pettit is presently serving as Chair of CISPR SC I and is one of CISPR’s representatives on
                      the Advisory Council on EMC (ACEC) within the IEC. He has been involved in CISPR activities
                      since 1998, both as a member of the US Technical Advisory Groups to CISPR SC G and CISPR
SC I and as an active member of CISPR SC I and its maintenance teams, CISPR SC I MT7 (CISPR 32 maintenance) and
CISPR SC I MT8 (CISPR 35 maintenance). He is also a member of the working groups preparing the next editions of
ANSI C63.4, C63.9 and C63.16.




                      ZACHARIAH PETERSON | NORTHWEST ENGINEERING SOLUTIONS

                     Zachariah Peterson received multiple degrees in physics from Southern Oregon University
                     and Portland State University, and he received his MBA from Adams State University. In 2011,
                     he began teaching at Portland State University while working towards his Ph.D. in Applied
                     Physics. His research work originally focused on topics in random lasers, electromagnetics in
                     random materials, metal oxide semiconductors, sensors, and select topics in laser physics;
                     he has also published over a dozen peer reviewed papers and proceedings. Following his
                     time in academia, he began working in the PCB industry as a designer and technical content
                     creator. As a designer, his experience focuses on high-speed digital systems and RF systems
for commercial and mil-aero applications. His company also produces technical content for major CAD vendors and
consults on technology strategies for these clients. In total, he has produced over 2,000 technical articles on PCB
design, manufacturing, simulation, modeling, and analysis. Most recently, he began working as CTO of Thintronics,
an innovative PCB materials startup focusing on high-speed, high-density systems.

He is a member of IEEE Photonics Society, IEEE Electronics Packaging Society, American Physical Society, and the
Printed Circuit Engineering Association (PCEA). He previously served as a voting member on the INCITS Quantum
Computing Technical Advisory Committee working on technical standards for quantum computing and quantum
electronics. He now sits on the IEEE P3186 Working Group focused on Port Interface Representing Photonic Signals
Using SPICE-class Circuit Simulators.




interferencetechnology.com                             | 4 |                 Interference Technology Guide Series
TECHNICAL EDITORIAL BOARD MEMBERS
Meet the 2023 Editorial Board

                    MIKE VIOLETTE | iNARTE CERTIFIED EMC ENGINEER

                    Mike is President of Washington Laboratories and Director of American Certification Body. He
                    has over 35 years of experience in the field of EMC evaluation and product approvals and has
                    overseen the development of engineering services companies in the US, Europe and Asia. Mike
                    is currently on the Board of Directors of the IEEE EMC Society.

                    He is a Professional Engineer, registered in the State of Virginia. He has given numerous
                    presentations on compliance topics and is a regular contributor to technical and trade magazines.




                    DAVID A. WESTON | iNARTE EMC ENGINEER

                    David A. Weston is an electromagnetic compatibility (EMC) consultant and certified National
                    Association of Radio and Telecommunications Engineers (iNARTE) EMC engineer at EMC
                    Consulting Inc. Merrickville, Ontario, Canada. A life member of the Institute of Electrical and
                    Electronics Engineers, Weston has worked in electronic design for 55 years, specializing in
                    the control, prediction, measurements, problem solving, analysis, and design aspects of EMC
                    for the last 44 years.

                    He is the author of the third edition of the 1,157-page book Electromagnetic Compatibility,
Methods, Analysis, Circuits, and Measurement published by CRC press in 2017, as well as numerous papers of a
practical nature.




interferencetechnology.com                             | 5 |                Interference Technology Guide Series
2023 SIGNAL & POWER INTEGRITY GUIDE




TOP THREE EMI AND POWER INTEGRITY
PROBLEMS WITH ON-BOARD DC-DC
CONVERTERS AND LDO REGULATORS

Kenneth Wyatt
Wyatt Technical Services LLC

Steve Sandler
Picotest Systems, Inc.



Modern devices are continuing a long-term trend of squeezing more electronics into smaller packages, while also
increasing system performance, data rates and operating efficiency. Higher efficiencies are often achieved by imple-
menting faster silicon MOSFETs or even faster eGaN FETs while size is reduced by increasing switching frequencies
and replacing aluminum and tantalum capacitors with smaller ceramic devices. One result of this trend is that there is
greater interaction between the disciplines of EMI, signal integrity (SI) and power integrity (PI).




interferencetechnology.com                              | 6 |                 Interference Technology Guide Series
2023 SIGNAL & POWER INTEGRITY GUIDE

INTRODUCTION
EMI is a measure of the electromagnetic emissions
produced by the high-speed current and voltage signals
the system creates. Power integrity is a measure of the
power quality at the device that being powered. This
means that the power supply voltages must be maintained
within the allowable operating voltage range of high-speed
devices.

Devices, such as modems, reference clocks and low noise      Figure 1. Diagram showing the measuring point at the switch device junction (on the left
amplifiers (LNAs) are all sensitive to noise on the power    side of L1) to ground return.
rails, which results in timing jitter, spurious responses
reduced data channel eye openings, and degraded
signal-to-noise ratio (SNR). This too, is a measure of       There was a very large ringing superimposed on the
power integrity.                                             switched waveform of 216 MHz. This can be seen clearly
                                                             in Figure 2.
The power supply itself is a noise source and the noise
sources generated by the power supply must be kept           A Fischer Custom Communications F-33-1 current probe
from propagating through the system.                         was used to measure both the input power cable common
                                                             mode current (violet trace) and output load differential
This article discusses the three most common causes of       mode current (aqua trace). See Figure 3. Note the broad
EMI and power integrity issues while providing tips for      resonant peaks at 216 MHz (marker 1) and the second
how to avoid or minimizes them in your design,               harmonic at 438 MHz (marker 2).
   1. Ringing on switched waveforms causes broad
      resonant peaks in the emission spectrum.
   2. DC-DC converters generate noise at the
      switching frequency, and because of high speed
      switching devices, can generate broadband
      switching harmonics well into the GHz.
   3. Power plane resonance in DC-DC converter
      or LDO regulators due to high-Q capacitors
      resonating with power planes.

RINGING AND RADIATED EMISSIONS
Any ringing on the switched waveform (fairly common)
can lead to broadband resonances in the resulting RF
spectrum. Resonant frequencies resulting from DC-DC          Figure 2. Measuring the rise time and ringing on a DC-DC converter. Notice to strong
converters or low dropout (LDO) linear regulators can        ringing at 216 MHz.
be as low as a few kHz while resonance due to the PDN
with switching devices, such as MOSFET’s can be in
hundreds of MHz or higher.

The harmonic energy resulting from this switching is
“captured” by the PDN and device resonances, evident
as ringing in the time domain. The current and voltage
of this ringing produces EMI. The magnitudes of the
ringing and EMI are related to the quality factor (Q)
and characteristic impedance of the resonance and the
harmonic energy produced by the switching.

As an example, the switching waveform on a DC-DC
buck converter demo board was measured with a Rohde
& Schwarz RTE 1104 oscilloscope and Rohde & Schwarz          Figure 3. Resulting resonances from the 216 MHz ring frequency (marker 1) and second
RT-ZS20 1.5 GHz active probe (Figure 1).                     harmonic at 438 MHz (marker 2).




interferencetechnology.com                               | 7 |                         Interference Technology Guide Series
2023 SIGNAL & POWER INTEGRITY GUIDE

Remediation Tips - There are several ways to improve                                Figure 5 shows the resulting measurement of a couple
the design to minimize the resonances, ringing and                                  DC-DC converters. The yellow trace is the ambient noise
therefore EMI. Since the energy is related to the switching                         floor of the measurement system and is always a good
frequency, rise time of the switching, characteristic                               idea to record for reference. The aqua and violet traces
impedance, and Q of the resonances, these factors are                               are the two converter measurements. Note that both
also the paths to mitigation.                                                       produce broadband noise currents out to 1 GHz, with the
                                                                                    convertor in violet out to beyond 1.5 GHz. Note the violet
    • Slower edges will degrade operating efficiency but                            trace is 20 to 50 dB higher than the ambient noise floor.
      reduce high frequency energy
    • Careful PCB design and capacitor selection will
      minimize the characteristic impedance and Q
    • Keep traces short and wide and dielectrics thin.
    • Keep all the switching circuitry on one side of
      the board, preferably with a thin dielectric to the
      respective ground return plane.
    • Use of a snubber circuit, damping of resonances
      using controlled ESR capacitors, or redesign of
      the inductor for lower leakage inductance.

For additional detail on measuring ringing refer to
Reference 1.
                                                                                    Figure 5. In this example, we’re looking from 30 MHz to 1.5 GHz to generally characterize
FAST EDGES CREATE BROADBAND NOISE AT GHz                                            the spectral emissions profile of a couple of on-board DC-DC converters. Both will potential-
FREQUENCIES                                                                         ly cause interference to mobile phone bands in the 700 to 950 MHz region. The one with
Today’s on-board DC-DC converters use switching                                     the violet trace is over 30 dB above the ambient noise level in the mobile phone band.
frequencies as high as 3 MHz. This is an advantage
because it allows for physically smaller inductor and filter                        Remediation Tips – To reduce the risk of self-interfer-
components, as well as increased efficiency. However,                               ence to on-board mobile phone modems and wireless
the fast edge speeds create broadband harmonic                                      systems, the product design must start off with EMC in
energy. The bandwidth of this harmonic energy is related                            mind and with no corners cut.
to the voltage and current rise time. A 1ns edge speed
can produce harmonic energy up to 3 GHz, or more.
                                                                                    This will consist of:
These broadband harmonics are the cause of radiated
emissions failures and also can affect the receiver                                     •    A near perfect PC board layout
sensitivity of any on-board telephone modems or other                                   •    Filtering of DC-DC converters
wireless systems, such as GPS. Figure 4 shows how                                       •    Filtering of any high frequency device
a typical DC-DC converter circuit can be characterized                                  •    Filtering of the radio module
using an H-field probe connected to a spectrum analyzer.                                •    Local shielding around high noise areas
                                                                                        •    Possibly shielding the entire product
It’s also possible to connect the probe to an oscilloscope                              •    Proper antenna placement
and hold it near each DC-DC converter to get some idea
of the ringing, if any, without disturbing the circuit.                             The PC board layout is critical and is where most of
                                                                                    your effort should reside. An eight or ten layer stack-up
                                                                                    will provide the most flexibility in segregating the power
                                                                                    supply, analog, digital, and radio sections and provide
                                                                                    multiple ground return planes, which may be stitched
                                                                                    together around the board edge to form a Faraday cage.
                                                                                    Care must be taken to avoid return current contamination
                                                                                    between sections – especially in the ground return
                                                                                    planes. For wireless products, the power plane for the
                                                                                    radio modem section should be isolated (except via a
                                                                                    narrow bridge) from the digital power plane. All traces
                                                                                    to this isolated plane should pass over the bridge
                                                                                    connecting the two. This can provide up to 40 dB of
Figure 4. Probing DC-DC converter noise sources on a typical wireless device.       isolation between the digital circuitry and radio.



interferencetechnology.com                                                      | 8 |                          Interference Technology Guide Series
2023 SIGNAL & POWER INTEGRITY GUIDE

It is vital that the power and ground return planes be on                       A short video helps explain the basic principles of PDN
adjacent layers and ideally 3-4 mils apart at the most.                         design (Reference 5). The radiated EMI of a LTC3880
This will provide the best high frequency bypassing. All                        DC-DC converter measured near the input plane using
signal layers should be adjacent to at least one solid                          an H-field probe is seen in Figure 6.
ground return plane. Clock, or other high-speed traces,
should avoid passing through vias and should not                                The 163 MHz is attributed to the ringing of the switches
change reference planes.                                                        as seen in Figure 7. This ringing is caused by the
                                                                                inductance of the upper MOSFET bond wires, pins and
Power supply sections should be well isolated from                              circuit board planes, ringing with the lower MOSFET
sensitive analog or radio circuitry (including antennas).                       and PC board capacitance.
Be aware of primary and secondary current loops and
their return currents. These return currents should not
share the same return plane paths as digital, analog,
or radio circuits. Remember that high frequency return
currents want to return to the source directly under the
source trace.

For more details on resolving DC-DC converter noise
issues with wireless radio modems, refer to Reference 2.

PC BOARD PLANE RESONANCE AND THE EFFECT
ON RADIATED EMISSIONS
Noise propagation in a simple system can be represented
by three elements, the voltage regulator, the printed                           Figure 7. The 163 MHz EMI is easily explained by the ringing at the switch device, as
circuit board planes with decoupling capacitors (PDN)                           discussed earlier.
and the device being powered (load).

Each of these three elements is comprised of resistive,                         The input ceramic decoupling capacitor resonates at
inductive and capacitive terms. Even “noise free”                               approximately 30 MHz, as seen in Figure 8 and results
low dropout (LDO) regulators can be highly inductive                            in the large 30 MHz EMI signature.
(Reference 3). The resistive, inductive and capacitive
terms can resonate amplifying the noise signals created
by the power supply and the load as they travel across
the PDN creating EMI. The harmonics of the switching
frequency and the switch ringing discussed earlier
excite these PDN resonances (Reference 4). As stated
previously this noise can degrade and interfere with on-
board wireless modems, as well as resulting radiated
and conducted emissions.



                                                                                Figure 8. The larger 30 MHz emission is identified as a printed circuit board resonance
                                                                                using an H-field probe and confirmed by a 1-port reflection impedance measurement at
                                                                                the input capacitor.


                                                                                The input power plane section of the DC-DC converter
                                                                                (measured in Figure 6) is shown in Figure 9 with
                                                                                schematic representations of the component, PC board
                                                                                and external connections.



Figure 6. Spectrum analyzer display showing the 30 MHz and 160 MHz resonances
detected near the input power connections of a DC-DC converter.




interferencetechnology.com                                                  | 9 |                         Interference Technology Guide Series
2023 SIGNAL & POWER INTEGRITY GUIDE




                                                                                          Figure 11. The large round pins on the left are the input power connector, J2. The larger
Figure 9. The power plane section of the DC-DC converter (measured in Figure 6) with
                                                                                          capacitor on the top side is an 0805 sized 47 μF and the smaller capacitor on the bottom
schematic representations of the component, PC board and external connections.
                                                                                          side is an 0603 sized 0.1 μF.

A very simple simulation example can be used to illustrate
these impedance resonance effects. Consider a simple
DC-DC converter as shown in Figure 10.




                                                                                          Figure 12. Spectral simulation of the input power lead shows the high Q ceramic (10 mΩ
                                                                                          blue) has a clear peak near 10 MHz that is eliminated using a controlled ESR ceramic
Figure 10. A simple DC-DC converter for illustration of plane resonance EMI. The “FET”    (200 mΩ red)
switches include lead inductance and drain capacitance (Coss). A small PC board and two
ceramic capacitors are included.
                                                                                          The simulated impedance, measured at the smaller
                                                                                          capacitor in Figure 13 shows the corresponding plane
Designers frequently place the FET switches on one side                                   resonance with a clear 10 MHz peak using the high Q
of the board with power entry on the opposite side of the                                 ceramic capacitor (blue) and the peak is eliminated using
PC board. The small PC board plane used in this example                                   the controller ESR ceramic capacitor (red).
has power entry through a pair of pins and no interconnect
inductance is added to connect power to the PC board. A
large 47 μF ceramic capacitor is placed on the top side of
the PC board, while a smaller, 0.1 μF ceramic capacitor is
placed very close to the FET switches on the bottom side
of the PC board. Two parallel vias connect power and
ground from the top side of the PC board to the bottom
side as seen in Figure 11.

The simple model is used to simulate the harmonic
current in the input connector, which is directly related to
conducted and radiated emissions. Two simulations are
performed; one with low ESR ceramic capacitors and the
other with a lower Q controlled ESR ceramic replacing                                     Figure 13. The simulated impedance at the 0.1 uF capacitor using high Q ceramic (10 mΩ
the 0.1 μF capacitor close to the FET switches. Both                                      blue) and a controlled ESR ceramic (200 mΩ red)
simulations are shown together in Figure 12.



interferencetechnology.com                                                          | 10 |                         Interference Technology Guide Series
2023 SIGNAL & POWER INTEGRITY GUIDE

Remediation Tips – To minimize PDN resonances, the            speed circuits. The design of the circuit board and
complete system of voltage regulator, PDN and the load        capacitor decoupling always involves trade-offs, but the
need to be carefully balanced. Damping resistance must        impacts on resonances need to be weighed carefully.
be included to eliminate or minimize the existence or Q       A multi-frequency harmonic comb generator can be
of resonances. This will consist of:                          extremely helpful for quickly identifying PDN resonances
                                                              (Reference 3).
     • Short, wide power planes
     • Keep the layout as small as possible to minimize       SUMMARY
       inductance                                             As you can see, designing DC-DC converters, LDOs,
     • Thinner PC board dielectric layers, closer to the      and PDNs with today’s high-speed technology nearly
       surface                                                always requires careful circuit design, adequate filtering,
     • Incorporate EM simulation to identify and minimize     simulation of the PDN, very careful circuit board layout,
       PDN resonances                                         and use of controlled-ESR filter capacitors. Poor designs
     • Keep capacitors on one side of the PC board to         can result in:
       the extent possible
     • Low-Q or ESR controlled capacitors reduce Q                • Ringing in power supply switches (or other fast-
     • Choose voltage regulators and output capacitors              edged digital switching) resulting in associated
       for good control loop stability                              radiated or conducted emissions resonant peaks
     • Don’t place cutouts or holes in ground plane                 at the ring frequency and harmonics.
       layers below the power plane                               • High frequency broadband noise well beyond
     • Ferrite beads are a very common cause of PDN                 1 GHz, resulting in self-interference to radio
       resonances                                                   modems.
     • Be aware of inductive interconnects bringing               • Poor stability and resonances in un-damped
       power to the system.                                         power distribution networks, leading to instability,
                                                                    spectral resonances, and associated radiated and
Printed circuit board design and decoupling is critical             conducted emissions.
and “rules-of-thumb” generally don’t work well in high




REFERENCES
1.    Wyatt, GaN Technology and the Potential for EMI (EDN), http://www.edn.com/electronics-blogs/the-emc-
      blog/4439839/GaN-technology-and-the-potential-for-EMI
2.    Wyatt, Platform Interference (EDN), http://www.edn.com/electronics-blogs/the-emc-blog/4441086/Platform-interfer-
      ence
3.    Wyatt, Review: Picotest J2150A Harmonic Comb Generator http://www.edn.com/electronics-blogs/the-emc-
      blog/4440532/Review--Picotest-J2150A-harmonic-comb-generator
4.    Sandler, The Inductive Nature of Voltage Control Loops, http://www.edn.com/electronics-blogs/impedance-measure-
      ment-rescues/4438578/The-inductive-nature-of-voltage-control-loops
5.    Sandler, How to Design for Power Integrity: Finding Power Delivery Noise Problems (Video), https://www.youtube.
      com/watch?v=oL6qjhJH_m4&t=4s&list=PLtq84kH8xZ9HIYgBYDsP7TbqBpftidzI8&index=4




interferencetechnology.com                               | 11 |                 Interference Technology Guide Series
2023 SIGNAL & POWER INTEGRITY GUIDE




POWER INTEGRITY OVERVIEW FOR
PCB DESIGNERS
Zachariah Peterson
Owner, Northwest Engineering Solutions LLC




INTRODUCTION                                                   The result of such power rail and ground plane potential
Most PCB designers don’t realize they have a power             fluctuations includes signal integrity and EMI problems
integrity problem until that problem causes a board to         such as:
fail. Power integrity is also related to two other important
areas that repeatedly cause design failures: signal integ-     • Transient ringing seen on I/O signal levels
rity and EMI/EMC. In fact, some common signal integrity        • Jitter, observed in edge transitions in an eye diagram
problems are related to power integrity in that unstable       • Radiated emissions, which may be observed from the
power leads to signal level and timing fluctuations. In ad-      surface or board edge
dition, some EMI problems can be caused by excessive           • Noise transfer between poorly isolated rails with the
emissions by fast transients within a power system.              same voltage

To help PCB designers and systems engineers better             These problems can occur despite precise design and
overcome their power integrity problems, it’s important        layout of power regulator circuits. Of course, power reg-
first to know how power integrity can cause other prob-        ulators have their own noise challenges, but the noise
lems in a circuit board. This article will give an overview    observed on a power rail in a high-speed PCB is really a
of the power integrity problems more designers are ex-         low-impedance power delivery challenge, not a regulator
periencing in modern electronics systems and which will        noise challenge.
become more prevalent as devices reach greater feature
density in the near future.                                    OBSERVING POWER INTEGRITY
                                                               The effects of power integrity on power delivery can be
WHO WORRIES ABOUT POWER INTEGRITY?                             measured directly by looking at the voltage provided by
Generally, when we refer to power integrity, we refer to       a PDN in a PCB. Power is delivered to components by
AC power integrity, meaning time-varying changes in the        first charging up the capacitance in the PDN; the PDN
power being delivered to a load. DC power integrity is         then discharges some current through the I/O sup-
also important, but is more the domain of power elec-          ply when logic outputs switch states. Because modern
tronics rather than high-speed digital systems.                CMOS-based I/O buffers switch very quickly, they excite
                                                               a broadband transient in the PDN that exhibits an under-
The goal in designing for stable power integrity is to         damped oscillation in system voltage level.
minimize power fluctuations in a PCB as components
pull power from the power distribution network (PDN).          Power delivery instabilities can be seen in an oscillo-
The typical area where power integrity is important is in      scope trace. The image below shows just such a pow-
boards with many high-speed components, although to            er droop event occuring at the moment a certain IC
an extent the same challenge arises in high-frequency          switches its logic state with fast edge rate. The result-
systems. The reason power integrity arises so often in         ing voltage dropout in the rail is significant and ends
this system is due to the fast edge rates of digital sig-      with an underdamped oscillation. If this dropout is too
nals; generally any digital system with fast GPIOs, fast       large, it could exceed the lower power limit of compo-
SPI buses, and standardized computing peripherals can          nents that are drawing power from the PDN, causing
have power integrity problems.                                 system resets.




interferencetechnology.com                                | 12 |                Interference Technology Guide Series
2023 SIGNAL & POWER INTEGRITY GUIDE




Significant power droop observed on a 3V3 rail in a single-board computer.



With further probing throughout the PCB, it is possible                          An example PDN impedance spectrum with 1 mΩ tar-
to identify specific components that may have insuffi-                           get impedance is shown below. In this example, we can
cient decoupling/bypassing and investigate how these                             see each of the contributors in the PCB layout to the
are placed in the PCB. The other factor contributing to                          overall impedance (VRM, plane, and groups of decou-
unstable power delivery is the layer stackup in the PCB.                         pling capacitors). This model was generated analytically
Potential changes to a design can be qualified in simula-                        by considering the equivalent circuit parameters of the
tion to determine their efficacy.                                                structures that make up a PDN in a PCB (planes, vias,
                                                                                 traces, capacitor parasitics,VRM model). A more accu-
DESIGNING PDN IMPEDANCE                                                          rate PDN impedance spectrum could be generated us-
The impedance of the PDN in a PCB is actually a ma-                              ing a full-wave solver.
trix, with its members being self-impedances for each
power rail and transfer impedances between pow-
er rails. The typical concern in designing the PDN for
large processors requiring multiple rails is to ensure
the self-impedance for each rail is minimized through-
out some relevant bandwidth (typically extending up to
GHz frequencies).

In starting the PDN design process, the designer first
needs to formulate two metrics:

• An acceptable voltage ripple range based on noise
  margin
• A target impedance based on the expected maximum
  average current draw and allowed voltage ripple

As core voltages have decreased, being as low as 0.8
V in some components, the noise margin compresses
and this creates greater pressure on the PCB designer
to ensure lower PDN impedance.


interferencetechnology.com                                                   | 13 |              Interference Technology Guide Series
2023 SIGNAL & POWER INTEGRITY GUIDE




Transfer impedance is used to evaluate isolation be-          • Post-layout simulations using full-wave
tween different rails, where the focus is on evaluating         electromagnetic field solvers
how current draw at one port produces a voltage fluctu-
ation at all other ports. This takes a design-simulate-op-    SPICE-based models have always been phenomeno-
timize strategy at the circuit level, which can be done in    logical, although they are effective for evaluating compo-
SPICE. This would later be verified in the PCB layout         nents selection and isolation between power rails. Some
with a full-wave solver, producing an impedance curve         of the best EDA vendor tools are now reaching the point
similar to the example shown on page 22.                      where reduced full-wave simulations can be performed
                                                              directly from PCB layout data to evaluate signal integrity.
At the system level, we must also consider the on-die
PDN impedance, as well as any in-package capaci-              The primary quantity to simulate when designing a PCB
tance used to keep the on-die impedance low. Semi-            for stable power integrity is the PDN impedance. This
conductor packages can have highly inductive PDN              would typically be generated in the frequency domain
impedance at GHz frequencies, which leads to a large          using S-parameters or transfer functions, or it could be
peak (strong antiresonance) in the PDN impedance              examined in the time domain, where the voltage tran-
spectrum. In some cases, the best the PCB designer            sient on a power rail is used to determine the PDN’s im-
could do was load up on small-case decoupling capaci-         pulse response function. In either case, the goal is to
tors and excess plane capacitance through the stackup         examine the impedance of the PDN given a proposed
design methods shown above.                                   stackup and known decoupling capacitor counts.

Modern semiconductor packages, including multi-chip
modules and 2.5D/3D integrated packages, could in-
clude additional in-package capacitance to ensure lower
PDN impedance in the GHz range in order to ensure sta-
ble power delivery. An example low-impedance package
design methodology involving formation of grounded
grids surrounding through-silicon vias in a 3D package
is shown above.

SIMULATING POWER INTEGRITY
The board used to gather the image shown above was
built with best practices in terms of its stackup (adjacent
power/ground planes), but still the droop arises due to in-
sufficient capacitance in the PDN. These dropout events
are difficult to predict during the design phase as they      Example SPICE model generated in Altium Designer. This model includes a decoupling
require sophisticated simulations:                            capacitor bank, equivalent circuits for planes, and a simple switch to simulate current
                                                              draw by an integrated circuit.
• Pre-layout simulations using SPICE-based models


interferencetechnology.com                               | 14 |                         Interference Technology Guide Series
2023 SIGNAL & POWER INTEGRITY GUIDE




This example stackup, generated in Altium Designer, uses hybrid construction to support both high speed digital signals and RF signals. Based on layer thicknesses and Dk values, an
ideal place to put a power plane or large power rails would be on L5.




STACKUP AND MATERIALS MATTER                                                                 high Dk value and high loss tangent in order to provide
The best predictor of power integrity in a PCB is the de-                                    high capacitance and dampen any radiated emissions
sign of the stackup. The reason we care about the stack-                                     from the power-ground plane pair. These materials are
up is because it enables inclusion of plane capacitance                                      used in high layer count rigid or flex PCBs in mobile
through placement of an adjacent power-ground plane                                          devices, and in the newer substrate-like PCBs used in
pair. Modern processors operating with fast edge rates                                       modern smartphones.
need to have a power-ground plane pair with high plane
capacitance for two reasons:                                                                 SUMMARY
                                                                                             As more designers confront power integrity challenges in
1. To ensure low PDN impedance up to higher                                                  PCBs and packaging, EDA vendors have a role to play
   frequencies                                                                               in providing tools to iterate designs without repeated
2. To compensate for any lack of on-die/in-package                                           prototyping. The next generation of tools is providing an
   capacitance                                                                               in-app approach to design optimization without requiring
                                                                                             an external simulation program, including in the area of
Ensuring high plane capacitance requires placing the                                         signal and power integrity. As more simulation applica-
two planes close together on a thin core or prepreg                                          tion vendors form partnerships with EDA/ECAD vendors,
layer, and the separating dielectric must have high                                          we can expect these tool sets to expand to give more de-
dielectric constant. Together, this provides sufficient                                      signers advanced capabilities for design and simulation
capacitance and low spreading inductance which can                                           in the areas of power integrity, signal integrity, and EMI.
cause the plane’s impedance minimum to reach near
the GHz range.

To aid power integrity in smaller devices that require sig-
nificant power draw, some advanced materials vendors
supply embedded capacitance materials. These mate-
rials are very thin, being designed to separate the pow-
er-ground plane pair in the layer stack. They also have


interferencetechnology.com                                                           | 15 |                            Interference Technology Guide Series
2023 SIGNAL & POWER INTEGRITY GUIDE



INDEX OF ADVERTISERS




AR RF/Microwave Instrumentation   LECTRIX
t: (215) 723-8181                 t: (484) 688-0300
e: info@arworld.us                e: info@lectrixgroup.com
w: www.arworld.us                 w: www.lectrixgroup.com
page: 2                           page: 17




interferencetechnology.com                       | 16 |      Interference Technology Guide Series
2023 SIGNAL & POWER INTEGRITY GUIDE




Break the same old pattern.




                    Problem First. Product Last.
                             Strategy | Content | Data | Technology




                   Digital Marketing for the B2B Electronics Industry

                             1.484.688.0300 | info@lectrixgroup.com
                                      www.lectrixgroup.com
interferencetechnology.com                    | 17 |          Interference Technology Guide Series


==========================================
FILE: AN3962.pdf
==========================================

Freescale Semiconductor                                                                                                   AN3962
                                                                                                                  Rev. 2.0, 8/2010
Application Note




PCB Layout Design Guide for Analog
Applications
By: Edward Lee, Rafael Garcia Mora




1        Purpose                                                     Contents
                                                                     1    Purpose . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1
PCB Layout design is essential to better performance,
reliability and manufacturability. Malfunctions from poor heat       2 Scope . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1
dissipation and noise, which may hurt the system stability,
have become an increasing problem, and may therefore
                                                                     3 General Design Guide . . . . . . . . . . . . . . . . . . 2
generate more failures and reliability malfunctions in
production lines.
                                                                     4 Power ground seperation (Noise isolation). 9
In this document, several considerations and guidelines for
PCB layout design are discussed for better performance,              5 Thermal Considerations . . . . . . . . . . . . . . . 12
reliability, and manufacturability.
                                                                     6 References . . . . . . . . . . . . . . . . . . . . . . . . . . 15
2        Scope
This document discusses basics for layout, regulations,
methods of noise isolation, and thermal considerations.




© Freescale Semiconductor, Inc., 2009 - 2010. All rights reserved.
General Design Guides


3         General Design Guides
Producibility is related to the complexity of the design, and the specific printed board or printed board assembly.
There are three producibility levels:
     •    Class 1: General Electronic Products
     •    Class 2: Dedicated Service Electronic Products
     •    Class 3: High Reliability Electronic Product
Class 1 products include consumer products, computers and their peripherals, and general military hardware. Class
2 products include communication equipment, sophisticated business machines, instruments and military
equipment. Class 3 products include the equipment for commercial and military applications, where continued
performance, or performance on demand is critical.
The complexity levels are specified as:
     •    Level A: General Design Complexity (Preferred)
     •    Level B: Moderate Design Complexity (Standard)
     •    Level C: High Design Complexity (Reduced Producibility)
Table 1 shows the general layout guidance for different classes. (Class A: simple single level consumer products;
Class B: complex and multilevel general industrial products; Class C: high reliability medical and military products)


                                            Table 1. Composite Board Design Guidance
                      Guidance                                Class A                  Class B                    Class C
 Number of conductor layers (Maximum)                            6.0                      12                         20
 Thickness of the total board (Maximum)                   2.5 mm (0.100 in)        3.8 mm (0.150 in)          5.0 mm (0.200 in)
 Board thickness tolerance                              ± 10% above nominal      ± 10% above nominal        ± 10% above nominal
                                                        or 0.18 mm (0.007 in),   or 0.18 mm (0.007 in),     or 0.18 mm (0.007 in),
                                                         whichever is greater     whichever is greater       whichever is greater
 Thickness of dielectric (Minimum)                        0.2 mm (0.008 in)       0.15 mm (0.006 in)          0.1 mm (0.004 in)
 Minimum conductor width
  Internal                                                0.3 mm (0.012 in)        0.2 mm (0.008 in)          0.1 mm (0.004 in)
  External                                                0.4 mm (0.016 in)       0.25 mm (0.010 in)          0.1 mm (0.004 in)
 Conductor width tolerance
  Unplated 2.0 oz/ft2                                   +0.1 mm (0.004 in)       +0.05 mm (0.002 in)        +0.025 mm (0.001 in)
                                                        -0.15 mm (0.006 in)       -0.13 mm (0.005 in)        -0.08 mm (0.003 in)
    Unplated 1.0 oz/ft2                                 +0.05 mm (0.002 in)      +0.025 mm (0.001 in)       +0.025 mm (0.001 in)
                                                        -0.08 mm (0.003 in)       -0.05 mm (0.002 in)       -0.025 mm (0.001 in)
 Protective plated                                      +0.20 mm (0.008 in)      +0.10 mm (0.004 in)        +0.05 mm (0.002 in)
 (metallic etch resist over 2.0 oz/ft2 copper)          -0.15 mm (0.006 in)      -0.10 mm (0.004 in)        -0.05 mm (0.002 in)
 Minimum conductor spacing                                0.3 mm (0.012 in)        0.2 mm (0.008 in)          0.1 mm (0.004 in)
 Annular ring plated-through hole (minimum)
  Internal                                               0.20 mm (0.008 in)       0.13 mm (0.005 in)         0.05 mm (0.002 in)
  External                                               0.25 mm (0.010 in)       0.20 mm (0.008 in)         0.13 mm (0.005 in)
 Feature location tolerance (master pattern, material
 movement, and registration)
 (diameter of true position)
   Up to 300 mm (12.0 in)                                0.85 mm (0.034 in)       0.55 mm (0.022 in)         0.30 mm (0,012 in)
   Up to 450 mm (18.0 in)                                1.0 mm (0.040 in)        0.60 mm (0.024 in)         0.45 mm (0.018 in)
   Up to 600 mm (24.0 in)                                1.15 mm (0.046 in)       0.85 mm (0.034 in)         0.55 mm (0.022 in)




                                     PCB Layout Design Guide for Analog Applications, Rev. 2.0
2                                                                                                         Freescale Semiconductor
                                                                                                                  General Design Guides

                                          Table 1. Composite Board Design Guidance
                     Guidance                                       Class A                    Class B                      Class C
 Master pattern accuracy
 • Feature location (diameter of true position)
  Up to 300 mm (12.0 in)                                     0.10 mm (0.004 in)           0.08 mm (0.003 in)            0.05 mm (0.002 in)
  Up to 450 mm (18.0 in)                                     0.13 mm (0.005 in)           0.10 mm (0.004 in)            0.08 mm (0.003 in)
  Up to 600 mm (24.0 in)                                     0.15 mm (0.006 in)           0.13 mm (0.005 in)            0.10 mm (0.004 in)
 • Feature size tolerance                                    0.08 mm (0.003 in)           0.05 mm (0.002 in)         0.025 mm (0.001 in)
 Board thickness to plated hole diameter (maximum)                    3:1                        6:1                          10:1
 Hole location tolerance (diameter of true position)
  Up to 300 mm (12.0 in)                                     0.40 mm (0.016 in)           0.30 mm (0.012 in)            0.10 mm (0.004 in)
  Up to 450 mm (18.0 in)                                     0.50 mm (0.020 in)           0.40 mm (0.016 in)            0.20 mm (0.008 in)
  Up to 600 mm (24.0 in)                                     0.6 mm (0.024 in)            0.50 mm (0.020 in)            0.30 mm (0.012 in)
 Unplated hole diameter tolerance (unilateral)
  0.0 - 0.8 mm (0 - 0.032 in)                                0.16 mm (0.006 in)           0.10 mm (0.004 in)            0.06 mm (0.002 in)
  0.85 - 1.6 mm (0.033 - 0.063 in)                           0.20 mm (0.008 in)           0.16 mm (0.008 in)            0.10 mm (0.004 in)
  1.65 - 5.0 mm (0.064 -0.200 in)                            0.30 mm (0.012 in)           0.20 mm (0.008 in)            0.16 mm (0.006 in)
 Plated hole diameter tolerance (unilateral) for
 minimum hole diameter maximum board thickness
 ratios greater than 1:4 add 0.05 mm(0.002 in)
   0.0 - 0.8 mm (0 - 0.032 in)                               0.20 mm (0.008 in)           0.16 mm (0.006 in)            0.10 mm (0.004 in)
   0.85 - 1.6 mm (0.033 - 0.063 in)                          0.30 mm (0.012 in)           0.20 mm (0.008 in)            0.10 mm (0.004 in)
   1.65 - 5.0 mm (0.064 -0.200 in)                           0.40 mm (0.016 in)           0.30 mm (0.012 in)            0.20 mm (0.008 in)
 Conductor to edge of board (minimum)
  Internal layer                                              2.5 mm (0.100 in)           1.25 mm (0.050 in)            0.65 mm (0.025 in)
  External layer                                              2.5 mm (0.100 in)            2.5 mm (0.100 in)            2.5 mm (0.100 in)

 Notes
         1.The number of conductor layers should be the optimum for the required board function and good producibility.


When considering the producibility of the PCB, there are certain guidelines for layout. For example, when drilling
and plating through holes, there are limitations related to the hole size. Table 2, describes the recommended
minimum hole size for plated through holes.


                                    Table 2. Minimum Hole Size for Plated-Through Holes
                    Board Thickness                    Class 1                    Class 2                  Class 3
                    <1.0 mm(0.040 in)                   Level C                    Level C                  Level C
                                                        0.15 mm                    0.2 mm                   0.25 mm
                                                       (0.006 in)                 (0.008 in)               (0.010 in)
                    1.0 mm -> 1.6 mm                    Level C                    Level C                  Level B
                    (0.040 -> 0.063 in)                 0.2 mm                     0.25 mm                  0.3 mm
                                                       (0.008 in)                 (0.010 in)               (0.012 in)
                    1.6 mm -> 2.0 mm                    Level C                    Level B                  Level B
                    (0.053 -> 0.080 in)                 0.3 mm                     0.4 mm                   0.5 mm
                                                       (0.012 in)                 (0,016 in)               (0.020 in)
                    >2.0 mm(0.080 in)                   Level B                    Level A                  Level A
                                                        0.4 mm                     0.5 mm                   0.6 mm
                                                       (0.016 in)                 (0.020 in)               (0.024 in)


Notes: If copper in the hole is greater than 0.03 mm(0.0012 in), the hole size can be reduced by one class




                                    PCB Layout Design Guide for Analog Applications, Rev. 2.0
Freescale Semiconductor                                                                                                                      3
General Design Guides

The component mounting of the layout also effects the reliability and the producibility of the board, so It is important
to consider PCB flexing. To avoid cracking when the PCB is flexed, it’s advantageous to place the components in a
vertical direction of the longer direction of the PCB. See Figure 1.




                                            Preferred   Poor    Poor

                                     Figure 1. Component Mounting Direction


3.1        Minimum Trace Width
To calculate what minimum width is required to handle a certain amount of current, it requires several parameters,
including the operating temp range, maximum current which will flow through the trace, copper thickness, etc. There
is simple rule of thumb, which can be applied for most of the applications. For 1.0 oz/ft2 of copper thickness, in most
of the commercial applications, 1.0 mm/A is required as a minimum trace width.




                             PCB Layout Design Guide for Analog Applications, Rev. 2.0
4                                                                                               Freescale Semiconductor
                                                                                                                             General Design Guides


3.2           Clearance in Primary Circuits
When considering the insulation distance between two traces (or components), it is important to understand the
difference of clearance and the creepage distance. Figure 2 shows the definition of these two distances.




                                                       Creepage Distance
                                                                                                          B Point
                           A Point


                                                 Clearance Distance




                                       Figure 2. Clearance and Creepage Distance

Clearance distance is defined as the shortest distance through the air between two conductive elements. The
creepage distence is defined as the shortest distance on the surface of an insulating material between two
conductive elements. As shown in Figure 2, with a slit between two conductive points, the creepage distance is
increased by detouring the slit.
Clearance in primary circuits must comply with the minimum dimension in Table 3, and where appropriate, Table 4.
The relevant conditions in these tables must be considered.


                       Table 3. Minimum Clearances for Insulation in Primary Circuits, and
                                 Between Primary and Secondary Circuits (mm)
                                                                 Circuits subject to Installation Category II

                                                                                                                                      Nominal mains
  Insulation working voltage                                                            Nominal mains supply voltage                  supply voltage
                                     Nominal mains supply voltage
     up to and including                                                                          > 150 V                                 > 300 V
                                               ≤ 150 V
                                                                                                  ≤ 300 V                                 ≤ 600 V
                                       (Transient rating 1500 V)
                                                                                          (Transient rating 2500 V)                  (Transient rating
                                                                                                                                          400 V)

                   V rms       Pollution degrees              Pollution           Pollution degrees              Pollution           Pollution degrees
 V peak or dc                       1 and 2                   degree 3                 1 and 2                   degree 3                1, 2, and 3
                (sinusoidal)
      V
                     V         Op       B/S     R       Op      B/S        R      Op       B/S     R       Op      B/S        R      Op    B/S      R
       71            50        0.4      1.0     2.0     0.8      1.3       2.6    1.0      2.0     4.0     1.3      2.0       4.0    2.0    3.2     6.4
                                       (0.5)   (1.0)            (0.8)     (1.6)           (1.5)   (3.0)            (1.5)     (3.0)         (3.0)   (6.0)
      210           150        0.5      1.0     2.0     0.8      1.3       2.6    1.4      2.0     4.0     1.5      2.0       4.0    2.0    3.2     6.4
                                       (0.5)   (1.0)            (0.8)     (1.6)           (1.5)   (3.0)            (1.5)     (3.0)         (3.0)   (6.0)
      420           300                                       Op 1.5 B/S 2.0(1.5) R 4.0(3.0)                                         2.5    3.2     6.4
                                                                                                                                           (3.0)   (6.0)
      840           600                                                     Op 3.0 B/S 3.2(3.0) R6.4(6.0)
      1,400        1.000                                                          Op/B/S 4.2 R 6.4




                               PCB Layout Design Guide for Analog Applications, Rev. 2.0
Freescale Semiconductor                                                                                                                                    5
General Design Guides

                            Table 3. Minimum Clearances for Insulation in Primary Circuits, and
                                      Between Primary and Secondary Circuits (mm)
                                                                 Circuits subject to Installation Category II

                                                                                                                         Nominal mains
     Insulation working voltage                                                    Nominal mains supply voltage          supply voltage
                                          Nominal mains supply voltage
        up to and including                                                                  > 150 V                         > 300 V
                                                    ≤ 150 V
                                                                                             ≤ 300 V                         ≤ 600 V
                                            (Transient rating 1500 V)
                                                                                     (Transient rating 2500 V)          (Transient rating
                                                                                                                             400 V)

                        V rms       Pollution degrees         Pollution       Pollution degrees         Pollution       Pollution degrees
    V peak or dc                         1 and 2              degree 3             1 and 2              degree 3            1, 2, and 3
                     (sinusoidal)
         V
                          V          Op      B/S    R    Op     B/S       R   Op      B/S    R     Op     B/S       R   Op    B/S     R
        2,800           2,000                                                  Op/B/S/R 8.4
        7,000           5,000                                                  Op/B/S/R 17.5
        9,800           7,000                                                   Op/B/S/R 25
       14,000           10,000                                                  Op/B/S/R 37
       28,000           20,000                                                  Op/B/S/R 80
       42,000           30,000                                                 Op/B/S/R 130

    Notes
            2.This table is applicable to equipment that will not be subject to transients exceeding Installation Category II, according
              to IEC 664. The appropriate transient voltage ratings are given in parentheses at the top of each nominal mains supply
              voltage column. Where higher transients are possible, additional protection might be necessary on the mains supply,
              to the equipment or to the installation.
            3.The values in the table are applicable to OPERATIONAL (Op), BASIC(B), SUPPLEMENTARY(S), and REINFORCED
              INSULATION (R).
            4.The values in parentheses are applicable to BASIC, SUPPLEMENTARY, or REINFORCED INSULLATION, only if the
              manufacturing is subject to a quality control program that provides at least the same level of assurance as the example
              given in UL1950 annex R.2. In particular, DOUBLE and REINFORCED INSULLATION shall be subject to ROUTINE
              TESTING for electric strength.
            5.All BASIC, SUPPLEMENTARY, and REINFORCED INSULLATION parts of the PRIMARY CIRCUIT are assumed to
              be at not less than the normal supply voltage, with respect to earth.
            6.Linear interpolation is permitted between the nearest two points for WORKING VOLTAGES between 2,800 V and
              42,000 V peak or dc, the calculated spacing being rounded up to the next higher 0.1 mm increment.
            7.The CLEARANCE shall be not less than 10 mm, for an air gap serving as REINFORCED INSULATION between a
              part at a HAZARDOUS VOLTAGE, and an accessible conductive part of the ENCLOSURE of floor standing
              equipment, or the non-vertical top surface of desk top equipment.




                                     PCB Layout Design Guide for Analog Applications, Rev. 2.0
6                                                                                                               Freescale Semiconductor
                                                                                                   General Design Guides




               Table 4. Additional Clearances for Insulation in Primary Circuits with Repetitive
                    Peak Voltages Exceeding the Peak Value of the Mains Supply Voltage
                                                  Nominal mains supply
            Nominal mains supply voltage                voltage
                                                                                    Additional clearance (mm)
                      ≤ 150 V                           > 150V
                                                        ≤ 300V
       Pollution degrees      Pollution degree       Pollution degrees                                 Reinforced
            1 and 2                   3                  1,2 and 3        Operational, basic or        Insulation
                                                                            Supplementary
      Maximum repetitive     Maximum repetitive     Maximum repetitive         insulation
        peak voltage V         peak voltage V         peak voltage V
           210 (210)              210 (210)              420 (420)                  0                       0
           298 (288)              294 (293)              493 (497)                 0.1                     0.2
           386 (366)              379 (376)              567 (575)                 0.2                     0.4
           474 (444)              463 (459)              640 (652)                 0.3                     0.6
           562 (522)              547 (541)              713 (729)                 0.4                     0.8
           650 (600)              632 (624)              787 (807)                 0.5                     1.0
           738 (678)              716 (707)              860 (884)                 0.6                     1.2
           826 (756)              800 (790)              933 (961)                 0.7                     1.4
           914 (839)                  -                1,006 (1,039)               0.8                     1.6
          1,002 (912)                 -                1,080 (1,116)               0.9                     1.8
          1,090 (990)                 -                1,153 (1,193)               1.0                     2.0
               -                      -                1,226 (1,271)               1.1                     2.2
               -                      -                1,300 (1,348)               1.2                     2.4
               -                      -                  - (1,425)                 1.3                     2.6


Notes: The values in parentheses in Table 4. shall be used 1) when the values in parentheses in Table 3. are used in
       accordance with note 3 of Table 3. and 2) for Operational Insulation.




                              PCB Layout Design Guide for Analog Applications, Rev. 2.0
Freescale Semiconductor                                                                                                7
General Design Guides


3.3           Clearances in Secondary Circuits
Clearances in Secondary circuits shall meet the minimum dimension of Table 5. The relevant conditions in the table
shall be taken into consideration.


                               Table 5. Minimum Clearance in Secondary Circuits (mm)
                                                                                                         Nominal mains
                                                                                                              supply
                                                                                                                             Circuits not
                            Nominal mains supply voltage            Nominal mains supply voltage         > 300 V, ≤ 600 V
    Insulation working                                                                                                       subjected to
                                        ≤ 150 V                            > 150 V, ≤ 300 V                 (Maximum
     voltage up to and                                                                                                         transient
                          (maximum transient in secondary         (Maximum transient in secondary          transient in
         including                                                                                                           overvoltage
                              circuit 800 V, ref note 13)             circuit 1500 V, ref note 13)          secondary
                                                                                                                             (ref note 11)
                                                                                                          circuit 2500 V,
                                                                                                           ref note 13)

                                                                                                            Pollution
                 V rms        Pollution          Pollution           Pollution           Pollution                           Pollution
    V peak                                                                                               degrees 1,2, and
              (sinusoidal) degrees 1 and 2       degree 3         degrees 1 and 2        degree 3
                                                                                                                3
                                                                                                                          degrees 1 and 2
    or dc V
                   V
                           Op B/S       R     Op    B/S      R    Op     B/S     R      Op     B/S   R   Op    B/S    R     Op   B/S    R
      71          50       0.4 0.7 1.4 1.0 1.3 2.6 0.7 1.0 2.0 1.0 1.3 2.6 1.7 2.0 4.0 0.4 0.4 0.8
                          (0.2) (0.2) (0.4) (0.8) (0.8) (1.6) (0.5) (0.5) (1.0) (0.8) (0.8) (1.6) (1.5) (1.5) (3.0) (0.2) (0.2) (0.4)
     140         100       0.6 0.7 1.4 1.0 1.3 2.6 0.7 1.0 2.0 1.0 1.3 2.6 1.7 2.0 4.0 0.6 0.7 1.4
                          (0.2) (0.2) (0.4) (0.8) (0.8) (1.6) (0.5) (0.5) (1.0) (0.8) (0.8) (1.6) (1.5) (1.5) (3.0) (0.2) (0.2) (0.4)
     210         150       0.6 0.9 1.8 1.0 1.3 2.6 0.7 1.0 2.0 1.0 1.3 2.6 1.7 2.0 4.0 0.6 0.7 1.4
                          (0.2) (0.2) (0.8) (0.8) (0.8) (1.6) (0.5) (0.5) (1.0) (0.8) (0.8) (1.6) (1.5) (1.5) (3.0) (0.2) (0.2) (0.4)
     280         200                         Op 1.1(0.8), B/S 1.4 (0.8), R 2.8 (1.6)                      1.7 2.0 4.0 1.1 1.1 2.2
                                                                                                         (1.5) (1.5) (3.0) (0.2) (0.2) (0.4)
     420         300                         Op 1.6 (1.0), B/S 1.9 (1.0), R 3.8 (2.0)                     1.7 2.0 4.0 1.4 1.4 2.8
                                                                                                         (1.5) (1.5) (3.0) (0.2) (0.2) (0.4)
     700          500                                                       Op/B/S 2.5 R 5.0
     840          600                                                       Op/B/S 3.2 R 5.0
    1,400        1,000                                                      Op/B/S 4.2 R 5.0
     2,800       2,000                                                         Op/B/S/R 8.4
     7,000       5,000                                                         Op/B/S/R 17.5
     9,800       7,000                                                          Op/B/S/R 25
    14,000      10,000                                                          Op/B/S/R 37
    28,000      20,000                                                          Op/B/S/R 80
    42,000      30,000                                                         Op/B/S/R 130




                                PCB Layout Design Guide for Analog Applications, Rev. 2.0
8                                                                                                                Freescale Semiconductor
                                                                                                                         General Design Guides

                                Table 5. Minimum Clearance in Secondary Circuits (mm)
                                                                                                               Nominal mains
                                                                                                                    supply
                                                                                                                                       Circuits not
                             Nominal mains supply voltage               Nominal mains supply voltage           > 300 V, ≤ 600 V
   Insulation working                                                                                                                  subjected to
                                         ≤ 150 V                               > 150 V, ≤ 300 V                   (Maximum
    voltage up to and                                                                                                                    transient
                           (maximum transient in secondary            (Maximum transient in secondary            transient in
        including                                                                                                                      overvoltage
                               circuit 800 V, ref note 13)                circuit 1500 V, ref note 13)            secondary
                                                                                                                                       (ref note 11)
                                                                                                                circuit 2500 V,
                                                                                                                 ref note 13)

                                                                                                                  Pollution
                  V rms        Pollution              Pollution          Pollution           Pollution                             Pollution
  V peak                                                                                                       degrees 1,2, and
               (sinusoidal) degrees 1 and 2           degree 3        degrees 1 and 2        degree 3
                                                                                                                      3
                                                                                                                                degrees 1 and 2
  or dc V
                    V
                            Op B/S       R     Op       B/S       R   Op     B/S   R        Op   B/S       R   Op       B/S   R        Op   B/S      R

Notes
        8.The values in the table are applicable to OPERATIONAL (Op), BASIC (B), SUPPLEMENTRARY(S), REINFORCED (R)
          insulation
        9.The values in parentheses are applicable to BASIC, SUPPLEMENTARY, or REINFORCED insulation only if
          manufacturing is subject to a quality control program that provides at least the same level of assurance as the example
          given in UL1950 annex R.2. In particular, the DOUBLE and REINFORCED insulation shall be subject to routine testing
          for electric strength.
        10.The calculated spacing being rounded up to the next higher 0.1 mm increment for a working voltage between 2,800 V
          and 42,000 V peak or DC, linear interpolation is permitted between the nearest two points.
        11.The values are applicable to DC secondary circuits which are reliably connected to earth and have capacitive filtering
          which limits the peak to peak ripple to 10% of the DC voltage.
        12.Reserved for future use.
        13.Where transients in the equipment exceed this value, the appropriate higher clearance shall be used.
        14.The clearance shall be not less than 10 mm for an air gap serving as reinforced insulation between a part at a
          hazardous voltage, and an accessible conductive part of the enclosure of floor standing equipment, or of the
          non-vertical top surface of desk top equipment.
        15.Compliance with a clearance value of 8.4 mm or greater is not required, if the insulation involved passes an electric
          strength test.


3.4           Creepage Distances
Creepage distances shall be not less than the appropriate minimum values specified in Table 6.

                                       Table 6. Minimum Creepage Distances (mm)
                                                           Operational, Basic, and Supplementary Insulation

 Working voltage up to           Pollution degree 1                          Pollution degree 2                         Pollution degree 3
 and including VRMS or
          DC                       Material group                             Material group                              Material group

                                     I,II,IIIa+IIIb                     I              II        IIIa + IIIb        I             II        IIIa + IIIb
              50                                                       0.6          0.9             1.2          1.5           1.7             1.9
             100                 Use the appropriate                   0.7          1.0             1.4          1.8           2.0             2.2
             125              CLEARANCE from Table 3                   0.8          1.1             1.5          1.9           2.1             2.4
             150                     or Table 5                        0.8          1.1             1.6          2.0           2.2             2.5
             200                                                       1.0          1.4             2.0          2.5           2.8             3.2
             250                                                       1.3          1.8             2.5          3.2           3.6             4.0
             300                                                       1.6          2.2             3.2          4.0           4.5             5.0
             400                                                       2.0          2.8             4.0          5.0           5.6             6.3
             600                                                       3.2          4.5             6.3          8.0           9.6            10.0
            1,000                                                      5.0          7.1            10.0         12.5           14.0           16.0




                                 PCB Layout Design Guide for Analog Applications, Rev. 2.0
Freescale Semiconductor                                                                                                                                   9
General Design Guides

                                      Table 6. Minimum Creepage Distances (mm)
                                                     Operational, Basic, and Supplementary Insulation

 Working voltage up to          Pollution degree 1                  Pollution degree 2                  Pollution degree 3
 and including VRMS or
          DC                      Material group                     Material group                      Material group

                                    I,II,IIIa+IIIb              I           II        IIIa + IIIb   I           II        IIIa + IIIb

Notes
        16.The values for creepage distances for REINFORCED Insulation are twice the values in the table for BASIC insulation.
        17.If the creepage distance derived from Table 6 is less than the applicable clearance from Table 3, Table 4, and
         Table 5, as appropriate, then the value for that clearance shall be applied as the value for the minimum creepage
         distance.
        18.Material group I 600 ≤ CTI (Comparative tracking index)
        19.Material group II 400 ≤ CTI < 600
        20.Material group IIIa 175 ≤ CTI < 400
        21.Material group IIIb 100 ≤ CTI < 175
        22.The CTI rating refers to the value obtained in accordance with method A of IEC 112.
        23.Where the material group is not known, material group IIIb shall be assumed.
        24.Reserved for future use
        25.It is permitted to use minimum creepage distances equal to the applicable clearances for glass, mica, ceramic, or
         similar materials.
        26.Linear interpolation is permitted between the nearest two points, the calculated spacing being rounded to the next
         higher 0.1 mm increment




                                PCB Layout Design Guide for Analog Applications, Rev. 2.0
10                                                                                                      Freescale Semiconductor
                                                                                   Power Ground Separation (Noise Isolation)


4       Power Ground Separation (Noise Isolation)
If there is a PCB with zero ohm impedance, no consideration for the noise coupling caused by the common
impedance and the current which flows through it is needed. It is not possible for real applications to make a zero
ohm trace, or to reduce the impedance to a negligible level.
Trace impedance becomes troublesome for analog engineers when designing the layout which handles huge
switching current in analog applications.
The resistance of the PCB trace can be calculated by following formula.


                                 R = 1.7e – 6 × L ⁄ A ÷ ( 1 + ( 3.9e – 3 × ( T – 25 ) ) ) Ohms

Copper Resistivity: 1.7e-6 Ohm*cm
Copper Temp_Co: 3.9e-3 /°C
For 1.0 oz/ft2 copper (35 μm thickness copper), 1.0 mm width trace, the resistance would be around 12.3 mOhm/
inch at 25°C.
In addition, it is difficult to provide enough layers due to the cost of the PCB. Generally, a single sided printed board
price is about $0.2 x /inch2, a double sided printed board price is about $1.0 x/inch2, and a multi-layered (7-layer)
printed board price is about $5.0 x/inch2. There should always be an adequate number of layers available. It is
important to design the PCB layout for noise isolation within a limited number of layers.
The main purpose of the separation between power ground and signal ground is to prevent the high voltage ripples
caused by high current flow in the power path from spreading into the sensitive analog blocks.
Ground pin of COUT in Figure 3, will have a voltage ripple generated by ISW, ID, or IL, and the resistance of the trace.


                               C u rre n t F lo w a t B o o s t T o p o lo g y


                                    IL
                                                                                                               Id




                                                          Is w




                                                                   RSW




                                    R r1                                        R r2




                                  Figure 3. Current Flow of the Boost Converter




                              PCB Layout Design Guide for Analog Applications, Rev. 2.0
Freescale Semiconductor                                                                                                  11
Power Ground Separation (Noise Isolation)



                                   C u rre n t F lo w a t B o o s t T o p o lo g y


                                       IL
                                                                                                           Id




                                                           Is w x R s w



                                                       IL x R r1


                                                                          RSW




                                       R r1                                                 R r2



                                                               B
                                                                                                   C
                                                                      A n a lo g B lo c k

                                                                                                                   Id x R r2
                                                   A


                                       IL x R r1
                                                                                                       IL x R r1



                                         Figure 4. Ground Noise Expression

As shown in Figure 4, each ground connection point A, B, and C will have a different voltage ripple, which will be
reflected to the connected Analog block. This may cause unwanted performance issues.
The connection point of power ground and analog ground should be carefully managed, to avoid this problem when
doing the layout. The rule of thumb is to connect these two grounds prior to the input capacitor, and close to the input
connector or input voltage supply. By doing this, two main benefits can be expected: the common impedance is
reduced, and the switching ripple (or noise) will be filtered by the capacitor.




                             PCB Layout Design Guide for Analog Applications, Rev. 2.0
12                                                                                                              Freescale Semiconductor
                                                                             Power Ground Separation (Noise Isolation)




                          Vcc




                          G ND
                                              A . P o o r L ayo u t




                          Vcc
                          Vcc
                          G ND
                          G ND




                                              B . Acc ep t ab le L ayo u t


                          V c c1
                          G ND1


                          V c c2
                          G ND2




                          V c c3
                          G ND3

                                              C . P ref erre d L ayo u t


                                 Figure 5. Voltage/Ground Distribution Concepts




                          PCB Layout Design Guide for Analog Applications, Rev. 2.0
Freescale Semiconductor                                                                                            13
Thermal Considerations


5        Thermal Considerations
In applications without an external heat sink or fans to limit component temperatures within a reliable range, the PCB
trace would be the only thermal path to distribute the heat generated by the components. The following equation
represents the trace thermal resistance.

                                              θtrace = ThermalResistivity × t ⁄ A

Copper_Thermal_Resistivity = 2.49 mmK/W (at 300 K)
For 1.0 oz/ft2 copper (35 mm thickness copper), 1.0 mm width trace, the thermal resistance of the trace per inch is
2.8°C/Watt.
The best way to dissipate heat from the components is to attached the components’ case (the main body which will
be used as a thermal path of the components) directly to the wide solid plane of the copper surface. If it is difficult
to expand the plane area, due to other circuits or pins, for example with the TQFN package, it is better to make a
thermal path with as many vias as possible to the other layer’s solid planes.
Table 7 shows the simulation results of the 32 pin 5x5 QFN and 56 pin 8x8 QFN, by changing the number of vias of
the exposed pad, changing the copper thickness, and changing the number of layers. The JEDEC JESD51
specification was used for this simulation.


5.1         Standard Thermal Resistances

                                              Table 7. Thermal Resistance data
                      Rating                                                                Value         Unit        Notes
                                                                                                                     (27) (28)
Junction to Ambient (Natural Convection)              Single Layer Board (1s)   RθJA         103         °C/W            ,
Junction to Ambient (Natural Convection)             Four Layer Board (2s2p)    RθJA          36         °C/W         (27),(29)

                                                                                                                      (27),(29)
Junction to Ambient (@200 ft/min)                     Single Layer Board (1s)   RθJMA         87         °C/W
                                                                                                                      (27) (29)
Junction to Ambient (@200 ft/min)                    Four Layer Board (2s2p)    RθJMA         30         °C/W             ,
                                                                                                                        (30)
Junction to Board                                                               RθJB          15         °C/W
                                                                                                                        (31)
Junction to Case (Bottom)                                                       RθJC          4          °C/W
                                                                                                                        (32)
Junction to Package Top                                 Natural Convection      RθJT          10         °C/W

Notes
        27.Junction temperature is a function of the die size, on chip power dissipation, package thermal resistance, mounting
         site (board) temperature, ambient temperature, air flow, power dissipation of other components on the board, and
         board thermal resistance.
        28.Per JEDEC JESD 51-2 with the single layer board (JESD 51-3) horizontal
        29.Per JEDEC JESD51-6 with the board (JESD 51-7) horizontal
        30.Thermal Resistance between the die and the printed circuit board, per JEDEC, JESD 51-8. Board temperature is
         measured on the top surface of the board near the package.
        31.Thermal resistance between the die and the solder pad on the bottom of the package. Interface resistance is ignored.
        32.Thermal characterization parameter indicating the temperature difference between package top and the junction
         temperature, per JEDEC, JESD51-2.


Figure 6 shows the thermal model of the 5x5 QFN package with 9 vias.




                                    PCB Layout Design Guide for Analog Applications, Rev. 2.0
14                                                                                                    Freescale Semiconductor
                                                                                                                                                                         Thermal Considerations




                                                                      Figure 6. Thermal Model of a 32 pin 5x5 QFN Package

The QFN package has very low thermal resistance from the die to the mounting surface: 3.8°C/W for this die size.
Figure 7 shows the relationship between thermal resistance and the copper thickness of the boards. In this
simulation, the board vias are connected on the plane, isolated from the others. There is one top surface trace layer.
For simplicity the planes are modelled as solid planes.

                                                      50
             Junction to Ambient Thermal Resistance




                                                      45

                                                      40

                                                      35

                                                      30

                                                      25
                                                      20

                                                      15

                                                      10

                                                       5

                                                       0
                                                            T wo in te r n a l        T wo in te r n a l        T wo in te r n a l        T wo in te r n a l        T wo in te r n a l
                                                               p la n e s 1 5            p la n e s 3 0            p la n e s 3 0            p la n e s 6 0           p la n e s 1 2 0
                                                           m ic r o n s , to p 3 5   m ic r o n s , to p 3 5   m ic r o n s , to p 7 0   m ic r o n s , to p 7 0   m ic r o n s , to p 7 0
                                                                 m ic r o n s              m ic r o n s              m ic r o n s               m ic r o n                m ic r o n


                                                                        Figure 7. Thermal Resistance vs. Copper Thickness

Figure 8 shows how having an effective board area is important to reduce the thermal resistance. The temperature
of the device becomes significantly hotter below an effective board area of 50 x 50 mm2.




                                                                      PCB Layout Design Guide for Analog Applications, Rev. 2.0
Freescale Semiconductor                                                                                                                                                                      15
References


                                                        70


                                                        60



               Junction-to-Ambient Thermal Resistance
                                                        50


                                                        40


                                                        30


                                                        20


                                                        10


                                                         0
                                                              0           1000         2000            3000              4000          5000        6000
                                                                                              Bo ar d A r e a (m m ^2)



                                       Figure 8. Effective Board Area vs. Junction to Ambient Thermal Resistance

Table 8 is the comparison table between a 32 pin 5x5 QFN package and a 56 pin 8x8 QFN package.
According to the simulation, with same number of vias, the thermal capacity of these two package does not show a
significant difference. However, as the number of vias is increased on the 8x8 QFN package, the temperature of the
device decreased by approximately 8.0°C with same package.


                                                                        Table 8. Case Temperature with Difference Vias.
                                                             Package                                                 TCASE at 2.0 W at TA = 25°C
                                                             32 pin 5x5 QFN, 3.6 mm flag, 9 vias                                85°C
                                                             56 pin 8x8 QFN, 3.6 mm flag, 9 vias                                88°C
                                                             56 pin 8x8 WFN, 3.6 mm flag, larger pad, 25 vias                   76°C


The most efficient way to dissipate the heat from a QFN package is to increase the number of vias on the exposed
pad, and increase the exposed pad size as much as possible.


6       References
         1.               IPC-D-330
         2.               UL1950
         3.               JEDEC JESD 51




                                                                     PCB Layout Design Guide for Analog Applications, Rev. 2.0
16                                                                                                                                            Freescale Semiconductor
How to Reach Us:
Home Page:
www.freescale.com

Web Support:
http://www.freescale.com/support

USA/Europe or Locations Not Listed:
Freescale Semiconductor, Inc.
Technical Information Center, EL516
2100 East Elliot Road
Tempe, Arizona 85284
1-800-521-6274 or +1-480-768-2130
www.freescale.com/support

Europe, Middle East, and Africa:
Freescale Halbleiter Deutschland GmbH
Technical Information Center
Schatzbogen 7
81829 Muenchen, Germany
+44 1296 380 456 (English)
+46 8 52200080 (English)
+49 89 92103 559 (German)
+33 1 69 35 48 48 (French)
www.freescale.com/support

Japan:
Freescale Semiconductor Japan Ltd.
Headquarters
ARCO Tower 15F
1-8-1, Shimo-Meguro, Meguro-ku,
Tokyo 153-0064
Japan
0120 191014 or +81 3 5437 9125
support.japan@freescale.com                              Information in this document is provided solely to enable system and
                                                         software implementers to use Freescale Semiconductor products. There are
Asia/Pacific:                                            no express or implied copyright licenses granted hereunder to design or
Freescale Semiconductor China Ltd.                       fabricate any integrated circuits or integrated circuits based on the
Exchange Building 23F                                    information in this document.
No. 118 Jianguo Road
Chaoyang District
                                                         Freescale Semiconductor reserves the right to make changes without further
Beijing 100022
                                                         notice to any products herein. Freescale Semiconductor makes no warranty,
China
                                                         representation or guarantee regarding the suitability of its products for any
+86 10 5879 8000
                                                         particular purpose, nor does Freescale Semiconductor assume any liability
support.asia@freescale.com
                                                         arising out of the application or use of any product or circuit, and specifically
                                                         disclaims any and all liability, including without limitation consequential or
For Literature Requests Only:
                                                         incidental damages. “Typical” parameters that may be provided in Freescale
Freescale Semiconductor Literature Distribution Center   Semiconductor data sheets and/or specifications can and do vary in different
P.O. Box 5405                                            applications and actual performance may vary over time. All operating
Denver, Colorado 80217                                   parameters, including “Typicals”, must be validated for each customer
1-800-441-2447 or +1-303-675-2140                        application by customer’s technical experts. Freescale Semiconductor does
Fax: +1-303-675-2150                                     not convey any license under its patent rights nor the rights of others.
LDCForFreescaleSemiconductor@hibbertgroup.com            Freescale Semiconductor products are not designed, intended, or authorized
                                                         for use as components in systems intended for surgical implant into the body,
                                                         or other applications intended to support or sustain life, or for any other
                                                         application in which the failure of the Freescale Semiconductor product could
                                                         create a situation where personal injury or death may occur. Should Buyer
                                                         purchase or use Freescale Semiconductor products for any such unintended
                                                         or unauthorized application, Buyer shall indemnify and hold Freescale
                                                         Semiconductor and its officers, employees, subsidiaries, affiliates, and
                                                         distributors harmless against all claims, costs, damages, and expenses, and
                                                         reasonable attorney fees arising out of, directly or indirectly, any claim of
                                                         personal injury or death associated with such unintended or unauthorized
                                                         use, even if such claim alleges that Freescale Semiconductor was negligent
                                                         regarding the design or manufacture of the part.




                                                         Freescale™ and the Freescale logo are trademarks of
                                                         Freescale Semiconductor, Inc. All other product or service names
                                                         are the property of their respective owners.
                                                         © Freescale Semiconductor, Inc. 2009 - 2010. All rights reserved.


                                                         AN3962
                                                         Rev. 2.0
                                                         8/2010


==========================================
FILE: CERN-THESIS-2023-189.pdf
==========================================

                                              Dipartimento di Ingegneria dell’Informazione

                                         Corso di Laurea Magistrale in Ingegneria Elettronica




                                    Design of an LNA based on SiGe HBT Technology for
                                     the Beam Position Monitor of Particle Accelerators
CERN-THESIS-2023-189




                                    University Supervisor:                                          Candidate:
                                    Prof. Massimo Macucci                              Giusy Valeria Passarelli
                       22/09/2023




                                    CERN Supervisor:
                                    Ing. Michele Bozzolan




                                                             Academic Year 2022/2023
1
                                                       Abstract

In the field of high-energy physics, the precise monitoring of particle beam
position is crucial for the efficient operation and control of particle accel-
erators. This thesis focuses on the design and optimization of a Low-Noise
Amplifier (LNA) in Silicon-Germanium Heterojunction Bipolar Transis-
tor (SiGe HBT) technology for the Beam Position Monitor (BPM) system
employed in the Proton Synchrotron (PS) particle accelerator at CERN.
The objective of this research is to develop a high-performance LNA pos-
sibly exceeding the specifications of the operational one, designed more
than 25 years ago. The initial stages of the thesis involve a comprehensive
review of relevant literature, focusing on the principles of accelerator tech-
nology, beam position monitor, and the fundamentals of Low-Noise Am-
plifier design. Building upon this foundation, the SiGe HBT technology
is explored for its suitability in the demanding environment of a particle
accelerator, considering factors such as noise performance, linearity and
operating frequency range. The design methodology encompasses various
stages, including device modeling, circuit simulation, layout implementa-
tion, PCB production and laboratory tests. Utilizing industry-standard
simulation tools, such as LTspice and AWR Microwave Office, the LNA
circuit is optimized for minimum noise figure, maximum gain, and opti-
mal impedance matching. Additionally, filtering and feedback techniques
are employed to improve the overall performance of the amplifier. The
outcomes of this research could contribute to the advancement of acceler-
ator technology, specifically in the domain of beam position monitoring.
The aim for the developed LNA design is to improve sensitivity and dy-
namic range of the CERN PS BPM system and, possibly, improve the
control and exploitation of the particle accelerator.




                                      2
3
                                                                   Contents

1 Introduction                                                                           6
  1.1   CERN Accelerator Complex . . . . . . . . . . . . . . . . . . . . . . .           6
  1.2   The Proton Synchrotron . . . . . . . . . . . . . . . . . . . . . . . . .         8
  1.3   Beam Position Monitoring . . . . . . . . . . . . . . . . . . . . . . . .        10
        1.3.1   Technique for Beam Position Detection . . . . . . . . . . . . .         11
  1.4   The role of Low-Noise Amplifier . . . . . . . . . . . . . . . . . . . . .       16

2 Fundamentals of LNA                                                                   17
  2.1   The Principles of LNA Operation . . . . . . . . . . . . . . . . . . . .         17
        2.1.1   Gain . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .    20
        2.1.2   Noise Figure . . . . . . . . . . . . . . . . . . . . . . . . . . . .    22
        2.1.3   Bandwidth . . . . . . . . . . . . . . . . . . . . . . . . . . . . .     26
        2.1.4   Stability . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .   26
        2.1.5   Linearity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .   28
  2.2   Noise Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .    30
        2.2.1   Thermal Noise     . . . . . . . . . . . . . . . . . . . . . . . . . .   31
        2.2.2   Shot Noise . . . . . . . . . . . . . . . . . . . . . . . . . . . . .    32
        2.2.3   Flicker Noise . . . . . . . . . . . . . . . . . . . . . . . . . . .     33

3 Analysis of the Current BPM System in the PS Ring                                     35
  3.1   Overview of the Current BPM System . . . . . . . . . . . . . . . . .            35


                                           4
  3.2   Examination of the Current LNA . . . . . . . . . . . . . . . . . . . .        37

4 SiGe HBT LNA Design Methodology                                                     49
  4.1   Key Requirements for the New Low-Noise Amplifier . . . . . . . . . .          49
  4.2   The SiGe HBT Technology . . . . . . . . . . . . . . . . . . . . . . . .       50
        4.2.1   Suitability to Our Case . . . . . . . . . . . . . . . . . . . . . .   53
  4.3   LNA Design Process . . . . . . . . . . . . . . . . . . . . . . . . . . .      56
  4.4   First Stage Design . . . . . . . . . . . . . . . . . . . . . . . . . . . .    56
        4.4.1   Selection of the Active Component BFP740F . . . . . . . . . .         56
        4.4.2   Schematic and Simulations . . . . . . . . . . . . . . . . . . . .     59
        4.4.3   Printed Circuit Board . . . . . . . . . . . . . . . . . . . . . .     68
        4.4.4   Outcomes of the First Stage Prototype Testing       . . . . . . . .   71
  4.5   Second Stage and Feedback Design . . . . . . . . . . . . . . . . . . .        76
        4.5.1   Series-Shunt Feedback . . . . . . . . . . . . . . . . . . . . . .     78
        4.5.2   Shunt-Shunt Feedback . . . . . . . . . . . . . . . . . . . . . .      82

5 Simulation Results and Measurement                                                  87
  5.1   Simulation Results . . . . . . . . . . . . . . . . . . . . . . . . . . . .    87
  5.2   Lab Tests . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .   91

6 Conclusions and Future Work                                                         99
  6.1   Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .   99
  6.2   Future Work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100




                                          5
                                                                                     1
                                                        Introduction

Chapter 1 provides a comprehensive and detailed overview of the particle accelera-
tor complex at CERN, with a particular focus on the PS ring, which is of utmost
importance in the present thesis project. The main objective of this chapter is to
explore the operational aspects of the Beam Position Monitors (BPM) installed in
each accelerator and their role in accurately monitoring the particle beams. Finally,
attention is drawn to the Low-Noise Amplifier (LNA) and the fundamental role it
plays in the analog front-end of the BPM.


1.1    CERN Accelerator Complex

The CERN, European Organization for Nuclear Research, was founded in 1954 and
is universally recognized as one of the most prestigious and influential scientific in-
stitutions in the world. As an international organization, CERN is dedicated to
scientific research in the field of high-energy physics (HEP), and its primary mission
is focused on studying the fundamental structure of the universe. Through the ex-
ploration of elementary particles and the forces that govern them, main objective
of CERN is to deepen our understanding of the nature and origin of the cosmos.
At the heart of CERN groundbreaking research activities lies a complex of particle
accelerators and detectors. CERN particle accelerators can be distinguished into
several categories, each characterized by its own design and specific purpose. Firstly,
we have linear accelerators (LINAC), which enable rapid acceleration of particles
along a straight path using Radio-Frequency (RF) fields. LINACs find wide appli-
cations in medical facilities for cancer treatment, as well as in the industrial sector.
Another type of accelerator is the synchrotrons that use powerful magnetic fields to
guide particles along a circular path, gradually increasing their speed. These accel-
erators have diverse purposes, such as conducting high-energy physics experiments,
materials research, and supporting medical applications. Finally, colliders represent

                                           6
another category of particle accelerators. These devices bring together two beams of
particles, causing them to collide at specific interaction points. Analyzing the sub-
atomic interactions that occur during these high-energy collisions allows scientists to
investigate the fundamental nature of matter. A notable example of a collider is the
famous Large Hadron Collider (LHC).




                       Figure 1: CERN Accelerator Complex


The Figure 1 illustrates the succession of particle accelerators at CERN [1]. As re-
ported in [2], the process of accelerating protons begins with the Linear Accelerator
4 (LINAC4), which plays a fundamental role in generating and accelerating proton
beams. Initially, negative hydrogen ions (H− ) are accelerated to 160 MeV. Subse-
quently, after stripping two electrons from the H- ions, the beam of ions is sent to
the Proton Synchrotron Booster (PSB), where their energy is further amplified to
2 GeV. After this stage, the protons are sent to the Proton Synchrotron (PS) and
then to the Super Proton Synchrotron (SPS), where their energy is further increased
to 26 GeV and 450 GeV, respectively. Once the path through the SPS is completed,
the proton beam is introduced into the massive Large Hadron Collider (LHC). The

                                          7
LHC consists of two circular rings where the protons travel in opposite directions.
Through this ring, the protons reach their maximum energy of 6.5 TeV before being
made to collide at the center of the four main detectors: ALICE, ATLAS, CMS, and
LHCb. The collisions of proton beams in these detectors, which generate a com-
bined energy of 13 TeV, allow scientists to study the produced particles and deepen
our understanding of particle physics and fundamental interactions. Parallel to this
proton pathway, heavy ions can also be accelerated and brought to collision.


1.2    The Proton Synchrotron

This thesis will focus on the Proton Synchrotron (PS) particle accelerator, a remark-
able research tool in the field of high-energy physics. The PS achieved a ground-
breaking moment on 24 November 1959, when it accelerated protons for the first
time, temporarily becoming the particle accelerator with the highest energy in the
world [3]. Originally conceived as CERN first synchrotron, the PS represents a funda-
mental milestone in the development of particle physics. Despite CERN investments
in new accelerators during the ’70s, the PS continued to adapt to research needs, sig-
nificantly increasing the intensity of the proton beam, now a thousand times higher
than in its early days. Impressive from an engineering perspective, the PS has a
circumference of 628 meters and is equipped with a complex system of 277 conven-
tional electromagnets at room temperature. Among them are 100 dipole magnets,
which bend the proton beams around the ring to maintain a circular trajectory. In
addition to accelerating protons, the PS has demonstrated its versatility by acceler-
ating a wide range of particles, including helium nuclei, oxygen, sulfur, argon, and
lead nuclei, electrons, positrons and antiprotons. This flexibility has allowed it to
contribute to numerous studies and discoveries in the field of particle physics and
the structure of matter.




                                          8
              Figure 2: Proton Synchrotron Straight Section - CERN 1




                    Figure 3: The Proton Synchrotron - CERN [3]




1
    http://psring.web.cern.ch/psring/pscomplex.html


                                              9
1.3    Beam Position Monitoring

Beam position monitoring plays a fundamental role in the proper functioning of
particle accelerators. In fact, precise measurement and careful control of the beam
position inside the accelerator are essential aspects to achieve the desired experimen-
tal results and ensure a safe and efficient operation of the entire system. Particle
accelerators are designed with the primary goal of accelerating charged particles to
high energy and causing them to collide with target materials or other particles. Ac-
curacy and control of these collisions are critical, and for this reason it is important
to maintain the stability of the particle beam. To this end, real-time monitoring of
beam position offers valuable information that allows operators to identify and cor-
rect any deviations from the desired trajectory. Accurate beam position monitoring
is equally important for beam losses detection. These leaks occur when particles de-
viate from their intended path and collide with accelerator components. The effects
of beam losses can be diverse, including localized heating, radiation damage, and po-
tentially hazardous situations. In this context, it is vital that operators can swiftly
identify any abnormal beam behavior and take appropriate measures to mitigate or
prevent such losses. Additionally, the accurate monitoring of the beam position is
essential in particle physics research. In fact, precise knowledge of the beam position
allows researchers to correlate recorded signals with specific beam conditions. This
aspect becomes particularly important in the context of elementary particle research,
where even small variations in position can have a significant impact on analyses and
scientific discoveries.
For linear accelerators and transfer lines, BPMs (Beam Position Monitors) are essen-
tial for measuring and correcting beam trajectories. In circular accelerators, BPMs
are not only used for measuring and correcting trajectories but also for calculating
the closed orbit, which is the averaged trajectory over multiple revolutions, making
them even more crucial. In the early stages of BPM development, monitoring sys-
tems were relatively simple, mainly consisting of an oscilloscope directly connected
to the detection signals. Over time, significant advancements in acquisition and pro-
cessing electronics have greatly improved modern BPMs. Today, they can accurately
digitize signals with high precision and resolution, enabling the detection of signal
groups separated by just a few nanoseconds. These technological improvements have
resulted in significant practical benefits, allowing for rapid visualization and analysis
of beam trajectories in a fraction of a second.

                                           10
A general block diagram of a typical beam position monitor is illustrated in Figure 4.
Here, four detector electrodes are symmetrically arranged along the horizontal and
vertical axes of the beam pipe. The electrodes interact electromagnetically with the
charged particles in the beam pipe, and each of them returns a pulsed signal pro-
portional to the intensity of the beam packets and the distance between the beam
and the electrode, i.e., the beam position. All four electrode signals are routed to
the analog front-end electronics, which comprise a variety of signal processing ele-
ments, such as analog filters, low-noise amplifiers, mixers, and subsequently digitized
through an analog-to-digital converter (ADC). Finally, the digitized position data is
collected by a data acquisition (DAQ) system [4].




                Figure 4: General Block Diagram of a BPM System


1.3.1   Technique for Beam Position Detection

The accurate determination of the beam position hinges upon the analysis of data
collected from pick-up electrodes situated within the beam pipe. Through the dig-
itization of electrode signals, the BPM system performs calculations to derive both
horizontal and vertical beam coordinates. The sensing elements commonly used
within circular accelerators are electrostatic or capacitive pick-ups that consist of
metallic plates or grids arranged in a specific configuration [5]. When the beam
passes through the pick-up, it induces an electric charge on the electrodes, resulting
in the generation of an image current Iim (t) that directly relates to the intensity of
the beam current Ibeam (t), but with reversed polarity, as shown in Figure 5 and in
equations (1) and (2).



                                          11
                          Iim (t)




                                                                                                                  t

                           -       -         -       -           -       -       -       -       -       -    -   image charges

                                                                             ⃗
                                                                             E
                                                                                                                  Ibeam (t)
                                   +             +           +           +           +       +           +




   Figure 5: Electromagnetic Interaction between the beam and an electrode [4]




                                                                 x
                                                                 Iim (t)


                     beam pipe

                                       pick-up                                               Cbp
                                                             ⃗
                                                             E
                                                                                                             Ibeam (t)
                               +         +       +       +           +               +               +



                    2a




                                                         l



                Figure 6: BPM Schematic for the vertical position


Furthermore, the image current Iim (t) exhibits an inverse relationship with the dis-
tance a between the beam and the plate, characterized by its length l and area A.
Consequently, by accurately measuring the difference in induced charge on the four
electrodes, it becomes possible to calculate the precise position of the beam.


                                                                 12
As reported in [4], the image current Iim (t) driven by the image charge Qim (t) is:

                                    dQim (t)     A dQbeam (t)
                        Iim (t) =            =−                                    (1)
                                      dt        2πal  dt
The electrical current Ibeam (t) is formed by N particles of charge state q per unit of
time t:
                                              qeN   qeN v
                               Ibeam (t) =        =                                (2)
                                                t     l
where e is the elementary charge and v is beam velocity.
To simplify, let us focus only on the plates that detect the transverse displacement
of the beam. It is evident that when the beam is not centered, there will be a
greater charge accumulation on the plate closest to it. This phenomenon is commonly
known as the “proximity effect”, and it is depicted in Figure 7. Consequently, the
amplitudes of the voltage pulses captured by the two opposing electrodes will exhibit
a discrepancy, allowing for the measurement of the vertical displacement (y) of the
beam.

                        beam pipe

                                    pick up
                                                     y from ∆Vy
                                              y

                                                              z




               Figure 7: Proximity Effect for the BPM vertical plates



                               1 Vup − Vdown    1 ∆Vy
                          y=     ·            =   ·                                (3)
                               Sy Vup + Vdown   Sy ΣVy



                                              13
where Vup and Vdown are the voltage pulses measured on the upper and lower plate
respectively, while Sy is the position sensitivity (for a more in-depth understanding
of this sensitivity, reference can be made to Ref. [6]).
Similarly, for the longitudinal displacement (x), we have:

                                1 Vright − Vlef t    1 ∆Vx
                         x=       ·                =   ·                          (4)
                                Sx Vright + Vlef t   Sx ΣVx

The capacitive pick-up is defined by its capacitance, denoted as C, which comprises
three components: the capacitance Cbp , which represents the capacitance between
the plate and the beam pipe, the capacitance between the plates, and the capacitance
contributed by the cable connecting the plate to the amplifier with input resistance
R [6]. From this consideration, the pick-up electrode can be schematized through
the equivalent circuit shown in Figure 8.

                                                             +

                      Iim (t)            C          R    Vim (t)

                                                             −


                Figure 8: Equivalent Circuit of a Pick-up Electrode


Considering the parallel connection it is possible to write the impedance Z as:

                                             R
                                    Z=                                            (5)
                                         1 + jωCR

The voltage drop across Z in the frequency domain is:

                                                   R
                   Vim (jω) = Z · Iim (jω) =            · Iim (jω)                (6)
                                               1 + jωCR

Considering that the Fourier Transform of dtd is −jω:

                                          14
                                  R     jωA
              Vim (jω) =              ·     · Ibeam (jω) = Zt (jω) · Ibeam (jω)    (7)
                              1 + jωCR 2πal

Therefore the Transfer Function of the pick-up is:

                                        Vim (jω)        R     jωA
                           Zt (jω) =              =         ·                      (8)
                                       Ibeam (jω)   1 + jωRC 2πal

This function is characterized by a zero in the origin and a pole at a frequency
fp = (2πRC)−1 , which depends on the input resistance of the amplifier. Indeed,
as this input resistance increases, the pole frequency decreases, allowing for precise
control over the frequency range in which the system must operate. The Figure 9
shows the Bode Diagram of this transfer function in three particular cases of amplifier
input impedance: high impedance, low impedance, transformed impedance.

                      π

         Zt (jω)      π
                      2
          [rad]
                       0


                     101

                     100

     |Zt (jω)|      10−1
       [dB]
                    10−2
                                              Low impedance 50 Ω
                    10−3                      High impedance 1 MΩ
                                              Transformed impedance 5 kΩ
                    10−4
                       10−3     10−2   10−1     100     101     102        103
                                              f [MHz]

                  Figure 9: Bode Diagram of Transfer Function Zt (jω) [6]




                                                 15
1.4    The role of Low-Noise Amplifier

The Low-Noise Amplifier (LNA) is a fundamental component in numerous electronic
systems, particularly those involved in communication and signal processing, such as
receivers and wireless communication systems. Even in the context of BPM (Beam
Position Monitor), the LNA plays a significant role as the initial stage in the analog
front-end of the BPM. Its function is to amplify weak electrical signals generated by
the BPM pick-up while minimizing the addition of noise.

ANTENNA




        RF FILTER                MIXER      IF FILTER

                      LNA                               VGA         ADC         DSP




                                      LO




              Figure 10: Block Diagram of a Typical Receiver System


The Low-Noise Amplifier currently employed in the BPM analog front-end of the
PS particle accelerator at CERN was designed and implemented about 25 years ago.
Despite its remarkable performance demonstrated over the years, the associated elec-
tronics are approaching the end of their lifecycle, with some components becoming
obsolete. Therefore, the main objective of this research thesis is to design a new
LNA using newer technology without compromising the excellent performance of the
current system. This new amplifier is proposed as a viable alternative to the model
currently in use.




                                           16
                                                                                     2
                                Fundamentals of LNA

Chapter 2 provides a comprehensive introduction to the fundamental aspects of Low-
Noise Amplifiers, providing readers with a strong foundation for understanding the
principles and considerations involved in SiGe HBT LNA design. This chapter covers
essential topics, including the principles of LNA operation, key parameters, and noise
analysis.


2.1    The Principles of LNA Operation

Low-Noise Amplifiers play a fundamental role in contexts where both signal ampli-
fication and low noise are of crucial importance. Within electronic systems, noise is
an intrinsic phenomenon that can compromise signal quality and hinder the accu-
rate detection or processing of weak signals. For this reason, the primary purpose of
Low-Noise Amplifiers (LNAs) is to amplify weak input signals without introducing
significant levels of additional noise. This results in a substantial improvement in the
overall signal-to-noise ratio (SNR), system sensitivity, and maximizes overall perfor-
mance. To achieve optimal performance, a solid understanding of their fundamental
principles of operation, along with the use of highly efficient technologies and com-
ponents, is crucial. These principles encompass various key aspects, including gain,
noise figure, input and output matching, stability and linearity. In the following
paragraphs, we will delve into each of these aspects in detail, exploring their signifi-
cance and impact on LNA performance. One way to simplify the analysis and study
of LNAs is by representing them as quadripoles. In general a linear time invariant
N-port network can be represented by a scattering parameter matrix or S-parameter
matrix [7]. This matrix describes the relationship between the incident and reflected
or transmitted waves at the input and output ports of the quadripole, providing
valuable insights into the behavior of the network and allows for a comprehensive
understanding of its performance characteristics.

                                          17
        I1                       I2                 a1                        a2
+      V1+                       V2+
                                       +                          S21
V1                  Q                  V2           b1
                                                            S11         S22
                                                                              b2
       V1−                       V2−                              S12
−                                      −

                         Figure 11: LNA as Two-Port Network


Taking into account the Telegrapher’s equations, which describe the propagation of
voltage and current phasors along a transmission line:

                            
                                       + jβl − −jβl
                             V (l) = V e + V e
                            
                                         V + jβl V − −jβl                          (9)
                             I(l) =
                                           e −     e
                                         Z0      Z0

Where:


     • V + is the phasor of the incident wave;

     • V − is the phasor of the reflected wave;

     • Z0 is characteristic impedance of the transmission line;

     • l is the length of the transmission line;
          2π
     • β=     is the phase constant;
           λ
          vf
     • λ=    is signal wavelength;
          f0
             c
     • vf = √ is propagation speed along the transmission line.
              ϵr




                                            18
It is possible to write:

                                 
                                          +     −
                                  V1 = V1 + V1
                                 
                                              V1 + V1 −                         (10)
                                  I1 =
                                                 −
                                              Z0    Z0

                                 
                                          +     −
                                  V2 = V2 + V2
                                 
                                              V2 + V2 −                         (11)
                                  I2 =
                                                 −
                                              Z0    Z0

The S-parameter matrix for a two-port network can be expressed as follows:

                                     !                 !         !
                                b1           S11 S12        a1
                                         =                                      (12)
                                b2           S21 S22        a2


a1 and a2 represent the incident waves at the input port, b1 and b2 represent the
reflected and transmitted waves at the output port, respectively [8].


                      V1 + Z0 I1  V1 +                  V2 + Z0 I2  V2 +
                 a1 =    √       =√                a2 =    √       =√
                        2 Z0        Z0                    2 Z0       Z0
                         V1 − Z0 I1  V1 −                  V2 − Z0 I2  V2 −
                  b1 =      √       =√             b2 =       √       =√
                           2 Z0        Z0                    2 Z0       Z0

S11 , S12 , S21 and S22 are complex numbers that characterize the network behavior:

   • S11 is known as the input reflection coefficient or input return loss;

   • S12 is known as the reverse gain or the isolation of the two-port;

   • S21 is known as the transducer power gain of the two-port;

   • S22 is known as the output reflection coefficient or output return loss.


                                              19
                b1                      b1                        b2                        b2
        S11 =                 S12 =                       S21 =                     S22 =
                a1                      a2                        a1                        a2
                     a2 =0                   a1 =0                      a2 =0                    a1 =0


When designing a Low-Noise Amplifier as a two-port network, the S-parameters
are typically optimized to achieve specific characteristics. To ensure efficient power
transfer, the LNA is designed to have low values of S11 and S22 , indicating good
matching between the input and output ports. This matching minimizes the reflec-
tion of input power, allowing most of it to be absorbed by the LNA rather than being
reflected back. In addition to good input/output matching, the LNA is engineered
to have a high value of S21 , representing a substantial power gain or amplification
of the input signal. This high gain enables to boost weak signals to a level suitable
for further processing or transmission. Overall, the goal of designing an LNA as a
two-port network is to achieve good input/output matching, high gain, and low noise
figure.


2.1.1     Gain

In the context of Radio-Frequency (RF), various types of power gains are defined,
providing a comprehensive view of the amplification characteristics of a system and
enabling accurate performance evaluation and optimal design. These types of gains
include Operational Power Gain (GP ), Available Power Gain (GA ), and Transducer
Gain (GT ) [9].

        PAin Pin             PAout PL


        RS
VS                       S                     ZL         ΓS                    S                          ΓL


                                                                  ΓIN                              ΓOU T




         Figure 12: Two-Port Network with Power and Reflection Coefficients



                                                     20
Operational Power Gain represents the ratio between the average power delivered to
the load (PL ) and the input power to the two-port network (Pin ):

                                                 PL
                                       GP =                                          (13)
                                                 Pin

This gain directly measures signal amplification, that is, by how much a device
increases the input signal power. It is essential for evaluating the effectiveness of
amplification and comparing its performance.
Available Power Gain, on the other hand, is defined as the ratio between the available
power at the output of the two-port network (PAout ) and the available power from
the signal generator (PAin ). The available power is the power that a generator can
supply to a matched load: the condition for conjugate matching is ZL = ZS∗ .

                                              PAout
                                      GA =                                           (14)
                                              PAin

This type of gain represents the increase obtainable under perfectly matched condi-
tions at both input and output, considering lossless matching networks.
Lastly, Transducer Gain is defined as the ratio between the average power delivered
to the load (PL ) and the available power from the signal generator (PAin ):

                                               PL
                                       GT =                                          (15)
                                              PAin

This parameter represents the gain obtainable if conjugate matching occurred at
the input. In general, the GT gain is less than both GA and GP . However, in the
presence of a conjugate matching at the input, GT equals GP , while with a conjugate
matching at the output, GT equals GA . Consequently, in situations where there is a
conjugate matching at both the input and output, GT = GP = GA occurs.
Considering the circuit in Figure 12, it is possible to obtain the reflection coefficients
at the input and output of the quadripole:

                                            ZIN − Z0
                                    ΓIN =                                            (16)
                                            ZIN + Z0

                                            21
                                               ZL − Z0
                                        ΓL =                                                (17)
                                               ZL + Z0
In particular, considering the system (12), it is possible to know the input and output
reflection coefficient in terms of S-parameters:

                                        b1         S12 S21 ΓL
                               ΓIN =       = S11 +                                          (18)
                                        a1         1 − S22 ΓL

                                        b2         S21 S12 ΓS
                              ΓOU T =      = S22 +                                          (19)
                                        a2         1 − S11 ΓS

In this way, for each gain, it is possible to provide a definition as a function of
S-parameters and reflection coefficients:

                                         |S21 |2 (1 − |ΓL |2 )
                             GP =                                                           (20)
                                     (1 − |ΓIN |2 )|1 − S22 ΓL |2

                                         |S21 |2 (1 − |ΓS |2 )
                            GA =                                                            (21)
                                    |1 − S11 ΓS |2 (1 − |ΓOU T |2 )

                |S21 |2 (1 − |ΓL |2 ) (1 − |ΓS |2 )   |S21 |2 (1 − |ΓL |2 ) (1 − |ΓS |2 )
         GT =                                       =                                       (22)
                 |1 − S22 ΓL |2 |1 − ΓIN ΓS |2         |1 − S11 ΓS |2 |1 − ΓOU T ΓL |2


2.1.2   Noise Figure

The generation of electrical noise within a circuit plays a pivotal role in shaping
its performance as it sets a minimum threshold for the signal level that the system
can detect. When assessing the noise characteristics of a Low-Noise Amplifier, a
widely employed metric is the noise factor represented by F . This metric provides
information about the degradation of the signal-to-noise ratio between the input and
output of the two-port network:

                                                   IN    S
                                      SN RIN     NIN
                                  F =          = SOU T                                      (23)
                                      SN ROU T   N        OU T


                                               22
In many cases, it is convenient to utilize the logarithmic scale in decibels (dB). The
noise figure parameter, denoted by N F , is defined as:


                                   N F = 10 log(F )                               (24)

To fully characterize a noisy amplifier, an effective approach is to use a noiseless
network with the addition of two separate equivalent input noise generators: an
equivalent voltage noise generator (en ) and an equivalent current noise generator
(in ).

                         en
                         −
                         +




                                                               +

                              in           Noiseless         Vu (t)
                                           amplifier
                                                               −



                 Figure 13: Noise Characterization of an Amplifier


Ideally, en is obtained by a procedure of shorting the input terminals of the amplifier
and measuring the RMS value of the output noise voltage VnOU T , considering the
voltage gain Av to be known. In parallel, in is obtained by keeping the input terminals
of the amplifier open and measuring the RMS value of the output noise voltage,
considering the voltage gain Av and the input resistance Rin of the amplifier to be
known:
                                  Vn                  Vn
                            en = OU T            in = OU T
                                   Av                 Av Rin

They are stochastic processes and can be described by the associated Power Spectral
Density (PSD):
                                 2              2
                                  V                A
                            Sen              Sin
                                  Hz               Hz

Considering the configuration shown in Figure 14, the total output noise is influenced
by both the internal noise sources (en and in ) and the effect of thermal noise et of
the signal generator impedance.

                                          23
                          et       en




                          −




                                   −
                          +




                                   +
                 ZS
                                        in            Noiseless
                      +
                                                      amplifier
                VS    −




               Figure 14: Internal Noise Sources and Thermal Noise


The stochastic processes en and in are correlated with each other and, in general,
this correlation tends to increase with increasing frequency. However, for most cases
of practical interest, it is possible to approximate the two generators as uncorre-
lated processes. Consequently, the power spectral density of the resulting process
can be obtained simply by summing the power spectral densities of the individual
contributions. This consideration leads us to derive the expression (27) for the noise
figure.
The noise power output due to thermal noise of the source termination is:

                                NOU T et = KT ∆f GT                               (25)

The total noise power output is:

                                        Sen + Sin |ZS |2
                           NOU TQ =                      ∆f GT                    (26)
                                             4RS

Hence, considering that the noise figure can also be defined as the ratio between the
total output noise power and the output noise power due to the thermal noise of the
source termination, we obtain:

                  NOU T et + NOU T en ,in     NOU TQ      Se + Sin |ZS |2
          NF =                            =1+          =1+ n                      (27)
                         NOU T et             NOU T et       4KT RS

From this equation we can observe that the noise figure is affected by various factors,
including the power spectral densities Sen and Sin and the impedance ZS of the signal
generator. When aiming to design an amplifier with low noise, the initial crucial
step involves carefully selecting the suitable active device. Once the active device

                                             24
is chosen, the primary focus is on determining the optimal termination ZSopt , which
helps minimize the noise figure. In simpler terms, achieving a Low-Noise Amplifier
involves finding the best possible match between the impedance of the signal source
and the input impedance of the amplifier. It is important to note that the minimum
value of NF will undoubtedly be achieved when XS = 0, so under the assumption
that ZS is real.

                 d(N F )   2RS Sin 4KT RS − (Sen + RS2 Sin )4KT
                         =                                      =0                     (28)
                  dRS                   (4KT RS )2

For a given amplifier, the source resistance value at which the noise figure reaches
its minimum is:
                                                s
                                                    Sen
                                      RSopt =                                          (29)
                                                    S in

Because ZS is typically determined by project specifications, it becomes crucial to
integrate impedance transformation networks between the source and the amplifier
input. This ensures that the amplifier perceives an impedance that is optimal in
terms of noise considerations. By employing the Friis Formula, the impact of all
noise characteristics can be assessed, allowing for the calculation of the overall noise
figure for a network consisting of the cascade of two or more quadripoles.

                                                               n
                   N F2 − 1            N Fn − 1               X   N Fk − 1
   N Ftot = N F1 +          + ... +                  = N F1 +                          (30)
                     GA1            GA1 GA2 ...GAn−1          k=2
                                                                  Q k−1
                                                                        GA i=1    i




The total noise figure (N Ftot ) is computed as the weighted sum of the noise figures of
the individual quadripoles, with the weights determined by the gains of the preceding
quadripoles. Consequently, the value of the overall noise figure is predominantly
influenced by the characteristics of the first stage. Thus, in order to minimize the
total noise figure of the system, it is crucial to ensure that the first stage possesses the
lowest noise figure and the highest achievable gain. The LNA typically positioned
as the initial stage in a signal receiver, holds significant importance in this context.


                                            25
Its design, characterized by high gain and a low noise figure, is crucial for optimal
system performance.


2.1.3   Bandwidth

The bandwidth of a Low-Noise Amplifier refers to the range of frequencies over
which it effectively amplifies the input signal while maintaining desirable performance
characteristics. To calculate the bandwidth of an LNA, we can use the following
formula:
                                    BW = fhigh − flow                              (31)

where fhigh represents the upper frequency limit, and flow represents the lower fre-
quency limit. Typically, the upper frequency limit is determined by the gain roll-off
characteristics of the amplifier. As the frequency increases beyond this limit, the
gain of the amplifier starts to decrease. This roll-off is often specified as the fre-
quency where the gain drops by 3 dB, known as the -3 dB cutoff frequency. On the
other hand, the lower frequency limit is influenced mainly by the input and output
coupling capacitors. These capacitors form a high-pass filter that attenuates low-
frequency signals. The -3 dB point of this high-pass filter corresponds to the lower
frequency limit of the LNA bandwidth. When designing an LNA, it is crucial to con-
sider several factors to achieve the desired bandwidth. Proper impedance matching
at the input and output of the LNA, the choice of active devices, and the internal
capacitances of transistors and interconnects all contribute to the overall high-pass
filter response and affect the lower frequency limit. By optimizing these factors, the
LNA bandwidth can be maximized, enabling effective amplification of signals across
a wide frequency range.


2.1.4   Stability

The stability of a Low-Noise Amplifier is a crucial aspect of its design, as it pertains
to the amplifier ability to maintain its intended characteristics without experiencing
oscillations or instabilities. An unstable LNA can lead to signal distortion, oscil-
lations, decreased gain, and even damage to the amplifier itself. Thus, ensuring
stability is an essential step in the design and development process. Among the dif-


                                          26
ferent forms of stability, unconditional stability emerges as a fundamental concept.
Unconditional stability refers to the LNA capability to remain stable regardless of
load conditions or the characteristics of external signal sources. This implies that
the LNA will consistently maintain stability, unaffected by changes in load or the
connection of external sources. This property guarantees reliable operation across
various usage scenarios. Evaluating the stability of an LNA commonly involves Rol-
let’s Stability Factor, denoted as K, which serves as a numerical parameter, which
is calculated on the basis of the LNA S parameters. If the value of K exceeds 1, the
circuit is considered unconditionally stable. Conversely, if it falls below 1, it indicates
the presence of regions of instability or potential oscillations. Hence, a value greater
than 1 is desired to ensure the unconditional stability of the LNA.

                         1 − |S11 |2 − |S22 |2 + |S22 S11 − S21 S12 |2
                   K=                                                  >1             (32)
                                         2|S12 ||S21 |

Mathematically, unconditional stability can be defined by establishing requirements
for the magnitude of input and output reflection coefficients of a two-port, stating
that they remain less than 1 for any passive load and source impedance. In this
context, “passive” implies that the real part of the load and source impedance is
positive, i.e., |ΓS | < 1, |ΓL | < 1 [10].
The condition for input reflection coefficient (ΓIN ) is expressed as:

                                               S12 S21 ΓL
                             |ΓIN | = S11 +               <1                          (33)
                                               1 − S22 ΓL

Similarly, the condition for output reflection coefficient (ΓOU T ) is given by:

                                               S12 S21 ΓS
                            |ΓOU T | = S22 +              <1                          (34)
                                               1 − S22 ΓS

If either of the conditions (33) or (34) is violated, the two-port is considered condi-
tionally stable. Conditional stability implies that the dual port will exhibit stability
within a limited range of passive loads and source impedances while potentially dis-
playing fluctuations for other passive terminations.

                                            27
2.1.5   Linearity

Linearity is the ability of a Low-Noise Amplifier to faithfully amplify the input sig-
nal while minimizing the effects of distortion and intermodulation. Two fundamental
parameters used to evaluate the linearity of an LNA are the Input Third-Order Inter-
cept Point (IIP3) and the 1dB Compression Point (1dBCP). When the input signals
have high power levels, devices become nonlinear, and the output signal reaches a
saturation point. This phenomenon is known as gain compression. Background noise
and gain compression define a dynamic range, which is the range of minimum and
maximum power over which the two-port device will operate linearly. Operating be-
low the 1 dB compression point ensures minimal distortion and maintains linearity,
as an increase in input power results in a proportional increase in output power.
When two or more signals are introduced into a nonlinear device, they interact
with each other, generating additional frequencies called intermodulation products
or distortion products, which were not present in the original signals. Among these,
third-order products are particularly significant because they have higher amplitudes
and are closer to the desired signals. Their proximity makes them more susceptible
to interference and distortion, leading to signal quality degradation. For example,
considering two input signals, f1 and f2 , the third-order intermodulation products
include 2f1 −f2 and 2f2 −f1 . If these third-order products overlap with the frequency
of other desired signals, they can cause interference, distortion, and the generation of
unwanted signals. The IIP3 represents the input power level at which the third-order
intermodulation products reach the same magnitude as the desired signal, causing
distortion. A higher IIP3 value indicates greater linearity, as it means the amplifier
can handle stronger input signals, in terms of power, without significant distortions.
A commonly used graphical technique to characterize the linearity of a device or
circuit operating in a limited frequency band is illustrated in Figure 15.




                                          28
              Pout (dBm)
                                                                  IP3
               OIP3
                                           1dB
            1dBCPout


                                            al
                                       ment
                                    nda
                                 Fu
                   GT




                                                   D3
                                                 IM
                                                        1dBCPin    IIP3        Pin (dBm)

             Figure 15: Graphical Representation of 1dBCP and IP3


In this diagram:

   • IMD3 represents the measure of the third-order distortion products produced
     by a nonlinear device when two tones closely spaced in frequency are fed into
     its input:
                                                 3
                                   IM D3 = k Pin                              (35)

     From the definition of IIP3, we have:
                                                                           GT
                            GT IIP 3 = k IIP 33 =⇒ k =                                     (36)
                                                                          IIP 32
     Then in logarithmic scale, we obtain:
                                                 3
                                                   
                        10 log(IM D3) = 10 log Pin   + 10 log(k) =⇒
                                                                                           (37)
                   10 log(IM D3) = 30 log(Pin ) + 10 log(GT ) − 20 log(IIP 3)

   • The input 1 dB Compression Point (1dBCPin ) is defined as the input power
     at which the power gain (GT ) decreases by 1 dB compared to its value for
     small-amplitude signals;

   • The output 1 dB Compression Point (1dBCPout ) is defined as the corresponding
     output power for the 1 dB Compression Point at the input;

                                                 29
   • The Input Third-Order Intercept Point (IIP3) is defined as the input power
     level at which the output power of the fundamental signal and the output
     power of the IMD3 become equal;

   • The Output Third-Order Intercept Point (OIP3) represents the corresponding
     output power level for IIP3;


2.2    Noise Analysis

Electronic noise is characterized by undesired, unpredictable fluctuations or distur-
bances within an electronic system. These fluctuations manifest as random variations
in physical quantities, making them challenging to precisely predict using determin-
istic models. Nevertheless, statistical descriptions can be employed in certain cases
to analyze these random fluctuations. To assess the magnitude of this randomness,
one can study a stochastic process denoted as X(t), which combines the determin-
istically known value of the observed quantity with a superimposed random phe-
nomenon. The amplitude of this random variation can be quantified using the root
mean square (RMS) value, providing a measure of its overall intensity:

                                         sZ
                                            ∞
                           XRM S (t) =           x2 fx (x; t) dx                 (38)
                                            −∞


Another key measure for analyzing electronic noise is the noise power spectral den-
sity (PSD), which provides information about the distribution of noise power across
different frequencies, aiding in the identification of dominant noise sources within a
specific frequency range:

                                              1
                              Sx (f ) = lim     |XT (f )|2                       (39)
                                         T →∞ T


where XT (f ) is the Fourier coefficient of the periodic extension of X(t) with period
T, called XT (t).




                                           30
The main sources of electronic noise that may introduce undesired changes in the
voltage or current levels of electronic signals and cause distortion of the original
transmitted information are [11]:

   • Thermal noise

   • Shot noise

   • Flicker noise


2.2.1    Thermal Noise

Thermal noise, also known as Johnson noise, is a fundamental type of noise that oc-
curs due to the random movement of charge carriers, within electronic components
and conductors at non-zero temperatures. According to the principles of statistical
mechanics, temperature is directly related to the average kinetic energy of parti-
cles. In electronic circuits, materials that conduct electricity, such as resistors and
transistors, contain a multitude of electrons that are constantly in motion. These
electrons interact with lattice vibrations, resulting in unpredictable fluctuations in
their motion. Since electronic signals are usually very small, these random fluctua-
tions can interfere with the desired signals, leading to a degradation in signal quality.
The magnitude of thermal noise is determined by the well-known Johnson-Nyquist
formula:

                                          p
                                   Vn =    4kT R∆f                                  (40)

Where:

   • Vn represents the noise voltage [V]

   • k denotes Boltzmann’s constant (1.38 × 10−23 J/K);

   • T corresponds the absolute temperature [K];

   • R is the resistance [Ω];

   • ∆f indicates the considered bandwidth [Hz].

                                           31
Therefore, the available thermal noise power Pn , i.e. the thermal noise power that a
resistor can supply to a matched load and the thermal noise power spectral density
SVn generated by a resistor, can be expressed , respectively, from the equations (41)
and (42):

                                     Pn = kT ∆f                                    (41)


                                   SVn (f ) = 4kT R                                (42)

From the formulas, it is evident that increasing temperature or resistance or widening
the bandwidth results in higher levels of thermal noise. It is important to consider
these factors in electronic circuit design and signal processing to minimize the impact
of thermal noise on signal quality. Moreover, utilizing equation (41), it is possible to
determine the minimum equivalent input noise, or noise floor, for a receiver at room
temperature (T0 = 17 ◦ C or T0 = 290 K) with a 1 Hz bandwidth:


             10 log(kT0 ) = 10 log 1.38 × 10−23 × 290 ≈ −174 dBm/Hz
                                                     
                                                                                   (43)

This value represents the theoretical lower limit of detectable signals in a system
due to the presence of thermal noise. Signal levels below this noise floor are often
considered too weak to be reliably distinguished from the noise.


2.2.2   Shot Noise

Shot noise, also known as Poisson noise, is a fundamental type of electrical noise
that arises from the discrete nature of electric charge and the statistical behavior of
electrons. The random fluctuations in current or voltage levels caused by shot noise
are a result of the discrete arrival of charge carriers at a given time interval. This
noise can be described by a Poisson distribution, and its magnitude increases with
the average current. The shot noise current mean-squared value can be expressed as:


                                     In2 = 2qI0 ∆f                                 (44)



                                          32
Here, q represents the elementary charge (1.602 × 10−19 C), I0 is the average cur-
rent flowing through the device, and ∆f is the bandwidth over which the noise is
measured.
The power spectral density of shot noise is:

                                    SIn (f ) = 2qI0                                (45)

This equation indicates that shot noise is frequency-independent, often referred to
as white noise. Shot noise is an important consideration in various fields, including
communication systems, semiconductor devices, and photonics. In these fields, pre-
cise signal detection and accurate measurements are crucial, and understanding and
managing shot noise are essential for achieving reliable performance.


2.2.3   Flicker Noise

Flicker noise, also known as 1/f noise, is a type of electronic noise that exhibits a
spectral density decreasing as frequency increases. It is particularly important in low-
frequency applications. The power spectral density of flicker noise can be described
mathematically using Hooge’s constant (αH ), and specific constants (β and γ) that
vary for each device:

                                                   Iβ
                                   SIn (f ) = αH                                   (46)
                                                   fγ

The primary cause of 1/f noise in semiconductor devices can be attributed to the
technological process by which the device is manufactured, specifically the density
of states. The occurrence of flicker noise is a result of the random nature of carrier
generation and recombination processes. These processes introduce fluctuations in
the carrier density, consequently leading to variations in the current flowing through
the device and giving rise to flicker noise. The density of states represents the
number of available energy states within a specific energy range in the material. A
higher density of states implies a greater number of states accessible for carriers to
occupy or vacate, so it intensifies the trapping and detrapping processes, thereby
amplifying the level of flicker noise. Comprehending and regulating the generation


                                          33
and recombination of carriers in energy states, as well as managing the density of
states, is critical for minimizing flicker noise in electronic devices and systems.
In summary, conducting a thorough noise analysis and identifying the sources of noise
enable the implementation of a wide range of highly effective strategies to mitigate
or minimize noise. These strategies may include techniques like shielding, filtering,
incorporating low noise components, and amplifiers. By employing such measures,
optimal performance levels can be achieved for electronic systems, guaranteeing their
smooth operation.




                                         34
                                                                                    3
             Analysis of the Current BPM
                   System in the PS Ring

Chapter 3 focuses on the analysis of the BPM system currently used in the PS
particle accelerator. Particular attention is given to the detailed description of the
Low-Noise Amplifier employed, and the results of simulations and measurements
conducted on the system are presented. Additionally, the chapter examines in detail
the measurement methods that have been tested, with a particular emphasis on
evaluating the noise figure of the LNA. Another important aspect is the positioning
strategy of the LNA within the PS to ensure effective shielding from the radiation
generated by the particle accelerator. This aspect is of fundamental importance to
ensure the proper functioning and longevity of the device.


3.1    Overview of the Current BPM System

The initial phase of the project focused on an in-depth analysis of the currently used
system in the PS particle accelerator. This preliminary stage involved a comprehen-
sive theoretical study and simulations of the existing system, examining its specifica-
tions and performance characteristics. Concurrently, rigorous laboratory tests were
conducted to acquire empirical data regarding the system behavior. From the outset,
the primary objective of this phase was to obtain a profound understanding of the
functioning of the current system under various operating conditions and identify
potential areas for improvement or alteration in the context of the new project. The
adopted approach in this study has established a solid foundation for designing the
new LNA, with the aim of updating the electronics, but without compromising the
current performance.
The block diagram in Figure 16 illustrates the comprehensive configuration of the
current BPM system that consists of a pick-up module, responsible for capturing

                                          35
the signals from the particle beam, and an external chassis housing the Low-Noise
Amplifier and other necessary electronics for signal processing.




            Figure 16: Block Diagram of the Current BPM System [12]


The pick-up module is strategically positioned in close proximity to the particle beam
to ensure efficient and accurate signal capture. A 5-meter long cable connects the
pick-up module to the external chassis, allowing the acquired signals to be transmit-
ted for further processing. The selection of this cable is crucial to preserve signal
integrity, requiring careful consideration of shielding and impedance matching to
minimize any potential signal loss or interference. Recognizing the sensitive nature
of the electronics within the system and the radiation environment prevalent near
the particle accelerator, the external chassis has been installed in a gap between
two concrete blocks, as shown in Figure 17. This strategic placement provides effec-
tive shielding, safeguarding the components from potential damage or interference
caused by high-energy radiation. It is worth noting that semiconductor electronics
can generally withstand an integrated dose of roughly 0.5 Gy to 1 kGy, provided
that appropriate devices and design methods are carefully selected. Importantly, the
area where the pick-up module is installed is subjected to a yearly radiation level of
approximately 40 kGy, whereas the yearly radiation in the concrete gap measures
around 40 Gy [12]. This significant difference in radiation between the two areas


                                         36
demonstrates that concrete acts as a formidable barrier against high-energy radia-
tion, substantially reducing the exposure of the electronic elements to radiation levels
that are more acceptable for their proper operation.




        Figure 17: Electronics Chassis in gap between two Concrete Blocks



3.2    Examination of the Current LNA

The Low-Noise Amplifier adopted for the present system is a folded cascode with
lossless feedback configuration, featuring two key stages. As can be observed from
the Figure 18, the first stage consists of three BF862 JFET (Junction Field-Effect
Transistor) devices connected in parallel, while the second stage employs a cascode
arrangement incorporating the BFT92 and BFR92A transistors. Additionally, two
feedback mechanisms are present: the first feedback is constituted by a transformer
formed by L1, L2, L3, and L4, which is useful for precisely adjusting the gain of the
LNA, while the second feedback, consisting of the resistance R20 , sets the impedance
seen at the JFET gates to 200 Ω. This impedance value is optimal for noise per-

                                          37
formance, effectively minimizing the noise figure of the amplifier. Furthermore, a
transformer is used to convert the input impedance to 50 Ω and thus obtain the
input matching.
The configuration adopted in the first stage serves to enhance the noise performance
of the LNA by limiting the collective noise voltage supplied
                                                          √     by each JFET. The
voltage noise of a single JFET is approximately 0.8 nV/ Hz. Through the parallel
combination of the three JFETs, the total voltage√ noise is reduced by a factor equal
   √
to 3 corresponding to approximately 460 pV/ Hz and an equivalent noise figure
of approximately 1 dB:


               "                2      #                    √    !2    
                         Vn                            460 pV / Hz
N F = 10 log        √                 + 1 = 10 log             √      + 1 = 0.988 dB
                        4KT RS                       0.9099 nV / Hz
                                                                                  (47)

This significant reduction in voltage noise allows for a LNA with extremely high
sensitivity, crucial for detecting weak signals. However, it is worth noting that the
number of JFETs represents a trade-off. Increasing the number of JFETs in parallel
reduces the voltage noise, thereby improving the LNA noise performance. On the
other hand, an increase in the number of JFETs in parallel results in a rise in
the overall gate capacitance, which can worsen the amplifier frequency response.
Consequently, optimizing the number of devices in parallel is an important aspect in
balancing the noise performance and frequency response characteristics of the LNA.




                                               38
                 Figure 18: LNA Schematic of the Current System


To thoroughly evaluate the performance of the current Low-Noise Amplifier (LNA)
and closely examine its behavior and characteristics under controlled conditions, the
first step was to conduct simulations using LTspice XVII. The simulation process
involved creating a circuit using ideal components. By running the simulations, we
obtained detailed results for power gain (S21 ), input reflection coefficient (S11 ), and
noise figure (NF). As shown in following figures, simulations revealed that the LNA
exhibits a power gain of around 24 dB, an input reflection coefficient of around -27 dB
and a noise figure of around 1.5 dB. These simulated values were used as a reference
point to understand the expected performance of the LNA in an ideal context.




                                           39
               Figure 19: Plots of S21 and S11 for the Current LNA




                    Figure 20: Plot of NF for the Current LNA


However, the pratical performance of the LNA is inevitably influenced by various
non-idealities, such as parasitic effects and component variations. For this reason,
extensive laboratory measurements were conducted on the physical prototype of the
LNA. By juxtaposing simulation and experimental data, we gained a comprehensive
understanding of the current LNA actual performance under real-world conditions.
This process allowed us to not only quantify the LNA gain, input matching, and noise
figure accurately but also to pinpoint any deviations or limitations in the design.
The power gain and input reflection coefficient were measured using the Rohde &
Schwarz ZNB4 VNA (Vector Network Analyzer), and the results of these measure-
ments showed no significant deviation from the simulated values obtained in LTspice

                                        40
XVII. This consistency between simulation and measurement validated the accuracy
of the simulation model, providing confidence in its predictive capability regarding
S-parameters. However, measuring the very low noise figure proved to be more com-
plex, as it necessitated finding a reliable and suitable method to obtain accurate
measurements. The pursuit of an appropriate NF measurement technique required
time and effort. Various methods were explored and evaluated to determine the
most reliable approach. Among these, the method that allowed us to obtain reliable
results is the one known as the Y-factor method. This technique involves employing
a noise source that has a pre-calibrated Excess Noise Ratio (ENR), which is a crucial
parameter in the process. The ENR is defined as the ratio between the difference in
noise temperatures of the noise source in its on (hot) and off (cold ) states and the
reference temperature (usually taken as 296K) [13]:

                                                              
                                                   Tsh − Tsc
                             EN RdB = 10 log                                      (48)
                                                       T0

The ENR calibration of the noise source is essential to accurately quantify the noise
power added by the DUT. By knowing the ENR value, one can establish a direct
relationship between the measured noise power and the actual noise temperature of
the DUT.

                       Tsh
                       R

                                                               Spectrum
                                          DUT
                                                               analyzer


                       R
                       Tsc

                 Figure 21: Block Diagram of the Y-factor Method


The Y-factor itself is a key metric in this method, representing the ratio of two noise
levels: one measured with the noise source hot and the other with the noise source
cold:



                                          41
                                            Nh
                                      Y =                                        (49)
                                            Nc

The key advantage of using the Y-factor method lies in its ability to model the DUT
noise performance through its equivalent noise temperature, denoted as Te . This
equivalent noise temperature represents the effective noise temperature that would
produce the same amount of output noise power as the DUT. It can be calculated
as:

                                          No(added)
                                   Te =                                          (50)
                                           kBGA

Where No(added) is the additional output noise power contributed by the DUT, k
is Boltzmann’s constant, B is the DUT available bandwidth, and GA is the DUT
available power gain.
By modeling the component noise through its noise temperature, we can easily find
the output noise for the two input noise levels. According to [14], the output noise
for the hot source (Nh ) at temperature Th is given by equation (51), and the output
noise for the cold source (Nc ) at temperature Tc is determined using equation (52):


                             Nh = kTh BGA + kTe BGA                              (51)


                             Nc = kTc BGA + kTe BGA                              (52)

Substituting (51, 52) in (49), we get the following equation for the Y-factor:

                                          Tsh + Te
                                   Y =                                           (53)
                                          Tsc + Te

From which is derived:

                                         Tsh − Y Tsc
                                  Te =                                           (54)
                                            Y −1

                                          42
Once Te is determined, we can then calculate the noise figure (N F ) using the follow-
ing equation:

                                                  
                                                Te
                               N F = 10 log 1 +                                    (55)
                                                T0

In our context, we have adopted a measurement approach based on the use of the
Noisecom NC346Y noise source, as depicted in Figure 22. This noise source is char-
acterized by a signal-to-noise ratio (ENR) of 15.14 dB at a frequency of 10 MHz.
Additionally, for conducting this analysis, we employed the Anritsu MS2692A spec-
trum analyzer, equipped with the ”noise figure measurement” function. This func-
tion, leveraging knowledge of the noise source used, allows for the direct calculation
of the noise figure without the need for additional calculations or external processing.




                     Figure 22: Noisecom NC346Y Noise Source


The noise source is set to generate a broadband noise signal covering the desired fre-
quency range and generates noise known as Additive White Gaussian Noise (AWGN)
using a Zener Diode. This diode simulates various random processes observed in na-
ture. In Figure 23, it can be observed that when a 28 V power supply is applied to
the noise source, the diode is reverse-biased into the avalanche region. In this state,
the diode produces a significant amount of noise due to the avalanche effect, which


                                          43
involves electronic generation and multiplication of electrons across the p-n junction,
resulting in the generation of high-power noise. This noise is essential for generating
a random signal of uniform amplitude at various frequencies. On the other hand,
when the power supply is disconnected, the noise source shows only a small amount
of noise at the output since the diode is no longer biased and is not involved in the
noise generation process. To ensure a constant and well-defined output, an RF choke
(RFC) is used, which is a large enough inductor to act as an open circuit at all the
frequencies of interest and ensures the decoupling of the DC power supply. Finally,
an attenuator is used, which must be designed to produce the necessary attenua-
tion and at the same time match the impedances. This attenuator ensures also that
whether the diode is on or off, the noise source maintains a relatively constant match
at the output.

                                                                    I

    28 V

                              Attenuator
                RFC
                                                    Reverse bias        Forward bias
                                                                                       V
                                                                D
                                                              eB

                                                             D
                                                          nch

                                                        er B
                                                    ala

                                                     Zen
                                                  Av




 Figure 23: Schematic of a Diode-based Noise Source and Zener Diode I-V Curve


The measurement process begins with a calibration operation, which plays a vital role
in ensuring precise noise figure measurements. During calibration, the measurement
system is configured to compensate for losses and distortions introduced by cables,
adapters, and other components between the noise source and the amplifier input, as
well as between the amplifier output and the spectrum analyzer. This step ensures
that the system is calibrated to measure only the characteristics of the device under
test (DUT) and not any external influences. Once calibration is completed, the noise
source is connected to the LNA input, while the LNA output is connected to the
input of the spectrum analyzer. After setting up the equipment, the measurement
parameters, such as the frequency range and resolution bandwidth, are adjusted to

                                           44
display the measure of the noise figure.
For the specific Low-Noise Amplifier being used, the results over a frequency range
of 1 MHz to 30 MHz are tabulated in the Table 1 (NF (dB) - LNA). Considering
the reference frequency of 10 MHz, the measured noise figure of LNA is found to be
equal to 1.237 dB.


                                       Spectrum analyzer
                                                                 Input
                               +28 V
                                                                Output




                                   Noise source                 LNA



                    Figure 24: LNA Noise Figure Measurement



In the same way, the measurement of the entire chassis was also carried out, and the
results are reported in the Table 1 (NF (dB) - Chassis).


                                       Spectrum analyzer
                                                                 Input
                             +28 V
                                                                Output




                    Noise source        Attenuator     Filter    LNA     VGA



                  Figure 25: Chassis Noise Figure Measurement




                                                  45
           Frequency (MHz)        NF (dB) - LNA        NF (dB) - Chassis

                   1                   2.367                 2.449

                   3                   1.389                 2.288

                   5                   1.215                 2.332

                   7                   1.295                 2.328

                   10                  1.237                 2.473

                   13                  1.345                 2.644

                   15                  1.206                 2.806

                   17                  1.211                 3.027

                   20                  1.303                 3.368

                   23                  1.216                 3.787

                   25                  1.431                 4.041

                   27                  1.619                 4.354

                   30                  1.544                 4.671

    Table 1: Summary of LNA and Chassis Noise Figure Measurement Results


To evaluate the noise figure of the entire chassis, another noise source, designed by
the current system designer, was employed (Figure 26). This source consists of two
resistors controlled at specific physical temperatures to generate the required noise
levels for the experiment. To create the cold noise source, one resistor is immersed
in liquid nitrogen (LN2 ), maintaining a constant temperature of 77 K. This low-
temperature environment ensures a stable and well-defined generation of the noise
signal, significantly contributing to measurement precision. For the hot noise source,
the ambient temperature of approximately 296 K is utilized. To preserve the integrity
of the noise signals and minimize unwanted interference, a high-quality coaxial relay
is used to connect the resistors to the chassis input. Subsequently, the noise figure


                                         46
measurement was conducted in two ways. In the first method, the same spectrum
analyzer previously used was employed, automatically providing the noise figure (NF)
measurement. The results are presented in Table 2 under the column (NF (dB) -
MB ). In the second method, the measurement was more manual: the spectrum
analyzer was used to measure the output noise under hot/cold conditions, and manual
calculations were performed to determine the Y-factors and, consequently, the NF.
The results are shown in the column (NF (dB) - MA ) of Table 2. In the second case,
to obtain accurate measurements of the Y-parameter using the spectrum analyzer, it
was essential to properly set up the instrument. First, adjust the internal attenuator
to 5 dB and set the resolution bandwidth (RBW) to 300 kHz, along with the video
bandwidth (VBW) to 30 Hz, ensuring that the internal amplifier is turned off. Next,
set the desired center frequency. Then, define a delta marker and proceed with the
measurement of the output noise using both the hot and cold sources. The measured
values correspond to the Y-factors of the entire chassis, including the attenuator,
low-pass filter, LNA, and VGA. It is worth noting that among the obtained noise
figure results listed in the table, no significant differences are evident.




                  Figure 26: Cold Noise Source - Resistor in LN2




                                         47
       Frequency (MHz)     Y (dB)     NF (dB) - MA      NF (dB) - MB

              0.5            2.5           2.31               -

              5              2.5           2.31              2.33

              10             2.7           2.32              2.47

              20             1.9           3.24              3.37

              30             1.3           4.62              4.67

              Table 2: Chassis Noise Figure Measurement Results


In conclusion, the measurement of LNA compression was performed using the VNA.
The LNA exhibits a compression of 0.1 dB when the input power is -24 dBm and a
1 dB compression point at an input power of -22 dBm.




Figure 27: 1dB and 0.1dB Compression Points at 10 MHz - Laboratory Measurement
           of the Current LNA



                                     48
                                                                                     4
                            SiGe HBT LNA Design
                                    Methodology

Chapter 4 focuses on the methodology used to design the LNA, discussing the se-
lected components in detail and illustrating the principles applied to design the LNA
schematic. Initially, the project specifications are examined, including the noise fig-
ure, the input matching, and the bandwidth. Next, a detailed explanation for the
choice of SiGe HBT technology and the active component to be used in the first
stage of the LNA is provided. Furthermore, the design flow adopted to obtain the
first stage prototype is described in depth, showing the results of the simulations and
laboratory tests. In the final part, the principles adopted for the design of the second
stage and the feedback present in the system are discussed in detail, also explaining
the components used.


4.1    Key Requirements for the New Low-Noise Amplifier

The primary goal of this project is to upgrade the LNA currently used in the analog
front-end of the beam position monitor for the proton synchrotron. Despite proven
reliability and functionality over time, the LNA electronics is gradually approaching
the end of its life cycle. This puts the system in a phase that requires a proactive
approach to ensure that optimal performance is maintained. The electronics renewal
process represents a crucial step to enhance the LNA performance and allow it to
be adapted to future challenges. In addition, the upgrade of the electronics results
in greater robustness of the system in the long term, minimizing the dependence on
obsolete and hard to find components.
Based on the in-depth analysis of the current LNA, discussed in the previous chapter,
we were able to define the following key specifications for the new project:



                                          49
   • Noise Figure: the LNA is expected to have a noise figure (NF) of less than
     2 dB. Attaining a low noise figure ensures that the LNA contributes mini-
     mal additional noise to the original signal, thereby preserving its quality and
     maximizing the overall signal-to-noise ratio.

   • Bandwidth: the LNA must operate within a bandwidth ranging from 100 kHz
     to 50 MHz. The aim is to extend the bandwidth compared to the current
     LNA, which is limited to 30 MHz by an input filter, while also considering the
     integration requirements with the other system components.

   • 50 Ω Input Matching: the LNA should exhibit excellent input matching with
     a reflection coefficient S11 below -20 dB. This characteristic facilitates effi-
     cient power transfer between the coaxial cable and the LNA, minimizing signal
     reflections and maximizing signal integrity.

In order to achieve the objectives of the project, extensive research was carried out
to identify an appropriate new technology. Among the various options, the silicon-
germanium heterojunction bipolar transistor (SiGe HBT) emerged as a particularly
promising choice for the implementation of the new Low-Noise Amplifier. The fol-
lowing sections provide an exhaustive description of this technology, underlining the
figures of merit (FOM) that demonstrate its adaptability to our specific use case.


4.2    The SiGe HBT Technology

In the field of Radio-Frequency (RF) electronics, various semiconductor materials are
widely used, among which silicon-germanium (SiGe) and gallium arsenide (GaAs)
stand out. These materials are employed in various types of transistors, such as
the bipolar junction transistor (BJT), the heterojunction bipolar transistor (HBT),
the metal-semiconductor field-effect transistor (MESFET), the high electron mo-
bility transistor (HEMT), and the metal-oxide-semiconductor field-effect transistor
(MOSFET). It is of fundamental importance to assess the advantages and limi-
tations of these devices through the analysis of common figures of merit (FOM),
which include current-voltage characteristics, stability, power gain analysis, cutoff
frequency, maximum oscillation frequency, and noise factor. This analysis allows for
a significant comparison between devices, facilitating technological choices, especially

                                          50
in application areas such as Low-Noise Amplifiers, power amplifiers, and transmis-
sion/reception systems.
Early bipolar junction transistors (BJT) were considered unsuitable for RF and mi-
crowave circuit applications, due to the limited mobility of both electrons and holes in
silicon. Indeed, electrons in reache a maximum speed of approximately 1 × 107 cm/s,
making silicon a relatively “slow” semiconductor [15]. Therefore, while silicon inte-
grated circuits are cost-effective, they cannot provide optimal performance for design-
ing high-frequency systems. For this reason, III-V materials, such as GaAs, despite
being more expensive, have dominated the RF and microwave market. However,
through the implementation of silicon-germanium (SiGe) alloys to manipulate the
silicon band gap (known as “Band gap engineering”), it was possible to improve the
performance of silicon transistors in the RF field. Based on that, silicon has emerged
as a contender against III-V devices, mainly because it guarantees a less expensive
production process. Although the idea of using SiGe alloys to control the band gap in
silicon devices dates back to the 1960s, the synthesis of defect-free SiGe films proved
to be a challenge until the 1980s. Indeed, it was only through the development of a
suitable technique for growing a homogeneous SiGe alloy on silicon that it became
possible to implement the concept of combining silicon and germanium into an alloy
for use in transistors [16]. The introduction of Germanium (Ge) into Silicon (Si)
has significant implications. First of all, thanks to the higher lattice constant of
Ge compared to Si, the energy band gap of Ge is smaller (0.66 eV) than that of Si
(1.12 eV). This means that thanks to the difference in band gap between silicon and
germanium, it is possible to perform band gap engineering by acting on the relative
concentrations of the two materials, making SiGe a good candidate for band gap en-
gineering. Moreover, to maintain stability and defect-free characteristics, SiGe must
be thin [17]. Consequently, the SiGe proves fitting for the base region, where a small
thickness is intrinsically required to obtain proper performance. This leads to the
formation of a device contains an n-Si/p-SiGe emitter-base (EB) heterojunction and
a p-SiGe/n-Si base-collector (BC) heterojunction. This device is commonly known
as a “SiGe Heterojunction Bipolar Transistor” (SiGe HBT), although it is more ac-
curately called a “Double Heterojunction SiGe Bipolar. The Figure 28 illustrates the
energy band diagrams of SiGe HBT and Si BJT transistors. The two devices have an
identical geometry (emitter, base, collector), and it is assumed that the doping pro-
files of the emitter and the collector are the same. However, the main difference lies
in the structure of the base. In the case of the SiGe transistor, the base is gradually

                                          51
diffused, presenting a doping profile that progressively varies from the emitter-base
junction to the collector-base junction. This approach was originally proposed by
Herbert Kroemer in 1953 [18]. Kroemer’s idea consisted of using a “drift transistor”
to generate an electric field in the base region and to reduce the barrier to electron
injection at the EB junction. This strategy accelerates the movement of minority
carriers from the emitter to the collector, leading to a significantly improved fre-
quency response. The realization of such a device involves gradually increasing the
Germanium (Ge) content linearly from 0% near the EB junction until reaching the
maximum value near the CB junction, followed by a decrease to return to 0%. This
unique feature of SiGe HBT devices provides an additional degree of flexibility in
design. The main reason underlying the use of a heterojunction in HBT lies in the
use of SiGe as the material in the base region. This choice results in a different align-
ment between the valence band (BV ) and the conduction band (BC ). As a result,
there is a significant reduction in the injection of holes from the base to the emitter.
This mechanism circumvents the need to have a strongly doped emitter relative to
the base, as is common in conventional BJTs. The elimination of this requirement
allows the doping concentration in the base region to be increased, thereby reducing
the resistance in this area and consequently improving high-frequency performance.




  Figure 28: Energy Band Diagram comparison between Si BJT and SiGe HBT




                                           52
4.2.1   Suitability to Our Case

In the design of the Low-Noise Amplifier which is the subject of this thesis, the
choice was made to use an RF transistor fabricated with SiGe HBT technology. This
selection was motivated by the exceptional performance offered by these devices,
both in terms of flicker noise (1/f ) and cutoff frequency (fT ). The cutoff frequency
of a transistor plays an extremely important role since it determines the frequency
response of the transistor itself and, consequently, limits the performance of the
entire system. To calculate the cutoff frequency of a bipolar transistor, the following
equation is used [16]:

                                                                           −1
                      1       kT
                fT =              (Ceb + Ccb ) + τe + τeb + τb + τc + τbc           (56)
                     2π       qIc


where Ceb and Ccb represent the emitter-base and collector-base capacitances, while
τb , τe , and τc denote the base, emitter, and collector transit times, respectively. Ad-
ditionally, τeb and τbc correspond to the emitter-base and collector-base space charge
region delay times, respectively.
It is evident that the decrease in τb , caused by the presence of SiGe, directly leads to
an increase in the cutoff frequency fT , compared to conventional Si BJT. According
to the results presented in [15], SiGe HBT demonstrates a substantial improvement
in cutoff frequency fT compared to similarly designed Si BJT. This improvement
is experimentally illustrated in Figure 29, with a remarkable enhancement of ap-
proximately 1.7 times. This performance makes SiGe HBT particularly suitable for
high-frequency operation and perfectly matches the required range between 100 kHz
and 50 MHz for our LNA.




                                              53
   Figure 29: Cutoff Frequency comparison between Si BJT and SiGe HBT [15]


Another important distinctive feature of SiGe HBT transistor is its excellent per-
formance in terms of 1/f noise. This device produces less noise at low frequencies
compared to other technologies such as silicon CMOS devices, GaAs MESFETs,
GaAs HEMTs, and GaAs HBTs. In practice, SiGe HBTs exhibit an 1/f noise per-
formance comparable to that achieved with Si BJTs, achieving a 1/f noise corner
frequency below 500 Hz [16]. This result is highlighted in Figure 30.




Figure 30: Comparison of the low-frequency noise characteristics between Si BJTs
           and SiGe HBTs [15]

                                       54
The difference from the point of view of 1/f noise between SiGe transistors and
silicon transistors with identical area is of great relevance. As highlighted in [15],
to improve wideband noise performance, it is essential to reduce the base resistance
Rbb , increase the transition frequency fT , and enhance the current gain (β). Bandgap
engineering has proven to be an ideal tool to achieve these results, and therefore SiGe
BJT transistors excel in wideband noise performance.
Furthermore, another strong point of SiGe HBT transistors lies in their lower intrinsic
noise compared to other alternative technologies, in fact, it ensures a minimum noise
figure below 0.7 dB at 2.0 GHz, as illustrated in Figure 31. These exceptional
performance characteristics allow low-noise amplifiers based on SiGe HBT to achieve
a noise figure below 2 dB showing optimal signal quality.




               Figure 31: Minimum Noise Figure of a SiGe HBT [15]


Finally, SiGe HBT components enjoy proven reliability and long-term availability,
providing assurance for project continuity and minimizing the dependence on obso-
lete and hard-to-find parts. This aspect is crucial to ensure reliable operation and
sustainable production of the Low-Noise Amplifier.




                                          55
4.3     LNA Design Process

The design process of the SiGe HBT-based Low-Noise Amplifier has been thoroughly
and systematically conducted, in two distinct phases. Initially, special attention was
dedicated to the design and analysis of the first stage. This stage, playing a crucial
role in the initial signal amplification and noise reduction, required meticulous selec-
tion of the active component and careful exploration of the most suitable topology.
Subsequently, following the design flow until the Printed Circuit Board (PCB) fab-
rication, the primary objective was to produce a prototype of the first stage. This
prototype underwent a series of tests aimed at evaluating the suitability of the cho-
sen active component for the intended purposes. Once this verification point was
successfully passed, the design process entered the second phase, which focused on
designing the second stage of the LNA and configuring the LNA feedback. Through
the creation of detailed schematics, accurate simulations using the AWR Microwave
Office software, and the creation of a layout and PCB using the Altium Designer
software, the final printed circuit was obtained. Detailed tests were performed on
this circuit to ensure its effectiveness and desired performance.


4.4     First Stage Design

4.4.1   Selection of the Active Component BFP740F

In the context of designing the first stage of our circuit, the initial focus was on
identifying the optimal active component. With the aim of satisfying the specific
requirements of the project, a thorough analysis was carried out to select the RF
transistor. After careful evaluation of the available alternatives, the choice fell on
low-noise RF transistors produced by Infineon. This selection was motivated by their
design aimed at meeting the needs of applications that require low noise levels and
high linearity. After examining the datasheets of various transistors and comparing
their characteristics, two candidates emerged as the most promising: the BFP720
and the BFP740F, both SiGe wideband RF NPN heterojunction bipolar transistors.
This selection was further supported by empirical laboratory tests and the noise
power spectral density measurement graphs (A2 /Hz) provided by Infineon (Figure
32 and Figure 33).

                                          56
    Figure 32: BFP720 Transistor Noise Power Spectral Density Measurements




   Figure 33: BFP740F Transistor Noise Power Spectral Density Measurements


Of the two selected devices, the BFP740F was preferred. A key factor driving this
decision was the corner frequency (fc ) of the flicker noise. This parameter represents
the critical point at which flicker noise equals white noise. It was observed that
the BFP740F has a lower corner frequency compared to the BFP720. A concrete
example of this difference has been identified considering a current Ic of 5 mA. As
can be seen from the Table 3, provided by Infineon, in the case of the BFP720, the

                                          57
corner frequency is 64.9 kHz, whereas for the BFP740F, such frequency is 14.1 kHz.

              Ic (mA)      fc (kHz) - BFP720        fc (kHz) - BFP740F

                 5                 64.9                      14.1

                7.5               128.6                      57.7

                 10               210.7                     138.8

                 15               435.2                     260.4

       Table 3: Extracted corner frequency values of BFP720 and BFP740F


This significant difference becomes even clearer by proceeding with the simulation of
the noise figure of the first stage of the LNA, while keeping the current value constant.
The comparative analysis of results obtained through simulation, shown in Figure
34, confirms that the BFP740F exhibits a remarkable ability to withstand the effects
of flicker noise at low frequencies. Therefore, the substantial difference regarding
corner frequencies and the demonstrated capability to preserve signal quality at low
frequencies bestow a significant advantage on the BFP740F, thereby confirming the
decision to use it in our project.




         Figure 34: Noise Figure Comparison Plot - BFP720 vs. BFP740F

                                           58
4.4.2      Schematic and Simulations




                  DCVS                         RES
                  ID=V1                        ID=R4
                  V=5 V                        R=750 Ohm

                                                                            CAP
                                                                            ID=C4
                                                                            C=8 pF



                                     RES
                                     ID=R2                                                                      CAP
                                                                            RES
                                     R=18k Ohm                                                                  ID=C2
                                                                            ID=R5
                                                                                                                C=1e6 pF
                                                                            R=20 Ohm



                                                                                                                            PORT
                                                                                                                            P=2
                                                                                                                            Z=50 Ohm
                                                                                       RES
                                               RES                                     ID=R6
                                               ID=R3                                   R=5.6 Ohm
                                               R=10 Ohm




                                                               1
PORT        CAP                                            C
P=1         ID=C1
            C=1e6 pF                                                                    CAP
Z=50 Ohm
                                                 2             SUBCKT                   ID=C6
                                                               ID=S1                    C=3.3 pF
                                                               NET="BFP740F"
                                                 B


                                                               E1    E2
                                                           3          4



                 RES                           RES                  RES
                 ID=R1                         ID=R7                ID=R8
                 R=100k Ohm                    R=2.2 Ohm            R=2.2 Ohm




                                Figure 35: LNA First Stage Schematic



 Symbol     C1       C2       C4        C6            R1             R2         R3        R4       R5      R6        R7        R8

 Value     1 µF      1 µF     8 pF    3.3 pF         100 kΩ         18 kΩ      10 Ω     750 Ω      20 Ω   5.6 Ω     2.2 Ω     2.2 Ω


                                        Table 4: Component values

                                                                   59
Figure 35 shows the initial configuration of the first stage of the LNA, highlighting
its key components. In particular, this stage operates as a common-emitter amplifier.
In order to ensure reliable transistor biasing, a strategic configuration of R1 , R2 and
R4 was adopted, which acts as a negative DC feedback mechanism. Specifically, R1
and R2 were designed as a voltage divider that controls the base voltage (VB ) of
the transistor. This voltage is regulated downstream of the collector resistor R4 .
Consequently, if the collector current (IC ) were to increase, this would result in a
decrease in the voltage VB , thus generating a stabilization of the working point of
the transistor. Capacitor C4 and resistors R3 and R5 play a significant role in circuit
stability, ensuring a K-factor greater than 1 for all frequencies. In particular, from
the simulation point of view, it was observed that the inclusion of C4 and R5 results
in a K-factor greater than 1 in the frequency range of 60 MHz to 4 GHz. This effect
is clearly illustrated in Figure 36, where it is evident that the omission of these two
components results in instability (K < 1). Moreover, it was found that resistor R3
plays a similar role at a frequency of 8 GHz, as illustrated in Figure 37. Finally, the
network R6 and C6 was added to the circuit. This element, introducing a pole, will
prove advantageous to cut the amplifier band.
In general, the voltage gain of a common-emitter amplifier is given by:

                                     vout      gm Rc
                              Av ≜        =−                                       (57)
                                     vin     gm RE + 1

But when gm RE ≫ 1, the voltage gain can be approximated as:

                                               RC
                                      Av ≃ −                                       (58)
                                               RE

It is evident that decreasing the emitter resistor RE results in an increase in gain.
In fact, in general, the resistor present in the emitter is typically used to ensure the
stability of the circuit operating point, but it is then bypassed through the use of
a capacitor. In our context, contrary to this common practice, maintenance of the
stable operating point is achieved through a feedback system between the base and
the collector. However, the emitter resistor (RE = R7 //R8 ) is still included, since
later it will be involved in a feedback loop aimed to stabilize the gain of the LNA.



                                          60
               DCVS               RES
               ID=V1              ID=R4
               V=5 V              R=750 Ohm

                                                            CAP
                                                            ID=C4
                                                            C=8 pF



                           RES
                           ID=R2                                                   CAP
                                                            RES
                           R=18k Ohm                                               ID=C2
                                                            ID=R5
                                                                                   C=1e6 pF
                                                            R=20 Ohm



                                                                                              PORT
                                                                                              P=2
                                                                                              Z=50 Ohm
                                                                       RES
                                  RES                                  ID=R6
                                  ID=R3                                R=5.6 Ohm
                                  R=10 Ohm




                                                 1
 PORT       CAP                              C
 P=1        ID=C1
            C=1e6 pF                                                    CAP
 Z=50 Ohm
                                       2         SUBCKT                 ID=C6
                                                 ID=S1                  C=3.3 pF
                                                 NET="BFP740F"
                                       B


                                                 E1    E2
                                           3            4



              RES                 RES                 RES
              ID=R1               ID=R7               ID=R8
              R=100k Ohm          R=2.2 Ohm           R=2.2 Ohm




Figure 36: First Stage Instability from 60 MHz to 4 GHz with C4 removed and R5
           short circuited




               DCVS               RES
               ID=V1              ID=R4
               V=5 V              R=750 Ohm

                                                            CAP
                                                            ID=C4
                                                            C=8 pF



                           RES
                           ID=R2                                                   CAP
                                                            RES
                           R=18k Ohm                                               ID=C2
                                                            ID=R5
                                                                                   C=1e6 pF
                                                            R=20 Ohm



                                                                                              PORT
                                                                                              P=2
                                                                                              Z=50 Ohm
                                                                       RES
                                  RES                                  ID=R6
                                  ID=R3                                R=5.6 Ohm
                                  R=10 Ohm




                                                 1
 PORT       CAP                              C
 P=1        ID=C1
            C=1e6 pF                                                    CAP
 Z=50 Ohm
                                       2         SUBCKT                 ID=C6
                                                 ID=S1                  C=3.3 pF
                                                 NET="BFP740F"
                                       B


                                                 E1    E2
                                           3            4



              RES                 RES                 RES
              ID=R1               ID=R7               ID=R8
              R=100k Ohm          R=2.2 Ohm           R=2.2 Ohm




                   Figure 37: First Stage Instability at 8 GHz with R3 short circuited




                                                                                                         61
Once the first stage topology was selected, we focused on choosing component values.
This phase was strongly supported by an iterative simulation process using the AWR
Microwave Office. Through this software, we tuned the values of the components in a
systematic way, allowing us to progressively improve the performance of the circuit.
In the context of the first stage, we have focused our attention on several aspects.
First of all, we made sure that the transistor draws a current of about 6 mA, in
line with the indications of the datasheet. We also aimed for a power gain (S21 ) of
around 20 dB, a noise figure (NF) below 1 dB and a K-factor greater than 1. The
iterative approach in the simulation has allowed us to obtain a configuration that
adequately satisfies the various specifications. In fact, the results obtained from the
simulations are the following:

                        Collector Current IC         6 mA

                           Power Gain S21          21.67 dB

                          Noise Figure N F         0.9414 dB

                        Table 5: Simulation results summary




                          Figure 38: First Stage Gain Plot

                                          62
                      Figure 39: First Stage Noise Figure Plot


The determining criterion for stability is the K-factor, which was found to be greater
than 1 over the entire frequency range, confirming the unconditional stability of
the circuit. However, there are also other criteria for assessing the unconditional
stability of a circuit [19]: µ1 (geometric stability factor - load), which quantifies the
distance from the center of Smith Chart to the nearest unstable point on the output
stability circle (center CL , radius ΓL ) and µ2 (geometric stability factor - source),
which does the same for the input stability circle (center CS , radius ΓS ). In order
to shift out of the Smith Chart the point of instability, it is desirable that both of
these parameters are greater than 1. Another index that evaluates stability is B1
(auxiliary stability factor), which must necessarily be greater than 0. The results of
our simulations, illustrated in Figure 40, show that all of these parameters satisfy
the necessary conditions to confirm the unconditional stability of the system.




                                           63
                Figure 40: First Stage Unconditional Stability Plot


Before starting the printed circuit board (PCB) design phase, it was deemed essential
to perform detailed simulations in order to obtain a more realistic analysis of the
circuit. In particular, it was decided to incorporate models based on real components,
including capacitors from the Murata library. This methodology allowed us to acquire
a more complete understanding of the effect of these components on the overall
performance of the system. In our study, we performed an analysis of the behavior
of the impedance of a 1 µF multilayer ceramic capacitor available in the Murata
library. The modulus of the impedance, represented in Figures 41 and 42, reveals
a series resonance phenomenon at 8 MHz. This particular behavior implies that
beyond this frequency, the capacitor takes on an impedance of an inductive nature.
Consequently, its effectiveness as a bypass element is compromised. To overcome this
limitation, a capacitor of lesser value, equal to 100 pF, is adopted. This capacitor
retains its capacitive nature even at much higher frequencies; in fact, it exhibits a
series resonance at 646 MHz, thus preserving the bypass functionality.




                                         64
             Impedance Modulus [ohm]




                                       Frequency[Hz]




  Figure 41: Modulus of the impedance vs. frequency for 1 µF Murata Capacitor
             Impedance Modulus [ohm]




                                       Frequency[Hz]




Figure 42: Modulus of the impedance vs. frequency for 100 pF Murata Capacitor


Consequently, simulations were run to compare the performance of a circuit includ-
ing exclusively ideal components and one featuring real Murata capacitors and via

                                           65
models, as shown in Figure 43. This was done in order to detect and analyze any
significant discrepancies in circuit performance. In particular, the type of via used is
a cylindrical one port via with microstrip pad. The parameters related to this via,
such as hole diameter D equal to 0.5 mm and pad width W equal to 0.5 mm have
been sized according to the values outlined in the PCB layout.



                                                                                                           MVIA1P
                                                  DCVS                                                     ID=V5
                                                              RES                                          D=0.5 mm
                                                  ID=V1
                                                              ID=R4                                        H=0.5 mm
                                                  V=5 V       R=750 Ohm                                    T=0.035 mm
          MSUB                                                                                             W=1 mm
          Er=4.5                                                             SUBCKT                        RHO=1
          H=0.5 mm                                                           ID=S6                         MSUB=SUB1
          T=0.035 mm                                                         NET="GQM1875C2E8R0CB12"
          Rho=1                                                                                                         SUBCKT
          Tand=0.016                                                                                                    ID=S2
          ErNom=4.5                                                                                                     NET="GRM1885C1H101GA01"
          Name=SUB1                                  RES
                                                     ID=R2                             RES
                                                     R=18k Ohm                         ID=R5
                                                                                       R=20 Ohm



                                                                                                                                                  PORT
                                                                                                                                                  P=2
                                                             RES                                                                                  Z=50 Ohm
                                                                                                  RES                    SUBCKT
                                                             ID=R3                                ID=R6
                                                             R=10 Ohm                                                    ID=S5
                                                                                                  R=5.6 Ohm              NET="GRM188R61E105KA12"


          SUBCKT
          ID=S8
          NET="GRM1885C1H101GA01"                                            1
   PORT                                                                 C
   P=1                                                                                                             SUBCKT
   Z=50 Ohm                                                                                                        ID=S10
                                                                 2          SUBCKT
                                                                                                                   NET="GQM1875C2E5R0BB12"
                                                                            ID=S1
                                                                            NET="BFP740F"
                                                                 B


                                     RES                                    E1    E2                               MVIA1P
              SUBCKT                 ID=R1                              3          4                               ID=V4
              ID=S4                  R=100K Ohm                                                                    D=0.5 mm
              NET="GRM188R61E105KA12"                                                                              H=0.5 mm
                                                                                                                   T=0.035 mm
                                                             RES                 RES                               W=1 mm
                                                             ID=R7               ID=R8                             RHO=1
                               MVIA1P                        R=2.2 Ohm           R=2.2 Ohm                         MSUB=SUB1
                               ID=V6
                               D=0.5 mm
                               H=0.5 mm
                               T=0.035 mm
                               W=1 mm                     MVIA1P                              MVIA1P
                               RHO=1                      ID=V2                               ID=V3
                               MSUB=SUB1                  D=0.5 mm                            D=0.5 mm
                                                          H=0.5 mm                            H=0.5 mm
                                                          T=0.035 mm                          T=0.035 mm
                                                          W=1 mm                              W=1 mm
                                                          RHO=1                               RHO=1
                                                          MSUB=SUB1                           MSUB=SUB1




                   Figure 43: LNA First Stage Schematic - Murata Capacitors




                                                                            66
   Figure 44: Gain comparison - Ideal Capacitors vs. Murata Capacitors




Figure 45: Noise Figure comparison - Ideal Capacitors vs. Murata Capacitors



                                    67
        Figure 46: First Stage Unconditional Stability Plot - Murata Capacitors


From the plots shown in the figures above, it is clear that the differences in the
gain, noise figure and stability parameters are negligible within the useful band-
width, without exerting a significant impact on the overall operation of the circuit.
Therefore, the strategy adopted to deal with the undesirable effect introduced by the
non-ideality of the 1 µF ceramic capacitor appears to be effective. Overall, despite
the introduction of non-ideal components, the results of the simulations remain in
line with our expectations.


4.4.3     Printed Circuit Board

We used the Altium Designer software to develop the first stage board. Our ap-
proach resulted in the creation of a 4-layer PCB with dimensions 4 cm × 4 cm,
carefully designed to maximize the performance of the LNA. This optimization was
achieved through a scrupulous layout selection among the standard options offered
by Eurocircuits and a meticulous arrangement of the components in the layout. The
4-layer PCB architecture features a central layer surrounded by two thinner prepreg
layers. This design was chosen because it optimizes power distribution and signal

                                          68
integrity. The outer layers serve a dual purpose: to accommodate signal routing
and to connect the components, such as surface-mount devices (SMD), connectors,
and other circuit elements. This arrangement minimizes the length of the signal
path, thus reducing the risk of interference and attenuation. On the other hand,
the inner layers are dedicated to a solid ground plane and to power distribution.
This approach provides a low-impedance path for stable power distribution, reduc-
ing noise and helping to maintain excellent signal integrity. Thoughtful planning of
a solid ground plane is critical to prevent impedance mismatch, crosstalk problems,
electromagnetic interference (EMI), and to ensure good ground connectivity.




                           Figure 47: PCB Layer Stack-Up


The representation of this structural arrangement is shown in Figure 47, which illus-
trates the layer stack-up of the PCB comprehensively. Both between the top layer
and layer 1, and between layer 2 and the bottom layer, the PP-006 prepreg is used as
a dielectric, with the relative dielectric constant Dk equal to 4.1 and the loss tangent
of dielectric Df equal to 0.016 . This material is advantageous because of its dielec-
tric properties that favor signal propagation and insulation between layers. In the
central area of the PCB, between layer 1 and layer 2, FR-4, with relative dielectric
constant Dk of 4.5 and the loss tangent of dielectric Df equal to 0.02, was used. This
design approach reflects careful planning in the printed circuit board design, with the
goal of maximizing the overall amplifier performance and minimizing any potential
negative impacts. Figures 48 and 49 provides a comprehensive representation of the
schematic and PCB, offering a clear understanding of the component layout and the

                                          69
connecting traces within the board. It is important to note that the illustration also
includes the detailed diagram of the voltage stabilizer based on a transistor. The
choice of this stabilizer compared to integrated solutions was made because it proved
more suitable for the high-radiation environment in which the device will be placed.




                    Figure 48: LNA First Stage PCB Schematic




                                         70
                          Figure 49: LNA First Stage PCB


4.4.4   Outcomes of the First Stage Prototype Testing

In the ending phase of the first stage development process, we conducted rigorous
testing of the prototype, revealing significant challenges related mainly to circuit
stability. In particular, we encountered circuit instability problems due to parasitic
effects which, in the simulation phase, could not be taken into account. However,
thanks to a well-planned empirical approach, it was possible to address these issues ef-
ficiently. In parallel with the execution of laboratory tests, detailed simulations were
performed to analyze the system behavior under various conditions. This synergistic
approach between simulations and tests enabled the identification of weaknesses in
the prototype and the iterative development of improvement solutions, ultimately
leading to the optimized configuration for the first stage as shown in Figure 50.




                                          71
                 DCVS                RES
                 ID=V1               ID=R4
                 V=5 V               R=470 Ohm




                                 RES
                                 ID=R2                                              CAP
                                 R=47k Ohm                                          ID=C2
                                                                                    C=1e6 pF


                                                   1
PORT        CAP                                                                                PORT
                                              C
P=1         ID=C1                                                                              P=2
                                                                            CAP
Z=50 Ohm    C=1e6 pF                                                                           Z=50 Ohm
                                                                            ID=C3
                                       2           SUBCKT
                                                                            C=3.3 pF
                                                   ID=S1
                                                   NET="BFP740F"
                                       B
                                                                            CAP
                                                                            ID=C5
                                                  E1    E2                  C=3.3 pF
                                              3          4



              RES                                       RES
              ID=R1                  RES                ID=R8
              R=47k Ohm              ID=R7              R=2.2 Ohm
                                     R=2.2 Ohm




                         Figure 50: First Stage Optimized Schematic



 Symbol     C1           C2       C3          C5             R1      R2      R4         R7       R8

  Value    1 µF          1 µF    3.3 pF      3.3 pF         47 kΩ   47 kΩ   470 Ω      2.2 Ω    2.2 Ω

                              Table 6: Optimized Component Values


To specifically address the issues related to bandwidth and oscillations, a solution
based on implementing a compensation with the addition of capacitors to the circuit
was implemented. Specifically, two 3.3 pF capacitors were added, connected from
the collector to the emitter. These capacitors were strategically placed to limit the


                                                       72
system bandwidth and prevent undesirable oscillations. The tests and simulation
results are presented in the following figures.




                         Figure 51: First Stage Board




                  Figure 52: First Stage K-factor Measurement

                                      73
Figure 53: First Stage Noise Figure Simulation Result


           Frequency (MHz)      NF (dB)
                   1              1.141
                   3              1.116
                   5              1.109
                   7              1.017
                  10              0.965
                  13              0.985
                  15              0.964
                  17              0.902
                  20              0.927
                  25              0.911
                  30              0.903

   Table 7: First Stage Noise Figure Measurement


                         74
                    Figure 54: First Stage Gain Measurement




                  Figure 55: First Stage Gain Simulation Result

As we can see, the system is unconditionally stable (52), provides a noise figure of
approximately 0.9 dB (7) and a gain of 22.4 dB (54). These results are very close to
those obtained in simulation.

                                        75
4.5    Second Stage and Feedback Design

For the implementation of the second stage of the Low-Noise Amplifier, we used the
LMH6629 operational amplifier in a 3 mm x 3 mm WSON-8 package. This amplifier,
fabricated using Silicon Germanium (SiGe) technology, stands out for its high-speed
performance, low noise, and wide bandwidth. Thanks to the combination of these
features, the LMH6629 proved to be an ideal choice for ensuring high amplification
in the second stage of the LNA, without compromising the system noise level.




                    Figure 56: LMH6629 - WSON (8) Package


The operational amplifier (Op Amp) configuration illustrated in Figure 57 operates
in the non-inverting amplifier mode. In this mode, the voltage gain is defined by the
following relationship, as outlined in [20]:

                                             R15
                                Av = 1 +                                        (59)
                                           R12 //R13

In order to achieve a voltage gain of approximately 26 dB, a value of 150 Ω was
chosen for the resistors R12 and R13 , while the value of 1500 Ω was chosen for the
resistor R15 .

                                        
                                    1500
                Av |dB = 20 log 1 +        = 20 log(21) = 26.4 dB               (60)
                                     75

Moreover, considering that the LMH6629 operational amplifier has a cutoff frequency
at 900 MHz, we have strategically incorporated a 1 pF capacitor in parallel with the

                                         76
feedback resistor to create a pole at 106.1 MHz, as indicated by equation (61). This
pole significantly influences the overall circuit response, allowing us to limit the
bandwidth to the value of interest:

                                     1
                           fp =             ≃ 106.1 MHz                        (61)
                                  2πR15 C15

Since the operational amplifier needs a dual power supply and we preferred not to
introduce a negative voltage power supply just for the Op Amp, we have created a
virtual ground reference with the power supply partition between R12 and R13 , as
well as between R9 and R10 .


                                                      C15
                                       Vcc

                                                      R15
                                 R13

                           R12
                                                  −         OU T
                                       Vcc
                                                  +

                                  R9
                           C2
                  IN


                                 R10




                 Figure 57: Non-Inverting Op Amp Configuration




                                             77
4.5.1   Series-Shunt Feedback

A critical aspect of the design phase of a Low-Noise Amplifier is the stability of its
gain. This aspect plays a fundamental role for various reasons, each of which has a
significant impact on the overall system performance. Fluctuations in the amplifier
gain can have direct consequences on the sensitivity of the entire system, influencing
its ability to detect weak signals. Furthermore, it is important to emphasize that
a change in gain could alter the amplifier noise figure, disrupting the quality of the
amplified signal. Another reason to pay particular attention to gain stability is the
influence that environmental factors, such as temperature, can have on the overall
amplifier performance. Thermal variations can cause fluctuations in the LNA pa-
rameters, compromising its performance in unpredictable ways. Therefore, ensuring
gain stability is a critical factor in ensuring the system robustness against chang-
ing environmental conditions. Based on these considerations, the approach adopted
in our project has been carefully directed towards implementing a targeted control
strategy aimed at gain stabilization. In particular, a series-shunt feedback approach
has been adopted, which has proven highly effective in balancing and controlling
gain fluctuations. This methodology acts as a control mechanism that constantly
monitors the amplifier gain and makes real-time corrections to maintain the gain
at the desired value. This choice has demonstrated to be particularly suitable for
preserving the system integrity even in dynamic and changing contexts, ensuring a
wide tolerance to parameter variations and guaranteeing reliable performance over
time.


          +                  +                                   +
                                           Vo
          VS                 Vi       A=                         Vo    RL
                            −              Vi                    −
          −


                             +             Vf
                            Vf        β=
                            −              Vo


                         Figure 58: Series-Shunt Feedback


                                         78
The block diagram depicted in Figure 58 illustrates the configuration of a series-shunt
feedback. In this circuit a fraction of the output voltage is applied in series with the
input voltage through the feedback loop. Hence, we can express the source voltage
Vs as the combination of the input voltage Vi and the feedback voltage Vf :


                                     Vs = Vi + Vf                                  (62)


Considering that the feedback voltage Vf is given by the product of the output voltage
Vo and the feedback factor β, and that Vo is determined by the product of the gain
A (gain of a voltage amplifier) and the input voltage Vi , we can write:

                                                     Vo
                      Vs = Vi + βVo = Vi + βAVi =       (1 + βA)                   (63)
                                                     A

Hence, we obtain that closed-loop gain Af is:

                                        Vo      A
                                 Af =      =                                       (64)
                                        Vs   1 + βA

In our specific case, as can be seen in Figure 59, the network with voltage gain A
consists of the cascade of the common emitter amplifier, with voltage gain A1 , and
the Op Amp, with voltage gain A2 . The feedback network β, instead, consists of an
RF transformer with turns ratio equal to 1 (1:1), a resistance RF 1 , and decoupling
capacitors. It should be noted that the presence of the transformer, which introduces
a phase inversion in the gain, together with feeding the feedback signal into the
emitter of the first stage, and the Op Amp configured in non-inverting mode, converge
to create a negative feedback effect. The RF transformer used is the ADT1-1 of Mini
Circuits which operates on a frequency range from 0.15 MHz to 400 MHz..




                                          79
                                             Vcc

                                                             C15
                                         R13
                                        R12
                            Vcc                              R15

                                        Vcc
                   R4                                                                    P2
                                                                                   C3   50Ω
                                        R9              −                    R14
                 R2
                                                        +
 P1
50Ω        C1                                                           +
                                  C2 R10                                Vo
                           Q1
                                                                        −
      RS
                                RV
                                                            1:1
                                  +
                R1 R                   RF1
                       3                           C5              C4
                                Vf

                                  −

                Figure 59: Series-Shunt Feedback in LNA Design


• Feedback Factor:

                                  Vf         R3 //RV
                           β=        =−                  = −0.01689                           (65)
                                  Vo    (R3 //RV ) + RF1
  Where:

                           hf e RB RC + R2 RB + RC RB + hie (R2 + RC + RB )
                RV =                                                                          (66)
                                       (R2 + RC + RB )(1 + hf e )

                                        RB = R1 //RS = 49.95 Ω                                (67)


                                      RC = R4 //R9 //R10 = 45.19 Ω                            (68)



                                                   80
      Considering the following limiting case:

                                           RB + hie
                               lim RV ≃                ≃ 4.515 Ω                   (69)
                              R2 →∞        (1 + hf e )

   • Loop Gain:

                                       R3 //RV
                         βA ≃ −                    (A1 A2 ) = 27.783               (70)
                                  (R3 //RV ) + RF1
      Where:


                                   A1 ≃ −3.92 A2 = 21                              (71)

   • Closed-loop Gain:

                         A                     (A1 A2 )
               Af =          ≃                                     = −34.44      (72)
                      1 + βA                  R3 //RV
                                 1+ −                       (A1 A2 )
                                         (R3 //RV ) + RF1

                            |Af |dB = 20 log (| − 34.44|) ≃ 31 dB                  (73)


Considering both the Op Amp ability to drive an approximate 100 Ω load and the
maximum achievable gain of approximately 44 dB across the two-stage cascade, and
taking into account the impact of this gain on the input resistance of the LNA, the
resistances RF 1 and R3 have been carefully selected. They have been valued at 150
Ω and 6 Ω respectively. Specifically, the feedback resistance RF 1 cannot be further
reduced as it would lead to an excessive load reduction on the Op Amp. Therefore,
while the optimal choice would be to keep the emitter resistance (R3 ) as low as
possible to minimize noise and maximize gain, a more balanced decision must be
made. This decision considers the need to maintain adequate gain by factoring in
the effect of this gain on the input impedance. Therefore, an emitter resistor with a
value slightly higher than the ideal value was chosen. This choice led to simulation
results showing a stable gain at a value of 32 dB, which is close to the result expected
from theoretical calculations of 31 dB.


                                          81
4.5.2   Shunt-Shunt Feedback

In the design of the Low-Noise Amplifier, two highly relevant aspects to consider
are input and output matching and minimum noise figure. In particular, input and
output matching play a crucial role in optimizing power transfer from the source to
the amplifier input and from the amplifier output to the load, in order to prevent
phenomena such as reflections and signal losses. Referring to equations (16) and
(17), it becomes evident that the reflection coefficient at the input becomes zero
when the input impedance of the amplifier matches that of the source. Similarly, the
reflection coefficient at the output becomes zero when the output impedance of the
LNA is equal to that of the load. In our context, as illustrated in Figure 60, the LNA
input is connected to the pick-up via a 5-meter coaxial cable with a characteristic
impedance of 50 Ω. The presence of the coaxial cable is determined by the need to
position the entire electronics of the BPM system in an area characterized by a lower
radiation level than that in which the pick-up is located. Consequently, despite the
source is reactive, we have to considered a 50 Ω matching between the cable and the
LNA input.


                                                         LNA
                                       5m, 50Ω
               Iim (t)         C


                                   pick-up

                              Figure 60: LNA Source


Regarding the minimum noise figure, as previously explained and demonstrated in
Chapter 2, we can say that it reaches its minimum value following the formula (29).
In other words, the noise figure takes its minimum value when the source impedance
ZS matches the optimal noise impedance ZSopt . In the specific case of the BFP740F
transistor, as stated in the datasheet, the source impedance required to achieve the
minimum noise figure is approximately 100 Ω.
To achieve both of these goals, we have adopted a combined approach that includes
the simultaneous use of a transformer at the input of the amplifier and a shunt-shunt

                                         82
feedback circuit. Specifically, starting from the configuration illustrated in Figure 59,
                                                    Ns
we introduced a transformer with a turns ratio of       = 2. This modification resulted
                                                    Np
in an increase in gain, raising it to 37 dB, while simultaneously reducing the input
impedance by a factor of 4. Subsequently, we implemented a negative shunt-shunt
feedback circuit, which is depicted in a block diagram in Figure 61. This form of
feedback takes a portion of the output voltage and introduces it in parallel to the
input current via a feedback network, thus helping to lower the input impedance.

                         Ii
                                                 Vo                 +
          Is                                A=                      Vo    RL
                                                 Ii                 −

                           If
                 If
                                                 If
                                            β=
                                                 Vo


                          Figure 61: Shunt-Shunt Feedback


In our specific case, as depicted in Figure 63, the shunt-shunt feedback consists
of a resistor RF2 = 2.2 kΩ and a decoupling capacitor C6 = 1 µF. The action of
this feedback can be simply explained with Miller’s theorem, as it aims to place in
                                                         ′
parallel with the still relatively high input impedance ZIN of the amplifier a much
smaller resistor that dominates the parallel combination, thereby determining the
input impedance as indicated in the following equation:

                                   RF2       2.2 kΩ
                        ZIN ≃           =              ≃ 54 Ω                       (74)
                                 1 − Av   1 − (−39.81)

Where, considering the voltages VA and VB shown in the circuit in Figure 63, we
have:


                                 VB
                      Av |dB =             = 32 dB =⇒ Av = −39.81                   (75)
                                 VA
                                      dB


                                              83
Indeed, from a theoretical standpoint, to achieve an input impedance ZIN perfectly
matching 50 Ω, it would have been necessary to use a feedback resistor with a value
of 2.041 kΩ. However, the choice of the 2.2 kΩ value was dictated by component
                                                                                  ′
availability in the market. Based on the discussion so far, the input impedance ZIN ,
which was initially relatively high, strongly capacitive, and frequency dependent,
while it a value of approximately 50 Ω is now achieved. Nevertheless, as can be
observed from Figure 62, for frequencies in the tens of MHz range, a significant
capacitive component is still present. Consequently, we introduced an inductance L1
of 39 nH to cancel the capacitive component. For frequencies around the hundreds
of kHz, on the other hand, there is an inductive component that, being extremely
low, can be considered negligible. Finally, concerning the output impedance, it is
set at 50 Ω through the use of the resistor R14 , of the value of 50 Ω, placed at the
output (in series with a very low impedance).




                       Figure 62: Input Impedance Matching




                                         84
                                                                      Vcc       C15
                                      C6    RF2
                                                                    R13
                                                        Vcc         R12         R15

                                                                    Vcc
                                               R4                                                     P2
                                                                                           R14   C3   50Ω
                                                                    R9          −
                         ′
                                              R2
       ZIN              ZIN                                                     +
P1                                                                                    +
50Ω           L1               1:2                             C2 R10                 VB
                                                    Q1
                                                                                      −
        C1         +                   C7
                   VA                                                     1:1
                   −
                                             R1
                                               R3             RF1   C5          C4




         Figure 63: Input Transformer 1:2 and Shunt-Shunt feedback in LNA Design


      In conclusion, taking into account all the strategies adopted and discussed so far, the
      schematic of the Low-Noise Amplifier was finalized, and is presented in Figure 64.
      Also included in the figure are some components added later during the tests, which
      will be discussed in the next chapter.




                                                   85
                                                                                                                                              SUBCKT
                                                                                                                                              ID=S21                                                             COAX2
                                                                                                                                              NET="GQM1875C2E101FB12"                                            ID=CX2
                                                                                                                                                                                      RES                        EL=3 Deg
                                                                                                                                                                                      ID=R19                     Fo=300 MHz
                                                                                                                                                                                      R=2.2k Ohm                 Z=100




                                                                                                                                                                                                                                                                                            SUBCKT
                                                                                                                                                                                                                                                                                            ID=S3
                                                                                                                                                   SUBCKT                                                                                                                                   NET="GQM1875C2E2R0BB12"
                                                                                                                                                   ID=S22  1u
                                                                                         MSUB
                                                                                         Er=4.5                                                    NET="GRM188R61E105KA12"
                                                                                         H=0.5 mm
                                                                                         T=0.035 mm                                                                                                     MVIA1P
                                                                                         Rho=1                                                                                                          ID=V7                                       RES                                                  RES
                                                                                         Tand=0.016                                                                                                     D=0.5 mm                                    ID=R12                                               ID=R15
                                                                                         ErNom=4.5                                                                                                      H=0.5 mm                                    R=150 Ohm                                            R=1500 Ohm
                                                                                         Name=SUB1                                                                                                      T=0.035 mm
                                                                                                                                                                                                        W=1 mm
                                                                                                                                                                                                        RHO=1                                                                        RES
                                                                                                                                                                                                        MSUB=SUB1                                                                    ID=R13
                                                                                                                                                                                                                                                                                     R=150 Ohm
                                                                                                                                                                                                         MVIA1P
                                                                                                                                                                                                         ID=V8
                                                                                                                                                                                                         D=0.5 mm
                                                                                                                                                                                                         H=0.5 mm
                                                                                                                                                                                                         T=0.035 mm
                                                                                                                                                                                                         W=1 mm
                                                                                                                                                                                                                                                                                                     DCVS
                                                                                                                                                                                                         RHO=1                             SUBCKT                                                    ID=V5
                                                                                                                                                                                                         MSUB=SUB1                         ID=S13                                                    V=5 V
                                                                                                                                                                                                                                           NET="GQM1875C2E2R0BB12"




                                                                                                                                                                                                                                                                                                                                 SUBCKT
                                                                                                                                                                                                                                                                                                                                 ID=S17
                                                                                                                           RES                                                                                                                                                                                                   NET="GQM1875C2E101FB12"
                                                                                                            DCVS
                                                                                                                           ID=R4                                                                                                                                                                                      RES
                                                                                                            ID=V1          R=470 Ohm                                                                                                                   RES
                                                                                                                                                                                                                                                                                                 8                    ID=R14
                                                                                                            V=5 V                                                                                                                                      ID=R9
                                                                                                                                                                                                                                                       R=100 Ohm                                                      R=50 Ohm
                                                                                                                                                                                                                                                                                        3

                                                                                                                                                                                                                                                                                                               7
                                                                                                                                                                                                                                                                                                                                                            PORT
                                                                                                                                                                                                                                                                                        4
                                                                                                                                                                                                                                                                                                                                                            P=2
                                                                                                                                                                                                                                                                          RES                                                                               Z=50 Ohm
                                                                                                                                                                                                                                                                                                 5   6                            SUBCKT
                                                                                                                                                                                                                                                                          ID=R11                                                  ID=S18
                                                                                                                       RES                                                           CAP                  RES                                          RES                R=47 Ohm                                                NET="GRM188R61E105KA12"
                                                                                                                       ID=R2                                                         ID=C8                ID=R16       SUBCKT                          ID=R10                            SUBCKT
                                                                                                                       R=47k Ohm                                                     C=18 pF              R=1k Ohm     ID=S8                           R=100 Ohm                         ID=S12
                                                                                                                                                                                                                       NET="GQM1875C2E101FB12"                                           NET="LMH6629"
                                                                                                                                                                                                                       SUBCKT
                                                                                                                                                                                                                       ID=S9
                                                                                                                                                                                                                       NET="GRM188R61E105KA12"
                   SUBCKT                                                     SUBCKT
                   ID=S16                                                                                                                                                                                                                                            MVIA1P
                                                                              ID=S2                                                                                                                                                                                  ID=V6
                   NET="GQM1875C2E101FB12"                                    NET="GQM1875C2E101FB12"                                     1
     PORT1                                                 SUBCKT                                                                                                                                     RES                                                            D=0.5 mm
     P=1                                     IND           ID=S10                                                                   C                                                                 ID=R17                                                         H=0.5 mm
     Z=50 Ohm                                ID=L1         NET="1_4_5turns"                                                                                                                           R=33 Ohm                                                       T=0.035 mm
     Pwr=-40 dBm                             L=39 nH




86
                                                                                                                                                                                                                                                                     W=1 mm
                                                                                                                             2          SUBCKT                       SUBCKT                                                                                          RHO=1
                                                       1                      2                                                         ID=S19                       ID=S5                                                                                           MSUB=SUB1
                                                                                                                                        NET="BFP740F"                NET="GQM1875C2E2R2CB12"
                                                                                                                             B

                                                                                                                                                                     SUBCKT
                                                                                                            CAP        RES               E1   E2                     ID=S1
                   SUBCKT                                                                                   ID=C7      ID=R1        3          4
                                                                                  SUBCKT                                                                             NET="GQM1875C2E2R2CB12"
                   ID=S20                                                                                   C=5.2 pF   R=47k Ohm
                                                                                  ID=S7
                   NET="GRM188R61E105KA12"
                                                                                  NET="GRM188R61E105KA12"
                                                                                                                                                                               RES
                                                                                                                                                                               ID=R18                                  SUBCKT
                                                                                              MVIA1P                   MVIA1P                                                  R=150 Ohm                               ID=S11
                                                                                              ID=V9                    ID=V3                                                                                           NET="ADT1_1___Plus25degC"                                             COAX2
                                                                                              D=0.5 mm                 D=0.5 mm                                                                                                                                                              ID=CX1
                                                                                              H=0.5 mm                 H=0.5 mm                                                                                                                                                              EL=11 Deg
                                                                                              T=0.035 mm               T=0.035 mm                                                                                                   3                                                        Fo=100 MHz
                                                                                              W=1 mm                   W=1 mm                                                                                                                                                                Z=50
                                                                                              RHO=1                    RHO=1                                             RES
                                                                                              MSUB=SUB1                                       RES                                                                         1                 2
                                                                                                                       MSUB=SUB1                                         ID=R8             SUBCKT
                                                                                                                                              ID=R7
                                                                                                                                                                         R=12 Ohm          ID=S4
                                                                                                                                              R=12 Ohm
                                                                                                                                                                                           NET="GQM1875C2E101FB12"
                                                                                                                                                                                                                                    4
                                                                                                                                                                                           SUBCKT
                                                                                                                                                                                           ID=S6
                                                                                                                                        MVIA1P                                             NET="GRM188R61E105KA12"                              SUBCKT
                                                                                                                                                                             MVIA1P
                                                                                                                                        ID=V2                                ID=V4                                                              ID=S14
                                                                                                                                        D=0.5 mm                             D=0.5 mm                                                           NET="GQM1875C2E101FB12"
                                                                                                                                        H=0.5 mm                             H=0.5 mm
                                                                                                                                        T=0.035 mm                           T=0.035 mm                                                         SUBCKT
                                                                                                                                        W=1 mm                               W=1 mm                                                             ID=S15
                                                                                                                                        RHO=1                                RHO=1                                                              NET="GRM188R61E105KA12"
                                                                                                                                        MSUB=SUB1                            MSUB=SUB1




                                                                          Figure 64: Schematic of the Low-Noise Amplifier based on SiGe HBT
                                                                                     5
                             Simulation Results and
                                      Measurement

Chapter 5 provides a comprehensive analysis of the results obtained through simula-
tions conducted using AWR Microwave Office. Furthermore, this chapter focuses on
the methods employed in laboratory testing and their respective outcomes. Finally,
a comparative analysis is conducted between the new LNA and the one currently
used in the system.


5.1    Simulation Results

In this section, we will present the results obtained from the simulations performed
with the AWR software. First, a system stability check was conducted. As can
be clearly seen from Figure 65, all the parameters, including the K-factor, B1, µ1
and µ2 , are such as to make the system unconditionally stable (for a more detailed
understanding of the requirements that these parameters must meet for the system
to be unconditionally stable, please refer to Section 4.4.2). Next, we proceeded to
plot the power gain S21 . The value obtained in the band of our interest, which ranges
from 0.1 MHz to 50 MHz, is 25.44 dB. It should be noted that a slight resonance
is visible around 150 MHz. However, since this resonance lies outside our band of
interest, it was not addressed with special attention, as we planned to use an amplifier
input filter to cut the band at 50 MHz. The measured noise figure is 1.372 dB, which
is less than the 2 dB required by the project specifications. Furthermore, both the
input and output matching proved to be satisfactory, as evidenced by the plots on
the Smith chart normalized to 50 Ω shown in figure 69. In particular, we obtained
a value of S11 lower than -20 dB. Finally, from the point of view of linearity, it is
evident from Figure 70 that the system exhibits linear behavior up to input power
levels of -15 dBm. Therefore, from a simulation point of view, we can state with

                                          87
certainty that all project specifications have been satisfactorily met.




               Figure 65: Unconditional Stability - Simulation Result




                     Figure 66: Power Gain - Simulation Result


                                          88
         Figure 67: Noise Figure - Simulation Result




Figure 68: Input Reflection Coefficient S11 - Simulation Result




                              89
  Figure 69: Input and Output Impedance - Simulation Results




Figure 70: 1dB Compression Point at 10 MHz - Simulation Result



                             90
5.2    Lab Tests

Once satisfactory results were achieved from the simulation point of view, it was
decided to proceed with the design of the PCB depicted in Figures 71 and 72. This
PCB accommodates four distinct channels, each dedicated to one of the pick-up
electrodes. In addition to the Low-Noise Amplifier, the PCB also includes the passive
input filter, stabilizers and filtering for the power supply, and mechanical relays
designed to bypass the LNA when the particle beam amplitude does not require
amplification. To ensure optimal performance, the PCB was designed following the
same layer stack-up shown in Figure 47, previously discussed for the first stage of
the LNA. This approach was taken to maintain design consistency and maximize
overall efficiency. Furthermore, components were strategically placed on both the
top and bottom of the PCB, a strategic choice aimed at minimizing signal paths
and, consequently, reducing losses.




                Figure 71: LNA Printed Circuit Board - Top Layer


                                         91
               Figure 72: LNA Printed Circuit Board - Bottom Layer


The tests conducted on the board were carried out with a meticulous approach aimed
at ensuring the stability and good performance of the amplifier. This strategy allowed
for the effective and organized identification and resolution of potential issues. Ini-
tially, a set of tests was conducted to evaluate each stage of the amplifier separately.
This phase ensured that each individual stage operated stably and consistently with
the simulations. Subsequently, a combined test of the two stages was performed,
assessing their interaction and the performance of the two cascaded stages. Finally,
tests were conducted by introducing one feedback loop at a time. The stepwise
approach used, allowed us to identify and solve instability problems, often due to
parasitic effects. For example, to stabilize the Op Amp, a 1 pF capacitor, labeled
as C19 , was added in parallel with resistor R12 . While, to address oscillations that
occurred outside the area of interest, particularly around a few gigahertz (GHz),
following the connection of the series-shunt feedback, the RC group consisting of C8

                                          92
and R16 in series with resistor R17 was implemented. This network introduced a pole
and a zero at the relevant frequencies, effectively resolving the oscillation issue while
preserving the frequency response integrity. Finally, the oscillation that emerged
after the connection of the second feedback loop was resolved by adding a 5.2 pF ca-
pacitor in parallel with R1 . Once operational stability of the amplifier was achieved,
tests were performed to measure the power gain S21 , input and output impedances,
and linearity using the Rohde & Schwarz ZNB4 Vector Network Analyzer (VNA). It
is important to note that we followed a different approach to evaluate the noise figure
compared to what was described earlier in Section 3.2. Specifically, we adopted the
“direct method”. The amplifier under test was terminated at the input with a 50 Ω
resistor, a standard condition for measurements of this kind. At the output, we con-
nected it to the Rohde & Schwarz MXO44 oscilloscope, a high-precision instrument
with a 12-bit resolution, configured with a Resolution Bandwidth (RBW) of 200 kHz,
which provides the sequence of samples at the sampling rate of 1 Gsps. This allows
us to measure the output noise power of the amplifier. However, since our goal is to
measure the noise present at the input of the amplifier, it is necessary to subtract the
gain contribution provided by the amplifier itself. This gain was measured separately
using a Vector Network Analyzer (VNA). To perform this subtraction operation, a
script was developed that, by receiving the data acquired from the oscilloscope and
the data measured by the VNA, allows us to determine the amplifier noise figure.
Plots of the results obtained from the tests are shown in the figures below.




                                           93
Figure 73: Unconditional Stability - Laboratory Measurement




     Figure 74: Power Gain - Laboratory Measurement


                            94
         Figure 75: Noise Figure - Laboratory Measurement




Figure 76: Input Reflection Coefficient S11 - Laboratory Measurement


                                95
Figure 77: Input Matching - Laboratory Measurement




Figure 78: Output Matching - Laboratory Measurement


                        96
Figure 79: 1dB and 0.1dB Compression Points at 10 MHz - Laboratory Measurement


The results of our experimental tests consistently align with the predictions obtained
through simulations, providing robust validation of the performance of our amplifier.
Specifically, we measured a power gain (S21 ) of 25.3 dB, a noise figure of approxi-
mately 1.5 dB, a reflection coefficient (S11 ) lower than -20 dB, and a linear response
(1 dBCP) up to input power levels of -15 dBm. Furthermore, the input and out-
put impedances have a value of 50 Ω, as required. Of particular significance is the
comparison with the current system. From the results presented in Table 8, it is
evident that our device not only maintains the performance of the current system
but even surpasses it in terms of linearity. In fact, at a frequency of 10 MHz, in the
currently used system, the 1 dB compression point occurs at an input power of -22
dBm, while the 0.1 dB compression point occurs at -24 dBm, as observed in Figure
27. In the new designed LNA, these compression points occur at -15 dBm and -17
dBm, respectively.




                                          97
                    Current LNA    New LNA
      Gain (S21 )      24 dB        25.3 dB
         NF          1.237 dB       1.5 dB
         S11         < -20 dB      < -20 dB
       1dBCP         -22 dBm       -15 dBm
       0.1dBCP       -24 dBm       -17 dBm

Table 8: Comparison between Current LNA and New LNA




                        98
                                                                                        6
             Conclusions and Future Work

6.1    Conclusions

In the course of this thesis, we undertook research to upgrade the Beam Position
Monitor (BPM) system of the CERN PS particle accelerator by developing a new
Low-Noise Amplifier (LNA) based on Silicon-Germanium Heterojunction Bipolar
Transistor (SiGe HBT) technology. Our mission was to breathe new life into a system
that, having been in operation for approximately 20 years, its electronic components
are now nearing the end of their life cycle, with some critical components having
become obsolete. Our efforts aimed not only to update the technological perspective
but also to preserve and enhance some of the system performance. The design flow
began with a comprehensive analysis of the existing system, with the goal of thor-
oughly understanding its strengths and weaknesses. This analysis led us to define
performance specifications for the new LNA: a bandwidth (BW) between 100 kHz
and 50 MHz, a noise figure (NF) of less than 2 dB, and a favorable 50 Ω input match
characterized by a reflection coefficient S11 below -20 dB. Once the objective was
clear, we engaged in the task of identifying modern technology that could effectively
replace obsolete RF JFET low noise component without compromising the perfor-
mance of the current system. After a rigorous evaluation of available options, SiGe
HBT technology emerged as the ideal candidate, with Infineon’s BFP740F transistor
chosen as the key component. This decision was supported by several critical factors,
especially its lower flicker noise corner frequency (fc ), which positions it as one of the
leading contenders among SiGe broadband NPN RF heterojunction bipolar transis-
tors on the market. The next phase involved a series of detailed simulations using
software such as LTSpice and AWR, extremely precise PCB design through Altium,
prototype creation, and comprehensive laboratory testing. In order to ensure the ut-
most robustness and reliability of our solution, we built two distinct prototypes: one
for the initial phase, confirming the choice of the BFP740F transistor, and a second


                                            99
one for the final complete board. Laboratory tests produced results that reflected
our simulations and validated our design approach. The LNA demonstrated a gain
(S21 ) of 25.3 dB, a good 50 Ω input matching with an S11 that far exceeded the -20
dB requirement, a low noise figure (NF) of about 1.4 dB, and a 1dBCP at an input
power of -15 dBm which highlighted better linearity compared to the current LNA.
In conclusion, the attention given to each phase of the project workflow allowed us to
fully achieve the project initial goal. In fact, despite all the technical constraints we
had to consider, we successfully developed an LNA using a more recent technology
that exhibited satisfactory performance results.


6.2    Future Work

The results obtained from this thesis work pave the way for interesting future prospects.
Firstly, it is evident that there is a need to focus on the optimization phase, with par-
ticular attention to reduce the noise figure. The results of this thesis can demonstrate
that by lowering the emitter resistance by a few ohms, a significant reduction in the
noise figure can be achieved. Therefore, the goal could be to find a solution that
allows for achieving a lower noise figure while still maintaining the required load for
the Op Amp and considering the impact of the fixed gain of the series-shunt feedback
on input impedance. Another interesting perspective for the future is the integration
of our LNA into the Beam Position Monitor of the particle accelerator, thereby al-
lowing for a practical evaluation of its performance in a real operational environment
and verifying its reliability. Additionally, it is desirable to proceed with the design
and development of the other stages that make up the analog front-end, such as the
Variable Gain Amplifier (VGA). One possible idea could be to position this stage in
the rack cabinet to facilitate accessibility, leaving only the LNA in the gap between
the two concrete blocks. Lastly, we can continue to explore and experiment with new
technologies that can meet the requirements of low noise figure and increased radia-
tion tolerance. A technology that meets these requirements could have a significant
impact on future applications in the field of particle acceleration and in other areas
of advanced scientific research, thus contributing to the advancement of science and
technology.




                                          100
                                                         References

 [1] Ewa Lopienska. The CERN accelerator complex, layout in 2022. Complexe des
     accélérateurs du CERN en janvier 2022. Technical report, CERN, 2022. General
     Photo.

 [2] CERN.     CERN’s accelerator complex.         https://home.cern/science/
     accelerators/accelerator-complex.

 [3] CERN.      The Proton Synchrotron.            https://home.cern/science/
     accelerators/proton-synchrotron.

 [4] P. Forck. Lecture notes on beam instrumentation and diagnostics. Archamps:
     Joint University Accelerator School, January - March 2011.

 [5] R Jones, M Gasior, T Lefevre, H Schmickler, and K Wittenburg. Introduction to
     beam instrumentation and diagnostics. CERN Yellow Report CERN-2014-009,
     2014.

 [6] P. Forck, P. Kowina, and D. Liakin. Beam position monitors. Synchrotron
     Radiation News, 1, 01 2008.

 [7] Tamer Riad and Qi Jing. A nonlinear s-parameters behavioral model for rf lnas.
     In 2nd Asia Symposium on Quality Electronic Design (ASQED), pages 106–111,
     2010.

 [8] F. Caspers. Rf engineering basic concepts: S-parameters, 2012.

 [9] Yip P. C. L. High-Frequency Circuit Design and Measurements. London: Chap-
     man & Hall, 1990.

[10] Voinigescu, S. High-frequency linear noisy network analysis, page 77–141. The
     Cambridge RF and Microwave Engineering Series. Cambridge University Press,
     2013.



                                       101
[11] François Fouquet. Noise in Radio-Frequency Electronics and its Measurement,
     2020.

[12] J.M. Belleman. A proposal for new head-electronics for the PS orbit measure-
     ment system, 07 2003.

[13] M. G. Arthur and W. J. Anson, 06 1974.

[14] Adler R. et al. Description of the noise performance of amplifiers and receiving
     systems. Proceedings of the IEEE, 51(3):436–442, 1963.

[15] J.D. Cressler. SiGe HBT technology: a new contender for Si-based RF and
     microwave circuit applications. IEEE Transactions on Microwave Theory and
     Techniques, 46(5):572–589, 1998.

[16] Armstrong, G.A. and Maiti, Ck. Technology Computer Aided Design for Si,
     SiGe and GaAs Integrated Circuits. Institution of Engineering and Technology,
     01 2007.

[17] J.W. Matthews and A.E. Blakeslee. Defects in epitaxial multilayers: I. Misfit
     dislocations. Journal of Crystal Growth, 27:118–125, 1974.

[18] H. Kroemer. Der Drifttransistor. Naturwissensch., 40:5789, 1953.

[19] M.L. Edwards and J.H. Sinsky. A new criterion for linear 2-port stability using
     a single geometrically derived parameter. IEEE Transactions on Microwave
     Theory and Techniques, 40(12):2303–2311, 1992.

[20] R. Mancini. Op Amps for Everyone: Design Reference. Newnes, 2003.




                                        102


==========================================
FILE: Chapter12.pdf
==========================================

                                     PRINTER CIRCUIT BOARD ISSUES


           CHAPTER 12: PRINTED CIRCUIT
            BOARD (PCB) DESIGN ISSUES

   INTRODUCTION                                          12.1
SECTION 12.1: PARTITIONING                               12.3
SECTION 12.2: TRACES                                     12.5
   RESISTANCE OF CONDUCTORS                              12.5
   VOLTAGE DROP IN SIGNAL LEADS—"KELVIN FEEDBACK"        12.7
   SIGNAL RETURN CURRENTS                                12.7
   GROUND NOISE AND GROUND LOOPS                         12.9
   GROUND ISOLATION TECHNIQUES                           12.11
   STATIC PCB EFFECTS                                    12.15
   SAMPLE MINIDIP AND SOIC OP AMP PCB GUARD LAYOUTS      12.17
   DYNAMIC PCB EFFECTS                                   12.19
   INDUCTANCE                                            12.21
   STRAY INDUCTANCE                                      12.21
   MUTUAL INDUCTANCE                                     12.22
   PARASITIC EFFECTS IN INDUCTORS                        12.24
   Q OR "QUALITY FACTORS"                                12.25
   DON'T OVERLOOK ANYTHING                               12.26
   STRAY CAPACITANCE                                     12.27
   CAPACITATIVE NOISE AND FARADAY SHIELDS                12.28
   BUFFERING ADCs AGAINST LOGIC NOISE                    12.29
   HIGH CIRCUIT IMPEDANCES ARE SUSCEPTIBLE TO NOISE
      PICKUP                                             12.30
   SKIN EFFECT                                           12.33
   TRANSMISSION LINES                                    12.35
   DESIGN PCBs THOUGHTFULLY                              12.36
   DESIGNNING+B46 CONTROLLED IMPEDANCE TRACES ON
   PCBs                                                  12.36
   MICROSTRIP PCB TRANSMISSION LINES                     12.38
   SOME MICROSTRIP GUIDELINES                            12.39
   SYMMETRIC STRIPLINE PCB TRANSMISSION LINES            12.40
   SOME PROS AND CONS OF EMBEDDING TRACES                12.42
   DEALING WITH HIGH SPEED LOGIC                         12.43
   LOW VOLTAGE DIFFERENTIAL SIGNALLING (LVDS)            12.49
   REFERENCES                                            12.51
 BASIC LINEAR DESIGN

SECTION 12.3: GROUNDING                               12.53
   STAR GROUND                                        12.54
   SEPARATE ANALOG AND DIGITAL GROUNDS                12.55
   GROUND PLANES                                      12.56
   GROUNDING AND DECOUPLING MIXED SIGNALS ICs WITH
     LOW DIGITAL CONTENT                              12.60
   TREAT THE ADC DIGITAL OUTPUTS WITH CARE            12.62
   SAMPLING CLOCK CONSIDERATIONS                      12.64
   THE ORIGINS OF THE CONFUSION ABOUT MIXED SIGNAL
     GROUNDING                                        12.66
   SUMMARY: GROUNDING MIXED SIGNAL DEVICES WITH LOW
     DIGITAL CURRENTS IN A MULTICARD SYSTEM           12.67
   SUMMARY: GROUNDING MIXED SIGNAL DEVICES WITH
   HIGH
     DIGITAL CURRENTS IN A MULTICARD SYSTEM           12.68
   GROUNDING DSPs WITH INTERNAL PHASE-LOCKED LOOPS    12.69
   GROUNDING SUMMARY                                  12.70
   GROUNDING FOR HIGH FREQUENCY OPERATION             12.70
   BE CAREFUL WITH GROUND PLANE BREAKS                12.73
   REFERENCES                                         12.75
SECTION 12.4: DECOUPLING                              12.77
   LOCAL HIGH FREQUENCY BYPASS / DECOUPLING           12.77
   RINGING                                            12.80
   REFERENCES                                         12.82
SECTION 12.5: THERMAL MANAGEMENT                      12.83
   THERMAL BASICS                                     12.83
   HEAT SINKING                                       12.85
   DATA CONVERTER THERMAL CONSIDERATIONS              12.90
   REFERENCES                                         12.96
                                                         PRINTER CIRCUIT BOARD ISSUES
                                                                        INTRODUCTION



CHAPTER 12: PRINTED CIRCUIT BOARD (PCB)
DESIGN ISSUES

Introduction

Printed circuit boards (PCBs) are by far the most common method of assembling modern
electronic circuits. Comprised of a sandwich of one or more insulating layers and one or
more copper layers which contain the signal traces and the powers and grounds, the
design of the layout of printed circuit boards can be as demanding as the design of the
electrical circuit.

Most modern systems consist of multilayer boards of anywhere up to eight layers (or
sometimes even more). Traditionally, components were mounted on the top layer in holes
which extended through all layers. These are referred as through hole components. More
recently, with the near universal adoption of surface mount components, you commonly
find components mounted on both the top and the bottom layers.

The design of the printed circuit board can be as important as the circuit design to the
overall performance of the final system. We shall discuss in this chapter the partitioning
of the circuitry, the problem of interconnecting traces, parasitic components, grounding
schemes, and decoupling. All of these are important in the success of a total design.

PCB effects that are harmful to precision circuit performance include leakage resistances,
IR voltage drops in trace foils, vias, and ground planes, the influence of stray capacitance,
and dielectric absorption (DA). In addition, the tendency of PCBs to absorb atmospheric
moisture (hygroscopicity) means that changes in humidity often cause the contributions
of some parasitic effects to vary from day to day.

In general, PCB effects can be divided into two broad categories—those that most
noticeably affect the static or dc operation of the circuit, and those that most noticeably
affect dynamic or ac circuit operation, especially at high frequencies.

Another very broad area of PCB design is the topic of grounding. Grounding is a problem
area in itself for all analog and mixed signal designs, and it can be said that simply
implementing a PCB based circuit doesn’t change the fact that proper techniques are
required. Fortunately, certain principles of quality grounding, namely the use of ground
planes, are intrinsic to the PCB environment. This factor is one of the more significant
advantages to PCB based analog designs, and appreciable discussion of this section is
focused on this issue.

Some other aspects of grounding that must be managed include the control of spurious
ground and signal return voltages that can degrade performance. These voltages can be
due to external signal coupling, common currents, or simply excessive IR drops in
ground conductors. Proper conductor routing and sizing, as well as differential signal
                                                                                        12-1
  BASIC LINEAR DESIGN

handling and ground isolation techniques enables control of such parasitic voltages.

One final area of grounding to be discussed is grounding appropriate for a mixed-signal,
analog/digital environment. Indeed, the single issue of quality grounding can influence
the entire layout philosophy of a high performance mixed signal PCB design—as it well
should.




12.2
                                                         PRINTED CIRCUIT BOARD ISSUES
                                                                         PARTITIONING


SECTION 1: PARTITIONING
Any subsystem or circuit layout operating at high frequency and/or high precision with
both analog and digital signals should like to have those signals physically separated as
much as possible to prevent crosstalk. This is typically difficult to accomplish in practice.

Crosstalk can be minimized by paying attention to the system layout and preventing
different signals from interfering with each other. High level analog signals should be
separated from low level analog signals, and both should be kept away from digital
signals. TTL and CMOS digital signals have high edge rates, implying frequency
components starting with the system clock and going up form there. And most logic
families are saturation logic, which has uneven current flow (high transient currents)
which can modulate the ground. We have seen elsewhere that in waveform sampling and
reconstruction systems the sampling clock (which is a digital signal) is as vulnerable to
noise as any analog signal. Noise on the sampling clock manifests itself as phase jitter,
which as we have seen in a previous section, translates directly to reduced SNR of the
sampled signal. If clock driver packages are used in clock distribution, only one
frequency clock should be passed through a single package. Sharing drivers between
clocks of different frequencies in the same package will produce excess jitter and
crosstalk and degrade performance.

The ground plane can act as a shield where sensitive signals cross. Figure 12.1 shows a
good layout for a data acquisition board where all sensitive areas are isolated from each
other and signal paths are kept as short as possible. While real life is rarely as simple as
this, the principle remains a valid one.

There are a number of important points to be considered when making signal and power
connections. First of all a connector is one of the few places in the system where all
signal conductors must run in parallel—it is therefore imperative to separate them with
ground pins (creating a Faraday shield) to reduce coupling between them.

Multiple ground pins are important for another reason: they keep down the ground
impedance at the junction between the board and the backplane. The contact resistance of
a single pin of a PCB connector is quite low (typically on the order of 10 mΩ) when the
board is new—as the board gets older the contact resistance is likely to rise, and the
board's performance may be compromised. It is therefore well worthwhile to allocate
extra PCB connector pins so that there are many ground connections (perhaps 30% to
40% of all the pins on the PCB connector should be ground pins). For similar reasons
there should be several pins for each power connection.

Manufacturers of high performance mixed-signal ICs, like Analog Devices, often offer
evaluation boards to assist customers in their initial evaluations and layout. ADC
evaluation boards generally contain an on-board low jitter sampling clock oscillator,
output registers, and appropriate power and signal connectors. They also may have
additional support circuitry such as the ADC input buffer amplifier and external
reference.

                                                                                        12-3
  BASIC LINEAR DESIGN




                        SAMPLING                     TIMING                CONTROL
                     CLOCK GENERATOR                CIRCUITS                LOGIC


                                                    BUFFER
          REFERENCE         ADC                                        DEMULTIPLEXER
                                                   REGISTER

            ANALOG                                             DIGITAL
                           FILTER
                                                      DSP
                                                                          BUFFER
                                                      OR
                                                                          MEMORY
                          AMPLIFIER                    µP




                  POWER           MULTIPLE                ADDRESS       MULTIPLE
                           ANALOG GROUNDS          DATA     BUS         GROUNDS
                            INPUT                  BUS


 Figure 12.1: Analog and Digital Circuits Should Be Partitioned on PCB Layout


The layout of the evaluation board is optimized in terms of grounding, decoupling, and
signal routing and can be used as a model when laying out the ADC section of the PC
board in a system. The actual evaluation board layout is usually available from the ADC
manufacturer in the form of computer CAD files (Gerber files). In many cases, the layout
of the various layers appears on the data sheet for the device. It should be pointed out,
though, that an evaluation board is an extremely simple system. While some guidelines
can be inferred from inspection of the evaluation board layout, the system that you are
designing is undoubtedly more complicated. Therefore, direct use of the layout may not
be optimum in larger systems.




12.4
                                                          PRINTED CIRCUIT BOARD ISSUES
                                                                              TRACES


SECTION 2: TRACES

Resistance of Conductors
Every engineer is familiar with resistors. But far too few engineers consider that all the
wires and PCB traces with which their systems and circuits are assembled are also
resistors (as well as inductors as well, as will be discussed later). In higher precision
systems, even these trace resistances and simple wire interconnections can have
degrading effects. Copper is not a superconductor—and too many engineers appear to
think it is!

Figure 12.2 illustrates a method of calculating the sheet resistance R of a copper square,
given the length Z, the width X, and the thickness Y.

                                        ρZ
                                   R=
                                        XY
                                   ρ = RESISTIVITY

                                         R


                                             Z

                                             Y
                              X


                 SHEET RESISTANCE CALCULATION FOR
                 1 OZ. COPPER CONDUCTOR:

                 ρ = 1.724 X 10-6 Ω cm, Y = 0.0036cm

                            Z
                 R = 0.48     mΩ
                            X
                  Z
                    = NUMBER OF SQUARES
                  X

                  R = SHEET RESISTANCE OF 1 SQUARE (Z=X)
                    = 0.48m Ω /SQUARE



       Figure 12.2: Calculation of Sheet Resistance and Linear Resistance
                        for Standard Copper PCB Conductors


                                                     -6
At 25°C the resistivity of pure copper is 1.724X10 Ω/cm. The thickness of standard
1 ounce PCB copper foil is 0.036 mm (0.0014"). Using the relations shown, the
resistance of such a standard copper element is therefore 0.48 mΩ/square. One can
                                                                              12-5
  BASIC LINEAR DESIGN

readily calculate the resistance of a linear trace, by effectively "stacking" a series of such
squares end to end, to make up the line’s length. The line length is Z and the width is X,
so the line resistance R is simply a product of Z/X and the resistance of a single square,
as noted in the figure.

For a given copper weight and trace width, a resistance/length calculation can be made.
For example, the 0.25 mm (10 mil) wide traces frequently used in PCB designs equates to
a resistance/length of about 19 mΩ/cm (48 mΩ /inch), which is quite large. Moreover, the
temperature coefficient of resistance for copper is about 0.4%/°C around room
temperature. This is a factor that shouldn’t be ignored, in particular within low
impedance precision circuits, where the TC can shift the net impedance over temperature.

As shown in Figure 12.3, PCB trace resistance can be a serious error when conditions
aren’t favorable. Consider a 16-bit ADC with a 5 kΩ input resistance, driven through
5 cm of 0.25 mm wide 1 oz. PCB track between it and its signal source. The track
resistance of nearly 0.1 Ω forms a divider with the 5 kΩ load, creating an error. The
resulting voltage drop is a gain error of 0.1/5 k (~0.0019%), well over 1 LSB (0.0015%
for 16 bits). And this ignores the issue of the return path! It also ignores inductance,
which could make the situation worse at high frequencies.


                                              5cm


               SIGNAL                                               16-BIT ADC,
               SOURCE                                                RIN = 5kΩ


                                     0.25mm (10 mils) wide,
                                     1 oz. copper PCB trace


                                      Assume ground path
                                      resistance negligible



 Figure 12.3: Ohm’s law predicts >1 LSB of error due to drop in PCB conductor

So, when dealing with precision circuits, the point is made that even simple design items
such as PCB trace resistance cannot be dealt with casually. There are various solutions
that can address this issue, such as wider traces (which may take up excessive space), and
may not be a viable solution with the smallest packages and with packages with multiple
rows of pins, such as a ball grid array (BGA), the use of heavier copper (which may be
too expensive) or simply choosing a high input impedance converter. But, the most
important thing is to think it all through, avoiding any tendency to overlook items
appearing innocuous on the surface.



12.6
                                                              PRINTED CIRCUIT BOARD ISSUES
                                                                                  TRACES

Voltage Drop in Signal Leads—Kelvin Feedback
The gain error resulting from resistive voltage drop in PCB signal leads is important only
with high precision and/or at high resolutions (the Figure 12.3 example), or where large
signal currents flow. Where load impedance is constant and resistive, adjusting overall
system gain can compensate for the error. In other circumstances, it may often be
removed by the use of "Kelvin" or "voltage sensing" feedback, as shown in Figure 12.4.

In this modification to the case of Figure 12.3 a long resistive PCB trace is still used to
drive the input of a high resolution ADC, with low input impedance. In this case
however, the voltage drop in the signal lead does not give rise to an error, as feedback is
taken directly from the input pin of the ADC, and returned to the driving source. This
scheme allows full accuracy to be achieved in the signal presented to the ADC, despite
any voltage drop across the signal trace.


                                  FEEDBACK "SENSE" LEAD
                                                                 S
                 SIGNAL                                              ADC with
                                      HIGH RESISTANCE            F
                 SOURCE                                               low R IN
                                        SIGNAL LEAD




                                      Assume ground path
                                      resistance negligible




  Figure 12.4: Use of a Sense Connection Moves Accuracy to the Load Point

The use of separate force (F) and sense (S) connections (often referred to as a Kelvin
connection) at the load removes any errors resulting from voltage drops in the force lead,
but, of course, may only be used in systems where there is negative feedback. It is also
impossible to use such an arrangement to drive two or more loads with equal accuracy,
since feedback may only be taken from one point. Also, in this much-simplified system,
errors in the common lead source/load path are ignored, the assumption being that ground
path voltages are negligible. In many systems this may not necessarily be the case, and
additional steps may be needed, as noted below.


Signal Return Currents
Kirchoff's Law tells us that at any point in a circuit the algebraic sum of the currents is
zero. This tells us that all currents flow in circles and, particularly, that the return current
must always be considered when analyzing a circuit, as is illustrated in Figure 12.5 (see
References 7 and 8).

                                                                                           12-7
  BASIC LINEAR DESIGN



               SIGNAL
                                           I
                                                                 LOAD
               SOURCE


                                                           RL       I


                              GROUND RETURN CURRENT
              G1                                                  G2
                                           I

                               AT ANY POINT IN A CIRCUIT
                     THE ALGEBRAIC SUM OF THE CURRENTS IS ZERO
                                          OR
                           WHAT GOES OUT MUST COME BACK
                        WHICH LEADS TO THE CONCLUSION THAT
                           ALL VOLTAGES ARE DIFFERENTIAL
                             (EVEN IF THEY’RE GROUNDED)



       Figure 12.5: Kirchoff’s Law Helps in Analyzing Voltage Drops Around a
                       Complete Source/Load Coupled Circuit


In dealing with grounding issues, common human tendencies provide some insight into
how the correct thinking about the circuit can be helpful towards analysis. Most engineers
readily consider the ground return current "I," only when they are considering a fully
differential circuit.

However, when considering the more usual circuit case, where a single-ended signal is
referred to "ground," it is common to assume that all the points on the circuit diagram
where ground symbols are found are at the same potential. Unfortunately, this happy
circumstance just ain’t necessarily so!

This overly optimistic approach is illustrated in Figure 12.6 where, if it really should
exist, "infinite ground conductivity" would lead to zero ground voltage difference
between source ground G1 and load ground G2. Unfortunately this approach isn’t a wise
practice, and when dealing with high precision circuits, it can lead to disasters.

A more realistic approach to ground conductor integrity includes analysis of the
impedance(s) involved, and careful attention to minimizing spurious noise voltages.




12.8
                                                          PRINTED CIRCUIT BOARD ISSUES
                                                                              TRACES




                                       SIGNAL
                                                                        ADC
        SIGNAL
        SOURCE



                                INFINITE GROUND
     G1                           CONDUCTIVITY                                 G2
                               → ZERO VOLTAGE
                                 DIFFERENTIAL
                                BETWEEN G1 & G2


 Figure 12.6: Unlike this Optimistic Diagram, it Is Unrealistic to Assume Infinite
      Conductivity Between Source/Load Grounds in a Real-World System



Ground Noise and Ground Loops
A more realistic model of a ground system is shown in Figure 12.7. The signal return
current flows in the complex impedance existing between ground points G1 and G2 as
shown, giving rise to a voltage drop ΔV in this path. But it is important to note that
additional external currents, such as IEXT, may also flow in this same path. It is critical to
understand that such currents may generate uncorrelated noise voltages between G1 and
G2 (dependent upon the current magnitude and relative ground impedance).

Some portion of these undesired voltages may end up being seen at the signal’s load end,
and they can have the potential to corrupt the signal being transmitted.

It is evident, of course, that other currents can only flow in the ground impedance, if there
is a current path for them. In this case, severe problems can be caused by a high current
circuit sharing an unlooped ground return with the signal source.

Figure 12.8 shows just such a common ground path, shared by the signal source and a
high current circuit, which draws a large and varying current from its supply. This current
flows in the common ground return, causing an error voltage ΔV to be developed.




                                                                                         12-9
  BASIC LINEAR DESIGN




                                    SIGNAL
                                                               LOAD
             SIGNAL
             SOURCE
                                                                  ISIG


                            ΔV = VOLTAGE DIFFERENTIAL
                           DUE TO SIGNAL CURRENT AND/OR
                           EXTERNAL CURRENT FLOWING IN
                                GROUND IMPEDANCE


                   G1                                 G2
  IEXT



Figure 12.7: A More Realistic Source-to-Load Grounding System View Includes
    Consideration of the Impedance Between G1-G2, Plus the Effect of Any
                          Nonsignal-Related Currents




                                                                         +Vs




          HIGH                       SIGNAL
        CURRENT       SIGNAL                                ADC
         CIRCUIT      SOURCE




                                     ΔV
                    ΔV = VOLTAGE DUE TO SIGNAL CURRENT PLUS
                   CURRENT FROM HIGH CURRENT CIRCUIT FLOWING
                          IN COMMON GROUND IMPEDANCE



Figure 12.8: Any Current Flowing Through a Common Ground Impedance Can
                               Cause Errors


12.10
                                                       PRINTED CIRCUIT BOARD ISSUES
                                                                           TRACES
From Figure 12.9, it is also evident that if a ground network contains loops, or circular
ground conductor patterns (with S1 closed), there is an even greater danger of it being
vulnerable to EMFs induced by external magnetic fields. There is also a real danger of
ground-current-related signals "escaping" from the high current areas, and causing noise
in sensitive circuit regions elsewhere in the system.


         HIGH                  SIGNAL A
       CURRENT
       CIRCUIT A
                         ZA                             CLOSING S1 FORMS A GROUND LOOP.
                                                        NOISE MAY COME FROM:

                                                          MAGNETIC FLUX CUTTING THE
                                                           GROUND LOOP
                                                NEXT      GROUND CURRENT OF A IN ZB
                      GROUND
MAGNETIC                                       STAGE
                    IMPEDANCES                            GROUND CURRENT OF B IN ZA
  FLUX        S1




                          ZB
         HIGH
       CURRENT
                               SIGNAL B
       CIRCUIT B



                              Figure 12.9: A Ground Loop


For these reasons ground loops are best avoided, by wiring all return paths within the
circuit by separate paths back to a common point, i.e., the common ground point towards
the mid-right of the diagram. This would be represented by the S1 open condition.


Ground Isolation Techniques
While the use of ground planes does lower impedance and helps greatly in lowering
ground noise, there may still be situations where a prohibitive level of noise exists. In
such cases, the use of ground error minimization and isolation techniques can be helpful.

Another illustration of a common-ground impedance coupling problem is shown in
Figure 12.10. In this circuit a precision gain-of-100 preamp amplifies a low level signal
VIN, using an AD8551 chopper-stabilized amplifier for best dc accuracy. At the load end,
the signal VOUT is measured with respect to G2, the local ground. Because of the small
700 μA ISUPPLY of the AD8551 flowing between G1 and G2, there is a 7 μV ground
error—about 7 times the typical input offset expected from the op amp!



                                                                                   12-11
  BASIC LINEAR DESIGN


                                  +5V



                                U1
                              AD8551

                                        R1
           V IN                        99kΩ
         5mV FS
                                                                          V OU T
                    ISUPPLY             R2
                    700μA              1kΩ            RGR OUND
                                                       0.01Ω


                                        G1           ΔV ≅ 7μV                G2




Figure 12.10: Unless Care Is Taken, Even Small Common Ground Currents Can
                    Degrade Precision Amplifier Accuracy


This error can be avoided simply by routing the negative supply pin current of the op amp
back to star ground G2 as opposed to ground G1, by using a separate trace. This step
eliminates the G1-G2 path power supply current, and so minimizes the ground leg
voltage error. Note that there will be little error developed in the "hot" VOUT lead, so long
as the current drain at the load end is small.

In some cases, there may be simply unavoidable ground voltage differences between a
source signal and the load point where it is to be measured. Within the context of this
"same-board" discussion, this might require rejecting ground error voltages of several
tens-of-mV. Or, should the source signal originate from an "off-board" source, then the
magnitude of the common-mode voltages to be rejected can easily rise into a several volt
range (or even tens-of-volts).

Fortunately, full signal transmission accuracy can still be accomplished in the face of
such high noise voltages, by employing a principle discussed earlier. This is the use of a
differential-input, ground isolation amplifier. The ground isolation amplifier minimizes
the effect of ground error voltages between stages by processing the signal in differential
fashion, thereby rejecting CM voltages by a substantial margin (typically 60 dB or more).

Two ground isolation amplifier solutions are shown in Figure 12.11. This diagram can
alternately employ either the AD629 to handle CM voltages up to ±270 V, or the
AMP03, which is suitable for CM voltages up to ±20 V.

In the circuit, input voltage VIN is referred to G1, but must be measured with respect to
G2. With the use of a high CMR unity-gain difference amplifier, the noise voltage ΔV
existing between these two grounds is easily rejected. The AD629 offers a typical CMR
of 88 dB, while the AMP03 typically achieves 100 dB. In the AD629, the high CMV
rating is done by a combination of high CM attenuation, followed by differential gain,
realizing a net differential gain of unity. The AD629 uses the first listed value resistors
12.12
                                                             PRINTED CIRCUIT BOARD ISSUES
                                                                                 TRACES
noted in the figure for R1 to R5. The AMP03 operates as a precision four-resistor
differential amplifier, using the 25 kΩ value R1 to R4 resistors noted. Both devices are
complete, one package solutions to the ground-isolation amplifier.

                                                  R5
                                                21.1kΩ
                                              (AD629 only)



                                                                       G2
                              R1                  R2
                          380kΩ / 25kΩ        380kΩ / 25kΩ


                                                                       CMV(V) CMR(dB)
                                                                  AD629 ± 270  88
                                                                  AMP03 ± 20   100
                         AD629 / AMP03
                VIN       DIFFERENCE
                          AMPLIFIERS

                                                                VOUT
                              R3                  R4
                          380kΩ / 25kΩ        20kΩ / 25kΩ
                                                                         G2
                 G1                                                    OUTPUT
               INPUT                   ΔV                              COMMON
              COMMON                 GROUND
                                      NOISE

    Figure 12.11: A Differential Input Ground Isolating Amplifier Allows High
  Transmission Accuracy by Rejecting Ground Noise Voltage Between Source
                    (G1) and Measurement (G2) Grounds


This scheme allows relative freedom from tightly controlling ground drop voltages, or
running additional and/or larger PCB traces to minimize such error voltages. Note that it
can be implemented either with the fixed gain difference amplifiers shown, or also with a
standard in-amp IC, configured for unity gain. The AD623, for example, also allows
single-supply use. In any case, signal polarity is also controllable, by simple reversal of
the difference amplifier inputs.

In general terms, transmitting a signal from one point on a PCB to another for
measurement or further processing can be optimized by two key interrelated techniques.
These are the use of high impedance, differential signal-handling techniques. The high
impedance loading of an in-amp minimizes voltage drops, and differential sensing of the
remote voltage minimizes sensitivity to ground noise.

When the further signal processing is A/D conversion, these transmission criteria can be
implemented without adding a differential ground isolation amplifier stage. Simply select
an ADC which operates differentially. The high input impedance of the ADC minimizes
load sensitivity to the PCB wiring resistance. In addition, the differential input feature
allows the output of the source to be sensed directly at the source output terminals (even
if single-ended). The CMR of the ADC then eliminates sensitivity to noise voltages
between the ADC and source grounds.

                                                                                        12-13
  BASIC LINEAR DESIGN


An illustration of this concept using an ADC with high impedance differential inputs is
shown in Figure 12.12. Note that the general concept can be extended to virtually any
signal source, driving any load. All loads, even single-ended ones, become differential-
input by adding an appropriate differential input stage. The differential input can be
provided by either a fully developed high Z in-amp, or in many cases it can be a simple
subtractor stage op amp, such as Figure 12.11.




               SIGNAL
                                                                   HIGH-Z
               SOURCE         VOUT                             DIFFERENTIAL
                                                                 INPUT ADC



                                          Ground path errors
                                             not critical




    Figure 12.12: A High-Impedance Differential Input ADC Also Allows High
              Transmission Accuracy Between Source and Load




12.14
                                                         PRINTED CIRCUIT BOARD ISSUES
                                                                             TRACES

Static PCB Effects
Leakage resistance is the dominant static circuit board effect. Contamination of the PCB
surface by flux residues, deposited salts, and other debris can create leakage paths
between circuit nodes. Even on well-cleaned boards, it is not unusual to find 10 nA or
more of leakage to nearby nodes from 15-volt supply rails. Nanoamperes of leakage
current into the wrong nodes often cause volts of error at a circuit's output; for example,
10 nA into a 10 MΩ resistance causes 0.1 V of error. Unfortunately, the standard op amp
pinout places the −VS supply pin next to the + input, which is often hoped to be at high
impedance! To help identify nodes sensitive to the effects of leakage currents ask the
simple question: If a spurious current of a few nanoamperes or more were injected into
this node, would it matter?

If the circuit is already built, you can localize moisture sensitivity to a suspect node with
a classic test. While observing circuit operation, blow on potential trouble spots through a
simple soda straw. The straw focuses the breath's moisture, which, with the board's salt
content in susceptible portions of the design, disrupts circuit operation upon contact.

There are several means of eliminating simple surface leakage problems. Thorough
washing of circuit boards to remove residues helps considerably. A simple procedure
includes vigorously brushing the boards with isopropyl alcohol, followed by thorough
washing with deionized water and an 85°C bake out for a few hours. Be careful when
selecting board-washing solvents, though. When cleaned with certain solvents, some
water-soluble fluxes create salt deposits, exacerbating the leakage problem.

Unfortunately, if a circuit displays sensitivity to leakage, even the most rigorous cleaning
can offer only a temporary solution. Problems soon return upon handling, or exposure to
foul atmospheres, and high humidity. Some additional means must be sought to stabilize
circuit behavior, such as conformal surface coating.

Fortunately, there is an answer to this, namely guarding, which offers a fairly reliable and
permanent solution to the problem of surface leakage. Well-designed guards can
eliminate leakage problems, even for circuits exposed to harsh industrial environments.
Two schematics illustrate the basic guarding principle, as applied to typical inverting and
noninverting op amp circuits.

Figure 12.13 illustrates an inverting mode guard application. In this case, the op amp
reference input is grounded, so the guard is a grounded ring surrounding all leads to the
inverting input, as noted by the dotted line.




                                                                                      12-15
  BASIC LINEAR DESIGN




                       INVERTING MODE GUARD:
                      RING SURROUNDS ALL LEAD
                       ENDS AT THE "HOT NODE"
                          AND NOTHING ELSE




    Figure 12.13: Inverting Mode Guard Encloses All Op Amp Inverting Input
                  Connections Within a Grounded Guard Ring


Guarding basic principles are simple: Completely surround sensitive nodes with
conductors that can readily sink stray currents, and maintain the guard conductors at the
exact potential of the sensitive node (as otherwise the guard will serve as a leakage
source rather than a leakage sink). For example, to keep leakage into a node below 1 pA
(assuming 1000-megohm leakage resistance) the guard and guarded node must be within
1 mV. Generally, the low offset of a modern op amp is sufficient to meet this criterion.
                                                  NON-INVERTING MODE GUARD:
                           Y                    RING SURROUNDS ALL "HOT NODE"
                                                  LEAD ENDS - INCLUDING INPUT
                                                     TERMINAL ON THE PCB




         Y                         X
                 RL
                                                        Y
                                                                         LOW VALUE GAIN
                                                         Y                 RESISTORS

                                          USE SHIELDING (Y) OR
                                           UNITY-GAIN BUFFER
                                         (X) IF GUARD HAS LONG
                                                  LEAD



Figure 12.14: Noninverting Mode Guard Encloses all Op Amp Noninverting Input
           Connections Within a Low Impedance, Driven Guard Ring


12.16
                                                         PRINTED CIRCUIT BOARD ISSUES
                                                                             TRACES
There are important caveats to be noted with implementing a true high quality guard. For
traditional through hole PCB connections, the guard pattern should appear on both sides
of the circuit board, to be most effective. And, it should also be connected along its
length by several vias. Finally, when either justified or required by the system design
parameters, do make an effort to include guards in the PCB design process from the
outset—there is little likelihood that a proper guard can be added as an afterthought.

Figure 12.14 illustrates the case for a noninverting guard. In this instance the op amp
reference input is directly driven by the source, which complicates matters considerably.
Again, the guard ring completely surrounds all of the input nodal connections. In this
instance, however, the guard is driven from the low impedance feedback divider
connected to the inverting input.

Usually the guard-to-divider junction will be a direct connection, but in some cases a
unity gain buffer might be used at "X" to drive a cable shield, or also to maintain the
lowest possible impedance at the guard ring.

In lieu of the buffer, another useful step is to use an additional, directly grounded screen
ring, "Y," which surrounds the inner guard and the feedback nodes as shown. This step
costs nothing except some added layout time, and will greatly help buffer leakage effects
into the higher impedance inner guard ring.

Of course what hasn’t been addressed to this point is just how the op amp itself gets
connected into these guarded islands without compromising performance. The traditional
method using a TO-99 metal can package device was to employ double-sided PCB guard
rings, with both op amp inputs terminated within the guarded ring.



Sample MINI-DIP and SOIC op amp PCB guard layouts
Modern assembly practices have favored smaller plastic packages such as eight pin
MINI-DIP and SOIC types. Some suggested partial layouts for guard circuits using these
packages are shown in the next two figures. While guard traces may also be possible with
even more tiny op amp footprints, such as SOT-23 etc., the required trace separations
become even more confining, challenging the layout designer as well as the
manufacturing processes.

For the ADI "N" style MINI-DIP package, Figure 12.15 illustrates how guarding can be
accomplished for inverting (left) and noninverting (right) operating modes. This setup
would also be applicable to other op amp devices where relatively high voltages occur at
pin 1 or 4. Using a standard eight pin DIP outline, it can be noted that this package’s 0.1"
pin spacing allows a PC trace (here, the guard trace) to pass between adjacent pins. This
is the key to implementing effective DIP package guarding, as it can adequately prevent a
leakage path from the –VS supply at pin 4, or from similar high potentials at pin 1.



                                                                                      12-17
  BASIC LINEAR DESIGN



                         1            8                      1            8
           GUARD
            INPUT       2             7        GUARD         2            7

           GUARD        3             6         INPUT        3            6
                                               GUARD
                        4             5                      4            5



                         INVERTING MODE                    NON-INVERTING MODE
                         GUARD PATTERN                       GUARD PATTERN

  Figure 12.15: PCB Guard Patterns for Inverting and Noninverting Mode Op
                Amps Using Eight Pin MINI-DIP (N) Package


For the left-side inverting mode, note that the Pin 3 connected and grounded guard traces
surround the op amp inverting input (Pin 2), and run parallel to the input trace. This guard
would be continued out to and around the source and feedback connections of
Figure 12-36 (or other similar circuit), including an input pad in the case of a cable. In the
right-side noninverting mode, the guard voltage is the feedback divider voltage to Pin 2.
This corresponds to the inverting input node of the amplifier, from Figure 12.14.

Note that in both of the cases of Figure 12.15, the guard physical connections shown are
only partial—an actual layout would include all sensitive nodes within the circuit. In both
the inverting and the noninverting modes using the MINI-DIP or other through hole style
package, the PCB guard traces should be located on both sides of the board, with top and
bottom traces connected with several vias.

Things become slightly more complicated when using guarding techniques with the
SOIC surface mount ("R") package, as the 0.05" pin spacing doesn’t easily allow routing
of PCB traces between the pins. But, there is still an effective guarding answer, at least
for the inverting case. Figure 12.16 shows guards for the ADI "R" style SOIC package.

Note that for many single op amp devices in this SOIC "R" package, Pins 1, 5, and 8 are
"no connect" pins. Historically these pins were used for offset adjustment and/or
frequency compensation. These functions rarely are used in modern op amps. For such
instances, this means that these empty locations can be employed in the layout to route
guard traces. In the case of the inverting mode (left), the guarding is still completely
effective, with the dummy Pin 1 and Pin 3 serving as the grounded guard trace. This is a
fully effective guard without compromise. Also, with SOIC op amps, much of the
circuitry around the device will not use through hole components. So, the guard ring may
only be necessary on the op amp PCB side.




12.18
                                                               PRINTED CIRCUIT BOARD ISSUES
                                                                                   TRACES
                      NOTE: PINS 1, 5, & 8 ARE OPEN ON MANY “R” PACKAGED DEVICES


            GUARD              1           8                       1               8

              INPUT            2           7         GUARD         2               7

             GUARD             3           6          INPUT        3               6

                               4           5         GUARD         4               5
                         –VS                                     –VS



                            INVERTING MODE                       NON-INVERTING MODE
                            GUARD PATTERN                        GUARD PATTERN

   Figure 12.16: PCB Guard Patterns for Inverting and Noninverting Mode Op
                   Amps Using Eight Pin SOIC (R) Package


In the case of the follower stage (right), the guard trace must be routed around the
negative supply at Pin 4, and thus Pin 4 to Pin 3 leakage isn’t fully guarded. For this
reason, a precision high impedance follower stage using an SOIC package op amp isn’t
generally recommended, as guarding isn’t possible for dual supply connected devices.

However, an exception to this caveat does apply to the use of a single-supply op amp as a
noninverting stage. For example, if the AD8551 is used, Pin 4 becomes ground, and some
degree of intrinsic guarding is then established by default.


Dynamic PCB Effects
Although static PCB effects can come and go with changes in humidity or board
contamination, problems that most noticeably affect the dynamic performance of a circuit
usually remain relatively constant. Short of a new design, washing or any other simple
fixes can’t fix them. As such, they can permanently and adversely affect a design's
specifications and performance. The problems of stray capacitance, linked to lead and
component placement, are reasonably well known to most circuit designers. Since lead
placement can be permanently dealt with by correct layout, any remaining difficulty is
solved by training assembly personnel to orient components or bend leads optimally.

Dielectric absorption (DA), on the other hand, represents a more troublesome and still
poorly understood circuit-board phenomenon. Like DA in discrete capacitors, DA in a
printed-circuit board can be modeled by a series resistor and capacitor connecting two
closely spaced nodes. Its effect is inverse with spacing and linear with length.

As shown in Figure 12.17, the RC model for this effective capacitance ranges from 0.1
pF to 2.0 pF, with the resistance ranging from 50 MΩ to 500 MΩ. Values of 0.5 pF and
100 MΩ are most common. Consequently, circuit-board DA interacts most strongly with
high impedance circuits.




                                                                                       12-19
  BASIC LINEAR DESIGN


                                        0.05" (1.3mm)


                                                  50 - 500MΩ



                                    0.1- 2.0 pF
                                                  CSTRAY




                                            RLEAKAGE




        Figure 12.17: DA Plagues Dynamic Response of PCB-Based Circuits


PCB DA most noticeably influences dynamic circuit response, for example, settling time.
Unlike circuit leakage, the effects aren’t usually linked to humidity or other
environmental conditions, but rather, are a function of the board's dielectric properties.
The chemistry involved in producing plated through holes seems to exacerbate the
problem. If your circuits don’t meet expected transient response specs, you should
consider PCB DA as a possible cause.

Fortunately, there are solutions. As in the case of capacitor DA, external components can
be used to compensate for the effect. More importantly, surface guards that totally isolate
sensitive nodes from parasitic coupling often eliminate the problem (note that these
guards should be duplicated on both sides of the board, in cases of through hole
components). As noted previously, low loss PCB dielectrics are also available.

PCB "hook," similar if not identical to DA, is characterized by variation in effective
circuit-board capacitance with frequency (see Reference 1). In general, it affects high
impedance circuit transient response where board capacitance is an appreciable portion of
the total in the circuit. Circuits operating at frequencies below 10 kHz are the most
susceptible. As in circuit board DA, the board's chemical makeup very much influences
its effects.




12.20
                                                           PRINTED CIRCUIT BOARD ISSUES
                                                                               TRACES

Inductance

Stray Inductance
All conductors are inductive, and at high frequencies, the inductance of even quite short
pieces of wire or printed circuit traces may be important. The inductance of a straight
wire of length L mm and circular cross-section with radius R mm in free space is given
by the first equation shown in Figure 12.18.



                                                                2R   L, R in mm

                                        L

             WIRE INDUCTANCE = 0.0002L ln   ( 2L
                                              R
                                                 ) - 0.75 μ H
             EXAMPLE: 1cm of 0.5mm o.d. wire has an inductance of 7.26nH
                              (2R = 0.5mm, L = 1cm)

                                              L

                      W                                                H




                                               2L             W+H
              STRIP INDUCTANCE = 0.0002L ln ( W+H ) + 0.2235 ( L ) + 0.5 μH

              EXAMPLE: 1cm of 0.25 mm PC track has an inductance of 9.59 nH
                            (H = 0.038mm, W = 0.25mm, L = 1cm)


              Figure 12.18: Wire and Strip Inductance Calculations


The inductance of a strip conductor (an approximation to a PC track) of width W mm and
thickness H mm in free space is also given by the second equation in Figure 12.18.

In real systems, these formulas both turn out to be approximate, but they do give some
idea of the order of magnitude of inductance involved. They tell us that 1 cm of 0.5-mm
of wire has an inductance of 7.26 nH, and 1 cm of 0.25-mm PC track has an inductance
of 9.59 nH—these figures are reasonably close to measured results.

At 10 MHz, an inductance of 7.26 nH has an impedance of 0.46 Ω, and so can give rise
to 1% error in a 50-Ω system.




                                                                                   12-21
  BASIC LINEAR DESIGN

Mutual Inductance
Another consideration regarding inductance is the separation of outward and return
currents. As we shall discuss in more detail later, Kirchoff's Law tells us that current
flows in closed paths—there is always an outward and return path. The whole path forms
a single turn inductor.


                NONIDEAL SIGNAL TRACE ROUTING



                                      LOAD


                                 LOAD

                                                 IMPROVED TRACE ROUTING
                               LOAD



                                                                      LOAD


                                                                 LOAD


                                                               LOAD




           Figure 12.19: Nonideal and Improved Signal Trace Routing


This principle is illustrated by the contrasting signal trace routing arrangements of Figure
9.10. If the area enclosed within the turn is relatively large, as in the upper "nonideal"
picture, then the inductance (and hence the ac impedance) will also be large. On the other
hand, if the outward and return paths are closer together, as in the lower "improved"
picture, the inductance will be much smaller.

Note that the nonideal signal routing case of Figure 12.19 has other drawbacks—the large
area enclosed within the conductors produces extensive external magnetic fields, which
may interact with other circuits, causing unwanted coupling. Similarly, the large area is
more vulnerable to interaction with external magnetic fields, which can induce unwanted
signals in the loop.

The basic principle is illustrated in Figure 12.20, and is a common mechanism for the
transfer of unwanted signals (noise) between two circuits.




12.22
                                                         PRINTED CIRCUIT BOARD ISSUES
                                                                             TRACES

               INTERFERENCE CIRCUIT                 SIGNAL CIRCUIT




                          M = MUTUAL INDUCTANCE
                          B = MAGNETIC REFLUX DENSITY
                          A = AREA OF SIGNAL LOOP
                          ωN = 2πfN = FREQUENCY OF NOISE SOURCE

                          V = INDUCED VOLTAGE = ωNMIN = ωAB


               Figure 12.20: Basic Principles of Inductive Coupling


As with most other noise sources, as soon as we define the working principle, we can see
ways of reducing the effect. In this case, reducing any or all of the terms in the equations
in Figure 12.20 reduces the coupling. Reducing the frequency or amplitude of the current
causing the interference may be impracticable, but it is frequently possible to reduce the
mutual inductance between the interfering and interfered with circuits by reducing loop
areas on one or both sides and, possibly, increasing the distance between them.

A layout solution is illustrated by Figure 12.21. Here two circuits, shown as Z1 and Z2,
are minimized for coupling by keeping each of the loop areas as small as is practical.


                                                                     Z1
                 V1




                 V2
                                                                      Z2


Figure 12.21: Proper Signal Routing and Layout Can Reduce Inductive Coupling


As also illustrated in Figure 12.22, mutual inductance can be a problem in signals
transmitted on cables. Mutual inductance is high in ribbon cables, especially when a
single return is common to several signal circuits (top). Separate, dedicated signal and
return lines for each signal circuit reduces the problem (middle). Using a cable with
                                                                                      12-23
  BASIC LINEAR DESIGN

twisted pairs for each signal circuit as in the bottom picture is even better (but is more
expensive and often unnecessary).


                                                      FLAT RIBBON CABLE WITH SINGLE
                                                       RETURN HAS LARGE MUTUAL
                                                       INDUC TANCE BETWEE N CIRCU ITS




                                                      SEPARATE AND ALTERNATE
                                                       SIGNAL / RETURN LINES FOR
                                                       EACH CIRCU IT REDUC ES
                                                       MUTUAL INDUC TANCE




                                                      TWISTED PAIRS REDUC E
                                                       MUTUAL INDUC TANCE STILL
                                                       FURTHER




      Figure 12.22: Mutual Inductance and Coupling Within Signal Cabling


Shielding of magnetic fields to reduce mutual inductance is sometimes possible, but is by
no means as easy as shielding an electric field with a Faraday shield (following section).
HF magnetic fields are blocked by conductive material provided the skin depth in the
conductor at the frequency to be screened is much less than the thickness of the
conductor, and the screen has no holes (Faraday shields can tolerate small holes,
magnetic screens cannot). LF and DC fields may be screened by a shield made of mu-
metal sheet. Mu-metal is an alloy having very high permeability, but it is expensive, its
magnetic properties are damaged by mechanical stress, and it will saturate if exposed to
too high fields. Its use, therefore, should be avoided where possible.


Parasitic Effects in Inductors
Although inductance is one of the fundamental properties of an electronic circuit,
inductors are far less common as components than are resistors and capacitors. As for
precision components, they are even more rare. This is because they are harder to
manufacture, less stable, and less physically robust than resistors and capacitors. It is
relatively easy to manufacture stable precision inductors with inductances from nH to
tens or hundreds of µH, but larger valued devices tend to be less stable, and large.

As we might expect in these circumstances, circuits are designed, where possible, to
avoid the use of precision inductors. We find that stable precision inductors are relatively
rarely used in precision analog circuitry, except in tuned circuits for high frequency
narrow-band applications.
12.24
                                                          PRINTED CIRCUIT BOARD ISSUES
                                                                              TRACES
Of course, they are widely used in power filters, switching power supplies and other
applications where lack of precision is unimportant (more on this in a following section).
The important features of inductors used in such applications are their current carrying
and saturation characteristics, and their Q. If an inductor consists of a coil of wire with an
air core, its inductance will be essentially unaffected by the current it is carrying. On the
other hand, if it is wound on a core of a magnetic material (magnetic alloy or ferrite), its
inductance will be nonlinear, since at high currents, the core will start to saturate. The
effects of such saturation will reduce the efficiency of the circuitry employing the
inductor and is liable to increase noise and harmonic generation.

As mentioned above, inductors and capacitors together form tuned circuits. Since all
inductors will also have some stray capacity, all inductors will have a resonant frequency
(which will normally be published on their data sheet), and should only be used as
precision inductors at frequencies well below this.


Q or "Quality Factor"
The other characteristic of inductors is their Q (or "Quality Factor"), which is the ratio of
the reactive impedance to the resistance, as indicated in Figure 12.23.

                   Q = 2πf L/R
              




                   The Q of an inductor or resonant circuit is a
              




                   measure of the ratio of its reactance to its
                   resistance.


                   The resistance is the HF and NOT the DCvalue.
              




                   The 3 dB bandwidth of a single tuned circuit is
              




                   Fc/Q where Fc is the center frequency.

                     Figure 12.23: Inductor Q or Quality Factor


It is rarely possible to calculate the Q of an inductor from its dc resistance, since skin
effect (and core losses if the inductor has a magnetic core) ensure that the Q of an
inductor at high frequencies is always lower than that predicted from dc values.

Q is also a characteristic of tuned circuits (and of capacitors—but capacitors generally
have such high Q values that it may be disregarded, in practice). The Q of a tuned circuit,
which is generally very similar to the Q of its inductor (unless it is deliberately lowered
by the use of an additional resistor), is a measure of its bandwidth around resonance. LC
tuned circuits rarely have Q of much more than 100 (3 dB bandwidth of 1%), but ceramic
resonators may have a Q of thousands, and quartz crystals tens of thousands.
                                                                                       12-25
  BASIC LINEAR DESIGN


Don't Overlook Anything
Remember, if your precision op amp or data-converter-based design does not meet
specification, try not to overlook anything in your efforts to find the error sources.
Analyze both active and passive components, trying to identify and challenge any
assumptions or preconceived notions that may blind you to the facts. Take nothing for
granted.

For example, when not tied down to prevent motion, cable conductors, moving within
their surrounding dielectrics, can create significant static charge buildups that cause
errors, especially when connected to high impedance circuits. Rigid cables, or even costly
low noise Teflon-insulated cables, are expensive alternative solutions.

As more and more high precision op amps become available, and system designs call for
higher speed and increased accuracy, a thorough understanding of the error sources
described in this section (as well those following) becomes more important.

Some additional discussions of passive components within a succeeding power supply
filtering section complements this one. In addition, the very next section on PCB design
issues also complements many points within this section. Similar comments apply to the
chapter on EMI/RFI.




12.26
                                                             PRINTED CIRCUIT BOARD ISSUES
                                                                                 TRACES

Stray Capacitance
When two conductors aren’t short-circuited together, or totally screened from each other
by a conducting (Faraday) screen, there is a capacitance between them. So, on any PCB,
there will be a large number of capacitors associated with any circuit (which may or may
not be considered in models of the circuit). Where high frequency performance matters
(and even dc and VLF circuits may use devices with high Ft and therefore be vulnerable
to HF instability), it is very important to consider the effects of this stray capacitance.

Any basic textbook will provide formulas for the capacitance of parallel wires and other
geometric configurations (see References 9 and 10). The example we need consider in
this discussion is the parallel plate capacitor, often formed by conductors on opposite
sides of a PCB. The basic diagram describing this capacitance is shown in Figure 12.24.



                                                          0.00885 E r A
                                                     C=                   pF
                                                                 d

                    A                                                       2
                                  d                  A = plate area in mm

                                                     d = plate separation in mm

                                                     E r = dielectric constant relative to air




                                      u Most common PCB type uses 1.5mm
                                        glass-fiber epoxy material with E r = 4.7

                                      u Capacitance of PC track over ground
                                        plane is roughly 2.8 pF/cm2



                  Figure 12.24: Capacitance of two parallel plates

Neglecting edge effects, the capacitance of two parallel plates of area A mm2 and
separation d mm in a medium of dielectric constant Er relative to air is:

                                      0.00885 Er A/d pF.                                    Eq. 12-1

where:
               Er = the dielectric constant of the insulator material relative to air
               A = the plate area
               D = the distance between the plates


From this formula, we can calculate that for general purpose PCB material (Er = 4.7,
d = 1.5 mm), the capacitance between conductors on opposite sides of the board is just
under 3 pF/cm2. In general, such capacitance will be parasitic, and circuits must be
designed so that it does not affect their performance.
                                                                               12-27
  BASIC LINEAR DESIGN

While it is possible to use PCB capacitance in place of small discrete capacitors, the
dielectric properties of common PCB substrate materials cause such capacitors to behave
poorly. They have a rather high temperature coefficient and poor Q at high frequencies,
which makes them unsuitable for many applications. Boards made with lower loss
dielectrics such as Teflon are expensive exceptions to this rule.


Capacitive Noise & Faraday Shields

There is a capacitance between any two conductors separated by a dielectric (air or
vacuum are dielectrics). If there is a change of voltage on one, there will be a movement
of charge on the other. A basic model for this is shown in Figure 12.25.

                                          C

                               IN
                      VN                            Z1          VCOUPLED




                            Z1 = CIRCUIT IMPEDANCE
                            Z2 = 1/jωC
                                               ⎛   Z1 ⎞
                            VCOUPLED = VN      ⎜         ⎟
                                               ⎝ Z1 + Z2 ⎠



           Figure 12.25: Capacitive Coupling Equivalent Circuit Model


It is evident that the noise voltage, VCOUPLED appearing across Z1, may be reduced by
several means, all of which reduce noise current in Z1. They are reduction of the signal
voltage VN, reduction of the frequency involved, reduction of the capacitance, or
reduction of Z1 itself. Unfortunately however, often none of these circuit parameters can
be freely changed, and an alternate method is needed to minimize the interference. The
best solution towards reducing the noise coupling effect of C is to insert a grounded
conductor, also known as a Faraday shield, between the noise source and the affected
circuit. This has the desirable effect of reducing Z1 noise current, thus reducing VCOUPLED.

A Faraday shield model is shown by Figure 12.26. In the left picture, the function of the
shield is noted by how it effectively divides the coupling capacitance, C. In the right
picture the net effect on the coupled voltage across Z1 is shown. Although the noise
current IN still flows in the shield, most of it is now diverted away from Z1. As a result,
the coupled noise voltage VCOUPLED across Z1 is reduced.

A Faraday shield is easily implemented and almost always successful. Thus capacitively
coupled noise is rarely an intractable problem. However, to be fully effective, a Faraday
12.28
                                                           PRINTED CIRCUIT BOARD ISSUES
                                                                               TRACES
shield must completely block the electric field between the noise source and the shielded
circuit. It must also be connected so that the displacement current returns to its source,
without flowing in any part of the circuit where it can introduce conducted noise.

                   CAPACITIVE
                     SHIELD
               C

        IN
                                                                IN
VN                          Z1         VCOUPLED   VN                           Z1   V COUPLED




             Figure 12.26: An Operational Model of a Faraday Shield




Buffering ADCs Against Logic Noise
If we have a high resolution data converter (ADC or DAC) connected to a high speed
data bus which carries logic noise with a 2 V/ns to 5 V/ns edge rate, this noise is easily
connected to the converter analog port via stray capacitance across the device. Whenever
the data bus is active, intolerable amounts of noise are capacitively coupled into the
analog port, thus seriously degrading performance.

                                 ADC                   CMOS
                                  IC                BUFFER/LATCH




                ANALOG
                INPUT
                PORT(S)
                                                                          NOISY
                                                                         DATA BUS
                                             N                       N




                     THE OUTPUT BUFFER/LATCH ACTS AS A FARADAY
                      SHIELD BETWEEN “N” LINES OF A FAST, NOISY DATA
                      BUS AND A HIGH PERFORMANCE ADC.

                     THIS MEASURE ADDS COST, BOARD AREA, POWER
                      CONSUMPTION, RELIABILITY REDUCTION, DESIGN
                      COMPLEXITY, AND MOST IMPORTANTLY,
                      IMPROVED PERFORMANCE!



Figure 12.27: A High Speed ADC IC Sitting on a Fast Data Bus Couples Digital
            Noise into the Analog Port, thus Limiting Performance
                                                                                     12-29
  BASIC LINEAR DESIGN

This particular effect is illustrated by the diagram of Figure 12.27, where multiple
package capacitors couple noisy edge signals from the data bus into the analog input of
an ADC.

Present technology offers no cure for this problem, within the affected IC device itself.
The problem also limits performance possible from other broadband monolithic mixed
signal ICs with single chip analog and digital circuits. Fortunately, this coupled noise
problem can be simply avoided, by not connecting the data bus directly to the converter.

                                            ADC
                                             IC




                   ANALOG
                    INPUT
                   PORT(S)
                                                                 NOISY
                                                                 DATA
                                                                  BUS




Figure 12.28: A High Speed ADC IC Using a CMOS Buffer/Latch at the Output
            Shows Enhanced Immunity of Digital Data Bus Noise


Instead, use a CMOS latched buffer as a converter-to-bus interface, as shown by
Figure 12.28. Now the CMOS buffer IC acts as a Faraday shield, and dramatically
reduces noise coupling from the digital bus. This solution costs money, occupies board
area, reduces reliability (very slightly), consumes power, and it complicates the design—
but it does improve the signal-to-noise ratio of the converter! The designer must decide
whether it is worthwhile for individual cases, but in general it is highly recommended.



High Circuit Impedances are Susceptible to Noise Pickup
Since low power circuits tend to use high value resistors to conserve power, this tends to
make the circuit more susceptible to externally induced radiated noise and conducted
noise. Even a small amount of parasitic capacitance can create a significant conduction
path for noise to penetrate.



12.30
                                                         PRINTED CIRCUIT BOARD ISSUES
                                                                             TRACES
For example, as little as 1 pF of parasitic capacitance allows a 5 V logic transition to
cause a large disturbance in a 100 kΩ circuit as illustrated in Figure 12.29

This serves to illustrate that high impedance circuits are full of potential parasitics which
can cause a good paper design to perform poorly when actually implemented. One needs
to pay particular attention to the routing of signals. Interestingly, many high frequency
layout techniques for eliminating parasitics can also be applied here for low frequency,
low power circuits—for different reasons. While circuit parasitics cause unwanted phase
shifts and instabilities in high frequency circuits, the same parasitics pick up unwanted
noise in low power precision circuits.




 Figure 12.29 High Circuit Impedances Increase Susceptibility to Noise Pickup


As discussed in the chapter on amplifiers, current feedback amplifiers do not like to have
capacitances on their inputs. To that end, ground planes should be cut back from the input
pins as shown in Fig. 12.30, which is an evaluation board for the AD8001 high speed
current feedback amplifier. The effect of even small capacitance on the input of a current
feedback amplifier is shown in Fig. 12.31. Note the ringing on the output.




                                                                                      12-31
  BASIC LINEAR DESIGN




         Fig. 12.30a: AD8001AR (SOIC) Evaluation Board—Top View




        Fig. 12.30b: AD8001AR (SOIC) Evaluation Board—Bottom View



12.32
                                                       PRINTED CIRCUIT BOARD ISSUES
                                                                           TRACES




   Figure 12.31: Effects of 10 pF Stray Capacitance on the Inverting Input on
                     Amplifier (AD8001) Pulse Response


Skin Effect
At high frequencies, also consider skin effect, where inductive effects cause currents to
flow only in the outer surface of conductors. Note that this is in contrast to the earlier
discussions of this section on dc resistance of conductors.

The skin effect has the consequence of increasing the resistance of a conductor at high
frequencies. Note also that this effect is separate from the increase in impedance due to
the effects of the self-inductance of conductors as frequency is increased.

                                      MICROSTRIP
                                      CONDUCTOR
                                      (CURRENT FLOW NORMAL
                                      TO DIAGRAM)



                                            HF CURRENT FLOWS IN ONE
          PC BOARD
                                            SIDE OF THE CONDUCTOR ONLY
         (DIELECTRIC)


         GROUND PLANE

                                        REGION OF RETURN
                                        CURRENT FLOW

                  Figure 12.32: Skin Depth in a PCB Conductor




                                                                                    12-33
  BASIC LINEAR DESIGN

Skin effect is quite a complex phenomenon, and detailed calculations are beyond the
scope of this discussion. However, a good approximation for copper is that the skin depth
in centimeters is 6.61/√f, (f in Hz). A summary of the skin effect within a typical PCB
conductor foil is shown in Figure 12.32. Note that this copper conductor cross-sectional
view assumes looking into the side of the conducting trace. Assuming that skin effects
become important when the skin depth is less than 50% of the thickness of the conductor,
this tells us that for a typical PC foil, we must be concerned about skin effects at
frequencies above approximately 12 MHz.

Where skin effect is important, the resistance for copper is 2.6 x 10-7 √f Ω/square, (f in
Hz). This formula is invalid if the skin thickness is greater than the conductor thickness
(i.e., at dc or LF).

Figure 12.33 illustrates a case of a PCB conductor with current flow, as separated from
the ground plane underneath.



               HF Current flows only
                in thin surface layers
                                                    TOP

                                           COPPER CONDUCTOR

                                                   BOTTOM
               Skin Depth: 6.61 √ f cm, f in Hz

                                          -7
               Skin Resistance: 2.6 x 10 √ f ohms per square, f in Hz

               Since skin currents flow in both sides of a PC track, the
                value of skin resistance in PCBs must take account of this



        Figure 12.33: Skin Effect with PCB Conductor and Ground Plane


In this diagram, note the (dotted) regions of HF current flow, as reduced by the skin
effect. When calculating skin effect in PCBs, it is important to remember that current
generally flows in both sides of the PC foil (this is not necessarily the case in microstrip
lines, see below), so the resistance per square of PC foil may be half the above value.




12.34
                                                        PRINTED CIRCUIT BOARD ISSUES
                                                                            TRACES

Transmission Lines
We earlier considered the benefits of outward and return signal paths being close together
so that inductance is minimized. As shown previously in Figure 7-30, when an HF signal
flows in a PC track running over a ground plane, the arrangement functions as a
microstrip transmission line, and the majority of the return current flows in the ground
plane directly underneath the line.

Figure 12.34 shows the general parameters for a microstrip transmission line, given the
conductor width, w, dielectric thickness, h, and the dielectric constant, Er.

The characteristic impedance of such a microstrip line will depend upon the width of the
track and the thickness and dielectric constant of the PCB material. Designs of microstrip
lines are covered in more detail later in this chapter.


                                       CONDUCTOR




                                      w
                        DIELECTRIC               h

                       GROUND PLANE




     Figure 12.34: A PCB Microstrip Transmission Line Is an Example of a
                    Controlled Impedance Conductor Pair


For most dc and lower frequency applications, the characteristic impedance of PCB
traces will be relatively unimportant. Even at frequencies where a track over a ground
plane behaves as a transmission line, it is not necessary to worry about its characteristic
impedance or proper termination if the free space wavelengths of the frequencies of
interest are greater than ten times the length of the line.

However, at VHF and higher frequencies it is possible to use PCB tracks as microstrip
lines within properly terminated transmission systems. Typically the microstrip will be
designed to match standard coaxial cable impedances, such as 50 Ω, 75 Ω, or 100 Ω,
simplifying interfacing.

Note that if losses in such systems are to be minimized, the PCB material must be chosen
for low/high frequency losses. This usually means the use of Teflon or some other
comparably low-loss PCB material. Often, though, the losses in short lines on cheap
glass-fiber board are small enough to be quite acceptable.

                                                                                     12-35
  BASIC LINEAR DESIGN

Design PCBs Thoughtfully
Once the system's critical paths and circuits have been identified, the next step in
implementing sound PCB layout is to partition the printed circuit board according to
circuit function. This involves the appropriate use of power, ground, and signal planes.
Good PCB layouts also isolate critical analog paths from sources of high interference
(I/O lines and connectors, for example). High frequency circuits (analog and digital)
should be separated from low frequency ones. Furthermore, automatic signal routing
CAD layout software should be used with extreme caution. Critical signal paths should
be routed by hand, to avoid undesired coupling and/or emissions.

Properly designed multilayer PCBs can reduce EMI emissions and increase immunity to
RF fields, by a factor of 10 or more, compared to double-sided boards. A multilayer
board allows a complete layer to be used for the ground plane, whereas the ground plane
side of a double-sided board is often disrupted with signal crossovers, etc. If the system
has separate analog and digital ground and power planes, the analog ground plane should
be underneath the analog power plane, and similarly, the digital ground plane should be
underneath the digital power plane. There should be no overlap between analog and
digital ground planes, nor analog and digital power planes.


Designing Controlled Impedances Traces on PCBs
A variety of trace geometries are possible with controlled impedance designs, and they
may be either integral to or allied to the PCB pattern. In the discussions below, the basic
patterns follow those of the IPC, as described in standard 2141 (see Reference 16).

Note that the figures below use the term "ground plane." It should be understood that this
plane is in fact a large area, low impedance reference plane. In practice it may actually be
either a ground plane or a power plane, both of which are assumed to be at zero ac
potential.

                                               D
                                WIRE




                                           DIELECTRIC       H




                            GROUND PLANE



 Figure 12.35: A Wire Microstrip Transmission Line With Defined Impedance is
          Formed by an Insulated Wire Spaced From a Ground Plane


The first of these is the simple wire-over-a-plane form of transmission line, also called a
wire microstrip. A cross-sectional view is shown in Figure 12.35. This type of
transmission line might be a signal wire used within a breadboard, for example. It is
12.36
                                                          PRINTED CIRCUIT BOARD ISSUES
                                                                              TRACES
composed simply of a discrete insulated wire spaced a fixed distance over a ground
plane. The dielectric would be either the insulation wall of the wire, or a combination of
this insulation and air.

The impedance of this line in ohms can be estimated with Eq. 12-2.

                                                60   ⎡ 4H ⎤
                                    Zo (Ω ) =     ln ⎢ ⎥ .                        Eq. 12-2
                                                εr ⎣ D ⎦
where:
               D = the conductor diameter
               H = the wire spacing above the plane
               εr = the dielectric constant of the material relative to air.

For patterns integral to the PCB, there are a variety of geometric models from which to
choose, single-ended and differential. These are covered in some detail within IPC
standard 2141 (see Reference 16), but information on two popular examples is shown
here.

Before beginning any PCB-based transmission line design, it should be understood that
there are abundant equations, all claiming to cover such designs. In this context, "Which
of these are accurate?" is an extremely pertinent question. The unfortunate answer is,
none are perfectly so! All of the existing equations are approximations, and thus accurate
to varying degrees, depending upon specifics. The best known and most widely quoted
equations are those of Reference 16, but even these come with application caveats.

Reference 17 has evaluated the Reference 16 equations for various geometric patterns
against test PCB samples, finding that predicted accuracy varies according to target
impedance. Reference 18 also evaluates the Reference 16 equations, offering an
alternative and even more complex set (see Reference 19). The equations quoted below
are from Reference 16, and are offered here as a starting point for a design, subject to
further analysis, testing and design verification. The bottom line is, study carefully, and
take PCB trace impedance equations with a proper dose of salt.




                                                                                     12-37
  BASIC LINEAR DESIGN

Microstrip PCB Transmission Lines
For a simple two-sided PCB design where one side is a ground plane, a signal trace on
the other side can be designed for controlled impedance. This geometry is known as a
surface microstrip, or more simply, microstrip.

A cross-sectional view of a two-layer PCB illustrates this microstrip geometry as shown
in Figure 12.36.

                             TRACE
                                               W
                                                           T


                                          DIELECTRIC               H




                         GROUND PLANE



   Figure 12.36: A Microstrip Transmission Line with Defined Impedance Is
Formed by a PCB Trace of Appropriate Geometry, Spaced from a Ground Plane


For a given PCB laminate and copper weight, note that all parameters will be
predetermined except for W, the width of the signal trace. Eq. 12-3 can then be used to
design a PCB trace to match the impedance required by the circuit. For the signal trace of
width W and thickness T, separated by distance H from a ground (or power) plane by a
PCB dielectric with dielectric constant εr, the characteristic impedance is:

                                         87            ⎡   5.98H    ⎤
                          Z o (Ω ) =                ln ⎢            ⎥
                                       ε r + 1.41      ⎣ (0.8W + T )⎦            Eq. 12-3


Note that in these expressions, measurements are in common dimensions (mils).

These transmission lines will have not only a characteristic impedance, but also
capacitance. This can be calculated in terms of pF/in as shown in Eq. 12-4.

                                                    0.67 (ε r + 1.41 )
                             C o (pF/in ) =
                                              ln [5.98H (0.8W + T )]             Eq. 12-4

As an example including these calculations, a 2-layer board might use 20-mil wide (W),
1 ounce (T = 1.4) copper traces separated by 10-mil (H) FR-4 (ε = 4.0) dielectric
material. The resulting impedance for this microstrip would be about 50 Ω. For other
standard impedances, for example the 75 Ω video standard, adjust "W" to about 8.3 mils.




12.38
                                                          PRINTED CIRCUIT BOARD ISSUES
                                                                              TRACES

Some Microstrip Guidelines
This example touches an interesting and quite handy point. Reference 17 discusses a
useful guideline pertaining to microstrip PCB impedance. For a case of dielectric
constant of 4.0 (FR-4), it turns out that when W/H is 2/1, the resulting impedance will be
close to 50 Ω (as in the first example, with W=20 mils).

Careful readers will note that Eq. 9.21 predicts Zo to be about 46 Ω, generally consistent
with accuracy quoted in Reference 17 (>5%). The IPC microstrip equation is most
accurate between 50 Ω and 100 Ω, but is substantially less so for lower (or higher)
impedances. Reference 20 gives tabular results of various PCB industry impedance
calculator tools.

The propagation delay of the microstrip line can also be calculated, as per Eq. 12-5. This
is the one-way transit time for a microstrip signal trace. Interestingly, for a given
geometry model, the delay constant in ns/ft is a function only of the dielectric constant,
and not the trace dimensions (see Reference 21). Note that this is quite a convenient
situation. It means that, with a given PCB laminate (and given ε r), the propagation delay
constant is fixed for various impedance lines.

                             t pd (ns/ft ) = 1.017 0.475 ε r + 0.67
                                                                                  Eq. 12-5

This delay constant can also be expressed in terms of ps/in, a form which will be more
practical for smaller PCBs. This is:

                             t pd (ps/in ) = 85 0.475 ε r + 0.67
                                                                                  Eq. 12.6

Thus for an example PCB dielectric constant of 4.0, it can be noted that a microstrip's
delay constant is about 1.63 ns/ft, or 136 ps/in. These two additional guidelines can be
useful in designing the timing of signals across PCB trace runs.




                                                                                     12-39
  BASIC LINEAR DESIGN

Symmetric Stripline PCB Transmission Lines
A method of PCB design preferred from many viewpoints is a multilayer PCB. This
arrangement embeds the signal trace between a power and a ground plane, as shown in
the cross-sectional view of Figure 9.142. The low impedance ac-ground planes and the
embedded signal trace form a symmetric stripline transmission line.



                                               DIELECTRIC
                                                                  H
                                               W
                           GROUND,
                            POWER                         T              B
                           PLANES
                                                                  H
                                          EMBEDDED
                                            TRACE




 Figure 12.37: A Symmetric Stripline Transmission Line With Defined Impedance
is Formed by a PCB Trace of Appropriate Geometry Embedded Between Equally
                    Spaced Ground and/or Power Planes


As can be noted from the figure, the return current path for a high frequency signal trace
is located directly above and below the signal trace on the ground/power planes. The high
frequency signal is thus contained entirely inside the PCB, minimizing emissions, and
providing natural shielding against incoming spurious signals.

The characteristic impedance of this arrangement is again dependent upon geometry and
the εr of the PCB dielectric. An expression for ZO of the stripline transmission line is:


                              Zo (Ω ) =
                                          60
                                               ln
                                                    ⎡ 1.9 (B ) ⎤
                                          εr        ⎢⎣ (0.8W + T )⎥⎦ .             Eq. 12.7

Here, all dimensions are again in mils, and B is the spacing between the two planes. In
this symmetric geometry, note that B is also equal to 2H + T. Reference 17 indicates that
the accuracy of this Reference 16 equation is typically on the order of 6%.

Another handy guideline for the symmetric stripline in an εr = 4.0 case is to make B a
multiple of W, in the range of 2 to 2.2. This will result in an stripline impedance of about
50 Ω. Of course this rule is based on a further approximation, by neglecting T.
Nevertheless, it is still useful for ballpark estimates.




12.40
                                                              PRINTED CIRCUIT BOARD ISSUES
                                                                                  TRACES
The symmetric stripline also has a characteristic capacitance, which can be calculated in
terms of pF/in:

                                             1.41 (ε r )
                      C o (pF/in ) =
                                       ln [3.81H (0.8W + T )]                     Eq. 12-8

The propagation delay of the symmetric stripline is shown in Eq. 12-9.

                                  t pd (ns/ft ) = 1.017 ε r
                                                                                  Eq. 12-9

or, in terms of ps:

                                  t pd (ps/in ) = 85 ε r
                                                                                 Eq. 12-10

For a PCB dielectric constant of 4.0, it can be noted that the symmetric stripline’s delay
constant is almost exactly 2 ns/ft, or 170 ps/in.




                                                                                     12-41
  BASIC LINEAR DESIGN

Some Pros and Cons of Embedding Traces
The above discussions allow the design of PCB traces of defined impedance, either on a
surface layer or embedded between layers. There of course are many other considerations
beyond these impedance issues.

Embedded signals do have one major and obvious disadvantage—the debugging of the
hidden circuit traces is difficult to impossible. Some of the pros and cons of embedded
signal traces are summarized in Figure 12.38.


               NOT EMBEDDED                                       EMBEDDED
 Route                                            Power
 Power                                            Route
 Ground                                           Route
 Route                                            Ground

            Advantages
                Signal traces shielded and protected
                Lower impedance, thus lower emissions and crosstalk
                Significant improvement > 50MHz
            Disadvantages
                Difficult prototyping and troubleshooting
                Decoupling may be more difficult
                Impedance may be too low for easy matching

 Figure 12.38: The Pros and Cons of Not Embedding vs. Embedding of Signal
                     Traces in Multilayer PCB Designs


Multilayer PCBs can be designed without the use of embedded traces, as is shown in the
left-most cross-sectional example. This embedded case could be considered as a doubled
two layer PCB design (i.e., four copper layers overall). The routed traces at the top form a
microstrip with the power plane, while the traces at the bottom form a microstrip with the
ground plane. In this example, the signal traces of both outer layers are readily accessible
for measurement and troubleshooting purposes. But, the arrangement does nothing to
take advantage of the shielding properties of the planes.

This nonembedded arrangement will have greater emissions and susceptibility to external
signals, vis-à-vis the embedded case at the right, which uses the embedding, and does
take full advantage of the planes. As in many other engineering efforts, the decision of
embedded vs. nonembedded for the PCB design becomes a tradeoff, in this case one of
reduced emissions vs. ease of testing.

12.42
                                                                                                               PRINTED CIRCUIT BOARD ISSUES
                                                                                                                                   TRACES

Dealing with High Speed Logic
Much has been written about terminating PCB traces in their characteristic impedance, to
avoid signal reflections. A good guideline to determine when this is necessary is as
follows: Terminate the transmission line in its characteristic impedance when the one-
way propagation delay of the PCB track is equal to or greater than one-half the applied
signal rise/fall time (whichever edge is faster). For example, a 2 inch microstrip line over
an Er = 4.0 dielectric would have a delay of ~270 ps. Using the above rule strictly,
termination would be appropriate whenever the signal rise time is < ~500 ps. A more
conservative rule is to use a 2 inch (PCB track length)/nanosecond (rise/fall time) rule. If
the signal trace exceeds this trace-length/speed criterion, then termination should be used.

For example, PCB tracks for high speed logic with rise/fall time of 5 ns should be
terminated in their characteristic impedance if the track length is equal to or greater than
10 inches (where measured length includes meanders).

As an example of what can be expected today in modern systems, Figure 12.39 shows
typical rise/fall times for several logic families including the SHARC DSPs operating on
+3.3V supplies. As would be expected, the rise/fall times are a function of load
capacitance.

                   GaAs: 0.1ns
                   ECL: 0.75n s
                   ADI SHARC DSPs: 0.5ns TO 1n s (OPERATING ON +3.3V SUPPLY)
                                                                18
                          RISE AND FALL TIMES – n s (10%–90%)




                                                                16

                                                                14
                                                                                         Y = 0.0796X + 1.17
                                                                12
         ASDP-21060l
           SHARC:                                               10
                                                                                   RIS E T IME
                                                                8

                                                                6                                              Y = 0.0467X + 0.55

                                                                4                              F A L L T IME

                                                                2

                                                                0
                                                                    0   20   40     60    80     1 00 1 20       1 40 1 60 1 80 2 00
                                                                                  LOAD CAPACITANCE – p F


          Figure 12.39: Typical DSP Output Rise Times and Fall Times


In the analog domain, it is important to note that this same 2 inch/nanosecond rule of
thumb should also be used with op amps and other circuits, to determine the need for
transmission line techniques. For instance, if an amplifier must output a maximum
frequency of fmax, then the equivalent rise time tr is related to this fmax. This limiting rise
time, tr, can be calculated as:
                                  tr = 0.35/fmax                                     Eq. 12-11

                                                                                                                                       12-43
  BASIC LINEAR DESIGN

The maximum PCB track length is then calculated by multiplying tr by
2 inch/nanosecond. For example, a maximum frequency of 100 MHz corresponds to a
rise time of 3.5 ns, so a 7-inch or more track carrying this signal should be treated as a
transmission line.

The best ways to keep sensitive analog circuits from being affected by fast logic are to
physically separate the two by the PCB layout, and to use no faster logic family than is
dictated by system requirements. In some cases, this may require the use of several logic
families in a system. An alternative is to use series resistance or ferrite beads to slow
down the logic transitions where highest speed isn't required. Figure 12.40 shows two
methods.


                                            < 2 inches
                                   R
                 LOGIC                                           LOGIC
                 GATE                                            GATE
                                                      CIN
                                Risetime = 2.2 R·CIN


                                            > 2 inches
                                   R
                 LOGIC                                           LOGIC
                 GATE                                            GATE
                                    C                 CIN



                                Risetime = 2.2 R·(C + CIN)

        Figure 12.40: Damping Resistors Slow Down Fast Logic Edges to
                         Minimize EMI/RFI Problems


In the first, the series resistance and the input capacitance of the gate form a low-pass
filter. Typical CMOS input capacitance is 5 pF to10 pF. Locate the series resistor close to
the driving gate. The resistor minimizes transient currents and may eliminate the
necessity of using transmission line techniques. The value of the resistor should be
chosen such that the rise and fall times at the receiving gate are fast enough to meet
system requirement, but no faster. Also, make sure that the resistor is not so large that the
logic levels at the receiver are out of specification because of the voltage drop caused by
the source and sink current which flow through the resistor. The second method is
suitable for longer distances (>2 inches), where additional capacitance is added to slow
down the edge speed. Notice that either one of these techniques increases delay and
increases the rise/fall time of the original signal. This must be considered with respect to
the overall timing budget, and the additional delay may not be acceptable.



12.44
                                                       PRINTED CIRCUIT BOARD ISSUES
                                                                           TRACES
Figure 12.41 shows a situation where several DSPs must connect to a single point, as
would be the case when using read or write strobes bidirectionally connected from
several DSPs. Small damping resistors shown in Figure 12.41A can minimize ringing
provided the length of separation is less than about 2 inches. This method will also
increase rise/fall times and propagation delay. If two groups of processors must be
connected, a single resistor between the pairs of processors as shown in Figure 12.41B
can serve to damp out ringing.


                                       SHARC                             SHARC
        A      STAR CONNECTION
                                        DSP                               DSP
              DAMPING RESISTORS                           <2"



                USE FOR RD, WR
                STROBES
                                                          10Ω
                                                         EACH
                                       SHARC                             SHARC
                                        DSP                               DSP

       NOTE: THESE TECHNIQUES
       INCR EASE RISE/FALL TIMES
       AND PROPAGATION DELAY
                                       SHARC                             SHARC
                                        DSP               <2"             DSP
        B    SINGLE DAMPLING
            RESISTOR BETWEEN                              20Ω
            PROCESS OR GROUPS


                                       SHARC                             SHARC
                                        DSP                               DSP




 Figure 12.41: Series Damping Resistors for High Speed DSP Interconnections


The only way to preserve 1 ns or less rise/fall times over distances greater than about
2 inches without ringing is to use transmission line techniques. Figure 12.42 shows two
popular methods of termination: end termination and source termination. The end
termination method (Figure 12.42A) terminates the cable at its terminating point in the
characteristic impedance of the microstrip transmission line. Although higher impedances
can be used, 50 Ω is popular because it minimizes the effects of the termination
impedance mismatch due to the input capacitance of the terminating gate (usually 5 pF to
10 pF).

In Figure 12.42A, the cable is terminated in a Thevenin impedance of 50 Ω terminated to
+1.4 V (the midpoint of the input logic threshold of 0.8 V and 2.0 V). This requires two
resistors (91 Ω and 120 Ω), which add about 50 mW to the total quiescent power
dissipation to the circuit. Figure 12.42A also shows the resistor values for terminating
with a +5 V supply (68 Ω and 180 Ω). Note that 3.3-V logic is much more desirable in
line driver applications because of its symmetrical voltage swing, faster speed, and lower
power. Drivers are available with less than 0.5 ns time skew, source, and sink current
                                                                                    12-45
    BASIC LINEAR DESIGN

capability greater than 25 mA, and rise/fall times of about 1 ns. Switching noise
generated by 3.3 V logic is generally less than 5 V logic because of the reduced signal
swings and lower transient currents.


                  TYPICAL DRIVERS:
               74FCT3807/A (IDT)                        +3.3V               +5.0V
A              74ACTQ240 (Fairchild)
                                                         120Ω                 180Ω
                                                         30mW                 72mW
                                ZO = 50Ω       +1.4V
                                                                                     +1.4V

                                                          91Ω                  68Ω
                                                         22mW                 29mW

        GROUND PLANE
                                                      END TERMINATION


          B                   SOURCE TERMINATION
                   ZO ≈ 10Ω

                          39Ω              ZO = 50Ω




              RULE OF THUMB:    USE TRANSMISSION LINE IF DISTANCE IS
                                MORE THAN 2"/ns OF LOGIC RISE/FALL TIME

                    50Ω PC BOARD TRANSMISSION LINE DELAY ≈ 1ns / 7"


               Figure 12.42: Termination Techniques for Controlled
                    Impedance Microstrip Transmission Lines


The source termination method, shown in Figure 12.42B, absorbs the reflected waveform
with an impedance equal to that of the transmission line. This requires about 39 Ω in
series with the internal output impedance of the driver, which is generally about 10 Ω.
This technique requires that the end of the transmission line be terminated in an open
circuit, therefore no additional fanout is allowed. The source termination method adds no
additional quiescent power dissipation to the circuit.

Figure 12.43 shows a method for distributing a high speed clock to several devices. The
problem with this approach is that there is a small amount of time skew between the
clocks because of the propagation delay of the microstrip line (approximately 1 ns /7").
This time skew may be critical in some applications. It is important to keep the stub
length to each device less than 0.5" in order to prevent mismatches along the transmission
line.

The clock distribution method shown in Figure 12.44 minimizes the clock skew to the
receiving devices by using source terminations and making certain the length of each
microstrip line is equal. There is no extra quiescent power dissipation as would be the
case using end termination resistors.

12.46
                                                            PRINTED CIRCUIT BOARD ISSUES
                                                                                TRACES

Figure 12.45 shows how source terminations can be used in bidirectional link port
transmissions between SHARC DSPs. The output impedance of the SHARC driver is
approximately 17 Ω, and therefore a 33 Ω series resistor is required on each end of the
transmission line for proper source termination.

The method shown in Figure 12.46 can be used for bidirectional transmission of signals
from several sources over a relatively long transmission line. In this case, the line is
terminated at both ends, resulting in a dc load impedance of 25 Ω. SHARC drivers are
capable of driving this load to valid logic levels.

                                                                                     +3.3V

                                                                                     120Ω
                                      TRANSMISSION LINE ZO = 50Ω                     30mW
   CLOCK                                                                     +1.4V

                                                                                      91Ω
                                                                                     22mW



                           SHARC                 SHARC              SHARC
                            DSP                   DSP                DSP


                           50Ω PC BOARD TRANSMISSION LINE DELAY ≈ 1ns / 7"
                                   NOTE: KEEP STUB LENGTH < 0.5"
                      NOT RECOMMENDED FOR SYNCHRONIZED SHARC OPERATION!


           Figure 12.43: Clock Distribution Using End-of-Line Termination


                     ZO ≈ 10Ω                   > 4"

                            39Ω              ZO = 50Ω                   SHARC
                 *                                                       DSP


                     ZO ≈ 10Ω

  CLOCK                     39Ω              ZO = 50Ω                   SHARC
                 *                                                       DSP



 * Same              ZO ≈ 10Ω
 Package
                            39Ω              ZO = 50Ω                   SHARC
                 *                                                       DSP




                Figure 12.44: Preferred Method of Clock Distribution
                   Using Source Terminated Transmission Lines

                                                                                             12-47
  BASIC LINEAR DESIGN

          ADSP-2106x                                                    ADSP-2106x


                                                                         OFF




                                         LENGTH > 6"


                               33Ω           ZO = 50Ω      33Ω


                  ON


              ZO ≈ 17Ω




          LINK PORT                                                     LINK PORT
         TRANSMITTER                                                    RECEIVER


                  Figure 12.45: Source Termination for Biirectional
                       Transmission Between SHARC DSPs




                       SHARC             SHARC                  SHARC
                        DSP               DSP                    DSP
          +3.3V                                                                 +3.3V

          120Ω                                                                  120Ω
          30mW                    ZO = 50Ω       LENGTH > 10"           +1.4V   30mW


            91Ω                                                                  91Ω
           22mW                                                                 22mW


                       SHARC             SHARC                  SHARC
                        DSP               DSP                    DSP



                               NOTE: KEEP STUB LENGTH < 0.5"
              NOT RECOMMENDED FOR CLOCKS IN SYNCHRONIZED SHARC OPERATION!


        Figure 12.46: Single Transmission Line Terminated at Both Ends

Emitter-coupled-logic (ECL) has long been known for low noise and its ability to drive
terminated transmission lines with rise/fall times less than 2 ns. The family presents a
constant load to the power supply, and the low level differential outputs provide a high
degree of common-mode rejection. However, ECL dissipates lots of power.



12.48
                                                         PRINTED CIRCUIT BOARD ISSUES
                                                                             TRACES

Low Voltage Differential Signaling (LVDS)

Recently, low-voltage-differential-signaling (LVDS) logic has attained widespread
popularity because of similar characteristics, but with lower amplitudes and lower power
dissipation than ECL. The defining LVDS specification can be found in the References.
The LVDS logic swing is typically 350 mV peak-to-peak centered about a common-
mode voltage of +1.2 V. A typical driver and receiver configuration is shown in
Figure 12.47. The driver consists of a nominal 3.5 mA current source with polarity
switching provided by PMOS and NMOS transistors as in the case of the AD9430 12-bit,
170-MSPS/210-MSPS ADC. The output voltage of the driver is nominally 350 mV peak-
to-peak at each output, and can vary between 247 mV and 454 mV. The output current
can vary between 2.47 mA and 4.54 mA. The LVDS receiver is terminated in a 100 Ω
line-to-line. According to the LVDS specification, the receiver must respond to signals as
small as 100 mV, over a common-mode voltage range of 50 mV to +2.35 V. The wide
common-mode receiver voltage range is to accommodate ground voltage differences up
to ±1 V between the driver and receiver.



                AD9430 OUTPUT DRIVER                     V+           V–
                            +3.3V)

                                     (3.5mA)
                                                         V–           V+




                         +1.2V
                      3.5kΩ 3.5kΩ




                                    (3.5mA)



                      Figure 12.47: LVDS Driver and Receiver


The LVDS edge speed is defined as the 20% to 90% rise/fall time (as opposed to 10% to
90% for CMOS logic) and specified to be less than < 0.3 tui, where tui is the inverse of the
data signaling rate. For a 210 MSPS sampling rate, tui = 4.76 ns, and the 20% to 80%
rise/fall time must be less than 0.3 × 4.76 = 1.43 ns. For the AD9430, the rise/fall time is
nominally 0.5 ns.


                                                                                      12-49
  BASIC LINEAR DESIGN

LVDS outputs for high performance ADCs should be treated differently than standard
LVDS outputs used in digital logic. While standard LVDS can drive 1 meter to 10 meters
in high speed digital applications (dependent on data rate), it is not recommended to let a
high performance ADC drive that distance. It is recommended to keep the output trace
lengths short (< 2 in.), minimizing the opportunity for any noise coupling onto the
outputs from the adjacent circuitry, which may get back to the analog inputs. The
differential output traces should be routed close together, maximizing common-mode
rejection, with the 100 Ω termination resistor close to the receiver. Users should pay
attention to PCB trace lengths to minimize any delay skew. A typical differential
microstrip PCB trace cross section is shown in Figure 12.48 along with some
recommended layout guidelines.




                         Keep TW, TS, and D constant over the trace length
                         Keep TS ~ < 2TW
                         Avoid use of vias if possible
                         Keep D > 2TS
                         Avoid 90° bends if possible
                         Design TW and TG for ~ 50Ω

        Figure 12.48: Microstrip PCB Layout for Two Pairs of LVDS Signals


LVDS also offers some benefits in reduced EMI. The EMI fields generated by the
opposing LVDS currents tend to cancel each other (for matched edge rates). In high
speed ADCs, LVDS offers simpler timing constraints compared to demultiplexed CMOS
outputs at similar data rates. A demultiplexed data bus requires a synchronization signal
that is not required in LVDS. In demuxed CMOS buses, a clock equal to one-half the
ADC sample rate is needed, adding cost and complexity, that is not required in LVDS.




12.50
                                                                 PRINTED CIRCUIT BOARD ISSUES
                                                                                     TRACES

References:

PC BOARD DESIGN ISSUES
1.   W. Doeling, W. Mark, T. Tadewald, and P. Reichenbacher, "Getting Rid of Hook: The Hidden
     PC-Board Capacitance," Electronics, October 12, 1978, p 111-117.

2.   Alan Rich, "Shielding and Guarding," Analog Dialogue, Vol. 17 N0. 1, 1983, pp. 8.

3.   Ralph Morrison, Grounding and Shielding Techniques, 4th Edition, John Wiley, Inc., 1998,
     ISBN: 0471245186.

4.   Henry W. Ott, Noise Reduction Techniques in Electronic Systems, 2nd Edition, John Wiley, Inc.,
     1988, ISBN: 0-471-85068-3.

5.   Paul Brokaw, "An IC Amplifier User's Guide to Decoupling, Grounding and Making Things Go Right
     for a Change," Analog Devices AN202.

6.   Paul Brokaw, "Analog Signal-Handling for High Speed and Accuracy," Analog Devices AN342.

7.   Paul Brokaw and Jeff Barrow, "Grounding for Low- and High-Frequency Circuits," Analog Devices
     AN345.

8.   Jeff Barrow, "Avoiding Ground Problems in High Speed Circuits," RF Design, July 1989.

9.   B. I. & B. Bleaney, Electricity & Magnetism, Oxford at the Clarendon Press, 1957, pp 23, 24, & 52.

10. G. W. A. Dummer, H. Nordenberg, Fixed and Variable Capacitors, McGraw-Hill, 1960, pp 11-13.

11. William C. Rempfer, Get All the Fast ADC Bits You Pay For, Electronic Design, Special Analog
    Issue, June 24, 1996, p.44.

12. Mark Sauerwald, Keeping Analog Signals Pure in a Hostile Digital World, Electronic Design, Special
    Analog Issue, June 24, 1996, p.57.

13. Jerald Grame and Bonnie Baker, Design Equations Help Optimize Supply Bypassing for Op Amps,
    Electronic Design, Special Analog Issue, June 24, 1996, p.9.

14. Jerald Grame and Bonnie Baker, Fast Op Amps Demand More Than a Single-Capacitor Bypass,
    Electronic Design, Special Analog Issue, November 18, 1996, p.9.

15. Walt Kester and James Bryant, Grounding in High Speed Systems, High Speed Design Techniques,
    Analog Devices, 1996, Chapter 7, p. 7-27.

16. Jeffrey S. Pattavina, Bypassing PC Boards: Thumb Your Nose at Rules of Thumb, EDN, Oct. 22, 1998,
    p.149.

17. Howard W. Johnson and Martin Graham, High-Speed Digital Design, PTR Prentice Hall, 1993,
    ISBN: 0133957241.

18. Walt Kester, A Grounding Philosophy for Mixed-Signal Systems, Electronic Design Analog
    Applications Issue, June 23, 1997, p. 29.

19. Ralph Morrison, Solving Interference Problems in Electronics, John Wiley, 1995.

20. C. D. Motchenbacher and J. A. Connelly, Low Noise Electronic System Design, John Wiley, 1993.

                                                                                                 12-51
   BASIC LINEAR DESIGN


21. Crystal Oscillators: MF Electronics, 10 Commerce Drive, New Rochelle, NY, 10801, 914-576-6570.

22. Crystal Oscillators: Wenzel Associates, Inc., 2215 Kramer Lane, Austin, Texas USA 78758,
    512-835-2038, http://www.wenzel.com.

23. Mark Montrose, EMC and the Printed Circuit Board, IEEE Press, 1999 (IEEE Order Number
    PC5756).




12.52
                                                        PRINTED CIRCUIT BOARD ISSUES
                                                                         GROUNDING


SECTION 3: GROUNDING
In this section we discuss grounding. This is undoubtedly one of the most difficult
subjects in system design. While the basic concepts are relatively simple, implementation
is very involved.

For linear systems the ground is the reference against which we base our signal.
Unfortunately, it has also become the return path for the power supply current in unipolar
supply systems. Improper application of grounding strategies can destroy high accuracy
linear system performance.

Grounding is an issue for all analog designs, and it can be said that implementing a PCB
based circuit doesn’t change the fact that proper implementation is essential. Fortunately,
certain principles of quality grounding, namely the use of ground planes, are intrinsic to
the PCB environment. This factor is one of the more significant advantages to PCB based
analog designs, and appreciable discussion of this section is focused on this issue.

Some other aspects of grounding that must be managed include the control of spurious
ground and signal return voltages that can degrade performance. These voltages can be
due to external signal coupling, common currents, or simply excessive IR drops in
ground conductors. Proper conductor routing and sizing, as well as differential signal
handling and ground isolation techniques enable control of such parasitic voltages.

One final area of grounding to be discussed is grounding appropriate for a mixed-signal,
analog/digital environment. Indeed, the single issue of quality grounding can influence
the entire layout philosophy of a high performance mixed signal PCB design—as it well
should.

Today's signal processing systems generally require mixed-signal devices such as analog-
to-digital converters (ADCs) and digital-to-analog converters (DACs) as well as fast
digital signal processors (DSPs). Requirements for processing analog signals having wide
dynamic ranges increase the importance of high performance ADCs and DACs.
Maintaining wide dynamic range with low noise in hostile digital environments is
dependent upon using good high speed circuit design techniques, including proper signal
routing, decoupling, and grounding.

In the past, “high precision, low speed" circuits have generally been viewed differently
than so-called "high speed" circuits. With respect to ADCs and DACs, the sampling (or
update) frequency has generally been used as the distinguishing speed criteria. However,
the following two examples show that in practice, most of today's signal processing ICs
are really "high speed," and must therefore be treated as such in order to maintain high
performance. This is certainly true of DSPs, and also true of ADCs and DACs.

All sampling ADCs (ADCs with an internal sample-and-hold circuit) suitable for signal
processing applications operate with relatively high speed clocks with fast rise and fall
times (generally a few nanoseconds) and must be treated as high speed devices, even
though throughput rates may appear low. For example, a medium speed 12-bit successive
                                                                                   12-53
  BASIC LINEAR DESIGN

approximation (SAR) ADC may operate on 10-MHz internal clock, while the sampling
rate is only 500 kSPS.

Sigma-delta (Σ-Δ) ADCs also require high speed clocks because of their high
oversampling ratios. Even high resolution, so-called "low frequency" Σ-Δ industrial
measurement ADCs (having throughputs of 10 Hz to 7.5 kHz) operate on 5-MHz or
higher clocks and offer resolution to 24-bits (for example, the Analog Devices AD77xx-
series).

To further complicate the issue, mixed-signal ICs have both analog and digital ports, and
because of this, much confusion has resulted with respect to proper grounding techniques.
In addition, some mixed-signal ICs have relatively low digital currents, while others have
high digital currents. In many cases, these two types must be treated differently with
respect to optimum grounding.

Digital and analog design engineers tend to view mixed-signal devices from different
perspectives, and the purpose of this section is to develop a general grounding philosophy
that will work for most mixed signal devices, without having to know the specific details
of their internal circuits.

From the previous discussion it should be clear that the issue of grounding can not be
handled in a “cookbook” approach. Unfortunately we can not give a list of things to do
that will guarantee success. We can say that there are certain things that if they aren’t
done will probably lead do difficulties. And, what works in one frequency range may not
necessarily work in another frequency range. And, often, there are competing
requirements. The best way to handle grounding is to understand how the currents flow.


Star Ground
The "star" ground philosophy builds on the theory that there is one single ground point in
a circuit to which all voltages are referred. This is known as the star ground point. It can
be better understood by a visual analogy—the multiple conductors extending radially
from the common schematic ground resemble a star. Note that the star point need not
look like a star—it may be a point on a ground plane—but the key feature of the star
ground system is that all voltages are measured with respect to a particular point in the
ground network, not just to an undefined "ground" (i.e., wherever one can clip a probe).

This star grounding philosophy is reasonable theoretically, but is difficult to implement
practically. For example, if we design a star ground system, drawing out all signal paths
to minimize signal interaction and the effects of high impedance signal or ground paths,
we often find implementation problems. When the power supplies are added to the circuit
diagram, they either add unwanted ground paths, or their supply currents flowing in the
existing ground paths are sufficiently so large, or noisy (or both) so as to corrupt the
signal transmission. This particular problem can often be avoided by having separate
power supplies (and thus separate ground returns) for the various circuit portions. For
example, separate analog and digital supplies with separate analog and digital grounds,
joined at the star point, are common in mixed signal applications.
12.54
                                                         PRINTED CIRCUIT BOARD ISSUES
                                                                          GROUNDING

Separate Analog and Digital Grounds
As a fact of life, digital circuitry is noisy. Saturating logic, such as TTL and CMOS,
draws large, fast current spikes from its supply during switching. However, logic stages,
with hundreds of millivolts (or more) of noise immunity, usually have little need for high
levels of supply decoupling.

On the other hand, analog circuitry is quite vulnerable to noise on both power supply rails
and grounds. So, it is very sensible to separate analog and digital circuitry, to prevent
digital noise from corrupting analog performance. Such separation involves separation of
both ground returns and power rails, which is inconvenient in a mixed signal system.

Nevertheless, if a mixed signal system is to deliver full performance capability, it is often
essential to have separate analog and digital grounds, and separate power supplies. The
fact that some analog circuitry will "operate" (i.e., function) from a single +5 V supply
does not mean that it may optimally be operated from the same noisy +5 V supply as the
microprocessor and dynamic RAM, the electric fan, and other high current devices! What
is required is that the analog portion operate with full performance from such a low
voltage supply, not just be functional. This distinction will by necessity require quite
careful attention to both the supply rails and the ground interfacing.

Note that analog and digital ground in a system must be joined at some point (the star
ground concept), to allow signals to be referred to a common potential. This star point, or
analog/digital common point, is chosen so that it does not introduce digital currents into
the ground of the analog part of the system—it is often convenient to make the
connection at the power supplies.

Note also that many ADCs and DACs have separate analog ground (AGND) and digital
ground (DGND) pins. On the device data sheets, users are often advised to connect these
pins together at the package. This seems to conflict with the advice to connect analog and
digital ground at the power supplies, and, in systems with more than one converter, with
the advice to join the analog and digital ground at a single point.

There is, in fact, no conflict. The labels "analog ground" and "digital ground" on these
pins refer to the internal parts of the converter to which the pins are connected, and not to
the system grounds to which they must go. For example, with an ADC, generally these
two pins should be joined together and to the analog ground of the system. It is not
possible to join the two pins within the IC package, because the analog part of the
converter cannot tolerate the voltage drop resulting from the digital current flowing in the
bond wire to the chip. But they can be so tied, externally.

Figure 12.49 illustrates this concept of ground connections for an ADC. If these pins are
connected in this way, the digital noise immunity of the converter is diminished
somewhat, by the amount of common-mode noise between the digital and analog system
grounds. However, since digital noise immunity is of the order of hundreds or thousands
of millivolts, this factor is unlikely to be important.


                                                                                      12-55
  BASIC LINEAR DESIGN

The analog noise immunity is diminished only by the external digital currents of the
converter itself flowing in the analog ground. These currents should be kept quite small,
and this can be minimized by ensuring that the converter outputs don’t see heavy loads. A
good solution towards this is to use a low input current buffer at the ADC output, such as
a CMOS buffer-register IC.

                                                                                 R
                                                                                       +VS




DIGITAL OUTPUTS                                        INTERNAL
                                     CONVERTER
                                                       DIGITAL
                                                       CURRENT
                                  AGND        DGND
            EXTERNAL DIGITAL
            CURRENT RETURNS
            THROUGH LOW
            IMPEDANCE AGND
                                             SYSTEM
                                             ANALOG
                                             GROUND




   Figure 12.49: Analog (AGND) and Digital Ground (DGND) Pins of a Data
           Converter Should Be Returned to System Analog Ground


If the logic supply to the converter is isolated with a small resistance and decoupled to
analog ground with a local 0.1 µF capacitor, all the fast-edge digital currents of the
converter will return to ground through the capacitor, and will not appear in the external
ground circuit. If the analog ground impedance is maintained low, as it should be for
adequate analog performance, additional noise due to the external digital ground current
should rarely present a problem.


Ground Planes
Related to the star ground system discussed earlier is the use of a ground plane. To
implement a ground plane, one side of a double-sided PCB (or one layer of a multilayer
one) is made of continuous copper and used as ground. The theory behind this is that the
large amount of metal will have as low a resistance as is possible. It will, because of the
large flattened conductor pattern, also have as low an inductance as possible. It then
offers the best possible conduction, in terms of minimizing spurious ground difference
voltages across the conducting plane.

Note that ground plane concept can also be extended to include voltage planes. A voltage
plane offers advantages similar to a ground plane, i.e., a very low impedance conductor,
12.56
                                                        PRINTED CIRCUIT BOARD ISSUES
                                                                         GROUNDING
but is dedicated to a one (or more) of the system supply voltages. Thus a system can have
more than one voltage plane, as well as a ground plane.

While ground planes solve many ground impedance problems, it should still be
understood they aren’t a panacea. Even a continuous sheet of copper foil has residual
resistance and inductance, and in some circumstances, these can be enough to prevent
proper circuit function. Designers should be wary of injecting very high currents in a
ground plane, as they can produce voltage drops that interfere with sensitive circuitry.

The importance of maintaining a low impedance large area ground plane is critical to all
analog circuits today. The ground plane not only acts as a low impedance return path for
decoupling high frequency currents (caused by fast digital logic) but also minimizes
EMI/RFI emissions. Because of the shielding action of the ground plane, the circuit’s
susceptibility to external EMI/RFI is also reduced.

Ground planes also allow the transmission of high speed digital or analog signals using
transmission line techniques (microstrip or stripline) where controlled impedances are
required.

The use of "buss wire" is totally unacceptable as a ground because of its impedance at the
equivalent frequency of most logic transitions. For instance, #22 gauge wire has about
20 nH/inch inductance. A transient current having a slew rate of 10 mA/ns created by a
logic signal would develop an unwanted voltage drop of 200 mV at this frequency
flowing through 1 inch of this wire:

                                 Δi          10 mA
                        Δv = L      = 20 nH * ns = 200 mV                       Eq. 12-12
                                 Δt


For a signal having a 2 V peak-to-peak range, this translates into an error of about
200 mV, or 10% (approximate 3.5-bit accuracy). Even in all-digital circuits, this error
would result in considerable degradation of logic noise margins.

Figure 12.50 shows an illustration of a situation where the digital return current
modulates the analog return current (top figure). The ground return wire inductance and
resistance is shared between the analog and digital circuits, and this is what causes the
interaction and resulting error. A possible solution is to make the digital return current
path flow directly to the GND REF as shown in the bottom figure. This is the
fundamental concept of a "star," or single-point ground system. Implementing the true
single-point ground in a system which contains multiple high frequency return paths is
difficult because the physical length of the individual return current wires will introduce
parasitic resistance and inductance which can make obtaining a low impedance high
frequency ground difficult. In practice, the current returns must consist of large area
ground planes for low impedance to high frequency currents. Without a low impedance
ground plane, it is therefore almost impossible to avoid these shared impedances,
especially at high frequencies.


                                                                                     12-57
  BASIC LINEAR DESIGN

                                         ID

                                         IA
                                                                         INCORRECT
               +         +
          VD        VA                              ANALOG          DIGITAL
                              VIN                   CIRCUITS        CIRCUITS


                   GND              I A + ID                   ID
                   REF
                                              ID

                                               IA                          CORRECT
               +         +
         VD         VA                              ANALOG          DIGITAL
                              VIN                   CIRCUITS        CIRCUITS


                   GND                               IA
                   REF
                                                          ID



   Figure 12.50: Digital Currents Flowing in Analog Return Path Create Error
                                    Voltages


All integrated circuit ground pins should be soldered directly to the low impedance
ground plane to minimize series inductance and resistance. The use of traditional IC
sockets is not recommended with high speed devices. The extra inductance and
capacitance of even "low profile" sockets may corrupt the device performance by
introducing unwanted shared paths. If sockets must be used with DIP packages, as in
prototyping, individual "pin sockets" or "cage jacks" may be acceptable. Both capped and
uncapped versions of these pin sockets are available (AMP part numbers 5-330808-3, and
5-330808-6). They have spring-loaded gold contacts which make good electrical and
mechanical connection to the IC pins. Multiple insertions, however, may degrade their
performance.

Power supply pins should be decoupled directly to the ground plane using low inductance
ceramic surface mount capacitors. If through hole mounted ceramic capacitors must be
used, their leads should be less than 1 mm. The ceramic capacitors should be located as
close as possible to the IC power pins. Ferrite beads may also be required for additional
decoupling.

So, the more ground the better—right? Ground planes solve many ground impedance
problems, but not all. Even a continuous sheet of copper foil has residual resistance and
inductance, and in some circumstances, they can be enough to prevent proper circuit
function. Figure 12.51 shows such a problem—and a possible solution.


12.58
                                                       PRINTED CIRCUIT BOARD ISSUES
                                                                        GROUNDING




    Figure 12.51: A Slit in the Ground Plane Can Reconfigure Current Flow
                               for Better Accuracy


Consider the application in Fig. 12.51. Due to the realities of the mechanical design, the
connector, which has power input is on one side and the power output section, which
needs to be near the heat sinking, which, in turn, needs to be on the other side of the
board. The board has a ground-plane 100 mm wide and a power amplifier draws 15 A. If
the ground plane is 0.038 mm thick and 15 A flows in it, there will be a voltage drop of
68 µV/mm. This voltage drop would cause quite serious problems to any ground-
referenced precision circuitry sharing the PCB. We can slit the ground plane so that high
current does not flow in the region of the precision circuitry, instead forcing it to flow
around the slit. This can possibly solve the problem (which in this case it did)—even
though the voltage gradient will increase in those parts of the ground plane where the
current does flow.




                                                                                    12-59
  BASIC LINEAR DESIGN

Grounding and Decoupling Mixed-Signal ICs with Low Digital
Currents
Sensitive analog components such as amplifiers and voltage references are always
referenced and decoupled to the analog ground plane. The ADCs and DACs (and other
mixed-signal ICs) with low digital currents should generally be treated as analog
components and also grounded and decoupled to the analog ground plane. At first
glance, this may seem somewhat contradictory, since a converter has an analog and
digital interface and usually has pins designated as analog ground (AGND) and digital
ground (DGND). The diagram shown in Figure 12.52 will help to explain this seeming
dilemma.

                          VA                                       VD
                           FERRITE BEAD
        A                                                                       D
                           VA              VD

                   LP                      LP
                                                           SEE
                                                           TEXT
                   RP           CSTRAY     RP

                                                                                DATA
                                                       R           BUFFER       BUS
                   ANALOG            DIGITAL
                                                                  GATE OR
            AIN/   CIRCUITS          CIRCUITS DATA
                                                                  REGISTER
            OUT
                    A                      B
                                                                  CIN ≈ 10pF
                    RP          CSTRAY     RP

                                IA   ID
                    LP                     LP

                           AGND           DGND
                               SHORT
                    A
                            CONNECTIONS
                                           A         VNOISE              D
                         A = ANALOG GROUND PLANE     D = DIGITAL GROUND PLANE


                   Figure 12.52: Proper Grounding of Mixed-signal ICs
                            with Low Internal Digital Currents


Inside an IC that has both analog and digital circuits, such as an ADC or a DAC, the
grounds are usually kept separate to avoid coupling digital signals into the analog
circuits. Figure 12.52 shows a simple model of a converter. There is nothing the IC
designer can do about the wirebond inductance and resistance associated with connecting
the bond pads on the chip to the package pins except to realize it's there. The rapidly
changing digital currents produce a voltage at point B which will inevitably couple into
point A of the analog circuits through the stray capacitance, CSTRAY. In addition, there
is approximately 0.2 pF unavoidable stray capacitance between every pin of the IC
package! It's the IC designer's job to make the chip work in spite of this. However, in
order to prevent further coupling, the AGND and DGND pins should be joined together
12.60
                                                        PRINTED CIRCUIT BOARD ISSUES
                                                                         GROUNDING
externally to the analog ground plane with minimum lead lengths. Any extra impedance
in the DGND connection will cause more digital noise to be developed at point B; it will,
in turn, couple more digital noise into the analog circuit through the stray capacitance.
Note that connecting DGND to the digital ground plane applies VNOISE across the
AGND and DGND pins and invites disaster!

The name "DGND" on an IC tells us that this pin connects to the digital ground of the IC.
This does not imply that this pin must be connected to the digital ground of the system. It
could correctly be referred to as “Digital Return.”

It is true that this arrangement may inject a small amount of digital noise onto the analog
ground plane. These currents should be quite small, and can be minimized by ensuring
that the converter output does not drive a large fanout (they normally can't, by design).
Minimizing the fanout (which, in turn, means lower currents) on the converter's digital
port will also keep the converter logic transitions relatively free from ringing and
minimize digital switching currents, and thereby reducing any potential coupling into the
analog port of the converter. The logic supply pin (VD) can be further isolated from the
analog supply by the insertion of a small lossy ferrite bead as shown in Figure 12.32. The
internal transient digital currents of the converter will flow in the small loop from VD
through the decoupling capacitor and to DGND (this path is shown with a heavy line on
the diagram). The transient digital currents will therefore not appear on the external
analog ground plane, but are confined to the loop. The VD pin decoupling capacitor
should be mounted as close to the converter as possible to minimize parasitic inductance.
These decoupling capacitors should be low inductance ceramic types, typically between
0.01 µF and 0.1 µF.

Again, not one grounding scheme will be appropriate for all applications. But by
understanding the options and planning ahead problems will be minimized.




                                                                                     12-61
     BASIC LINEAR DESIGN

Treat the ADC Digital Outputs with Care
It is always a good idea (as shown in Figure 12.52) to place a buffer register adjacent to
the converter to isolate the converter's digital lines from noise on the data bus. The
register also serves to minimize loading on the digital outputs of the converter and acts as
a Faraday shield between the digital outputs and the data bus (See Figure 12.53). Even
though many converters have three-state outputs/inputs, these registers are on the die and
still allow the signals on the data pins to couple into sensitive areas. This isolation
register still represents good design practice. In some cases it may be desirable to add an
additional buffer register on the analog ground plane next to the converter output to
provide greater isolation.

                                             ADC
                                              IC




                      ANALOG
                       INPUT
                      PORT(S)
                                                                NOISY
                                                                DATA
                                                                 BUS




    Figure 12.53: A High Speed ADC IC Using a Buffer/Latch at the Output Shows
                    Enhanced Immunity to Digital Data Bus Noise


The series resistors (labeled "R" in Figure 12.53) between the ADC output and the buffer
register input help to minimize the digital transient currents which may affect converter
performance. The resistors isolate the digital output drivers from the capacitance of the
buffer register inputs. In addition, the RC network formed by the series resistor and the
buffer register input capacitance acts as a lowpass filter to slow down the fast edges.

A typical CMOS gate combined with PCB trace and a through hole will create a load of
approximately 10 pF. A logic output slew rate of 1 V/ns will produce 10 mA of dynamic
current if there is no isolation resistor:
                                  Δv           1V                                 Eq. 12-13
                        ΔII = C      = 10 pF *     = 10 mA
                                  Δt            ns

.



12.62
                                                                     PRINTED CIRCUIT BOARD ISSUES
                                                                                      GROUNDING
A 500 Ω series resistors will minimize this output current and result in a rise and fall time
of approximately 11 ns when driving the 10 pF input capacitance of the register:

                         tr = 22*t = 22*R*C = 22* 500 Ω * 10 pF = 11 ns.                    Eq. 12-14

TTL registers should be avoided, since they can appreciably add to the dynamic
switching currents because of their higher input capacitance.


                    VA         V A FERRITE
                                     BEAD                                      VD
                                                                   SEE
                                                                   TEXT
          A              A     VA            VD                                        D

                                                               R
                                     ADC                                   BUFFER
                  AMP                                                       GATE
                                     OR
                                     DAC                                     OR
                                                                                     TO OTHER
                                                               R          REGISTER
                                                                                      DIGITAL
                                                                                     CIRCU ITS
      A           VA          AGND          DGND


     A                               A                A                        D


           VOLTAGE             SAMPLING
                                                                               ANALOG
          REFERENCE             CLOCK                     VA         A       GROUND PLANE
                              GENERATOR
                                                                                DIGITAL
              A                  A                A                  D       GROUND PLANE




                    Figure 12.54: Grounding and Decoupling Points


The buffer register and other digital circuits should be grounded and decoupled to the
digital ground plane of the PC board. Notice that any noise between the analog and
digital ground plane reduces the noise margin at the converter digital interface. Since
digital noise immunity is of the orders of hundreds or thousands of millivolts, this is
unlikely to matter. The analog ground plane will generally not be very noisy, but if the
noise on the digital ground plane (relative to the analog ground plane) exceeds a few
hundred millivolts, then steps should be taken to reduce the digital ground plane
impedance, thereby maintaining the digital noise margins at an acceptable level. Under
no circumstances should the voltage between the two ground planes exceed 300 mV, or
the ICs may be damaged.

Separate power supplies for analog and digital circuits are also highly desirable. The
analog supply should be used to power the converter. If the converter has a pin
designated as a digital supply pin (VD), it should either be powered from a separate
analog supply, or filtered as shown in the diagram. All converter power pins should be
decoupled to the analog ground plane, and all logic circuit power pins should be
                                                                                 12-63
  BASIC LINEAR DESIGN

decoupled to the digital ground plane as shown in Figure 12.54. If the digital power
supply is relatively quiet, it may be possible to use it to supply analog circuits as well, but
be very cautious.

In some cases it may not be possible to connect VD to the analog supply. Some of the
newer, high speed ICs may have their analog circuits powered by +5 V, but the digital
interface powered by +3 V to interface to 3 V logic. In this case, the +3 V pin of the IC
should be decoupled directly to the analog ground plane. It is also advisable to connect a
ferrite bead in series with the power trace that connects the pin to the +3 V digital logic
supply.

The sampling clock generation circuitry should be treated like analog circuitry and also
be grounded and heavily decoupled to the analog ground plane. Phase noise on the
sampling clock produces degradation in system SNR as will be discussed shortly.



Sampling Clock Considerations
In a high performance sampled data system a low phase noise crystal oscillator should be
used to generate the ADC (or DAC) sampling clock because sampling clock jitter
modulates the analog input/output signal and raises the noise and distortion floor. The
sampling clock generator should be isolated from noisy digital circuits and grounded and
decoupled to the analog ground plane, as is true for the op amp and the ADC.

The effect of sampling clock jitter on ADC Signal-to-Noise Ratio (SNR) is given
approximately by the equation:

                                            ⎡ 1 ⎤
                             SNR = 20 log10 ⎢          ⎥,                           Eq. 12-15
                                            ⎢⎣ 2πft j ⎥⎦

where SNR is the SNR of a perfect ADC of infinite resolution where the only source of
noise is that caused by the rms sampling clock jitter, tj. Note that f in the above equation
is the analog input frequency. Just working through a simple example, if tj = 50 ps rms,
f = 100 kHz, then SNR = 90 dB, equivalent to about 15-bits dynamic range.

It should be noted that tj in the above example is the root-sum-square (rss) value of the
external clock jitter and the internal ADC clock jitter (called aperture jitter). However, in
most high performance ADCs, the internal aperture jitter is negligible compared to the
jitter on the sampling clock.

Since degradation in SNR is primarily due to external clock jitter, steps must be taken to
ensure the sampling clock is as noise free as possible and has the lowest possible phase
jitter. This requires that a crystal oscillator be used. There are several manufacturers of
small crystal oscillators with low jitter (less than 5 ps rms) CMOS-compatible outputs.
(For example, MF Electronics, 10 Commerce Dr., New Rochelle, NY 10801,
12.64
                                                            PRINTED CIRCUIT BOARD ISSUES
                                                                             GROUNDING
Tel. 914-576-6570 and Wenzel Associates, Inc., 2215 Kramer Lane, Austin, Texas 78758
Tel. 512-835-2038).

Ideally, the sampling clock crystal oscillator should be referenced to the analog ground
plane in a split-ground system. However, this is not always possible because of system
constraints. In many cases, the sampling clock must be derived from a higher frequency
multipurpose system clock which is generated on the digital ground plane. It must then
pass from its origin on the digital ground plane to the ADC on the analog ground plane.
Ground noise between the two planes adds directly to the clock signal and will produce
excess jitter. The jitter can cause degradation in the signal-to-noise ratio and also produce
unwanted harmonics.

This can be remedied somewhat by transmitting the sampling clock signal as a
differential signal using either a small RF transformer as shown in Figure 12.55 or a high
speed differential driver and receiver IC. If an active differential driver and receiver are
used, they should be ECL to minimize phase jitter. In a single +5 V supply system, ECL
logic can be connected between ground and +5 V (PECL), and the outputs ac coupled
into the ADC sampling clock input. In either case, the original master system clock must
be generated from a low phase noise crystal oscillator.


                                    DIGITAL GROUND PLANE        ANALOG GROUND PLANE
           VD                        VD
                                                                            SAMPLING
                                                                             CLOCK
    LOW PHASE
                            SYSTEM CLOCK
      NOISE
                             GENERATORS
   MASTER CLOCK                                                                METHOD 1


            D          VD       D
                                                        D                  A
                                                       VD              VA
                                                                               SAMPLING
         DSP OR MICROPROCESSOR                                     +            CLOCK
                                                                   _
                                                                               METHOD 2

                        D                              D               A
                                        1       tj = Sampling Clock Jitter
                    SNR = 20 log10
                                      2π f tj   f = Analog Input Frequency



                   Figure 12.55: Sampling Clock Distribution from
                          Digital to Analog Ground Planes




                                                                                          12-65
  BASIC LINEAR DESIGN

The Origins of the Confusion About Mixed-Signal Grounding
Most ADC, DAC, and other mixed-signal device data sheets discuss grounding relative to
a single PCB, usually the manufacturer's own evaluation board. This has been a source of
confusion when trying to apply these principles to multicard or multi-ADC/DAC
systems. The recommendation is usually to split the PCB ground plane into an analog
plane and a digital plane. It is then further recommended that the AGND and DGND pins
of a converter be tied together and that the analog ground plane and digital ground planes
be connected at that same point as shown in Figure 12.56. This essentially creates the
system "star" ground at the mixed-signal device.

All noisy digital currents flow through the digital power supply to the digital ground
plane and back to the digital supply; they are isolated from the sensitive analog portion of
the board. The system star ground occurs where the analog and digital ground planes are
joined together at the mixed signal device. While this approach will generally work in a
simple system with a single PCB and single ADC/DAC, it is not optimum for multicard
mixed-signal systems. In systems having several ADCs or DACs on different PCBs (or
on the same PCB, for that matter), the analog and digital ground planes become
connected at several points, creating the possibility of ground loops and making a single-
point "star" ground system impossible. For these reasons, this grounding approach is not
recommended for multicard systems, and the approach previously discussed should be
used for mixed-signal ICs with low digital currents.


                                        VA                          VD



                                                 VA        VD
                                                  MIXED
                        ANALOG                    SIGNAL                  DIGITAL
                        CIRCU ITS                 DEVICE                 CIRCU ITS

 SYS TEM                                     AGND     DGND
  STAR
 GROUND
                                A            A                  D        D

                          ANALOG                                   DIGITAL
                       GROUND PLANE                             GROUND PLANE



                                    A                      D


                       ANALOG                                                DIGITAL
                       SUPPLY                                                SUPPLY



           Figure 12.56: Grounding Mixed-Signal ICs: Single PC Board
                         (Typical Evaluation/Test Board)




12.66
                                                             PRINTED CIRCUIT BOARD ISSUES
                                                                              GROUNDING

Summary: Grounding Mixed-Signal Devices with Low Digital Currents
in a Multicard System
Figure 12.57 summarizes the approach previously described for grounding a mixed signal
device which has low digital currents. The analog ground plane is not corrupted because
the small digital transient currents flow in the small loop between VD, the decoupling
capacitor, and DGND (shown as a heavy line). The mixed signal device is for all intents
and purposes treated as an analog component. The noise VN between the ground planes
reduces the noise margin at the digital interface but is generally not harmful if kept less
than 300 mV by using a low impedance digital ground plane all the way back to the
system star ground.

                                                 VN      V N = NOISE BETWEEN
                                                               GROUND PLANES
                       VA                                VD
                                  FILTER


                            VA             VD
                                                 R                 BUS
                                 MIXED
           ANALOG                SIGNAL
                                                       BUFFER             DIGITAL
           CIRCU ITS             DEVICE                LATCH             CIRCU ITS
                            AGND       DGND



                   A   A               A                       D         D


                    ANALOG                                       DIGITAL
                 GROUND PLANE                                 GROUND PLANE


                       A           A                     D           D


  TO SYSTEM                                                                    TO SYSTEM
ANALOG SUPPLY                                                                DIGITAL SUPPLY
                                           TO SYSTEM STAR GROUND


               Figure 12.57: Grounding Mixed Signal ICs with Low
                   Internal Digital Currents: Multiple PC Boards


However, mixed-signal devices such as sigma-delta ADCs, codecs, and DSPs with on-
chip analog functions are becoming more and more digitally intensive. Along with the
additional digital circuitry come larger digital currents and noise. For example, a sigma-
delta ADC or DAC contains a complex digital filter which adds considerably to the
digital current in the device. The method previously discussed depends on the decoupling
capacitor between VD and DGND to keep the digital transient currents and isolated in a
small loop. However, if the digital currents are significant enough and have components
at dc or low frequencies, the decoupling capacitor may have to be so large that it is
impractical. Any digital current which flows outside the loop between VD and DGND

                                                                                         12-67
  BASIC LINEAR DESIGN

must flow through the analog ground plane. This may degrade performance, especially in
high resolution systems.

It is difficult to predict what level of digital current flowing into the analog ground plane
will become unacceptable in a system. All we can do at this point is to suggest an
alternative grounding method which may yield better performance.


Summary: Grounding Mixed-Signal Devices with High Digital Currents
in a Multicard System
An alternative grounding method for a mixed-signal device with high levels of digital
currents is shown in Figure 12.58. The AGND of the mixed signal device is connected to
the analog ground plane, and the DGND of the device is connected to the digital ground
plane. The digital currents are isolated from the analog ground plane, but the noise
between the two ground planes is applied directly between the AGND and DGND pins of
the device. For this method to be successful, the analog and digital circuits within the
mixed signal device must be well isolated. The noise between AGND and DGND pins
must not be large enough to reduce internal noise margins or cause corruption of the
internal analog circuits.

                                                                           V N = NOISE BETWEEN
                                                           VN
                                                                                 GROUND PLANES

                                     VA                                            VD



        BACK-TO-BACK                                  VA         VD
          SCHOTTKY                                     MIXED
                               ANALOG                                          DIGITAL
            DIODES                                     SIGNAL
                               CIRCU ITS                                      CIRCU ITS
              OR                                       DEVICE
           FERRITE                                AGND          DGND
             BEAD
          (SEE TEXT)
                                          A       A                    D      D


                              ANALOG                                          DIGITAL
                            GROUND PLANE                                   GROUND PLANE


                                 A            A                   D            D



                    TO SYSTEM                                                             TO SYSTEM
                  ANALOG SUPPLY                                                         DIGITAL SUPPLY
                                          TO SYSTEM STAR GROUND


              Figure 12.58: High Digital Currents: Multiple PC Boards


Figure 12.58 shows optional Schottky diodes (back-to-back) or a ferrite bead connecting
the analog and digital ground planes. The Schottky diodes prevent large dc voltages or
low frequency voltage spikes from developing across the two planes. These voltages can
12.68
                                                           PRINTED CIRCUIT BOARD ISSUES
                                                                            GROUNDING
potentially damage the mixed-signal IC if they exceed 300 mV because they appear
directly between the AGND and DGND pins. As an alternative to the back-to-back
Schottky diodes, a ferrite bead provides a dc connection between the two planes but
isolates them at frequencies above a few MHz where the ferrite bead becomes resistive.
This protects the IC from dc voltages between AGND and DGND, but the dc connection
provided by the ferrite bead can introduce unwanted dc ground loops and may not be
suitable for high resolution systems.


Grounding DSPs with Internal Phase-Locked Loops
As if dealing with mixed-signal ICs with AGND and DGNDs wasn’t enough, DSPs such
as the ADSP-21160 SHARC with internal phase-locked-loops (PLLs) raise issues with
respect to proper grounding. The ADSP-21160 PLL allows the internal core clock
(determines the instruction cycle time) to operate at a user selectable ratio of 2, 3, or 4
times the external clock frequency, CLKIN. The CLKIN rate is the rate at which the
synchronous external ports operate. Although this allows using a lower frequency
external clock, care must be taken with the power and ground connections to the internal
PLL as shown in Figure 12.59.



                                                                    +3.3V
                                              10Ω    +2.5V
                  SHORT TRACES
                                                         40             46

                                      AV DD         V DD INT   V DD EXT
                                       PLL
              0.1µF      0.01µF
                                      X1, X2,           DSP
                                      X3, X4        (ADSP-21160)
                                     CLKIN

                                       AGND               GND


                                                               83
                      SHORT TRACES




                                       DIGITAL GROUND PLANE



                      Figure 12.59: Grounding DSPs with Internal
                             Phase-Locked-Loops (PLLs)


In order to prevent internal coupling between digital currents and the PLL, the power and
ground connections to the PLL are brought out separately on pins labeled AVDD and
AGND, respectively. The AVDD +2.5 V supply should be derived from the VDD INT
+2.5 V supply using the filter network as shown. This ensures a relatively noise-free
                                                                                     12-69
  BASIC LINEAR DESIGN

supply for the internal PLL. The AGND pin of the PLL should be connected to the digital
ground plane of the PC board using a short trace. The decoupling capacitors should be
routed between the AVDD pin and AGND pin using short traces.


Grounding Summary
There is no single grounding method which will guarantee optimum performance 100%
of the time! This section has presented a number of possible options depending upon the
characteristics of the particular mixed signal devices in question. It is helpful, however to
provide for as many options as possible when laying out the initial PC board.

It is mandatory that at least one layer of the PC board be dedicated to ground plane. The
initial board layout should provide for nonoverlapping analog and digital ground planes,
but pads and vias should be provided at several locations for the installation of back-to-
back Schottky diodes or ferrite beads, if required. Pads and vias should also be provided
so that the analog and digital ground planes can be connected together with jumpers if
required.

The AGND pins of mixed-signal devices should in general always be connected to the
analog ground plane. An exception to this are DSPs which have internal phase-locked-
loops (PLLs), such as the ADSP-21160 SHARC. The ground pin for the PLL is labeled
AGND, but should be connected directly to the digital ground plane for the DSP.


Grounding for High-Frequency Operation

The “ground plane” layer is often advocated as the best return for power and signal
currents, while providing a reference node for converters, references, and other
subcircuits. However, even extensive use of a ground plane does not ensure a high quality
ground reference for an ac circuit.

The simple circuit of Figure 12.59, built on a two layer printed circuit board, has an ac
and dc current source on the top layer connected to a via (via 1) at one end and to a
single U-shaped copper trace connected to via 2. Both vias go through the circuit board
and connect to the ground plane. Ideally, the impedance is zero and the voltage appearing
across the current source is also zero.




12.70
                                                           PRINTED CIRCUIT BOARD ISSUES
                                                                            GROUNDING

                                                                 SOLID SHEET OF
                                                                 GROUND-PLANE ON BOTTOM
        VIA 2                                    VIA 1



                AC + DC




                     U SHAPED TOP CONDUCTOR




                                                                                SCHEMATIC


Figure 12.60: Schematic and Layout of Current Source with U-shaped Trace on
                PC Board and Return through Ground Plane.


This simple schematic hardly begins to show the actual subtleties. But an understanding
of how the current flows in the ground plane from via 1 to via 2 makes the realities
apparent and shows how ground noise in high frequency layouts can be avoided.


                                                                               GROUND-PLANE
                                                                               ON BACK
                 VIA 2                                            VIA 1



                          DC
                                                         IN
                                   DC CURRENT PATH       GND
                                                         PLANE

                                                 ON TOP TRACE




                               AREA OF LOOP FOR
                               CALCULATING INDUCTANCE


                    Figure 12.61: DC Current Flow for Figure 12.60


The dc current flows in the manner in Figure 12.61, as one might surmise, taking the path
of least resistance from via 1 to via 2. Some current spreading occurs, but little current
flows a substantial distance from this path. In contrast, the ac current does not take the
path of least resistance, it take the path of least impedance, which, in turn, depends on
inductance.



                                                                                          12-71
  BASIC LINEAR DESIGN


             I                                                                FLUX LINES
                                                 OPPOSING                      AROUND
                                                  OUTSIDE                      TOP WIRE
                                                   LOOP




                                          REINFORCING
                                             INSIDE
                                              LOOP

      FLUX
      LINES
     AROUND
     BOTTOM                            OPPOSING                                                     I
      WIRE                              OUTSIDE
                                         LOOP




   Figure 12.62: Magnetic Field Lines and Inductive Loop (Right Hand Rule)


Inductance is proportional to the area of the loop made by the current flow; the
relationship can be illustrated by the right hand rule and the magnetic field shown in
Figure 12.62 Inside the loop, current along all parts of the loop produces magnetic field
lines that add constructively. Away from the loop, however, field lines form different
parts add destructively, thus the field is confined principally within the loop. A larger
loop has greater inductance. This means that, for a given current level, it has more stored
magnetic energy (Li2), greater impedance (XL = jωL), and hence will develop more
voltage a given frequency.

                                                    GROUND-PLANE
                                                      ON BACK




             VIA 2                               VIA 1           VIA 2                           VIA 1



        AC                                                  AC               GROUND-PLANE
                                                                             CURRENT PATH
                     GROUND-PLANE CURRENT PATH
                       PATH IS UNDER TOP TRACE

                                                                         AREA OF INDUCTOR LOOP



                          TOP TRACE CURRENT PATH                           TOP TRACE CURRENT PATH



 Figure 12.63: AC Current Path Without (left) and with (right) Resistance in the
                               Ground Plane


Which path will the current choose in the ground plane? Naturally the lower impedance
path. Considering the loop formed by the U-shaped surface lead and the ground plane and
neglecting resistance, high frequency ac current will follow the path with the least
inductance, hence the least area.



12.72
                                                       PRINTED CIRCUIT BOARD ISSUES
                                                                        GROUNDING
In the example shown, the loop with the least area is quite evidently formed by the
U-shaped top trace and the portion of the ground plane directly underneath it. So while
Figure 12.61 shows the dc current path, Figure 12.63 shows the path that most of the ac
current takes in the ground plane, where it finds minimum area, directly under the
U-shaped top trace. In practice, the resistance in the ground plane causes the current to
flow at low- and mid-frequencies to somewhere between straight back and directly under
the top conductor. However, the return path is nearly under the top trace as low as 1 MHz
or 2 MHz.


Be Careful with Ground Plane Breaks

Wherever there is a break in the ground plane beneath a conductor, the ground plane
return current must by necessity flow around the break. As a result, both the inductance
and the vulnerability of the circuit to external fields are increased. This situation is
diagrammed in Figure 12.64, where conductors A and B must cross one another.

Where such a break is made to allow a crossover of two perpendicular conductors, it
would be far better if the second signal were carried across both the first and the ground
plane by means of a piece of wire. The ground plane then acts as a shield between the
two signal conductors, and the two ground return currents, flowing in opposite sides of
the ground plane as a result of skin effects, do not interact.


                                           SIGNAL CURR ENT B
        THIS VIEW FROM PCB
         CONDUC TOR (TRACK ) SIDE

        NOTE: RETURN CURR ENTS
         A & B MAY INTERACT
                                                      BREAK IN GROUND PLANE

                                                        CROSSOVER “B” ON
                                                        GROUND PLANE
                                                        SIDE
                                                                     SIGNAL
                                                                     CURR ENT A

           RETURN CURR ENT B
           DIVERTS AROUND                           RETURN CURR ENT A DIVERTS
           GROUND PLANE                             AROUND GROUND PLANE BREAK,
           BREAK, RAISING                           RAISING INDUC TANCE
           INDUC TANCE




         Figure 12.64: A Ground Plane Break Raises Circuit Inductance,
                  and Increases Vulnerability to External Fields


With a multilayer board, both the crossover and the continuous ground plane can be
accommodated without the need for a wire link. Multilayer PCBs are expensive and
                                                                                    12-73
  BASIC LINEAR DESIGN

harder to trouble-shoot than more simple double-sided boards, but do offer even better
shielding and signal routing. The principles involved remain unchanged but the range of
layout options is increased.

The use of double-sided or multilayer PCBs with at least one continuous ground plane is
undoubtedly one of the most successful design approaches for high performance mixed
signal circuitry. Often the impedance of such a ground plane is sufficiently low to permit
the use of a single ground plane for both analog and digital parts of the system. However,
whether or not this is possible does depend upon the resolution and bandwidth required,
and the amount of digital noise present in the system.




12.74
                                                                PRINTED CIRCUIT BOARD ISSUES
                                                                                 GROUNDING

References:
24. Alan Rich, “Shielding and Guarding,” Analog Dialogue, Vol. 17 N0. 1, 1983, pp. 8.

25. Ralph Morrison, Grounding and Shielding Techniques, 4th Edition, John Wiley, Inc., 1998,
    ISBN: 0471245186.


26. Henry W. Ott, Noise Reduction Techniques in Electronic Systems, 2nd Edition, John Wiley, Inc.,
    1988, ISBN: 0-471-85068-3.


27. Paul Brokaw, “An IC Amplifier User’s Guide to Decoupling, Grounding and Making Things Go Right
    for a Change,” Analog Devices AN202.


28. Paul Brokaw and Jeff Barrow, “Grounding for Low- and High-Frequency Circuits,” Analog Devices
    AN345.


29. Jeff Barrow, “Avoiding Ground Problems in High Speed Circuits,” RF Design, July 1989.


30. B. I. & B. Bleaney, Electricity & Magnetism, Oxford at the Clarendon Press, 1957, pp 23, 24, & 52.


31. William C. Rempfer, Get All the Fast ADC Bits You Pay For, Electronic Design, Special Analog
    Issue, June 24, 1996, p.44.


32. Mark Sauerwald, Keeping Analog Signals Pure in a Hostile Digital World, Electronic Design, Special
    Analog Issue, June 24, 1996, p.57.


33. Walt Kester and James Bryant, Grounding in High Speed Systems, High Speed Design Techniques,
    Analog Devices, 1996, Chapter 7, p. 7-27.


34. Howard W. Johnson and Martin Graham, High Speed Digital Design, PTR Prentice Hall, 1993,
    ISBN: 0133957241.


35. Walt Kester, A Grounding Philosophy for Mixed-Signal Systems, Electronic Design Analog
    Applications Issue, June 23, 1997, p. 29.


36. Ralph Morrison, Solving Interference Problems in Electronics, John Wiley, 1995.


37. C. D. Motchenbacher and J. A. Connelly, Low Noise Electronic System Design, John Wiley, 1993.



38. Mark Montrose, EMC and the Printed Circuit Board, IEEE Press, 1999 (IEEE Order Number
    PC5756).


                                                                                                 12-75
  BASIC LINEAR DESIGN



                        Notes:




12.76
                                                        PRINTED CIRCUIT BOARD ISSUES
                                                                         DECOUPLING

SECTION 4: DECOUPLING
It is imperative to properly decouple ALL ICs in a high speed and/or high precision
application. This decoupling should include a small (typically 0.01 µF to 0.1µF)
capacitor. This capacitor should have good high frequency characteristics. Surface mount
multilayer ceramics are ideal; the purpose of this capacitor is to shunt any high frequency
noise away for the IC. This is because the power supply rejection ratio drops with
frequency, as shown in Figure 12.65. While this plot is for an op amp, all linear circuits
and converters have the same general shape, rejection falling with increasing frequency.
Keeping the high frequency noise out of the IC helps keep it from getting to the output
(of a linear circuit) or affecting the noise (of a converter)




Figure 12.65: Power Supply Rejection Ratio (PSRR) of an AD8029


In addition to the high frequency cap there should be liberal use of larger electrolytic
capacitors (10 µF to 100 µF). These capacitors are not required at every chip. The
purpose of these capacitors is to provide a local reservoir of charge so that instantaneous
current demands can be provided from a local source, instead of having to come from a
power supply which may be relatively far away and subject to the inductance and
resistance of the PCB traces.


Local high frequency bypass/decoupling
As we have stated, each individual analog stage requires local, high frequency
decoupling. These stages are provided directly at the power pins, of all individual analog
stages. Figure 12.66 shows the preferred technique, in both correct (left) as well as
incorrect example implementations (right). In the left example, a typical 0.1 μF chip
ceramic capacitor goes directly to the opposite PCB side ground plane, by virtue of the
via, and on to the IC’s GND pin by a second via. In contrast, the less desirable
                                                                                     12-77
  BASIC LINEAR DESIGN

arrangement at the right adds additional PCB trace inductance in the ground path of the
decoupling cap, reducing effectiveness.


               CORRECT                             INCORRECT
                                   OPTIONAL
                                 FERRITE BEADS

             POWER            DECOUPLING     POWER          DECOUPLING
             SUPPLY           CAPACITOR      SUPPLY         CAPACITOR
             TRACE                           TRACE

                       V+                             V+
                                                                     PCB
                                                                    TRACE
                               VIAS TO
                      IC       GROUND              IC
                                PLANE                                VIA TO
                                                                    GROUND
                                                                     PLANE
                      GND                             GND



  Figure 12.66: Localized High Frequency Supply Filter(s) Provides Optimum
    Filtering and Decoupling via Short Low-Inductance Path (Ground Plane)

The general technique shown here as suitable for single-rail power supply, but the
concept obviously extends to dual rail systems. Note—if the decoupled IC in question is
an op amp, the GND pin shown is the −VS pin. For dual supply op amp uses, there is no
op amp GND pin per se, so the dual decoupling networks should go directly to the
ground plane when used, or other local ground.

All high frequency (i.e., ≥10 MHz) ICs should use a bypassing scheme similar to
Figure 12.66 for best performance. Trying to operate op amps and other high
performance ICs without local bypassing is almost always folly. It may be possible in a
few circumstances, if the circuitry is strictly micropower in nature, and the gain-
bandwidth in the kHz range. To put things into an overall perspective however, note that
a pair of 0.1 μF ceramic bypass caps cost less than 25 cents. Hardly a worthy saving
compared to the potential grief and lost time of troubleshooting a system without
bypassing!

In contrast, the ferrite beads aren’t 100% necessary, but they will add extra HF noise
isolation and decoupling, which is often desirable. Possible caveats here would be to
verify that the beads never saturate, when the op amps are handling high currents.

Note that with some ferrites, even before full saturation occurs, some beads can be
nonlinear, so if a power stage is required to operate with a low distortion output, this
should also be lab checked.

The effects of inadequate decoupling on harmonic distortion performance are
dramatically illustrated in Figure 12.67. The left photo shows the spectral output of the
AD9631 op amp driving a 100 Ω load with proper decoupling (output signal is 20 MHz,

12.78
                                                       PRINTED CIRCUIT BOARD ISSUES
                                                                        DECOUPLING
2 V p-p). Notice that the second harmonic distortion at 40 MHz is approximately
–70 dBc. If the decoupling is removed, the distortion is increased, as shown in the right
photo of the same figure. Figure 12.67A also shows stray RF pickup in the wiring
connecting the power supply to the op amp test fixture. Unlike lower frequency
amplifiers, the power supply rejection ratio of many high frequency amplifiers is
generally fairly poor at high frequencies. For example, at 20 MHz, the power supply
rejection ratio of the AD9631 is less than 25 dB. This is the primary reason for the
degradation in performance with inadequate decoupling. The change in output signal

              PROPER DECOUPLING                      NO DECOUPLING
                     A                                          B




            VERTICAL SCALES: 10dB/div, HORIZONTAL SCALES: 10MHz/div

     Figure 12.67: Effects of Inadequate Decoupling on Harmonic Distortion
                     Performance of the AD9611 Op Amp




    Figure 12.68: Effects of Inadequate Decoupling on the Phase Response
                            of the AD9631 Op Amp

                                                                                   12-79
  BASIC LINEAR DESIGN

produces a corresponding signal dependent load current change. The corresponding
change in power supply voltage due to inadequate decoupling produces a signal
dependent error in the output which manifests itself as an increase in distortion.

Inadequate decoupling can also severely affect the pulse response of high speed
amplifiers such as the AD9631. Figures 12.67 and 12.68 shows normal operation and the
effects of removing all decoupling capacitors on the AD9631 in its evaluation board.
Notice the severe ringing on the pulse response for the poorly decoupled condition.


Ringing
An inductor in series or parallel with a capacitor forms a resonant, or "tuned," circuit,
whose key feature is that it shows marked change in impedance over a small range of
frequency. Just how sharp the effect is depends on the relative Q of the tuned circuit. The
effect is widely used to define the frequency response of narrow-band circuitry, but can
also be a potential problem source.

If stray inductance and capacitance (which may or may not be stray) in a circuit should
form a tuned circuit, then that tuned circuit may be excited by signals in the circuit, and
ring at its resonant frequency.


                                               L1                        R1     L1
                                                     +VS                             +VS
                      IC                                     IC
                                               1µH                      10Ω    1µH
                                        C1                              C1
                                       0.1µF                           0.1µF




                   EQUIVALENT DECOUPLED POWER              SMALL SERIES RESISTANCE
                   LINE CIRCUIT RESONATES AT:              CLOSE TO IC REDUCES Q

                                   1
                           f =
                                 2π √ LC


        Figure 12.69: Resonant Circuit Formed by Power Line Decoupling


An example is shown in Figure 12.69, where the resonant circuit formed by an inductive
power line and its decoupling capacitor may possibly be excited by fast pulse currents
drawn by the powered IC.

While normal trace inductance and typical decoupling capacitances of 0.01 μF to 0.1 μF
will resonate well above a few MHz, an example 0.1 μF capacitor and 1 μH of
inductance resonates at 500 kHz. Left unchecked, this could present a resonance problem,
as shown in the left case. Should an undesired power line resonance be present, the effect
may be minimized by lowering the Q of the inductance. This is most easily done by
inserting a small resistance (~10 Ω) in the power line close to the IC, as shown in the
right case.
12.80
                                                             PRINTED CIRCUIT BOARD ISSUES
                                                                              DECOUPLING

References:
1.   Paul Brokaw, "An IC Amplifier User's Guide to Decoupling, Grounding and Making Things Go
     Right for a Change," Analog Devices AN202.

2.   Henry W. Ott, Noise Reduction Techniques in Electronic Systems, 2nd Edition, John Wiley,
     Inc., 1988, ISBN: 0-471-85068-3.

3.   Mark Sauerwald, “Keeping Analog Signals Pure in a Hostile Digital World,” Electronic Design,
     Special Analog Issue, June 24, 1996, p.57.

4.   Jerald Grame and Bonnie Baker, “Design Equations Help Optimize Supply Bypassing for Op
     Amps,” Electronic Design, Special Analog Issue, June 24, 1996, p.9.

5.   Jeffrey S. Pattavina, “Bypassing PC Boards: Thumb Your Nose at Rules of Thumb,” EDN,
     Oct. 22, 1998, p.149.

6.   C. D. Motchenbacher and J. A. Connelly, Low Noise Electronic System Design, John Wiley,
     1993.

7.   Walt Jung, Walt Kester, Bill Chesnut, "Power Supply Noise Reduction and Filtering," portion of
     Section 8 within Walt Kester, Editor, Practical Design Techniques for Power and Thermal
     Management, Analog Devices, Inc., 1998, ISBN 0-916550-19-2.




                                                                                              12-81
  BASIC LINEAR DESIGN


SECTION 5: THERMAL MANAGEMENT
For reliability reasons, systems with appreciable power dissipation are increasingly called
upon to observe thermal management. All semiconductors have some specified safe
upper limit for junction temperature (TJ), usually on the order of 150°C (sometimes
175°C). Like maximum power supply voltages, maximum junction temperature is a worst
case limitation which shouldn’t be exceeded. In conservative designs an ample safety
margin should be included. Note that this is critical, since semiconductor lifetime is
inversely related to operating junction temperature. Simply put, the cooler ICs are, the
longer their lifetimes will be.

This limitation of power and temperature is basic, and is illustrated by a typical data sheet
statement as in Figure 12.70. In this case it is for the AD8017AR, an 8-pin SOIC device.


        The maximum power that can be safely dissipated by the AD8017 is
        limited by the associated rise in junction temperature. The maximum
        safe junction temperature for plastic encapsulated device is
        determined by the glass transition temperature of the plastic,
        approximately +150°C. Temporarily exceeding this limit may cause a
        shift in parametric performance due to a change in the stresses
        exerted on the die by the package. Exceeding a junction temperature
        of +175°C for an extended period can result in device failure.

    Figure 12.70: Maximum Power Dissipation Data Sheet Statement for the
        AD8017AR, an ADI Thermally Enhanced SOIC Packaged Device


Tied to these statements are certain conditions of operation, such as the power dissipated
by the device, and the package mounting to the printed circuit board (PCB). In the case of
the AD8017AR, the part is rated for 1.3 W of power at an ambient of 25°C. This assumes
operation of the 8-lead SOIC package on a two-layer PCB with about
4 in2 (~2500 mm2) of 2 oz. copper for heat sinking purposes. Predicting safe operation for
the device under other conditions is covered below.



Thermal Basics

The symbol θ is generally used to denote thermal resistance. Thermal resistance is in
units of °C/watt (°C/W). Unless otherwise specified, it defines the resistance heat
encounters transferring from a hot IC junction to the ambient air. It might also be
expressed more specifically as θJA, for thermal resistance, junction-to-ambient. θJC and
θCA are two additional θ forms used, and are further explained below.

In general, a device with a thermal resistance θ equal to 100°C/W will exhibit a
temperature differential of 100°C for a power dissipation of 1 W, as measured between
12.82
                                                          PRINTED CIRCUIT BOARD ISSUES
                                                                THERMAL MANAGEMENT
two reference points. Note that this is a linear relationship, so 1 W of dissipation in this
part will produce a 100°C differential (and so on, for other powers). For the AD8017AR
example, θ is about 95°C/W, so 1.3 W of dissipation produces about a 124°C junction-to-
ambient temperature differential. It is of course this rise in temperature that is used to
predict the internal temperature, in order to judge the thermal reliability of a design. With
the ambient at 25°C, this allows an internal junction temperature of about 150°C. In
practice most ambient temperatures are above 25°C, so less power can then be handled.

For any power dissipation P (in watts), one can calculate the effective temperature
differential (ΔT) in °C as:

                                            ΔT = P × θ                              Eq. 12-16

where θ is the total applicable thermal resistance.

Figure 12.71 summarizes a number of basic thermal relationships.


        θ = Thermal Resistance (°C/W)
                                                                       TA    AMBIENT
        P = Total Device Power Dissipation (W)
        T = Temperature (°C)
                                                                             θCA
        ΔT = Temperature Differential = P × θ
        θJA = Junction-Ambient Thermal Resistance                     TC    CASE
        θJC = Junction-Case Thermal Resistance
        θCA = Case-Ambient Thermal Resistance
                                                                              θJC
        θJA = θJC + θCA
        TJ = TA + (P × θJA)                                           TJ   JUNCTION

        Note: TJ(Max) = 150°C (Sometimes 175°C)

                     Figure 12.71: Basic Thermal Relationships


Note that series thermal resistances, such as the two shown at the right, model the total
thermal resistance path a device may see. Therefore the total θ for calculation purposes is
the sum, i.e., θJA = θJC and θCA. Given the ambient temperature TA, P, and θ, then TJ can
be calculated. As the relationships signify, to maintain a low TJ, either θ or the power
being dissipated (or both) must be kept low. A low ΔT is the key to extending
semiconductor lifetimes, as it leads to lower maximum junction temperatures.

In ICs, one temperature reference point is always the device junction, taken to mean the
hottest spot inside the chip operating within a given package. The other relevant reference
point will be either TC, the case of the device, or TA, that of the surrounding air. This then
leads in turn to the above mentioned individual thermal resistances, θJC and θJA.


                                                                                       12-83
  BASIC LINEAR DESIGN

Taking the simplest case first, θJA is the thermal resistance of a given device measured
between its junction and the ambient air. This thermal resistance is most often used with
small, relatively low power ICs such as op amps, which often dissipate 1 W or less.
Generally, θJA figures typical of op amps and other small devices are on the order of
90°C/W to 100°C/W for a plastic 8-pin DIP package, as well as the better SOIC
packages.

It should be clearly understood that these thermal resistances are highly package
dependent, as different materials have different degrees of thermal conductivity. As a
general guideline, thermal resistance of conductors is analogous to electrical resistances,
that is copper is the best, followed by aluminum, steel, and so on. Thus copper lead frame
packages offer the highest performance, i.e., the lowest θ.


Heat Sinking
By definition, a heat sink is an added low thermal resistance device attached to an IC to
aid heat removal. A heat sink has additional thermal resistance of its own, θCA, rated in
°C/W. However, most current IC packages don’t easily lend themselves to heat sink
attachment (exceptions are older TO-99 metal can types). Devices meant for heat sink
attachment will often be noted by a θJC dramatically lower than the θJA. In this case θ will
be composed of more than one component. Thermal impedances add, making a net
calculation relatively simple. For example, to compute a net θJA given a relevant θJC, the
thermal resistance of the heat sink, θCA, or case to ambient is added to the θJC as:

                             θJA = θJC + θCA                                     Eq. 12-17

and the result is the θJA for that specific circumstance.

More generally, however, modern op amps don't use commercially available heat sinks.
Instead, when significant power needs to be dissipated, such as ≥1 W, low thermal
resistance copper PCB traces are used as the heat sink. In such cases, the most useful
form of manufacturer data for this heat sinking are the boundary conditions of a sample
PCB layout, and the resulting θJA for those conditions. This is in fact the type of specific
information supplied for the AD8017AR, as mentioned earlier. Applying this approach,
example data illustrating thermal relationships for such conditions is shown by
Figure 12.72. These data apply for an AD8017AR mounted to a heat sink with an area of
about 4 square inches on a 2 layer, 2 ounce copper PCB.

These curves indicate the maximum power dissipation vs. temperature characteristic for
the AD8017, for maximum junction temperatures of both 150°C and 125°C. Such curves
are often referred to as derating curves, since allowable power decreases with ambient
temperature.

With the AD8017AR, the proprietary ADI Thermal Coastline IC package is used, which
allows additional power to be dissipated with no increase in the SO-8 package size. For a
TJ(max) of 150°C, the upper curve shows the allowable power in this package, which is
12.84
                                                                                                                                 PRINTED CIRCUIT BOARD ISSUES
                                                                                                                                       THERMAL MANAGEMENT
1.3 W at an ambient of 25°C. If a more conservative TJ(max) of 125°C is used, the lower of
the two curves applies.
                                                                              2.0




                                              MAXIMUM POWER DISSIPATION (W)
                                                                              1.5


                                                                                                                      TJ = +150°C

                                                                              1.0
                                                                                             TJ = +125°C



                                                                              0.5




                                                                               0
                                                                                    0   10       20     30       40    50    60        70    80    90
                                                                                                      AMBIENT TEMPERATURE (°C)


          Figure 12.72: Thermal Rating Curves for AD8017AR Op Amp


A performance comparison for an 8-pin standard SOIC and the ADI Thermal Coastline
version is shown in Figure 12.73. Note that the Thermal Coastline provides an allowable
dissipation at 25°C of 1.3 W, whereas a standard package allows only 0.8 W. In the
Thermal Coastline heat transferal is increased, accounting for the package’s lower θJA.

                                             2.0
             MAXIMUM POWER DISSIPATION (W)




                                                                                                                  8-PIN THERMAL COASTLINE SOIC

                                             1.5




                                             1.0

                                                                                        8-PIN STANDARD SOIC

                                             0.5




                                             0
                                                                              -50 -40 -30 -20 -10            0   10    20   30    40    50   60   70    80   90

                                                                                                       AMBIENT TEMPERATURE - (°C)


  Figure 12.73: Thermal Rating Curves for Standard (Lower) and ADI Thermal
                   Coastline (Upper) 8-Pin SOIC Packages


                                                                                                                                                                  12-85
  BASIC LINEAR DESIGN

Even higher power dissipation is possible, with the use of IC packages better able to
transfer heat from chip to PCB. An example is the AD8016 device, available with two
package options rated for 5.5 W and 3.5 W at 25°C, respectively, as shown in Figure
12.73.


Taking the higher rated power option, the AD8016ARP PSOP3 package, when used with
a 10 inch2 of 1 oz. heat sink plane, the combination is able to handle up to 3 W of power
at an ambient of 70°C, as noted by the upper curve. This corresponds to a θJA of 18°C/W,
which in this case applies for a maximum junction temperature of 125°C.



                                              10 INCHES2 OF 1 OZ. COPPER




                                           PSOP3 (ARP)




                                   BATWING (ARB)




Figure 12.74: Thermal Characteristic Curves for the AD8016 BATWING (Lower)
           and PSOP3 (Upper) Packages, for TJ(Max) Equal to 125°C


The reason the PSOP3 version of the AD8016 is so better able to handle power lies with
the use of a large area copper slug. Internally, the IC die rest directly on this slug, with
the bottom surface exposed as shown in Figure 12.75. The intent is that this surface be
soldered directly to a copper plane of the PCB, thereby extending the heat sinking.




12.86
                                                       PRINTED CIRCUIT BOARD ISSUES
                                                             THERMAL MANAGEMENT




   Figure 12.75: Bottom View of AD8016 20-Lead PSOP3 Package Showing
          Copper Slug for Aid in Heat Transfer (Central Grayed Area)


For reliable, low thermal resistance designs with op amps, several design Do's and Don'ts
are listed below. Consider all of these points, as may be practical.

   1) Do use as large an area of copper as possible for a PCB heat sink, up to the point
      of diminishing returns.

   2) In conjunction with 1), do use multiple (outside) PCB layers, connected together
      with multiple vias.

   3) Do use as heavy copper as is practical (2 oz. or more preferred).

   4) Do provide sufficient natural ventilation inlets and outlets within the system, to
      allow heat to freely move away from hot PCB surfaces.

   5) Do orient power-dissipating PCB planes vertically, for convection aided airflow
      across heat sink areas.

   6) Do consider the use of external power buffer stages, for precision op amp
      applications.

   7) Do consider the use of forced air, for situations where several watts must be
      dissipated in a confined space.

   8) Don't use solder mask planes over heat dissipating traces.

   9) Don't use excessive supply voltages on ICs delivering power.



                                                                                   12-87
  BASIC LINEAR DESIGN

Both of the AD8016 package options are characterized for both still and moving air, but
the thermal information given above applies without the use of directed airflow.
Therefore, adding additional airflow lowers thermal resistance further (see Reference 2).

For the most part, these points are obvious. However, one that could use some
elaboration is number 9. Whenever an application requires only modest voltage swings
(such as for example standard video, 2 V p-p) a wide supply voltage range can often be
used. But operation of an op amp driver on higher supply voltages produces a large IC
dissipation, even though the load power is constant.


In such cases, as long as the distortion performance of the application doesn’t suffer, it
can be advantageous to operate the IC on lower supplies, say ±5 V, as opposed to ±15 V.
The above example data was calculated on a dc basis, which will generally tax the driver
more in terms of power than a sine wave or a noise-like waveform, such as a DMT signal
(see Reference 2). The general principles still hold for these ac waveforms, i.e., the op
amp power dissipation is high when load current is high and the voltage low.




           400                                                  Ps + Pq = TOTAL
                                 +VS
                                                                OP AMP POWER
    POWER            +1V
     (mW)                    +                 +2V

           300               AD817
                             -                   150Ω
                                 -VS
                                                                Pq = QUIESCIENT POWER
           200
                                 1kΩ                            Ps = SIGNAL POWER

                           1kΩ
           100


                                                                 Pr = LOAD POWER
             0
                 0                     5                10      15

                                           ±VS, VOLTS

   Figure 12.76: Power Dissipated in Video Op Amp Driver for Various Supply
                   Voltages with Low Voltage Output Swing



While there is ample opportunity for high power handling with the thermally enhanced
packages described above for the AD8016 and AD8107, the increasingly popular smaller
IC packages actually move in an opposite direction. Without question, it is true that
today’s smaller packages do noticeably sacrifice thermal performance. But, it must be


12.88
                                                         PRINTED CIRCUIT BOARD ISSUES
                                                               THERMAL MANAGEMENT
understood that this is done in the interest of realizing a smaller size for the packaged op
amp, and, ultimately, a much greater final PCB density for the overall system.


These points are illustrated by the thermal ratings for the AD8057 and AD8058 family of
single and dual op amp devices, as is shown in Figure 12.77. The AD8057 and AD8058
op amps are available in three different packages. These are the SOT-23-5, and the 8-pin
MSOP, along with standard SOIC.


As the data shows, as the package size becomes smaller and smaller, much less power is
capable of being removed. Since the lead frame is the only heat sinking possible with
such tiny packages, their thermal performance is thus reduced. The θJA for the packages
mentioned is 240°C/W, 200°C/W, and 160°C/W, respectively. Note this is more of a
package than device limitation. Other ICs with the same packages have similar
characteristics.




Figure 12.77: Comparative Thermal Performance for Several AD8057/AD8058
                        Op Amp Package Options


Data Converter Thermal Considerations
At first glance, one might assume that the power dissipation of an ADC or a DAC will
remain constant for a given power supply voltage. However, many data converters,
especially CMOS ones, have power dissipations that are highly dependent upon not only
output data loading but also the sampling clock frequency. Since many of the newer high-
speed converters can dissipate between 1.5 W and 2 W maximum power under the worst-
case operating conditions, this point must be well understood in order to ensure that the

                                                                                      12-89
  BASIC LINEAR DESIGN

package is mounted in such a way as to maintain the junction temperature within
acceptable limits at the highest expected operating temperature.

The previous discussion in this chapter on grounding emphasized that the digital outputs
of high performance ADCs, especially those with parallel outputs, should be lightly
loaded (5 pF to10 pF) in order to prevent digital transient currents from corrupting the
SNR and SFDR. Even under light output loading, however, most CMOS and BiCMOS
ADCs have power dissipations which are a function of sampling clock frequency and in
some cases, the analog input frequency and amplitude.

For example, Figure 12.78 shows the AD9245 14-bit, 80-MSPS, 3-V CMOS ADC power
dissipation versus frequency for a 2.5 MHz analog input and 5 pF output loading of the
data lines. The graphs show the digital and analog power supply currents separately as
well as the total power dissipation. Note that total power dissipation can vary between
approximately 310 mW and 380 mW as the sampling frequency is varied between
10 MSPS and 80 MSPS.




Figure 12.78: AD9245 14-Bit, 80-MSPS, 3 V CMOS ADC Power Dissipation vs.
             Sample Rate for 2.5 MHz Input, 5 pF Output Loads




12.90
                                                           PRINTED CIRCUIT BOARD ISSUES
                                                                 THERMAL MANAGEMENT




   SOLDER
   EXPOSED
   PADDLE
   TO PCB,
   IF POSSIBLE




                                                              AD9245 POWER DISSIPATION
                                                              = 380mW @ 80MSPS



                      θJA = 32.5°C/W, PER EIA/DESD51-1, STILL AIR


             Figure 12.79: AD9245 CP-32 Lead-Frame Chip-Scale
                        Package (LFCSP), Bottom View


The AD9245 is packaged in a 32-pin leadless chip scale package as shown in
Figure 12.79. The bottom view of the package shows the exposed paddle which should be
soldered to the PC board ground plane for best thermal transfer. The worst-case package
junction-to-ambient resistance, θJA, is specified as 32.5°C/W, which places the junction
32.5°C × 0.38°C = 12.3°C above the ambient for a power dissipation of 380 mW. For a
maximum operating temperature of +85°C, this places the junction at a modest
85°C + 12.3°C = 97.3°C.

The AD9430 is a high performance 12-bit, 170 MSPS /210 MSPS, 3.3 V BiCMOS ADC.
Two output modes are available: dual 105-MSPS demultiplexed CMOS outputs, or
210 MSPS LVDS outputs. Power dissipation as a function of sampling frequency is
shown in Figure 12.56. Analog and digital supply currents are shown for CMOS and
LVDS modes for an analog input frequency of 10.3 MHz. Note that in the LVDS mode
and a sampling frequency of 210 MSPS, total supply current is approximately 455 mA—
yielding a total power dissipation of 1.5 W.




                                                                                     12-91
  BASIC LINEAR DESIGN




                                   SAMPLE RATE – MSPS

                 TOTAL CURR ENT @ 210MSPS , LVDS MODE = 55mA + 400mA = 455mA
                 TOTAL POWER DISSIPATION = 3.3V × 455mA = 1.5W


         Figure 12.80: AD9430 12-Bit 170 MSPS/210 MSPS ADC Supply
                  Current vs. Sample Rate for a 10.3 MHz Input


The AD9430 is available in a 100-lead thin plastic quad flat package with an exposed pad
(TQFP/EP) as shown in Figure 12.81. The conducive pad is connected to chip ground and
should be soldered to the PC board ground plane. The θJA of the package when soldered
to the ground plane is 25°C/W in still air. This places the junction 25°C × 1.5°C = 37.5°C
above the ambient temperature for 1.5 W of power dissipation. For a maximum operating
temperature of +85°C, this places the junction at 85°C + 37.5°C = 122.5°C.




         SOLDER HEAT SLUG
         TO GROUND PLANE
         IF POSSIBLE

            STILL AIR:
   θJA = 25°C/W, SOLDERED

   θJA = 32°C/W, UNSOLDERED


        AD9430 POWER DISSIPATION
        IN LVDS MODE @ 210MSPS
        SAMPLE RATE = 1.5W




                    Figure 12.81: AD9430 100-Lead e-PAD TQFP
12.92
                                                       PRINTED CIRCUIT BOARD ISSUES
                                                             THERMAL MANAGEMENT




        SOLDER HEAT SLUG
        TO GROUND PLANE
        IF POSSIBLE

           STILL AIR:
   θJA = 23°C/W, SOLDERED

   θJA = 30°C/W, UNSOLDERED


     AD6645 POWER DISSIPTION
     = 1.75W MAXIMUM




            Figure 12.82: AD6645 52-Lead Power-Quad 4 (LQFP_ED)
               (SQ-52) Thermally Enhanced Package, Bottom View


The AD6645 is a high performance 14-bit, 80 MSPS/105 MSPS ADC fabricated on a
high speed complementary bipolar process (XFCB, and offers the highest SFDR (89 dBc)
and SNR (75 dB). Although there is little variation in power as a function of sampling
frequency, the maximum power dissipation of the device is 1.75 W. The package is a
thermally enhanced 52-lead PowerQuad 4® with an exposed pad as shown in Figure
12.82.

It is recommended that the exposed center heat sink be soldered to the PC board ground
plane to reduce the package θJA to 23°C/W in still air. For 1.75 W of power dissipation,
this places the junction temperature 23°C × 1.75°C = 40.3°C above the ambient
temperature. For a maximum operating temperature of +85°C, this places the junction at
85°C + 40.3°C = 125.3°C. The thermal resistance of the package can be reduced to
17°C/W with 200 LFPM airflow, thereby reducing the junction temperature to 30°C
above the ambient, or 115°C for an operating ambient temperature of +85°C.

High speed CMOS DACs (such as the TxDAC® series) and DDS ICs (such as the
AD985x series) also have clock-rate dependent power dissipation. For example, in the
case of the AD9777 16-bit, 160-MSPS dual interpolating DAC, power dissipation is a
function of clock rate, output frequency, and the enabling of the PLL and the modulation
functions. Power dissipation on 3.3 V supplies can range from 380 mW
(fDAC = 100 MSPS, fOUT = 1 MHz, no interpolation, no modulation) to 1.75 W
(fDAC = 400 MSPS, fDATA = 50 MHz, fs/2 modulation, PLL enabled). These and similar
parts in the family are also offered in thermally enhanced packages with exposed pads for
soldering to the PC board ground plane.


                                                                                   12-93
  BASIC LINEAR DESIGN

These discussions on the thermal application issues of op amps and data converters
haven't dealt with the classic techniques of using clip-on (or bolt-on) type heat sinks.
They also have not addressed the use of forced air cooling, generally considered only
when tens of watts must be handled. These omissions are mainly because these
approaches are seldom possible or practical with today's op amp and data converter
packages.

The more general discussions within References 4-7 can be consulted for this and other
supplementary information.




12.94
                                                               PRINTED CIRCUIT BOARD ISSUES
                                                                     THERMAL MANAGEMENT

REFERENCES: THERMAL MANAGEMENT

1.   Data sheet for AD8017 Dual High Output Current, High Speed Amplifier, Analog Devices, Inc.,
     http://www.analog.com

2.   Data sheet for AD8016 Low Power, High Output Current, xDSL Line Driver,
     Analog Devices, Inc., http://www.analog.com/.

3.   "Power Consideration Discussions," data sheet for AD815 High Output Current Differential Driver,
     Analog Devices, Inc., http://www.analog.com/.

4.   Walt Jung, Walt Kester, "Thermal Management," portion of Section 8 within Walt Kester, Editor,
     Practical Design Techniques for Power and Thermal Management, Analog Devices, Inc., 1998,
     ISBN 0-916550-19-2.

5.   General Catalog, AAVID Thermal Technologies, Inc., One Kool Path, Laconia, NH, 03246, (603)
     528-3400.

6.   Seri Lee, "How to Select a Heat Sink," Aavid Thermal Technologies, http://www.aavid.com

7.   Seri Lee, "Optimum Design and Selection of Heat Sinks," 11th IEEE SEMI-THERM™ Symposium,
     1995, http://www.aavid.com .




                                                                                               12-95


==========================================
FILE: Design Techniques for EMC, 1999, Part 5, PCB layout.pdf
==========================================

                             Design Techniques for EMC and signal integrity
                                     Part 5: PCB design and layout
             Originally published in the EMC Compliance Journal in 1999, significantly improved since then
                         and available from http://www.compliance-club.com/KeithArmstrong.aspx
Eur Ing Keith Armstrong CEng MIET MIEEE ACGI BSc(hons)
Partner, Cherry Clough Consultants, www.cherryclough.com, Associate of EMC-UK
Phone & fax: (+44) (0)1785 660247, Email: keith.armstrong@cherryclough.com
This is the fifth in a series of six articles on best-practice EMC and signal integrity techniques in
electrical/electronic/mechanical hardware design. The series is intended for designers of electronic
products, from building-block units such as power supplies, single-board computers, and ‘industrial
components’ such as PLCs and motor drives, through to stand-alone or networked products such as
computers, audio/video/TV, appliances, instrumentation and control, etc.
The techniques covered in these six articles are:
1) Circuit design (digital, analogue, switch-mode, communications), and choosing components
2) Cables and connectors
3) Filters and transient suppressors
4) Shielding
5) PCB layout (including transmission lines)
6) ESD, electromechanical devices, and power factor correction
A textbook could be written about any one of the above topics (and many have), and this magazine
article format merely introduces the various issues and points to the most important best-practice
techniques. Signal integrity is treated as ‘internal EMC’. Employing these well-proven techniques
from the start of a new design generally reduces the number of iterations of hardware and software
during development, and often reduces unit-manufacturing costs too. EMC compliance is generally
quicker, easier, with less risk of serious delays in time-to-market.
Table of contents for Part 5
5.          PCB layout ................................................................................................................................... 2
     5.1 Circuit segregation ....................................................................................................................... 3
            5.1.1      The boundary between outside- and inside-worlds ..................................................................................... 3
            5.1.2      Boundaries within an inside-world .............................................................................................................. 3
            5.1.3      Segregation .................................................................................................................................................. 3
            5.1.4      Component placement and routing of traces ............................................................................................... 5
     5.2 Interface Suppression ................................................................................................................... 5
            5.2.1      Suppressing outside/inside-world interfaces............................................................................................... 6
            5.2.2      Interfaces between dirty/high speed/noisy and clean/sensitive/quiet areas ................................................. 6
            5.2.3      Details of interface suppression techniques................................................................................................. 8
     5.3 Reference planes .......................................................................................................................... 8
            5.3.1      Creating proper reference planes ................................................................................................................. 9
            5.3.2      Connecting 0V planes to chassis ............................................................................................................... 12
            5.3.3      Shielding effect of planes .......................................................................................................................... 12
            5.3.4      Interconnecting planes in multi-PCB assemblies ...................................................................................... 12
            5.3.5      To split or not to split?............................................................................................................................... 12
            5.3.6      Galvanically isolated planes ...................................................................................................................... 13
            5.3.7      What if multilayer PCBs are thought too costly? ...................................................................................... 14
     5.4 Power decoupling....................................................................................................................... 14
            5.4.1      Power decoupling techniques .................................................................................................................... 14
            5.4.2      Self-resonance problems............................................................................................................................ 15


Design techniques for EMC – Part 5                                 © Cherry Clough Consultants 5 March 2007                                                      Page 1 of 25
            5.4.3     Decoupling without power planes ............................................................................................................. 17
     5.5 Transmission Lines .................................................................................................................... 17
            5.5.1     Changing layers ......................................................................................................................................... 20
            5.5.2     Simulation and prototype testing ............................................................................................................... 21
            5.5.3     Manufacturing issues with transmission lines ........................................................................................... 21
            5.5.4     Terminating transmission lines.................................................................................................................. 21
            5.5.5     Layer "stack up" ........................................................................................................................................ 23
            5.5.6     Joints, stubs, and buffers............................................................................................................................ 23
            5.5.7     Segregation in backplane systems ............................................................................................................. 25
     5.6 Useful references........................................................................................................................ 25

5.          PCB layout

5.1         Introduction
These PCB design techniques are well-proven to reduce the cost and effort of meeting “external”
EMC requirements such as FCC, VCCI, and/or the EMC Directive. They also improve ‘internal EMC’
and signal integrity, and help reduce the number of design iterations it takes to get a product to market.
As electronic technology advances (clock speeds increase, A/D converter resolutions improve) internal
EMC problems multiply, and the well-proven techniques described here become more important for
commercial success.
5.1.1         The synergy and cost-effectiveness of using these PCB techniques
The PCB techniques described here interact with each other to give improvements which are much
greater than each can achieve on its own. Solving EMC problems at PCB level always costs much less
than solving them at a higher level of assembly. Even if EMC problems can only be reduced at PCB
level, the costs of the higher-level EMC measures required will be considerably reduced.
The PCBs resulting from the use of these techniques may take longer to design initially (and need
higher skill levels) and may also have higher material costs, but…
•    Unit cost-of-manufacture should be reduced overall
•    The number of development iterations will be reduced
•    Time to market will be reduced
•    Reliability will be improved, leading to improved market perception and lower warranty costs
•    Engineering support for early production reduced
Understanding ‘why’ these methods work helps extract their maximum benefits, but all we have room
for here is a brief tour of these techniques – a few excellent references are provided at the end.
A major survey conducted in 2000 found that 43% of rework/redesign was caused by EMC and signal
integrity-related problems. As electronics technology advances its EMC emissions and susceptibility
both worsen and as a result many companies are finding that the ‘EMC fixes’ they used to be able to
apply to their products to get them through EMC compliance tests are just not good enough any more.
The fixes that would make their products compliant would also make them far too expensive
compared with competitors and what the market will stand. So EMC must be now designed-in from
the first to avoid serious financially embarrassing delays.
The techniques described in this section improve signal integrity (e.g. ground bounce) as well as
improving EMC, so they are very valuable techniques and should always be used. If any of the
following PCB techniques cannot be applied correctly for any reason, this is an indication that
problems with signal integrity and/or EMC will probably arise during development, so a suitable
amount of time and resource should be pre-allocated to deal with this by the project planner.



Design techniques for EMC – Part 5                               © Cherry Clough Consultants 5 March 2007                                                    Page 2 of 25
5.1.2    Profitable products
It is possible, by using the PCB techniques described here, to make a PCB-based product that meets
commercial/industrial EMC requirements yet that only needs a low-cost plain plastic enclosure to
protect it physically and from electro-static discharges. This allows almost unlimited freedom with the
plastic enclosure design.
The lowest-cost way to do this is to use a single PCB for all the circuits and interconnections within a
product. There will be no wires or cables inside the product. Although the PCB might be quite
sophisticated (e.g. a multilayer stack-up with some ICs covered by PCB-mounted shielding cans) it
will generally have a low overall cost-of-manufacture because it will be so easy and quick to
assemble, and it will tend to be more reliable (reduced problems with poor connections in wires and
cables, plus good EMC performance).
Remember, it is low cost-of-manufacture and low warranty costs that are important for a profitable
product. Material costs are totally irrelevant as long as the overall cost-of-manufacture is low and the
product is reliable enough. Unfortunately many companies do not have a good way to determine
assembly costs during design (much less reliability), so tend to focus on material costs because these
are easy to establish. Some companies even assume that the selling price is a multiple of the material
cost, whereas for the vast majority of electronic products the selling price has no direct (i.e. causal)
relationship with material cost at all. In fact, reducing the material cost can lead to more expensive
cost-to-make, not to mention delays in time-to-market and high warranty costs through unreliability.
5.1.3    Advanced PCB techniques
This part of the series covers basic PCB design techniques for EMC. Products with PCBs that use
high-speed signals (e.g. clocks >66MHz, risetimes of under 1ns, analogue >1GHz) may need to use
advanced PCB techniques as well as those described here. Even low-frequency signals may need
advanced PCB techniques, if they are susceptible to interference and in an aggressive electromagnetic
environment without high-specification enclosure shielding and filtering. The basic techniques
described here are a pre-requisite for the use of more advanced techniques.

5.2     Circuit segregation
For cost-efficiency, segregation needs to be employed from the start of the real design process. The
various segregated zones may need filtering and/or shielding from each other, so it is clear that the
layout of the PCB cannot begin until it is known where these are to be put.
The two main zones are:
The Outside World: Where total control of the electromagnetic (EM) environment is not practicable.
The Inside World: Where total control of the EM environment will be achieved.
5.2.1    The boundary between the Outside and Inside worlds
Outside and inside zones are easy to establish for a product with a fully-shielded enclosure (they are
segregated by the shield) but can be hard to draw for unshielded products.
Conductors completely within an unshielded product will couple with the external EMC environment.
They can be a cause of radiated emissions, and the radiated RF environment will cause them to carry
noise current and voltage and inject it into the circuits, depending on how efficient the conductor is as
an unintentional antenna at the frequencies concerned (see Volumes 1 and 2).
5.2.2    Boundaries within an inside-world
When the zone which is the inside-world has been determined (there may be two or more ‘inside
zones’ in a multi-PCB product where the PCBs are connected by wires), each zone should be further
subdivided into dirty, high-speed, noisy, (etc.) potentially “aggressive” circuits, and clean, sensitive,
quiet, (etc.) potential “victim” circuits. The likelihood of a circuit node being aggressive depends on



Design techniques for EMC – Part 5      © Cherry Clough Consultants 5 March 2007             Page 3 of 25
its maximum dV/dt and/or dI/dt. The likelihood of a circuit node being a victim of EM phenomena
depends on its signal levels and noise margins (less = greater sensitivity).
5.2.3    Segregating the zones
The various inside-world areas should be physically segregated from each other, and from the outside-
world, both mechanically and electrically. Start at the earliest design phase by showing the segregated
areas clearly on all drawings, usually done by drawing dotted lines around rectangular areas each
covering one segregated portion of the circuit.
Ensure that this segregation is maintained throughout the rest of the design process including system
design, PCB layout, wiring harness design, mechanical packaging, etc. Showing segregation clearly on
all system, wiring, and circuit diagrams is of great help in communications between electronic
designers, mechanical designers, and PCB layout persons – and is especially important where work is
done by people on different sites, or by subcontractors.
Most design occurs in two dimensions. It is not uncommon to find that, in the final assembly, a PCB
carrying a very sensitive circuit (such as a thermocouple or microphone amplifier) finds itself in close
proximity to a noisy circuit (such as a switch-mode power converter), with consequent signal quality
problems. Such unpleasant and time-consuming three-dimensional assembly problems should be
avoided by detailed visualisation of the final assembly from the start, even before the circuits are
designed and the PCBs laid out.
Figure 5A shows good segregation practices applied to a single-pcb product, whether it has an overall
enclosure shield or not.




This example shows that the segregated area where the outside world interface suppression
components are fitted, is along one edge of the PCB, as if it were a wall between outside and inside-
worlds (which it is, in a way).
This area would only contain opto-isolators, isolating transformers, baluns, filters, transient absorbers,
similar interfacing components but no ICs. It would also contain bonding points for the screens of any
screened cables, and/or for any enclosure shielding. If this example PCB was part of a larger
assembly, the segregation techniques employed for best EMC would be just the same.




Design techniques for EMC – Part 5      © Cherry Clough Consultants 5 March 2007             Page 4 of 25
The inside/outside-world interface components are restricted to one dedicated edge of the PCB to
encourage all unwanted external currents (e.g. caused by voltage differences in protective earths) to
restrict themselves to that area of the PCB, and discourage them from flowing through circuit areas.
Where an effective enclosure shield exists, the inside/outside-world boundary becomes the shielded
wall of the enclosure. All of the associated filtering and suppression components, and cable screen
bonding, must then use a connector panel set in the wall of the enclosure as their reference (as
described in Part 4). A single area for all interconnections is still best. A wider range of PCB-mounted
screened and/or filtered connectors that can also bond to a metal panel is now available. These parts
would be soldered to the PCB reference plane, then electrically bonded metal-to-metal to the wall of a
screened enclosure during final assembly, and can be very cost-effective.
Narrow channels free from components should be left between each of the segregated circuit areas on
the PCB. These should be wide enough for the fitting of a PCB-mounted “tuner-can” shield, and
provision should be made (at least on prototype boards) for bonding such screening cans to the 0V
plane at frequent intervals (say, every 15mm) along all edges.
5.2.4    Component placement and routing of traces
The most noisy or susceptible components in each area should be positioned first, as close to the
centre of their areas and as far away from cables or wires as possible. Such components include clock
generators and distribution (extremely noisy); bussed digital ICs (very noisy); microcontrollers
(noisy); switch-mode power transistors and rectifiers and their chokes, transformers, and heatsinks (all
very noisy), analogue ICs (sensitive), and millivolt level amplifiers (very sensitive). Remember (from
Part 1) that even low-frequency operational amplifiers can be extremely susceptible to interference,
even beyond 1GHz.
After the extremely short connections from components to reference planes, digital clock distributions
(very aggressive signals) must be the next "nets" to be routed, and must be run on a single PCB layer
adjacent to a 0V plane. These traces must be as short as possible, and even so may need to use
transmission-line techniques (described later). It may be necessary to experiment with component
placement to achieve minimum trace lengths. Where clock traces are made longer than necessary to
minimise skew, a "serpentine" layout is best.
Digital busses and high-speed I/O should be routed next, in a similar manner to clock traces, deferring
only to clock traces and plane bonds where there is a conflict. Very susceptible traces, such as those
carrying millivolt transducer signals, should also be routed as if they were clock or data buss traces,
although they will always be in a different segregated area of the PCB. The later section on
transmission lines describes what to do where critical traces have to change layers.
All other types of analogue, digital, and power signals should also be routed according to how
aggressive or sensitive they are. Where these characteristics are not obvious from a circuit analysis,
probing a prototype with a wide-band oscilloscope (and/or spectrum analyser) with voltage or current
probes will reveal which are the most aggressive, and injecting voltages or currents from a wideband
sweep generator will reveal which are most sensitive. A loop probe can be most useful here, being
able to inject signals into traces without requiring connection of external equipment to potentially
sensitive area of the circuit concerned.
All components and their traces must be contained within their designated PCB zones (areas). The
only traces which may exit or enter a zone are those that have to interconnect with other zones – these
traces might all need filtering or suppressing in some other manner, discussed later. Where it has not
proved possible to eliminate all the wires and cables inside a product, make sure that their routes are
fixed so they are as short as possible and can’t stray into the wrong PCB zones.
It is best to check that segregation instructions have been followed on draft PCB layouts, well before
PCB manufacture. An easy check is to count the traces and other conductors which cross the dotted
lines showing the segregated zones on the circuit diagram – there should be exactly the same number
crossing the channels between areas on the draft PCB layout.


Design techniques for EMC – Part 5      © Cherry Clough Consultants 5 March 2007            Page 5 of 25
Where PCBs have been autorouted it is usual to find unexpected traces crossing zone boundaries –
these are often the source of much design heartache, so eliminate them right away by applying more
skill to the layout. Autorouting does not generally provide good layouts for EMC purposes.
Devices which connect directly to other zones (e.g. A/D and D/A converters, filters, etc.) are
positioned right at the nearest edge of their zone. All external interconnections should be restricted to
one edge of the PCB only, to help prevent external circulating (noise) currents from flowing through
the circuitry on the PCB.

5.3     Interface Suppression
EM disturbances can be radiated and/or conducted across interfaces between segregated areas, and
shielding, filtering, or isolation techniques (such as opto-coupling) are used to reduce this to
acceptable levels. To decide on the most cost-effective methods for each interface, they should be
assessed for all the EM phenomena possible, given the operational EM environment and the
emissions/immunity characteristics of the circuits concerned.
Don’t ignore internal power supplies and other common connections such as 0Vs or grounds when
considering interfaces between areas. Circuit designers abbreviate such connections on their circuit
diagrams, often to invisibility, even though they provide the return current paths that are as important
as the send path.
5.3.1    Suppressing outside/inside-world interfaces
Conductors passing from outside to inside-worlds may need the full range of suppression techniques –
shielding, filters, isolating transformers, opto-isolators, surge protection devices, etc. As described
above, best practice is to use a single PCB area or panel in the enclosure shield for all outside/inside-
world interconnections and their suppression.
Visual displays (such as LCDs, LEDs, VDUs, moving-coil meters, etc.) and controls (such as
pushbuttons, potentiometers, rotary knobs, etc.) are also interfaces between outside and inside-worlds,
and are particularly exposed to personnel electro-static discharge (ESD), which will be covered by
Part 6 of this series.
Shielding (See Part 4) may be applied to chips or areas of the PCB; the whole PCB; sub-assemblies of
PCBs; entire assemblies of PCBs; or the entire product (listed in ascending order of cost and
difficulty). The segregation methods described above help make low-cost shielding possible.
5.3.2    Interfaces between dirty/high speed/noisy and clean/sensitive/quiet areas
Determining the types/amounts of suppression to be applied to traces and other conductors
interconnecting different PCB areas needs an assessment of both the desired signals and the unwanted
noise they may carry, plus the sensitivity of the circuits they connect to.
Digital clocks and data busses are aggressively noisy and should not be allowed in
clean/sensitive/quiet PCB areas. Data intended for a sensitive area should be latched from its bus no
closer than the boundary of that area, and the data busses themselves restricted to a noisier area.
Power distribution networks are often overlooked routes for conducted noise from one segregated area
to another, as are "static" data lines, and other low-frequency signals. Digital control lines which
remaining at logic 1 or 0 for long periods are often thought to be quiet, but they usually carry tens or
even hundreds of millivolts of high-frequency noise generated by the electrical activity of their source
ICs (e.g. by “ground bounce” and its corresponding “power bounce”). Many an analogue circuit has
suffered from noise on its power supply rails from switch-mode power supplies or DC/DC converters,
or from digital processing sharing the same rails or from noise injected into analogue switches and
opamps from “static” logic control signals. It is often necessary to fit small filters to such inter-area
connections, but sometimes more drastic measures are required, such as opto-isolation.




Design techniques for EMC – Part 5      © Cherry Clough Consultants 5 March 2007             Page 6 of 25
Components that interface between segregated areas, such as analogue-to-digital convertors,
transformers, data bus latches, filters, isolators, and the like, should be positioned at an edge common
to the areas they interconnect, as shown by Figure 5B. They should usually remain wholly within one
area or the other (so as to keep a component-free channel between segregated circuit areas) and their
traces must route directly to their respective areas and not mingle with traces associated with the
“other side” of these components or other areas.




One purpose in keeping the channel component-free is to reduce crosstalk, but it also makes it easier
to fit shielding over the segregated areas of circuitry, should it be needed. Where interface components
like ferrite beads, common-mode chokes, or opto-isolators are placed in one of these channels it can
help to achieve good separation between the traces associated with each circuit area, but the cut-outs
they require in any PCB-mounted shield may compromise its shielding effectiveness.
This compromise between the need for good trace segregation and for shielding effectiveness does not
apply when ‘feedthrough’ filter components are fitted as interconnections between segregated areas.
These are designed to fit into and actually penetrate the walls of screened enclosures, so when fitted in
(otherwise component- and trace-free channels) they encourage good trace segregation and don’t
compromise shielding effectiveness. Traditionally, feedthrough filters are screwed or soldered into a
hole in the shield, with wires connecting to their ends. This does not suit robotic surface-mounted
assembly techniques, prompting some manufacturers to produce ‘SMD feedthrough filters’. These
generally have an earth electrode around their centre, which is intended to be soldered to the PCB
reference plane (although some types may also be able to be hand-soldered to a cut-out in their shield).
In general the small size and low-profile of these parts means that they only require a very small cut-
out in the shield they penetrate, and so may be expected to have little effect on shielding effectiveness.
Where SMD ‘feedthroughs’ are used, their performance will be improved if the shield they are
associated with is soldered to the PCB reference plane as close as possible to the SMD feedthroughs,
as frequently as can be achieved (at least as often as 50mm times the risetime of the fastest signal in
nanoseconds). Very stringent applications sometimes require PCB shields to be seam-soldered all
around their circumference, and such assemblies would probably need to use the more traditional
wired-in feedthrough devices.
Radiated interference between segregated areas is possible. The stray capacitance between
components may only be a fraction of a pF, but at high frequencies can inject significant displacement
currents into components and traces in neighbouring areas. Combining small-sized low-profile

Design techniques for EMC – Part 5      © Cherry Clough Consultants 5 March 2007             Page 7 of 25
components with PCB reference planes, and placing the noisiest devices (e.g. clocks, processors,
switch-mode power devices) and signals in the centres of their areas, can help avoid the need to shield
PCB areas from each other.
5.3.3     Details of interface suppression techniques
Suppression techniques include:
•   common-mode and/or differential mode filtering
•   galvanic isolation using opto-isolators or transformers
•   communications protocols (to improve bit error rate in the presence of interference)
•   surge protection devices
•   the use of balanced drive and receive signals (instead of "single ended")
•   the use of fibre-optic, infra-red, wireless, laser, or microwave instead of copper cables
•   shielding of areas, volumes, cables, and connectors
All of these are covered by other parts of this series. It is important to realise that on a PCB only a
plane (described next) can provide a good enough reference at high frequencies to enable the full
performance of filters, cable screens, and internal shields to be achieved on a PCB.
Figure 5C shows an example of a PCB layout for filtering a through-hole connector connected to an
outside-world signal cable. The filter is simple LC type (see Part 3) using individual RF-suppressing
ferrite beads. A common-mode choke is often a better solution, especially for high-speed signals for
which individual line filters might affect the signals, and it is recommended to place and route the
ferrites so that their pads can be used to fit individual beads (as shown) or a common-mode choke, at
least on prototype PCBs.
The PCB’s ground plane is cut away around the connector to reduce capacitive coupling to the
unfiltered conductors. The connector area only contains the PCB traces between the connector pins
and the row of ferrites. All the other traces are routed over the ground plane, keeping 3mm or so away
from its edges at all times.
The ferrites are arranged in a row so that the trace and pad associated with the ‘connector side’ of any
one ferrite is always as far away as possible from the trace and pad associated with the ‘capacitor side’
of all other ferrites. If this is not done, RF can couple across (leak around) the filter through stray
capacitance paths. The capacitors are placed in a row and close to their associated ferrites for a similar
reason.




Design techniques for EMC – Part 5       © Cherry Clough Consultants 5 March 2007               Page 8 of 25
The bonds between the capacitors and the ground plane must be very short and direct, to provide the
lowest possible inductance and so help the capacitors to filter out higher frequencies (see the section
on decoupling, later in this Part).

5.4     Reference planes
Due to their intrinsic reactance and resonances, traces, wires, “star grounding”, area fills, guard rings,
etc., cannot provide an adequate reference for a PCB except at low frequencies (usually below 1MHz).
For example, the rule-of-thumb for the inductance of PCB traces on their own or single wires, is
1nH/mm. This means that just 10mm of PCB trace has an impedance of 6.3Ω at 100MHz, and 63Ω at
1GHz. For this reason, only unbroken areas of metal conductor can provide an adequate reference up
to 1GHz (and beyond), and these are called reference planes. In a PCB these are usually called power,
ground, or 0V planes, but it is best to avoid the use of the words “ground” or “earth” in connection
with EMC and circuits (reserving them for specific uses associated with safety bonding). As far as
most EMC design techniques are concerned, a connection to the green/yellow protective earth
conductor can often be more of a problem than a solution.
Reference plane techniques allow dramatic reductions in all unwanted EM coupling when used in
conjunction with the other techniques described here. Reference planes are also essential for almost
every other PCB EMC design technique to function properly.
5.4.1    Creating proper reference planes
As frequencies and component densities increase and rise-times decrease, PCB planes are increasingly
necessary. They are the only way to provide a known voltage, or a minimum-loop-area current return
path, at RF. They should be called Reference Potential Planes and/or Return Planes, but are usually
called simply ground, 0V, or power planes.
Unless a circuit is within a well-shielded and filtered enclosure with no digital or switch-mode or other
noisy circuits, it is nowadays exposed to an environment which contains a great deal of RF. So almost
all circuits should now use 0V planes. Where 0-5V signals on a PCB are >4MHz digital or >100MHz
sine-wave, power planes should also be used.




Design techniques for EMC – Part 5      © Cherry Clough Consultants 5 March 2007             Page 9 of 25
To function as intended and provide a plane needs a vanishingly small inductance between any two
connections made to it. A plane can be achieved on a PCB by devoting one copper layer to an
unbroken copper sheet and making all connections to it direct. A ‘copper fill’ is not a plane.
A 0V plane must be used as the 0V (or ground) connection for all its associated circuits, so that no 0V
return currents flow in any traces. To help minimise inductance in the return path, only use ‘thermal
break’ pads where necessary for soldering, and minimise the lengths of any ‘pin-escape’ or ‘break
out’ traces from surface-mounted components to the vias that connect to a plane (see later).
Power planes are created and used in a similar manner for power connections and their return currents.
0V planes must lie under all their components and all their associated traces, and extend a significant
distance beyond them and their power planes (a distance of 20 times their height above the plane is
often recommended). The segregation and interface suppression techniques described earlier must still
be followed even where a 0V plane is common to a number of different circuit areas.
Perforations such as leads, pins, and via holes increase the inductance of a plane, making it less
effective at higher frequencies. “Buried via” techniques have been developed for cellphones, allowing
interconnections between routing layers without perforating the reference plane. For less demanding
products a rule-of-thumb is that any gaps must have dimensions of 0.01λ or less at the maximum
frequency concerned. For a good plane at 1GHz, (e.g. to help meet most of the present EU harmonised
EMC standards cost-effectively) this rule implies that plane gaps should have dimensions ≤1.5mm
(remembering that the velocity of propagation in FR4 is approx. half of what it is in air). "Sneaking"
traces into a plane layer is not allowed.
Unavoidable gaps in a plane must not merge to create larger ones. PCB design rules should size
clearance holes so that for regular hole spacings such as through-hole connectors or DIL packages, the
plane "webs" between holes as shown by Figure 5D.




Traces, area fills, guard rings, etc. forming part of the reference on signal layers can be used to good
effect at high frequencies – but only when bonded to an underlying 0V plane with at least one via hole
every 5mm to15mm (using a random allocation of spacings).
0V planes should extend well beyond all components, traces and power planes. [1] recommends “the
20H rule”: 0V planes should extend by at least 20 times their layer spacing. High-speed components



Design techniques for EMC – Part 5      © Cherry Clough Consultants 5 March 2007          Page 10 of 25
(such as digital clocks, processors, and memory) and their signal traces should always be placed near
the centres of their segregated areas, well away from plane edges.
All 0V and power connections must bond immediately to their respective planes to minimise their
connection inductance. Leaded components must have their through-plated holes directly connected to
planes using thermal-break pads as shown by Figure 5D (sometimes called wagon-wheels) to help
with soldering. Surface mounted devices (SMDs) for reflow soldering have to compromise the
prevention of dry joints (e.g. tomb-stoning) with the need to minimise the inductance of plane
connections.
Figure 5E shows various methods for connecting reflow-soldered decoupling capacitors to their
ground and power planes. The most important issues in this case are to get the two plane connections
as close together as possible and to keep any ‘break out’ traces as short and as wide as is possible
without risking dry joints. Other components connecting to planes should follow similar rules,
especially IC power pins and transmission-line matching resistors.




The very best method is to use ‘via-in-pad’. This can be done with the standard through-hole processes
by using over-sized pads and tenting a good-quality solder-resist over a number of plane vias. Via-in-
pad is automatic when using Microvia (high density interconnect or HDI) PCB technology
High-quality solder resist, tented solder resist, minimum size soldered areas, and similar techniques
should be used where they allow the plane-connecting vias to be closer to the component pads without
causing dry joints. Plane connections that do not need to be soldered (typical of the vias for reflow-
soldered SMD components) may not need to use thermal-break pads – using solid plane connections
instead will reduce inductance still further (but never extend a trace to avoid having to use a thermal-
break pad).
It is best to make reference planes rectangular (but not thin) to minimise their inductance, and also to
make the fitting of PCB level shielding easier. Square planes, and planes with simple aspect ratios
such as 1:2, should be avoided to help reduce possible problems with resonances. Where there are a
number of different power supplies, there may need to be a number of different power planes.
Segregation of circuit areas (see earlier) makes it easier to fit several broadly rectangular power planes
on the same layer.




Design techniques for EMC – Part 5      © Cherry Clough Consultants 5 March 2007            Page 11 of 25
5.4.2    Connecting 0V planes to chassis
Components and traces have weak capacitive coupling to everything else. Electrical activity causes
displacement currents to flow in these “stray” capacitances, a cause of common-mode emissions.
High-speed circuits usually need at least a nearby metal surface, and (increasingly) a fully shielded
enclosure, to reduce the resulting emissions problems. The metal chassis or shields need to be
connected to the reference plane of their PCB, preferably at a number of points spread over the PCB
so that the high frequency displacement currents can be returned to their source within a fraction of
their wavelength. PCB mechanical supports and fixings are often used for these chassis bonds, but
should be very short (<4mm). There should be at least one bond in the centre of each area of high-
speed circuitry, especially clock generators and distribution. For high-speed digital boards, 0Vplane to
chassis bonds every 50mm to 100mm all over the PCB may not be overkill, and provision (at least)
should be made for these on prototype PCBs. Even if it is not intended to have a metal chassis or
shielded enclosure, it is still a good idea to include a number of potential chassis bonding points, just
in case. Sometimes a sheet of aluminised cardboard or PVC is sufficient to overcome unexpected
problems, providing it can be bonded to the right place(s).
To add flexibility, especially for mixed analogue/digital PCBs, each plane-to-chassis bond can have
traces and pads that allow the bond to be left open, or else fitted with direct links or capacitors of
various types and values. Fitting a direct link at one chassis bond and capacitors at the others allows
low frequencies (for which the inductance is not important) to be controlled with a “star ground”
system, whilst high frequencies are controlled by the low inductance of the widely distributed
capacitive links. Care should be taken to minimise the inductances of all these traces, pads, and linking
components (SMD preferred). Where reference planes must be galvanically isolated only capacitor
bonds may be used, but care should be taken with safety approvals and earth-leakage requirements
(especially for patient-coupled medical apparatus).
5.4.3    Shielding effect of planes
Antennas placed close to metal planes are less effective at radiating and receiving. Many advantages
of planes are due to the way they allow the return currents to take the path of least inductance, but
their “antenna shielding” effect is also important. For any significant advantage to be achieved from
this effect, the tops of all the PCB components must be no more than one-twentieth of a wavelength
above a PCB plane, at the highest frequency of concern for emissions and immunity, e.g. 15mm to
give a degree of shielding to analogue circuits exposed to 1GHz immunity testing.
Even lower profiles will give improved shielding, one reason why SMD components are much
preferred for EMC, with very low profile ball-grid-array and flip-chip technologies being better still.
The plane needs to extend by considerably more distance around the components than their height
above it.
5.4.4    Interconnecting planes in multi-PCB assemblies
Card cage, backplane, and mother/daughterboard structures will experience considerable signal
integrity and EMC advantages from linking their reference planes together with very low inductance.
This may be achieved with frequent low-inductance links between their planes, more-or-less
uniformly distributed along the full length of all their common boundaries. Shielded backplane
connectors are happily becoming more commonly available. Where shielded connectors aren’t used,
using one 0V plane-linking pin alongside every signal or power pin in a connector may seem
expensive, but sometimes it is the lowest-cost (or only practical) way to improve the EMC of a
multiple-PCB product. Bonding planes via front panels and/or card guides is also very worthwhile.
5.4.5    To split or not to split?
Split reference planes may give better or worse EMC (and signal integrity) than unsplit planes, and
this depends very much on the PCB layout and circuit design so it is often hard to decide which
method to use. Note that where a 0V plane is to be split off from the main 0V plane, it may still need
chassis bonds as described earlier. This is particularly true of “traditional” method of splitting off


Design techniques for EMC – Part 5      © Cherry Clough Consultants 5 March 2007           Page 12 of 25
connector panel 0V plane areas (to try stop noise on the main board from exiting via the external
connectors), when the connector area on the PCB must have its local 0V plane bonded to any
enclosure shielding. Also note that the inevitable stray capacitance across a split progressively “shorts
it out” above 500MHz anyway.
To get any benefits from split planes with modern electronic technologies requires significant attention
to detail, which is one reason why an increasing number of designers are now using common, unsplit
0V planes as a matter of course.
Allow for both split and unsplit options, on prototype PCBs at least, by splitting all planes at the
natural boundaries between the segregated circuit areas, but also providing the means to "stitch" them
together manually later on. Stitching requires pairs of via holes on each side of the split every 10mm
or so (random spacing of 5mm to 15mm preferred). These via pairs may be left open, or bridged with
short wires or capacitors, and it is important to pitch the via pairs close together so that small
capacitors or "zero-ohm links" can be used (preferably SMD). Linking planes with a single copper link
and multiple capacitors can control lower frequencies (where inductance is not significant) by "star
grounding", whilst also controlling higher frequencies by creating the effect of a single low-inductance
plane.
Because a split in a plane is a slot antenna, it is best if no traces cross the split (or even go near to it).
Where traces have to cross – they must have carefully-defined return current paths, and for high
frequency currents these paths must be physically adjacent to their send traces. These tend to defeat
the purpose of the split, so should be limited to the bandwidth of the wanted signal (which should
already have been restricted to just what is needed, as described in the section on interface analysis
and suppression above). High-speed signals can usually be returned through a suitable size and type of
capacitor, although some data streams with highly-variable content may need a more wideband return
path than a single capacitor can easily provide (may need a direct link).
Balanced signals would ideally need no local return path, but in practice their balance always degrades
at some frequency so a nearby return path is needed for the resulting common-mode “leakage”
(usually a small-value capacitor). DC power and low-frequency signals that have been filtered to
remove all high-frequency noises can use the star point between the split 0Vs for their return, as long
as the inductance of the resulting current loop is negligible. Beware of assuming that a conductor is
only carrying low frequencies just because that is what its signal name implies. In modern mixed
digital/analogue products all the traces and other conductors in a product usually carry significant
levels of high frequency noise. A local return path for a low-frequency signal could be a ferrite bead.
Common-mode (CM) chokes fitted to any types of signals and their associated returns (e.g. a 4-circuit
CM choke for a set of three related signals and their return) will probably help get the best
performance from split planes, but cost more.
When all the above has been designed into the split-plane PCB, it will need testing and optimisation.
Direct or capacitive links to/from the “stitching vias” should be added/subtracted to achieve the best
EMC performance. If it is discovered that the best EMC is achieved when all the stitching points are
directly linked, the next iteration of the PCB could remove the splits and their stitching points
completely, saving manufacturing costs.
5.4.6    Galvanically isolated planes
The split planes described above are all ultimately powered from the same power rails (0V, at least),
so there is a clear need for return current paths to be catered for every conductor (signal or power) that
crosses from one plane area to another. It is often assumed that galvanically isolated areas have no
return current requirements, but this is not so at high frequencies.
Galvanic isolation devices (opto-isolators, transformers, etc.) suffer from stray internal capacitance. A
typical opto has 0.8pF internal capacitance, which provides a shunting impedance of only 2kΩ at
100MHz, or 200Ω at 1GHz, which will clearly prevent signal isolation from being maintained at high
frequencies. Transformers (especially in DC/DC power converters) tend to have even larger stray


Design techniques for EMC – Part 5        © Cherry Clough Consultants 5 March 2007              Page 13 of 25
internal capacitances. Common-mode chokes may be used to improve the isolation at high
frequencies, but struggle to increase it by an order of magnitude at 1GHz. There are also many other
stray capacitances around to compromise isolation. So there is a need, at high frequencies, to provide a
local return path for the displacement currents that flow in these stray capacitances, to prevent them
from causing common-mode conducted and radiated emissions and immunity problems.
Because we usually only need isolation for low frequencies (usually only 50Hz) we can connect
galvanically isolated planes to the main reference plane with a number of low-value capacitors (spread
around the gap perimeter), so as to achieve the effect of a single reference plane for high frequencies
and provide low-inductance local return paths for stray displacement currents.
Of course, great care may need to be taken with component approvals and leakage currents where
safety is concerned.
5.4.7    What if multilayer PCBs are thought too costly?
In volume, four-layer PCBs now only cost between 20% and 50% more than two-layer. The use of
planes usually turns out, in retrospect, to have been the most cost-effective EMC technique possible,
especially when the overall financial break-even time and profitability of a product is considered.
An appropriate technique for low-density double-sided PCBs is to put all the traces on one side, and a
solid 0V plane on the other. For digital products, the lack of a power plane might require a number of
ferrite beads in the power rails (see later), so it might not prove to be most cost-effective.
Where traces must use both sides of a two-layer PCB, some EMC improvements may be had by
"gridding" 0V traces. This can be done by using a "maximum copper" or "area fill" on the 0V traces of
both PCB layers, which must run perpendicular to each other, "stitching" the resulting horizontal and
vertical 0V areas and lines together with via holes wherever they cross to create a grid over the whole
PCB area. Smaller grid sections are needed around the more sensitive or aggressive components, often
difficult to achieve for leaded microprocessors but easier for SMD types. Time should be allowed for
moving components and traces around to achieve the best grid structure, but any grid will always be
much less effective than a proper solid plane.
Single-sided PCBs are extremely difficult to make EMC compliant without enclosure shielding and
filtering, except for circuits which naturally have very low emissions (low dV/dt and dI/dt) and also
have naturally very high immunity (e.g. high signal levels and low impedances).

5.5     Power decoupling
The aim of power decoupling is to maintain the power supply impedance to each IC at 1Ω or less
across the entire frequency range of interest (at least 150kHz to 1GHz for EMC). Some devices may
need 0.1Ω or less over some frequency ranges for correct operation. Wires and PCB traces have too
much inductance to provide these low impedances, which require local capacitance of suitable quality.
5.5.1    Power decoupling techniques
A large decoupling capacitor (e.g. 100µF) should be fitted where power supplies enter or leave a PCB,
and some smaller ones (e.g. 10µF tantalum or solid aluminium) should be "sprinkled" around the PCB
on a "µF per unit area" principle, as well as being positioned near to heavy power usage such as
microprocessors, memory, and other powerful digital ICs. These capacitors provide low impedance up
to, say, 10MHz. Next, the power supplies to every IC should be decoupled very nearby using
appropriate capacitor sizes and types. Where an IC has a number of power pins, each pin should have
an appropriate decoupling capacitor nearby, even if they are on the same supply (e.g. Vdd).
Achieving good decoupling above 10MHz gets more difficult as frequency increases, because the
inductance of component leads, PCB traces, via holes, and capacitor self-inductance, inevitably limit
their performance. The achievement of good power supply decoupling at higher frequencies using
capacitors mounted close to IC power pins is discussed next.



Design techniques for EMC – Part 5      © Cherry Clough Consultants 5 March 2007          Page 14 of 25
The total local decoupling capacitance required depends on the IC’s transient power demands and the
tolerances of its DC power rails. VLSI and RAM manufacturers should be able to specify the values
(and maybe even the capacitor types and preferred layout patterns) for their products, but note that
they will probably have assumed an accurate 5V power supply – usually not true of real life.
The formula C(∆V) = I(∆t), using the units Farads, Volts, Amps, and seconds, covers what we want to
know. ∆V is obtained by subtracting the IC's minimum operational voltage (from its data sheet) from
the worst-case minimum power rail voltage (taking account of initial tolerances, regulation,
temperature coefficients, ageing drift, and the voltage drops in the power conductors). ∆V often turns
out to be a mere +100mV. I is the IC's transient current demand from its power rail, which lasts for ∆t.
I and ∆t are almost never found in data sheets, and must be measured in some reasonably sensible way
with an oscilloscope. An obvious component of I is the device’s output (load) current, but this is often
negligible in comparison with “shoot-through" currents, also known as “transient supply current”.
There is no point in measuring I or ∆t with greater than ±20% accuracy.
Where ∆V is low it may be cost-effective to increase it by improving the regulation of the power
supply, and/or reducing the resistance of the power rails, rather than fit larger capacitors with their
lower performance at high frequencies. This is a common argument for local power regulation.
5.5.2    Self-resonance problems
Self-resonance in capacitors stops them providing low impedances at high frequencies, with higher
values generally being worse. The first self-resonant frequency (SRF) of a capacitor is a series
                                                       1
resonance, and a rule of thumb for this is: fres =          , where L = ESL (internal to the capacitor)
                                                    2π LC
 + the total inductance of any leads + the total inductance of any traces and/or vias. 1nH/mm may be
assumed for leads and/or traces from a capacitor to the power pins of its IC. The inductance
contributed by 0V and power planes may be neglected when the capacitor is near to its IC. Decoupling
capacitors generally become ineffective at more than 3 times their SRF, as shown by Figure 5F.




Design techniques for EMC – Part 5      © Cherry Clough Consultants 5 March 2007          Page 15 of 25
It is interesting to note that the favourite 100nF capacitor, even with no traces at all, is effectively
useless above 50MHz, yet it is still often seen in circuits with clocks of 50MHz or over, where it can
do nothing to help control the fundamental clock frequency, never mind its harmonics.
Close proximity of adjacent 0V and power planes (with their low internal and connection inductances)
can provide capacitance with no SRF below 1GHz. Two planes separated by 0.15mm in an FR4 PCB
achieve approximately 23pF/sq.cm of high quality RF capacitor. Good decoupling from 10 to
1000MHz can be achieved by combining adjacent 0V and power planes with SMD ceramic capacitors
(COG and NPO types are best). Sometimes two different values of capacitors (e.g. 100nF and 1nF)
may be required. Low inductance bonds from IC power pins and decoupling capacitors to their planes
is essential, and the capacitors must be positioned close to their IC. The common practice of routing
from IC power pin to decoupling capacitor, and only then connecting to the plane, does not make best
use of plane capacitance.
Whenever two capacitors are connected in parallel, a high-Q (i.e. sharp) high impedance resonance is
created which could compromise power impedance at that frequency. This is easily dealt with on
PCBs which have a dozen or more decoupling capacitors, since for every sharp high-Z resonance there
are a number of alternate current paths with low-Z, which will swamp it. It may be a good idea to fit
decoupling capacitors of 10nF to 100nF in large areas of planes which are devoid of ICs, to help this
swamping process. Parallel resonances are very sharp and often don’t correspond to any harmonics so
have no effect, but unless it is known that this will also be the case for a new PCB (and that no-one
will ever alter its clock frequencies) it is risky to ignore their potential for upset.
Parallel resonance problems are more likely to occur where only a few decoupling capacitors are used,
for example where a small circuit area is powered from a dedicated power plane. It may be controlled
by fitting a low-value resistor (say 1Ω) or small ferrite bead (preferably using SMD packages and
short traces) in series with one lead of the larger value capacitors. Alternatively, adding a number of
additional capacitors with differing values should help.
The sudden change in characteristic impedance at the edges of parallel PCB planes creates resonances
at integer multiples of half-wavelengths. For example, the first such resonance for a 150mm width or
length would be around 500MHz for a bare PCB, moving down in frequency as the PCB was loaded
with decoupling capacitors (which slows the velocity of propagation in the planes). This was the
reason for recommending non-square rectangular plane shapes (and non-simple aspect ratios) in an
earlier section. The resulting high impedances at various areas of the PCB can be controlled by fitting
lots of decoupling capacitors, so it is only likely to be a problem for circuits operating at high
frequencies with large planes and few decoupling capacitors. There is a suggestion that fitting 1 to
10nF decoupling capacitors around the edges of planes can reduce this effect.




Design techniques for EMC – Part 5      © Cherry Clough Consultants 5 March 2007          Page 16 of 25
Figure 5G shows a time domain view of how good power supply decoupling functions in an example
situation. The first nanosecond or so of transient current can only be provided by local 0V/power plane
capacitance, with from 1ns to 3ns being provided by SMD ceramic capacitors up to 10nF located




nearby.
Larger (or further away) capacitors are only able to contribute to the current demand after at least 3ns.
"Bulk" capacitors (e.g. tantalums) only provide significant current after 20ns or so, even if nearby
(non-ceramic dielectrics and electrolytics are slow to respond to transient current demand due to
dielectric absorption effects, also known as dielectric memory or dielectric relaxation).
A PCB process is available that uses a special dielectric between adjacent 0V and power planes to
increase their capacitance and eliminate the need for most of the smaller values of decoupling
capacitors. Three-terminal or “feedthrough” SMD decoupling capacitors have much higher SRFs than
regular two-terminal capacitors, but are more expensive. There are also laminar capacitor components
(such as the Micro/Q range) made to fit under leaded ICs, which are also expensive and perhaps best
used in attempts to improve existing PCBs without relaying them.
5.5.3      Decoupling without power planes
One way to achieve possibly adequate decoupling without a power plane is to connect one end of an
IC's decoupling capacitor to its power pin with very short fat trace, then connect that end of the
capacitor to the power distribution via a thin trace (to create some inductance) or ferrite bead, rated for
the IC’s current. Three-terminal or high-specification capacitors may be used to advantage so that a
high SRF is achieved with a single decoupler. This technique still requires a 0V plane. Where a large
number of ferrite beads or expensive capacitors are required, multi-layer boards may prove to be more
cost-effective and require less area.

5.6       Transmission Lines
Transmission lines maintain a chosen characteristic impedance, Z0, from a signal’s source to its load,
and (as discussed in Part 2 of this series) unlike all other interconnections do not resonate however
long they are. Transmission lines can easily be made on PCBs by controlling materials and dimensions
and providing accurate termination resistances at source and/or load. They may also be extended off
the PCB (if necessary) with appropriate controlled-impedance cables and connectors.



Design techniques for EMC – Part 5       © Cherry Clough Consultants 5 March 2007            Page 17 of 25
Comparing the length of a PCB trace conductor with the wavelength of the highest frequencies of
concern in the relevant medium (e.g. FR4), or with the rise- and fall-times of a signal, gives us what is
called the ‘electrical length’ of the trace. Electrical length may be expressed as a fraction of a
wavelength or as a fraction of the rise- or fall-time. When a conductor is ‘electrically long’,
transmission lines need to be used to maintain the frequency response (sometimes called ‘flatness’) or
to prevent excessive distortion of the waveshape. For high-speed signals on PCBs, transmission line
techniques are required for all electrically long traces both for signal integrity and EMC.
The crude rule of thumb are that a conductor is electrically long when it exceeds one-seventh of the
shortest wavelength of concern, or when the time that the leading edge of a signal takes to travel from
the source to the furthest receiver exceeds half of its rise or fall times. Consider Fast TTL, which is
specified as having 2ns risetimes. The dielectric constant of FR4 at high frequencies is around 4.0,
which gives a signal velocity of 50% of c, or 1.5 x 108 m/s, equivalent to a trace propagation time of
6.7ps/mm. In 2ns a signal in an FR4 PCB would have travelled about 300mm, so it appears that Fast
TTL signals need only use transmission lines for traces of 150mm or longer. Unfortunately, this
answer is wrong. The ‘half risetime’ rule is very crude and can lead to problems if its shortcomings are
not understood.
Databook specifications for output rise/fall times are maximum values, and devices almost always
switch a lot faster (assume at least four times faster in the absence of actual data). It is best to measure
a number of samples from different batches, and obtain an agreement from the device manufacturer
that he will warn well in advance of mask-shrinks. Also, the inevitable capacitive loading from
connected devices reduces the propagation velocity from what would be achieved on the bare board.
So transmission lines should be used for much shorter lengths of trace than suggested by the above
rule, merely to achieve adequate digital signal integrity. Taking these two issues into account, we may
find that specified 2ns rise/falltime signals should use transmission lines for traces that are longer than
30mm (and possibly even less).
Transmission lines are often used for clock distribution and high-speed busses; for slower signals that
have to travel further, such as SCSI and USB; and also for even slower communications such as
10base-T Ethernet and RS485, which have to travel very long distances.
Most transmission lines are used to preserve the waveshape of high-speed signals, and to reduce their
emissions, but transmission-line techniques work in just the same way to reduce the amount of
external fields picked-up by a trace, so are valuable for EMC immunity reasons too. It may help to use
transmission lines for low-bandwidth signals (e.g. analogue instrumentation) to prevent their
contamination by high-frequency fields in their environment (which could be inside a product), since
analogue devices are particularly prone to demodulating RF at hundreds of MHz (refer to Part 1).
When designing a transmission line for immunity purposes, the ‘shortest wavelength of concern’ or
the ‘highest frequency of concern’ is the important parameter.
IEC 1188-1-2: 1998 [2], gives a wealth of details on constructing a wide variety of transmission lines
with PCB traces, plus how to specify their manufacture and check quality at goods-in. [1], [3], [4], and
[5] are also very helpful with this large and detailed topic, so only the two most common types are
described below.
The first example is a surface microstrip (see Figure 5H), and its Z0 is given in ohms by:
        87             . H
                     598
Zo =           × Ln
      εr + 141
            .       0.8B + C
where εr is the dielectric constant of the substrate (typically 4.4 for FR4 at 100MHz), B is the trace
width, C is the thickness of the copper material used, and H is the substrate thickness.
Its propagation velocity in ns/metre is: 3.335 0.475εr + 0.67 .




Design techniques for EMC – Part 5       © Cherry Clough Consultants 5 March 2007             Page 18 of 25
The second example is the symmetrical stripline (Figure 5J), which uses two reference planes:
     60          . H
                19
Zo =     × Ln           .
      εr      0.8 B + C

The propagation velocity for a symmetrical stripline in ns/metre is: 3.335 εr .
Striplines are slightly slower than microstrip, but have zero forward crosstalk and much less off-board
leakage, so are best for EMC.
[1] gives correction factors for the above formulae to compensate for capacitive loading (typically a
                              Z0
few pF per gate): Z ′ 0 =            where Cd is the sum of all capacitive loads, Z0 is the original
                                Cd
                            1+
                                C0
characteristic impedance (unloaded) of the line, and C0 is the characteristic capacitance of the
(unloaded) line obtained from the basic formulae given in [2].
                                                           V0
Velocity is slowed according to the formula: V ′ =               from [1], where V0 is the original
                                                             Cd
                                                          1+
                                                             C0
(unloaded) velocity. A constant “gates per unit length” is preferred for the layout of an array of load
devices, rather than bunching them together, although it may be possible to adjust the line dimensions
for different portions of the trace so that the same Z0 is maintained all along its length, even where
load devices are bunched together.
The highest-speed (or most critical) signals should run adjacent to a 0V plane, preferably one paired
with a power plane for decoupling. Less critical signals may be able to be routed against a power plane
where the power plane has been adequately decoupled and is not too noisy (i.e. has been properly
decoupled, see earlier). Any such power plane must be the one associated with the signal’s ICs.
Striplines routed between two 0V planes (one or both of which is paired with a power plane for
decoupling) give the best signal integrity and EMC.
Transmission lines must not have any breaks, gaps, or splits in any of the planes they are routed over,
as these cause sudden changes in Z0. They should also stay as far away as possible from any breaks,
gaps, splits, or plane edges, by at least ten times their trace’s width. Low crosstalk requires spacing

Design techniques for EMC – Part 5      © Cherry Clough Consultants 5 March 2007          Page 19 of 25
adjacent transmission lines by at least three times their trace widths. A very critical or aggressive
signal (e.g. a radio antenna connection) may benefit from using a symmetrical stripline with a row of
closely spaced vias between its two 0V planes all along each side, ‘walling it off’ from other traces
and creating a coaxial type of structure in the PCB. This requires a different Z0 formula from those
above.
The two transmission line types above require two or more PCB layers, so can be costly to achieve in
high-volume low-cost products (although in volume a 4-layer PCB should cost no more than 20%
more than a 2-layer). Balanced and co-planar line types can be constructed on a single PCB layer, so
may be a solution where high-speed signals must use lowest-cost PCBs. Single-layer transmission
lines will take between two and three times the area as microstrip or stripline, so be prepared for their
real estate demands. Also beware of saving so much cost on the PCB that the cost of the enclosure
shielding and filtering has to be increased. It is a general rule that solving an EMC problem at
enclosure level costs between 10 and 100 times more than it would have if it were solved at PCB level.
So when trying to pare costs to the bone by reducing the number of PCB layers, allow the time and
cost for a couple of additional PCB iterations to get the EMC and signal integrity within specification
and within budget, and also allow for additional PCB area.
5.6.1    Changing layers
High-speed or other critical transmission lines should not change layers. This means routing clock
distribution first, moving components around to achieve the smallest area of highest-speed circuitry
and traces. High-speed busses, fast data communications, and the like are routed next, still sticking to
one layer, and then everything else (less critical for signal integrity or EMC) is routed around them,
changing layers as necessary. Where there is no reasonable alternative to changing the layers of a
critical transmission line, a decoupling capacitor (with a suitable frequency response) should be fitted,
with its vias linking all the relevant power and 0V planes, near to the point where the signal changes
layers.
Keeping to the same layer is easy when using surface-mounted devices with microstrip transmission
lines on the same side of the PCB. Stripline is less leaky than microstrip – but this would mean
changing layers, which is generally a bad thing. (Microwave circuit designers often employ microstrip
with surface-mount devices with leads that are exactly the same width as the PCB transmission line
impedance (usually 50Ω), but they also generally fit each gain stage inside its own milled pocket in an
aluminium housing. Such techniques are not generally suitable for computer and DSP boards.)
Changing layers is usually necessary, if not to use striplines for their beneficial effects, then because of
trace densities, so how can we mitigate its effects?
We already have at least one decoupling capacitor associated with each IC (see 5.4 above) so we can
change layers near to an IC, but we must consider the electrical lengths of the portions of the signal
path that do not share the stripline layer. A crude rule of thumb is that these portions should not have
an electrical length longer than one-eighth of the rise time (approximately one-thirtieth of the shortest
wavelength of concern). Where very large changes in Z0 can occur (e.g. when using a ZIF or other IC
socket) it would be better to aim for less than one-tenth of the rise time. Use these rules to determine
the maximum length, and keep well within this length wherever possible.
So for signals specified as having 2ns rise time signals we should probably change layers no further
than 10mm from the centre of the IC’s body or the centre of the line termination resistor. This includes
a ‘safety factor’ of 4 to allow for the actual edge rate of the signal being faster than the data sheet
maximum. At least one decoupling capacitor, which connects all the relevant powers and grounds
together (respectively) should also be within a similar distance from any transmission line that changes
layers. Such short lengths are often difficult to achieve with larger ICs, and this reveals some of the
compromises inherent in modern high-speed PCB layout. This also reveals at least one reason why
physically smaller ICs are preferred, and why bonding techniques such as BGA and flip-chip (which
reduce the distance from the PCB trace to the silicon itself) are continually being developed and
improved upon.


Design techniques for EMC – Part 5       © Cherry Clough Consultants 5 March 2007             Page 20 of 25
5.6.2    Simulation and prototype testing
Because of the variations in the types of ICs, and the applications they find themselves in, some
engineers will find these rules of thumb not tough enough, and some will wonder whether they are
over-engineered, but that is the function of a rule of thumb, after all.
Computer-based circuit simulation techniques that calculate EMC and/or signal integrity based on
parameters extracted from an actual PCB layout are becoming more capable, and their use is
recommended instead of the crude rules-of-thumb expressed here. However, remember that device
switching speed are almost always considerably faster than their data sheet specifications, so a
simulation that uses data sheet figures will give a false sense of confidence.
Tests with a high-speed oscilloscope and probing system should be carried out on the first PCB
prototypes to see whether the waveshape is good enough. A waveshape that does not distort as it
travels around the PCB is the goal, and merely following these rules of thumb is unlikely to achieve
such perfection, although the result may be good enough. Close-field probing with a single-turn loop,
using a high-speed ‘scope and/or a spectrum analyser, is another good way to detect signal integrity or
EMC problems at prototype board level. The techniques involved in prototype testing are not
discussed further here.
Even when using sophisticated modelling or simulation techniques, always perform signal integrity
and EMC checks on early prototypes.
5.6.3    Manufacturing issues with transmission lines
Normal FR4 PCB material has a nominal relative dielectric constant (εr) of approximately 4.7 at
1MHz falling roughly in a linear fashion with increasing frequency to 4.2 at 1GHz. Actual values of εr,
can vary by ±25%. Controlled εr grades of FR4 are available at little or no extra cost, but PCB
manufacturers may not use these grades unless specifically requested.
PCB manufacturers work with standard thickness laminations (“prepregs”), and their thicknesses
should be discovered (along with their manufacturing tolerances) before design starts. The trace
widths can then be chosen to achieve the required Z0 for the available range of dielectric thicknesses.
Trace widths after PCB processing are usually about one thousandth of an inch less than those used on
the photoplots. Ask what thickness to add to the drawn traces to achieve the required finished trace
widths.
For signal frequencies greater than 1GHz it may be necessary to use other dielectric materials than
FR4, such as those used for microwave applications (e.g. Duroid from Rogers Corporation Inc., or a
number of more modern dielectrics).
5.6.4    Terminating transmission lines
“Classical” RF transmission lines are terminated both at signal source and load by impedances equal
to their Z0 (allowing for the internal impedances of source and load devices). Although an ideal and
sometimes necessary technique, it halves the received voltage – so most ordinary analogue and digital
circuits use low-Z sources and high-Z loads with the line only terminated at one end, to preserve signal
levels.
RF engineers often use reactive components or even lengths of trace as line terminations, but the
terminations for wideband analogue and conventional digital signals require individual resistors,
preferably SMD types for their excellent high-frequency performance. To get the best from SMD
resistors they must be connected to the reference planes using low inductance techniques as shown by
Figure 5C.




Design techniques for EMC – Part 5      © Cherry Clough Consultants 5 March 2007          Page 21 of 25
Figure 5K shows the common termination techniques. Classical RF termination is still often used for
high-speed signals such as fast backplane systems.




Where signals are restricted to a single PCB, series (source) termination may be used at the driver end
of a transmission line, with the resistor chosen so that in series with the impedance of the output driver
it matches the line’s Z0. This method has the advantage of consuming little power, and is most suitable
for lines with a single load device at their far end. Where other loads exist along the length of the line
they experience "reflected wave switching" and their response may need to be slowed to prevent false
clocking.
Parallel (shunt, or load) termination at the very far end of a line is used where there are a number of
devices spread along the length of the line and they need to respond most quickly, and achieves
“incident wave switching”. Figure 5K shows the termination resistor connected to the 0V plane, but
some logic families use other reference voltages (e.g. the positive plane for ECL). Parallel termination
dissipates a lot of power, and may also load some IC outputs too heavily.
Alternative types of parallel termination include "Thévenin" and RC. Thévenin uses resistor values
designed so that their parallel resistance is Z0 and they would provide a DC voltage at their junction
equal to the average line voltage, to minimise power dissipation. Thévenin termination needs a
properly decoupled power plane at all frequencies of concern so needs decoupling capacitors nearby.
RC termination uses capacitor values between 10pF and 620pF (typically) and only terminates the line
for high frequencies. Because of the problems of capacitors (discussed earlier) it may be more difficult
for an RC termination to equal the highest frequency performance of a parallel resistor or Thévenin
termination.
"Active termination" uses a voltage regulator to drive an additional power plane at the nominal
average value of the digital signals. A parallel line termination connects to this plane, which must be
properly decoupled for the frequencies of concern. Electrically equivalent to the Thévenin method,
this can save power by running the voltage regulator (which needs to be able to source as well as sink
current) in Class AB.
Where a line is driven bi-directionally the compromise position for terminating resistors (series or
parallel) is in the centre of the line, so such lines should always be kept very short and may not be able
to run as fast as the device speeds may suggest. Series terminations at all possible drivers may be used
instead of series termination at the centre of the line, but this may not give good signal integrity unless

Design techniques for EMC – Part 5       © Cherry Clough Consultants 5 March 2007            Page 22 of 25
all the lines concerned are very short. Parallel termination at both ends of the line can give very good
performance and allows the highest data rates, but drivers must capable of driving the resulting lower
impedances, and power dissipation will also increase. Parallel (or Thévenin or active) termination at
both ends is used for serial or parallel data cables such as SCSI and Ethernet.
When “star” connecting a number of individual series-terminated transmission lines, either use one
termination resistor chosen so that the total source resistance equals the parallel combination of all the
starred lines, or else use one resistor to match each line. The latter technique should be better. The star
configuration may also be used to drive multiple parallel-terminated lines. In either case, the signal
source must be capable of driving the parallel combination of all the lines' Z0s.
It is generally better to choose higher values of Z0 to reduce signal currents and reduce radiation from
the traces. Many ordinary CMOS or TTL ICs were never designed for driving transmission lines, and
have neither the drive capability or an output impedance that is equal for both sourcing and sinking.
Such devices may be able to use series, Thevenin, RC, or active terminations on high-impedance lines,
but the best method to use, and the line impedance, may be difficult to predict for a given logic family.
However, an increasing number of devices are becoming available to drive transmission lines, and the
increasing range of LVDS and similar devices is making clock and bus driving much easier and easing
EMC problems. Backplane bus driver ICs are available with 25Ω output impedances, suitable for
“star” driving four individual 100Ω, or six 150Ω lines. Some devices now have on-chip DC/DC
converters which cause their unloaded outputs to achieve double the correct logic levels, so that when
operated into a classically terminated line the received logic levels are correct.
5.6.5    Layer "stack up"
The above section on decoupling shows it is good EMC practice to provide 0V and power planes on
adjacent layers and to maximise their capacitance by using a thin dielectric (say 0.15mm) between
them. The above section on transmission lines shows that proximity to a reference plane is important
for high-speed traces. We can put this all together to decide how to stack up our PCB layers.
Four-layer PCBs often have their layers stacked as follows:
1)      Microstrip transmission lines and other critical signals
2)      0V plane
3)      +5V plane
4)      Non-critical signals
Where more signal layers are required, a 0V and power plane "core" should be retained. Additional
layers of high-speed signals may need additional 0V planes to be added, but high-speed clocks and
data busses and similarly aggressive or very critical traces should not swap layers.
Here is one of a number of possible stack-ups for an 8-layer computer motherboard:
1)      0Vplane
2)      Most critical “offset striplines” and other signals, routed at 90° to layer 3) to reduce crosstalk
3)      Most critical “offset striplines” and other signals, routed at 90° to layer 2) to reduce crosstalk
4)      0V plane
5)      +5V plane
6)      Non-critical signals routed at right angles to layer 7) to reduce crosstalk
7)      Less critical “offset striplines” and other signals, routed at 90° to layer 6) to reduce crosstalk
8)      0V plane
5.6.6    Joints, stubs, and buffers
The above has treated transmission lines as if they were all point-to-point connections, so we need to
address bussed systems such as RAM arrays, and situations where several cards interconnect at high
speeds, such as backplane systems.



Design techniques for EMC – Part 5       © Cherry Clough Consultants 5 March 2007             Page 23 of 25
A length of trace that springs off from a joint with the main trace is called a ‘stub’. For memory arrays,
the usual PCB layout technique is to route busses horizontally on one layer, ‘via-d’ through to another
layer with vertically routed stubs to connect to the array devices. To preserve the transmission line the
electrical length of the stubs must be kept to under one-eighth of the rise time (and preferably much
less). Don’t forget that the important parameter is the real switching rate of the signals, not the data
sheet specification of the drivers. If in doubt, assume the drivers switch four times faster than their
data sheet maxima.
The stub length used for the calculation should include the distance from the end of the trace (the IC’s
soldered pin) to the centre of the IC itself. Where the permissible stub length is too short for traditional
‘horizontal and vertical’ array routing, daisy chain routing should be used instead. Daisy chain routing
is generally better for high-speed signals in any case, especially when the traces remain all on one
layer. Daisy chain routing means that the bussed traces go from the source directly to each load in
turn. Abrupt changes in trace direction should be avoided, with gentle curves or large chamfers used
instead. In an incident wave system, the daisy-chained traces would end in the parallel, Thevenin, RC,
or active termination resistors.
When electrically long stubs can’t be avoided, buffers should be fitted close to the main trace to
minimise the stub lengths. This is often used in backplane systems, where a number of plug-in cards
must all run from the same clock lines and data busses, as shown in Figure 5L. The clock buffers must
all be fitted very close to the backplane board connectors, and as signal speeds and data rates increase
it is more common to find that matched-impedance backplane connectors are needed. Where a plug-in
card only has one or two ICs that need to connect to the backplane clock and data lines, by placing
them close the backplane connector it may be possible to do without the buffers.




Buffering is also a good technique for reducing the loading on a transmission line. For example, where
there are ten plug-in cards each with ten ICs, all receiving one signal, their combined load capacitance
can be around 400pF. The signal and return currents for this high value of capacitance have a long
way to flow, increasing the likelihood that they will create EMC problems. Buffering the signal at
each card means that the main line is only loaded by around 40pF, while the signal and return currents
for the ten devices on each card now flow only in that card, improving signal integrity and reducing
EMC problems.




Design techniques for EMC – Part 5       © Cherry Clough Consultants 5 March 2007             Page 24 of 25
Carrying high-speed signals through connectors and backplanes, it is important (vital for transmission
lines) to maintain the same physical structure. For example, striplines in plug-in boards should be
continued as striplines in the backplane, (although it is possible with some degradation in signal
integrity to swap from one type of transmission line to another as long as the trace dimensions
maintain the same Z0). Where transmission lines entering a backplane connector are routed against a
power plane, that power plane should be continued through the connector into a power plane in the
backplane and then to the associated power planes in the other cards using that signal. The
interconnections between the power planes in the boards and the backplane should be designed in the
same way as for the 0V return planes. Some boards may find that their optimum backplane connector
pinning needs to be: 0V, signal 1, +5V, signal 2, 0V, signal 3, +5V, signal 4, 0V, ….etc.
5.6.7    Segregation in backplane systems
Section 5.1 above said high-speed devices should be kept in the middle of their segregated area, well
away from any PCB or reference plane edges, or connectors. The backplane system described above
and in Figure 5L places the fastest ICs close to the backplane connector but does not compromise the
earlier rules if the backplane is designed to be an extension of the plug-in boards at high frequencies.
This requires RF bonding the reference planes in the backplane to the corresponding reference planes
in the plug-in boards, so that at the highest frequency of concern there appears to be no impedance
discontinuity between them. Using shielded connectors helps - their shields should bond their mating
halves to each other in 360° (refer to Part 2 of this series), and also bond all along their length to the
0V reference plane on both sides. Whether shielded connectors are used or not, there should be one
signal return pin for every one or two (at most) signal or power pins in the connector, and these return
pins should be spaced fairly regularly along the entire length of the connector. Most designers would
place the return pins according to a regular scheme, but there is some evidence that a randomised
allocation can have benefits. Impedance-matched connectors will almost always have a return pin
alongside every signal pin, in any case.
It is important to make sure that all the high-speed devices associated with the backplane connector are
closer to the middle of the connector, and do not go near to the outer edges of the boards, near the ends
of the connector. It is best if the backplane connector extends to occupy the entire length of the card
edge, but if it can’t it should still extend well to both sides of the area of the high-speed devices
associated with the backplane connector.

5.7     Useful references
[1]     M. Montrose, EMC and the Printed Circuit Board, design, theory, and layout made simple,
        IEEE Press, 1999, ISBN 0-7803-4703-X
[2]     IEC 61188-1-2 : 1998 Printed Boards and Printed Board Assemblies – Design and use. Part
        1-2: Generic Requirements – Controlled Impedance, www.iec.ch.
[3]     IPC-2141, Controlled Impedance Circuit Boards and High Speed Logic Design, Institute for
        Interconnecting and Packaging Electronics Circuits, April 1996, www.ipc.org.
[4]     Tim Williams, EMC for Product Designers 3rd edition, Newnes 2001, ISBN: 0-7506-4930-5,
        www.newnespress.com.
[5]     H W Johnson and M Graham, High Speed Digital Design, a Handbook of Black Magic,
        Prentice Hall, 1993, ISBN 0-13-39-5724-1.




Design techniques for EMC – Part 5      © Cherry Clough Consultants 5 March 2007            Page 25 of 25


==========================================
FILE: High-Speed PCB Design Guide.pdf
==========================================

TITLE PCB
High-Speed
 Design Guide
    Foreword

                                   Why would we write on a topic that has
                                   been written about numerous times? What are
                                   we trying to say that is different from what has
                                   already been said? Through this design guide,
                                   we make an attempt to convey the design
                                   aspects from a manufacturing perspective and
                                   the fine details that make a big impact - not just

     the theoretical, but also the practical elements. We started offering design layout
     services because, for our customers, it comes down to completing the project on
     schedule and knowing that the design will work in thousands as well as in ten-
     piece prototypes.

     The impractical design decisions made at the initial design stage will eventually
     get baked into the prototype, stay through the lifecycle of the product, and
     inadvertently cause quality defects and/or increase costs over the long term.
     Yes, a design review can help! But how often do you see a PCB manufacturer at
     the table in a design review? And it’s not a one-meeting solution.

     Designing an optimum PCB that is manufacturable requires immense practical
     experience. This practical experience is gained from processing thousands of
     designs and understanding the ramifications of placing a via too close to a trace,
     selecting a suitable component instead of an obsolete one, designing a stack-up
     to reduce the EMI issues from the outset and much more.

     We have tried to distill the basics of what we believe every electrical engineer and
     designer should perceive when it comes to high-speed PCB designing. We will
     address most of the important design techniques and hope that we will be able to
     impart something that you didn’t know before.


     Amit Bahl
     Director of Sales & Marketing at Sierra Circuits
     email: amit@protoexpress.com



2                      Copyright Sierra Circuits Inc., 2020
Table of Contents
1. Introduction to High-Speed PCB Design......................................8

         1.1 PCB Design Flow in General............................................................ 10
         1.2 How Does One Decide if it is a High-Speed Design?........................ 10
         1.3 Complexity of Design................................................................... 12
         1.4 High-Speed Design Considerations.............................................. 13
2. Signal Integrity for PCB Designer................................................ 14

         2.1 What Is Signal Integrity?.................................................................14
         2.2 Need for Signal Integrity..................................................................15
         2.3 What Leads to Signal Integrity Issues in a PCB?...............................16

		2.3.1 Impedance discontinuities....................................................... 16           16
		 2.3.2 Reflections, Ringing, Overshoot and Undershoot................... 17                         17
		 2.3.3 Crosstalk................................................................................... 19
		 2.3.4 Via Stub.................................................................................... 20
                                                                                                      20 		
   2.3.5 Skew and Jitter......................................................................... 21  21
		2.3.6 Signal attenuation.................................................................... 21     21
		 2.3.7 Ground Bounce......................................................................... 21    21
		 2.3.8 Power and Ground Distribution Network.................................22
		 2.3.9 EMI Noise...................................................................................22
			
3. PCB Transmission Lines and Controlled Impedance....................23

  3.1 PCB Transmission Lines..................................................................23               23
			
		      3.1.1 What is a PCB Transmission Line? .........................................23                     23
        3.1.2 When is an Interconnection Treated as a Transmission
		            Line?...........................................................................................26

         3.2. The Characteristic Impedance of a Uniform Transmission
              Line    .........................................................................................26
                                                                                                               26
         3.3 Controlled Impedance Structures in PCBs........................................27                 27
		3.3.1 Single-Ended Microstrip............................................................28
		 3.3.2 Single-Ended Stripline ..............................................................28
                                                                                              28
		 3.3.3 Microstrips Differential Pair......................................................29
		 3.3.4 Striplines Differential Pair.........................................................29
                                                                                              29


                                       www.protoexpress.com                                                         3
         3.4 How to Control the Impedance................................................................30
                                                                                                         30
         3.5 Design and Manufacture of Controlled Impedance Lines........................ 30             30

             3.5.1 Determining Which Signals Require Controlled Impedance................. 30
                                                                                           30

    		       3.5.1.1 Communication Protocols Requiring Controlled 			
    			               Impedance Lines...................................................................... 31
    		       3.5.1.2 Annotate the Schematic with Impedance
    				 Requirements................................................................. 31                            31
      3.5.2 Routing Differential Pairs........................................................................ 32
      3.5.3 Placing Components, Vias, and Coupling Capacitors........................... 33
      3.5.4 Length Matching...................................................................................... 34 34
      3.5.5 Reference Layers for Return Path of Controlled Impedance
    		             Signals.......................................................................................... 36
                                                                                                                     36
      3.5.6 Errors to Avoid When Designing for Controlled Impedance.............. 39

    		       3.5.6.1 Distinguishing Controlled Impedance Traces
    				                    from Other Traces ......................................................... 39           39
    		       3.5.6.2 Traces Overpassing Split Planes............................................. 40                 40
    		       3.5.6.3 Traces with no Reference Ground Plane ................................ 40
      3.5.7 Controlled Impedance Design Checklist................................................ 41
      3.5.8 Common Mistakes to Avoid in a Stack-Up for Controlled			
            Impedance............................................................................................... 41
                                                                                                                     41
      3.5.9 Manufacturing Tolerances, Measurements, and Coupons................... 41                                41

    			                         3.5.9.1 How Sierra Circuits Deals with Controlled
    			                                 Impedance...................................................................... 4141
    			                         3.5.9.2 Impedance Failure Analalysis
                                         During MF....................................................................... 42
                                                                                                                          42
    		                          3.5.9.3 The Sierra Circuits Impedance Calculator.................... 43

    4. PCB Stackup Design & PCB Technology....................................... 45
                                                                                  45
          4.1 PCB Stackup Design.............................................................................. 45
                                                                                                               45

             4.1.1 Construction of a Stackup...................................................................... 45      45
             4.1.2 Stackup Design........................................................................................ 45
                                                                                                                           46
             4.1.3 Best Way to Do a Stackup for
                   High-Speed Signals................................................................................. 46  46
             4.1.4 Lamination Selection............................................................................... 48  48
             4.1.5 Stackup Design Material Parameter 			                                              			
                   Considerations......................................................................................... 48
                                                                                                                           48
             4.1.6 Propagation Velocity............................................................................... 48  48
             4.1.7 Planning High-Speed PCB Stackup........................................................ 49

4                                   Copyright Sierra Circuits Inc., 2020
       4.2 Selecting High-Speed Materials..........................................................49

		4.2.1 PCB Material Categories..............................................................50 50
		 4.2.2 Signal Loss and Operating Frequency........................................ 50         50
		 4.2.3 Non-PTFE Materials.................................................................... 51
                                                                                                51
		 4.2.4 Stackup Guidelines for Mixed Materials.................................... 53          53
		 4.2.5 Hybrid Stack-up Guidelines..........................................................53

       4.3 Effect of Different Styles of Fibreglass Weaves on Impedance............54             54
       4.4 Terms and Definitions for Stackup......................................................56
                                                                                                  56


5. EMI and EMC.................................................................................57
                                                                                               57
       5.1 Electromagnetic Compatibility (EMC)..................................................57
       5.2 What is EMC or EMI?......................................................................... 57  57
       5.3 Sources of EMI.................................................................................. 58
                                                                                                            58
       5.4 Best PCB Design Practices for EMC....................................................58		        58

6. Power Integrity..............................................................................59
                                                                                                59

       6.1 Introduction - What is Power Integrity?............................................... 59
       6.2 PDN Block Diagram............................................................................ 60
                                                                                                         60
       6.3 PDN Noise and its Causes.................................................................. 60 60
       6.4 Analysis and Design of PDN...............................................................62   62
			6.4.1 Target Impedance ZPDN and its Frequency 			
			       Spectrum........................................................................... 63
                                                                                              63
			 6.4.2 Estimation of Actual ZPDN over the Bandwidth............ 65                         65

				                             6.4.2.1 Voltage Regulator Module (VRM)...................... 65
				                             6.4.2.2 Actual Behavior of a Real Capacitor.................. 65       65
				                             6.4.2.3 Role of Bulk Capacitors...................................... 66
                                                                                                        66
				                             6.4.2.4 Ceramic Chip Decoupling Capacitor.................. 68         68
				                             6.4.2.5 Trace Loop Inductance....................................... 7070
				                             6.4.2.6 Via Loop Inductance........................................... 71
                                                                                                        71
				                             6.4.2.7 Planes Loop Inductance..................................... 71 71
				                             6.4.2.8 Spreading Loop Inductance............................... 72    72
				                             6.4.2.9 Capacitance of a Pair of Planes........................ 72     72
				                             6.4.2.10 IC Package and Internal Die............................ 73

       6.5 Power Integrity, Signal Integrity, and EMI are related......................... 73		
                                                                                           73



                                   www.protoexpress.com                                                          5
    7. High-Speed PCB Layout Design......................................................74
                                                                                         74
            7.1 Footprint Design for High-Speed Boards.............................................. 74

    		               7.1.1 Component Footprint Shapes........................................................74
                                                                                                             74
    		               7.1.2 Pad Shapes for High-Speed PCB Design...................................... 74     74

            7.2 Component Placement ................................................................................ 75

    		 7.2.1 Component Placement Strategy....................................................75
    		 7.2.2 Floor Planning.................................................................................75		
                                                                                                            75
    		        7.2.2.1 Wonders that a Floorplan can do.................................. 76
    			       7.2.2.2 Component Placement Considerations in High-
    				              Speed PCBs ..................................................................... 76   76
    		 7.2.3 Termination Resistors.................................................................... 78   78
    		 7.2.4 Component Orientation..................................................................79      79
    		 7.2.5 SMT and Through-Hole Component Placement...........................79                          79
    		 7.2.6 Via Shapes Considerations............................................................79        79
    		 7.2. 7 Component Selection and Placement..........................................80                 80
    		 7.2.8 Separating Analog and Digital Circuits..........................................80             80
    		 7.2.9 Ground Plane Isolation................................................................... 81   81
    		 7.2.10 Surge Suppressors Placement.................................................... 81            81

            7.3 High-Speed Routing Strategy .............................................................. 82

    		7.3.1 Best Routing Practices for High-Speed Routing...........................82
                                                                                    82

    		                        7.3.1.1 Ground and Power Planes...............................................82        82
    			                       7.3.1.2 Polygon Voids..................................................................84
                                                                                                                      85
    			                       7.3.1.3 Trace Bend Geometry......................................................85     85
    			                       7.3.1.4 Signal Proximity...............................................................86
                                                                                                                      86
    			                       7.3.1.5 Differential Pair Signals.................................................. 87  87
    			                       7.3.1.6 Length Matching..............................................................88 88
    			                       7.3.1.7 Signal Return Path...........................................................93 93
    			                       7.3.1.8 Split Plane Approach.......................................................98   98
    			                       7.3.1.9 Virtual Split Approach......................................................99  99
    			                       7.3.1.10 Components Selection for High Speed Design...........100                       100


    			




6
        7.4 Vias and Microvias.............................................................................. 101

		7.4.1 Different Types of Vias................................................................. 101

			                       7.4.1.1 Through-hole Vias.......................................................... 101
			                       7.4.1.2 Blind Vias........................................................................ 101
			                       7.4.1.3 Buried Vias...................................................................... 102
                                                                                                                     102
			                       7.4.1.4 Microvias......................................................................... 102
                                                                                                                     102
			                       7.4.1.5 Via-In-Pad....................................................................... 103

				                                7.4.1.5.1 What is Via-in-pad?.......................................... 103

		7.4.2 PCB Design Tips for Vias.............................................................. 104        104
		 7.4.3 Via Design...................................................................................... 105
                                                                                                          105
			                       7.4.3.1. Class Type and Minimum Drill and Pad		                                   		
			                                Requirements................................................................ 106
                                                                                                                106
			                       7.4.3.2 Current carrying capacity of Vias................................... 107      107

		               7.4.4 Microvias Design........................................................................... 108

8. Appendix....................................................................................... 109

 8.1 High-Speed PCB Design Checklist...................................................... 109
 8.2 Sierra Circuits Deliverables................................................................. 111
                                                                                                   111
 8.3 Sierra Circuits PCB Design Capabilities............................................... 111    111
		




                                                                                                                           7
    1. Introduction to High-Speed PCB Design

    In the modern world, complexity of electronic products has increased due to the
    demand for higher performance such as faster data transfers, better image
    processing, higher computing power, and greater functionality. This has resulted in higher
    component count in PCBs, higher signal frequencies of the order of 5GHz and more, high-speed
    interfaces such as HDMI, DDR-3/4, Gigabit ethernet, and HDI (High Density Interconnect) PCB
    technologies having blind and buried microvias. In the future, the demand for even higher
    performance from computers, mobiles, and communication devices would require PCBs to
    be designed to cope with even higher speed of operation and higher component densities.

    This booklet addresses the high-speed PCB design challenges and the best practices to
    be followed to meet those challenges.

       It may seem obvious to state that high-speed design requires special care which is
      generally not needed in low speed design. High-speed designs are also usually more
                                      complex nowadays.


    1.1 PCB Design Flow in General

    To state very briefly, an electronic product goes through different stages from product de-
    sign concept, to product requirements and specifications document (including the list of key
    electronic components/devices and key communication interfaces to be used), to circuit
    schematic design, to PCB design, and finally to the PCB manufacturing and PCB assembly.




8                           Copyright Sierra Circuits Inc., 2020
Definition of product concept, writing the detailed product requirements, and de-
sign of the circuit schematics are mainly the responsibilities of a system designer.

During schematic entry, care needs to be taken while breaking up the design into
functional blocks, bringing all related components on one page and also clear-
ly marking the high-speed connections and power connections. For example,
Ethernet related components, which run typically at 50MHz or more, are accu-
mulated on one page of the schematic design. The differential and single end-
ed impedance controlled lines must be clearly marked on the schematic. Also,
the high current traces and voltages need to be designated. This will help the
PCB designer to decide the component placement strategy and routing strategy.

As schematics are finalised, the BOM should also be validated and approved by the
system designer.

Once these are done and made available to the PCB designer, then the PCB de-
sign plan needs to be worked out. As a first step, the high-speed nature and
complexity of the design must be properly assessed. Based on these assess-
ments, the appropriate PCB technology is chosen and a stackup is designed.

The PCB layout design is the next stage which includes components foot-
prints creation, setting of the DRC parameters such as trace width, trace spac-
ing, via padstacks, identifying controlled impedance traces and setting their
rules, component placement, and routing. As the placement and the routing are
done, all the best practices to reduce signal integrity problems and EMI are con-
sidered. All these concepts will be discussed in detail in subsequent sections.

Once the PCB design is complete, reviewed, and approved by all the stakeholders, it
goes for PCB fabrication and ultimately PCB assembly.

It is extremely important that the PCB designers ensure that the design is man-
ufacturable and can be successfully assembled. So, before committing to
manufacturing, the designers should thoroughly review the design from a De-
sign for Manufacturability (DFM) and Design for Assembly (DFA), perspective.




                           www.protoexpress.com                                        9
     1.2 How Does One Decide if it is a High-Speed Design?

     To execute a successful PCB design for a circuit board, one has to first determine if
     it is in fact a high-speed design. If it is a high-speed design, then the PCB designer
     would need to take special care during the design process; and we would call them
     as high-speed design considerations – the main subject of this booklet.

     1. In most cases, based on their past experience, the system design engineering
     team may determine that this would be a high-speed design. The design team must
     accept this, and can verify it by means of the process described below.

     2. Occasionally, it might not be explicitly stated that the design is a high-speed one;
     in that case the design team should determine if the design involves high-speed.

     In order to decide if the PCB requires high-speed design, we follow a two step
     process:

     Firstly, the system designers must state the values of one or more of the following
     parameters of design (these characterise the high-speed nature of the circuitry):

     •   The maximum frequency (Fm)content in the highest speed signals in the circuit.
     •   The fastest rise (or fall) time (Tr) of the digital signals in the circuit.
     •   The maximum Data Transfer Rate (DTR) applicable for signals in the circuit.

     A good news is that one does not need all the above three parameters, even one will
     be sufficient, as it is possible to make an approximate estimate of the remaining two
     parameters by using the following formula:

                                   Fm ≈  0.5 / Tr    ≈   2.5 DTR
     Our objective here is to determine the highest signal frequency content i.e. Fm.

     Examples:

     (Ex.1) Let the fastest rise time of the digital signals be given as: Tr = 100ps (pi-
     co-seconds). Then, Fm = 0.5 / (100 x 10-12 sec.) = 5 x 109 Hz = 5GHz.

     (Ex.2) Let the highest data transfer rate be given: DTR = 5.0Gbps (Gigabits per sec-
     ond). Then Fm = 2.5 x DTR = 2.5 x 5.0 x109 bps = 12.5GHz.

     As a rough rule of thumb, if the highest frequency content in the signals – Fm – is
     greater than 50MHz, it should be treated as a high-speed design.




10                           Copyright Sierra Circuits Inc., 2020
While the above rule of thumb is fine in most cases, there are special cases where
even Fm = 60MHz may not need high-speed design considerations, and there may be
some cases where even 40MHz Fm may need high speed design care.

If we want to be more certain, we carry out the following additional steps:

Secondly, we need to determine the wavelength (λm) on the PCB of the electrical
(electromagnetic to be precise) signals for a given frequency, in our case Fm.

                            Wavelength for Fm: λm  = v / Fm
             Where: v = speed of signals on a PCB  ≈ (11.8 inch/ns) I
           Where: Ereff = Effective dielectric constant of the PCB material
                             Propagation Delay: tpd = 1/ v
The speed and propagation delay for some of the commonly used PCB materials are
mentioned in the following table:




Knowing speed ‘v’ from above, we can calculate the wavelength ‘λm‘ for a given
frequency Fm .

 Now the rule of thumb: If the length of an interconnection l < λm /12, then we do not
 need to consider it as a high speed interconnection. If l ≥ λm /12, then we do need to
                      consider it as a high speed interconnection.



                             www.protoexpress.com                                         11
     There is one caveat here: while mostly, we would be considering l here
     for the length of PCB interconnection, it may happen the particular inter-
     connection goes outside the PCB through a connector to a long cable; in
     that case we need to consider the entire length of the interconnection.

     Let us illustrate by some examples:

     Assuming PCB material FR4 (370HR), we have v = 6.9 in/ns (microstrip) and 5.9 in/
     ns (stripline).

     For Fm = 50MHz, minimum λm = 5.9 in/ns / 50MHz = 118 inch. Here Minimum λm /12
     = 9.8 in. Hence, if interconnection length l < 9.8 in, (which is likely to be the case if PCB
     size is < 8”x 8” ) we may consider it as low speed, but if l ≥ 9.8 in, which maybe the
     case for a PCB size of ≥ even 6”x 8”, we must consider it as high-speed one.

     For Fm = 100MHz, minimum λm = 5.9 in/ns / 100MHz = 59 inch. Here Minimum λm
     /12 = 4.9 in. Hence, if interconnection length l < 4.9 in, ( which is likely toi be the case if
     PCB size is around 2”x 3” ) we may consider it as low speed, but if l ≥ 4.9 in, which will
     be likely for a PCB size of around 4”x5” or greater, we must consider it as high-speed
     one.

     For Fm ≥ 1GHz, minimum λm ≤ 5.9 in/ns / 1GHz = 5.9 inch. Here Minimum λm /12 ≤
     0.5 in. In any PCB, the interconnection length is likely to exceed this; Hence, we must
     consider it as high-speed one.

     We thus see that the PCB size and therefore the interconnection lengths also play
     an important role in determining which interconnections are to be treated with high-
     speed design considerations.

     1.3 Complexity of Design
     In addition to high-speed design considerations, we also need to assess the
     complexity of the design since it also requires special design considerations.

     The prime factors that play a crucial role in the design complexity are:

     •   Component density components count/size of board
     •   Routing density required
     •   Pitch of high pin count devices like BGAs :
             Fine pitch BGAs (0.5mm, 0.4mm pitch) with >16 pins count. These invariably
             require blind and buried vias for proper IO fanouts.
             Number of pins in a BGA exceeds 250

     •   Types of interfaces: HDMI, Gigabit ethernet, DDR3, etc.
     •   PCB technology to be used:

12                            Copyright Sierra Circuits Inc., 2020
            Small form factor board (1”x 1”) with more than 50 components
            Larger size boards with more than 500 components
            Designs requiring impedance control 100Ω differential lines, 50Ω single-
            ended lines, and more than 500 components
            Any design which takes more than two weeks to layout
            The density of component pins exceeds 110 pins per square inch (17 pins
            per square cm)
            The density of component parts exceeds 10 parts per square inch (1.55
            per square cm)
            The circuit requires mixed technology of digital, radio frequency (RF), or
            analog
            The board requiring mixed materials for construction
            The board has which has stringent electrical constraints
            Boards having layers 8 to 12 layers or more, depending on the complexity

1.4 High-Speed Design Considerations
There are special considerations one needs to take when designing a high-speed PCB:

1. All high-speed interconnections need to be designed as transmission lines and
not just as point to point interconnections to reduce signal distortion, crosstalk and
electromagnetic radiation.
2. All causes of signal degradations need to be kept under control within acceptable
limits.
3. Adequate PCB technology is to be chosen so as to meet the demands of compo-
nent density, wiring density, communication protocols, and complex devices.
4. All causes of unacceptable levels of electromagnetic radiation need to be kept
under control.
5. Adequate power integrity has to be maintained in spite of high-frequency noise
on power and ground rails in high-speed circuits – ensuring adequate power supply
voltages are maintained at all the electronic devices and components for them to
function properly.
6. Adequate and special PCB routing schemes need to be adopted to meet the de-
mands of component density, wiring density, communication protocols, and complex
devices.

The first three of the above points are usually covered under the disciplines called
Signal Integrity and PCB stackup design, the fourth point is covered under the disci-
pline called EMI,

the fifth is covered under Power Integrity, and the sixth under Special layout routing
techniques.

We will now discuss these in requisite details in the following sections and chapters
of this booklet.

                             www.protoexpress.com                                        13
     2.Signal Integrity for PCB Designers
     The moment you hear the term signal integrity, you might start yawning. But once you
     have an understanding of it, you will be a master in this field for sure.

     Let’s get straight to the point.

     2.1 What is Signal Integrity?
     Signal Integrity (SI) signifies the signal’s ability to propagate without distortion. Signal
     integrity is nothing but the quality of the signal passing through a transmission line.

     Fundamentally, signal integrity issues must be taken care of during the PCB design
     phase. Once the PCB has been designed, there is little one can do to improve signal
     integrity.

     A simple analogy for your understanding:

     AM signal -> not so clear (distorted signals)

     FM signal -> more clear (better signal integrity)

     To be more descriptive, signal integrity is the measurement of the quality of an elec-
     trical signal typically in electronic printed circuit board. In digital electronics, a stream
     of binary values is represented by a voltage (or current) waveform. However, digital
     signals are fundamentally analog in nature, and all signals are subject to effects such
     as noise, distortion and loss.




                                   A




                                   B




                                   C




14                            Copyright Sierra Circuits Inc., 2020
Over short distances and at low bit rates, a simple transmitting line can transmit with
sufficient fidelity. At high bit rates and over longer distances, transmitting lines can
have different effects and degrade the electrical signal to the point where errors occur
and the system or device fails.

However, as speed increases, high-frequency effects take over and even the short-
est lines can suffer from problems such as ringing, crosstalk, reflections, and ground
bounce, seriously hampering the integrity of the signal.

Figure A above shows an ideal signal. Figure C shows the effect of noise on an ideal
signal. In the following sections, we discuss the effects of a noisy signal on data integ-
rity. In short, a noisy signal could result in bad data and therefore faulty operations.


2.2 Need for Signal Integrity
Signal integrity signifies the signal’s ability to propagate without distortion.

When we have signal integrity issues in a PCB, it may not work as desired. It may work
in an unreliable manner – works sometimes and sometimes not. It may work in the pro-
totype stage, but often fail in volume production; it may work in the lab, but no reliably
in the field; it worked in older production lots, but fails in new production lots, etc.

A signal is said to have lost its integrity when:

•   It gets distorted, i.e. its shape changes from the desired shape
•   Unwanted electrical noise gets superimposed on the signal, degrading its signal to
    noise (S/N) ratio
•   It creates unwanted noise for other signals and circuits on the board

A PCB is said to have requisite signal integrity when:

•   All signals within it propagate without distortion
•   Its devices and interconnections are not susceptible to extraneous electrical noise
    and EMI – electromagnetic interference – from other electrical products in its vicin-
    ity as per or better than regulatory standards
•   It does not generate or introduce or radiate EMI in other electrical circuits/cables/
    products either connected to it or present in its vicinity, as per or better than regula-
    tory standards




                               www.protoexpress.com                                             15
     2.3 What Leads to Signal Integrity Issues in a PCB?
     Perhaps the most important cause of signal integrity issues in a PCB is faster signal
     rise times. When circuits and devices are operating at low-to-moderate frequencies
     with moderate rise and fall times, signal integrity problems due to PCB design are rarely
     an issue. However, when we are operating at high (RF & higher) frequencies, with much
     shorter signal rise times, signal integrity due to PCB design becomes a very big issue.

                        SIGNAL EDGE MOVING ACROSS A TRACE IN HIGH-SPEED




                                                Rise time is shot compared
                                                to time of flight


     Factors that contribute to signal integrity degradation:

     Generally speaking, fast signal rise times and high-signal frequencies increase signal
     integrity issues.
     For analytical purposes, we can divide various signal integrity issues into the following
     categories:

     2.3.1 Impedance discontinuities

     As we mentioned earlier, if the signal encounters a discontinuity in impedance during
     its travel, it will suffer reflections which cause ringing and signal distortion. Discontinu-
     ities in the line’s impedance will occur at the point of encountering one of the following
     situations:

     •   When a signal encounters a via in its path.
     •   When a signal branches out into two or more lines.
     •   When a signal return path plane encounters a discontinuity, like a split.
     •   When line stubs are connected to signal lines and are 1/4th the wavelength of the
         switching speed of the driver.
     •   When a signal line starts at the source end.
     •   When a signal line terminates at the receiver end.
     •   When signal and return paths are connected to connector pins.

     And, faster the signal rise time, greater will be the signal distortion caused by imped-
     ance discontinuities.



16                           Copyright Sierra Circuits Inc., 2020
We can minimize signal distortion due to line impedance discontinuities by:

•   Minimizing the effects of discontinuities caused by vias and via stubs by using
    smaller microvias and HDI PCB technology.
•   Reducing trace stubs lengths.
•   Routing traces in daisy chain fashion rather than multi-drop branches when a signal
    is used at more than one place.
•   Proper terminating resistors at the source.
•   Using differential signaling and tightly coupled differential pairs, which are inherent-
    ly more immune to discontinuities in signal return path planes.


2.3.2 Reflections, Ringing, Overshoot and Undershoot

What is Reflection?

When a signal is transmitted in a transmission line, some of the signal power may be
reflected back to its transmitter rather than being carried all the way along the trace to
the far end. Whenever the impedance changes in a circuit, some amount of reflection
will happen. The reflected signal will travel back until it encounters another change in
impedance and gets reflected again.

Influence of reflection:

•   Signal distortion caused by reflection
•   Overshooting and undershooting caused by reflection

How to reduce reflection noise:

•   Maintain the constant impedance
•   Maintain good ground grading
•   Use series termination resistor and place near the source point

What is Ringing?

Ringing is a voltage or current output
that oscillates like a ripple on a pond
when it’s seen on an oscilloscope. The
oscillation is a response to a sudden
change in the input signal, like turning
it on or switching.




                              www.protoexpress.com                                             17
     Daniel Beeker and Rick Hartley explained, “Ringing is the result of having the driver
     farther away from the receiver than 1/4th wavelength. This results in a first order reflec-
     tion of more than the incident wave that returns to the driver and becomes a depletion
     wave at a lower voltage going back to the receiver, until all of the energy finally either
     goes into the receiver, is converted to heat in the conductors and dielectric or mostly
     radiates.”

     Influence of ringing:

     •   Increased EMI
     •   Increased current flow
     •   Decreased performance
     •   Audible feedback



     What is Overshooting and Under-
     shooting?

     A theoretical instantaneous
     transition of signal allowed
     maximum upper and lower
     amplitude.



     Overshoot:
     When the signal transits from lower
     value to higher value and the value
     of the transit signal is more than the
     actual value, then overshoots occur.

     Undershoot:
     When the signal transits from high-
     er value to lower value and the value
     of the transit signal is more than the
     actual value, then undershoots
     occur.




18                           Copyright Sierra Circuits Inc., 2020
2.3.3 Crosstalk

One signal transmitting in one channel or circuit in a transmitting system creates an
undesired effect on another circuit or channel, as shown in the below image.




Crosstalk occurs when there is coupling of energy from aggressor signal to victim sig-
nal (typically two tracks close to each other) in terms of the interference of electric and
magnetic fields. The electric field is coupled via mutual capacitance between the sig-
nals. On the other hand, the magnetic field is coupled via mutual inductance between
the signals.

Mutual capacitance:

When two traces run parallel to each other and are separated by a dielectric they be-
have as parallel plates of a capacitor and when the traces are at two different voltages
an electric field is generated between them. Any variation of voltage in one of the traces
will induce current in the other trace due to the electric field variation. This capacitance
between two traces is called mutual capacitance.

Mutual inductance:

A trace carrying current has a magnetic field around it. If there is another trace close
to the first trace carrying current this magnetic field will couple with the second trace.
By Faraday’s law if there is a variation in current in the first trace the magnetic field will
change which will induce a voltage in the second trace. The inductance due to magnet-
ic field coupled traces is called mutual inductance.



                               www.protoexpress.com                                              19
     Techniques for decreasing crosstalk:

     •   Increase the spacing between signal lines as much as routing restrictions allow.The
         magnitude of the energy in the space is reduced by the square of the distance.
     •   When designing the transmission line, the conductor should be placed as close
         to the ground plane as possible. This couples the transmission line tightly to the
         ground plane and decouples it from adjacent signals.
     •   Implement differential routing techniques where possible.
     •   To avoid coupling, the signals should be routed on different layers orthogonal to
         each other.
     •   Reduce parallel run lengths between signals.
     Crosstalk Noise

     A fast voltage or current transition on a signal line or return path plane may couple
     onto adjacent signal lines causing unwanted signals called crosstalk and switching
     noise on the adjacent signal lines. The coupling occurs due to mutual capacitance
     and mutual inductance. In uniform transmission lines, a relative amount of capaci-
     tive and inductive coupling is comparable. If there are discontinuities in transmission
     lines, usually inductive coupling dominates, and switching noise results. And as al-
     ways, faster rise time signals create more crosstalk and switching noise.

     Crosstalk and switching noise can be reduced by:

     •   Increasing the separation between adjacent signal traces.
     •   Making the signal return paths as wide as possible, and uniform like uniform
         planes, and avoiding split return paths.
     •   Using a lower dielectric constant PCB material.
     •   Using differential signaling and tightly coupled differential pairs, which are inher-
         ently more immune to crosstalk.

     2.3.4 Via Stub

     When a routed signal starts from the top layer and ends with some inner layer, the
     remaining portion form the inner layer to the bottom layer is a via stub.

     Daniel Beeker and Rick Hartley said, “A stub is a single piece of conductor, and unless
     there is a pair of vias next to each other - one ground and one signal - or a signal via
     and a ground plane, the field does not see the stub except as very high impedance.”




20                           Copyright Sierra Circuits Inc., 2020
                                                 A via stub acts like a resonant circuit
                                                 with a specific resonant frequency
                                                 at which it stores maximum energy
                                                 within it. If the signal has a significant
                                                 component at or near that frequency,
                                                 that component of the signal will be
                                                 heavily attenuated due to the energy
                                                 demands of the via stub at its reso-
                                                 nant frequency.




2.3.5 Skew and Jitter

Signals take finite times as they travel on a PCB

                                                          TIP:
from source to receiver. The signal delays are
proportional directly to signal line lengths and
inversely proportional to signal speed on the spe-
cific PCB layers. If data signals and clock signals
                                                          Skew in a group of signal
do not match in overall delays, they would arrive
                                                          lines can be minimized
at different times for detection at the receiver,
                                                          by signal delay matching,
and this would cause signal skews; and exces-
                                                          primarily by trace length
sive skew would cause signal sampling errors. As
                                                          matching.
signal speeds become higher, the sampling rates
are also higher, and allowable skew gets smaller,
causing greater propensity for errors due to skew.

2.3.6 Signal attenuation

Signals suffer attenuation as they propagate over
PCB lines due to losses caused by conducting
trace resistances (which increases at higher
                                                         TIP:
frequencies due to skin effect) and dielectric
material dissipation factor Df. Both these losses        When signal attenuation
increase as frequency increases, therefore high-         is an important consider-
er frequency components of signals will suffer           ation, one has to choose
greater attenuation than do the lower frequency          the right type of low loss
components; this causes reduction in signal              high-speed material and
bandwidth, which then leads to signal distortion         proper control over trace
by increase in signal rise time; and excessive           geometries to minimize
signal rise time increase results in errors in data      signal losses.
detection.



                             www.protoexpress.com                                             21
     2.3.7 Ground Bounce

     Ground bounce is a form of noise that occurs during transistor switching i.e., when
     the PCB ground and the die package ground are at different voltages.

     Techniques for decreasing ground bounce:

     •   Implement decoupling capacitors to local ground
     •   Incorporate serially-connected current-limiting resistors
     •   Place decoupling capacitors close to the pins
     •   Run proper ground



     2.3.8 Power and Ground Distribution Network

     Power and ground rails or paths or planes have very low, but FINITE nonzero imped-
     ances. When devices’ output signals and internal gates switch states, currents through
     power and ground rails/paths/planes change, causing a voltage drop in power and
     ground paths. This will decrease the voltage across the power and ground pins of the
     devices. Higher the frequency of such instances, and faster the signal transition times,
     and higher the number of lines switching states simultaneously, greater is the voltage
     decrease across power and ground rails. This will reduce signals’ noise margins, and if
     excessive, would cause devices to malfunction.

     To reduce these effects, the power distribution network has to be so designed as to
     minimize the power system’s impedance:

     •   Power and ground planes should be placed as close together.
     •   Multiple low inductance decoupling capacitors should be used across power and
         ground rails and they should be placed as close to device power and ground pins as
         possible.
     •   Use device packages with short leads.

     2.3.9 EMI Noise

     EMI increases with frequency and faster signal rise times. Radiation far-field strength
     increases with frequency linearly for single–ended signal currents, and squarely for
     differential signal currents.




22                          Copyright Sierra Circuits Inc., 2020
3. PCB Transmission Lines and
     Controlled Impedance
3.1 PCB Transmission Lines

By controlling the characteristic impedance of a trace on the PCB the signal distortion
can be reduced to acceptable levels. Such traces with controlled impedances of typ-
ically 50 ohms single-ended and 100 ohms differential behave as transmission lines.

A transmission line maintains the chosen impedance, Z0, from the source to the load.
Additionally, they do not resonate no matter how long the trace runs, unlike other inter-
connections.

Transmission lines are crafted easily on PCBs by controlling materials, dimension of
the traces, and by providing accurate termination resistances at source and/or load.

3.1.1 What is a PCB Transmission Line?

A PCB transmission line is a type of interconnection used for moving signals from their
transmitters to their receivers on a printed circuit board. A PCB transmission line is
composed of two conductors: a signal trace and a return path which is usually a ground
plane. The volume between the two conductors is made up of the PCB dielectric
material.

The alternating current that runs in a transmission line usually has a high enough fre-
quency to manifest its wave propagation nature. The key aspect of the wave propaga-
tion of the electrical signals over a transmission line is that the line has an impedance
at every point along its length and if the line geometry is the same along the length, the
line impedance is uniform. We call such a line a controlled impedance line. Non-uniform
impedance causes signal reflections and distortion. It means that at high frequencies,
transmission lines need to have a controlled impedance to predict the behavior of the
signals.

It is crucial to not ignore the transmission line effects in order to avoid signal reflec-
tions, crosstalk, electromagnetic noise and other issues which could severely impact
the signal quality and cause errors.




                             www.protoexpress.com                                            23
     Transmission line examples:

     There are usually two basic types of signal transmission line interconnects used in
     PCBs: microstrips and striplines. There is a third type – coplanar without a reference
     plane but it is not very common in use.

     A microstrip transmission line is composed of a single uniform trace – for the signal
     – located on the outer layer of a PCB, and parallel to a conducting ground plane, which
     provides the return path for the signal. The trace and the ground plane are separated by
     a certain height of PCB dielectric. Below is an uncoated microstrip:




     A stripline is composed of a uniform trace – for the signal – located on the inner layer
     of a PCB. The trace is separated on each side by a parallel PCB dielectric layer and then
     a conducting plane. So it has two return paths – reference plane 1 and reference plane
     2.




24                          Copyright Sierra Circuits Inc., 2020
In addition to conventional microstrips and striplines described above, a coplanar
waveguide structure has the signal trace and the return path conductor on the same
layer of the PCB. The signal trace is at the center and is surrounded by the two adja-
cent outer ground planes; it is called “coplanar” because these three flat structures
are on the same plane. The PCB dielectric is located underneath. Both microstrips and
striplines may have a coplanar structure. Below is a coplanar microstrip waveguide
with a ground plane.




Example of a coaxial cable (which is not a PCB transmission line):
A coaxial line has a circular shape and is not a PCB transmission line. This circular
cable is composed of a central wire conductor for the signal and an outer circular con-
ductor for the return path. The space between the two conductors is filled by a dielec-
tric material. The outer conductor wire completely surrounds the signal wire. Coaxial
lines are mostly used as cables for high-frequency applications, such as television, etc.
A coaxial cable must have a uniform geometry of conductors and the properties of the
dielectric material must be uniform along the entire geometry.

                                                   It is essential to keep in mind that a
                                                   PCB transmission line is composed
                                                   of not only the signal trace but also
                                                   the return path, which is usually an
                                                   adjoining ground plane or a coplanar
                                                   conductor, or a combination of both.




                             www.protoexpress.com                                           25
     3.1.2 When is an Interconnection Treated as a Transmission Line?
     The set of electrical conductors (as stated above, at least two conductors are required:
     one for the signal and the other one for the return path, which is usually a ground plane)
     used for connecting a signal between its source and its destination is called a trans-
     mission line (and not just an interconnection) if it is not possible to ignore the time it
     takes for the signal to travel from the source to the destination, as compared to the time
     period of one-fourth of the wavelength of the higher frequency component in the signal.

     Two very important properties of a transmission line are its characteristic impedance
     and its propagation delay per unit length; and if the impedance is not controlled along
     its entire length, or the line is not terminated by the right value of impedance, signal
     reflections, crosstalk, electromagnetic noise, etc. will occur, and degradation in signal
     quality may be severe enough to create errors in information being transmitted and
     received.

     When the signal frequencies (in case of analog signals) or the data transfer rates (in
     case of digital signals) are low (less than 50 MHz or 20 Mbps), the time it will take for a
     signal to travel from its source to its destination on a PCB would be very small (< 10%)
     compared to the time period of one-fourth of a wavelength or the fastest rise time of
     a digital pulse signal. In this case, it is possible to approximate the interconnect by
     assuming that the signal at the destination follows the signal at its source at the same
     time. In such a low-speed scenario, the PCB signal can be analyzed by conventional
     network analysis techniques and we can ignore any signal propagation time or trans-
     mission line reflections, etc.

     However, when dealing with signals at higher frequencies or higher data transfer rates,
     the signal propagation time on PCB conductors between the source and the destination
     cannot be ignored in comparison to the time period of one-fourth of a wavelength or
     the fastest pulse rise time. Therefore, it is not possible to analyze the behavior of such
     high-speed signals on PCB interconnects using ordinary network analysis techniques.
     The interconnects need to be considered as transmission lines and analyzed accord-
     ingly. The calculations for the impedances are discussed in the controlled impedance
     section.

     3.2 The Characteristic Impedance of a Uniform Transmission Line
     The relationship between V(x) and I(x) as follows:



     This is defined as the impedance of the transmission line at location x. Units of Z are
     Ohms. The parameters R, L, G and C depend on the geometry (shape, width, etc.) of the
     relevant PCB conductors forming the transmission line and the properties of the con-
     ductors and dielectric materials used in the PCB.


26                          Copyright Sierra Circuits Inc., 2020
If the material and the geometrical properties are assumed to be uniform along the
length of the transmission line, and the PCB materials are considered homogeneous,
then R, L, G and C have the same value at every location along the length of the trans-
mission line. This means that the above impedance has the same value for all values
of x along the transmission line. This kind of transmission line is called a uniform trans-
mission line and its impedance is:




This is the characteristic impedance of the uniform transmission line and it is its most
important property from the signal integrity perspective. In the PCB industry, we gener-
ally refer to characteristic impedance as just “the impedance” of the transmission line.
If the PCB manufacturing process is such that we are able to control the geometry of
the PCB transmission lines within a specified tolerance range, then we could obtain the
impedance value of the PCB transmission line at every location along its length within
a specified tolerance of a desired value. This way, the PCB transmission line has a con-
trolled impedance and is called a controlled impedance PCB. If we look at an infinite
transmission line of characteristic impedance Z0 from the left side at any point, we
can see an impedance of Z0 . Therefore, if we take a finite length transmission line of
impedance Z0 and terminate it on the right by an impedance of value Z0, and if we look
at the finite transmission line from the left, it will appear as an infinite transmission of
impedance Z0 from the impedance perspective:




3.3 Controlled Impedance Structures in PCBs

PCB designs are becoming smaller and faster, with each passing day. For the proper
operation of circuits, the signals between components have to be noise-free and with-
out distortion. This can be achieved by controlling the impedance of the traces.




                              www.protoexpress.com                                             27
     What is Controlled Impedance?

     Controlled impedance is the characteristic impedance of a transmission line constitut-
     ed by PCB conductors. It is relevant when high-frequency signals propagate through
     PCB transmission lines. Controlling impedance of a PCB trace is required to propagate
     signals without distortion.
     The impedance of a particular circuit is determined by the physical dimensions and
     materials of that circuit.

     Here are some of the most widely used PCB transmission lines which require controlled
     impedance:

     3.3.1 Single-Ended Microstrip

     A single-ended microstrip is a transmission line composed of a single uniform conduc-
     tor placed on the outer layer of a PCB. The return path for signals traveling on this line
     is usually provided by a conducting plane separated from the transmission line by a
     certain height of the PCB dielectric.

                                                             H = Height of the dielectric be-
                                                             tween the trace and plane, spec-
                                                             ified in mils
                                                             W = Width of the copper trace,
                                                             specified in mils
                                                             T = Thickness of the copper
                                                             trace, specified in mils
                                                             Er = Dielectric constant of the
                                                             dielectric between the trace
                                                             and plane

     3.3.2 Single-Ended Stripline

     A single-ended stripline is composed of a uniform conductor on an inner layer of a PCB.
     It is separated on each side by a dielectric layer followed by copper planes.

                                                             H = Height of the dielectric be-
                                                             tween the trace and plane, spec-
                                                             ified in mils
                                                             W = Width of the copper trace,
                                                             specified in mils
                                                             T = Thickness of the copper
                                                             trace, specified in mils
                                                             Er = Dielectric constant of the
                                                             dielectric between the trace
                                                             and plane
28                          Copyright Sierra Circuits Inc., 2020
3.3.3 Microstrips Differential Pair

A microstrip differential pair is similar to the single-ended microstrip described earlier,
except that it has a pair of conductors separated by a uniform distance between them.

                                                            H = Height of the dielectric be-
                                                            tween the trace and plane, spec-
                                                            ified in mils
                                                            W = Width of the copper trace,
                                                            specified in mils
                                                            T = Thickness of the copper
                                                            trace, specified in mils
                                                            Er = Dielectric constant of the
                                                            dielectric between the trace
                                                            and plane
                                                            S = The separation between the
                                                            two traces of the differential
                                                            pair

3.3.4 Striplines Differential Pair

A stripline differential pair is similar to the single-ended stripline except that it has a pair
of conductors separated by a uniform distance between them.

                                                            H = Height of the dielectric be-
                                                            tween the trace and plane, spec-
                                                            ified in mils
                                                            W = Width of the copper trace,
                                                            specified in mils
                                                            T = Thickness of the copper
                                                            trace, specified in mils
                                                            Er = Dielectric constant of the
                                                            dielectric between the trace
                                                            and plane
                                                            S = The separation between the
                                                            two traces of the differential
                                                            pair




                                www.protoexpress.com                                               29
     3.4 How to Control the Impedance?

     The factors that influence impedance are the PCB materials dielectric, the trace thick-
     ness, width and height from the ground plane.

     The designer should make sure that the manufacturer has the ability to provide the right
     pattern size, position, and tolerance. The board might turn out to be useless if these
     parameters aren’t achieved.


     The two types of commonly implemented impedance controls are:


     Controlled dielectric thickness:

     The designer provides the controlled dielectric stack-up to the manufacturer. Since im-
     pedance traces are not specified here, the manufacturing focus is completely upon
     building a board within +/- 10% tolerance of the specified dielectric thickness from layer
     to layer.

     Impedance control:

     Here the impedance is controlled through the dielectric thickness, the trace width, and
     space. The manufacturer performs a test to ensure that the desired impedance can be
     achieved using TDR coupons. Some adjustments are made depending upon results
     from the first articles in order to meet the designer’s needs and the boards are manu-
     factured within the specified tolerance.

     A typical tolerance on the final impedance is +/- 10%. But Sierra Circuits is capable of
     achieving +/- 5% impedance tolerance.
     A typical tolerance on the final impedance is +/- 10%. But Sierra Circuits is capable of
     achieving +/- 5% impedance tolerance.

     3.5 Design and Manufacture of Controlled Impedance Lines

     3.5.1 Determining Which Signals Require Controlled Impedance

     When designing a board, designers should stick to strict guidelines for controlled im-
     pedance. They should study the datasheets of the integrated circuits to determine the
     specific signals that require controlled impedance. The components’ datasheets pro-
     vide precise instructions for impedance values for each group of signals. Usually, the
     data sheets mention the spacing rules and the right layers on which specific signals are
     to be routed.


30                          Copyright Sierra Circuits Inc., 2020
3.5.1.1 Communication Protocols Requiring Controlled Impedance Lines




3.5.1.2 Annotate the Schematic with Impedance Requirements

In the circuit schematics, the engineer should specify the controlled impedance signals
and the nets should be classified as differential pairs (100Ω, 90Ω or 85Ω) or single-end-
ed nets (40Ω, 50Ω, 55Ω, 60Ω or 75Ω). To make things clearer, the designer can append
N or P after the net names for differential pair signals in a schematic.

Also, the special controlled impedance layout guidelines must be specified (if any) in
the schematic or in a dedicated ”Read me” file.

In the below Altium schematic, the differential pairs have appropriate net names.




                             www.protoexpress.com                                           31
     3.5.2 Routing Differential Pairs

     The high-speed differential pair signal traces should be routed parallel to each other
     with a consistent spacing between them. Specific trace width and spacing are needed
     to calculate the specific differential impedance. The differential pairs should be rout-
     ed symmetrically. The designer should minimize areas where the specified spacing is
     enlarged due to pads or the ends. When differential pairs change layers and therefore
     change reference ground planes, ground transition vias are required which connect the
     two different ground references.




                                                                   TIP:
                                                                   Route differential pairs
                                                                   symmetrically and always
                                                                   keep signals parallel




32                          Copyright Sierra Circuits Inc., 2020
3.5.3 Placing Components, Vias, and Coupling Capacitors

The components or vias should not be placed between differential pairs even if the
signals are routed symmetrically around them. Components and vias between the dif-
ferential pair signals create discontinuity in impedance and could lead to signal integ-
rity problems. For high-speed signals, the spacing between one differential pair and an
adjacent differential pair should not be less than five times the width of the trace. The
designer should also maintain a keep-out of 30 mils to any other signals. For clocks or
periodic signals, the keep-out should be increased to 50 mils to ensure proper isolation.




                                                              TIP:
                                                              Do not place any
                                                              components or vias
                                                              between differential pairs.




If high-speed differential pairs require serial coupling capacitors, they need to be placed
symmetrically. The capacitors create impedance discontinuities, so placing them sym-
metrically will reduce the amount of discontinuity in the signal.




                                                              TIP:
                                                              Place coupling capacitors
                                                              symmetrical.




                              www.protoexpress.com                                            33
     The designer should minimize the use of vias for differential pairs, and if placed, they
     need to be symmetrical to minimize discontinuity.




                                                                    TIP:
                                                                    Do not route high-speed
                                                                    signals at plane and PCB
                                                                    borders.




     3.5.4 Length Matching

     Propagation delay of a signal in a circuit is important and it should be within the specs
     of the components. Propagation delay depends on the physical characteristics of the
     trace if width, thickness, and height of the trace are the same throughout the trace then
     propagation delay is directly proportional to the length of the trace. Thus, in a differen-
     tial pair if the delays have to be the same then their lengths should be same/matched
     as well.

     Length matching will achieve propagation delay matching if the speed of the signals
     on various traces is the same. Length matching may be required when a group of high-
     speed signals travel together and are expected to reach their destination at the same
     time (within a specified mismatch tolerance). Note that, it’s a good practice to keep all
     the high-speed signals of the same group of signals on the same layer to avoid skew
     in propagation delay.

     The lengths of the traces forming a differential pair need to be matched very closely,
     otherwise that would lead to an unacceptable delay skew (mismatch between the posi-
     tive and negative signals) and the propagation delay for the traces should be within the
     requirements of the design. The mismatch in length needs to be compensated by using
     serpentines in the shorter trace. The geometry of serpentine traces needs to be careful-
     ly chosen to reduce impedance discontinuity. The figure below shows the requirements
     for ideal serpentine traces.

     It is important to match the etch lengths of the differential pairs and add serpentine
     routing as close as possible to the mismatched ends. In the image below, the serpen-
     tine is added near the pads on the left side as they are farther apart from each other
     and hence mismatched.


34                          Copyright Sierra Circuits Inc., 2020
The serpentine traces should be placed as near as possible to the source of the mis-
match. This ensures that the mismatch is corrected immediately. In the figure below,
the mismatch occurs on the left set of vias, so the serpentine needs to be added on the
left rather than the right. Similarly, bends cause mismatches making the trace on the
inner bend smaller than the outer trace. Therefore, we need to add serpentines as close
to the bend area. If a pair has two bends closer than 15mm, they compensate each
other, hence, the addition of serpentines isn’t required.




                                                            TIP:
                                                            Add length correction to
                                                            the mismatching point.




                                                           TIP:
                                                           Place length compensa-
                                                           tion close to bend.




                            www.protoexpress.com                                          35
     When a differential pair signal changes from one layer to another using vias and has a
     bend, each segment of the pair needs to be matched individually. Serpentines should
     be placed on the shorter traces near the bend. The designer has to manually inspect
     for this kind of violation as it will not be caught in design rule checks (DRC) since the
     lengths of the total signals will be closely matched. Since the signal speed of traces on
     various layers may be different, it is recommended to route differential pair signals on
     the same layer if they require length matching.



                                                                  TIP:
                                                                  Length differences need
                                                                  to be compensated in
                                                                  each segment.



     3.5.5 Reference Layers for Return Path of Controlled Impedance Signals

     All high-speed signals require a continuous reference plane for a return path of the
     signal. An incorrect signal return path is one of the most common sources for noise
     coupling and EMI issues. The return current for high-speed signals try to follow the sig-
     nal path closely whereas the return current for low-speed signals take the shortest path
     available. Generally, the return path for high-speed signals is provided in the reference
     planes nearest to the signal layer.

     High-speed signals should not be routed over a split plane because the return path will
     not be able to follow the trace. The designer should route the trace around the split
     plane for better signal integrity. Also, the ground plane must be minimum three times
     the trace width (3W rule) on each side.



                                                                  TIP:
                                                                  Avoid routing over split
                                                                  planes.




36                         Copyright Sierra Circuits Inc., 2020
If there is absolutely no other option and a signal needs to be routed over two different
reference planes, a stitching capacitor between the two reference planes is required.
The capacitor needs to be connected to the two reference planes and should be placed
close to the signal path to keep the distance between the signal and the return path
small. The capacitor allows the return current to travel from one reference plane to the
other and minimizes impedance discontinuity. A good value for the stitching capacitor
is between 10nF and 100nF.



                                                              TIP:
                                                              Stitching capacitor is
                                                              needed when routed over
                                                              split planes. If both the
                                                              references are ground
                                                              then a trace bridge be-
                                                              tween the two grounds
                                                              placed below the signal
                                                              is a better option than a
                                                              capacitor



The PCB designer should avoid both split plane obstructions and slots in the reference
plane just underneath the signal trace. If the slots are unavoidable, stitching vias should
be utilized to minimize the issues created by the separated return path. Both pins of the
capacitor should be connected to the ground layer and should be placed close to the
signal.




                                                              TIP:
                                                              Stitching capacitor need-
                                                              ed when routing over
                                                              plane obstructs.




                             www.protoexpress.com                                             37
     When vias are placed together, they create voids in reference planes. To minimize these
     large voids, the designer should stagger the vias to allow sufficient feed of the plane
     between vias. Staggering the vias allows the signal to have a continuous return path.

     If a high-speed differential pair or single-ended signal switches the layers, the designer
     should add stitching vias close to the layer change vias. This also allows the return cur-
     rent to change ground planes.




      TIP:
      Place stitching vias when signal changes ground reference. Preferably put the
      ground via between the signal vias.




38
3.5.6 Errors to Avoid When Designing for Controlled Impedance


3.5.6.1 Distinguishing Controlled Impedance Traces from Other Traces


The trace widths of controlled impedance traces must be distinct from the remaining
traces. This makes it easy for the manufacturer to identify them.

For example, if a 5-mil trace is required to achieve 50Ω impedance and if the board
has other traces routed with 5-mil widths, then the manufacturer will have a hard time
identifying the controlled impedance traces. Hence, it’s recommended to route the 50Ω
impedance traces to 5.1-mil or 4.9-mil wide.

The table below shows an example of a design with the trace widths and spacings for
controlled impedance on different layers. The non-impedance signal traces should not
be routed with 3.5, 3.6, 4.2, 4.25, and 4.3-mil trace widths for this particular design.




                                                                                           39
     3.5.6.2 Traces Overpassing Split Planes
     The high-speed signals must be routed over a solid ground reference plane. The traces
     should not be routed over a split plane or a void in the reference plane. Routing high-
     speed signals across split planes can produce the following issues:

     •   Interference with neighboring signals
     •   Degradation of the electrical signal thus ruining signal integrity

     The designer can use stitching capacitors across split planes if the signals have to
     be routed over them. The capacitors contribute a return path for the high-frequency
     current and minimize the current loop area along with any impedance discontinuity
     created by traversing the split plane. In the image shown below, the signals are routed
     around the void in the plane rather than across the split/void.




                                  Image credit: Altium Designer

     3.5.6.3 Traces with no Reference Ground Plane
     The designer should route the high-speed signals either on the top or bottom layer.
     Also, a complete ground reference plane on the adjacent layers must be provided. The
     impedance will be quite high if there are no adjacent layers. The inner layers can be
     used for power planes and other signal routing purposes.



40
3.5.7 Controlled Impedance Design Checklist
•   The controlled impedance lines should be marked in the PCB schematic drawing.
•   The differential pair trace lengths should be matched with a tolerance of 20% of the
    signal rise/fall time.
•   High-data frequency connectors should be used.
•   For stripline construction, use ground or unbroken power, over, beneath and sides of
    the differential pairs. The ground and power planes provide the return currents path.
    This also reduces EMI issues.

3.5.8 Common Mistakes to Avoid in a Stack-Up for Controlled Impedance
Prepregs:

Generally, it is recommended not to use more than three different types of prepregs in
a stack-up. The dielectric thickness of each prepreg layer should be less than 10 mils,
otherwise, it increases the chance of a greater variation in the final thickness. Prepregs
with very low-resin and high-glass content should be avoided. The low-resin content
may lead to resin starvation during lamination. For example, 7628 and 2116 prepregs
have low-resin and high-glass content.

Impedance trace/space:

The spacing between two traces in a differential pair should not be more than twice the
width of the traces. For example, a 4-mil differential trace should not have more than
an 8-mil space. Also, the trace width should not exceed twice the dielectric thickness
between the target signal layer and the nearest reference layer.

3.5.9 Manufacturing Tolerances, Measurements, and Coupons
3.5.9.1 How Sierra Circuits Deals with Controlled Impedance
Equipment used by Sierra Circuits for impedance measurement:

•   Polar CITS – coupons only
•   Tektronix 8300 – boards as well as coupons

If an impedance test coupon is not functional or fails the impedance test, Sierra Circuits
performs impedance testing on boards to verify if the product is within the specifica-
tions. It is essential to test the impedance from the boards due to the length of the trac-
es, which depends upon the size of the board. The position of the inner layer impedance
traces in the finished product is very critical as well.




                                                                                              41
     3.5.9.2 Impedance Failure Analysis During Manufacturing

     Upon failure, a cross-section of the impedance coupon is taken to investigate the devi-
     ation from the calculated impedance to the recorded impedance.

     The manufacturer’s cross-section technician measures the dielectric thicknesses de-
     pending upon the trace location, either the inner layer or the outer layer. Additionally, the
     trace width is estimated from the bottom as well as the top of the affected impedance
     trace along with the copper thickness or the trace height.

     When it is a differential pair, the spacing between the two traces is measured to un-
     derstand whether or not the projected impedance is in alignment with the recorded
     impedance. The image shown below depicts the cross-section evaluation details on a
     single-ended impedance trace.

     A – Trace Width from Top
     B – Copper Thickness or Trace Height
     C – Trace Width from Bottom
     D – Dielectric Thickness between Layer 2 and Layer 3 (Trace)
     E – Dielectric Thickness between Layer 3 (Trace) and Layer 4




     To determine the acceptability of the boards, Sierra Circuits implements test coupons
     to ensure there are no variations in the trace width or the trace thickness.




42                            Copyright Sierra Circuits Inc., 2020
3.5.9.3 The Sierra Circuits Impedance Calculator

Designers can choose the type of impedance required: single-ended or differential.




Calculating single-ended impedance:

Next, the dielectric constant is chosen based on the materials listed in the box below.
Depending on the stack-up the dielectric height is chosen. The required single-ended
impedance, the trace width, and the trace thickness are entered (if not already pre-
filled). Finally, the impedance is calculated once the “Calculate Impedance” or “Calcu-
late Trace” buttons are clicked. If a specific trace width is required, the dielectric height
and the trace thickness should be adjusted until desired trace width is achieved. Note:
The impedance should not vary too much when the above values are changed.




                                 www.protoexpress.com                                           43
     Calculating differential impedance:

     In the differential impedance calculator the trace width, the dielectric height, the dielec-
     tric constant, and the trace thickness are entered. Finally, “Calculate Trace” button is
     clicked to obtain the accurate trace width. If a specific trace width is required, then the
     adjustments can be made until the desired value is obtained. Note that the impedance
     tolerance +/- 2%.




     Disclaimer:

     In both cases, Sierra Circuits’ stack-up team does not check the odd mode impedance,
     the even mode impedance, the propagation delay, the inductance, or the capacitance.
     The reason is that most boards only require one or two types of impedance: single-
     ended and differential.




44                          Copyright Sierra Circuits Inc., 2020
4. PCB Stackup Design & PCB Technology
4.1 PCB Stackup Design
High-speed designs demand critical signal integrity requirements and crafting a PCB
with the right stack-up becomes part of the overall signal integrity equation. The selec-
tion of the PCB materials for impedance, dissipation, and other signal characteristics
along with the right order and number of layers of the materials, need to be considered.

A stack-up, also known as build-up, is the construction of a multilayer PCB in a sequen-
tial order. Almost 99% of the time, the stack-ups will be symmetrical. The stack-ups are
made up of cores, prepregs and copper foils. The majority of the products fall under
62-mil board thickness.

4.1.1 Construction of a Stackup
Depending on the construction type,
stackups are classified into:

•   Core construction (99% results,
    employed for military and
    aerospace)
•   Foil construction (97% results)

  The different types of stack-ups are:
• Standard
• Hybrid – involves two different
   types of dielectric material for dif-
   ferent layers
• HDI

A PCB stackup of layers consists of
various layers which include cores,
prepregs and foils.


4.1.2 Stackup Design
The PCB construction depends on the component packages used in the design, required
signal trace density, and impedance matching requirements. For the high-speed PCBs,
using a multilayer PCB with buried ground and power supply planes is mandatory. Solid
copper planes allow designers to keep the device ground and power connections short.
Further, the ground plane offers low inductance return paths for the high-speed signals.



                             www.protoexpress.com                                           45
     We hear from our PCB manufacturing team that there are cases where designers spent
     hundreds of labor hours on designing PCBs which ultimately had to be trashed. This
     is because the designers failed to understand the manufacturability of these complex
     designs.

     Just so that this doesn’t happen to you, have a look at the below mentioned pointers.

     Tips for an optimum design:

     •   Maintain minimum aspect ratio:
            o 1:10 for through-hole
            o 1:0.75 for microvias
     •   Implement microvias to bring down the board thickness.
     •   In sequential lamination, do not exceed more than 3 lamination cycles. More 		
         than 5 or 6 laminations might create problems.
     •   When there are numerous connections through blind vias, always incorporate a
         back drilling option to minimize the lamination, drill and fill cycles.
     •   When the line widths are 3 mils, the start copper should be 9 microns.



     4.1.3 Best Way to Do a Stackup for High-Speed Signals
     The complex components on the board, like the BGAs, determine the PCB stack-up. The
     complexity of the BGA and the pitch of the BGA, either 0.8, 0.5 or 0.4, would determine
     the stackup design. For fine pitch BGA of 0.5mm and less, it’s recommended to have a
     stackup of at least 10 layers with buried vias and via-in-pads. For instance, if a 9 X 9 or
     a 10 X 10 BGA is used, then the designer needs to fan out the nets in the right manner.
     Likewise, if a 0.5mm BGA is incorporated, then through-hole vias can be used to fan it
     out assuming it’s not too populated. But if a 0.4mm BGA is considered, then blind and
     buried vias are implemented for routing purposes. As a result, it adds up more layers in
     the stackup.

     The PCB designer should figure out the number of layers required to fan out a BGA.
     Consequently, the designer determines on which layers the critical signals are routed
     and the number of power and ground layers required. All these parameters will deter-
     mine the number of layers in the stackup.




46                          Copyright Sierra Circuits Inc., 2020
This is what a preliminary stackup looks like:




                                                         12-layer stackup




     10-layer stackup with signal layers




                                                          16-layer stackup


Sierra Circuits provides stackup design services. In case you need help, kindly send us
your request.

The multiple metal layers in a PCB aid high connection density, minimum crosstalk, and
good electromagnetic compatibility (EMC). These factors help in achieving good signal
integrity. Ideally, all the signal layers should be separated from each other by ground
or continuous power planes. This reduces crosstalk and provides uniform transmis-
sion lines with accurately controlled characteristic impedance. Efficient performance
is achieved when using dedicated ground and power plane layers that are continuous
across the entire board area. When it is not possible to implement ground or power
planes between signal layers, care must be taken to ensure signal line coupling is min-
imized.


                             www.protoexpress.com                                         47
     4.1.4 Lamination Selection
     The dielectric materials used for laminations are discussed in this section.

     FR4 Laminate

     •   Widely used in the electronic industry
     •   Economical
     •   Ideal for frequencies kept below 2.5GHz to 3GHz range
     •   Digital signal may be affected by the physical properties of the material

     Rogers

     •   Dedicated high-speed laminates (Rogers RO4350)
     •   Used in RF applications

     4.1.5 Stackup Design Material Parameter Considerations
     The reason why a designer must choose the right material is stated below:

     The velocity of a signal propagating through a printed circuit board is dependent on
     the dielectric constant of that board. For instance, when the signal frequency exceeds
     5GHz, the typical dielectric constant of FR4, say around 4.7, drops close to 4. Whereas,
     the relative dielectric constant of Rogers remains constant – 3.5 from 0 up to 15GHz.

     If the dielectric constant of the PCB changes with frequency, then different frequency
     components of the signal will have different velocities. This implies that these compo-
     nents will reach the load at different times. This leads to the distortion of digital signals.
     Along with this, the signal losses increase with the rise in frequency. This again will add
     up to the distortion of the digital signal.

     4.1.6 Propagation Velocity
     Electrical signals in the medium propagate slower than the speed of light in a vacuum.
     The speed is proportional to square root relative dielectric constant (Er) of the medium.

                                      VPROPOGATION = (CVACCUM/√Er)

     Refer to the materials selection chapter for details on materials.




48                           Copyright Sierra Circuits Inc., 2020
4.1.7 Planning High-Speed PCB Stackup
An accurately stacked PCB substrate will effectively reduce electromagnetic emissions,
crosstalk, and improve the signal integrity of the product. A poorly arranged stack-up
might increase EMI emissions, crosstalk and also the device becomes more suscep-
tible to external noise. These issues can cause faulty operation due to timing glitches
and interference which dramatically reduces the performance of the product.

With the right stack-up, the designer can suppress the noise at the source rather than
correcting the issues after the product is built. PCBs involving multiple planes enable
signals to be routed in microstrip or stripline controlled impedance transmission line
configurations. The signals are tightly coupled to the ground or power planes and im-
prove signal integrity by reducing crosstalk.

In high-speed PCBs, the ground and power planes perform three significant functions:

•   Controls crosstalk amongst signals
•   Deliver stable reference voltages for exchanging digital signals
•   Distribute power supply to all the logic devices

While choosing a multilayer stack-up the designer should consider the following:

•   A signal layer should always be placed right next to a plane.
•   The signal layers should be tightly coupled (<10 MIL) to their adjacent planes.
•   A power plane or a ground plane can be incorporated for the return path of a signal.
•   Determine the return path of the signals. The high-frequency signals take the path
    of least inductance.

4.2 Selecting High-Speed Materials
The most common PCB material is FR4. This material is used in most electronic appli-
cations. However, when it comes to high-frequency signals, especially in the microwave
domain, FR4 is not suitable.

When designing PCB circuits at microwave frequencies, the key characteristics that
define circuit laminate performance for microwave/RF printed-circuit boards include:

•   Dielectric constant(Dk)
•   Dissipation factor (Df)
•   Coefficient of thermal expansion (CTE)
•   Thermal coefficient of dielectric constant (TCDk)
•   Thermal conductivity

The high-frequency material perhaps most familiar to users of PCB laminates is polytet-
rafluoroethylene (PTFE) which is a synthetic thermoplastic fluoropolymer that has ex-
cellent dielectric properties at microwave frequencies. Rogers materials are also
commonly used.
                              www.protoexpress.com                                         49
     4.2.1 PCB Material Categories
     When selecting high-speed PCB laminates, what are the primary concerns that must
     be addressed in regards to manufacturability and cost? Let’s take a look at this chart.
     For your convenience, we’ve classified important materials into buckets based on the
     materials’ signal loss properties against a varying frequency range .

                                                                  Normal speed and loss:
                                                                  Normal-speed materials are
                                                                  the most common PCB ma-
                                                                  terials—the FR-4 family.
                                                                  Their dielectric constant
                                                                  (Dk) versus frequency re-
                                                                  sponse is not very flat and
                                                                  they have higher dielectric
                                                                  loss. Therefore, their suit-
                                                                  ability is limited to a few GHz
                                                                  digital/analog applications.
                                                                  An example of this material
                                                                  is Isola 370HR.

     Medium speed, medium loss: Medium-speed materials have a flatter Dk versus fre-
     quency response curve, and have a dielectric loss about half that for normal speed
     materials. These are suitable for up to ~10GHz. An example of this material is Nelco
     N7000-2 HT.

     Medium speed, medium loss: Medium-speed materials have a flatter Dk versus fre-
     quency response curve, and have a dielectric loss about half that for normal speed
     materials. These are suitable for up to ~10GHz. An example of this material is Nelco
     N7000-2 HT.

     High speed, low loss: These materials also have flatter Dk versus frequency response
     curves and low dielectric loss. They generate less unwanted electrical noise compared
     to other materials. An example of this material is Isola I-Speed.

     Very high speed, very low loss (RF/microwave):Materials for RF/microwave applica-
     tions have the flattest Dk versus frequency response and the least dielectric loss. They
     are suitable for up to ~20GHz applications. An example of this material is Isola Tachy-
     on 100G.




50                         Copyright Sierra Circuits Inc., 2020
Exploring materials




                      www.protoexpress.com   51
     4.2.2 Signal Loss and Operating Frequency

     What PCB material properties account for the difference in the PCB electrical perfor-
     mance, and how do these differences affect the PCB material cost? As it turns out,
     there are three main factors to evaluate when it comes to material performance for
     high-speed PCB designs. What is the signal loss at the operating frequency? Should
     you be concerned about the weave effect, and how easy is the material to manufacture
     your stack-up in construction?




     First, let’s take a look at the relationship between signal loss and operating frequency.
     As you can see from the graph, there’s a direct correlation between signal loss and fre-
     quency. At the same time, we can also see that certain materials are less lossy than
     others. This was the basis we used to create our material classification bucket on
     the previous chart. This graph shows which materials could possibly perform better
     electrically at higher speeds.




52
Next, let’s compare the direct cost based on our material classifications. As you can
see from the chart, less lossy materials cost more. You will have to decide what mate-
rials work best for your specific project. As you can see, the Rogers 4350B material is
higher than that of Megtron 6 or Itera, even though electrical performance is similar. In
the microwave category, the Taconic RF-35 is about 30% less expensive for the same
performance as other materials in this category.




                                                                                            53
     4.2.3 Non-PTFE Materials
     Let’s do a deeper dive into the non-PTFE materials. We will come back to the PTFE
     materials in a bit. Now, all of these materials perform somewhat similarly and at
     somewhat similar costs, but what justifies the cost differences, and what is the ad-
     vantage of working with higher cost materials?




     First, we must understand material construction, and the effects of glass on character-
     istic impedance must also be understood. One way to achieve this is by understanding
     the weave effect and the different types of glass cloth. As you can see, different glass
     construction will affect DK distribution. A board with a loose weave will have greater
     variation in board thickness and greater variation in DK distribution. However, a tight
     weave will have a more consistent board thickness and more even DK distribution. The
     effective DK of the material remains the same as the signal traverses the dielectric.

     What is really important to note from a manufacturing perspective is that a board with
     a tighter weave is easier to manufacture. When the glass weave is more consistent,
     mechanical laser drilling also becomes more consistent.




54                         Copyright Sierra Circuits Inc., 2020
Aside from the glass weave, there are two other types of glass to choose from, Si
glass or E-glass. E-glass is the predominant glass type. E-Glass is a low alkali glass
with a typical nominal composition of SiO2 54wt%, Al2O3 14wt%, CaO+MgO 22wt%,
B2O3 10wt% and Na2O+K2O less then 2wt%. Some other materials may also be pres-
ent at impurity levels. It varies the thickness between 1.3 mils to 6.8 mils. Looking at
the chart, you can see the Dk of the E-glass at 5 gigahertz is 6.5, while the Df is .006.
Now, Si glass is much purer than E-glass, and as a result, the Dk of 5 gigahertz for
the Si glass is 4.5 and the Df is .004. The cost of the laminate compared to E-glass is
about 15% higher.

4.2.4 Stackup Guidelines for Mixed Materials

Next, we will review three stack-ups and go over some basic stack-up guidelines for
mixed materials.

•   Stack-up #1 is a pure Rogers stack-up using Rogers 3000 materials. It is a mul-
    tilayer construction that requires longer dwell times at higher temperatures. This
    lamination process is known as fusion bonding. Only a select few manufacturers,
    like Sierra Circuits, have the equipment and the expertise to perform this operation.
•   Stack-up #2 is a hybrid stack-up using Rogers and Isola materials. Designers use
    this method to save on material cost and to aid in the manufacturability of multi-
    layer stack-ups. Rogers is not suitable for sequential lamination process, and there
    are other material vendors, like Taconic and Isola, who make materials that perform
    similar to Rogers and do not have these limitations. In the past, it’s been difficult to
    control the press-out thickness of these B-stage materials. Now, with better equip-
    ment, better process controls, customers can expect consistency and reap the
    benefits.
•   Stack-up #3 consists solely of Taconic materials. These materials, although based
    on glass cloth, have similar performance to Rogers materials and are much easier
    to manufacture. With glass cloth, materials also become dimensionally stable.
4.2.5 Hybrid Stack-up Guidelines
Now, let’s discuss some hybrid stack-up guidelines. We recommend the following when
Now, let’s discuss some hybrid stack-up guidelines. We recommend the following when
dealing with a hybrid construction. Use the high-performance material as the core. Lam-
inate with FR-4 prepreg. Balance the FR-4 portion, and don’t use a high Tg dielectric or
bonding film with a lesser Tg material.

So, there you have it. We reviewed how to select high-speed materials based on perfor-
mance and cost, including manufacturability.




                              www.protoexpress.com                                             55
     4.3 Effect of Different Styles of Fibreglass Weaves on Impedance
     The substrate of the PCB is made up of fibreglass material which is woven as a fabric
     and hardened with resin to make a flat enduring surface for a PCB. Different types to
     substrate have different weaves as shown below. Denser and closer the weave better
     and even the dielectric qualities. Thus, more uniform characteristic impedance. This
     results in better signal quality at high speeds.




     When a set of high-speed differential signals are on the PCB, represented by the red
     and blue lines in the above figure, form a pair of differential traces. If you look closely,
     you will find that when one of the tracks is in the weaving space, the corresponding Er
     value will be greater than the other signal line, and the Er value is different. The result is
     change in the differential impedance. This phenomenon variation in impedance due to
     the dielectric layer glass weave is the fibre weave effect, and if weave density of spars-
     er, its impact is more serious!




56                           Copyright Sierra Circuits Inc., 2020
Common Fibreglass Weave Styles




Prepregs:
Generally, it is recommended not to use more than three different types of prepregs in
a stack-up. The dielectric thickness of each prepreg layer should be less than 10 mils,
otherwise, it increases the chance of a greater variation in the final thickness. Prepregs
with very low-resin and high-glass content should be avoided. The low-resin content
may lead to resin starvation during lamination. For example, 7628 and 2116 prepregs
have low-resin and high-glass content.




                             www.protoexpress.com                                            57
     4.4  Terms and Definitions for Stackup
     •    The dielectric constant (Dk) of a dielectric or insulating material can be defined as
          the ratio of the charge stored in an insulating material placed between two metal-
          lic plates to the charge that can be stored when the insulating material is replaced
          by vacuum or air. It is also called electric permittivity or simply permittivity.

         And, it is at times referred to as relative permittivity, because it is measured rela
         tively from the permittivity of free space (ε0).

         The dielectric constant characterizes the ability of plastics to store electrical
         energy.

     •    The dissipation factor (tan δ) or Df is defined as the ratio of the ESR and capacitive
          reactance. The dissipation factor is a measure of loss-rate of energy of a mode of
          oscillation (mechanical, electrical, or electromechanical) in a dissipative system.

     •    The coefficient of thermal expansion (CTE) describes how the size of an object
          changes with a change in temperature. Specifically, it measures the fractional
          change in size per degree change in temperature at a constant pressure.

     •    Circuit materials are evaluated by a number of different parameters, including
          dielectric constant (Dk) and dissipation factor (Df). Those two parameters also
          have temperature-based variants that provide insight into the expected behavior of
          a circuit material with changes in temperature, notably the thermal coefficient of
          dielectric constant (TCDk) and the thermal coefficient of dissipation factor (TCDf).
          The parameters detail the amounts of change in a material’s Dk and Df, respective-
          ly, as a function of temperature, with less change representing a material that is
          more stable with temperature.




58                            Copyright Sierra Circuits Inc., 2020
5. EMI and EMC
EMC is the branch in electrical engineering that deals with the unintentional generation,
propagation, and reception of electromagnetic energy. These elements may cause un-
desired effects such as electromagnetic interference (EMI).

In many designs, EMC design considerations are not taken during the initial design
phase. Resolving the EMC issue after production can be a painful task. Most design-
ers are under the impression that these problems can be fixed using additional EMC
suppression components at the end of the product development cycle. However, this is
quite challenging and can be an expensive fix.


5.1 Electromagnetic Compatibility (EMC)
A full treatment of EMI/EMC is outside the scope of this book. Here, we shall only talk
of some good design practices that help towards reduction of generated EMI and great-
er immunity from received EMI.

5.2 What is EMC or EMI?
All electronic circuits generate electromagnetic interference or electromagnetic dis-
turbance (EMI), and are also affected by EMI generated by other electrical/electronic
equipment. Therefore, our goal during PCB design is two pronged:

•   The product should not generate EMI disturbances exceeding acceptable levels.
•   The product should be immune from acceptable levels of EMI disturbance.

If we achieve the two objectives above, we have implemented electromagnetic compat-
ibility (EMC) successfully.

EMC standards specify both acceptable levels: EMI generation and EMI susceptibility.
If a product is required to be EMC certifiable, then the design has to ensure that the
product will operate such that generated EMI is within specified levels, and the product
will not malfunction if specified levels of received EMI are present.
In the U.S., FCC governs the EMC regime; it classifies products in several categories
– for business use (Class A) and for residential use (class B). Class B is stricter than
class A.




                             www.protoexpress.com                                           59
     5.3 Sources of EMI
     •   Radio frequency signals, harmonics, etc.
     •   Fast signal transitions, high frequency clock signals
     •   Transients generated by lightning, power circuits, motors, circuit breakers and
         other power switching devices, etc.

     EMI can occur either by radiation or conduction:

     •   Conductively through power input lines, cables, etc. This will be the predominant
         EMI below 30 MHz.
     •   By electromagnetic radiation from power and communication transmission lines,
         and power switching devices, arcing, and electrostatic discharges. These will be
         the predominant EMI above 30MHz.

     5.4 Best PCB Design Practices for EMC
     Proper grounding design practice:

     •   Majority of EMI problems can be traced to bad GROUNDING design. A good
         ground design will be less susceptible to EMI.
     •   Reduce current loops to minimum paying special attention to signal of high fre-
         quency. Current loops can be reduced by using solid ground references below high
         speed signals.
     •   Choice of logic family: do not choose a logic family faster than required; a faster
         logic family will generate more EMI.
     •   Choose the logic family with the highest noise margin; hence less susceptibility to
         EMI.
     •   Power rails are also a source of EMI problems. Use solid ground planes to avoid
         EMI issues.
     •   Impedance matching: signal ringing /distortion is less, hence less EMI.
     •   Shielding practice: Shield all very frequency circuit segments by metal enclosures.
     •   Filtering for EMC: low pass or band pass filters attenuate high frequency compo-
         nents:
             •   A ferrite core inductor in series is an effective low-pass filter for input power
                 rails: a ferrite bead has very high impedance at high frequencies and almost
                 negligible impedance at low frequencies.
             •   A capacitor in parallel
             •   Mains filters
             •   IO filters
             •   Feedthroughs
             •   Three terminal capacitors
             •   Cable shield terminations



60                          Copyright Sierra Circuits Inc., 2020
6. Power Integrity

                        Die                               Voltage Regulator Module (VRM)
          BGA Package             Decoupling Capacitors




6.1 Introduction - What is Power Integrity?
A circuit board requires one or more power supply voltages to operate. These are most-
ly generated by Voltage Regulator Modules (VRMs). These VRMs are designed to de-
liver the required maximum currents at the required voltages to the various devices on
the circuit board.

Power Distribution Network (PDN) consists of all the interconnects from the VRMs to
the terminals/pads of various components and devices (ICs, etc.) including all the bulk
and ceramic decoupling capacitors, power and ground planes, the intervening vias,
traces and the relevant leads, solder balls, wire-bonds, etc. of the device packages.

A PDN’s any voltage rail is a single net but a very large one, having many components
connected to it, and is spread over almost the entire PCB. PDN is susceptible to electri-
cal noise generated by the components, and the various signal, power and ground nets
on the PCB. Furthermore, faster and greater the number of the signal transitions (rise
and fall times) switching over various I/Os and internal circuits of the devices on the
board, greater will be the magnitude and frequency bandwidth of the electrical noise on
the PDN.

PDN noise is injurious to the proper functioning of the board in several ways:

•   When the magnitude of the noise on PDN exceeds a certain threshold, it alters the
    voltages delivered to the ICs below the acceptable values, causing malfunction of
    the circuits on the board.
•   Even if a PDN supplies a voltage to the devices within tolerance, the PDN noise may
    still cause other problems. It can cause or appear as crosstalk on signal lines, it can
    transfer to the input power source line from where it can pass on to other VRMs
    inputs, thereby to their outputs.


                              www.protoexpress.com                                            61
     •   Furthermore, as PDN interconnects are usually the largest conducting surfaces on
         the PCB and carry the highest currents, any high frequency PDN noise has the po-
         tential of creating a lot of electromagnetic radiation, possibly causing failure to
         pass EMC compliance.

     It is therefore important to control the PDN noise, and ensure that it delivers the re-
     quired voltages within acceptable tolerance limits (usually within ± 2 to 5%), across the
     power supply voltage and ground terminals of the various devices mounted on the PCB,
     and the devices’ dynamic current demands are met at all times and over their entire
     functional frequency range.

     Power Integrity (PI) deals with all aspects of the PDN – it is designed to control the PDN
     noise.
     6.2 PDN Block Diagram
     Before we analyze the PDN in greater detail, let us look at a general PDN:




     PDN starts from the various VRMs followed by bulk decoupling capacitors (usually
     electrolytic – aluminum/tantalum/polymer), power and ground planes with associated
     via and traces interconnects, multiple HF decoupling chip capacitors (usually ceramic
     capacitors) and the associated vias and traces interconnects to power supply voltage
     and ground pins of the various Devices – ICs, transistors, etc..

     6.3 PDN Noise and its Causes
     The control of PDN noise plays the most important role in ensuring good power integri-
     ty. In order to control it, one must first understand and analyze the causes and sources
     of the PDN noise.
     If there were only constant DC current flow in the PDN interconnects from the VRMs to
     the ICs, that would cause a constant voltage drop, called the IR Drop, between the VRM
     and the ICs:

     IR Drop = (Series resistance of the power and ground rails) X (Current in the rails)
     ……………… (PI-1)

     However, the current drawn by the ICs and devices on the board is never constant but
     fluctuates rapidly with time. Thus, the current drawn is not DC but an AC current, and
     instead of ‘IR’ drop, we will need to consider the ‘IZ’ drop where Z is the AC impedance
     of the PDN network:
62                          Copyright Sierra Circuits Inc., 2020
AC Voltage on PDN = (AC Impedance of the PDN) X (AC current in the PDN) ……………………..
(PI-2)

In ICs and transistors, when the digital signals, either inside the IC chip and/or on the
I/O pins and associated circuitry, switch from one logic level to the other logic level, the
current drawn from the power supply pins of these devices also changes. This change
occurs in a very short time characterized by the rise or fall time ‘tr’ which ranges from
sub-nanoseconds to a few nanoseconds in high-speed circuits.

If ΔI is the amount of change in the current drawn by the IC from the power supply,
and Δt = tr is the time during which this change occurs, then this change will induce a
voltage Vnoise= L x (ΔI / ΔT) = L x (ΔI/ tr) across the power and ground pins, where
‘L’ is the inductance of the loop formed by the path of the power and ground nets i.e.
the PDN. This noise voltage is rightly a cause of the PDN noise. There are three things
apparent from this PDN noise source:

a.     The greater the ΔI is, greater will the noise voltage be. So, if multiple signals, say
‘n’, are switching simultaneously in one or more devices on the same power rail, the
current change in time ‘tr’ on that rail will be nΔI, so that noise voltage will become ‘n’
times:

   VnoisePDN = L x n x (ΔI/ tr) ………………………………………………………………………………….. (PI-3)

Complex ICs – FPGAs, microcontrollers, memories, ASICs, etc. – (i) have many I/Os
and (ii) quite a lot of internal processing goes on inside them as per programs running
therein. Both these sources result in switching taking place in a tremendous amount,
and it would be very likely that a large number of signals are switching simultaneously,
resulting in a large magnitude of PDN noise.

b.     The smaller the value of ‘tr’, the greater will be the value of PDN noise. In our
present era of ever increasing processing power occurring in shorter and shorter time
durations in complex ICs and transistors, we are confronted with very high data transfer
rates and extremely small rise times i.e. ‘tr’ – in the range of few tens of picoseconds.
Obviously, these devices have potential to create very high PDN noise.

c.    Finally, greater the PDN inductance ‘L’ is, greater the PDN noise will be. What con-
tributes to ‘L’ in the power delivery path? There are many sources:

i.      Firstly, every loop in the PDN interconnect has a parasitic inductance propor-
tional to its loop area. Thus, all the interconnects – inside the IC chip, from inside to IC
terminals, from IC terminals to PCB pads, PCB traces and vias from pads to decoupling
caps to power and ground planes and then to the VRMs – all form current path loops
with inductances (usually in nH range).




                              www.protoexpress.com                                              63
     ii.     Secondly, the decoupling capacitors – both bulk electrolytic and ceramic types
     - are not ideal capacitors. They have inductances associated with their external and
     internal leads called ESL- the Equivalent Series Inductance - which can be several
     10nHs in case of electrolytic capacitors and a few nHs in case of ceramic capacitors.
     Capacitors also have ESR – Equivalent Series Resistance – drop-through which adds
     to the PDN noise. The equivalent circuit of a real capacitor of stated value C is shown
     in the following diagram.




     Inductance of the capacitor increases its impedance at higher frequencies where it
     no longer functions as a capacitor. Every piece of conductor on the PCB and inside
     the components in the power delivery path has some parasitic inductance associated
     with it.

     If we look at equation (PI-3), given the ICs and other active devices on the circuit
     board, the only thing in our control to limit the PDN noise is the PDN inductance L!
     6.4 Analysis and Design of PDN
     A circuit schematic diagram of the PDN network can be represented as follows:




     The top and bottom lines represent the power and ground rails or planes. At P and G an
     IC is connected. This network comprises mainly VRM, resistors, inductors, and capaci-
     tors and its analysis is most conveniently done in frequency domain by circuit analysis
     techniques, either manually or by using SPICE. What we need is to estimate the required
     spectrum of the frequencies of interest and look at the impedance ZPDN of the PDN
     network looking back from the points P and G where the devices – ICs and transistors
     – are connected to the PDN, and analyze how ZPDN varies with frequency over the
     bandwidth of interest.

64                         Copyright Sierra Circuits Inc., 2020
6.4.1 Target Impedance ZPDN and its Frequency Spectrum
If Imax is the maximum current consumption rating of a particular PDN voltage rail –
say of VCC – then the actual current drawn by VCC rail may vary, over a period of time,
from very low to almost Imax depending on how many and how fast I/Os are switching
simultaneously at a particular instant. If the fastest rise time is tr, then the highest
frequency content in the current waveform is of the order of fm = 0.5/ tr , and it would
be prudent to say that noise current waveform has a spectrum covering the frequency
range from DC to fm , and the magnitude Îm of a sinusoidal current waveform at any
frequency of interest in this spectrum is ≤ Îm = (1/2) Imax.

If ZPDN be the impedance of the PDN network at the frequency of interest, then the
noise voltage generated on the VCC rail will have a magnitude V̂Noise given by:

        V̂Noise = ZPDN x Îm   ………………………………………………………………………… (PI-4)

This noise voltage will occur as ripple voltage on the VCC rail. In order that the ICs
connected on the VCC rail function properly, we need to ensure the V̂Noise magnitude-
does not exceed the acceptable ripple voltage of the IC’s power supply voltage VCC :

V̂Noise ≤ Acceptable voltage ripple = VCC x Acceptable Ripple% …………………………… (PI-5)

Therefore, ZPDN ≤ (VCC x Ripple%) / (Îm) = (VCC x Ripple%) / (0.5 x Imax) ……………..... (PI-6)

We now define the Target Impedance - ZT-PDN - of the PDN network by:

     ZT-PDN = (VCC x Acceptable Ripple %) / (0.5 x Imax) …………………………………… (PI-7)

So that the actual PDN impedance should be limited by:

ZPDN ≤ ZT-PDN   (over the entire frequency spectrum of the PDN Noise Current) (PI-8)

In the picture below we show a typical good PDN impedance plot vs Frequency and
also the Target Impedance of the PDN. The actual impedance does go above the tar-
get impedance line for the entire frequency range from DC to 10GHz and that means
that it meets the condition of the above equation (PI-8).




                              www.protoexpress.com                                            65
     Thus, the design of a good PDN network involves the following steps:

     (1) Determine the highest frequency fm = 0.5/ tr where tr is the fastest signal rise or fall
     time. DC to a few fm is the frequency range of interest.

     (2) Calculate the target PDN impedance ZT-PDN for each voltage rail as per the above
     equation.

     (3) Draw the PDN network or a simplified version of it, and calculate, using SPICE or
     manually, the actual PDN impedance at various frequencies i.e. to plot the PDN imped-
     ance spectrum (plot of impedance magnitude vs frequency), and to understand how
     various decoupling capacitors and geometry of the PCB conductors and vias in the
     PDN affect this spectrum shape.

     (4) Choose appropriate decoupling capacitors and geometry of the PCB conductors
     and vias in the PDN to ensure that ZPDN ≤ ZT-PDN for each voltage rail over the entire fre-
     quency spectrum of interest.
     Examples of calculation of fm and ZT-PDN :

     (1) For VCC = 3.3V rail, Let the fastest rise time be 1ns. Therefore, the highest frequen-
     cy is: fm = 0.5/ tr = 0.5/ (1 ns) = 500MHz. Let Imax = 3A, ripple = 3%. Therefore, ZT-Vcc =
     (3.3V x 3%) / (0.5 x 3A) = 0.066Ω

     (2) For VDD = 1.2V rail, Let fastest rise time be 0.5 ns. Therefore, the highest frequency
     is: fm = 0.5/ tr = 0.5/ (0.5 ns) = 1000 MHz. Let Imax = 1A, ripple = 2%. Therefore, ZT-VDD =
     (1.2V x 2%) / (0.5 x 1A) = 0.048Ω.

     Generally, the target PDN ZT-PDN impedance falls in the range of 0.04Ω to 0.1Ω for most
     medium-to-complex requirements. And the frequency band of interest is DC to 1GHz.
     Thus, the ZPDN magnitude should not go above ZT-PDN for the entire frequency band from
     DC to 1GHz. See the picture below as an example:




66                          Copyright Sierra Circuits Inc., 2020
6.4.2 Estimation of Actual ZPDN over the Bandwidth
To estimate the actual PDN impedance at various frequencies, we need to analyze its
equivalent circuit schematics model like the one shown in Fig. PI-03 above. The values
of the resistors are quite small as compared to the impedances of inductances and ca-
pacitances; therefore a simplified schematics of a typical PDN network can be depicted
as here under:




If we see the impedance of the above PDN looking back from P and G, we realize that
the VRM, the bulk capacitors, HF decoupling capacitors, the IC package, and die play
a very significant role in determining the magnitude of ZPDN in various frequencies
zones. In PCB design, the IC package and die are not in our control, but the other ele-
ments are. We will therefore concentrate our analysis on the VRM, bulk capacitors, and
the HF decoupling capacitors and their frequency zones of influence on PDN
impedance.
6.4.2.1 Voltage Regulator Module (VRM)
At low frequencies – from DC to about a few KHz, the VRM provides a low impedance
for the PDN. The impedances looking back into VRM at 1kHz should be lower than ZT/2.
Generally, a well-chosen VRM will exhibit a very low impedance in this frequency range.
For example, even for large value of LVRM ≤ 3µH, ZVRM ≈ 2πf LVRM would be ≤ 0.02Ω at
1KHz frequency.
6.4.2.2 Actual Behavior of a Real Capacitor
If C, LC, and RC respectively are the capacitance, Equivalent Series Inductance (ESL), and
Equivalent Series Resistor (ESR) of a real capacitor, then the impedance ZC will have a
minimum value = ESR at the resonant frequency given by:
                                         ………………………………………………………… (PI-9)




                                 www.protoexpress.com                                        67
     If we plot the impedance ZC of a single capacitor versus frequency, we get a plot similar
     to one shown by the red and green curves for the capacitors C1 and C2 respectively
     in the following diagram. Note that for frequency < Fr, the impedance is effectively ca-
     pacitive (i.e. impedance decreases as frequency increases) and for frequency > Fr, it is
     inductive (i.e. impedance increases with frequency). If we also draw the target imped-
     ance ZT line in this diagram, this line cuts the ZC line at two frequencies; and within the
     frequency range given by them, we find that ZC ≤ ZT. We thus know over which frequen-
     cies the given decoupling capacitor will be useful in keeping the PDN impedance within
     target.




     In the above diagram, we have also shown the case of two capacitors. Red line cor-
     responds to C1, the green line corresponds to C2, and the blue line corresponds to the
     effective combined C= ‘C1 in parallel with C2’. We see that for the combined C, there is a
     impedance peak exceeding the ZT line at a frequency lying in between the two resonant
     frequencies Fr-c1 and Fr-c2. The height of this peak is found to be inversely proportional
     to the ESRs value; therefore very low ESR values can sometimes be counterproduc-
     tive in keeping ZPDN below ZT. One of the ways to remove this peak is to introduce a third
     capacitance whose resonant frequency lies between the two resonant frequencies;
     though we will now have 3 valleys and 2 peaks, still the magnitude of the peaks will be
     lowered as a result of the low impedance of the third capacitor in that frequency range.

     If we use multiple capacitors of the same value in parallel, we may have multiple peaks
     but they will be close together and their magnitudes will be small. Using ‘n’ exactly sim-
     ilar capacitors in parallel has the effect of increasing the effective value of capacitor ‘n’
     times while dividing the value of ESL and ESR by ‘n’. However, if we have ‘n’ dissimilar
     capacitors in parallel, the equivalent impedance plot will have, in addition to ‘n’ mini-
     mum valleys, also ‘n-1’ peaks, and we need to be careful while choosing the capacitors
     so that the peaks do not go above the ZT line.




68                           Copyright Sierra Circuits Inc., 2020
6.4.2.3 Role of Bulk Capacitors

These are typically electrolytic capacitors – aluminum, tantalum or polymer types. Their
resonant frequencies range - fbclow to fbchigh - from a few kHz to 100kHz, and they are thus
able to keep the PDN impedance low in the frequency range from a few kHz to 100kHz.
Their ESL is of the order of 10 to 20nH. The bulk capacitance value is so chosen in or-
ders to make the impedance of bulk capacitor < ZT at 1kHz.

Guidelines for choosing bulk capacitors:

Let ZT be the PDN target impedance.

1. Do not choose a tantalum capacitor with very low ESR value as it may cause un-
wanted high peaks when the effect of other capacitors in parallel - tantalum as well as
ceramic - is also taken into account. Choose a tantalum capacitor with ESR ≈ 0.5 ZT .

2. As the effective frequency range of tantalum capacitors is ~ 1kHz to 100kHz, choose
the capacitor value C such that its impedance (1/(2πfC)) at fbclow = 1kHz is less than
√(ZT2 –ESR2).

          Cbulk ≥ 1/[ 2πfbclow √(ZT2 –ESR2) ] = 159/ √(ZT2 –ESR2) ……………(PI-10)

Example: If ZT = 0.1Ω, ESR = 0.05Ω, fbclow = 1kHz, then, Cbulk ≥ 159/√(0.12 –0.052) = 1836
µF

So, a bulk capacitor of 1840µF with an ESR ≈ 0.05Ω will be required.

ESL of a typical high value tantalum capacitor is ~ 20nH.

It will be difficult to find a tantalum or polymer capacitor of capacitance near 1800µF
with an ESR of 0.05Ω. So, it would be best to use 2 or more tantalum capacitors in
parallel.

We could use 2 capacitors of 1000µF, ESR=0.1Ω so that effective C= 2000µF & ESR =
0.05Ω ohms.

Or, we could use 4 capacitors of 470µF, ESR = 0.2Ω each, so that effective C=1880µF
and ESR= 0.05Ω.

Or, we could use three tantalum capacitors: two – C1 and C2 - each of 680µF and ESR
= 0.2Ω each and one C3 of capacitance = 500µF, ESR = 0.1Ω. As this case involves dis-
similar capacitors, we will go for this here. Parallel of two similar capacitors - C1 II C2
- gives effective capacitance = 1360µF and effective ESR = 0.1Ω. Let C= C1 II C2 II C3
be the final capacitance (≈1860µF, ESR =0.05Ω). The plot of ZC will look like as under:



                                  www.protoexpress.com                                         69
     We see that the impedance is less than o.1Ω for 1kHz to 2MHz.

     3. We can now estimate the fbchigh, the highest frequency at which the bulk capacitor
     impedance will be ≤ZT . At this frequency, the impedance will be effectively inductive in
     series with ESR. This frequency will be:

     fbchigh = √(ZT2 - ESR2) /(2πESL) …………………………………………………………………………. (PI-11)

     = 0.0866/(2π x 6.67nH) ≈ 2.1 MHz in this example as also indicated in the plot above.

     As we had indicated, bulk capacitors are to ensure ZPDN ≤ ZT in the frequencies up to a
     few 100kHz, correctly speaking upto fbchigh. Above fbchigh or 100kHz, whichever is higher,
     the bulk capacitors will behave highly inductive and their impedance magnitude will be
     > ZT , therefore we need high frequency decoupling capacitors like ceramic chip capac-
     itors to control the impedance of the PDN.

     6.4.2.4 Ceramic Chip Decoupling Capacitor

     Ceramic chip capacitors, also called as MLCCs, have resonant frequencies in the range
     of a few 100kHz to a few 100MHz ( depending on value and size) and they have very
     low ESRs – of the order of a few milliohms to few 10s of milliohms. They play the dom-
     inant in controlling the PDN impedance and keeping the PDN impedance ≤ target im-
     pedance in the frequency range of 100kHz to 100MHz. These capacitors are very small
     SMT components – their individual capacitances range from a few Pico-Farads to tens,
     and even hundreds of Micro-Farads.

     A 0.001µF ceramic capacitor typically has a resonant frequency of ~ 300MHz (0201
     size) to ~200MHz(0805).

     A 0.01µF ceramic capacitor typically has a resonant frequency of ~90MHz (0201 size)
     to ~70Mhz(0805 size).


70                          Copyright Sierra Circuits Inc., 2020
A 0.1µF ceramic capacitor typically has a resonant frequency of ~30MHz (0201 size)
to ~20Mhz(0805 size).

A 1µF ceramic capacitor typically has a resonant frequency of ~10 MHz (0201 size) to
~ 6MHz (0805 size).

A 10µF ceramic capacitor typically has a resonant frequency of ~3MHz (0402 size) to
~ 2MHz (0805 size).
Guidelines for choosing ceramic capacitors:

If we continue the example given above for tantalum capacitors, we find that tantalum
capacitors are able to control the ZPDN < ZT upto fbchigh = 2MHz. Above 2MHz, ceramic
capacitors control the PDN impedance.

At 2MHz, we require a ceramic capacitance value given by: (ZT=0.1Ω , ESR of capacitor
= 0.04Ω)

   Ccer ≥ 1/[ 2πfbchigh √(ZT2 –ESR2) ] = 1/ (2π2x106x 0.0916) = 0.87µF ……...(PI-12)

This value is in the range of 0.1 to 1µF; its resonant frequency will be about 10 to 30MHz
as per earlier data.

At 100MHz, the impedance of this ceramic capacitor will be largely inductive. We want
the this inductive impedance to be ≤ √(ZT2 –ESR2) = 0.0916Ω at 100MHz; so that the
inductance - ESL is limited by:

 ESLcer ≤ √(ZT2 –ESR2) / (2π fcerhigh) = 0.0916/(2 π x 100 x 106) = 0.146nH …………(PI-13)

It would be more than safe to assume an effective ESL = 1nH per ceramic capacitor.
Therefore, to keep ESL < 0.146nH, we require at least 1nH/ 0.146nH = 7 capacitors in
parallel. As the total value required should be ≥ 0.87µF, each capacitor should have a
value = 0.87/ 7 = 0.124µF.

The nearest available standard value is 0.1µF. They have a typical ESR = 0.04Ω. So, we
will require 9 such capacitors in parallel. There effective ESL will be 1nH/9= 0.11 nH,
and effective ESR will be 0.04/9 = 0.0045Ω. These will result in the ZPDN at 100MHz =
√((2πfL)2 + ESR2) ≈ 0.07Ω, well within the ZT limit. In fact, these will keep the ZPDN within
ZT limit for up to 145MHz.




                              www.protoexpress.com                                              71
     In this way, one can decide on the value and number of ceramic capacitors required to
     keep the PDN impedance below target for frequencies up to 100MHz or even higher.

     The most widely used ceramic decoupling capacitors are of values 0.1µF. To extend
     the low PDN impedance range beyond 100MHz, one uses capacitors of values 0.01µF
     (=10nF=10,000pF) ZT limit and 0.001µF (=1nF=100pF).

     One thing that we should look out when paralleling different value ceramic capacitors.
     This was discussed in section 2.4.4.2.2 (Actual Behavior of a Real Capacitor) above. Do
     not choose two different values only; choose 3 different values to avoid high resonant
     peaks.

     These decoupling capacitors are installed on the PCB very close to IC power and ground
     terminals so that parasitic trace inductance from capacitor pad to the IC terminal pad
     is very low. The inductance of the vias from the power and ground planes needed to
     connect to the capacitor terminals also add to the overall inductance of the capacitor.
     Thus, we need to take into account not only the ESL of the chip capacitor but also the
     loop inductance of the vias and the traces that connect the IC’s power and ground pins
     to the capacitors and to the power and ground planes.

     6.4.2.5 Trace Loop Inductance
     Trace loop inductance is given by :

                     Llptr ≈ Zch x Tpd = Zch x l x tpd ………………………………… (PI-14)

     Here Zch is the characteristic impedance of the trace loop, ‘l’ is the length of the trace
     and tpd is the propagation delay per unit length, which depends on the effective dielec-
     tric constant Ereff of the PCB material.

     To keep it low we need to make ‘l’ as well as ‘Zch’ low. Hence, we can formulate the fol-
     lowing design rules to keep traces loop inductances low:

     1. Keep ‘l’ length as short as possible. Place decoupling ceramic capacitors as close
     to the IC as possible.

     2.   Keep the width of the traces as wide as possible. This will keep Zch low.

     3. Keep the height between the component layer and ground and power planes as low
     as possible. This will also keep Zch low.




72                          Copyright Sierra Circuits Inc., 2020
6.4.2.6 Via Loop Inductance

For a pair of vias (of height h, via diameter d, and center to center distance D), the via
loop inductance Lvia is given by:

        Lvp ≈ 0.4 x h x [ln(2D/d) +1/4] nH …… where h is in mm. ……………… (PI-15)




Example: 8mil ‘d’ via, with D = 40mils and h = 60mils = 1.5mm, Lvp = 1.53nH.
6.4.2.7 Planes Loop Inductance

If w is the width, l the length and h the separation between two planes, the loop induc-
tance is given by

             Lploop = (1.28 h l / w) nH; h is in mm. ……………………………… (PI-16)


Example: If l = 5, w and h = 10mils = 0.25mm, Lplane = 1.6nH.




All the above come into play when considering the total inductance in the path of IC
power supply ground pins connections to the power and ground planes and the decou-
pling capacitors.




                                 www.protoexpress.com                                        73
     In the above example, the IC and decoupling capacitor connections to the ground and
     power planes are shown.

     Loop 1 and Loop 3 are via loops, Loop 2 is a plane loop or via to plane spreading loop.

     6.4.2.8 Spreading Loop Inductance

     Spreading loop inductance between two vias (diameter ‘d’) with separation ‘D’ in the
     loop of two planes of vertical separation ‘h’ is given by

                  Lvia-via = 0.84 h ln(D/d) nH; h is in mm. ……………………….. (PI-17)

     The overall inductance in the above scenario of a decoupling capacitor can be of the
     order of a few nH as compared to ~1nH for the internal ESL of the capacitor.

     To keep via related inductance low, we should use the following rules:

     i.       Design vias with larger diameters
     ii.      Keep the distance between vias small
     iii.     Keep the height of vias and the distances between power and ground
              planes small

     6.4.2.9 Capacitance of a Pair of Planes

     Inherent capacitance between power and ground planes plays an important decoupling
     role at high frequencies to keep the PDN impedance under control.

     Capacitance between two planes ( like shown in figure PI-9 earlier) is given by

                Cplane = €reff 225 (A / h) pF ……………………………………………… (PI-18)


74                         Copyright Sierra Circuits Inc., 2020
Where A is the area of the coupling planes in square inches, h is the separation height in
mils in between the planes, and €reff is the dielectric constant ( or relative permittivity)
of the dielectric material between the planes.

Example: If A = 4” x 6” = 24 sq.” and h = 4 mils, and €r = 3.8, then

Cplane = (225 x 3.8 x 24) x 4 = 5130pF = 5.13nF.

If we calculate the inductance of these planes loop as per equation PI-16, we get:

Lploop = 1.28x(4/40) x 6/4 = 0.192nH.

This gives the resonant frequency of the planes as:

fr_planes = 1/(2π√(LC)) = 160MHz.

So, this will play a useful role in the frequency range of 100 to 200MHz.

6.4.2.10 IC Package and Internal Die

Beyond a few 100MHz, the parasitics inside the IC package and inductances and ca-
pacitances in the semiconductor die dominate in determining the ZPDN and they practi-
cally limit the safe highest frequency beyond which the IC should not be used. However,
control of this is beyond the scope of the PCB designer, so we shall not go into further
details of this topic.

6.5 Power Integrity, Signal Integrity, and EMI are related
We observed that in order to keep ZPDN within control, we need to keep the dielectric
height low between a ground plane and components, and also between power and
ground planes. This is also required to reduce crosstalk and maintain good signal in-
tegrity. Thus, good power integrity also leads to better signal integrity. Furthermore, if
noise on the PDN is controlled, then the PDN noise coupled onto signal nets will also be
reduced and furthermore EMI will also be controlled.




                             www.protoexpress.com                                              75
     7. High-Speed PCB Layout Design
     The high-speed board layout design requires careful planning of footprint design, com-
     ponent placement, and routing of the traces. This chapter discusses the essential lay-
     out design requirements in a high-speed design.




     7.1 Footprint Design for High-Speed Boards
     7.1.1 Component Footprint Shapes

     During a PCB design, a lot of thought is put into the schematic organization, board
     materials, layer configuration, critical component placement, and routing of high-speed
     signals. But one thing doesn’t get as much attention as the rest of the design aspects
     is the footprint shapes. Although the components used in the high-speed design aren’t
     much different from the conventional design, there are some minute changes that can
     help in creating a high-speed design.

     7.1.2 Pad Shapes for High-Speed PCB Design

     In high-speed design, the primary thing to consider during the evaluation of footprint
     shapes is the size of the footprint pad shapes.




76
The pad shapes are the bare metal pads where the component pins will be soldered to
once the PCB is manufactured. Generally, some of the pad shapes are replicated to pro-
duce an entire component footprint shape. Approximately, the PCB pads are 30% larger
than the pins. The pad sizes are carefully calculated considering the manufacturing
issues that could arise during the fabrication process. Issues like tombstoning, where
the surface mount devices like capacitors and resistors flip up one side can ruin the
functionality of the board. With the right pad size, these kinds of issues can be resolved
with manual rework.

Despite all these benefits, for a high-speed design, the extra metal can increase para-
sitic capacitance and increase the connection length between critical components. In
order to suit the high-speed needs, the pad sizes must be reduced to avoid the parasitic
capacitances. Instead of enlarging the pad size by 30% of the actual pin size, it would
be beneficial to increase it only by a small margin of 5%.

Additionally, the connection lengths can be reduced by decreasing the spacing between
components. Implementing smaller pad sizes does not affect the mechanical strength
since the contact area between the pins and the PCB remains the same. Smaller pads
occupy less space on the board but the manufacturing cost goes up. The designer
should understand the manufacturing capabilities of a PCB manufacturer before reduc-
ing the footprint pad sizes.

Another design technique that can help in high-speed design is rounding the corners of
the pads. Incorporating rounded pads will enable the designer to route traces closer to
the pads. This will reduce connection lengths creating a compact circuitry.

7.2 Component Placement
7.2.1 Component Placement Strategy

The systematic placement of components plays a prominent role in high-speed PCB
design. Here are some strategies to consider for high-speed circuits.

7.2.2 Floor Planning

The first step in PCB layout design is to have a floorplan. A floorplan is a sketch that
allocates general areas where blocks of circuitry are to be placed on the board.




                                                                                             77
     7.2.2.1 Wonders that a Floorplan can do

     The floorplan links the schematic drawing and the layout. It provides a head start
     to the designer on component placement. A pre-placement floorplan will allow the
     designer to optimize the component placement for signal integrity goals. Also, the
     small components, like bypass capacitors and termination resistors, will be placed
     at an early stage instead of getting squeezed into the design at the end. The func-
     tional blocks of circuitry like power conditioning, RF, digital, analog, etc., should be
     arranged as groups to reduce signal crossing.

     A floorplan gives an insight into how the signals flow between functional blocks. For
     an efficient board, group the power conditioning together so that their signals do not
     have to cross through sensitive areas of RF circuitry. Plan your placement to main-
     tain the connection lengths as short as possible. The components that are part of
     high-speed signal paths where multiple nets connect a series of components should
     be placed as close together. The designer has to consider the routing channels while
     planning the component placement to ensure there is adequate space. The require-
     ments of power and ground planes should also be considered when planning out the
     placement of functional blocks of circuitry.

     Always implement continuous power planes unless there is a scenario where the de-
     sign demands a split power plane. When dealing with split power planes, be cautious
     while placing the connected components across the split. The high-speed transmis-
     sion lines should not cross the splits in power planes since it will break up the return
     path for those signals. Finally, avoid placing components of a different functional
     group in the midst of another circuit. Even this will affect the return path of the
     circuit.

     7.2.2.2 Component Placement Considerations in High-Speed PCBs

     As a first step, the designer should read the schematic and breakdown into sub-sec-
     tions depending on the circuit function. For instance: analog, digital, high-speed,
     high-current, power supply, etc..




78
Apart from the circuit function, the voltage and current levels should be analyzed.
Circuits with similar VCC and GND should be grouped and placed together.




Refer to the schematic circuit diagram while placing the components. Identify the
main components of the circuit such as microprocessors, ethernet chips, memories
etc. Place these as per the floorplan and with shortest traces between these main
chips as per the datasheet guidelines and which makes the signal flow smooth and
unidirectional as far as possible. Next, place the components associated with the
main components such as crystal oscillators, decoupling capacitors, termination
resistors.

Some of the component placement considerations are discussed below.

•   To begin with, avoid placing sensitive high-speed devices close to the edge of
    the board. This is because the edge of the board possesses different impedance
    characteristics and also there is a higher chance of electromagnetic interference
    (EMI). On top of this, connectors that connect the PCB can radiate EMI. In view
    of these factors, it will be a good practice to place sensitive high-speed devices
    close to the board center to reduce the influence of EMI.

•   The thermal effect is another crucial aspect to be considered. In high-speed
    boards, the devices may run at a higher temperature than standard board com-
    ponents. To ensure that these hot components stay cool, implement a place-
    ment strategy in which these components receive an unrestricted airflow. For
    instance, do not place bigger components like connectors in the path of airflow
    to a hot BGA.




                                                                                         79
     7.2.3 Termination Resistors
     In high-speed PCBs, the termination resistors must be placed along with the rest of
     the components instead of squeezing them in the end. These resistors are usually
     addressed at the end once the main parts of the circuitry have been placed. Since
     termination resistors are part of the circuit as a whole, their placement is critical for
     the accurate operation of the circuit.

     Here are two commonly used schemes for placing termination resistors:

     Simple parallel termination:

      A termination resistor is placed on the end of the circuit nearest to the receiver while
     the other side is attached to power or ground plane. The greater the trace length
     from the load pin to the resistor, the higher the circuit susceptible to signal reflection.
     Hence, the designer should place the resistor as close as possible to the load pin of
     the receiver to minimize the stub length of the connecting trace.

     Series termination:

     The series resistor is attached inline immediately after the driver pin of the circuit.
     Since the resistor is an inline part, it doesn’t have the stub length to be considered
     like in a parallel termination resistor. After figuring out the right strategy for placing
     the termination resistors, the designer can include it in the floorplan.

     In view of the above strategies, along with circuitry path and power and ground re-
     quirements, a commendable design can be drafted for high-speed layouts.

     While the whole component placement process is challenging, the way in which it is
     done will determine the manufacturability of the boards.




80
7.2.4 Component Orientation
Align similar components in the same direction. This helps in effective routing in
PCB design and ensures an error-free soldering process during assembly.




   Good Components Orientation (left) and Poor Components Orientation (right)


7.2.5 SMT and Through-Hole Component Placement
It’s advisable to place all the surface mount devices (SMD) on the same side of the
board. All through-hole components should be placed on the top side of the PCB to
reduce the assembly steps.

7.2.6 Via Shapes Considerations
In a high-speed circuit, any mental on the PCB should be considered as part of that
circuit. The trace lengths, the via size, and the via depth should be taken into account
for high-speed circuit calculation. The designer should understand that the via drill
size impacts the size of the via. Smaller the vias, the better will be the performance
of the circuit. Once the designer decides the vias sizes, the right placement of these
vias close to their respective pads should be considered.

In high-speed design, the vias are placed closed to the pad to avoid parasitic capac-
itance. Sometimes they are placed partially on the pad or entirely within the pad.
These adjustments require DRC adjustments.




                                                                                           81
     7.2.7 Component Selection and Placement
     It is good practice to minimize the use of sockets since they can introduce inductance.
     The designer should select the correct package, and accompanying component foot-
     print while designing for high-speed. Components like op-amps are available in differ-
     ent packages. One type of an op-amp may support shorter trace lengths in a circuit
     than the other. Finally, the component footprint shapes should be optimized for thermal
     considerations. The best way to dissipate heat is to place power pads right under the IC
     footprints that are connected to an internal plane. Even the smallest change in the pad
     shapes can tighten up the routing and decrease the connection lengths. This will result
     in a compact design.




       Good Components Orientation (left) and Poor Components Orientation (right)


     7.2.8 Separating Analog and Digital Circuits

     The placement routing topologies should be implemented in a way where the analog
     and digital GND do not mix up. The block diagram below shows the component place-
     ment. As we can observe in the first placement scheme, the analog and digital reverse
     currents overlap each other. This degrades the analog signals since the reference is
     disturbed. The PCB designer must avoid such practices. In the second scheme, we can
     see the GND paths for analog and digital are isolated. Here, the digital reverse current
     does not interfere with the analog reference GND. The designer should adopt a place-
     ment strategy such that even if the GND is not isolated (same net), the reverse currents
     of either section do not interfere with each other.




82
7.2.9 Ground Plane Isolation

Isolate the ground planes when required in the digital section. The figure presented
below shows the necessity of isolation within the digital sections. The USB and RJ45
connectors communicate externally. The board GND needs to be isolated to avoid any
noise or interference from external chassis/body GND.




                        RJ45 Connector and USB Connector
7.2.10 Surge Suppressors Placement

To protect circuits from external voltage surges often surge suppressing diodes and
inductors are provided in the circuits. Place these surge suppressors close to the in-
coming signal connectors and avoid vias connecting these surge suppressors and vias
have parasitic inductances.




                                                                                         83
     7.3 High-Speed Routing Strategy

     In a high-speed design, a well-organized trace routing after the placement of compo-
     nents is necessary for a circuit to operate without any signal integrity issues. The first
     step in routing is stack-up design. Stack-up design is an important part of routing strat-
     egy and needs to be planned before routing traces. One of the key factors in routing
     controlled impedance traces is to have unbroken ground planes below and above the
     top and bottom layers. For inner signal layers carrying controlled impedance traces in-
     corporate ground planes on either side of the controlled impedance traces.

     The design rules are next set in the PCB design tool. The differential pair and single-end-
     ed traces are identified and the classes are defined. In the classes, the trace widths and
     spacings are determined. Additionally, the via sizes are also specified.

     The routing is done in stages and the strategy is to route critical traces first. The design-
     er should route crystals to the devices they are associated with first with the shortest
     routes. The decoupling capacitors are placed close to the power pins of the ICs and
     they are routed first. Also the gnd vias for the decoupling capacitors are placed. Care
     is taken to keep place for the trace routing. Later, the controlled impedance traces are
     routed. The routing is then completed.

     7.3.1 Best Routing Practices for High-Speed Routing
     7.3.1.1 Ground and Power Planes

     One of the most usual problems in PCB design, and also in the system design, is the
     lack of a good ground structure.

     As a rule of thumb, it’s most beneficial to have a solid-rock common ground. For best
     results, a designer should incorporate at least a four-layer PCB. A four-layer PCB allows
     devoting one of the inner layers to a full ground plane. A ground plane composed of a
     full, plain, sheet of copper, as large as the PCB, ensures minimal impedance between
     any couple of grounded points. This ground plane should never be broken by routing
     any small track in it. There should exist only one ground plane on that layer.

     When some of the copper is removed on this ground plane, parasitic impedances are
     introduced immediately on the neighboring tracks. In this kind of a design, usually, the
     side nearest to the ground plane is used to mount all the high-speed components like
     RF components using microstrip techniques. The opposite side is used for mounting
     less critical components. The second inner layer is used for power distribution and
     different power islands are placed in this layer such as 3.3V, 1.8V, 5V, etc. The power
     islands are made as large as possible in order to reduce the impedance.




84
A double-sided PCB may be the right choice for economical use when it comes to cost
minimization. Achieving this is quite difficult. When there is a requirement to route
tracks on both sides of the PCB in the same area then a good ground plane is no longer
guaranteed. The only solution is then to implement huge ground planes on both sides
that are interconnected by plenty of vias.
                                        Designing a double-sided PCB can get complex
                                        since the ground plane gets shared between the
                                        top and bottom layers. The designer should en-
                                        sure that there is at least a full ground plane un-
                                        der the most critical section. The top side must
                                        be used for routing as much as possible with a
                                        few traces on the bottom side.
                                        Lots of interconnecting vias are needed to inter-
                                        connect the top and the bottom grounds.
             Ground stitching vias

Split ground planes are sometimes implemented in critical cases. For instance, a
ground plane for the logic sections and a ground plane for the analog components,
interconnected at a single point. The concept is to reduce the noise through the ground
planes. Sadly, it is quite challenging to accurately implement such an idea. In particular,
it is then mandatory to route all the traces going from one region to the other exclusive-
ly above this interconnecting point. If not then this gives a very good antenna which will
either transmit or receive spurious signals. In most cases, a full single ground is more
reliable and provides better results than split grounds, as long as the placement of the
components is adequate.




                                                                                              85
     Usually, a split ground plane is avoided unless there is a specific need like strong ESD
     risks. Or else, any track going from one ground area to the other should cross the
     boundary just under the interconnecting point. If not, then there will be a current loop
     leading to EMC problems.

     7.3.1.2 Polygon Voids

     The signal vias produce voids in the power and ground planes. Improper positioning
     of vias can create plane areas in which the current density is increased. These re-
     gions are called hot spots. These hot spots must be avoided. The best solution is to
     place the vias such that there is enough space between the vias for the power plane
     to pass through. As a thumb rule, place vias 15 mils apart wherever possible.




     Avoid copper plane hot spots.




86
7.3.1.3 Trace Bend Geometry

The bends should be kept minimum while routing high-speed signals. If the bends
are required, then 135° bends should be implemented instead of 90°.




Use 135⁰ bends instead of 90⁰.

To achieve a specific trace length, serpentine traces are needed. A minimum dis-
tance of 4 times the trace width must be maintained between adjacent copper in a
single trace. Each segment of the bends should be 1.5 times the trace width. Most of
the DRCs in CAD tools do not check these minimum distances as the traces are part
of the same net.




Keep minimum distance and segment length at bends.




                                                                                       87
     7.3.1.4 Signal Proximity


     A minimum distance should be maintained between traces to minimize the crosstalk.
     The crosstalk level depends on the length and the distance between two traces. In
     some areas, the routing of traces reaches a bottleneck where the traces are closer
     than the allowed distance between them. In such situations, the distance between the
     signals outside the bottleneck should be increased. Even if the minimum requirement
     is met, the spacing can be increased a little further.




     Increase the spacing between traces wherever possible.

     Trace stubs:

     The long stub traces may act as antennas and consequently increase problems com-
     plying with EMC standards. Stub traces can also create reflections that negatively af-
     fect signal integrity. Pull-up or pull-down resistors on high-speed signals are common
     sources of stubs. If such resistors are required then route the signals as a daisy chain.




     Avoid stub traces by implementing daisy chain routing.




88
7.3.1.5 Differential Pair Signals

When routing high-speed differential pairs parallel to each other, a constant distance
should be maintained between them. This distance helps to achieve the specified dif-
ferential impedance. The designer should minimize the area in which the specified
spacing is enlarged due to pad entries. The differential pairs should be routed symmet-
rically.




Route the differential pairs symmetrically and keep the signals parallel.




The designer should not place any components or vias between differential pairs even
if the signals are routed symmetrically. Placement of components and vias between
differential pairs could lead to EMC problems and impedance discontinuities.




Do not include any components or vias in-between a differential.




                                                                                          89
     Some high-speed differential pairs need serial coupling capacitors. These capacitors
     should be placed symmetrically. The capacitors and the pads produce impedance dis-
     continuities. Capacitor sizes such as 0402 are preferable, 0603 are acceptable. Larger
     packages such as 0805 or C-packs must be avoided.




     Place coupling capacitors symmetrically




     Since the vias introduce an enormous discontinuity in impedance, the number of vias
     must be reduced and should be placed symmetrically. If the signals change the planes
     then the ground transition vias are required.




      Place vias symmetrically.




90                       Copyright Sierra Circuits Inc., 2020
While routing a differential pair, both the traces should be routed on the same layer so
that the impedance requirements are met. Also, the same number of vias should be
included in the traces.




Route pairs on the same layer and place the same number of vias.
7.3.1.6 Length Matching

The high-speed interfaces have additional requirements concerning the time of arrival
clock skew between different traces and pairs of signals. For instance, in a high-speed
parallel bus, all data signals need to arrive within a time period in order to meet the
setup and hold time requirements of the receiver. The PCB designer should ensure that
such permitted skew is not exceeded. To achieve this requirement, the length matching
is necessary.

The differential pair signals demand a very tight delay skew between the positive and
negative signal traces. Hence, any length differences should be compensated by using
serpentines. The geometry of serpentine traces should be carefully designed in order to
reduce impedance discontinuity.




  Use this recommended serpentine trace geometry.


                            www.protoexpress.com                                           91
     The designer should place the serpentine traces at the root of the length mismatching.
     This ensures that the positive and negative signal components are propagated syn-
     chronously over the connection.




     Add length correction to the mismatching point.


     The bends are usually the source of length mismatches. The compensation should be
     planted very close to the bend with a maximum distance of 15mm.




     Place length compensation close to the bends.

     Generally, two bends compensate each other. If the bends are closer than 15mm then
     no additional compensation with serpentines are necessary. The signals should not
     traverse asynchronously over a distance more than 15mm.




92                         Copyright Sierra Circuits Inc., 2020
Bends can compensate each other.

The mismatches in each segment of a differential pair connection should be matched
individually. In the figure shown below, the vias separate the differential pair into two
segments. The bends need to be compensated individually here. This ensures that the
positive and negative signals are propagated synchronously through the vias. The DRC
overlooks this violation since it only checks the length difference over the whole
connection.




Length differences should be compensated in each segment.

The signal speed is not the same in all the layers of a PCB. Since it is hard to figure
out the difference, it is preferable to route signals on the same layer if they need to be
matched.




Pairs within the same interface should be preferably routed on the same layer.


                           www.protoexpress.com                                          93
     Some of the CAD tools also consider the trace length inside a pad to its total length.
     The figure shown below depicts two layouts which are similar from an electrical point
     of view.

     In the left figure, the traces inside the capacitor pads do not have an equal length. Even
     though the signals are not using the internal traces, some CAD tools consider this as
     part of the length calculation and display a length difference between the positive and
     negative signals. In order to minimize this, ensure that the pad entry is equal for both
     signals.

     In the same way, some CAD tools do not consider the length of vias when calculating
     the total length. Since differential pairs should have the same amount of vias in both
     traces, the error does not affect the length matching. However, it can affect calcula-
     tions for matching two differential pairs or the matching of parallel buses.




     Pay attention to length calculation issues encountered in some CAD tools.
     A symmetric breakout of differential pair signal is preferred wherever possible in order
     to avoid the serpentine traces.




     This is the preferred symmetrical breakout.

     Small loops can be included for the shorter trace instead of serpentine traces if there is
     enough space between pads. This is generally preferred over a serpentine trace.


94                          Copyright Sierra Circuits Inc., 2020
This is the preferred breakout of differential pairs.


7.3.1.7 Signal Return Path

An incorrect signal return path results in noise coupling and EMI issues. The designer
should always think of the signal return path when routing a signal. The power rails and
low-speed signals take the shortest return current path. In contrast to this, the return
current of high-speed signals tries to follow the signal path.




In high-speed signals, the return current tries to follow the signal path.



                             www.protoexpress.com                                      95
     A signal should not be routed over a spit plane as the return path is not able to follow
     the signal trace. If a plane is split between a sink and source, route the signal trace
     around it. If the forward and return paths of a signal are separated, the area between
     them acts as a loop antenna.

     Stitching capacitors should be incorporated if a signal needs to be routed over two
     different reference planes. The stitching capacitor enables the return current to travel
     from one reference plane to the other. The capacitor should be placed close to the
     signal path so that the distance between the forward and return path are kept small.
     Generally, the values of stitching capacitors are between 10nF and 100nF.




     Placement of stitching capacitors over split planes.

     In general, plane obstructions and plane slots must be avoided. If it is really necessary
     to route over such obstruction then stitching capacitors should be used.




     Stitching capacitors incorporated when routing over plane obstructs.

     The designer should look out for voids in reference planes while routing high-speed sig-
     nals. Voids in reference planes are generated when placing vias close together. Large
     void areas should be avoided by ensuring adequate separation between vias. It is better
     to place fewer ground and power vias in order to reduce via voids.



96                         Copyright Sierra Circuits Inc., 2020
Avoid via plane voids.

The return path should be considered at the source and sink of a signal. In the figure
shown below, the left design is considered to be a bad design. Since there is only one
single ground via on the source side, the return current cannot travel back over the ref-
erence ground plane as intended. The return path is the ground connection present on
the top layer instead. The problem in hand is that the impedance of the signal trace is
calculated as referenced to the ground plane and not to the ground trace on the top lay-
er. Hence, it is essential to place ground vias at the source and sink side of the signal.
This allows the return current to travel back on the ground plane.




Return path should be considered when placing ground vias.

As far as possible avoid using power planes as references. But when a power plane is
considered as a reference to a signal, then the signal should be able to propagate back
over the power plane. The signals are referenced to ground in the source and sink. To
switch the reference to the power plane, stitching capacitors should be incorporated at
the sink and source. If the sink and source are utilizing the same power rail for their sup-
ply, then the bypass capacitors can act as stitching capacitors if they are placed close
to the signal entry/exit point. The ideal value for the stitching capacitor is between 10nF
and 100nF.



                           www.protoexpress.com                                            97
     Include stitching capacitors when using power planes as reference.

     When a signal switches a layer, the reference ground plane will also be switched. Hence,
     stitching vias should be added close to the layer change vias. This permits the return
     current to change the ground plane. When dealing with differential signals, the switch-
     ing ground vias should be placed symmetrically.




     Stitching capacitors should be included when signal changes ground reference.

     When a signal switches to a layer that has a different net as a reference then stitching
     capacitors should be implemented. This permits the return current to flow from the
     ground to the power plane through the stitching capacitor. Also, the stitching capacitor
     placement and routing should be symmetrical when differential pairs are considered.




98                         Copyright Sierra Circuits Inc., 2020
Incorporate stitching capacitors when signal reference plane changes.
The designer should not route high-speed signals on the edge of the reference planes
or close to PCB borders. This can have an adverse impact on the trace impedance.




High-speed signals should not be routed at plane and PCB edges.




                         www.protoexpress.com                                      99
      7.3.1.8 Split Plane Approach

      The split ground approach makes it easy in the schematic to determine which compo-
      nents and pins should be connected to the digital ground and which ones to the ana-
      log ground. These kinds of schematics can be routed by placing two different ground
      planes as reference. The two planes should be placed accurately. The analog ground
      must be placed underneath the analog pins and components. Note: It is always prefer-
      able to have one solid ground plane.




      Power plane splitting needs to be placed carefully.

      The mixed-signal circuits require the analog and digital ground connected together at
      a single point. In the reference schematics, it is always recommended to place ferrite
      beads or zero-ohm resistors between the two nets. The merging of the digital and an-
      alog ground should be placed close to the integrated circuit. In a mixed-signal design
      that has split planes, the digital signal should not be routed over an analog ground
      plane and the analog signal should not be routed over the digital ground plane.




      Digital signals should not cross the analog ground plane.




100                            Copyright Sierra Circuits Inc., 2020
7.3.1.9 Virtual Split Approach

In the virtual split approach, the analog and digital ground are not separated in the sche-
matic diagram. Also, in the two ground domains are not electrically split in the layout
either. Interestingly, the layout is split virtually, i.e., an imaginary separation is drawn
between the analog and digital ground. The components should be placed carefully
considering the correct side of the virtually split planes.




Components should be placed carefully with virtual plane splitting.

The designer should keep in mind the virtual line between the two ground domains
during the routing process. Neither the digital nor the analog signal trace is allowed to
cross the virtual split line.




Digital signals should not cross the virtual analog ground.




                            www.protoexpress.com                                           101
      7.3.1.10 Components Selection for High Speed Design

      The board design begins with the schematic, specifically with the selection of the com-
      ponents. The surface-mount devices (SMD) are preferred since smaller components
      and shorter wires result in stablest high-speed performances.

      Choosing the package can get tricky sometimes. One beneficial criterion is to look at
      the track width calculated for a 50-ohm impedance. The best high-speed performances
      are usually accomplished if the width of the component is close to track width. This will
      lower the impedance matching issues between the track and the component pad.




      The impedance mismatches can be reduced by selecting those components that have
      a package that is almost the same size as of the calculated track width. The test points
      should be planned at the schematic phase.




          TIP:
          When it comes to power supplies, implement separated digital and analog
          power supplies, even using only a small SMT ferrite bead to isolate them. If
          there are successive high frequency amplifying stages, then decouple the pow-
          er supply of these successive circuits, or else this might result in an oscillation
          somewhere in the circuit.




102                           Copyright Sierra Circuits Inc., 2020
7.4 Vias and Microvias

In a high-speed circuit, any mental on the PCB should be considered as part of that
circuit. The trace lengths, the via size, and the via depth should be taken into account
for high-speed circuit calculation. The designer should understand that the via drill size
impacts the size of the via. Smaller the vias, the better will be the performance of the
circuit. Once the designer decides the vias sizes, the right placement of these vias
close to their respective pads should be considered.

In high-speed design, the vias are placed closed to the pad to avoid parasitic capaci-
tance. Sometimes they are placed partially on the pad or entirely within the pad. These
adjustments require DRC adjustments.

7.4.1 Different Types of Vias




Depending on their functionality, there are different types of vias that are drilled into a
PCB.

7.4.1.1 Through-hole Vias

The hole penetrates from the top layer to the bottom layer. They can be either PTH or
NPTH. For PTH, the connection is established from the top to the bottom layer.

7.4.1.2 Blind Vias

The hole penetrates from an exterior layer and ends at an interior layer. Here, the hole
doesn’t penetrate through the entire board but connects the PCB’s exterior layers to at
least one interior layer. Either the connection is from the top layer to a layer in the center
or from the bottom layer to some layer in the interior region. The other end of the hole
cannot be seen once the lamination is done. Hence, they are called blind vias.




                             www.protoexpress.com                                            103
      7.4.1.3 Buried Vias

      These vias are located in the interior region of the PCB. The buried vias have no paths
      to the outer layers. They connect the inner layers and stay hidden from sight. As per IPC
      standards, buried vias and blind vias must be 6 mils (150 micrometers) in diameter or
      less.

      7.4.1.4 Microvias

      The most commonly known vias are the microvias (µvias). During PCB manufacturing,
      microvias are drilled by lasers and have a smaller diameter compared to the standard
      through-hole vias. Microvias are generally implemented in High-Density Interconnec-
      tion (HDI) PCBs. The depth of a microvia isn’t usually more than two layers deep since
      the plating of copper inside these small vias is a tedious task. The smaller the diameter
      of a via, the higher should be the throwing power of the plating bath to achieve electro-
      less copper plating.

      Microvias can be classified into stacked vias and staggered vias based on their loca-
      tion in the PCB layers.

      ·      Stacked vias are piled on top of one another in different layers.
      ·      Staggered vias are scattered in the different layers. And they are more
             expensive.
      ·      Additionally, there is another type of microvias called skipvias. Skipvias skip
             one layer, meaning, they pass through a layer making no electrical contact
             with that specific layer. The skipped layer will not form an electric connection
             with that via.

      Microvias improve the electrical characteristics and also allow miniaturization for high-
      er functionality in less space. This, in turn, makes room for large pin-count chips that
      can be found in smartphones and other mobile devices.

      Microvias reduce the layer count in printed circuit board designs and enable higher
      routing density. This eliminates the need for through-hole vias. The microvias micro
      size and capabilities have successively increased processing power. The implementa-
      tion of microvias instead of through-holes can reduce the layer count of PCBs and also
      ease the BGA breakout. Without microvias, you would still be using a big fat cordless
      phone instead of your sleek little smartphone.




104                          Copyright Sierra Circuits Inc., 2020
7.4.1.5 Via-In-Pad




Implementation of via in pad or via in pad plated over (VIPPO) in your design

                                                         The increasing signal speed,
                                                         board component density, and
                                                         PCB thickness have led to the
                                                         implementation of via-in-pad.
                                                         The PCB design (CAD design)
                                                         engineers implement VIPPO
                                                         along with the conventional via
                                                         structures in order to achieve
                                                         routability and signal integrity
                                                         requirements.




                Via-In-Pad Vs. Traditional Via


7.4.1.5.1 What is Via-in-pad?


In traditional vias, the signal trace is routed away from the pad and then to the via. You
can see this in the above diagram. This is done to avoid seepage of the solder paste into
the via during the reflow process. In a via-in-pad, the drilled via is present right below a
pad. To be precise, the via is placed within the pad of a surface mount component.




                                 www.protoexpress.com                                          105
                                       Traditional dog bone and VIPPO

      First, the via is filled with non-conductive epoxy depending on the designer’s require-
      ment. Later, this via is capped and plated to regain the land area. This technique shrinks
      the signal path lengths and as a result eliminates the parasitic inductance and capaci-
      tance effect.

      The via-in-pad accommodates smaller component pitch sizes and shrinks the PCB’s
      overall size. This technology is ideal for BGA footprint components.

      To make things better, back-drilling process is implemented along with the via-in-pad.
      The back drilling is performed to eliminate the signal reflections within the unused por-
      tion of the via. The unwanted via stub is drilled to remove any kind of signal reflection.
      This ensures signal integrity.

      7.4.2 PCB Design Tips for Vias
      Here are a few quick tips that you can consider while employing vias in your design:

      •   Use maximum micro via structures in your design.
      •   Stacked and staggered vias: Choose staggered instead of stacked vias since the
          stacked vias need to be filled and planarized. This process is time consuming and
          expensive as well.
      •   Keep the aspect ratio minimum. This provides better electrical performance and
          signal integrity. Lower noise and crosstalk, and lower EMI/RFI.
      •   Implement smaller vias. This can help you build an efficient HDI PCB since the stray
          capacitance and inductance gets reduced.
      •   Via-in-pads must be filled, unless they reside in thermal pads.
      •   The pad matrix on which a BGA will be installed may include through vias and blind
          vias, but all of them must be filled and planarized, otherwise solder joints will be
          compromised.
      •

106                         Copyright Sierra Circuits Inc., 2020
•   Incorporate vias in the thermal pads under QFNs to help solder flow through to con-
    ductive planes.
•   The vias ensure a secure solder joint for the thermal pad and prevent solder from
    floating the package during assembly, which could hamper forming good solder
    joints at the QFN contacts.
•   An assembly shop can compensate for a lack of through vias in a thermal pad by
    adding windowpane-shaped opening in the solder paste stencil above the pad, to
    relieve solder pooling and outgassing during assembly, but the fix is less effective
    than if vias were present.
•   Check for minimum clearance of traces and vias from the routed/scored edges.
•   Check the position of vias for BGA packages.
•   Via-in-pad design requires filling.
•   Dog-bone design: Separate each via from its pad with a predefined short trace cov-
    ered with solder mask. Ensure there is no mask clearance for the vias under BGA.
•   The board documentation should include a drill file with tool codes and X-Y coordi-
    nates for all holes.
•   The fab drawing should include a drill chart with hole symbols on the drawing and
    finished hole sizes along with via tolerances.
•   The Gerber files should include via plugging holes if required.
•   Controlled depth for blind and buried vias.
•   Tolerance:

       o Minimum outer layer annular ring: as per IPC standards
       o Minimum inner layer annular ring: as per IPC standards
       o Drill to plane clearance: 8 mils
       o Diameter: ± 3 mils preferred
       o Location: 1 mil
       o Registration: 1 mil
       o Via clearance of solder mask: 2.5 mils bigger than via pad size
       o Encroachment of solder mask onto via: via size + 3 mils
       o Anti-pad: 16 mils bigger than the hole size and plane relief preferred 8 mils

There may be requirements for fabricators to plug, fill, or tent vias on a PCB.

7.4.3 Via Design
The effects of via design are discussed in this section. The Via design depends on two
parameters: the drill size and the pad size/annular ring. These parameters are recom-
mended in IPC standards.

The drill size depends on the thickness of the board. In a power board requiring high
currents, the drill size will depend on the current required per via.




                           www.protoexpress.com                                          107
      7.4.3.1. Class Type and Minimum Drill and Pad Requirements

      The charts mentioned below show that for a class 2 62 mil PCB the recommended drill
      size is 8 mils with a pad size of 18mils. For class 3 62 mils PCB the recommended drill
      size is 8 mils and pad size is 23 mils.

      •   Depending upon the Performance, the designs are classified as follows:

             1. Class-1: General electronic products
             2. Class-2: Dedicated service electronic products
             3. Class-3: High reliability electronic products

      •   Drill values depend on the class of the design, fabrication technique, and the PCB
          thickness.

      Below given are the few values for Class-2 and Class-3 that should be followed.




108                         Copyright Sierra Circuits Inc., 2020
7.4.3.2 Current carrying capacity of Vias

Vias are often used to tie power planes together and therefore it becomes necessary
to know the current capacity of the via. To understand the current capacity of a via,
it’s necessary to know the surface area of the via. The via forms a cylinder in the via
drill hole. The length of the cylinder is the thickness of the board ‘B’. The surface area
of the cylinder formed by the via copper plating ‘p’ is given by p*D* B where D is the
drill size or diameter of the drill hole. The thickness of the cylinder is equal to the
plating thickness which is 0.8 mils. If the cylinder of the via is imaginarily cut along
its length B and spread out, the via cylinder will be a trace of length B, thickness t=0.8
mils, and width p*D = 3.14 * via drill size. For 8 mils dril,l the trace width would be
8*3.14 = 25.12. Using a standard trace current calculator with ambient of 25 ⁰C and
temperature rise of 5 degrees and since the via is not covered by solder its equivalent
to an external trace. For an 8 mil drill the current capacity for 5 ⁰C temperature rise is
0.8 amps.




    Table 1: Current calculator for trace width     Table 2: Drill size and current capacity




                               www.protoexpress.com                                            109
      7.4.4 Microvias Design
      Microvias are the holes with diameters less than 6 mils. Practically speaking, vias pos-
      sess an inductive and capacitive parasitic value. The smaller vias have lower capaci-
      tance whereas the short length, larger diameter vias have lower inductance. The induc-
      tive and capacitive parasitics will affect the high-speed signals.

      The designer should use the upper layers for high priority supplies. Placing high tran-
      sient current supplies vertically closer to the device decreases the distance the cur-
      rents need to propagate through the vias. Also, the ground planes should be adjacent
      to high transient current power planes to reduce inductance and couple the high-fre-
      quency noise.

      The most important thing to consider while incorporating vias is the aspect ratio. The
      aspect ratio, via diameter to the dielectric thickness of the spanned layer, decides the
      reliability of a PCB. To understand more about vias, please have a look at Sierra Circuits’
      DFM Handbook.




110                          Copyright Sierra Circuits Inc., 2020
8. Appendix
8.1 High-Speed PCB Design Checklist
There are plenty of things that a designer should remember while designing a PCB.
Just so that you don’t miss out the vital aspects of designing, keep this checklist right
by your side when you draft your design.

1. Layout related:

        a. Verify that high-speed traces do not cross broken planes and are routed on
            solid planes.
        b. Controlled impedance traces should have ground reference for top and
            bottom layers.
        c. Controlled impedance traces should have ground reference on both sides in
            inner signal layers.
        d. Ground and power vias are near the related component pad with very short
            traces.
        e. Keep ground current loops minimum.
        f. Mention controlled impedance traces in your fab notes.
2. Mark the dimensions of the board.
3. Hole to hole dimension and mounting hole dimension start from the edge of the
   board.
4. Label all the test points.
5. Include signal names for connector pins wherever possible.
6. All legend text should be aligned in one or two directions only (size 30/6mils nom
   25/4).
7. All polarized components should possess polarity marking.
8. All ICs must have pin 1 indication.
9. Fab drawing checklist:
         a. Fab notes:
		               i. IPC Class 2 or Class 3 board type
		               ii. Layer wise impedance track details
		               iii. Color of solder mask
		               iv. Annular ring/drill size (minimum)
         b. Layer stack-up:
		               i. Mark board thickness
		               ii. Copper thickness for every layer
		               iii. Insulation material name and thickness
		               iv. Mention notes for blind and buried vias if applicable
		               v. Add a note for filled via-in-pads for BGA
		               vi. Fiducials minimum 3
10. Check if all the SMD components have defined solder mask and solder paste.
11.Verify whether the through-hole components have solder mask openings.
                           www.protoexpress.com                                             111
      12. The exposed center pad of QFN ICs should have paste in small patches.
      13. Update the drill chart.
      14. The drill chart should have separate drill symbols for each drill size:
              a. Use “+” for vias
              b. Square with an alphabet for plated holes (PTH)
              c. Triangle with an alphabet for non-plated holes (NPTH)
      15. Drill chart should display:
              a. +/– 3 mils tolerance for PTH
              b. +/ – 2 mils tolerance for NPTH
              c. Tolerance on vias can be adjusted depending on the via drill and pad size
              d. Typical via tolerance is set to +/– 3 mils
              e. Check if all the drills (in the drill chart) are whole numbers
              f. Check if each drill matches the desired value
      16. Check the dates and verify the date format in the template.
      17. Check the layout design file name.
      18. Update the name of the design in the template block.
      19. Check and clear all valid DRCs.
      20. Routing should be 100%.
      21. Read all the notes mentioned in the fab layer and other layers. Any changes made
          should be updated immediately. Also check the impedance value with layer stack.
      22. Create Gerber files.
      23. View the files with GC Prevue:
              a. Inspect for cleanliness, absence of silvers, and hanging nets
              b. SMB and SPB match
              c. SMT and SPT match
      24. Using GC Prevue, inspect individual copper pours for minimum spacing and
          absence of shorts between different copper pours.
      25. BOM validation with the right part numbers
      26. Create documents on:
              a. Assembly top and bottom layers
              b. Fab drawing
              c. Drill drawing
              d. All layers
              e. Schematic PDF
      27. Cutout on the board:
              a. Mark cutout on the board outline layer and fab layer
              b. Marking with dimensions on fab layer
              c. When generating Gerbers enable board outline layer on all layers
              d. Verify it in all layers by opening the Gerbers
              e. Cutout outline layer must be 2 mils
      28. Select the appropriate files (All .art files, art_aper, art_param, nc_param, .drl,
          placement file, ipc file).

      These pointers will definitely assist a designer to craft a board that can be easily
      manufactured.

112                         Copyright Sierra Circuits Inc., 2020
8.2 Sierra Circuits Deliverables
The Design deliverable in form of soft files will include the following:

•   Gerbers:

        TOP - top layer
       SMT - solder mask top
       SPT - solder paste top
       BOT - bottom layer
       SMB - solder mask bottom
       SPB - solder paste bottom
       SST - silkscreen top
       SSB - silkscreen bottom
       AST - assembly top
       ASB - assembly bottom
       Inner layers signal and power /GND
•   FAB drawing Outline drill drawing
•   NC drill file
•   Pick and place file
•   IPC 356 netlist file
•   ODB++ file
•   Project files (on request) CAD Files


8.3 Sierra Circuits PCB Design Capabilities
•   High-speed digital designs, analog designs, mixed designs, power designs, and RF
    designs
•   PCB design with controlled impedance requirements
•   PCB design for mechanical-constrained boards and enclosures
•   PCB design for flex, rigid and rigid-flex designs
•   PCB designs for mobile phones
•   HDI designs with via-in-pad, blind via, buried via and micro vias, via stacking and
    staggering technology
•   Designs with fine pitch BGAs of 0.4mm and 0.5mm
•   Designs with high-pin count full matrix BGAs 0.4mm pitch, PoP package, with 2
    mil/ 2mil tracks/spacings
•   Design for ROHS compliance
•   Stack-up design and impedance calculation for single-ended, differential, and co-
    planar-waveguide models

               https://www.protoexpress.com/pcb/pcb-design-service/


                             www.protoexpress.com                                         113
      A Special Thank You to Anil S Raiker




        This book couldn’t have been put together without the guid-
        ance of our beloved PCB Design Head, Mr. Anil. S. Raiker.
        Anil has an industry experience of more than 30 years and
        has a strong academic background with two master’s de-
        grees. He is quite passionate about PCB designing and
        leads some of the finest designers in the industry. Anil is a
        thinker, innovator, and a well-established PCB designer. He
        finds satisfaction in solving complex problems and never
        stops updating himself with new technologies. Apart from
        designing, Anil loves to explore new places in his free time.
        We are glad to have him on board. Thank you, Anil!




114                Copyright Sierra Circuits Inc., 2020
Sierra
SierraCircuits
       Circuits
1108 West Evelyn Avenue
   1108 WestCA
Sunnyvale,   Evelyn Avenue
                94086
+1 (408) 735-7137
   Sunnyvale, CA 94086
www.protoexpress.com
 +1 (408) 735-7137


==========================================
FILE: IEEE-SCC21-SI-PI.pdf
==========================================

Signal and Power Integrity Design Methodology for
   High-Performance Flight Computing Systems
            Nicholas G. Franconi, Alan D. George                         Alessandro D. Geist1 , Dennis Albaijes2
            NSF Center for Space, High-Performance,                    Science Data Processing Branch (Code 587) 1
              and Resilient Computing (SHREC)                               Flight Data Systems and Radiation
                    University of Pittsburgh                                    Effects Branch (Code 561) 2
                     Pittsburgh, PA, USA                                    NASA Goddard Space Flight Center
                nicholas.franconi@nsf-shrec.org                                     Greenbelt, MD, USA
                     alan.george@pitt.edu                              {alessandro.d.geist, dennis.albaijes}@nasa.gov



   Abstract—Computing capabilities of space systems have in-         use the limited processing resources available to spacecraft
creased onboard performance by orders of magnitude with the          [1]. NASA and AFRL have jointly identified improvements
use of radiation-tolerant field-programmable gate arrays (FPGA)      to onboard space computing as a “technology multiplier” and
and processors. The incorporation of signal and power integrity
analysis with printed circuit board (PCB) design in reliable         addressed a broad range of computing architectures require-
computing architectures for space systems has become critical        ments for future missions [2]. The next-generation of science
to enable future mission capabilities. Developers launch high-       and defense missions will require spacecraft processors to
performance processors into a breadth of orbits and missions,        support a variety of computationally intensive tasks (e.g. multi
running varying applications that create challenges for designing    core-processing), high-throughput sensor data processing (e.g.
reliable computing hardware. Specifically, for these designs, aca-
demic and industry research has focused on component radiation       hyperspectral imagers), autonomous spacecraft and constel-
performance, fault mitigation, and reliable architectures. How-      lation operation (e.g. Blackjack “Pit Boss”), and real-time
ever, other design parameters including electromagnetic interfer-    data generation and compression [3]. These systems require
ence (EMI), PCB stackup, signal integrity (SI), voltage regulator    advanced machine-learning and deep-learning algorithms that
module (VRM) design, and power distribution network (PDN)            have been developed and optimized for SmallSat and CubeSat
are often deprioritized or disregarded as the design matures.
Since these characteristics are becoming more significant in high-   applications to enhance these identified needs [4].
performance processor designs, this research presents a hardware        When evaluating the requirements for future missions, sys-
design and analysis methodology for high-performance, space-         tem designers must trade operational resiliency within the
computing systems that focuses on a holistic design approach         hazardous space environment, address application performance
and PDN reliability. While these challenges exist across all space   needs while meeting size, weight, power, and cost (SWaP-C)
hardware, the reduced PCB dimensions imposed by SmallSats
and CubeSats introduce additional hurdles, specifically to VRM       constraints [5]. Limitations of radiation-hardened (rad-hard)
and decoupling design. By examining the relationship between         processors exacerbate the ever-increasing mission processing
the PDN and radiation performance, an analytical relationship is     requirements and have led to the adoption of radiation-tolerant
developed that incorporates Total Ionizing Dose and Single-Event     processors, field programmable gate arrays (FPGAs), and
Transients to ensure reliability throughout the mission duration.    hybrid system-on-chip (SoC) devices that provide a suitable
The presented design methodology is applied to the SpaceCube
v3.0 Mini, an FPGA-based on-board science data processing            balance between processing capability, reliability, and SWaP-
system developed at NASA Goddard Space Flight Center.                C [6], [7]. The increased availability of SmallSat and CubeSat
   Index Terms—Power Distribution Network, Target Impedance,         launches has driven a transition from larger 6U (223×160
Signal Integrity, Printed Circuit Board, Space Computing             mm2 ) printed circuit board (PCB) form factors to smaller 3U
                                                                     (100×160 mm2 ) and even 1U (100×100 mm2 ) dimensions.
                      I. I NTRODUCTION                               The reduction in PCB area combined with the increased
   The increased accessibility to space provided by a mul-           processing capabilities from radiation-tolerant devices present
titude of launch opportunities has not led to more promi-            a number of obvious advantages for mission designers, but
nent advances in core spacecraft technologies (e.g. onboard          also introduce significant engineering challenges during the
computing). Due to unique mission architectures, innovations         design of architecture and layout, specifically relating to
in sensor technology and more frequent launches, mission             component density, reliability, power distribution networks
designers are able to propose more advanced concepts includ-         (PDN), power integrity (PI), and signal integrity (SI). While
ing spacecraft autonomy and machine learning that outpace            advances in PCB manufacturing and assembly technologies
the capabilities of onboard space processing. In the 2018            are enabling for commercial processors, additional research
decadal strategy for Earth observations from space, the Na-          is required to understand the impact of these advances on
tional Academies’ Space Studies Board (SSB) highlighted the          reliability [8]. When comparing devices incorporated into
need for more advanced analysis methodologies to efficiently         these PCB assemblies, researchers have historically focused on
the reliability and performance metrics of rad-hard processors      processing and reconfigurable logic to enable resiliency and
and FPGAs [9]. However, these studies do not consider the           performance while adapting to the radiation environment [11].
radiation and reliability effects on complex and dense PDN          The selection of an appropriate architecture for an intended
designs with large step-load current transients required by         application presents a number of difficulties and is non-trivial.
state-of-the-art FPGAs and processors [10]. These transients        To simplify the selection process, a framework for analyzing
can easily stress point-of load (PoL) converters, decoupling        the performance of processor architectures based on the com-
networks, and PCBs beyond their capabilities if not properly        putational density (CD) and measured in gig-operations per
accounted for. The reliability requirements levied on spacecraft    second was developed by [9]. While the methodology was
avionics and instrument processors combined with smaller            tested based on current onboard space computing devices at
PCB dimensions, high-density interconnects (HDI), limited           the time of publication, recent research has updated these met-
radiation-hardened components, and mil-spec capacitors selec-       rics to include the current state-of-the-art processors, FPGAs,
tion requires a re-evaluation of traditional spaceflight design     and SoCs [3], [12]. Figure 1 is a compilation of the previous
methodologies for future missions.                                  metrics showing the continued exponential increasing trends
   In this publication, the current ad-hoc design process is        in performance for radiation-tolerant SoC devices. Microsemi
discussed with commonly referenced rules-of-thumb for tradi-        FPGAs prior to the RTG4 were not included in [9], but are
tional larger spacecraft avionics. We incorporate this process      still relevant to the comparisons and presented for continuity.
with new research to present a design and analysis methodol-
ogy that addresses the challenges of high-performance space-
flight processors design. Additionally, we present a novel
methodology that enhances the traditional target impedance
approach and incorporates total ionizing dose (TID) and
single-event transient (SET) effects. Our hybrid approach
provides a clear path to reliably evaluate high-performance
spaceflight computing systems and tailor performance to mis-
sion specific orbits and operating environments. The proposed
methodology is applied to the SpaceCube v3.0 Mini processor
card that features the Xilinx Kintex UltraScale FGPA, and
was developed at NASA Goddard Space Flight Center in
the Science Data Processing branch. The remainder of this
publication is organized as follows. Section II provides an
overview of rad-hard processors, FPGAs, and hybrid SoCs
for space applications, SmallSat reliability metrics, and power
distribution networks for space hardware. Section IV describes
                                                                    Fig. 1. Performance comparison between rad-hard and radiation-tolerant
our design and analysis methodology with the hybrid target          processors (green), FPGAs (black), and system-on-chip (red) devices based
impedance. Section V applies the design framework to the            on the giga-operations per second (GOPS) metric compiled from [3], [9], [12]
SpaceCube v3.0 Mini processor card including insights gained
throughout the development process. Finally, Section VI pro-           While the performance increases are evident, the chal-
vides concluding statements and insights for future work.           lenges levied to design and manufacture these systems has
                                                                    also increased exponentially. The combination of decreased
                      II. BACKGROUND                                transistor channel widths and the increase in operating fre-
   This section provides an overview of rad-hard and rad-           quencies of current architectures have led to higher power
tolerant FPGAs, processors, and SoCs including their benefits       densities with core voltages below 1.0 V and tolerances less
and challenges for space computing. Radiation effects and           than ±3%. Whereas processors 20 years ago could operate
reliability in SmallSat and CubeSat missions are presented as       with core voltage tolerances of ±125 mV, current state-of-
it pertains to the PDN and system-level design. Finally, we         the-art architectures requires regulation to within ±25 mV
summarize challenges with space-grade capacitors.                   [13]. Simultaneously, the maximum core current for FPGAs
                                                                    has increased beyond 30 A with load transients as fast 4
A. High-Performance Processors for Space Systems                    A/ns, and the next generation of processing architectures (e.g.
   The landscape of spacecraft and mission development has          Xilinx Versal) exceeding 165 A [14]. These core currents
shifted from large monolithic satellites to SmallSats and           are composed of both static and dynamic components. The
CubeSats. As the same time, the space industry has begun to         static current represents the continuous current drawn from
develop systems with a combination of radiation-tolerant and        a device with no activity, whereas dynamic current represents
rad-hard devices, using both processors and FPGAs to meet the       the additional current resulting from design activity. The static
processing and instrumentation needs of missions. Given their       and dynamic currents are design dependent, but are typically
prevalence in the commercial world, hybrid SoCs are of par-         derived from clock frequency, temperature, process variation,
ticular interest as they provide the benefits of both fixed-logic   processor load, and FPGA fabric utilization. While the rela-
tionship between the static current, temperature, and transistor             they represent an enveloping worst-case example for effective
leakage is essential to switched converter design and thermal                bounding of target impedance calculations.
limitations, the dynamic current represents the dominant factor
                                                                             B. Radiation Effects
for PDN design. Fast transients will stress a poorly designed
decoupling network and can lead to processor brownout and                       Radiation effects relevant to processing architectures and
hardware reliability problems (e.g. premature capacitor failure)             power systems are broken into three categories: (1) Total
if not identified prior to flight. Figure 2 shows the core voltage           Ionizing Dose (TID), (2) Displacement Damage (DD), and
with tolerance (left y-axis) and peak core current (right y-                 (3) Single-Event Effect (SEE). TID is the cumulative long-
axis) that provides a comparison between processing capability               term damage resulting from ionization primarily caused by
and power for each device in Figure 1. As expected, the                      low energy protons and electrons. DD is permanent damage
exponential increase in computing performance is mirrored by                 caused by the long-term displacement of lattice atoms after
the peak core current.                                                       collisions with protons or neutrons. SEE are destructive and
                                                                             non-destructive events that occur when heavy ions or high-
                                                                             energy protons pass through a semiconductor and create excess
                                                                             charge carriers. Further categorization of relevant SEEs are
                                                                             provided below.
                                                                                • Single-Event Transients (SET) are non-destructive tem-
                                                                                   porary variations producing atypical circuit responses.
                                                                                • Single-Event Upsets (SEU) are non-destructive recover-
                                                                                   able events that induce a state change, typically associated
                                                                                   with memory bit-flips.
                                                                                • Single-Event Latch-up (SEL) is a potentially destructive
                                                                                   event where a device current is driven out of specification.
                                                                                • Single-Event Burnout (SEB) is a destructive event where
                                                                                   a permanent short forms between the source and drain.
                                                                                • Single-Event Gate Rupture (SEGR) is a destructive event
                                                                                   where a permanent short forms between the gate & drain.
Fig. 2. Rad-hard and radiation-tolerant core voltages and currents for       For processor and FPGA architectures, the response to SET,
processor (green), FPGA (black), and system-on-chip (red) devices based on   SEU, and SEL differ, but several dependable computing
90% fabric utilization for FPGAs and 100% processor load                     techniques exist for both architectures with a comprehensive
                                                                             overview covered in [15]. Unlike processing architectures,
   To account for the variability in power estimation between                radiation effects in power systems are complicated by the wide
devices, specific processor and FPGA designs were created                    range of analog and digital parameters that can be affected
to develop a real-world maximum current for each type                        [16]. With the complexity related to space system design,
of computing architecture. To provide a realistic use case,                  radiation-beam testing is typically used to characterize device
each architecture was configured with a mixture of high-                     susceptibility to radiation and provide insight to the device’s
performance non-volatile memory (e.g. DDR) in addition to                    expected survival for a given orbit. Radiation effects and
low-speed (e.g. low-voltage differential signal (LVDS) and                   radiation-beam testing are covered in-depth in [17]. Addi-
general purpose input output (GPIO)) and high throughput                     tionally, NASA Electronics and Packaging Program (NEPP)
interfaces (e.g. multi-gigabit transceivers), where applicable.              developed the Radiation Hardness Assurance (RHA) program
Additionally, each device was configured for maximum pro-                    as a recommended multi-step approach to designing reliable
cess variation and a 25◦ C temperature de-rating from the                    space systems [18]. As a result, electronic part manufactur-
maximum junction temperature reported in the datasheet. For                  ers now provide RHA data (e.g. screening, manufacturing,
each processor, the core current at 100% processor utilization               and radiation characterization) that simplifies part evaluation.
was estimated based on either the peak power in the datasheet                Model-based risk management (e.g. Bayesian net analysis and
or the processor’s power estimator, if available. Since FPGAs                fault-tree analysis) predict radiation induced effects throughout
require more complex PDNs, manufacturers provide the power                   the mission duration, and is essential to understanding the
estimator tools, which were obtained for each FPGA and                       coupling between hardware, software, and power systems in
SoC. For each FPGA, the power estimator was configured                       space systems.
for 90% fabric utilization (i.e. look-up tables, random access
memory, and digital signal processing slices) with a toggle                  C. Reliability in SmallSat Missions
rate of 25% and a system clock of 100 MHz. Finally, SoCs                        While the RHA risk classification system provides insight
were configured with the combination of FPGA and processor                   to guide payload development based on national significance,
settings. While the design configurations defined here would                 the system does not address design difficulties associated with
not be compliant with NASA GSFC-STD-1000G Goddard                            CubeSat and SmallSat design. Historically, it was accepted that
Open Learning Design (G.O.L.D) Rules for mission design,                     CubeSats were high-risk endeavors; however, their growing
potential utility drove NASA to improve and quantify SmallSat
mission risk with a public-private Small Satellite Reliability
Initiative (SSRI) [19]. SSRI identified the potential benefits
of CubeSat and SmallSat missions, especially as reliability
increases. They identified the coupling between SmallSat and
CubeSat missions with larger satellite buses for future deep
space missions. In their concluding report, SSRI highlighted
the trades required to increase mission confidence with respect
to cost, schedule, performance, and risk through a consolidated
set of tools, resources, best practices, and lessons learned. De-
signing systems for both SmallSat and higher-class missions is
a complicated balance between part performance, screening,
and cost. The designer must understand the root cause and
failure mechanisms (e.g. part selection, manufacturing, and
assembly), and incorporate that knowledge early in the design
phase to ensure maximum reliability [20].                           Fig. 3. I&T and on-orbit failures between 2005 and 2017 for Class A to
                                                                    Class D missions at NASA Goddard Space Flight Center
   The Safety and Mission Assurance (SMA) division at
NASA Goddard Space Flight Center is focused on character-
izing and understanding risk in order to provide recommenda-        in next-generation space processors. Regardless of the mission
tions to missions. Since 2005, they have compiled electronic        class, the design of processing systems must be a holistic
and electromechanical part failures for Class A to Class D          approach based on reliability.
missions that occurred during integration and testing (I&T) or
throughout the mission duration. The data in Figure 3 shows         D. Space and High-Rel Capacitors
each failure categorized by component type and failure mech-           Given the sensitivity of capacitors to external stresses,
anism, which provides a number of significant insights. First,      capacitor selection (e.g. Tantalum and MLCC) is especially
integrated circuits represent 53% of the all recorded failures      important for reliable space systems. While tantalum capaci-
with space pedigree parts accounting for 7% of those failures       tors provide a larger capacitance per unit area, the relatively
and a nearly equal failure distribution between commercial,         high equivalent series resistance (ESR) and equivalent series
high-reliability, and MIL-spec components. The data indicates       inductance (ESL) limit their application when compared to
that part screening is only a portion of the overall system         MLCCs, which are better able to filter high-frequency tran-
reliability equation, especially given the mission classes on       sients. Commercial designs commonly use bulk tantalums
which these failures were recorded. Second, capacitors and          with a mixture of chemistries, but outgassing and electrolytic
power systems together represent 40% of failures, which is          field crystallization limit the wide availability and options for
especially concerning given the inherent complexity of power        space applications. A comprehensive overview of capacitor
converters and decoupling networks in state-of-the-art pro-         stability across temperature, bias voltage, package size, and
cessing architectures. Multi-layer ceramic capacitors (MLCC)        aging is covered in [22]. For avionics processors with low-
are especially sensitive to differences in coefficient of ther-     voltage and high-current transient requirements, both polymer
mal expansion, high-temperature manufacturing processes, and        tantalum capacitors and MLCCs are primarily used. Compared
thermo-mechanical stresses associated with hand-soldering,          to automotive and commercial grade components, additional
all of which increase the probability premature failures [21].      challenges are introduced with the minimum ceramic thickness
Finally, nearly 1-in-5 failures can be attributed to the assembly   between plates required by space qualified capacitors standards
process or rework. Optimal component placement is critical,         (e.g. GSFC S-311, MIL-PRF-123, and MIL-PRF-55365). As
especially with the push to smaller form-factor PCBs and            a result, a significant reduction in capacitance is observed
complex PDNs that require hundreds of decoupling capacitors.        between automotive-grade and space-qualified capacitors.
If priority is not given to component placement early in the           Analysis of Table I shows that high-reliability automotive
design process, ineffective PDNs have a high likelihood, and        grade capacitors outperform the space rated capacitors by a
create reliability problems that require significant re-design      factor of 4-to-1 for small MLCC 0402 packages and 10-to-1
work through the addition of decoupling capacitors to amelio-       for large MLCC 1210 packages. For example, each MLCC
rate mediocre designs. Additionally, cracked capacitors may         0402 capacitor on a commercial processor would require four
not be identified during I&T, but instead fail on orbit. While      high-reliability flight capacitors to provide equivalent decou-
the engineers designing space systems never expect to have          pling performance. Additionally, switched converters required
re-work performed, the tight mission timelines and high costs       large bulk capacitance with low ESR to minimize ripple, but
associated with a PCB re-spin create an environment where           the lack of MLCC options forces designers to select tantalum
board rework is the only option. As such, integrating design for    capacitors in larger packages with higher ESRs. The overall
manufacture and assembly (DFMA) practices are imperative to         reduction in capacitance of space-qualified capacitors is espe-
minimizing cost, meeting schedule, and maintaining reliability      cially evident when examining Xilinx’s decoupling recommen-
                                                           TABLE I
      M AXIMUM CAPACITANCE FOR AUTOMOTIVE AND SPACE QUALIFIED CAPACITORS WITH ESTIMATED ESR BASED ON MANUFACTURER DATA

                                       Automotive Grade                                         Space Qualified
                               Temperature                                            Temperature
           Type      Package                   Value     ESR    Voltage   Package                      Value      ESR         Voltage
                                Coefficient                                            Coefficient
          MLCC        0201        X7S         0.10 µF   35 mΩ   10 V        0201         X7R          0.01 µF   75 mΩ          10 V
          MLCC        0402        X7R         0.47 µF   15 mΩ   6.3 V       0402         X7R          0.10 µF   40 mΩ          10 V
          MLCC        0603        X7R          2.2 µF   7 mΩ    6.3 V       0603         X7R          0.22 µF   30 mΩ          10 V
          MLCC        0805        X7R          10 µF    6 mΩ    10 V        0805         X7R          0.47 µF   10 mΩ          10 V
          MLCC        1210        X7R          22 µF    3 mΩ    16 V        1210         X7R          2.7 µF     4 mΩ          10 V
          MLCC        1210        X7R          47 µF    2 mΩ    6.3 V       1812         X7R          4.7 µF     3 mΩ          10 V
         Tantalum     7374           -        680 µF    23 mΩ   2.5 V       7374            -         220 µF    180 mΩ          6V



dations for the radiation-tolerant Kintex UltraScale FPGA that       equivalent circuit models to approximate the frequency and
requires an additional 110 capacitors for the core voltage rail      location dependence of vias, planes, and decoupling capacitors
when compared to the commercial recommendation [13], [14].           [23].
In addition to requiring more capacitors and PCB area, these             Larger and faster transient magnitudes place greater stresses
space-qualified capacitors are substantially more expensive          on the PDN that manifest as processor brownout, power-
than their high-reliability counterparts further exacerbating the    plane crosstalk, radiated electromagnetic interference (EMI),
challenge of space affordability for lower budget SmallSats.         SI problems, and premature component failures. VRM selec-
Finally, the evaluation of decoupling requirements for current       tion for high-performance processors determines power effi-
commercial processors from [10] shows a trend toward sub-            ciency, PDN performance, and decoupling capacitor quantity.
milliohm target impedances that space-rated capacitors strug-        While linear VRMs generate low-noise voltage supplies in a
gle to deliver. Given the variability between mission class,         small footprint, their low power efficiency limits functional-
duration, and radiation environment, assessing the system            ity in an already power-constrained spacecraft environment.
performance, reliability, and cost is essential to the resilient     Conversely, switched converters are capable of high-current
design of next-generation avionics and instrument processors.        outputs at efficiencies greater than 90%, and able to respond
                                                                     quickly to large current transients induced by state-of-the-
        III. P OWER D ISTRIBUTION N ETWORK AND
                                                                     art FPGAs. The output voltage is generated by switching
          R ADIATION - BASED TARGET I MPEDANCE
                                                                     transistors at a specified duty cycle introduces noise that must
   The PDN is responsible for providing a stable low-noise           filtered from the power rail. Since the focus of the proposed
supply from the voltage regulators through package intercon-         research relates to core voltages, the use of VRM in this
nects, power planes, and decoupling capacitors to the die on         publication refers to switched converters.
each IC. Figure 4 shows an equivalent circuit model of a PDN             The PDN is affected by both DC voltage drop or AC
with a simulated impedance waveform. As previously dis-              transient responses. The DC voltage drop is proportional to
cussed, the complexity of power systems in high-performance          the peak current and the power plane resistance. DC effects
processors has increased drastically over the past two decades,
forcing designers to simultaneously evaluate and trade comput-
ing performance, functionality, and power requirements within
the constraints of thermal and mechanical. While these trades
do not represent new research for commercial industries, the
limitations of space system design present a significant barrier,
especially as industry drives towards SmallSat and CubeSat
bus architectures that demands high-performance on-board
processing. Even with the release of smaller rad-hard voltage
regulator module (VRM), the limited area available on a 1U
and 3U PCBs is exceptionally restrictive. When combined
with the increased number of independent voltage rails and
decoupling requirements on modern processors, designers are
forced to make stark trade-offs between performance, reliabil-
ity, and cost. With these increases in system complexity, PDN
simulations are a necessity. Given the expense and schedule
for complex layouts, simulation speed is often prioritized
over model accuracy. Full 3D electromagnetic (EM) simula-
tors provide greatest model accuracy, but the computational
complexity and simulation duration limit their application.          Fig. 4. Equivalent circuit model power distribution network with location and
As such, many simulation tools use hybrid field solvers and          frequency dependent for high-performance processors
can be corrected by placing the VRM sense signal close to                While commercial VRMs have DC tolerances as low as
the processor to provide a closed-loop feedback mechanism             0.25%, the rad-hard design process introduces significant
that minimizes the effects of large DC currents and power             variability as indicated by DC tolerances upwards of 1.5%.
plane resistance (IR) drop. However, AC transient response is         The decreased processor voltage tolerances combined with the
more complicated as it depends on the PCB stackup, via stack,         high-reliability required by space processors creates a difficult
component location, capacitor selection, VRM design, and              design trade space as the low target impedance requires
load-step current parameters. Given the significant coupling          significant capacitance to operate across the mission lifetime.
between the stackup and the PDN, accounting for stackup               Given these increased demands, a re-evaluation of the target
effects and component placement when simulating the VRM is            impedance is proposed in Equation 4, which separates operat-
essential to identifying problematic designs prior to manufac-        ing temperature (toltemp ), load regulation (tolload ), and radiation
turing. Additionally, selecting the VRM switching frequency           (tolTID ). Differences in manufacturing processes lead to in-
(fsw ) for a given topology, generally has the greatest impact        creased tolerances at temperature extremes, typically greater at
on efficiency as it determines the inductor value (L), output         lower temperatures than higher temperatures. Overestimating
capacitance (Cout ), and voltage ripple (Vripple ) that is shown in   the operational temperatures can constrains the PDN design
Equation 1 where IL is the inductor ripple current and RESR           which unnecessarily increases decoupling requirements. The
is the decoupling network’s ESR. Traditionally, switching             proposed target impedance provides a realistic design metric
frequency has been limited by the gate capacitance of silicon         to compare VRMs during the layout study. In addition to TID
field effect transistors (FETs). Combined with the inherent           effects, SETs can induce both fast microsecond-duration and
radiation tolerance of Gallium Nitride (GaN) transistors, recent      slow millisecond-duration changes to the output voltages that
advancements have enabled efficient power conversion while            are not taken into account in Equation 4. Accounting for SET
switching at frequencies in the megahertz range.                      transients with target impedance is impractical, however the
                                                                      SET effects can easily be modeled with a SPICE simulator
                            Iripple
           Vripple =                     + RESR ∗ IL           (1)    and an instantaneous ground fault of variable duration to
                       (8 ∗ fsw ∗ Cout )                              determine the maximum SET that can be decoupled. Since
   A number of design methodologies exist for synthesizing            the manufacturer radiation data is used to derive the maximum
PDN impedance profiles including multi-pole and distributed           tolerance for RHA parts based on statistical data, no additional
matched bypassing [24]. For voltage rails with low currents,          radiation analysis should be required.
deriving the output capacitance from the voltage ripple in                           Vcore ∗ [tolcore − tolload − toltemp − tolT ID ]
Equation 1 may be sufficient. For higher and faster currents,           ZT arget =
                                                                                                    Icore ∗ %step−load
a charge-based methodology provides a more accurate capac-                                                                          (4)
itance estimate [10]. Equation 2 relates the energy transfer          For example, a design team selects an FPGA with a core
between the VRM inductor, the decoupling capacitance, and             voltage of 1.0V ± 3% and worst-case current of 10 A load
the load.                                                             with a 25% load step, and trades two VRMs in Table II.
                 Q
                            
                        1 LP oL · Istep
                                         
                                              Istep                   Comparing the worst-case analysis, the target impedance for
       Cout =         = ·                  ·              (2)         VRM1 is 4 mΩ, and the target impedance for VRM2 is 8 mΩ.
               ∆Vout    2       Vout         ∆VoutAC
                                                                      To meet the worst-case target impedance, VRM2 requires two
However, the charge-based estimate does not account for               additional bulk 1210 MLCCs when compared to VRM1 , which
the loop controller bandwidth, and assumes a sufficiently             increases the required converter area by 35 mm2 . However,
slow current slew-rate such that the capacitor’s ESL and              the orbit radiation (25 krad) and temperature range (-25°C to
ESR is negligible. While these methodologies provide initial          85°C) shows the reference voltage tolerances are comparable
estimates, the amount of additional capacitance is determined         leading to a 9.6 mΩ target impedance. This reduction in target
by modeling in the time (e.g. SPICE) and frequency (e.g. PDN          impedance when compared to worst-case analysis signifies
Impedance) domains. Equation 3 shows the target impedance             that less bulk output capacitors are needed, which enables
(Ztarget ) that represents the maximum PDN impedance at which         additional processor functionality without loss of performance.
the processor’s voltage remains within specification for a
given load current. The tolproc and tolDC represent the percent                                  TABLE II
tolerance for the processor voltage rail and DC accuracy of              C OMPARISON OF REPRESENTATIVE RAD - HARD BUCK CONVERTERS
the VRM. While the target impedance is constant across fre-                        Area      Efficiency   tolworst   tolrad   toltemp   tolload
quency, the harmonic content contained in the current transient        VRM 1     505 mm2        88%        2.0%      0.1%      0.3%      0.3%
waveform begins to decay at 40 dB per decade, which depends            VRM 2     601 mm2        82%        1.0%      0.2%      0.3%      0.2%
on the waveform shape. Above this frequency envelope, the
low spectral content enables a 20 dB per decade increase in
target impedance as indicated in Figure 4.                             IV. P RINTED C IRCUIT B OARD D ESIGN M ETHODOLOGY
                          Vcore ∗ (tolcore − tolDC )                     The current state of space hardware and architecture design
             ZT arget =                                        (3)    is decoupled from the layout, manufacturing, and assembly
                                Iload ∗ %step
as designs are outsourced to external vendors for a more turn-      design metric for comparison. The package that a component
key experience. While this process was sufficient a decade ago      is housed inside is tightly coupled with thermal performance
with large ceramic components, the current state of the space       and functionality (e.g. I/O constraint, performance). While
industry has begun a shift to smaller ball-grid array packages      large processing elements consume significant power and have
with increased adoption of radiation-tolerant devices. The tight    priority in the layout study, even low-power components that
coupling between computational performance, PDN design,             are poorly placed during the layout study can quickly exceed
and software requires a multi-dimensional integrated team           maximum temperature ratings. As such, it is recommended
that profoundly understands all aspects and trades associated       that the hardware design team use the manufacturer-provided
with design decisions. As engineering teams are often short-        power estimator combined with processor and FPGA fabric
handed with schedule and budget constraints, the Science Data       utilization, I/O quantities, data-rates, and estimated junction
Processing Branch at NASA Goddard Space Flight Center               temperature constraints. If power estimators are unavailable,
has developed a design methodology that incorporates many           the worst-case operational limits of the device within the
complexities associated with space processor development and        intended environment is also acceptable. However, it should
PCB design, shown in Figure 5. The foundation of the design         be noted that this could lead to over designing the PCB
process is decision making based on the simulation data,            in situations where target applications are not stressing use
manufacturer recommendations, and experience in previous            cases for the device. Worst-case power estimates have negative
projects. While many signal and power integrity simulators          impacts on cost and loss of functionality if far outside any re-
exist (e.g. Siemens HyperLynx, Keysight ADS, and ANSYS              alistic use case. Most state-of-the-art architectures require on-
SIWave), the cost and complexity is often a barrier to adoption     board volatile and non-volatile memory that have significant
but the ability to identify problems before manufacturing is        I/O requirements. Reference voltage rails with tight tolerances
essential to a fast engineering development cycle.                  specific to certain memories (e.g. double data rate (DDR)) and
                                                                    termination schemes (e.g. emitter-coupled logic (ECL)) should
A. Processor Trade and Layout Study
                                                                    be noted as specialized VRMs may be required to support
   Evaluating processor architectures is non-trivial since a        those components. Any additional circuitry (e.g. watchdogs,
desired performance metric is specific to a given engineering       transceivers) must be documented and evaluated to maintain
team and will vary depending on intended software application       system reliability and performance requirements.
needs. Considering the complexity of the processor analysis,           The state-of-the-art FPGAs and processors have complex
the comparison between processors, FPGAs, and SoCs is left          power systems requiring many voltage rails, and the limited
to the reader, however a thorough comparison is presented in        number and large size of radiation-hardened VRMs presents
[5]. Throughout this analysis phase, the hardware design teams      a significant barrier. Commercial VRMs are available with a
must be in close contact with the software and FPGA groups          multitude of functionality (e.g. wide input voltage, pulse skip-
to receive input on architecture-level decisions that could         ping, current sensing) and in a variety of configurations (e.g.
impact performance, I/O interfaces, and future mission needs.       integrated FETs, System-on-Module, Controller) that enable
A challenging, but critical part of the effort is determining how   the designer to select an optimal configuration based on load
to decompose/partition a particular application between the         current. However, the radiation, temperature, and reliability
disparate computing elements that informs the design trades         constraints limit functionality by combining the controller and
for each of the processing elements. The design team must           FETs, which ultimately limit the input voltage range, current
define and balance system functionality and computational           output, and efficiency. Given these constraints, a preliminary
performance which is constrained by the following parameters:       power system should be designed based on documented output
   • Processor, memory, and input/output (I/O) constraints          voltages, expected load currents, and sequencing requirements.
   • PCB stackup considerations                                     Compiling these values into a spreadsheet or program enables
   • Manufacturing and assembly limitations                         automatic calculation of currents and powers based on con-
   • Maximum bus power and available voltage rails                  verter type and efficiency. The spreadsheet enables the identi-
   • Mechanical mounting and thermal limitations                    fication of low-current voltage supplies that may be powered
   • Mission reliability requirements and component costs           by linear VRMs, voltage rails that can be shared between
   While some of the listed variables are more flexible,            multiple components, and identify high current rails that may
developing a priority and understanding the future impact           require parallel synchronized switched VRMs. Given the over-
are especially important when performing the cost-to-benefit        all complexity of the power system, a diagram documenting
analysis of a specific design trade. During the component           the entire system is recommended to prevent any accidental
research process, it is beneficial to have a single document        oversights. Finally, VRM simulations with estimated currents
containing all relevant information for available components        and step-load transients enable verification of bulk decoupling
that include power supply requirements, package dimensions,         capacitors within voltage tolerance requirements.
thermal limitations, and layout constraints. Voltage tolerances,       Once preliminary components are selected for a given
peak currents, and overshoot/undershoot limits can vary dras-       processing architecture, the layout study determines if the
tically even within a computing architecture family. Within the     proposed components, passives, and connectors fit within the
constraints of the PCB area, a layout study represents the first    limited board area. A layout study is performed by arranging
    Fig. 5. PCB design and analysis methodology developed at NASA Goddard Space Flight Center and optimized for high-performance processors



shapes that are scaled to the package size of each component             list that includes the voltage rails, signal interfaces, length
around the fixed board area. A variety of applications can be            matching requirements, data-rates, and trace-to-trace isolation
used (e.g. presentation, flowchart, PCB layout), but design for          requirements. There are two benefits to categorizing signals
manufacture and assembly (DFMA) practices (e.g. component                and power planes by their importance, intended routing layers,
clearances) must be enforced. With increased complexity,                 and proximity on the PCB: (1) development of an accurate
layout studies benefit when they are performed in a PCB                  stackup and (2) sufficient information for the layout engineer.
layout software that presents the clearest representation of the         It should be noted that a layout study is only successful after a
layout. Component placement should be optimized between                  stackup is approved by a vendor, which can lead to drastically
the shortest path between devices, routing density, and the              different layout studies that depend on component selection.
thermal performance. Areas with high routing density require
                                                                         B. Stackup Study
greater component separation to balance length matching and
crosstalk constraints. While reference designs released by                  The foundation of the PCB is the stackup that is composed
manufacturers are convenient to reference, industry experts              of alternating layers of copper foil and stacked dielectric
have noted they often do not conform to reasonable design                materials. The stackup should be designed in parallel with
practices and should be scrutinized before design decisions              the layout study as they are tightly coupled. The majority of
are implemented [25], [26]. At this stage, the designer should           challenges associated with complex PCB designs are attributed
include sufficient margin based on additional passives and               to improper stackup and via stack planning. The stackup
decoupling capacitors that may not be realistic to include               study identifies and addresses problems associated with HDI
in the layout study. Mechanical engineers play an important              breakout, SI, PI, and EMI prior to layout. Stackup design
role throughout the design process, generating the Mechanical            is a multi-faceted challenge with large solution space that
Interface Control Document (MICD) prior to the layout study.             consists of PCB thickness, dielectric material properties, via
Additionally, thermal engineers should verify part placement             drill and padstack, reliability, manufacturability, and cost. The
based on estimated powers and packages parameters.                       layer count estimate from the layout study provides a starting
                                                                         point for the trade space, but is subject to change throughout
   Once the layout study nears completion, a preliminary                 the layout process as unforeseen constraints arise. Since the
stackup should be developed based on the quantity of power               layer count is primarily controlled by the signal breakout, each
planes and signal layers. Many methodologies exist for op-               component package must be evaluated based on the pin pitch,
timizing layer count and high-density interconnect (HDI)                 minimum via diameter, trace width, and number of traces
breakout in [14]. Pre-layout SI simulations with input/output            broken out through each via pair, represented in Figure 6.
buffer information specification (IBIS) models in conjunction               Equation 5 provides an analytical representation of Figure 6
with the estimated PCB trace lengths from the layout study               that is essential to the design of HDI breakouts. The available
provide insights into drive strength, slew rate, and termination         routing area drives the controlled impedance trace calculations,
value and location. All of these parameters have significant             which is constrained by the package pin pitch, via drill/pad,
impact on the HDI breakout capability. Finally, different                clearances, and PCB thickness. For example, a device with a
processing architectures can be compared based on layout                 1 mm pitch, a 24 mil via pad diameter, and a via clearance
complexity, total cost, power, and any reduction in capability           of 4 mil has a maximum route area of 7.37 mil. Depend-
resulting from power system and I/O limitations. Once a layout           ing on the mission reliability and IPC-6012 manufacturing
study is completed and a processor architecture is selected, a           class, these parameters can change significantly. From the
routing priority list should be created which is an ordered              desired impedance value, the maximum route area, a dielectric
                                                                         effects, multiple dielectric effects can introduce functional
                                                                         problems. While manufacturers provide a single value for the
                                                                         dielectric constant, the dielectric is actually composed of an
                                                                         epoxy resin and fiber weave with different dielectric properties.
                                                                         As trace widths become comparable to a PCB’s fiber weave,
                                                                         the propagating signal experiences different impedances and
                                                                         time-of-flights based on the continuously changing dielectric
                                                                         constants that induces reflections and reduces the channel
                                                                         operating margin. While low-loss substrates present a simple
                                                                         solution, the reduction in dielectric constant has significant
                                                                         impact on trace widths, component breakout, and length-
   Fig. 6. Breakout definitions for high-density interconnects on PCBs   matching requirements that may limit a design to a specific
                                                                         material. Additionally, increased costs associated with manu-
                                                                         facturing and flight qualification of new low-loss dielectrics
thickness, and copper weight can be derived from either                  must not outweigh the performance benefits, especially with
approximations or 2D solvers that calculate transmission line            reduced area designs (e.g. 1U, 3U) and when simple solutions
impedance based on topology. While controlled impedance is               exist to mitigate these effects (e.g. zig-zag routing, spread-
essential to operating at high-data rates, trace impedance is            fabrics). The dielectric’s frequency-dependence and stability
often adjusted during HDI breakout to optimize cost with no              become especially critical as line rates increase beyond 5 GHz.
impact on performance. These adjustments to trace width and
impedance should be documented in the routing priority list.                As with signal routing consideration, the quantity of power
                                                                       planes in a stackup design is strongly dependent on the
                                 Dpad
          Larea = Lpitch − 2 ∗         + Lclearance       (5)            processing architecture and layout study. The design of an
                                   2                                     effective PDN is non-trivial with the performance dominated
Once the dielectric thicknesses are verified with vendor data,           by two parameters: (1) the mounting inductance (2) spreading
the total board thickness can be calculated based on signal and          inductance. The mounting inductance is the series impedance
power plane requirements. While manufacturing capabilities               seen by the capacitor when connecting to planes. As such,
limit the minimum via drill diameter based on the PCB                    power and ground planes placed close to the surface layers
thickness, most manufacturers recommend a 10:1 minimum                   and multiple vias placed close to each decoupling capacitor
aspect ratio to ensure the stackup for manufacturability. If             minimizes the mounting inductance. The spreading inductance
the drill diameter to board thickness ratio is less than the             is the series impedance observed between the decoupling
required ratio, either the layer count must be reduced or                capacitor and the IC pin, and placement of the decoupling
the stackup design should be adjusted for thinner dielectrics.           capacitor as close to the IC power pin is essential to an
However, the thickness reduction requires a re-calculation of            effective PDN. While power planes near the surface layers
the transmission line impedances and adjustments are not                 provide improved PDN performance, a symmetric stackup
always feasible. By establishing a dialog with vendors early             with equal distributions of plane and signal layers on the top
in the design process, the difficulties associated with stackup          half and bottom half of the PCB is preferred by manufacturers
design (e.g. dielectric material, via padstack, and controlled           as it prevents board warpage during assembly thermal cycles.
impedance) and reliability are reduced while maintaining high            These complications introduce additional complexity as board
manufacturing yields at the lowest possible cost.                        thickness, minimum via diameter, plane location, and layer
   As the trace geometry area decreases and rise-times drop              count must be simultaneously evaluated. The decision to
below 100 picoseconds, copper effects (e.g. surface roughness,           select a component without understanding and incorporating
skin effect) and dielectric effects (e.g. dielectric losses, fiber       the manufacturing costs, often associated with complicated
weave) become crucial to stackup design. The skin effect is              manufacturing practices (e.g. microvias, ¿10:1 aspect ratio,
the tendency of current as low as 1 MHz to distribute on the             back drilling) that lead to lower yields, introduces significant
surface of the conductor. Specific to each transmission line             risk to the project schedule and can lead to exponentially
topology, the current distribution is non-uniformly distributed          increasing costs. Once a stackup has been designed, manu-
towards the closest adjacent reference plane. Discontinuities            facturer verification based on the reliability class (e.g. Class
in the reference plane for both power and signal routes are              2, Class 3, ES) is required. Small changes to the stackup can
the cause of many functional problems on PCBs as it leads to             have catastrophic effects on the layout that require a complete
ringing on signal lines, radiated fields, and noisy power planes.        re-design of the PCB. Given the additional costs associated
The combination of the skin effect and surface roughness                 with Class 3 and IPC-6012ES, a PCB can be designed to the
of copper foils increases the effective trace resistance as the          higher reliability standard but manufactured to Class 2 as an
distance traveled by the high-frequency currents is longer. This         affordable solution to prototype development. However, the
attenuation is manufacturing process dependent and typically             reverse process is not as simple and will likely require changes
becomes significant above 1 GHz. In addition to conductor                to the PCB layout.
C. PCB Layout                                                       cost. Finally, fabrication and assembly drawings are developed
                                                                    with specifics relating to the stackup, controlled impedance
   The benefit of the proposed design methodology is that           trace widths, allowable tolerances, and any additional informa-
once the layout and stackup studies are completed, many of          tion relevant to the design that may not be apparent. While the
the common problems associated with complex designs have            developed PCB design methodology appears to be an ordered
been evaluated and accounted for. By following the routing          process, the approach is holistic and very iterative. Both SI and
priority list, the goal of this methodology is prioritize the       PI effects must be simultaneously evaluated within context of
PDN and minimize plane layout complexity while maintaining          their impact to overall system performance as optimizing one
processing functionality. As such, layout of high-current and       facet of a design is often detrimental to another.
low-noise planes should be prioritized over low-current planes.
Since component locations are finalized in the layout study,                  V. C ASE S TUDY: S PACE C UBE V 3.0 M INI
the next step is the placement of high-frequency decoupling            SpaceCube processors are a collection of FPGA-based on-
capacitors as close to the component pins as possible, and then     board data processing systems developed in the Science Data
bulk decoupling placement near each VRM. When capacitor             Processing Branch at NASA Goddard Space Flight Center
placement is finalized, the placement of vias to connect            (GSFC). The goal of the SpaceCube program is to provide
decoupling capacitors to the respective planes is next. Optimal     substantial increases to onboard computing while maintaining
PDN performance is obtained when the distance between each          reliability and lowering relative power consumption and cost.
decoupling capacitor and the via is minimized. Multiple vias        In response to mission needs, the hybrid-processing design
are recommended for bulk capacitors to support the larger           approach combines radiation-hardened and commercial com-
currents. After the preliminary power systems layout is com-        ponents to form a novel architecture that combines the best
plete, PDN simulations should be performed to identify any          capabilities of CPUs, DSPs, and FPGAs. As part of the third
placement problems and if additional decoupling is needed. A        generation of processing architectures, the SpaceCube v3.0
decoupling capacitor mounting inductance report, which most         Mini (SCv3M) was developed as a SWaP-C optimized 1U
simulators are capable of generating, easily identifies poorly      processor to the CubeSat card specification ([CS]2 ) for the
mounted capacitors that would limit PDN performance. After          mission enabling capabilities and reusable box configurations
which, impedance simulations for each power pin ensure the          [7]. The foundation of the SCv3M is the Xilinx Kintex Ultra-
target impedance requirements derived during the VRM design         Scale FPGA that provides orders of magnitude performance
are maintained. However, simulators output an impedance             improvements when compared to rad-hard processors. Xilinx
for each pad of the IC package, but the target impedance            is committed to supporting the space-grade Kintex UltraScale
represents a single value required by the die. Since scattering     (XQRKU060) in a column grid array (CGA) package with
parameters are not always available to model the package, by        QML-V screening that features the same die as the industrial-
assuming each power pin has an equal current a first-order          grade part in a ball grid array (BGA) package [27]. While
approximation is derived by multiplying the target impedance        Xilinx designed the CGA package to be roughly pin compati-
in Equation 4 by the quantity of power pins. Multiple design        ble with the BGA package, significant differences between the
and simulation iterations are typically required before the         impedance of the ball and column introduce difficulty when
PDN impedance is below the target impedance. Additionally,          designing for a selective population scheme. The increased
time-domain simulations for current transients ensure coupling      impedance of the CGA pins combined with the large currents
between power planes does not affect voltage tolerances.            induce greater voltage drop and require on-die voltage sensing
   After the PDN has been optimized, signal termination is          for the VRM. Additionally, Xilinx adjusted the core voltage
placed based on the routing priority list and the pre-layout        tolerance from 3% on the BGA to 4% and increased the
SI analysis. Since routing and transmission line effects are        decoupling capacitor recommendation by a factor of 1.7×.
exacerbated with increasing trace lengths, certain effects (e.g.    When compared to the BGA package, the increase requires
crosstalk, termination location) can be ignored if the trace        an additional 100 space-qualified capacitors that consume
length is kept short. While skin effect and surface roughness       approximately 1,000 mm2 on the PCB. However, the core
are fixed at this point in the design, fiber weave effects can be   voltage pins under the part only represent 136 mm2 . Even
mitigated with design practices (e.g. zig zag routing, panel        with ideal placement, many decoupling capacitors will have
rotation). After a preliminary routing of each interface is         marginal effect on the PDN while severely limiting proces-
completed, board level SI simulations should be performed to        sor functionality. Given the size constraints, the PDN was
verify that timing, cross-talk, and overshoot/undershoot do not     designed for the industrial-grade BGA package, while being
exceed manufacturer recommended operating conditions for            able to accept the space-qualified package with a potential
each device. At this stage in the design, SI and PI simulations     performance derating.
may reveal additional problems that need to be addressed in the        From a trade study early in the design process, the Mi-
layout. This analysis leads to an iterative design process based    crosemi RT ProASIC3 was selected as a radiation-hardened
on analysis versus rules of thumb. As such, the layout engineer     monitor (RHM) for programming, system monitoring, mem-
must understand the impact of all parameters on the system          ory scrubbing, and radiation mitigation. The RT ProASIC3
design to make educated decisions based on performance and          provided the greatest functionality in a small package without
Fig. 7. (a) 22-layer stackup manufactured to IPC-6012DS from HyperLynx (b) Component placement and preliminary thermal analysis based on 15W case
(c) Core voltage power integrity analysis at PCB vs BGA (d) Primary side of assembled SCv3M



the need for additional VRMs. For non-volatile memory, the                documented four major issues during layout that are presented
Kintex and RHM have independent 16 GB NAND flash                          below. First, the high component density proved especially dif-
memory modules that store OS boot images and intermediate                 ficult as the initial layout studies in Microsoft Visio had insuf-
application data products. To support high-throughput instru-             ficient component clearances. Second, the potential for high-
ment data buffering and softcore microprocessors, the SCv3M               power dissipation required placement of the Kintex FPGA near
design includes 2 GB of 72-bit wide DDR3 SDRAM operating                  the card edge as determined by board level thermal analysis
at 1,333 Mega Transfers per second. For external connectivity,            in Figure 7 (b). The placement became a limitation later in
the mass required to implement the large I/O count with                   the layout as it became difficult to breakout and length match
connectors and cabling is prohibitive, whereas the backplane              certain interfaces. While more time was spent in layout than
design provides a SWaP-C optimized solution. The SCv3M                    expected, the potential for high power dissipation outweighed
was designed with a 400-pin Samtec backplane connector to                 the extended layout times. Third, the complexity in routing
break out a multitude of LVDS, single-ended 3.3V GPIO,                    the DDR3 interface drove placement of the DDR3 as far
and multi-gigabit transceiver lanes. Additionally, an 85-pin              as possible from the Kintex to provide sufficient area for
Nano-D front-panel connector was incorporated that supports               length matching. This extra distance proved beneficial as tight
CameraLink and low-speed single-ended 3.3V interfaces. The                matching was easily achieved on the 72-bit interface. Fourth,
22-layer stackup in Figure 7 (a) was designed to the IPC-                 a differential pair is unable to breakout between two through
6012DS space and military avionics standard, and has 8 mil                vias with a 1 mm pitch, but was not identified until after the
blind and 12 mil through vias that are essential to achieving             component placement and routing priority list was developed.
high component density without sacrificing SI/PI performance.             The design team worked with the manufacturer, and was able
The stackup has four 1-ounce power planes split between                   to develop a solution to decrease via clearance by removing
the primary and secondary layers that are enclosed between                non-functional pads without a stackup redesign.
grounds to minimize mounting inductance. Plane mirroring
                                                                             When the assembled card arrived, a custom suite of auto-
was selectively implemented to minimize DC voltage drop.
                                                                          mated tests developed by the embedded processing group were
Finally, the isolated signal layers enable routing without
                                                                          performed to verify both the functionality and performance of
concern for adjacent layer crosstalk. Extensive pre- and post-
                                                                          each interface on the SCv3M. Nearly all of the automated test-
layout simulations in Siemens HyperLynx were analyzed to
                                                                          ing passed without problems, however the testing did identify
characterize SI performance of the SCv3M. The drive strength,
                                                                          three DDR3 data byte groups had failed calibration and were
termination location, and termination values were optimized
                                                                          non-operational. Since the layout passed the PCB software
for each interface to balance high-data rates and provide
                                                                          design rule checks and the time-of-flight requirements for
sufficient margin to the recommended operating conditions.
                                                                          each data byte group were verified with HyperLynx DDRx
Post-layout crosstalk simulations with manufacturer-provided
                                                                          analysis, the issue was not easily identifiable. Additionally,
IBIS models showed an average crosstalk of 21 mV and a peak
                                                                          the data lines were routed with blind vias making oscilloscope
crosstalk of 115 mV across all interfaces at peak rates. Due
                                                                          probing of the problematic data byte groups during operation
to the PDN complexity, an Excel document was developed to
                                                                          impossible. After much FPGA reconfiguration and software
track the combinations of target impedances, temperatures, and
                                                                          testing, the problem was identified as multiple signals shorted
load currents. DC drop, AC impedance in Figure 7 (c), and
                                                                          to ground. Further examination of the layout found that a
current density simulations were performed for each power
                                                                          trace had been shifted, creating a short between ground and
plane. The core voltage rail was shown to meet the required
                                                                          three data lines, but was masked by a setting in the layout
3.6 mΩ target impedance based on the maximum converter
                                                                          design rules. The DDRx simulator did not identify the shorted
tolerance.
                                                                          traces either as the removal of non-functional pads created a
  During the course of the layout process, our design team                scenario where the simulator used the via pads to check for
shorts but does not check for shorts to drilled holes. With                   [3] A. Geist, C. Brewer, M. Davis, N. Franconi, S. Heyward, and T. Wise,
all other interfaces passing functional and performance tests,                    “SpaceCube v3.0 NASA Next-Generation High-Performance Processor
                                                                                  for Science Applications,” in 33rd Annual AIAA/USU Conference on
custom FPGA cores were developed to specifically test the                         Small Satellites, ser. Advanced Technologies II, Logan, UT, August 3-8,
PDN of the core voltage rail with large FPGA designs. Core                        2019.
dynamic currents of 12.3 A were tested with corresponding                     [4] S. Sabogal, P. Gauvin, B. Shea, D. Sabogal, A. Gillette, and C. Wilson,
                                                                                  “SSIVP: Spacecraft Supercomputing Experiment for STP-H6,” in 31st
core voltage measurements taken to identify potential core                        Annual AIAA/USU Conference on Small Satellites, ser. Next on the Pad
voltage violations, and no PI issues were identified. As such,                    2, Logan, UT, August 10-14, 2017.
the relative success of the SCv3M design is attributed to design              [5] A. D. George and C. M. Wilson, “Onboard Processing With Hybrid
                                                                                  and Reconfigurable Computing on Small Satellites,” Proceedings of the
and analysis methodology presented in Section IV.                                 IEEE, vol. 106, no. 3, pp. 458–470, 2018.
                                                                              [6] D. Rudolph, C. Wilson, J. Stewart, P. Gauvin, A. D. George, H. Lam,
                       VI. C ONCLUSIONS                                           G. Crum, M. Wirthlin, A. Wilson, and A. Stoddard, “CSP: A Mul-
   The state-of-the-art commercial processing architectures re-                   tifaceted Hybrid Architecture for Space Computing,” in 28th Annual
                                                                                  AIAA/USU Conference on Small Satellites, ser. Advanced Technologies
quire tight tolerance on voltage rails that feed large current                    I, Logan, UT, August 3-8, 2019.
transients inside high-density packages that breakout hundreds                [7] C. Brewer, N. Franconi, R. Ripley, A. Geist, T. Wise, and S. Sabo-
of IO to various interfaces. Conversely, traditional space                        gal, “NASA SpaceCube Intelligent Multi-Purpose System for Enabling
                                                                                  Remote Sensing, Communication, and Navigation in Mission Architec-
systems with large PCB form-factors and high tolerance power                      tures,” in 34th Annual AIAA/USU Conference on Small Satellites, ser.
systems have created an environment where strict design                           Advanced Technologies I, Logan, UT, August 7-12, 2020.
methodologies were not required for avionics and instrument                   [8] J. Leitner, B. Sood, E. Isaac, J. Shue, N. Lindsey, and J. Plante,
                                                                                  “Risk-based safety and mission assurance: Approach and experiences
processors. However, the next generation of systems demand a                      in practice,” Quality Engineering, vol. 30, no. 4, pp. 648–662, 2018.
holistic design and analysis methodology. In this publication,                [9] T. M. Lovelly and A. D. George, “Comparative analysis of present and
we have reviewed the state-of-art for flight processors, the dif-                 future space-grade processors with device metrics,” Journal of Aerospace
                                                                                  Information Systems, vol. 14, no. 3, pp. 184–197, 2017.
ficulty associated with powering these devices, and described                [10] C. Parisi, “Voltage Regulator Design and Optimization for High-Current,
the impact of the power system has on reliability. Classic                        Fast-Slew Rate Load Transients,” in 2020 Texas Instruments Power
decoupling strategies were presented including the ripple                         Supply Design Seminar. Texas Instruments, February 10, 2020.
                                                                             [11] S. Sabogal, A. George, and C. Wilson, “Reconfigurable Framework for
method, the charge-based approach, and the target impedance.                      Environmentally Adaptive Resilience in Hybrid Space Systems,” ACM
We present the design methodology that was developed and                          Trans. Reconfigurable Technol. Syst., vol. 13, no. 3, September 2020.
tested in the Science Data Processing Branch at NASA GSFC.                        [Online]. Available: https://doi.org/10.1145/3398380
                                                                             [12] E. Gretok, “Comparative Benchmarking Analysis of Next-Generation
While the methodology is generic to optimizing all space-flight                   Space Processors,” Masters Thesis, University of Pittsburgh, 2019.
processors, the methodology is especially enabling to small                  [13] DS925: Zynq UltraScale+ MPSoC Data Sheet: DC and AC Switching
form-factor 1U architectures, which must combine state-of-                        Characteristics, Xilinx, 2020, rev. 1.18.
                                                                             [14] UG583: UltraScale Architecture PCB Design, Xilinx, 2021, rev. 1.2.
the-art FPGAs and processors that push the bounds of current                 [15] I. Koren and C. M. Krishna, Fault-Tolerant Systems, 2nd Edition. San
PDN technologies. Given the variability in mission classes, a                     Francisco, CA, USA: Morgan Kaufmann, 2020.
novel de-rated target impedance calculation was derived based                [16] P. C. Adell and L. Z. Scheick, “Radiation effects in power systems:
                                                                                  A review,” IEEE Transactions on Nuclear Science, vol. 60, no. 3, pp.
on the operating temperature, load and line regulation, and                       1929–1952, 2013.
radiation environment that enables designing power systems                   [17] National Academies of Sciences, Engineering, and Medicine, Testing at
for the intended mission. Finally, the PCB design methodology                     the Speed of Light: The State of U.S. Electronic Parts Space Radiation
                                                                                  Test Infrastructure. Washington, DC: National Academies Press, 2018.
was applied to the SpaceCube v3.0 Mini high-performance                      [18] M. J. Campola, “Radiation Hardness Assurance (RHA): Overview for
processor developed at NASA Goddard Space Flight Center.                          Mission Success,” in NASA Electronic Parts and Packaging (NEPP)
A target impedance of 3.6 mΩ was achieved with capacitor                          Program Electronics Technology Workshop (ETW), Greenbelt, MD, June
                                                                                  15-18, 2020.
constraints. Trades between stackup and PDN were presented                   [19] M. Johnson, “SmallSat Reliability:Issues and Solution Approaches,” in
as it pertains to the layout and design.                                          Pacific Operational Science and Technology Conference, Honolulu, HI,
                                                                                  USA, March 6-10, 2017.
                 VII. ACKNOWLEDGMENT                                         [20] B. Sood, “Achieving Improved Reliability with Failure Analysis,” in
                                                                                  IPC High Reliability Forum, Linthicum, MD, May 15, 2018.
  The authors would like to recognize the contributions and                  [21] A. Teverovsky, “Cracking Problems in Low-Voltage Chip Ceramic
support of team members in the Science Data Processing                            Capacitors,” NASA Electronic Parts and Packaging Program, Greenbelt,
Branch including Cody Brewer, Christopher Wilson, David                           MD, Tech. Rep., 2018.
                                                                             [22] R. Deshpande, Capacitors. McGraw-Hill Education, 2015.
Wilson, Sebastian Sabogal, Travis Wise, and David Petrick in                 [23] E. Bogatin and L. Smith, Principles of Power Integrity for PDN Design
addition to Thomas Cook from the University of Pittsburgh.                        Simplified. Prentice Hall, 2017.
                                                                             [24] I. Novak, “Comparison of Power Distribution Network Design Methods:
                            R EFERENCES                                           Bypass Capacitor Selection Based on Time Domain and Frequency
 [1] National Academies of Sciences, Engineering, and Medicine, Thriving          Domain Performances,” in DesignCon 2006, Santa Clara, CA, USA,
     on Our Changing Planet: A Decadal Strategy for Earth Observation             February 6-9, 2006.
     from Space: An Overview for Decision Makers and the Public. Wash-       [25] E. Bogatin, “Keynote Speaker: Breaking Bad: A Downside of Open
     ington, DC: National Academies Press, 2019.                                  Source Designs,” in Altium Live 2019 Conference, San Diego, CA, USA,
 [2] R. Doyle, R. Some, W. Powell, G. Mounce, M. Goforth, S. Horan, and           October 12, 2019.
     M. Lowry, “High Performance Spaceflight Computing; Next-Generation      [26] R. Hartley, “Presentation: How to Achieve Proper Grounding,” Novem-
     Space Processor: A Joint Investment of NASA and AFRL,” in Interna-           ber 11, 2019, altium Expert Live Training.
     tional Symposium on Artificial Intelligence, Robotics, and Automation   [27] DS882: Radiation Tolerant Kintex UltraScale XQRKU060 FPGA Data
     in Space (iSAIRAS 2014), Montreal, Canada, June, 2014.                       Sheet, Xilinx, 2020, rev. 1.2.


==========================================
FILE: PCB.pdf
==========================================

PCB Design
                                          Copyrights

Software, documentation and related materials:
Copyright © 2002 Altium Limited


This software product is copyrighted and all rights are reserved. The distribution and sale of this
product are intended for the use of the original purchaser only per the terms of the License
Agreement.
This document may not, in whole or part, be copied, photocopied, reproduced, translated, reduced
or transferred to any electronic medium or machine-readable form without prior consent in writing
from Altium Limited.
U.S. Government use, duplication or disclosure is subject to RESTRICTED RIGHTS under applicable
government regulations pertaining to trade secret, commercial computer software developed at
private expense, including FAR 227-14 subparagraph (g)(3)(i), Alternative III and DFAR 252.227-7013
subparagraph (c)(1)(ii).
P-CAD is a registered trademark and P-CAD Schematic, P-CAD Relay, P-CAD PCB, P-CAD ProRoute, P-
CAD QuickRoute, P-CAD InterRoute, P-CAD InterRoute Gold, P-CAD Library Manager, P-CAD Library
Executive, P-CAD Document Toolbox, P-CAD InterPlace, P-CAD Parametric Constraint Solver, P-CAD
Signal Integrity, P-CAD Shape-Based Autorouter, P-CAD DesignFlow, P-CAD ViewCenter, Master
Designer and Associate Designer are trademarks of Altium Limited. Other brand names are
trademarks of their respective companies.


                                            Altium Limited
                                           www.altium.com
                                                                                   Table of Contents

chapter 1     Introduction to P-CAD PCB
              P-CAD PCB Features..........................................................................................................1
              About this Guide..................................................................................................................2
              About P-CAD PCB (6/400) ..................................................................................................2

chapter 2     Installation and Setup
              System Requirements .........................................................................................................3
                   Recommended System ................................................................................................3
                   Minimum System..........................................................................................................3
              Installing P-CAD Products ...................................................................................................4

chapter 3     PCB Basics
              About the User Interface......................................................................................................6
                  Menu Bar......................................................................................................................6
                  Toolbars .......................................................................................................................6
                  Command Toolbar........................................................................................................7
                  Placement Toolbar .......................................................................................................7
                  Route Toolbar ..............................................................................................................8
                  Custom Toolbar............................................................................................................9
                  Prompt Line..................................................................................................................9
                  Status Line ...................................................................................................................9
                  X and Y Coordinates ..................................................................................................10
                  Grid Toggle Buttons ...................................................................................................10
                  Macro Record (Temporary Macro) Button..................................................................11
                  Layer Display Combo Box and Scroll Buttons............................................................12
                  Line Width Combo Box...............................................................................................12
                  Radius Combo Box ....................................................................................................12
                  Status Information Area..............................................................................................12
                  Workspace .................................................................................................................13
                  Using Multiple Windows .............................................................................................13
              View Commands ...............................................................................................................13
                  Zoom Commands.......................................................................................................13
                  (View) Zoom In/Out ....................................................................................................13
                  (View) Zoom Window .................................................................................................14
                  Other View Options ....................................................................................................14



P-CAD PCB User’s Guide                                                                                                                                i
                 Jump Commands ...................................................................................................... 14
            Using Layers..................................................................................................................... 15
                 Placing Objects.......................................................................................................... 15
                 Item and Layer Drawing Order .................................................................................. 16
            Object/Action Interaction................................................................................................... 16
                 Object Selection and Placement................................................................................ 16
                 Object Selection and Object Properties..................................................................... 16
            Placing Objects................................................................................................................. 16
                 Moving Objects.......................................................................................................... 17
                 Rotating and Flipping Objects.................................................................................... 17
                 Orthogonal Modes ..................................................................................................... 17
                 Unwinding Segments................................................................................................. 18
                 Moving Objects to Another Layer .............................................................................. 18
                 Changing an Arc Centerpoint .................................................................................... 18
                 Using a Snappy Cursor ............................................................................................. 19
            Selecting Objects.............................................................................................................. 19
                 Status Line Information.............................................................................................. 19
                 Single Select.............................................................................................................. 19
                 Multiple Select ........................................................................................................... 20
                 Sub Select ................................................................................................................. 20
                 Block Select............................................................................................................... 21
                 Using the Selection Masks ........................................................................................ 21
                 Edit Deselect All ........................................................................................................ 24
                 Edit Select All ............................................................................................................ 24
                 Selecting a Net .......................................................................................................... 24
                 Select Highlighted...................................................................................................... 24
            Editing Objects ................................................................................................................. 24
                 Selection Reference Point ......................................................................................... 25
                 Moving Objects.......................................................................................................... 25
                 Rotating and Flipping Objects.................................................................................... 25
                 Resizing an Object .................................................................................................... 26
                 Cutting, Copying, and Pasting Objects ...................................................................... 27
                 Copying Objects (Ctrl+C)........................................................................................... 27
                 Drag-and-Drop (Ctrl+Left Click)................................................................................. 27
                 Copying to a File........................................................................................................ 27
                 Pasting From a File ................................................................................................... 28
                 Pasting a Circuit From a File ..................................................................................... 28
                 Pasting Limitations .................................................................................................... 28
                 Using the Copy Matrix Command.............................................................................. 28
                 Using the Edit Properties Command ......................................................................... 28
            Properties ......................................................................................................................... 28
                 Properties of Multiple Objects.................................................................................... 29
            Right Mouse Commands .................................................................................................. 29
            Loading and Saving Files ................................................................................................. 31
                 Drag and Drop File Load ........................................................................................... 31

chapter 4 Tutorial - PCB Design Session
            Introduction....................................................................................................................... 33


ii                                                                                                              P-CAD PCB User’s Guide
              Setting up the workspace ..................................................................................................33
                    Setting workspace configuration and display options .................................................33
                    Setting up layers ........................................................................................................35
                    Title blocks .................................................................................................................36
                    Display Options ..........................................................................................................38
                    Setting the line width ..................................................................................................39
                    Setting grids ...............................................................................................................39
              Object placement ..............................................................................................................40
                    Placing lines ...............................................................................................................40
                    Placing arcs................................................................................................................41
                    Placing pads...............................................................................................................42
                    Placing vias ................................................................................................................43
                    Placing text.................................................................................................................43
                    Placing fields ..............................................................................................................44
              Placing components ..........................................................................................................44
                    Setting up libraries .....................................................................................................44
                    Adding components....................................................................................................45
              Selecting objects ...............................................................................................................47
                    Selecting single objects..............................................................................................47
                    Selecting multiple objects...........................................................................................47
                    Subselecting objects ..................................................................................................47
                    Block selecting objects ...............................................................................................48
                    Selecting highlighted objects......................................................................................49
                    Selecting collocated objects .......................................................................................49
              Modifying objects...............................................................................................................51
                    Moving objects ...........................................................................................................51
                    Rotating objects .........................................................................................................51
                    Resizing objects .........................................................................................................52
                    Adding a vertex ..........................................................................................................52
                    Aligning components ..................................................................................................52
                    Copying and pasting objects ......................................................................................53
                    Pasting from the Clipboard.........................................................................................53
                    Duplicating objects using Copy Matrix........................................................................54
                    Deleting objects..........................................................................................................54
              Changing object properties................................................................................................54
                    Unifying values ...........................................................................................................55
                    Using the Selection Mask...........................................................................................56
                    Replacing components...............................................................................................57
              Initial board layout .............................................................................................................57
                    Creating a board outline .............................................................................................58
                    Loading a Netlist ........................................................................................................58
                    Positioning components .............................................................................................59
                    Optimizing nets ..........................................................................................................60
              Routing connections ..........................................................................................................61
                    Creating routing settings ............................................................................................61
                    Manual routing ...........................................................................................................63
                    Changing routed connections.....................................................................................65
                    Unrouting a board ......................................................................................................66



P-CAD PCB User’s Guide                                                                                                                                 iii
            Other options .................................................................................................................... 66
                 Pad and via stacks .................................................................................................... 66
                 Copper pours............................................................................................................. 68
                 Plowing tracks and cutouts ........................................................................................ 69
            Design verification ............................................................................................................ 70
                 Netlist verification ...................................................................................................... 70
                 Design Rule Checking ............................................................................................... 70
            Generating reports............................................................................................................ 72
            Printing and plotting your design ...................................................................................... 74
                 Setting up your print jobs ........................................................................................... 74
            Generating manufacturing files......................................................................................... 75
                 Generating Gerber output.......................................................................................... 75
                 Viewing Gerber photoplot files................................................................................... 78
                 Generating N/C drill files............................................................................................ 78

chapter 5   Documentation Tools
            Documenting a Design with Document Toolbox ............................................................... 79
                 Drawing Layers.......................................................................................................... 79
                 PCB Title Sheets ....................................................................................................... 80
                 Borders and Zones .................................................................................................... 80
                 Borders ...................................................................................................................... 80
                 Title Blocks ................................................................................................................ 82
                 Design Views............................................................................................................. 82
                 Revision Blocks ......................................................................................................... 82
                 Fields and Field Sets ................................................................................................. 83
                 Drawing and Revision Notes ..................................................................................... 83
                 Defining Drawing or Revision Notes .......................................................................... 83
                 Design Details ........................................................................................................... 84
                 Graphic Files ............................................................................................................. 85
                 Layer Stackup Diagrams ........................................................................................... 85
                 Drill Tables................................................................................................................. 86
                 Associative Dimensions............................................................................................. 87
            Printer & Plotter Setup ...................................................................................................... 88
            Printing ............................................................................................................................. 88
                 Setting Up Print Jobs................................................................................................. 89
                 Assign Drill Symbols.................................................................................................. 91
                 Setting up Print Colors and Other Options ................................................................ 93
                 Batch Print ................................................................................................................. 93

chapter 6   Routing
            Routing Features .............................................................................................................. 95
            Selecting a Route Tool ..................................................................................................... 96
            Routing Setup ................................................................................................................... 97
                Opening a File ........................................................................................................... 97
                Placing Connections.................................................................................................. 97
                Setting your Grids...................................................................................................... 97
                Status Line Grid Toggle............................................................................................. 98



iv                                                                                                                P-CAD PCB User’s Guide
                   Changing Layers ........................................................................................................98
                   Setting Line Width ......................................................................................................98
                   Setting Up Via Style ...................................................................................................99
                   Orthogonal Modes (O key) .......................................................................................101
                   Fixed Routable Objects ............................................................................................101
              Point-to-Point Routing .....................................................................................................102
              General Routing Features ...............................................................................................103
                   Status Line Information ............................................................................................103
                   T-Routing .................................................................................................................103
                   Routing with Curved Arcs.........................................................................................103
                   Unwind .....................................................................................................................105
                   Backtracking.............................................................................................................105
                   Routing to Free Copper............................................................................................105
                   Changing Layers ......................................................................................................105
                   Trace Cleanup..........................................................................................................105
                   Overlapping Connections .........................................................................................106
                   Copper Pours and Routing.......................................................................................106
              Manually Routing Connections........................................................................................106
                   Manual Routing Steps ..............................................................................................106
                   Terminating a Route.................................................................................................107
                   Arc Routing ..............................................................................................................108
                   Orthogonal Modes....................................................................................................108
              Interactive Routing ..........................................................................................................108
                   Interactive Routing Steps .........................................................................................108
                   Obstacle Hugging.....................................................................................................109
                   Pad Entry or Exit ......................................................................................................109
                   Terminating a Route.................................................................................................110
                   Loop Removal ..........................................................................................................111
              Miter Routing ...................................................................................................................111
                   Using the Route Miter Tool.......................................................................................111
                   Orthogonal Modes....................................................................................................113
              Modifying Routes.............................................................................................................113
              Route Bus........................................................................................................................113
                   Using Bus Route ......................................................................................................114
              MultiTrace Routing ..........................................................................................................115
                   Using MultiTrace ......................................................................................................116
                   Controlling Trace Placement ....................................................................................117
              Route Fanout...................................................................................................................118
                   Using Fanout Route .................................................................................................118
                   A Fanout Example....................................................................................................120
              Maximize Hugging/Minimize Length................................................................................122
              Visible Routing Area........................................................................................................123
              Shortcut Menu Commands..............................................................................................124
              Options Configure Route Tab..........................................................................................125
              Online DRC: ....................................................................................................................126

chapter 7     Auto Routing
              Introduction to the Shape-Based Router .........................................................................127


P-CAD PCB User’s Guide                                                                                                                               v
            Routing with Quick Route ............................................................................................... 127
                P-CAD Quick Route Steps....................................................................................... 128
                Completing the PC Board ........................................................................................ 130
                Verifying the Finished Board.................................................................................... 132
                Setting Up the Route Autorouter Dialog .................................................................. 132
                Commands Available during Routing ...................................................................... 140
                Toolbar .................................................................................................................... 144
                Quick Route Limitations........................................................................................... 145
                Routing Fine Points ................................................................................................. 145

chapter 8   Design Verification
            Introduction to Design Verification .................................................................................. 151
            Setting Up DRC Rules .................................................................................................... 151
                 Design Tab .............................................................................................................. 151
                 Layer Tab ................................................................................................................ 152
                 Rooms Tab .............................................................................................................. 153
                 Net Class Tab.......................................................................................................... 154
                 Net Tab.................................................................................................................... 154
                 Class to Class Tab .................................................................................................. 155
                 Working with Design Rule Check ............................................................................ 156
                 Design Rules by Hierarchy ...................................................................................... 156
                 Design Rules by Hierarchy ...................................................................................... 158
                 Copper Ties and DRC ............................................................................................. 164
            Configuring DRC............................................................................................................. 164
            Online DRC .................................................................................................................... 167
            Using DRC Error Annotation........................................................................................... 167
                 Finding DRC Errors ................................................................................................. 168
                 Overriding Error Displays ........................................................................................ 169
                 Block Selecting Error Indicators............................................................................... 169
                 Overriding DRC Errors ............................................................................................ 170
                 Fixing DRC Errors ................................................................................................... 170
                 Deleting DRC Errors................................................................................................ 170

chapter 9   CAM
            Introduction to CAM ........................................................................................................ 171
            Gerber Output................................................................................................................. 171
                 Set Up Output Files ................................................................................................. 172
                 Aperture Assignments ............................................................................................. 174
                 Setting Drill Symbols ............................................................................................... 176
                 Gerber Format ......................................................................................................... 177
                 Compress Output Files ............................................................................................ 178
                 Generating Gerber Output ....................................................................................... 178
            Gerber Verification.......................................................................................................... 178
            Deleting Gerber Layer Information.................................................................................. 180
                 No Free Pads on the Board ..................................................................................... 180
                 Free Pads on the Board .......................................................................................... 180
            Creating a Padmaster Gerber File .................................................................................. 181



vi                                                                                                            P-CAD PCB User’s Guide
              N/C Drill Output ...............................................................................................................181
                  Setting Up Output Files ............................................................................................182
                  Assigning Tools ........................................................................................................183
                  Set Format Options ..................................................................................................185
                  Compress Output Files.............................................................................................186
                  Generate N/C Drill Output ........................................................................................186
              Creating a Drill Symbol Legend.......................................................................................187
                  Generating Drill Drawing ..........................................................................................188

chapter 10 Copper Pours
              Introduction to Copper Pours...........................................................................................189
              Properties ........................................................................................................................189
              Islands .............................................................................................................................190
              Repour.............................................................................................................................190
                   Pour/Repour Options................................................................................................190
              Connectivity.....................................................................................................................191
              Setting Backoff ................................................................................................................192
              Thermals .........................................................................................................................192
              Circles .............................................................................................................................192
              Routing ............................................................................................................................192
                   Autorouting...............................................................................................................192
                   Manual and Interactive Routing................................................................................192
              Auto Plowing ...................................................................................................................193
              Overlapping Pours...........................................................................................................193

chapter 11    Interapplication Functions
              Introduction to Interapplication Functions ........................................................................195
              DDE Hotlinks ...................................................................................................................195
                   Enabling DDE Hotlinks .............................................................................................196
                   Setting the Current Highlight Color...........................................................................196
                   Highlighting Parts and Components .........................................................................196
                   Highlighting Nets ......................................................................................................196
                   Unhighlighting Parts and Components .....................................................................197
                   Unhighlighting Nets ..................................................................................................197
              ECOs...............................................................................................................................197
                   Types of ECOs.........................................................................................................197
                   Utils Record ECOs ...................................................................................................198
                   Utils Import ECOs.....................................................................................................198
                   Utils Export ECOs ....................................................................................................200
              Starting Other P-CAD Applications..................................................................................201
              Customizing P-CAD PCB ................................................................................................202

Chapter 12 File Commands
              Introduction to File Commands........................................................................................203
              File New ..........................................................................................................................203
              File Open.........................................................................................................................203
                   Drag-and-Drop File Load..........................................................................................204


P-CAD PCB User’s Guide                                                                                                                                   vii
            Open a File .............................................................................................................. 204
            Opening a Recently Used File ................................................................................. 204
            Opening an ASCII File............................................................................................. 204
       File Close........................................................................................................................ 205
       File Save......................................................................................................................... 205
            Saving an ASCII File ............................................................................................... 206
            Net Classes ............................................................................................................. 206
       File Save As ................................................................................................................... 206
            Save a File to a Name and Location........................................................................ 206
            Saving an ASCII File ............................................................................................... 207
       File Clear ........................................................................................................................ 207
       File Print ......................................................................................................................... 207
            Print Preview ........................................................................................................... 208
            Generating Print Jobs.............................................................................................. 209
            Setup Print Jobs ...................................................................................................... 210
            Drill Symbols............................................................................................................ 213
            Colors and Other Print Options................................................................................ 214
       File Print Setup ............................................................................................................... 215
       File Reports .................................................................................................................... 215
            Custom Report Option............................................................................................. 218
       File Design Info............................................................................................................... 223
            General Tab............................................................................................................. 224
            Fields Tab................................................................................................................ 224
            Attributes Tab .......................................................................................................... 226
            Notes Tab ................................................................................................................ 227
            Revisions Tab.......................................................................................................... 228
            Statistics Tab ........................................................................................................... 228
       File Design Technology Parameters............................................................................... 229
            Creating or Opening a Design Technology Parameters File ................................... 230
            Design Technology Parameters Dialog ................................................................... 230
       File Import Shape Route................................................................................................. 244
       File Import Gerber........................................................................................................... 244
       File Import DXF............................................................................................................... 246
            Loading a DXF File.................................................................................................. 246
            DXF to P-CAD PCB Layer Map ............................................................................... 247
            DXF Units ................................................................................................................ 248
            Locate DXF Origin ................................................................................................... 248
            View Log File Upon Completion .............................................................................. 249
            Items Supported for Translation .............................................................................. 249
            DXF Import Notes.................................................................................................... 251
       File Import PDIF.............................................................................................................. 251
            Open a File .............................................................................................................. 251
       File Import IDF ................................................................................................................ 252
       File Export Shape Route................................................................................................. 253
       File Export Gerber .......................................................................................................... 253
            Setup Output Files................................................................................................... 254
            Apertures Assignments ........................................................................................... 256
            Auto (Automatic Describe/Assign) ........................................................................... 257



viii                                                                                                        P-CAD PCB User’s Guide
                   Setting Drill Symbols ................................................................................................261
                   Gerber Format..........................................................................................................262
                   Compress Output Files.............................................................................................263
                   Generate Output Files ..............................................................................................263
              File Export N/C Drill .........................................................................................................264
                   Setup Output Files....................................................................................................266
                   Tools Assignments ...................................................................................................267
                   N/C Drill Format .......................................................................................................269
                   Compress Output Files.............................................................................................269
              File Export DXF ...............................................................................................................270
                   Component Height Check Box .................................................................................272
                   DXF Output Considerations .....................................................................................272
              File Export PDIF ..............................................................................................................273
                   PDIF File Export .......................................................................................................273
              File Export IDF ................................................................................................................274
              File Export RFQ Format ..................................................................................................276
              File Exit............................................................................................................................276

chapter 13 Edit Commands
              Using the Edit Commands...............................................................................................279
              Edit Undo.........................................................................................................................280
              Edit Redo.........................................................................................................................281
              Edit Cut............................................................................................................................281
                   Cutting Objects from Nets ........................................................................................282
              Edit Copy.........................................................................................................................283
              Edit Copy to File ..............................................................................................................283
              Edit Paste ........................................................................................................................284
                   Paste Behavior .........................................................................................................284
                   Paste From Clipboard ..............................................................................................286
                   Paste from File .........................................................................................................286
                   Paste To Layer .........................................................................................................286
                   Paste Special ...........................................................................................................287
                   Paste Circuit.............................................................................................................287
              Edit Move By RefDes ......................................................................................................290
              Edit Move to Layer ..........................................................................................................291
                   Moving an Object .....................................................................................................291
                   Restrictions ..............................................................................................................291
              Edit Properties.................................................................................................................292
                   Component Properties .............................................................................................293
                   Component Reference Links....................................................................................304
                   Connection Properties..............................................................................................305
                   Pad Properties .........................................................................................................307
                   Net Tab ....................................................................................................................309
                   Via Properties...........................................................................................................311
                   Line Properties .........................................................................................................313
                   Arc Properties ..........................................................................................................314
                   Polygon Properties ...................................................................................................315
                   Test Point Properties................................................................................................316


P-CAD PCB User’s Guide                                                                                                                                   ix
         Copper Pour Properties ........................................................................................... 317
         Cutout Properties..................................................................................................... 323
         Plane Properties ...................................................................................................... 323
         Room Properties...................................................................................................... 325
         Text Properties ........................................................................................................ 327
         Attribute Properties.................................................................................................. 328
         Field Properties ....................................................................................................... 330
         Design View Properties ........................................................................................... 331
         Detail Properties ...................................................................................................... 331
         Diagram Properties.................................................................................................. 332
         Picture Properties .................................................................................................... 333
         Table Properties ...................................................................................................... 333
         Dimension Properties .............................................................................................. 334
    Edit Delete ...................................................................................................................... 335
         Delete Objects ......................................................................................................... 335
         Deleting Objects from Nets...................................................................................... 336
    Edit Copy Matrix ............................................................................................................. 337
         Duplicating an Object(s) .......................................................................................... 337
    Edit Explode Component ................................................................................................ 338
         Exploding a Component .......................................................................................... 338
    Edit Alter Component...................................................................................................... 338
         Altering a Component.............................................................................................. 339
    Edit Align Components ................................................................................................... 340
         Align Horizontally or Vertically ................................................................................. 340
         Align to Grid............................................................................................................. 340
    Edit Select All ................................................................................................................. 341
    Edit Deselect All.............................................................................................................. 341
    Edit Highlight .................................................................................................................. 341
         DDE Hotlinks ........................................................................................................... 341
    Edit Unhighlight .............................................................................................................. 341
    Edit Unhighlight All.......................................................................................................... 342
    Edit Select Highlighted.................................................................................................... 342
    Edit Fix............................................................................................................................ 342
         Edit Fix .................................................................................................................... 342
         Edit Unfix ................................................................................................................. 342
         Edit Unfix All ............................................................................................................ 343
    Edit Rooms ..................................................................................................................... 343
    Edit Components ............................................................................................................ 344
         Components List Box .............................................................................................. 344
         Set All/Clear All........................................................................................................ 344
         Properties ................................................................................................................ 344
         Highlight/Unhighlight................................................................................................ 344
         Highlighting an Attached Net ................................................................................... 345
         Jumping to a Component ........................................................................................ 345
    Edit Nets ......................................................................................................................... 345
         Set By Attribute........................................................................................................ 349
         Set Nets By Layer Attribute ..................................................................................... 350
         Rename Nets........................................................................................................... 350



x                                                                                                        P-CAD PCB User’s Guide
                   Edit Attributes ...........................................................................................................350
                   Pad Properties .........................................................................................................354
                   Info Button................................................................................................................355
              Edit Measure ...................................................................................................................355
              Edit Select .......................................................................................................................356
                   Select Actions ..........................................................................................................356
                   Select Commands ....................................................................................................356
                   Selecting Objects .....................................................................................................356
                   When Objects Overlap .............................................................................................357
                   Moving and Copying Objects ...................................................................................357
                   Resizing Objects ......................................................................................................357
                   Rotating and Flipping ...............................................................................................358
                   Modifying (Edit Properties) .......................................................................................358
                   Shortcut Menu Commands.......................................................................................359
              Selection Reference Point ...............................................................................................359
                   Placing a Selection Reference Point ........................................................................359
                   Radial Placement .....................................................................................................359

chapter 14 View Commands
              Using the View Commands .............................................................................................361
              View Redraw ...................................................................................................................361
              View Extent .....................................................................................................................361
              View Last.........................................................................................................................362
              View All............................................................................................................................362
              View Center.....................................................................................................................362
              View Zoom In ..................................................................................................................362
              View Zoom Out................................................................................................................363
              View Zoom Window.........................................................................................................363
                  Using the Zoom Window ..........................................................................................363
              View Jump Location ........................................................................................................363
                  Jumping to a Location ..............................................................................................364
              View Jump Text...............................................................................................................364
                  Jumping to Text........................................................................................................364
              View Command Toolbar ..................................................................................................365
              View Placement Toolbar..................................................................................................365
              View Route Toolbar .........................................................................................................365
              View Custom Toolbar ......................................................................................................366
              View Prompt Line ............................................................................................................366
              View Status Line..............................................................................................................366
              View Snap to Grid ...........................................................................................................367

chapter 15 Place Commands
              Using the Place Commands ............................................................................................369
              Place Autoplace ..............................................................................................................370
                  Performing Autoplacement.......................................................................................372
              Place Component............................................................................................................374
                  Placing a Component ...............................................................................................374



P-CAD PCB User’s Guide                                                                                                                                  xi
          Rotating or Flipping a Component ........................................................................... 375
          Attributes ................................................................................................................. 376
          Jumper Pads ........................................................................................................... 376
          Test Points............................................................................................................... 376
      Place Connection............................................................................................................ 377
          Placing a Connection............................................................................................... 377
          Merging Nets ........................................................................................................... 378
          Jumper Pads ........................................................................................................... 378
      Place Pad ....................................................................................................................... 378
          Placing a Pad .......................................................................................................... 378
          Rotating or Flipping a Pad ....................................................................................... 379
          Renumbering Pads.................................................................................................. 379
          Modifying Pad Styles ............................................................................................... 379
      Place Via ........................................................................................................................ 380
      Place Line....................................................................................................................... 380
          Placing a Line .......................................................................................................... 380
          Status Line............................................................................................................... 380
          Orthogonal Modes (for Line Segments)................................................................... 381
      Place Arc ........................................................................................................................ 382
          Placing an Arc ......................................................................................................... 382
          Move, Rotate, Flip, Change ..................................................................................... 382
      Place Polygon................................................................................................................. 383
          Placing a Polygon.................................................................................................... 383
          Draft or Outline Display Mode.................................................................................. 383
          Rotating or Flipping a Polygon................................................................................. 383
          Altering the Shape of a Polygon .............................................................................. 384
      Place Point ..................................................................................................................... 384
          Placing Points.......................................................................................................... 385
          Placing Test Points.................................................................................................. 386
          Setting Point Size .........................................................Error! Bookmark not defined.
          Showing or Hiding Points ........................................................................................ 387
      Place Copper Pour ......................................................................................................... 387
          Placing a Copper Pour ............................................................................................ 387
          Rotate or Flip ........................................................................................................... 389
      Place Cutout ................................................................................................................... 389
          Placing a Cutout ...................................................................................................... 389
          Rotate or Flip ........................................................................................................... 390
      Place Keepout ................................................................................................................ 390
      Place Plane .................................................................................................................... 390
          Placing a Plane........................................................................................................ 390
          Pads and Vias ......................................................................................................... 391
          Rotating or Flipping a Plane .................................................................................... 392
      Place Room .................................................................................................................... 392
      Place Text....................................................................................................................... 393
          Place Text Dialog .................................................................................................... 393
          Place Text Features ................................................................................................ 395
          Zooming and Panning While Placing Text ............................................................... 396
          Text Summary ......................................................................................................... 396



xii                                                                                                       P-CAD PCB User’s Guide
              Place Attribute .................................................................................................................396
                  Placing an Attribute ..................................................................................................397
                  Rotating or Flipping a Field ......................................................................................397
              Place Field.......................................................................................................................398
                  Placing a Field..........................................................................................................399
                  Rotating or Flipping a Field ......................................................................................399
              Place Dimension .............................................................................................................400
                  Placing a Dimension.................................................................................................400
                  Modifying a Dimension .............................................................................................403
                  Rotating a Dimension ...............................................................................................403

chapter 16 Route Commands
              Using the Route Commands ...........................................................................................405
              Route Autorouter .............................................................................................................406
              Route View Log ...............................................................................................................407
              Route Manual ..................................................................................................................408
                  Manually Routing a Connection ...............................................................................409
                  Terminating a Route.................................................................................................409
                  Status Line Information ............................................................................................410
                  Routing between Layers...........................................................................................411
                  T-Routing .................................................................................................................411
                  Modifying Traces ......................................................................................................411
                  Orthogonal Modes (O key) .......................................................................................412
                  Online DRC ..............................................................................................................413
                  Overlapping Connections .........................................................................................414
                  Routing to Free Copper............................................................................................414
                  Copper Pours ...........................................................................................................414
              Route Interactive .............................................................................................................414
                  Routing Connections ................................................................................................414
                  Controlling Trace Placement ....................................................................................415
                  Pad Entry or Exit ......................................................................................................416
                  T-Routing .................................................................................................................417
                  Terminating a Route.................................................................................................417
                  Modifying Traces ......................................................................................................418
                  Changing Layers ......................................................................................................418
                  Vias, Layers, and Line Widths ..................................................................................419
                  Loop Removal ..........................................................................................................419
                  Copper Pours ...........................................................................................................419
                  Shortcut Menu ..........................................................................................................419
                  Keyboard Shortcuts..................................................................................................420
              Route Miter......................................................................................................................420
                  Using the Route Miter Tool.......................................................................................420
                  Editing Existing Miters ..............................................................................................421

chapter 17    Options Commands
              Using the Options Commands.........................................................................................423
              Options Selection Mask...................................................................................................423



P-CAD PCB User’s Guide                                                                                                                                xiii
          Items........................................................................................................................ 424
          Layers...................................................................................................................... 425
          Layer Sets ............................................................................................................... 426
          Select Mode Frame ................................................................................................. 426
          Selection Mask Parameters..................................................................................... 426
          Selecting and Modifying .......................................................................................... 427
          Single Selection Tab................................................................................................ 428
      Options Configure........................................................................................................... 429
          General Tab............................................................................................................. 429
          Online DRC Tab ...................................................................................................... 433
          Route Tab................................................................................................................ 435
          Manufacturing Tab................................................................................................... 437
      Options Grids.................................................................................................................. 439
          Mode ....................................................................................................................... 440
          Visible Grid Style ..................................................................................................... 440
          Relative Grid Origin ................................................................................................. 440
          Grid Spacing: Uniform/Non-uniform......................................................................... 440
          Grid Toggle Button (or G key).................................................................................. 441
      Options Display............................................................................................................... 442
          Colors ...................................................................................................................... 442
          Miscellaneous.......................................................................................................... 444
      Options Preferences ....................................................................................................... 448
          Keyboard Tab .......................................................................................................... 448
          Mouse Tab............................................................................................................... 449
      Options Layers ............................................................................................................... 450
          Layers Tab............................................................................................................... 451
          Sets Tab .................................................................................................................. 453
          Titles Tab................................................................................................................. 455
          Layers...................................................................................................................... 456
      Options Current Line....................................................................................................... 457
          Overriding Default Units .......................................................................................... 458
      Options Current Keepout ................................................................................................ 458
      Options Current Radius .................................................................................................. 459
      Options Design Rules ..................................................................................................... 459
          Design Tab .............................................................................................................. 459
          Layer Tab ................................................................................................................ 460
          Rooms Tab .............................................................................................................. 462
          Net Class Tab.......................................................................................................... 462
          Net Tab.................................................................................................................... 464
          Class to Class Tab .................................................................................................. 466
      Options Net Classes ....................................................................................................... 469
      Options Pad Style ........................................................................................................... 472
          Simple and Complex Pad Styles ............................................................................. 473
          Adding a Pad Style .................................................................................................. 473
          Modify a Simple Pad Style....................................................................................... 474
          Modify a Complex Pad Style.................................................................................... 474
          Purging Pad Styles .................................................................................................. 480
          Renaming a Pad Style............................................................................................. 480



xiv                                                                                                      P-CAD PCB User’s Guide
                  Setting a Hole Range ...............................................................................................480
                  Merging Pad Styles ..................................................................................................481
              Options Via Style.............................................................................................................482
              Options Text Style ...........................................................................................................482
                  Adding Text Style .....................................................................................................483
                  Changing Text Display .............................................................................................483
                  Text Style Properties ................................................................................................484
                  Purging Text Styles ..................................................................................................484
                  Renaming Text Style ................................................................................................484
                  Deleting Text Style ...................................................................................................484
                  Text Style Properties Dialog.....................................................................................485
                  Merging Text Styles..................................................................................................486

chapter 18 Library Commands
              Using the Library Commands ..........................................................................................487
              Library New .....................................................................................................................487
              Library Alias.....................................................................................................................488
                   Creating an Alias ......................................................................................................488
              Library Copy ....................................................................................................................489
                   Copying Patterns/Components ................................................................................490
              Library Delete ..................................................................................................................491
                   Deleting from a Library .............................................................................................491
              Library Rename...............................................................................................................492
                   Renaming a Pattern/Component ..............................................................................492
              Library Setup ...................................................................................................................493
                   Drag and Drop File Load ..........................................................................................493
                   Setting Up a Library..................................................................................................493
              Library Pattern Save As...................................................................................................494
                   Saving a Pattern.......................................................................................................494
              Library Archive Library.....................................................................................................495

chapter 19 Utils Commands
              Using the Utils Commands ..............................................................................................497
              Utils Renumber................................................................................................................497
                   Renumbering Reference Designators ......................................................................497
                   Renumbering Pads...................................................................................................499
                   Renumbering Default Pin Designators .....................................................................500
              Utils Force Update...........................................................................................................500
              Utils Record ECOs ..........................................................................................................502
                   Types of ECOs.........................................................................................................502
              Utils Import ECOs............................................................................................................503
                   ECO Filename..........................................................................................................503
                   Preview ECOs ..........................................................................................................504
                   Pseudo Patterns.......................................................................................................504
              Utils Export ECOs ...........................................................................................................505
                   View Pending ECOs.................................................................................................505
                   Save ECOs Now ......................................................................................................505



P-CAD PCB User’s Guide                                                                                                                                xv
      Utils DRC........................................................................................................................ 506
           Filename.................................................................................................................. 507
           View Report ............................................................................................................. 507
           Design Rules (DRC Setup)...................................................................................... 507
           Annotate Errors ....................................................................................................... 516
           Severity Levels ........................................................................................................ 516
           Summarize Ignored Errors ...................................................................................... 517
           Summarize Overridden Errors ................................................................................. 517
           Clear All Overrides .................................................................................................. 518
           Design Rule Checks ................................................................................................ 518
           Area To DRC ........................................................................................................... 519
      Utils Find Errors .............................................................................................................. 519
      Utils Load Netlist............................................................................................................. 520
           Loading a Netlist...................................................................................................... 521
           Loading a Netlist on an Existing Board.................................................................... 522
           Pseudo Patterns ...................................................................................................... 522
           Jumper Pads ........................................................................................................... 522
           Optimize Nets .......................................................................................................... 522
           Reconnect Copper................................................................................................... 523
           Check for Copper Sharing ....................................................................................... 523
      Utils Generate Netlist...................................................................................................... 523
           Generate a Netlist.................................................................................................... 523
      Utils Compare Netlist ...................................................................................................... 524
           Comparing a Netlist ................................................................................................. 524
      Utils Optimize Nets ......................................................................................................... 525
           Utils Optimize Nets Command................................................................................. 525
           Manual Gate Swap .................................................................................................. 527
           Rules for Pin Swapping ........................................................................................... 529
           Rules for Gate Swapping......................................................................................... 530
           Impact on the Library Executive .............................................................................. 530
      Utils Reconnect Nets ...................................................................................................... 530
           Check for Copper Sharing ....................................................................................... 531
           Jumper Pads ........................................................................................................... 531
           Create Nets From Free Copper ............................................................................... 531
      Utils Trace Clean-up ....................................................................................................... 532
      Utils Shortcut Directory ................................................................................................... 532
      Utils P-CAD Schematic................................................................................................... 532
      Utils P-CAD Library Executive ........................................................................................ 532
      Utils P-CAD Pattern Editor.............................................................................................. 532
      Utils P-CAD Symbol Editor ............................................................................................. 532
      Utils P-CAD InterPlace/PCS ........................................................................................... 533
      Utils P-CAD Signal Integrity............................................................................................ 533
           Running a Signal Integrity Analysis ......................................................................... 533
      Utils P-CAD AutoRFQ..................................................................................................... 537
      Utils Customize............................................................................................................... 537
           Displaying the Custom Toolbar................................................................................ 539
           Executing a Custom Tool ........................................................................................ 539




xvi                                                                                                      P-CAD PCB User’s Guide
Chapter 20 DocTool Commands
              Using the DocTool Commands........................................................................................541
              DocTool Place Table .......................................................................................................541
                  The Basic Place Table Dialog ..................................................................................542
                  Note and Revision Note Table Options ....................................................................542
                  Drill Table Advanced Options...................................................................................543
              DocTool Place Design View ............................................................................................543
              DocTool Place Detail .......................................................................................................545
              DocTool Place Diagram...................................................................................................546
              DocTool Place Picture .....................................................................................................548
              DocTool Titles .................................................................................................................548
              DocTool Notes.................................................................................................................548
              DocTool Update ..............................................................................................................548
              DocTool Update All .........................................................................................................549
              DocTool Mirror On Copy..................................................................................................549

chapter 21 Macro Commands
              Using the Macro Commands ...........................................................................................551
              Macro Setup ....................................................................................................................551
                  Setting Up a Macro...................................................................................................551
              Macro Record..................................................................................................................552
                  Macro Recording Tool ..............................................................................................552
                  Recording a Macro ...................................................................................................553
                  Recording a Temporary Macro.................................................................................553
              Macro Delete ...................................................................................................................554
              Macro Rename................................................................................................................554
              Macro Run.......................................................................................................................555
              Recording Efficient Macros..............................................................................................555
              Other Macro Features .....................................................................................................556
                  Running a Macro ......................................................................................................556
                  Status Line Recording Indicators .............................................................................556
                  Automatic Delays .....................................................................................................557
                  Editing Macro Files...................................................................................................557
              Macro File Syntax............................................................................................................557
                  Mouse Events ..........................................................................................................558
                  Keyboard Events ......................................................................................................558
                  Special Events .........................................................................................................561
                  Edit Events ...............................................................................................................561
                  File Syntax ...............................................................................................................561

chapter 22 Window Commands
              Using the Window Commands ........................................................................................563
              Window New Window......................................................................................................563
              Window Cascade ............................................................................................................563
              Window Tile.....................................................................................................................563
              Window Arrange Icons ....................................................................................................564
              Selecting a Window.........................................................................................................564


P-CAD PCB User’s Guide                                                                                                                              xvii
chapter 23 Help Commands
           Help P-CAD PCB Help Topics........................................................................................ 565
           How to Use Help............................................................................................................. 565
           Series II Commands ....................................................................................................... 565
           About P-CAD PCB.......................................................................................................... 565

appendix A Keyboard Reference
           Keyboard Shortcuts in P-CAD PCB ................................................................................ 567

appendix B P-CAD System Messages
           Error Messages .............................................................................................................. 571
           Warning Messages ......................................................................................................... 576

Index
           Index............................................................................................................................... 581




xviii                                                                                                           P-CAD PCB User’s Guide
                                                                                    CHAPTER             1


                                      Introduction to P-CAD PCB

       Congratulations on your purchase of P-CAD PCB! P-CAD PCB is a highly versatile and flexible
       productivity-enhancing tool for the professional designer. It meets the design requirements of
       today’s complex boards in a straight-forward easy-to-use manner.
       P-CAD PCB is an advanced printed circuit board design system for the Microsoft Windows
       operating systems. It includes a powerful combination of design tools to make your job easier and
       achieve superior results.


P-CAD PCB Features
       This section highlights some of the important P-CAD PCB features:
       •   Up to 999 layers; multiple power and ground planes.
       •   User-definable board, net, and component attributes.
       •   Copper pour with clearances following design rules or user settings, plowed tracks, island
           removal.
       •   Support for Design Technology Parameters.
       •   User-definable pad stacks, including blind/buried vias.
       •   Split power/ground planes.
       •   Cross-probing with P-CAD Schematic.
       •   Advanced bi-directional ECO capabilities.
       •   Component library data integrated for use in both P-CAD Schematic and P-CAD PCB.
       •   Powerful pattern graphic capabilities with automatic alternate pattern graphic selection based
           on side of board and component rotation.
       •   Item rotation to 0.1 degree.
       •   Curved traces.



P-CAD PCB User’s Guide                                                                                      1
Chapter 1: Introduction to P-CAD PCB                                                       About this Guide


       •    Comprehensive Design Rules Checking with error annotation and on-screen highlighting.
       •    Tightly integrated with the P-CAD Shape-Based Autorouter.
       •    Full range of manufacturing and assembly functions.
       •    Tight integration to the SPECCTRA® autorouter, CAM350®, and Viewlogic® products.
       •    Integrated web-based request for PCB fabrication quotation feature.
       •    IDF version 3 import and export options.
       •    Extensive print and report options.
       •    Block and subselection allow portions of designs to be copied, moved, rotated and deleted.


About this Guide
       This manual provides information about P-CAD PCB, a full-featured printed circuit board design
       system, and P- CAD PCB (6/400), a reduced-capacity printed circuit board design system.
       This manual includes the following sections:
       •    Getting Started: This section tells what you need to get started using P-CAD PCB. It provides
            installation instructions and walks you through the basic capabilities of P-CAD PCB. Tutorial
            chapters provide instructions on creating and navigating a simple design.
       •    Using PCB: These chapters provide information that you need to work with P-CAD PCB. They
            give you details on some of PCB’s advanced features such as manual, interactive, and automatic
            routing, as well as using Design Technology Parameters.
       •    PCB Reference: This section includes an extensive command reference, covering all of the P-
            CAD PCB commands


About P-CAD PCB (6/400)
       P-CAD PCB (6/400) has the full range of advanced design features available with P-CAD PCB, but
       with reduced design capacity. It is a Windows-based printed circuit board design system.
       Differences between the two products have been noted throughout this manual with the symbol
       you see in the left margin. The following chart provides a summary of those differences:


           Maximum number of components           400
           Maximum number of layers               Maximum of six copper layers, including a predefined Top
                                                  and Bottom layer and four user- defined signal or plane
                                                  layers.

           Network Licensing                      Unsupported




2                                                                                 P-CAD PCB User’s Guide
                                                                                     CHAPTER             2


                                                   Installation and Setup

       This section lists the required hardware and software settings you need to install the P-CAD Suite.


System Requirements
       Make sure that your PC and its software conform to the following P-CAD requirements and
       recommendations.

   Recommended System
       •   Windows NT 4/2000 Professional
       •   PC with Pentium III Processor
       •   128MB RAM (256MB for high component/net count)
       •   400MB Hard Disk Space
       •   Desktop area 1024x768 pixels
       •   32-bit Color Palette
       •   CD-ROM Drive
       •   Mouse or compatible pointing device

   Minimum System
       •   Windows 95/98/2000Me
       •   PC with Pentium 166MHz
       •   64MB RAM
       •   200MB Hard Disk Space (without ISO libraries)
       •   Desktop area 800x600 pixels
       •   256 Color Palette


P-CAD PCB User’s Guide                                                                                       3
Chapter 2: Installation and Setup                                              Installing P-CAD Products


        •   CD-ROM Drive
        •   Mouse


Installing P-CAD Products
        For up-to-date installation information refer to the file Readme.WRI, located on the product CD.
        This file can also be found in the application program folder (\Program Files\P-CAD 2002) after
        installation. Note that the setup program on the Product CD can also be used to Repair or Remove
        an existing P-CAD Installation.




4                                                                               P-CAD PCB User’s Guide
                                                                                       CHAPTER            3


                                                                               PCB Basics

       This chapter introduces many of the basic features you need to know when using P-CAD PCB. It
       includes general information on such topics as:
       •   The user interface
       •   View commands
       •   Using layers
       •   Object/action interaction
       •   Placing objects
       •   Edit objects
       •   Properties
       •   Right mouse commands
       •   Loading and saving files
       What is presented here is a high level look at PCB capabilities. For a detailed description of a
       particular operation, refer to the appropriate chapters. For instructions on how to perform a
       particular operation refer to the Tutorials chapter.




P-CAD PCB User’s Guide                                                                                    5
Chapter 3: PCB Basics                                                            About the User Interface




About the User Interface
       The PCB interface follows the standard Windows format, with the addition of PCB-specific controls.




    Menu Bar
       The menu bar allows you easy access to PCB commands and functions.



       To activate a menu, click the menu title or press the ALT key in combination with the underlined
       letter of the menu title (e.g., ALT+F to open the File menu). When the menu appears, click a menu
       item, or press the underlined key, to choose a command.
       •   A command followed by three dots (e.g., Open...) opens a dialog when you choose it.
       •   The menu bar wraps if you reduce the width of the window. In contrast, other areas of the
           screen truncate with screen reduction.

    Toolbars
       Three toolbars provide shortcuts to commonly used commands and PCB functions. Toolbars
       appear when you choose the appropriate View command. Once a toolbar is visible on your screen,
       you can use your mouse to drag it to a new position. It can be docked along the edges of your
       screen, or left floating in the middle of your display. A floating toolbar can be resized.



6                                                                               P-CAD PCB User’s Guide
About the User Interface                                                               Chapter 3: PCB Basics


        Tool Tips explain each of the toolbar buttons. To activate a Tool Tip, simply place the mouse over
        the button.

    Command Toolbar
        The Command Toolbar provides shortcuts to menu commands and other system functions.




        These buttons appear on the Command Toolbar.


         Click this button          To do this:       Click this button         To do this:
                              Edit Select                                 Edit Paste

                              File New                                    Edit Undo

                              File Open                                   Edit Redo

                              File Save                                   Edit Measure

                              File Print                                  View Zoom Window

                              Edit Cut                                    Online DRC

                              Edit Copy                                   Record ECOs


        The Undo, Redo and Zoom Window buttons operate in conjunction with other PCB tools. For
        example, if the Place Arc tool is active and you choose to undo an action, you can then resume
        placing arcs without having to restart the command.

    Placement Toolbar
        The Placement Toolbar provides shortcuts to PCB placement commands.




P-CAD PCB User’s Guide                                                                                       7
Chapter 3: PCB Basics                                                              About the User Interface


       These buttons appear on the Placement Toolbar:


        Click this button         To do this:        Click this button          To do this:
                            Place Component                              Place Copper Pour

                            Place Connection                             Place Cutout

                            Place Pad                                    Place Keepout

                            Place Via                                    Place Plane

                            Place Line                                   Place Room

                            Place Arc                                    Place Text

                            Place Polygon                                Place Attribute

                            Place Point                                  Place Field

                                                                         Place Dimension


       Click these buttons to select a PCB tool such as the Place Line tool or the Select tool. Once
       selected, a tool remains active until you select another tool.
       When a tool is active you can perform actions associated with the tool as well as certain one-time
       actions such as zooming, changing layers, and undoing the last operation.
       For example, when you enable the Place Line tool, you are limited to placing line segments and
       cannot perform other actions like placing an arc (Place Arc) or selecting another object (Edit
       Select).

    Route Toolbar
       The Route Toolbar provides shortcuts to PCB route commands.




8                                                                                  P-CAD PCB User’s Guide
About the User Interface                                                                  Chapter 3: PCB Basics


        These buttons appear on the Route Toolbar:


         Click this button          To do this:          Click this button            To do this:
                             Route Manual                                       Route Fanout

                             Route Interactive                                  Push Traces

                             Route Miter                                        Maximize Hugging

                             Route Bus                                          Minimize Length

                             Route MultiTrace                                   Visible Routing Area



    Custom Toolbar
        You can create a Custom Toolbar for access to other applications from PCB. Programs are added to
        the Custom Toolbar by choosing the Utils » Customize command. You can launch any of the
        programs by clicking their Custom Toolbar buttons or selecting them from the list of programs that
        appear in the Utils menu.
        Complete instructions on creating and using the Custom Toolbar are found in, Utils Commands,
        (page 497).

    Prompt Line
        The Prompt Line lies below the work area and is the first line of the prompt/status line area,
        extending the complete width of the PCB display (the second line being the Status Line. Its display
        can be displayed or hidden using the View » Prompt Line command). When there is no prompt, the
        area is empty.
        When you choose a command or process, the Prompt Line displays a prompt message that
        provides useful instructions on what to do when a certain tool is selected.

    Status Line
        The Status Line area is at the bottom of the screen and its display can be turned on or off by
        choosing the View » Status Line command. A check mark next to the Status Line indicates that the
        Status Line display is turned on.



        The Status Line has the following basic features, from left to right:




P-CAD PCB User’s Guide                                                                                        9
Chapter 3: PCB Basics                                                               About the User Interface


     X and Y Coordinates
       These two values in the lower-left corner of the Status Line show you the position of the cursor as
       you move it over the workspace. The display lets you enter the exact X and Y coordinates of specific
       points on the screen.
       Keyboard shortcuts listed below are defaults; you can change them by choosing the Options »
       Preferences command.
       If the Select tool is enabled, these boxes act as a shortcut for the View » Jump Location command:
       1.   Press the J key to get focus on the X coordinate edit box.
       2.   Type an X coordinate value.
       3.   Press the TAB key to move to the Y coordinate box.
       4.   Type a Y coordinate value.
       5.   Press ENTER. The cursor moves to the new X, Y coordinate, scrolling the workspace if
            necessary.
       If a Placement tool is enabled, these boxes let you specify a specific X, Y location at which to place
       the object.
       For certain multi-point objects such as lines, buses, and polygons, you can use these boxes to place
       the object at specific locations:
       1.   Choose one of the Placement commands (e.g., Place » Line).
       2.   Press the J key to set focus on the X coordinate edit box.
       3.   Type an X coordinate value.
       4.   Move to the Y coordinate box.
       5.   Type a Y value.
       6.   Press ENTER set the start point of the object.
       7.   Repeat steps 2 through 6 for each point in the object.
       8.   Press ESC to complete placement of the object.
       The coordinate values express either millimeters or mils, depending on the settings in the Options
       Configure dialog; the decimal point is placed at hundredths for mm, tenths for mils. Negative
       numbers appear in relative grid mode only when the relative origin point is somewhere other than
       the lower-left (absolute) origin.

     Grid Toggle Buttons
       The Grid toggle button and the Grid combo box beside it allow you to easily switch between grid
       settings and add new grid settings. The toggle switches between absolute grid (Abs, with white
       background) and relative grid (Rel, with colored background). Your absolute and relative grid
       values can be changed from the combo box. The A key toggles between absolute and relative grids.



10                                                                                  P-CAD PCB User’s Guide
About the User Interface                                                             Chapter 3: PCB Basics


        Absolute grid always uses the lower-left corner of the workspace as the origin point (X and Y are
        both zero). Relative grid allows you to specify any point as an origin point. You can even make the
        origin point for relative the same as for absolute, thereby making the toggle button a combination
        of grid sizes rather than absolute vs. relative.

        Choose a new grid from the list to add new grids to your design.




        To add a new grid, type a new value and press ENTER. The new grid becomes the current grid. The
        G key scrolls forward through the list of grid settings. SHIFT+G scrolls back through the list.

    Macro Record (Temporary Macro) Button
        The Macro toggle button, located on the Status Line, allows you to create temporary macros on the
        fly to produce shortcut functions for temporary use. These temporary macros are named _DEFAULT
        in the program. Typically, you would use this temporary macro for a short time within a design
        process (e.g., repeatedly placing a combination of lines, duplicating the same lengths and angles).
        The M key is equivalent to the M button.
        Only one temporary macro is available at a time; each time you record a new macro, it overwrites
        the previous one.

        To Record a Macro
        1.   Click the M button (or press the M key) to begin recording; the button displays a red
             background when it is recording.
        2.   Perform whatever actions you wish to temporarily record.
        3.   To stop recording, click the M button (or press the M key) again; the red background
             disappears when it stops the temporary recording.
        4.   Press the E key to execute the temporary macro. The actions you recorded will repeat at the
             cursor location each time you press E.
        Although it is not common while recording a temporary macro, you can temporarily halt the
        recording of the macro (to perform an interim action you don't want to be part of the macro
        recording). Use the Macro Record/Stop command, and click Pause in the dialog. When you do this,
        the background color of the M button turns to yellow. To resume recording, use the Macro
        Record/Stop command again and click Resume. To finish recording, click the M button again.

        The M key also ends the recording of a named macro (Macro Record/Stop).

        To create more permanent macros, use the Macro Record/Stop command to name the macro
        before recording it. Refer to the command documentation in the Command Reference section of
        this manual for more information.
        The default macro also can be renamed to a more permanent name using the Macro » Rename
        command.



P-CAD PCB User’s Guide                                                                                        11
Chapter 3: PCB Basics                                                               About the User Interface


     Layer Display Combo Box and Scroll Buttons
        These buttons are a shortcut to the Options » Layers command and dialog. Use the list box (a list of
        layers) and scroll buttons to select or change layers.




        The list box (enabled with the single down arrow) shows a list of current layers from which you can
        choose. The scroll buttons (up and down arrows) and L and SHIFT+L allow you to scroll through the
        enabled layers in order.
        The color swatch shows the line color for the corresponding layer. Clicking this swatch opens the
        Options Layers dialog. Line colors can be viewed or altered by using the Options » Display
        command.

     Line Width Combo Box
        This combo box presents a list of line widths set using the Options Current Line dialog. You can
        select a line width or type a new value to add a new line width to the list. The new width becomes
        the current width. W and SHIFT+W allow you to scroll up and down through the list of line widths.




     Radius Combo Box
        The Radius combo box displays the current radius setting used when placing polygonal shapes that
        have rounded corners. You can select a radius setting from the pull down list or enter a new radius
        number. Radius settings can also be applied using the Options » Current Radius command. The
        new radius becomes the current radius.




     Status Information Area
        Displays information relevant to the action you are currently performing.



        The information area displays the following types of data:
        •   Total length of the current line or route you are creating.
        •   Identifies selected objects either specifically (net name, reference designator and layer) or
            generally (number of items selected).
        •   The delta X and delta Y measurements of objects being moved or line segments being
            stretched.
        •   Pad numbers when you are numbering them.



12                                                                                  P-CAD PCB User’s Guide
View Commands                                                                        Chapter 3: PCB Basics


   Workspace
       The workspace is the logical design area in a design. You can alter your workspace size with the
       Options » Configure command.
       The workspace area and the window are not necessarily the same thing. Since the window is
       rectangular, if you specify your workspace as square and choose View » Zoom Out or View » All,
       the square workspace area covers the left area of the window, leaving an “out of bounds” area to
       the right in which no work can be done. The edge of the workspace can be determined by the edge
       of the displayed grid, or when the cursor readout stops changing. By resizing the window, you can
       reduce the size of the out of bounds area.

   Using Multiple Windows
       PCB allows you to open multiple design files at the same time. Additionally, you can have multiple
       windows open on the same design to view different parts of it simultaneously.
       Each design file you open creates a window inside the application window in which you can edit
       that design. As is standard in Windows, you can change the length and width of each window in
       relation to the other windows running on your screen. You can also activate or deactivate other
       screen areas such as the Placement Toolbar and status/prompt line areas, which alternately
       decreases or increases the available space in the application window.


View Commands
       You can use the view commands to control how your design appears on the screen. You can zoom
       in to see and edit fine details of your design. You can zoom out to view the entire design. Scrolling
       allows you to move across the screen. The jump commands allow you to jump to a specific
       component or location.

   Zoom Commands
       You can use the zoom commands to zoom in and out and move around the workspace, making it
       easier to perform such functions as creating a board outline, and manually placing components.

   (View) Zoom In/Out
       When you use the zoom in/out functions, the cursor changes to a magnifying glass shape until you
       click in the workspace. The spot where you click becomes the center of the zoom area. The amount
       of zoom is determined by the Zoom Factor value in the Options Configure dialog.
       Another way to zoom in and out is to use the plus + key to zoom in and the minus - key to zoom
       out. When you use the plus key or minus key, you don't need to click in the workspace to zoom;
       the cursor location becomes the center of the zoom area.
       You must re-invoke the Zoom command (or Zoom key) for every zoom action.




P-CAD PCB User’s Guide                                                                                      13
Chapter 3: PCB Basics                                                                      View Commands


     (View) Zoom Window
            The zoom window is drawn to enclose a certain area of your workspace, and then fill the
       screen with the contents of the window.
       The three ways to invoke zoom window are the Z key, the Placement Toolbar Zoom button, and the
       View » Zoom Window command on the menu. After you invoke the command, click and drag to
       define the window size in the workspace. Release the mouse button and the window you
       designated fills the workspace.

     Other View Options
       The following view options are also available:
       •   View » Center:(the C key): centers the design around the current cursor location.
       •   View » Extent: causes the display to encompass all items in the workspace.
       •   View » Redraw: clears everything in the workspace to the background color and then repaints
           the screen.
       •   View » Last: redraws the previous (last) view, if you have altered the view in any way.
       •   View » All: redraws the screen with the entire workspace shown.
       •   Panning: You can use the C key for panning across the workspace by moving the cursor and
           pressing C repeatedly; each time you press the C key the display re-centers around the current
           cursor location.
       •   Scroll bars: Use the scroll bars and scroll boxes to view items that exist beyond the border of a
           window. Drag the scroll box or click the scroll button to pan through a design moving up and
           down or from side to side.

     Jump Commands
       Jump commands allow you to jump to a specific component, location, text string or node. For
       additional information, see Utils Commands, (page 497).

       Jump to a Component
       Use the Edit Components dialog to view the components in your design.
       Select one component from the Components list box and click Jump to jump to that component.
       The component appears in the center of your workspace.

       View Jump Location
       This command allows you to position the cursor to a specified location (X, Y coordinates).
       If you are zoomed in, this command pans the workspace to the specified location, attempting to
       center the location. If the specified location is already visible on the screen, no panning is
       necessary. The units used for the location value (mil or mm) are determined by the setting in
       Options Configure.



14                                                                                P-CAD PCB User’s Guide
Using Layers                                                                           Chapter 3: PCB Basics


       With the select tool enabled, you can use the X, Y Coordinate boxes in the status bar as a shortcut
       for this command.

       View Jump Text
       This command accesses the View Jump Text dialog. You can use it to search through all text strings
       and locate a specific combination of letters.
       When PCB finds the first instance of the specified text string, it highlights it in the current highlight
       color. To search for text matches based on case, enable the Case Sensitive Search option. To search
       all layers for the specified text string, enable the Search Entire Design option. If this option is
       disabled, PCB searches the current layer only.

       Jump to a Node
       You can use the Edit Nets dialog to jump to a node attached to a particular net. Select a node from
       the Nodes list box and click the Jump to Node button.


Using Layers
       PCB allows you to enable and configure up to 999 layers (including the eleven predefined layers) to
       accommodate even the most demanding PC board designs.

       P-CAD PCB (6/400) designs are restricted to a maximum of six copper layers, including a predefined
       Top and Bottom layer and four user-defined signal or plane layers. P-CAD PCB (6/400) designs can
       have a total of 999 layers.

       You can use the Options Layers dialog to add, name, number, and assign layers to a PCB design.
       This dialog also lets you arrange layers to reflect the actual layer order of your board. You can
       enable or disable layers (for display and routing), and make one of the enabled layers current. The
       dialog displays all existing design layers, and you can create additional layers as needed.
       The Current drop down list in the Options Layers dialog allows you to choose a layer to be the
       current layer. Clicking on the color swatch in the status bar opens the Options Layers dialog.




       Additionally, you can use the L key or the layer box on the Status Line (combo box and scroll
       arrows) as a shortcut for selecting the current layer. The current layer is identified by name and
       color on the Status Line. Use SHIFT+L to scroll backwards through the enabled layers.

   Placing Objects
       When you place an object into a design, it is placed on the current layer unless it is an object that is
       defined on several layers such as a pad, via, or component. These objects are composed of other
       objects that may be defined on more than one layer.




P-CAD PCB User’s Guide                                                                                        15
Chapter 3: PCB Basics                                                                Object/Action Interaction


     Item and Layer Drawing Order
        Except where overridden, objects on the layers are drawn as follows: plane and non-signal layers
        are drawn first, followed by signal layers, with the current layer drawn last. Pads defined on the
        current layer are the last items drawn on the current layer.


Object/Action Interaction
        Consistent with other Windows compliant interfaces, the user interface provides you with menu
        choices, dialogs, options, and feedback based on what is appropriate given the current state of
        your design and PCB. The interface provides power, flexibility, and logical choices based on the
        object(s) currently selected and the command or process currently being invoked. For example, the
        product main menu changes to reflect only those commands that may be accessed when
        autorouting after the autorouter has been started.

     Object Selection and Placement
        Current and enabled layer status (Options Layers) affects the selection and placement of objects.
        Objects are placed individually on the current layer. Objects can be selected on the current layer or
        on all enabled layers through the Options » Preferences option to Allow Single Select on All Enable
        Layers.
        Block selection of objects depends on the selection masks and filters set in the Options Selection
        Mask dialog and may be further filtered by enabling and disabling layers using the Options Layers
        dialog.

     Object Selection and Object Properties
        Perhaps the most powerful aspect of the interface is its ability to modify one or more objects by
        selecting the objects and then performing an action on your selection. Items can be individually
        selected, selected using a set of selection criteria (Options » Selection Mask), or by other methods
        such as by using the Select button in the Edit Nets dialog.
        After an object or collection of objects is selected, you can select all associated net objects, delete,
        move as a group, highlight the objects, or if the objects are the same type, you can modify or query
        their properties. (Many of these most frequently used commands can be accessed by clicking the
        right mouse button after you have selected the objects. This provides an unprecedented ability to
        globally or individually modify and enhance your design based on your own preferred design style.


Placing Objects
        You can use Place commands to draw new objects or place already created objects, such as
        components, into your design.
        The objects that you can place in your design are those listed on the Place menu, in order:
        Component, Connection, Pad, Via, Line, Arc, Polygon, Point, Copper Pour, Cutout, Keepout, Plane,
        Room, Text, Attribute, Field, and Dimension.




16                                                                                   P-CAD PCB User’s Guide
Placing Objects                                                                        Chapter 3: PCB Basics




        When you enable one of these Place commands, it remains enabled until you enable a different
        tool. However different tools act differently. For example, for the Line tool each click places
        another line segment until you click the right mouse button. For the Pad tool, each click places a
        new pad.
        When you place an item, it is always placed at a grid point regardless of your cursor setting. See
        Options Grids (page 439).

    Moving Objects
        You can move pads, vias, components, points, text, attributes, and fields while you are placing
        them. Instead of clicking and releasing on a certain location, you can click and hold the mouse
        button, then move the ghosted outline of the object before releasing to place it. This is the
        recommended placement method, as you can be more accurate in placement location.
        Some of these objects require the interaction of a dialog before the object can be placed (e.g.,
        content of text), but the placement characteristics are the same.

        P-CAD PCB (6/400) designs are restricted to a maximum of six copper layers, including a predefined
        Top and Bottom layer and four user-defined signal or plane layers. P-CAD PCB (6/400) designs can
        have a total of 999 layers.

    Rotating and Flipping Objects
        You can also rotate and flip many objects (e.g. components, pads) that appear on your design while
        you are placing them. For example, when the Place Component tool is active, when you click and
        hold the left mouse button, you can rotate the component by pressing R or flip it by pressing F
        before you finally place it.
        You can find details on which objects can be rotated or flipped by looking at the specific place
        command in the command reference chapter of this manual.

    Orthogonal Modes
        While placing lines, you can press the O key to cycle through the enabled orthogonal modes. The
        enabled orthogonal modes are determined by the settings in the Options Configure dialog. For
        placing lines, the modes are limited to line segments (no arcs).
        The orthogonal modes are divided into mode pairs, as shown in the following paragraphs. The F
        key toggles between the mode pair of the orthogonal mode you are in. The “any angle” straight
        line mode is always available, no matter what orthogonal modes are enabled.

        90/90 Line-Line
        Both lines are either horizontal or vertical (displayed perpendicular to each other). For long, the
        first segment is always longer than the second. For short, the first segment is shorter. You can
        toggle between the two configurations with the F key.



P-CAD PCB User’s Guide                                                                                        17
Chapter 3: PCB Basics                                                                        Placing Objects




       45/90 Line-Line
       The first mode makes the first segment displayed at a 45-degree angle and the second segment is
       either horizontal or vertical. The second mode makes the first segment either horizontal or vertical
       and the second segment displays at a 45-degree angle. You can toggle between the two modes with
       the F key.




       While performing manual routing with Route Manual, there are three orthogonal mode pairs (six
       modes) to choose from, including arcs.

     Unwinding Segments
       You can unwind (undo) a segment with the BACKSPACE key for lines, polygons, copper pours,
       cutouts, keepouts, and copper that you place.
       When you place a multiple segment object, you can press the BACKSPACE key to delete the
       previous segment. If you have finished placing the object (clicked the right button), then the
       unwind function does not work. You can undo the placement of a finished object (Edit » Undo), but
       you cannot unwind it.

     Moving Objects to Another Layer
       The Edit » Move to Layer command allows you to select a number of objects, and move the objects
       to the current layer. This facility enhances the ability to clear out congested areas for routing.
       Additionally, if you have accidentally placed objects on the wrong layer, you can move them easily
       to the correct layer.

       You can change the current layer after the items have been selected using any of the layer changing
       methods described in the Using Layers section.

     Changing an Arc Centerpoint
       While placing an arc, you can alter the centerpoint before the final placement. After you click, drag,
       and release, the arc start and end points are defined. A second click defines the center point and,
       therefore, the radius. If you click and drag, you can alter the centerpoint of the arc before you
       release.
       Selecting the F key allows you to toggle between the arc’s beginning and end points.




18                                                                                 P-CAD PCB User’s Guide
Selecting Objects                                                                       Chapter 3: PCB Basics


    Using a Snappy Cursor
        Use the View » Snap to Grid command to enable a snappy cursor, meaning that the cursor can only
        move from grid point to grid point, as opposed to a free floating cursor. The benefits of a snappy
        cursor are mainly a question of personal preference (e.g., you may be accustomed to a snappy
        cursor from other program applications). Also, a snappy cursor can create a predictable point of
        reference and placement when moving and rotating objects or measuring distances.

        Items are still placed on grid regardless of the cursor setting.

        The current setting for Snap to Grid (whether it is enabled or disabled) is saved to your PCB.ini
        file when you exit the program.


Selecting Objects
              The Select tool lets you select objects, which you have placed in your design. When the Select
        tool is active, data tips appear when the mouse is over an object in the workspace.
        The Select tool can be accessed by:
        •   choosing the Select command from the Edit menu.
        •   activating the Select tool from the Placement toolbar.
        •   pressing the S key.
        The Select tool is layer-specific by default. If an item is on a specific layer, then that layer must be
        current to allow selection. Component selection is an exception, since components are not specific
        to a single layer.

        Items are still placed on grid regardless of the cursor setting.

        When you select an object, the object appears in the selection color set by the Options » Display
        command.

    Status Line Information
        The Status Line information area identifies the item, either specifically (component RefDes or net
        name) or generally (number of items selected). When possible, the layer name is also displayed.




    Single Select
        Once the Select tool is enabled, you can click a single object to select it; the object appears in the
        Selection color. Any other selected objects are deselected.
        Single selection can also used in conjunction with a Selection Mask, see Using the Selection Masks
        (page 21) for more details.



P-CAD PCB User’s Guide                                                                                           19
Chapter 3: PCB Basics                                                                        Selecting Objects


        Toggling through Objects
        If there are overlapping objects, you can enable the Select tool and toggle through them using
        either the SPACEBAR or the left mouse button to click repeatedly in the same location. Two strokes
        of the SPACEBAR equal one click and release.

     Multiple Select
        You can add or remove selected items by holding down the CTRL key and clicking individual items.
        When you select multiple objects, the number of objects selected is displayed on the Status Line.
        If you release the CTRL key and click anywhere other than one of the selected objects, all items are
        deselected.

        In the Mouse tab of the Options Preferences dialog you can set the SHIFT key as the key to use for
        multiple selections.

        Multiple Selection with Collocated Objects
        The behavior of the multiple select feature with collocated objects depends on the setting of the
        Single Select Mode option in the Single Selection tab of the Options Selection Mask dialog.
        If the Single Select Mode is set to Cycle-Picking, then as you hold the CTRL key and left-click each
        collocated object is selected in turn.
        If the Single Select Mode is set to Popup Dialog, then whenever you click on collocated objects the
        following selection dialog is displayed.




        The dialog will include a list of all collocated objects, with a check box next to each. Click to enable
        the checkbox of each object that you wish to select, then when you are ready, click the button at
        the top left of the dialog with the exclamation character (!) to carry out the selection. Click the X
        button to cancel the selection action.

     Sub Select
        The sub select feature lets you select a single part of an object. Once selected, you can view and, in
        some cases, modify properties for the item selected.
        For example, you can select a component pad and bring up a Properties dialog for that pad. Then
        you can change the pad style for the selected pad.

        In the Mouse tab of the Options Preferences dialog you can set the CTRL key as the key to use for a
        sub selection.



20                                                                                   P-CAD PCB User’s Guide
Selecting Objects                                                                     Chapter 3: PCB Basics


        Example
        To select pad 8 in a 7400 component:




                                   Î

        Hold down the SHIFT key and left mouse button, and click the pad. The pad, and not the entire
        component, will be selected.

    Block Select
        Where single selection is performed by clicking directly on an object to select it, Block Selection
        allows you to select multiple objects (a block of objects) in a single action.
        To block select a group of objects, click and hold the left mouse button in an unoccupied area of
        the workspace, then drag the mouse. As you drag the mouse a dotted box is displayed, indicating
        the area that the block selection is to apply to. The standard behavior can then be modified by
        setting up the Selection Mask, where you can restrict the objects that are selected, the layers that
        selection is permitted on, or change the behavior of the selected area.

    Using the Selection Masks
        Choose Options » Selection Mask from the menus to display the Options Selection Mask dialog,
        where you define both the Block Selection mask, and the Single Selection mask.




P-CAD PCB User’s Guide                                                                                         21
Chapter 3: PCB Basics                                                                      Selecting Objects


       Block Selection Tab




       Items
       Notice that there are both item check boxes and item buttons (the buttons are a sub-function of
       the item boxes). The check boxes, when enabled, instruct the selection mask to include all items of
       that type (e.g., all lines of any width) on the specified layers.
       Notice in the figure of the Options Selection Mask dialog (above) that the grayed items each have
       an item button that is available. Each button displays its respective selection mask dialog for further
       selection criteria.
       If you want to be more specific in the selection of components (for example, selecting only one
       type), you need to click the Component check box until it turns gray. This makes the component
       button available. You can then click on the Component button to display the Options Selection
       Mask dialog in which you can specify the component type, value, etc.




22                                                                                  P-CAD PCB User’s Guide
Selecting Objects                                                                      Chapter 3: PCB Basics


        Layers
        The layers that are set (highlighted) are included in the selection criteria along with the enabled
        items. Thus, the selection mask can include both layers and item combinations.

        Layer Sets
        Use the Layer Sets list box and Layer Sets button to quickly limit the selection to a predefined layer
        set. Do this by:
        1.   Select a layer set from the Layer Set drop down list box and
        2.   Click the Apply Layer Set button.
        The layers belonging to that set are highlighted in the Layers box and are used as part of the
        selection criteria.
        Refer to Layers (page 425) for information on creating layer sets.

        Select Mode Area
        Selection is done by clicking in the workspace and dragging the mouse to form a selection
        rectangle. If you want the selection to take place within the rectangle, click the Inside Block radio
        button in the Select Mode area of the dialog. If you want the selection to take place outside of the
        rectangle, then click the Outside Block radio button. Touching Block will select all items inside and
        touching the selection block. This is a more inclusive selection option than Inside Block. After you
        have set the criteria for block selection, you will use the block select function to perform the actual
        selection. Use the Edit » Select command to click and drag a selecting rectangle.

        Performing a Block Select
        To do a block select, once you have set your selection filters, click and drag to create a selection
        box around a block of objects. Any objects meeting your selection criteria (items, layers, select
        mode area) appear in the selection color.

        Single Selection Tab
        This tab of the Options Selection Mask dialog is used to control the behavior when performing a
        single selection. The Single Selection tab includes the same options for Items and Layers, refer to
        the previous topic for information on these. Single Selection also includes the following features.

        Current Layer Only
        When this option is enabled you can only perform a single selection on the current layer.

        Single Selection Mode
        Cycle-Picking – in this mode collocated objects are 'cycled through' by repeated left-clicking of the
        mouse (or pressing the SPACEBAR twice).
        Popup Dialog – when this option is enabled a pop-up dialog box appears whenever you click to
        select at a location where there are collocated objects. The dialog lists all objects that are
        overlapping, AND are selected in the Items list, AND are in a selected layer in the Layers frame. The
        dialog displays information on the type of object (e.g. Line), the layer on which the object is placed




P-CAD PCB User’s Guide                                                                                         23
Chapter 3: PCB Basics                                                                             Editing Objects


        (e.g. Top), any associated Net (e.g. VCC) and any other useful information about the object (e.g.
        WIDTH=20mil). Click on an object in the dialog to select that object.




        The small pop-up dialog can be resized by clicking and dragging on an edge or corner.

     Edit Deselect All
        You can click on an empty area outside of the selection region or use the Edit » Deselect All
        command to deselect all items. The Select tool is enabled, but no objects are selected.

     Edit Select All
        You can select all objects in the active window by using the Edit » Select All command.

     Selecting a Net
        There are two ways you can select all items in the net to which an item is connected.
        The first way is to use the Edit Nets dialog. Select a net from the list in the dialog and click the
        Select button.
        The second way is to select the item, click the right mouse button, and choose Select Net from the
        popup menu.
        In both cases, the complete net is highlighted as selected, subject to any criteria set in Options »
        Selection Mask.

     Select Highlighted
        Highlighed objects can be selected by choosing Edit » Select Highlighted from the menus.


Editing Objects
        Once objects have been selected, you can perform editing functions discussed in this section.

        These functions do not work on fixed components.

        P-CAD PCB (6/400) designs are restricted to a maximum of 400 components. Therefore, when using
        P- CAD PCB (6/400), do not exceed this number when pasting components into your design or
        duplicating components using Copy Matrix.




24                                                                                     P-CAD PCB User’s Guide
Editing Objects                                                                        Chapter 3: PCB Basics


    Selection Reference Point
        A selection reference point is used and automatically appears with all select operations such as
        moving, copying, rotating, flipping and pasting. To specify a location different than the default,
        select the object(s), click the right mouse button to access the pop up menu containing the
        Selection Point option, and select the position of the reference point with respect to the selected
        item. If you don’t specify a different location for the selection reference point, PCB uses a default
        reference point.
        Clipboard cut/copy/paste operations support the user-defined reference point. The default
        selection point appears in the center during block operations.

        Moving Objects
        If the selection reference point is off-grid when a move operation begins, then it is automatically
        snapped to the nearest grid point and all the selected objects move the same relative distance.

        Flipping and Rotating Objects
        Components are flipped and rotated about the reference point. Additionally, components can be
        aligned around a selection reference point either horizontally or vertically.

        Aligning Components
        Components can be aligned vertically or horizontally, around a selection reference point. Place a
        selection reference point at the point of alignment. Then choose Edit » Align Components and set
        the desired alignment options.

        Copying and Pasting Objects
        The selection reference point is saved to the clipboard or to a block file and automatically restored
        when pasting objects into your design. When pasting, an object’s reference point snaps to grid.

    Moving Objects
        To move an object, select it, then click on the object and drag the cursor to the new location.
        Release to place the object. You can also move an object by selecting it and using the arrow keys to
        reposition the object in the workspace.
        When you move an object connected to other objects, the connections remain in place after the
        move.
        If you are moving multiple objects within a selection box, click anywhere in the selection box and
        drag. All the selected objects in the box follow. Release the button to place the objects.
        When selecting and moving several components into position, the connections rubberband to
        maintain the established nets.

    Rotating and Flipping Objects
        You can rotate and flip many objects once they have been placed in your design. First select the
        object. Then press the R key to rotate the object 90 degrees counterclockwise; press SHIFT+R to
        rotate it by an amount specified in Options Configure. Press F to flip the object.



P-CAD PCB User’s Guide                                                                                          25
Chapter 3: PCB Basics                                                                        Editing Objects


        You can find details on which objects can be rotated or flipped by looking at the specific place
        command in the command reference chapter of this manual.

     Resizing an Object
        You can resize an object by clicking one of its handles and dragging to stretch the object. Handles
        are the squares displayed when certain objects are selected singly. They appear only if you select
        one object, and if the object can be resized.
        The resize function varies among the different objects (some objects cannot be resized with this
        function, e.g., pads and vias).
        For example, to resize an arc you click one of the endpoint resize handles and drag the endpoint to
        increase the sweep angle. To resize a polygon, you can grab one of its vertex handles and move it
        to change the polygon.




        When you move a polygon handle that is on an edge between two vertices, a new vertex is created
        (allowing you even more reshaping). You can delete a vertex by moving it to an adjacent vertex and
        releasing.
        Lines, Arcs, Polygons, Copper Pours, Keepouts, Planes, Rooms and Cutouts can be resized.

        Rounding Corners of Polygonal Shapes
        The corners of polygonal shapes (polygons, copper pours, polygon keepouts, cutouts and planes)
        can be rounded. The rounded corner forms a filleted edge, which is the rounded intersection of
        two edges. This intersection of the two edges is created with an arc of a specified radius that is
        tangential to both edges.
        A new radius can be added by entering it directly into the Radius combo box on the Status Line or
        by choosing the Options » Current Radius command and entering the new values in the Current
        Radius dialog. You can choose the desired radius from those in the Radius combo box drop down
        list on the Status Line. The radius displayed in the combo box is the current setting.
        When a polygonal shape has filleted corners, additional handles appear in the shape as shown
        below:




        To change the radius of a filleted corner, grab the interior handle and drag it until you see the
        desired radius for the corner. The radius displayed in the Radius combo box on the Status Line only
        affects the polygonal shape at the time of placement or during modification. You can also access
        radius settings by double clicking the polygonal shape to display the Properties dialog where you
        can make modifications to the definition or filleted points.


26                                                                                 P-CAD PCB User’s Guide
Editing Objects                                                                           Chapter 3: PCB Basics


    Cutting, Copying, and Pasting Objects
        Once an object or objects have been selected, the selection can be cut or copied to the Windows
        clipboard, and clipboard objects can be pasted back into the design or stored in the file where you
        can paste the selection in at a later time.

        Cutting Objects (Ctrl+X)
        You can cut objects from a design and paste them into a new location, into a new design, or even
        into another application using the cut and paste functions. To cut an object, select it and choose
        the Edit » Cut command or press Ctrl+X.
        The object is moved to the Windows clipboard, from where you can paste it.

        When you choose Edit » Cut to remove objects from nets, you can get a variety of results,
        depending on what you cut and the makeup of the net you remove it from. The function of smart
        nets is to maintain certain connections when objects such as copper connections, unrouted
        connections, and net nodes are removed.

    Copying Objects (Ctrl+C)
        You can copy objects from a design and store them in the Windows clipboard. To copy an object,
        select it and choose the Edit » Copy command or press Ctrl+C.

    Drag-and-Drop (Ctrl+Left Click)
        For copying within the same design, you can also use the shortcut copy drag-and-drop. This works
        just like moving objects with drag-and-drop, except you are copying the object instead of moving
        it. You first enable Edit » Select mode, click on the object to select it, then Ctrl+left click and drag to
        where you want to place the copied object.

    Copying to a File
        The Edit » Copy to File command provides a shortcut for copying objects and net information to a
        file.
        When you select the Edit » Copy to File command a dialog appears where you can pick a filename
        and save the data you are copying. Later, you can use the Paste from File or Edit » Paste Circuit
        From File commands to paste the information into a different design or the same design.

        Pasting Objects (Ctrl+V)
        To paste object(s) from the Windows clipboard, choose the Edit » Paste From Clipboard command
        or press Ctrl+V. Objects saved to a block file can be pasted using the Edit » Paste From File
        command.
        Objects and net information copied to the clipboard or a block file can be pasted using the Paste
        Circuit and Paste Circuit From File commands, respectively. These two paste commands provide
        the ability to control how the copied components and nets are incrementally named when pasted
        and the option to choose which net attributes are retained.




P-CAD PCB User’s Guide                                                                                           27
Chapter 3: PCB Basics                                                                               Properties


     Pasting From a File
        The Edit » Paste from File command provides a shortcut for pasting objects and net information
        from a file to the design.

     Pasting a Circuit From a File
        The Edit » Paste Circuit from File command provides a shortcut for pasting objects and net
        information into a design. When using the Paste Circuit from File command, you retain the ability
        to control how the pasted objects are named and which net attributes are retained.

     Pasting Limitations
        You must have enough space in the target workspace location for the items you are pasting. If the
        space isn't sufficient or you are too close to the edge, the data cannot be pasted.
        When cutting or copying objects between designs, the pasted objects automatically appear on the
        same layer that they were cut or copied from, if they are layer specific, regardless of the current
        layer. If the target layer does not exist in the target design, the items are not pasted.
        Use the Edit » Paste to Layer command to paste all items in the clipboard to a specific layer.

     Using the Copy Matrix Command
        The Edit » Copy Matrix command allows you to create a matrix of objects. You can use this
        command to duplicate one or more selected objects in both the horizontal and vertical directions.
        For example, you could use this command to select a pad and create two columns of eight pads, or
        you can select an existing column and create any number of additional columns.
        The settings selected in the Copy Matrix dialog are retained throughout your PCB session.

     Using the Edit Properties Command
        The Edit » Properties command allows you to select an object and change many of its settings (i.e.,
        properties). For example, when you select an arc and choose the Edit » Properties command, you
        can change the arc’s start and end angles. See the next section, Properties, for additional details.


Properties
        You can display and change an object’s properties any of the following ways:
        •   Choose the Edit » Properties command (See the Edit Properties command section).
        •   Click the right mouse button and select Properties from the pop-up menu that appears.
        •   Left double-click the selected object.
        The Properties dialog that appears depends on the object you selected. For example, if you select a
        pad and choose Edit » Properties, the Properties dialog that appears would show pad properties.




28                                                                                  P-CAD PCB User’s Guide
Right Mouse Commands                                                                 Chapter 3: PCB Basics


   Properties of Multiple Objects
       When displaying the properties of multiple objects, the result depends on whether the objects are
       of the same type.

       Objects of the Same Type
       If the objects are the same type, but have different styles or other characteristics, then the
       Properties dialog appears, but specific information about the objects will be blank or grayed where
       the information differs between objects.
       You can enter information in the dialog and click OK, and then all of the selected objects uniformly
       take on the characteristics (e.g., dimensions) of what you specified in the dialog. You can use the
       block selection mask to restrict selection; refer to the Options » Selection Mask command.
       Although you cannot display the properties of objects of different types, you can perform other
       edit commands


Right Mouse Commands
       When you select an object and click the right mouse button, a pop-up menu appears providing
       shortcuts to common commands performed on selected objects. This menu changes depending on
       the object you select.
       The following section summarizes the commands, which appear on the pop-up menu:


        Add To Net              This command allows you to add a pad or via to a net. The pad or via
                                must not currently be assigned to a net. Use the complementary
                                Remove From Net to remove a pad or via from a net.
        Add Vertex              This command inserts a vertex in the selected line or trace.
        Align                   A shortcut for Edit » Align Components. Components can be aligned
                                around a selection reference point either horizontally or vertically,
                                and as an option, equally spacing the parts.
        Alter                   A shortcut for Edit » Alter Components, which allows you to select
                                certain component items and subsequently move, rotate, flip, and (in
                                some cases) delete them.
        Copy Matrix             A shortcut to Edit » Copy Matrix. Duplicates selected objects based
                                on parameters you choose.
        Copy                    A shortcut to Edit » Copy. Allows you to copy the object to the
                                clipboard.
        Cut                     A shortcut to Edit » Cut. Allows you to cut the object to the
                                clipboard.
        Delete                  A shortcut to Edit » Delete. This command deletes selected objects.
        Edit Nets               A shortcut to Edit » Nets. This command brings up the Edit Nets



P-CAD PCB User’s Guide                                                                                   29
Chapter 3: PCB Basics                                                              Right Mouse Commands


                               dialog with the nets containing the selected objects pre-highlighted
                               in the net list box.
        Explode                A shortcut to Edit » Explode Component. This command allows you
                               to convert a pattern back to its basic primitives, creating a collection
                               of editable graphic objects.
        Fix                    A shortcut for Edit » Fix » Fix. This command sets the selected object
                               to be fixed in the workspace.
        Highlight              A shortcut to Edit » Highlight. This command highlights the selected
                               objects in the current highlight color.
        Highlight Attached     This command highlights nets attached to the selected objects in the
        Nets                   current highlight color.
                               This also highlights the corresponding items (for nets and
                               components) in Schematic if the DDE Hotlinks check box in the
                               Options Configure dialog is checked.
        Highlight Included     This command highlights the components in the selected room’s
        List                   Included Component List.
        Net Info               This command brings up a dialog providing information about the
                               selected net.
        Properties             A shortcut to Edit » Properties. Depending on the object(s) selected,
                               the appropriate Edit Properties dialog appears.
        Remove From Net        This command allows you to remove a pad or via from its net.
        Select Net             This command highlights all items in the net to which the selected
                               item is connected.
        Selection Point        This command allows you to relocate a selection reference point for
                               the selected object or objects.
        Unfix                  A shortcut for Edit » Fix » Unfix. This command unfixes the selected
                               object, allowing it to be moved in the workspace.
        Unhighlight            A shortcut to Edit » Unhighlight. This command removes the
                               highlighting from selected objects.
        Unhighlight Attached   This command removes the highlighting from nets attached to the
        Nets                   selected objects.
        Unhighlight Included   This command removes the highlighting from a room’s Included
        List                   Component List.




30                                                                                P-CAD PCB User’s Guide
Loading and Saving Files                                                              Chapter 3: PCB Basics




Loading and Saving Files
       In addition to P-CAD PCB binary files, PCB can also load and save the following file formats:
       •   ASCII
       •   P-CAD Shape-Based Router format
       •   DXF mechanical CAD format
       •   IDF V3 format
       •   PDIF files
       •   RFQ WebQuote format (Save only)
       Use the File » Open, File » Save, and File » Save As commands to load and save ASCII. All other
       formats are accessed via the File » Import, and File » Export sub-menus. For additional information,
       refer to the appropriate commands in the reference section of this manual.

   Drag and Drop File Load
       You can use the drag and drop method for loading files into PCB.
       You can use the drag and drop method for opening PCB design files (.pcb), loading netlist files
       (.net and .alt), and opening library files (.lib) from the File Manager or other Windows file
       maintenance utilities. Just click the filename in the utility, drag it to the PCB window or reduced
       icon, and release. The specified file opens.




P-CAD PCB User’s Guide                                                                                       31
                                                                                     CHAPTER              4


                              Tutorial - PCB Design Session

Introduction
       Welcome to the P-CAD PCB tutorial. During this tutorial, we will be exploring the design process
       from setting up the workspace and placing objects through to Gerber file output. This tutorial uses
       some demonstration files that are supplied with P-CAD.


Setting up the workspace
       Before you begin placing components on your board and setting up the design rules, for example,
       you should specify the physical properties of the board you are designing.
       Using the commands in the Options menu, you can set PCB's options to fit your design needs, such
       as configuration options, layers, display colors and grids. Your settings are saved with your current
       design and become the new defaults for subsequent design sessions.

   Setting workspace configuration and display options
       The Options menu commands are used to set up the environment of your workspace. These
       settings are stored with the current PCB file and become the new defaults for subsequent design
       sessions.

       Setting the workspace size
       The workspace is the logical design area in a design. You can alter your workspace size with the
       Options Configure command.
       1.   Choose Options » Configure and click the General tab of the Options Configure dialog.




P-CAD PCB User’s Guide                                                                                    33
Chapter 4: Tutorial - PCB Design Session                                          Setting up the workspace




        2.   Select the mils button in the Units frame. Make sure your workspace size is set to 11000 by 8500
             mils, to match an 11" x 8.5" sheet of paper (landscape orientation). You may wish to increase
             the workspace later to allow more space around the sheet during object placement.




        3.   While we are in this option, click the Route tab and select all check boxes in the Orthogonal
             Modes frame to allow all modes to be available when placing lines and arcs. Click OK to
             continue.



34                                                                                 P-CAD PCB User’s Guide
Setting up the workspace                                              Chapter 4: Tutorial - PCB Design Session


       For details on the other options in the Options Configure dialog, refer to the Options Commands
       chapter.

   Setting up layers
       Next, we will set up a new layer for a title block. You can use this method to set up the number of
       layers you require in a design. When you add (create) a layer, you must specify a layer type and a
       unique name and layer number. The layer definitions you establish here are saved as part of the
       design file.
       1.   Choose Options » Layers. The Options Layers dialog appears.




       2.   Choose a layer Type of Non-Signal, as the title block should reside on a non-signal layer.
       3.   Type a new layer name in the Layer Name text box, e.g. Title.
       4.   Specify a Layer Number (up to 988) or allow the program to choose the next available layer
            number when you click Add.
       5.   Click Add. The new layer, Title, is enabled (available for use) by default. It is listed in the Layer
            list with the layer code NE (N=Non-Signal, E=Enabled), the layer number to the right and the
            Line color set by default. We will look into changing layer display colors later in this section of
            the tutorial.
       6.   Select Title from the Current Layer list. This layer becomes the current layer on which you can
            place the objects that make up a title block and sheet border.
       7.   Click Close to exit the dialog and retain the settings.

       The easiest way to change the current layer is to use the layer controls on the status line. You can
       also switch between layers by pressing L (cycle downward) or SHIFT+L (cycle upward).



P-CAD PCB User’s Guide                                                                                          35
Chapter 4: Tutorial - PCB Design Session                                             Setting up the workspace


     Title blocks
        First we will set up a title block and border, as illustrated below, using the Titles tab of the Options
        Layers dialog. The title block, which comes from a supplied .tbk file, and the border are not
        selectable and can only be changed or removed through the Titles tab.
        When you change layers to start object placement and use a zoom command, the Title layer no
        longer displays. You can check that placed objects are within the border by making Title the
        current layer and choosing View » Redraw to see the border and title block again.




        1.   Choose Options » Layers again and click on the Titles tab.
        2.   Select Display Border. Notice that the border dimensions have automatically adjusted to allow
             500mil (.5 inch) between the edge of your workspace and the edge of the border.
        3.   Set up the zones that display in the border as reference marks. Type 4 in both # of Zones boxes
             to create four zones in both horizontal and vertical directions and select Annotate Zone
             Information.




36                                                                                    P-CAD PCB User’s Guide
Setting up the workspace                                           Chapter 4: Tutorial - PCB Design Session




       4.   Now we can select a title block that has been supplied with P-CAD with lines and text fields
            already inserted. Click on Select to choose a filename of an existing title block. Choose
            ADT_AB.tbk from the Titles folder in the P-CAD installation directory and click Open.
       5.   Within the title block we chose in the step above, there are design information fields that
            display the values you enter in their appropriate place. Click Fields to display the Fields tab of
            the Design Info dialog.




P-CAD PCB User’s Guide                                                                                           37
Chapter 4: Tutorial - PCB Design Session                                              Setting up the workspace


        6.   Select a field name you wish to include in the title block, e.g. Title, click on Properties and
             enter the value in the Field Properties dialog, e.g. Tutorial exercise, and click OK.
        7.   Repeat the step above for all required fields, e.g. Drawing Number, Revision, Date and Drawn
             By, and click on Close to complete and return to the Options Layers Titles tab.
        8.   Click Modify to apply the changes and then Close. The title block will display in the workspace
             with the design information entered.
        9.   You can change the design information at any time by changing the field properties using the
             procedure above or choosing File » Design Info. Refresh the screen to see the changes by
             choosing View » Redraw.

        You may wish to create your own title blocks (filename.tbk) by placing lines, fields, graphics and
        text. For more information about title blocks, refer to Options Commands.

        Next we will set up the other workspace options that will be saved with this file.

     Display Options
        Display options allow you to define the color and display preferences for your workspace. You can
        use the same color on all layers for an item, the same color for all items on a layer, or distinct colors
        for items per layer. To set your color preferences:
        1.   Choose Options » Display. The Options Display dialog displays. Click on the Colors tab.




        2.   There are three ways to set color options:
             •   To select a color for everything that appears on a layer, click the corresponding layer
                 button and select a color from the palette that appears. For example, click the Top button
                 to select a color for everything that appears on the Top layer of your design.




38                                                                                    P-CAD PCB User’s Guide
Setting up the workspace                                           Chapter 4: Tutorial - PCB Design Session


            •   To choose a color for every instance of an object, click an item button. For example, click
                Via to choose a color for vias. This color is applied to vias on all layers of your design.
            •   To choose a color for an object on a specific layer, right-click the colored square where the
                object and layer meet in the color matrix. Then, choose a color from the pop up color
                palette.
       3.   When you’ve finished setting up color options, click OK to close the dialog.
       To learn about setting up colors, or the Miscellaneous tab options, see the Options Commands
       chapter.

   Setting the line width
       The width of lines placed on the board is determined by the current line width. We will set up a
       current line width here that will allow you to get started with placing lines in the next section of the
       tutorial.
       1.   Choose Options » Current Line. The Options Current Line dialog displays.




       2.   Set the line width to 8 mils by typing 8 in the Line Width box and click Add. The line width is
            added to the list for future easy access from the status line.
       3.   Alternatively, type a line width in the Line Width list on the status line and press Enter.

   Setting grids
       A 100mil grid works well for placing through-hole components. This gives you maximum flexibility
       when selecting a grid for routing. Later in this tutorial we will look at non-uniform relative grids,
       which are useful when routing multiple tracks between pads and autorouting. Default colors for
       grids are set as green (10X grid) and white (1X grid) and can be changed by choosing the Options »
       Display.
       To set the current absolute grid:
       1.   Choose Options » Grids and select a grid spacing of 100mil from the options available.
       2.   If you wish to create a new grid spacing, simply type in the new spacing in the Grid Spacing
            box and click Add. The new setting appears in the list and becomes the current grid setting.




P-CAD PCB User’s Guide                                                                                        39
Chapter 4: Tutorial - PCB Design Session                                                      Object placement




        3.   Make sure the grid is Visible and the mode is Absolute. This sets the grid origin point to be the
             lower-left corner of the workspace, i.e. X and Y are both zero. Click OK.
        4.   Alternatively, set a grid by using the grid controls on the status line, i.e. click on the Abs
             (Absolute) button to toggle to Rel (Relative) and back. Choose a grid spacing from the list to
             the right of the Abs button, or type a grid spacing in the Grid Select list on the status line and
             press Enter.
        5.   If the grid is not immediately visible on the screen, use + (plus) key on the keypad to zoom in
             on your design. Press the - (minus) key to zoom out.
        6.   Save this file by choosing File » Save. Type in the filename Titleblock.pcb, choose the
             directory you want to save it in and click on Save. Do not close the file as we will use it during
             this tutorial as we practice object placement, selection and modification methods.


Object placement
        This section of the PCB tutorial shows you how to place simple objects, such as lines, arcs, pads,
        vias, text and fields. In the following sections, we will try selecting, moving and modifying the
        objects you have placed. Remember that you remain in the placement mode you have chosen until
        you select another mode.

     Placing lines
        Lines are graphical objects used for creating title blocks, board and component outlines. Lines and
        arcs are non-electrical entities, but they do create copper and will affect design rule checking if you
        place them on signal layers. You can create a single line or multi-segment lines using the Place »
        Line command.

        Placing a single line
        1.   Make sure your new PCB file, Titleblock.pcb, is open.
        2.   Set the line width you wish to use by choosing Options » Current Line, or select or enter a line
             width in the Line Width list on the status line.




40                                                                                    P-CAD PCB User’s Guide
Object placement                                                    Chapter 4: Tutorial - PCB Design Session


       3.   Select the layer on which to place lines, either by the status line layer feature, or by choosing
            Options » Layers. You can switch between layers by pressing L or SHIFT+L. Choose the Top
            layer using one of these methods.

       4.   Choose Place » Line or click the      toolbar button.
            While you draw a line or segments, the cursor is displayed as a crosshair. When you finish the
            line segments, the cursor returns to its normal shape.
       5.   Press and hold down the left mouse button where you want to start the line. Drag the mouse to
            draw the line and release the left button where you want the line to end. Lines will snap to the
            nearest gridpoint to the cursor. Pressing the BACKSPACE (unwind) key at this stage will return
            the cursor to the start point.
       6.   To permanently place the line, right-click or press ESC. The line will change to the color of the
            layer it is placed on. Then you can begin another line at a new location. You will remain in Line
            Placement mode until you select another mode.

       Placing multi-segment lines
       This time we will place multi-segment lines and use the orthogonal modes we set by choosing
       Options » Configure and clicking the Route tab in the setup section of this tutorial. We will also
       change layers while placing lines.
       To place a multi-segment line, follow these steps:
       1.   Press and hold down the mouse button where you want to start the line. Drag the mouse to
            draw the line and release where you want the line to end. Repeat this action and draw two or
            three more line segments.
       2.   Watch the status line as you draw line segments. The dX and dY measurements are given while
            you drag a segment, and the total line length is given when you complete each segment.
       3.   Orthogonal modes use lines that are horizontal, vertical, and at 45-degree angles. The available
            orthogonal modes are provided as mode pairs. Press the O key to cycle through the mode
            pairs and the F key to switch (flip) between the current mode pair while you are placing line
            segments.
       4.   Between some segments, press the L key (or SHIFT+L) to switch between layers. Lines drawn
            in different layers will display in its layer color when the line is permanently placed.
       5.   Use the BACKSPACE (unwind) key to delete the last segment drawn.
       6.   Right-click or press ESC to finish the series of segments. Choose Edit » Undo or click the Undo
            toolbar button      to delete the whole series of segments.

   Placing arcs
       Arcs can be partial or full circles and are graphical objects only. The line width of an arc is set in the
       same way as for placing lines. You remain in arc placement mode until another mode is selected.




P-CAD PCB User’s Guide                                                                                          41
Chapter 4: Tutorial - PCB Design Session                                                        Object placement


        Creating an arc
        1.   Choose Place » Arc or click the      toolbar button. The cursor changes to a crosshair while you
             are drawing an arc.
        2.   Move the cursor to a grid point in your workspace. Use the X and Y grid readout in the status
             line to aid in accurate construction.
        3.   Click and drag up and right at a 45-degree angle to another grid point, then release. The click
             (down) and release (up) define the start and end point of the arc and so create the diameter of
             the arc.
        4.   The unfinished arc should look like a (in the figure shown). Click
             and drag the centerpoint up and left to form a 90-degree corner like
             b. Release and you will have created a 90-degree arc, like c.
        5.   An arc can be flipped over while you are placing it by pressing the F key before you complete it.

        Creating a circle
        If the start and end point of the arc are in the same place, the arc defines a circle. In this case, the
        second click and drag moves the center point of the circle away from the defined point on the
        circumference.
        1.   To create a circle, move the cursor to a grid point in your workspace and click. This will define
             a point on the circumference of the circle.
        2.   Click where you wish the center of the circle to be placed and a circle will appear.

     Placing pads
        Pads and vias are placed with a pad/via style (also known as a stack) attached. We will explore pad
        and via styles in more depth in the section Using Pad and Via Stacks later in this tutorial.
        To place pads, follow these steps:
        1.   Choose Options » Pad Style. When the Options Pad Style dialog appears, examine the current
             pad style. There is at least one default style.
        2.   Double-click a pad style in the Current Style list. An asterisk (*) marks the current pad style.
             Then, click Close.

        3.   Choose Place » Pad or click the       toolbar button.
        4.   Click where you want to place the pad in the workspace. P-CAD places the pad near the cursor
             location and the pad center snaps to the nearest grid point. If you can't see the pad, press the +
             key to zoom in. Pads display in the color set using Options » Display.
        5.   To place another pad, press and hold down the mouse button, move the ghosted image of the
             pad to the position you want, and release the mouse button.
        6.   Place a few more pads, moving them into different positions. You will use these objects later
             when you practice deleting and modifying objects.




42                                                                                     P-CAD PCB User’s Guide
Object placement                                                    Chapter 4: Tutorial - PCB Design Session


   Placing vias
       Vias do not belong to a particular layer. The via you place has all of the properties associated with
       the current via style. To place a buried via, for example, the current style must be set up to have a
       shape defined only on a buried layer. Vias are almost identical to pads in the way that they are
       placed, rotated, flipped, and edited.
       1.   Choose Options » Pad Style. When the Options Via Style dialog appears, examine the current
            via style.
       2.   Double-click a pad style in the Current Style list. An asterisk (*) marks the current via style.
            Then, click Close.

       3.   Choose Place » Via or click the      toolbar button to place a via in your design.
       4.   To place another via, press and hold down the mouse button, move the ghosted image of the
            via to the position you want, and release the mouse button.

       For more information about pad and via styles, see Using Pad and Via Stacks later in this tutorial.

   Placing text
       The Place Text command allows you to place text on your design.

       1.   Choose Place » Text command or click the         toolbar button and click where you wish to
            place the text string. The Place Text dialog appears at the bottom of the screen. You may need
            to move the dialog up slightly to access the text style options.
       2.   Type in the text you require in the dialog. Click More» to change the font, rotation or text
            justification.




       3.   Click Place and the text displays in the color of the layer it has been placed on.
       For information about text styles used with placing text and fields, refer to Options Text Styles in
       the Options Commands chapter.




P-CAD PCB User’s Guide                                                                                         43
Chapter 4: Tutorial - PCB Design Session                                                Placing components


     Placing fields
        This command places a field containing design information such as date, time, author, etc. The
        value of a field placed in the design, with the exception of Current Date/Time, Filename and
        Modified Date, must be specified in the Field Properties dialog, otherwise you place a generic field,
        e.g. {Author} rather than the author’s name. Current date and current time are taken from the
        computer's clock.

        1.   Choose the Place » Field command or click the      toolbar button.
        2.   The Field Properties dialog is accessed from the File » Design Info command (Fields tab) by
             selecting a field name and clicking on Properties.
        3.   By selecting a placed field and choosing Properties from the shortcut menu, you can change
             the font and justification properties, or add new text styles.




Placing components
        Before you can place components, you need to add one or more libraries that contain the
        components. The components can come from libraries that are provided with the P-CAD program
        or they can be ones that you create. Components can then be placed, flipped and rotated.

     Setting up libraries
        Every time you place a component, the program searches the library you specify in the Place
        Component dialog. You can open additional libraries, as long as the maximum number of open
        libraries (100) is not exceeded.
        1.   Choose Library » Setup to open the following dialog.




44                                                                                 P-CAD PCB User’s Guide
Placing components                                                  Chapter 4: Tutorial - PCB Design Session




       2.   To open a library, click Add. The Library File Listing dialog appears.
       3.   In the dialog, navigate to the directory containing the library that you want to open, i.e.
            Demo.lib in the Demo folder of the P-CAD installation directory.
       4.   Select the library file. Then, click Open to add the library to Open Libraries list.
       5.   Click OK. The libraries that you have specified are now open and therefore accessible for
            component placement.

   Adding components
       Once the appropriate libraries are open, it is time to place some components. We will place several
       different types of components that we will use later in this tutorial.

       1.   Choose Place » Component or click the          toolbar button and click in the workspace. The
            Place Component dialog appears.




P-CAD PCB User’s Guide                                                                                      45
Chapter 4: Tutorial - PCB Design Session                                                Placing components




        2.   Select the component that has an attached pattern from the Component Name list. A pattern is
             attached to a component if a pattern name appears in the top-right corner and displays below
             in the dialog box, e.g. CAP300. We will place some capacitors named CAP300 first.
        3.   In the Place Component dialog, type a value in the Ref Des box, e.g. C1, to set the reference
             designator for this component and click OK.
        4.   A ghosted outline of the component will appear on the cursor and can then be moved to
             where you wish to place it.
        5.   Choose one of these methods to place the component:
             •   For quick placement, click the location at which you want to place the part.
             •   For accurate placement, do the following:
                 1.   Hold down the left mouse button or press the SPACEBAR.
                 2.   Move the ghosted component to the location you want. If appropriate, press F to flip
                      or R to rotate the component by 90 degrees counterclockwise. You can press SHIFT+R
                      to rotate the component by the Rotation Increment set in the General tab of Options »
                      Configure. If you do not set a rotation increment, the rotation increment is set to 45
                      degrees by default.
                 3.   Place the component by releasing the mouse button or by pressing the SPACEBAR.
        6.   When you have placed the component, the reference designator and component type are
             updated.
        7.   Place a few more components using the different methods outlined in the step above. Choose
             a variety of components, such as resistors and connectors.




46                                                                                 P-CAD PCB User’s Guide
Selecting objects                                                   Chapter 4: Tutorial - PCB Design Session


        8.   When you have finished placing components, right-click or press ESC and then choose S for
             Edit » Select to exit from part placement mode.
        9.   We will be using these placed components when we look at selecting and modifying objects,
             so save the PCB file by choosing File » Save but do not close.


Selecting objects
        This section of the tutorial explores the variety of ways to select single and multiple objects. Place
        two or three pads in the workspace if you haven't done so in the previous section.
        If the Show DataTips feature is enabled in the Miscellaneous tab of Options » Display, a Data Tip
        appears when you move the cursor over an object in your design. Data Tips show context-sensitive
        information about design objects and can assist you in selecting the appropriate object.

    Selecting single objects
        To select a single object, follow these steps:
        1.   Press the + (plus) key to zoom in on your workspace. This makes viewing objects easier.

        2.   Press S or click the Select button     on the command toolbar as a shortcut for choosing Edit »
             Select.
        3.   Click a pad to select it. The pad will display in the selection color (set in Options »
             Display) with a bounding box around it.
        4.   To deselect the pad, click in a blank space in your workspace to cancel the selection of the pad.

    Selecting multiple objects
        To select multiple objects, follow these steps:
        1.   Select the first pad.
        2.   Hold down the CTRL key and select another pad (Ctrl+Click). Notice that both pads are
             selected and the bounding box includes all selected pads.
        3.   To deselect the pads, click in a blank space in your workspace.

    Subselecting objects
        You can select objects that make up a component. For example, you can select a pad that belongs
        to a component. To subselect an object, follow these steps:
        1.   Place a component in the workspace using the Place » Component command.
        2.   Press S or click the Select button on the command toolbar as a shortcut for choosing Edit »
             Select.
        3.   Hold down the SHIFT key and click on a pad that belongs to the component. Notice that only
             the pad is selected.




P-CAD PCB User’s Guide                                                                                           47
Chapter 4: Tutorial - PCB Design Session                                                    Selecting objects


        4.   Now, you can perform actions on the pad. For example, you can right-click the pad and choose
             Properties from the shortcut menu to query the pad.

     Block selecting objects
        To select a group of objects, you can perform a block select. To block select, follow these steps:
        1.   Hold down the mouse button and drag the cursor across your workspace to draw a bounding
             outline around two or three pads.
        2.   Release the mouse button to select the pads.
        3.   Deselect the pads by clicking in a blank area of the workspace.

        Block selecting using Selection Mask
        You can define block selection criteria to specify which particular objects are selected when you
        perform a block select. This time, we will block select the capacitors, CAP300, we placed earlier by
        using their Type to define the selection criteria.
        1.   Choose Options » Selection Mask and click the Block Selection tab if it is not active. The Block
             Selection dialog appears. The check boxes have three states: checked (included); blank
             (excluded) or shaded (masked with additional selection criteria).
        2.   Click the Clear All button to clear the default
             selection of all items. All of the item check
             boxes will become blank and the item buttons
             become shaded.
        3.   Click the Component check box until a shaded
             check mark appears. When the Component
             button becomes available, click Component.
             The Component Selection Mask dialog appears.
        4.   In the Type text box, type: CAP300, or choose it
             from the list.
        5.   Click OK to save the changes and return to the
             Options Selection Mask dialog.
        6.   In the Layers frame, click Set All to select all
             layers.
        7.   Select Inside Block as the Select Mode and click
             OK to set your selection criteria and close the
             dialog.
        8.   Choose View » Extent to make sure the entire
             design is displayed in the workspace.
        9.   Draw a bounding outline around the entire
             design. When you release the mouse button, notice that only the CAP300 components are
             selected.



48                                                                                  P-CAD PCB User’s Guide
Selecting objects                                                  Chapter 4: Tutorial - PCB Design Session


        10. Remember to clear your filter when you having finished using Block selection by choosing
            Options » Selection Mask again and clicking Set All and OK.

    Selecting highlighted objects
        You can select objects that have been highlighted with the highlighter feature in P-CAD PCB.
        1.   Highlight a few objects by selecting them first, then right-click and choose Highlight from the
             shortcut menu. The objects will display in the Highlight color set using Options » Display.
        2.   To select the highlighted objects, choose Edit » Select Highlighted. Only the objects
             highlighted in step 1 will be selected.

    Selecting collocated objects
        When objects overlap so that you cannot select any one of them, you can switch between the
        collocated objects even if they reside on different layers. The switching style used depends on the
        selection made in the Single Select Mode in the
        Single Selection tab of the Options Selection Mask
        dialog.

        Selecting single collocated objects
        Before using these selection modes, add some
        objects that are collocated (in the same position).
        1.   Place a line on the current layer, e.g. Top.
        2.   Switch to another layer and place a line in the
             same position, e.g., Bottom. Repeat this step on
             at least one other layer, e.g. Bottom Silk.

        Cycle Picking
        To toggle through collocated objects and select one
        object:
        1.   Set up the single selection criteria by choosing
             Options » Selection Mask. Click on the Single
             Selection tab and select Cycle Picking in the
             Single Select Mode frame.
        2.   Position the cursor over the collocated objects.
        3.   Click the left mouse button to toggle between
             objects. Information about the currently
             selected item displays in the status line, e.g. ‘Component RN3 selected on Top Layer’.

        Popup dialog
        To choose an object to select from a list of collocated objects on different layers:
        1.   If you choose Popup Dialog in Single Select Mode frame of the Single Selection tab, click the
             left mouse button once over the collocated objects to bring up the dialog. The popup dialog



P-CAD PCB User’s Guide                                                                                         49
Chapter 4: Tutorial - PCB Design Session                                                        Selecting objects


             lists information about all overlapping objects that are selected in the Items list and in a
             selected layer in the Layers frame.




        2.   When the dialog first opens, the first object in the list is highlighted. The objects are listed in
             layer order, from top-most layer to bottom-most layer.
        3.   Click the required object in the list to make it the selected object and close the dialog.
        4.   Click again to bring up the dialog if required.
        5.   To close the dialog without selecting any objects, click on the crossed box or press ESC.

        Selecting multiple collocated objects
        You can select more than one object that has the same position if you have chosen the Popup
        Dialog option.
        1.   Ctrl+Click over the collocated objects to bring up the popup dialog.
        2.   Click the checkboxes to choose the objects you require.




        3.   Click on the     box to close the dialog and select the nominated objects in the workspace.

             You could also combine the selection of collated objects with the selection of other objects
             that do not overlap, by using Ctrl+Click to multiple select.




50                                                                                     P-CAD PCB User’s Guide
Modifying objects                                                  Chapter 4: Tutorial - PCB Design Session




Modifying objects
        In this section of the tutorial, we will practice modifying the graphical properties and attributes of
        the objects we have already placed. We will cover the following commands:
        •    move, align, rotate and resize objects
        •    copy, paste, duplicate and delete objects
        •    change object properties using the properties dialogs and selection masks.

    Moving objects
        To move a single object, follow these steps:
        1.   Select a pad in the workspace.
        2.   Press and hold down the mouse button over the selected pad. Then, drag the pad to a new
             location.
        3.   Release the button to place the pad at the new location. This works the same with all objects
             (e.g. lines, arcs, polygons, etc.)
        If the selection reference point is off-grid when a move operation begins, then it automatically
        snaps to the nearest grid point and all selected objects move the same relative distance.

        Moving a group of objects
        To move a group of objects, follow these steps:
        1.   Select a group of objects using one of these methods:
             •   Block select by dragging a bounding outline around a group of pads to select them
             •   Select a pad, hold down the CTRL key, and then click other pads to add them to your
                 selection.
        2.   After you have selected the pads, press and hold down the mouse button anywhere in the
             bounding outline. Then, move the objects where you want to place them and release the
             mouse button. Alternatively, pressing ALT+Click gives you the ability to move the mouse freely
             without having to keep the left button depressed.
        This process works the same way for all objects.

    Rotating objects
        You can rotate objects, such as lines, arcs, text and components, after they have been placed.
        1.   Select a component to demonstrate this command.
        2.   Press and hold down the mouse button. While you are holding the button down, press R. The
             object rotates 90 degrees counterclockwise. Release the mouse button to place the
             component.




P-CAD PCB User’s Guide                                                                                           51
Chapter 4: Tutorial - PCB Design Session                                                   Modifying objects


        3.   You can also press SHIFT+R to rotate the component by the Rotation Increment set in the
             General tab of Options » Configure. If you do not set a rotation increment, the rotation
             increment is set to 45 degrees by default.
        4.   Deselect the object by clicking in an empty space.

        Customizing rotation increments
        P-CAD PCB's 32-bit database provides the precision to rotate objects down to 0.1 degree, without
        round-off errors. This means, for example, that a component rotated 7.5 degrees 48 times, will be
        returned to its exact original position.
        1.   Choose Options » Configure to set the rotation increment.
        2.   Type a value in the Rotation Increment box in the General tab of the Options Configure dialog.
        3.   Select one or more components and press SHIFT+R to rotate selected items by the custom
             Rotation Increment.

     Resizing objects
        You can resize and reshape lines, arcs, polygons, copper pours, polygonal keepouts, and cutouts.
        For this exercise, you will resize a line. To do this, follow these steps:
        1.   Select a line in the workspace. Notice that two resize handles appear at each end of the line.
        2.   With the line selected, move your cursor and position it over one of the handles. Press and
             hold down the mouse button over a handle, then move the cursor to increase or decrease the
             length of the line.
        3.   Release the mouse button. Notice the size of the line has changed.
        4.   Deselect the object by clicking in an empty area of the workspace.

     Adding a vertex
        You can add a vertex to a line or line segment. If multiple lines/line segments are selected, the Add
        Vertex command will not be available. To add a vertex, follow these steps:
        1.   Select the line/line segment you wish to add a vertex to.
        2.   Right-click and select the Add Vertex command from the pop up menu. The line/line segment
             will be broken into two segments and the first segment will be selected.
        3.   You can undo vertices that have been added, using the Edit » Undo command. To delete a
             vertex, click-and-drag its handle onto an adjacent vertex and release the mouse button.

     Aligning components
        You can only align components, however please note that this command cannot be undone. To
        align the capacitors you have already placed:
        1.   Select all the CAP300 type components using a Block Selection filter.




52                                                                                   P-CAD PCB User’s Guide
Modifying objects                                                 Chapter 4: Tutorial - PCB Design Session


        2.   Right-click, i.e. click the right mouse button, and choose Selection Point from the
             popup menu. Click to locate a point around which we will vertically align the
             components. The selection point marker displays.
        3.   Choose Edit » Align Components and select Vertical About Selection Point and Space Equally
             from the dialog. Enter a spacing of 500 mils and click OK.
        4.   The capacitors will be stacked vertically. The selection point marker disappears when you
             deselect the capacitors. Remember to clear your filter when you have finished using Block
             Selection.

    Copying and pasting objects
        Once a section of your board design has been successfully completed, you may find it useful to
        reuse that information again, either in the current design or in a future design. Objects and net
        information can be copied to the Clipboard or to a block file and later pasted into a different
        location using the various copy and paste commands.

        More information on all these commands can be found in the Edit Commands chapter.

        Copying objects and net information
        A copied object is placed on the clipboard. To copy a single object, choose one of these methods:
        •    Select an object and choose one of the copy commands from the Edit menu
        •    Right-click on a selected object and choose Copy from the shortcut menu.
        To select a group of objects, or include net information in the copied information:
        1.   Block select the desired objects.
        2.   Choose the desired Copy command. All selected objects are copied to the clipboard.

        Drag and drop copying
        To quickly copy objects within the same design and not affect the clipboard:
        1.   Select the object(s) you want to copy.
        2.   Ctrl+Click on the selected objects and drag the copy to a new location.

    Pasting from the Clipboard
        There are several paste options to choose.
        1.   Choose Edit » Paste From Clipboard and click the workspace. The ghosted outline of the
             copied objects appears.
        2.   Before releasing the mouse button, drag the outline to a precise location within the
             workspace, then place the objects by releasing the mouse button.




P-CAD PCB User’s Guide                                                                                      53
Chapter 4: Tutorial - PCB Design Session                                           Changing object properties


     Duplicating objects using Copy Matrix
        To duplicate a group of objects, we will use a pad as an example. This command works with all
        selected objects.
        1.   Select a pad.
        2.   Choose Edit » Copy Matrix. Note that the row and column spacing is in mils; you can change
             the units using Options » Configure.
        3.   Enter information in the appropriate boxes, as shown in the following figure. Positive and
             negative numbers for Number of Columns duplicate the object to the right and left,
             respectively. With Number of Rows, a positive value duplicates up, a negative value down.




        4.   Click OK and the pad duplicates as shown in the illustration above.

     Deleting objects
        To delete an object, e.g. a pad:
        1.   Select a pad you wish to delete. If a pad belongs to a part or component, you cannot move or
             delete that pad. However, you can subselect the pad to perform certain actions. For details, see
             Subselecting Objects.
        2.   Choose one of these methods to delete it:
             •   Press the DELETE key.
             •   Right-click and choose Delete from the popup menu.
             •   Choose Edit » Delete.



Changing object properties
        You can change the properties of a selected object. Each object has a Properties dialog which is
        accessed in the same way. Let’s practice by changing the properties of a pad.
        The easiest way to bring up a Properties dialog is to double-click on an unselected object.
        Alternatively, follow these steps:
        1.   Select a pad in your workspace.



54                                                                                   P-CAD PCB User’s Guide
Changing object properties                                          Chapter 4: Tutorial - PCB Design Session


       2.   Open the Properties dialog using one of these methods:
            •   Right-click and choose Properties from the shortcut menu.
            •   Choose Edit » Properties. The Pad Properties dialog appears.




       3.   In the Pad Number box, type: 1
       4.   In the Default Pin Designator box, type: A1
       5.   From the Pad Style drop-down list select the desired pad style. If the pad style you want does
            not appear in the list, click the Pad Styles button to display the Options Pad Style dialog, where
            you can add or modify a pad style.
       6.   Click OK to exit this dialog and check the pin number and designator have changed.

       For information about pad and via styles, see Using Pad and Via Stacks later in this tutorial. For
       more information about properties, refer to Edit Commands chapter.

   Unifying values
       Now let’s try setting uniform line widths for two lines of unequal widths.
       1.   Choose Place » Line and place a line with line width of 10mils in the workspace. By default, the
            line width is 10 mils, unless you have changed this setting using the Options » Current Line
            command.
       2.   Select the line. Then, open the Properties dialog using one of these methods:
            •   Right-click and choose Properties from the shortcut menu.
            •   Choose Edit » Properties.
       3.   In the Width box, change the line width to 20 mils. Click OK to close the Line Properties
            dialog. The selected line’s width changes in the workspace.
       4.   Place another line near the first one, leaving it at the default width.



P-CAD PCB User’s Guide                                                                                      55
Chapter 4: Tutorial - PCB Design Session                                          Changing object properties


        5.   Select both lines by drawing a bounding outline around the lines.
        6.   Choose Edit » Properties. Because each line has a different width, no value appears in the Line
             Properties dialog. However, you can change the width of both lines, by entering a value in the
             Width box. For this exercise, type 50 in the Width box.
        7.   Click OK and both lines will become 50 mils wide.

     Using the Selection Mask
        The Block Selection tab in the Options » Selection Mask command provides you with some
        powerful and labor-saving features. This selection mask can work in very specific or general ways,
        depending on the parameters you define for the selection filtering process.
        In this section you will learn how to complete the following tasks, which would be typical
        applications for this selection tool.
        •    Select all lines of a particular width (thickness) on specific layers and change them to another
             width.
        •    Select components of a certain type, change their values and make the values visible in the
             display.

        Changing line width
        This method of changing line widths allows you to specify which lines will be changed by their
        current width, regardless of which layer they have been placed on.
        1.   Choose Options » Selection Mask and click the Block Selection tab.
        2.   In the Items frame of the Options Selection Mask dialog, click Clear All.
        3.   Click the Line check box until a shaded check mark appears and the Line button becomes
             available. Click the Line button. The Line Selection Mask dialog appears.
        4.   In the Width text box, type: 20 mil and click OK to return to the Options Selection Mask
             dialog.
        5.   Select all of the layers in the Options Selection Mask dialog by clicking Set All in the Layers
             frame. Choose Inside Block. Later, when you do a block select, this setting will select all items
             inside your bounding outline. Click OK.
        6.   Draw a bounding outline around the entire design. If necessary, choose View » Extent to view
             the entire board.
        7.   While the board is selected, right-click and choose Properties from the shortcut menu.
        8.   In the Width text box, type: 30 mil and click OK. All of the selected 20 mil lines in your
             design will now be 30 mil lines.

        Modifying components using the Selection Mask
        Now, let’s modify all CAP300 components by changing their values from .1 to .05F and making these
        values visible.



56                                                                                   P-CAD PCB User’s Guide
Initial board layout                                              Chapter 4: Tutorial - PCB Design Session


        1.   Block select all the CAP300 capacitors using Options » Selection Mask.
        2.   Right-click the selected components and choose Properties from the shortcut menu. The
             following dialog appears.




        3.   In the Value text box in the Component Properties dialog, type: .05F
        4.   In the Visibility frame, select the RefDes, Value and Type check boxes to display them in the
             workspace and click OK.
        5.   The formerly invisible value of .1 that was attached to the CAP300 components is now a visible
             value of .05F.

    Replacing components
        Next, we’ll replace a component with one of a similar type.
        1.   Select a CAP300 component and choose Edit » Properties.
        2.   In the Type combo box, change the type from CAP300 to CAP-NON. The pattern is updated
             and any connectivity is maintained.

             The Component Properties dialog provides a link to the Query function where you can search
             a library for a desired component to replace the current component. See your Library Executive
             User’s Guide for more information on using Query.

        3.   We have now finished using our Titleblock.pcb file for the moment, so choose File » Close
             and save the changes.


Initial board layout
        This section walks you through the steps you need to layout the board. We will use mostly
        demonstration files supplied with P-CAD during the rest of this tutorial.




P-CAD PCB User’s Guide                                                                                       57
Chapter 4: Tutorial - PCB Design Session                                                   Initial board layout


     Creating a board outline
        To start a design, create a board outline using Place » Line on the Board layer. For your
        convenience we have provided an outline to get you started.
        1.   Open the Demo1_o.pcb file provided in the Demo folder of the P-CAD installation directory by
             choosing File » Open.
        2.   You are now ready to place components or load a netlist generated from a schematic.

     Loading a Netlist
        To design a PCB, you could place components one at a time and then choose Place » Connections
        to add connections. However, most designs today are first created as a schematic, from which a
        netlist is generated. A netlist lists components and their electrical connections. Each set of
        connections carrying the same signal is a net. Connected component pins are defined as nodes and
        each net contains at least two nodes.
        Components placed using Utils » Load Netlist are located by searching, in order, through the open
        libraries.
        Loading a netlist into PCB has two effects:
        •    If found in the libraries currently open, components in the netlist are automatically placed in
             the workspace.
        •    Electrical connections between nodes are made, forming the ratsnest (blue lines).
        To load a netlist:
        1.   Choose Utils » Load Netlist. The Utils Load Netlist dialog displays.




58                                                                                  P-CAD PCB User’s Guide
Initial board layout                                             Chapter 4: Tutorial - PCB Design Session


        2.   Open the netlist titled Demo1.net found in the Demo folder of the P-CAD installation directory
             by clicking on Netlist Filename.
        3.   Set the Netlist Format to P-CAD ASCII.
        4.   PCB scans the open libraries, retrieves the patterns, and places them in the workspace above
             your board outline. Then the ratsnest of net connections is created as shown below.




        5.   Now you are ready to move the components into position within the board outline.

    Positioning components
        Achieving optimal placement is a crucial foundation to designing high-quality printed circuit
        boards. The ratsnest provides a visual clue to the densities on the board.
        1.   You can turn the display of nets ON or OFF with the Edit » Nets command. This is useful to
             focus on a set of connections, such as address lines or your power and ground nets.
        2.   After netlist placement, you can move the components manually onto the board or you can
             move them by reference designator. When you select and move components into position, the
             connections ‘rubberband’ to maintain the established nets. See below for details about moving
             components by RefDes (reference designator).
        3.   Remember you can zoom during editing, pressing the R and F keys rotate and flip the
             components, and pressing ALT+Click allows you to move the mouse freely without having to
             hold down the left button.




P-CAD PCB User’s Guide                                                                                      59
Chapter 4: Tutorial - PCB Design Session                                                   Initial board layout


        Moving components by RefDes
        You can move components by reference designator. To learn how to do this, you will practice
        moving a group of capacitors into position within your board outline.
        1.   Choose Edit » Move by RefDes. The Edit Move by RefDes dialog appears and the RefDes list
             contains a list of the components in your design.
        2.   Select all of the capacitors in the RefDes list. To do this, hold down the SHIFT key and click C12
             and C23.




        3.   Click OK to close the dialog and return to the workspace.
             When the Edit Move by RefDes dialog closes, the status line shows the name of the Next
             RefDes to move. We’ll move C12 first.
        4.   Place the component. The status line shows C13 as the Next RefDes to move. Continue placing
             the parts until you’ve placed all of the capacitors.
        5.   Once you’ve moved all of the selected components, the Edit Move By RefDes dialog appears.
             You have these options:
             •   To move another component or group of components, select the components from the
                 RefDes list.
             •   To close the Edit Move by RefDes dialog, click Cancel or press ESC.

     Optimizing nets
        As components are moved, the connections may have become less efficient than when they were
        originally placed. PCB includes a command to re-optimize the connections.
        1.   Choose Utils » Optimize Nets.
        2.   Notice the connections change as each net is evaluated and shortened.




60                                                                                   P-CAD PCB User’s Guide
Routing connections                                                Chapter 4: Tutorial - PCB Design Session


       Optimize Nets is also used to swap pins and gates for effective routing. Refer to the Utils
       Commands chapter for more information.

       3.   Close the PCB file without saving.


Routing connections
       For routing, we need to change some current settings. Then we'll step through manual routing and
       discuss the changes that can be made to existing traces, followed by a brief look at interactive and
       automatic routing.

   Creating routing settings
       Set up the routing layers, any non-uniform grids and clearance rules before manually routing a
       board.

       Setting routing layers
       Routing is only permitted on enabled signal layers.
       1.   Open Demo1_u.pcb from the Demo folder of the P-CAD installation directory.




       2.   Choose Options » Layers.
       3.   Enable all of the layers to be used for routing. The Top and Bottom layers will be used in this
            example.

       Using non-uniform routing grids
       We previously set our grid to 100 mils for optimal placement. Non-uniform grids are also supported
       to route multiple tracks between pads, and for autorouting. A 42 8 8 42 grid (mils) means that
       grid points are located in a pattern of 42 mils, 8 mils, 8 mils and 42 mils apart, starting at the origin.
       This spacing is convenient for routing one or two 8 mil traces between 60 mil pads, using 8 mil
       clearances, as shown below.


P-CAD PCB User’s Guide                                                                                         61
Chapter 4: Tutorial - PCB Design Session                                                   Routing connections




             We'll add a non-uniform, relative grid for routing.
        1.   Choose Options » Grids and click Relative Mode.
        2.   Type 42 8 8 42 in the Grid Spacing box with the values separated by spaces. Click Add. If you
             are working in millimeters, unit overrides must be typed for each value, e.g. 42 mil, 8 mil etc.
        3.   Clear the Prompt for Origin check box, and enter an origin at X=25.0, Y=0.0. This is needed
             to align the relative grid with component pads (most pads are 25 mils off of a 100 mil grid with
             origin at 0, 0).
        4.   Click OK to continue.

        Setting clearance rules
        Now we can set some Clearance rules to be used for design rule checking as we route. To set all
        clearance rules to 8 mils:
        1.   Choose Options » Design Rules and click the Layer tab.
        2.   Click Set All to select all entries.
        3.   Set the Pad to Pad, Pad to Line, Line to Line, Pad to Via, Line to Via and Via to Via values to 8.
             An easy way is to type in 8 in the Pad to Pad box and then TAB to the next box.




        4.   Click Update and then click Close to exit the dialog.




62                                                                                     P-CAD PCB User’s Guide
Routing connections                                               Chapter 4: Tutorial - PCB Design Session


   Manual routing
       Online DRC will annotate and document design rule errors created while routing the board. While
       routing, look at the status information portion (right side) of the status line for the measurements
       of your route. Routed arcs are also accurately measured.
       Follow these steps to manually route all the connections on your board:
       1.   Zoom in so you can select unrouted connection lines. Rows and columns of grid points may be
            seen between pads, displaying convenient routing channels.

       2.   Choose Route » Manual or click the Route Manual button         on the Route toolbar.
       3.   Enable Online DRC for routing using one of these methods:
            •   Choose Options » Configure, click the Online DRC tab and select the Enable Online DRC
                check box.
            •   Click the Online DRC button        on the command toolbar.
       4.   Switch to the Top signal layer, using your layer shortcuts.
       5.   Using the keyboard shortcut G, toggle to a desired routing grid. This grid should be based
            upon the chosen connection. During the routing and layer changing process, zoom in (+) and
            out (-) as needed.
       6.   Click and hold directly over a connection near a starting pad and drag the trace segment that
            displays as desired. Release at a location where you want the first vertex. Then, click at the
            location you want for the third vertex.




       7.   When the mouse is down, press the O key to access the desired orthogonal shape and the F
            key to toggle (flip) the vertex. Release the mouse. Notice the second vertex is added for you
            depending on the orthogonal mode chosen. The orthogonal modes include arcs, 45-degree
            diagonals, and 90-degree angles.
            Press the mouse down again to locate the next segment. To place curved traces, as below, type
            O to reach the arc orthogonal mode, and release the mouse.




P-CAD PCB User’s Guide                                                                                       63
Chapter 4: Tutorial - PCB Design Session                                                  Routing connections


             Remember you can limit the enabled orthogonal modes by entering the Route tab of the
             Options » Configure command and disabling the unwanted orthogonal modes.
        8.   Switch to the Bottom layer by pressing the L or SHIFT+L key (or use the status line controls) to
             route any segments where you need to cross a blockage. When changing layers in routing
             mode, the current via or the via style specified within the net attributes is automatically placed
             to connect the layers.
        9.   Create obvious clearance violations by routing too close to pads, vias or signals. The machine
             beeps and an error indicator is placed by the DRC for each violation.
        10. Press the BACKSPACE key to unwind the offending trace. Notice that the trace and the error
            indicators generated by the trace are deleted. Each press of the BACKSPACE key backs up to
            the previous point. Leave at least one error in the design.
        11. To complete the route all the way to the destination pad, click the right mouse button or press
            ESC. When you route directly to the destination pad, a diamond shape appears, indicating
            routing is complete with a zero length connection.
             To terminate routing without completing the connection, press either slash key (\ or /). You can
             finish routing it at any time. Note the current layer has been reset. The keyboard shortcuts
             used to complete or suspend routing can be customized in the Route tab of the Options »
             Configure command.
        12. Route a few more connections, practicing with orthogonal modes, placing one or two traces
            between pads, and toggling between layers.
        13. When you have finished practicing your manual routing, close the demo file using File » Close
            without saving it. We will use it again in the next section to demonstrate autorouting.

        Autorouting part or all of a PCB
        We will complete routing the example PCB using P-CAD’s Shape Router. You can automatically
        route a single connection within a net, all pads on a particular component, or all connections
        within a defined area by choosing the relevant option from the Tools menu.
        1.   Open Demo1_u.pcb again.
        2.   Select View » Extents to show the extent of all objects placed in the workspace.
        3.   To automatically route a particular net, select Route » AutoRouters. Choose P-CAD Shape
             Route from the AutoRouter pull down menu and select Start.




64                                                                                   P-CAD PCB User’s Guide
Routing connections                                               Chapter 4: Tutorial - PCB Design Session




       4.   The design will enter the Autorouting interface. Select Tools » AutoRoute Net. The cursor will
            change to an arrow. Select any pad on the relevant net or on any connection line and the
            P-CAD Shape Based AutoRouter will automatically route the entire net.
       5.   Continue to select other nets to route.
       6.   To automatically route the entire board, select Tools » Start AutoRouter from the Shape Based
            Auto Router menu.
       7.   When routing is complete, select File » Save and Return to save the routing and return to the
            PCB editor.

   Changing routed connections
       Routed segments can be changed in a variety of ways:
       •    Reroute: Rerouting a segment is done by using the Route » Manual command. Click over the
            segment to be changed; it becomes a ghosted connection that can be manually routed as
            previously described. Click to locate each new vertex; press O and F to change orthogonal
            modes; press the BACKSPACE key to unwind.
       •    Mitering routes: Route Miter turns corners into arcs or 45-degree angles. After selecting the
            cornering style in the Route tab of Options » Configure command, each left click over a 90-
            degree corner gives you the ability to move the corner back into a mitered angle or arc. To get
            optimum results, choose a finer grid than your normal routing grid before mitering.
       •    Move: Select a routed segment, then click and drag it (or its corner) to a new location. Notice
            that the adjacent segments are stretched to maintain connectivity.
       •    Line and Arc Properties: Select a segment, click right button, and choose Properties from the
            pop-up menu. You can then change the line or arc width.
       •    Delete route: Select a segment, click right button, and choose Delete from the pop-up menu or
            press the DELETE key. The route reverts back to a connection.
       •    Delete connection: After you delete copper and it reverts to a connection, you can select and
            delete the connection itself. This is a drastic edit and should be used with caution.




P-CAD PCB User’s Guide                                                                                        65
Chapter 4: Tutorial - PCB Design Session                                                             Other options


        •    Move to Layer: Select one or more segments routed on the Top layer. Switch the current layer
             to Bottom and choose the Edit Move To Layer (SHIFT+T) command. Vias are added and deleted
             as needed.

     Unrouting a board
        In this procedure you will select all lines, arcs, and vias on all layers, then delete them. This will, in
        effect, unroute the entire board.
        1.   If it is not already open, choose File » Open and open Demo1_u.pcb.
        2.   Choose Options » Selection Mask.
        3.   In the Items frame of the Block Selection tab, click Clear All to cancel the selection of the items
             check boxes. Then, click the Arc, Line, and Via check boxes, to enable these three items.
        4.   In the Layers frame, click Clear All. Then, hold down the SHIFT key and click Top and Bottom.
        5.   In the Select Mode frame, choose Inside Block and click OK to close the dialog.
        6.   Do a block select of the complete board. To do this, draw a bounding outline around the entire
             board. If necessary, choose View » Extent for a complete view of the board.
        7.   When all arcs, lines, and vias are selected, press the DELETE key. The result should be that all
             the routed items in your design – lines, arcs and vias – will return to connections.


Other options
        In this section, we will explore some of the options available in P-CAD that are useful when
        creating a PCB, i.e. pad and via stacks, copper pours and cutouts.

     Pad and via stacks
        PCB supports both simple and complex pads and vias, as well as blind and buried vias. Surface
        mount pads and uniform, through-hole pads and vias are considered simple. Since these types are
        predominant in a design, P-CAD 2000 has powerful features specifically for dealing with them.
        At this point, we will look closely at complex pads and vias. PCB lets you define different shapes
        and sizes on the various layers in a design. This feature, called pad stacks, helps you route complex
        designs and allocate clearance on certain layers. A similar feature, called via stacks, gives you the
        ability to set up different styles of vias on a layer-by-layer basis and void vias on certain layers,
        hence creating blind and buried vias.
        In the samples supplied, the pad and via shapes and sizes are the same on all internal signal layers.
        The Modify Pad Style and Modify Via Style dialogs can be used to create unique styles for any layer.
        1.   Open Accsampl.pcb found in the Demo folder of the P-CAD installation directory.
        2.   Zoom in to Area 4 on the sample board where we have created a pad stack, a via stack, a blind
             via and a buried via.




66                                                                                      P-CAD PCB User’s Guide
Other options                                                       Chapter 4: Tutorial - PCB Design Session


       Pad stacks
       1.   Select the pad labeled Pad Stack and choose Edit » Properties. The Pad Properties dialog
            appears for the select pad.
       2.   Click Pad Styles. The Options Pad Style dialog appears where the 100x60x38 (width x height x
            diameter) style is selected as P:EX100Y60D38A.




       3.   Next, click Modify (Complex) to open the Modify Pad Style (Complex) dialog. This is where pad
            styles are created and changed. To view the details of this style, click each layer in the Layers
            list. You'll see different sizes and shapes defined for the top, bottom, and internal signal layers.
       4.   After you exit the dialogs, switch between the signal layers choosing View » Redraw after each
            layer change. You'll see the different pad shapes as they are defined on each layer for this style.

       Via stacks
       Via stacks are created and defined the same way. When manually routing from one layer to
       another, PCB alerts you if you try to insert a via between layers that the current via style does not
       support.
       1.   Select the via stack example, right-click, and choose Properties. The Via Properties dialog
            displays.
       2.   View the via's characteristics just as you did for the pad.
       Now we’ll look at the blind and buried vias provided.
       1.   The blind via has been created by choosing Options » Via Style and clicking the Modify Hole
            Range button. The via feeds from the bottom through internal signal layers, but does not
            penetrate the top.
       2.   Likewise, you can set up buried vias to connect any combination of internal layers by clicking
            the Modify Hole Range button in this dialog. This via feeds from one internal signal layer to
            another, but does not penetrate the outer layers.
       3.   You can prevent pads and vias within the boundaries of a plane or copper pour from
            automatically connecting to the plane or copper pour. To do this, click on Modify (Complex) in




P-CAD PCB User’s Guide                                                                                         67
Chapter 4: Tutorial - PCB Design Session                                                       Other options


             the Options Via Style dialog and select the Prohibit Copper Pour Connections option in the
             Modify Via Style (Complex) dialog.
        4.   Close Accsampl.pcb without saving any changes.

     Copper pours
        Using the copper pour feature, you can lay down areas of copper with a backoff from tracks and
        pads within the area defined by the pour outline. You can also define various properties for each
        copper pour in a design, such as fill characteristics, backoff smoothness, connectivity and more.
        When you place a copper pour, you first draw the pour outline as a polygon. Then, you flood the
        pour outline with a copper fill.
        To draw a copper pour outline, follow these steps:
        1.   Open up our original file Titleblock.pcb to practice copper pours.

        2.   Choose Place » Copper Pour or click the      toolbar button.
        3.   Click where you want to place the first vertex of the copper pour. Make sure you create the
             copper pour over some lines and other objects that you have previously drawn on the same
             layer.
        4.   Drag the cursor to another point and click. Drag the cursor to another point and click at each
             corner of the polygon you want to draw.
        5.   When you’ve finished drawing a polygonal shape, right-click, or press ESC. You remain in
             placement mode until you choose another command.
        6.   Select the copper pour you want to fill and use one of the following methods to open the
             Copper Pour Properties dialog:
             •   Double-click on the copper pour
             •   Choose Edit » Properties
             •   Right-click and choose Properties from the popup menu.




68                                                                                 P-CAD PCB User’s Guide
Other options                                                      Chapter 4: Tutorial - PCB Design Session


       7.   In the Copper Pour Properties dialog, click the Style tab and select the appropriate options in
            the Fill Characteristics frame. Whatever you specify here applies only to the selected copper
            pour(s).
       8.   In the State frame, select Poured.
       9.   Click OK to close the dialog. P-CAD PCB floods the pours with a copper fill using the pour
            order set in the Pour/Repour Options frame of the Options Configure dialog.
       10. Zoom in to examine the pour more closely, including the way the copper is backed off from
           pads and traces.

       For more information on copper pours, refer to the Copper Pours chapter.

   Plowing tracks and cutouts
       On occasion, you may need to route a track through an area where copper has been previously
       poured.
       1.   Place a track (Place » Line) through the copper pour we have just created.
       2.   Selecting the pour and pour it again by opening its Properties dialog and selecting Repour.
       3.   Zoom in to see the newly added track with the defined clearance around it.
       Alternatively, you can select Auto Plow Copper Pour to plow tracks through the copper pour as you
       place them.
       1.   Choose Options » Configure and click on the General tab in the Options Configure dialog.
       2.   Select Auto Plow Copper Pour and click OK.
       3.   Place a track (Place » Line) through the copper pour and zoom in to check the results.

       Creating cutouts
       To create an unpoured area within a pour, add a cutout. Cutouts can be used to prevent copper
       from being poured into intricate areas, thus avoiding unwanted islands of copper from forming.

       1.   Choose Place » Cutout or click the      toolbar button.
       2.   Click where you want to place the first corner of the cutout within the copper pour you
            created previously.
       3.   Drag the cursor to another point and click. Drag the cursor to another point and click at each
            corner of the cutout polygon you want to draw.
       4.   Right-click or press ESC to establish the cutout polygon. Since we selected Auto Plow Copper
            Pour in the previous exercise, the area defined by the cutout is not filled. If this option was not
            selected, you would have to the re-pour the copper pour to create the cutout.
       5. Close Titleblock.pcb.




P-CAD PCB User’s Guide                                                                                        69
Chapter 4: Tutorial - PCB Design Session                                                   Design verification



Design verification
        Completed designs should always be verified prior to generating final artwork and CAM files. PCB
        provides a variety of tools to help check your design against the original schematic and against your
        mechanical design rules, such as DRC (Design Rule Check).
        To try out a few of the following operations, open the routed board Rdemo1_p.pcb in the Demo
        folder of the P-CAD installation directory.

     Netlist verification
        1.   Choose the Utils » Compare Netlist command to verify the integrity of the current design
             against the original netlist.
        2.   If you mistakenly deleted a component or a net from the design, this command shows you the
             discrepancy. For practice, compare the loaded design to the netlist Demo1.net in the Demo
             folder of the P-CAD installation directory. They should be identical.

     Design Rule Checking
        Comprehensive electrical and physical design rule checks can be performed on the board.
        1.   Choose Utils » DRC. The Utils DRC dialog displays. The DRC can generate a comprehensive
             report that is output to a filename you specify by clicking Filename.




        2.   The design rules to be checked are specified by enabling specific report options. A complete
             description of each rule check can be found in the online help. The demonstration board has
             silk screen violations that you need to find. Select the Silk Screen Violations check box.
        3.   Click the Design Rules button to set the physical design rule clearances to 12 mils. In the
             Design Rule dialog, click Set Defaults from the Layers tab and click Close.




70                                                                                  P-CAD PCB User’s Guide
Design verification                                               Chapter 4: Tutorial - PCB Design Session


        4.   Select View Report so the output report is presented on-screen and select Annotate Errors so
             that error indicators are placed on your board to help spot and fix problems.
        5.   Select Summarize Ignored Errors so that ignored errors are summarized on the report, and
             then click the Severity Levels button to open the Rules Severity Level dialog.




        6.   Select the Point-To-Point Connectivity and Unconnected Pins rules and choose Ignored in the
             Severity Level frame. Click OK to return to the Utils DRC dialog.
        7.   Choose Region to define a smaller area of the board for rules checking. To define the region
             you want to DRC, choose one of these methods:
             •   Use Define Region:
                 1.   Click Define Region. PCB takes you back to the design.
                 2.   Hold down the left mouse button on the first corner of the area you want to define.
                      Drag the cursor until the target zone is completely within the rectangle and release
                      the button. Right-click to finish the region definition.
                 3.   Confirm that you want to update the region coordinates shown in the message box.
             •   Set the region coordinates directly, enter the X and Y coordinates for the Lower Left and
                 Upper Right in the appropriate text boxes.
        8.   Click OK to begin checking.
        9.   On completion, the DRC output report is opened and can be viewed, edited, or printed from
             the Notepad utility. Switch back to your design and notice that indicators have been placed at
             error locations.
        10. Select any marker, right-click, and choose Properties to view the error descriptions in the Find
            Errors dialog.




P-CAD PCB User’s Guide                                                                                        71
Chapter 4: Tutorial - PCB Design Session                                                   Generating reports




        11. You can view any error in the design by selecting one or all categories. Scroll sequentially
            through all the errors using the up and down arrows next to the Error Number text box.
             You can also enter an error number in the text box and click Find to go directly to that error
             message.
        12. Click Jump To to locate an error in the design.
             When working with a real design, you would resolve each error and delete the indicators one
             by one. We'll skip that step here and just delete them. To delete DRC error markers, either:
             •   block select all of your DRC Errors items and press DELETE, or
             •   choose Utils » DRC with no reports enabled. Rerunning the command clears the old
                 markers.
        13. Keep the PCB file open as we will use it for generating reports in the next section.


Generating reports
        This section of the tutorial shows how to create a variety of useful reports out of a PCB file. These
        reports can help you verify the integrity of your design and document your work. Reports can be
        customized and saved with the design to be used in the future. Comma-separated ASCII report
        files can be output for loading into your word processor, database manager or spreadsheet
        program for further editing or formatting.
        1.   With Rdemo1_p.pcb open, choose File » Reports to open the File Reports dialog.




72                                                                                   P-CAD PCB User’s Guide
Generating reports                                              Chapter 4: Tutorial - PCB Design Session




       2.   Choose the reports you want to generate by selecting the appropriate check boxes in the
            Reports to Generate list. Choose P-CAD Report in the Style Format box and in the Report
            Destination frame, choose Screen.
       3.   Click Generate to produce the reports. The selected reports will display in separate Notepad
            windows, e.g. the Bill of Materials report (Rdemo1_p.bom) shown below that was generated
            from the file Rdemo1_p.pcb.




       4.   You can save or print the reports using the Notepad File commands. When you have finished
            viewing the reports, close each report window and select Close in the File Reports dialog.
       For more information on how to customize reports, refer to the File Commands chapter.




P-CAD PCB User’s Guide                                                                                     73
Chapter 4: Tutorial - PCB Design Session                                        Printing and plotting your design



Printing and plotting your design
        Using PCB, you can generate high-quality artwork on the wide variety of devices supported by
        Microsoft Windows as well as Gerber-format photoplotters. First you'll set up the printer, then
        create a print job for each piece of the design to be generated. Finally, you select any number of
        print jobs and generate the output.
        1.   We'll demonstrate using Rdemo1_p.pcb, so make it the current design.
        2.   Choose File » Print Setup to set up your printer, paper size and source, orientation, number of
             copies and other printer options. Click on Landscape and click OK.

     Setting up your print jobs
        1.   Choose File » Print. The Print Jobs list shows any jobs that are
             already defined for our demo board, e.g. Components.
        2.   Click Setup Print Jobs. Here you set up your options including
             the layers and items to be included, and the scale, offsets,
             rotation, and drill symbol size for the output.
        3.   Select Components in the Print Jobs list. You'll see the
             characteristics defined for that job on the right of the dialog.
             To change the job, update the options and click Modify.
        4.   Now we’ll create a print job that includes all the layers of the
             board. To create a new print job, type a new job name, e.g.
             ALL, in the Print Name box, choose your options e.g. set all
             layers and other options set in the dialog below and click Add.
             Multiple jobs can be added or changed before you click Close to return to the File Print dialog.




74                                                                                      P-CAD PCB User’s Guide
Generating manufacturing files                                      Chapter 4: Tutorial - PCB Design Session


        5.   Next, click Drill Symbols. We could individually assign each hole size to one of the drill
             symbols provided. Instead, click Automatic Assign to assign them instantly, then close the
             dialog.
        6.   Set your output colors by clicking the Colors button if you have a color printer.
        7.   Return to the File Print dialog. Select print job names to include or exclude the jobs from being
             printed. Select ALL.
        8.   You may preview the output before printing by clicking the Print Preview button, checking the
             output and clicking Close to return to the File Print dialog.
        9.   Click Generate Printouts to send the print jobs to your printer. The following file will be
             printed showing all layers.




Generating manufacturing files
        This final section of the tutorial looks at generating Gerber and N/C drill files.
        The process for generating Gerber-format photoplot files is very similar to that for generating print
        as discussed in the previous section of this tutorial. You determine the contents of the various
        photoplot files, select one or more of them, and generate the output. With Gerber files, however,
        you must also take the extra step of mapping apertures to items on your design using PCB’s
        automatic aperture assignment.

    Generating Gerber output
        1.   Make the file Rdemo1_p.pcb the current file and choose File » Export » Gerber. The buttons
             on the right of the File Gerber Out dialog are arranged in the order required to step through
             the process of generating photoplot files.




P-CAD PCB User’s Guide                                                                                       75
Chapter 4: Tutorial - PCB Design Session                                       Generating manufacturing files




        2.   Click Setup Output Files. You will notice that there are already some output files generated for
             you.
        3.   Now we will create a new output job for the Top Silk layer by setting output file options.
        4.   Type TSK in the File Extension edit box. The output files have the same base name as the
             design file but with a unique extension, e.g. for Top Silk, etc.




        5.   Highlight the Top Silk layer in the Layers list box. Click all the check boxes, except Mirror. Also
             click View log file upon completion to report errors during Gerber generation.
        6.   Then click Add to add RDEMO1_P.TSK to the Output File list.


76                                                                                    P-CAD PCB User’s Guide
Generating manufacturing files                                     Chapter 4: Tutorial - PCB Design Session


        7.   Specify the Output Path where the Gerber photoplot files will be stored, e.g. C:\PCAD\Demo.
        8.   Click Close to exit the dialog and return to the main File Gerber Out dialog. The new Gerber
             file, RDEMO1_P.TSK , appears in the Output Files list box.
        9.   Next, click Apertures to assign a photoplot aperture to each item on the board. To save time,
             just click Auto in the Automatic Describe/Assign frame. PCB automatically assigns an aperture
             to each item. You can then edit any of the assignments if you wish. Click Close to complete
             aperture definition.




        10. The File Gerber Out dialog provides access to assigning drill symbols. Click Drill Symbols to
            display the Drill Symbol Assignments dialog. From this dialog, you can assign drill symbols
            either manually or automatically. Click Automatic Assign to auto assign the drill symbols. Select
            Close to save your changes.
        11. Click Gerber Format from the File Gerber Out dialog to set the format for your output, such as
            the output units, numeric type and format, in the Gerber Format dialog. By default, the output
            format is set to 274-D so we do not need to change any settings. Select Close to return to the
            File Gerber Out dialog.
        12. To compress Gerber files into a single compressed file when output, select the
            Compressed(.ZIP) check box in the Compress Output Files frame of the File Gerber Out
            dialog. This option requires an unzipping program. Alternatively, select the Self-Extracting
            (.EXE) check box to produce a single self-extracting compressed file that contains all your
            selected Gerber output files. We will not compress our small file this time, so leave the check
            boxes unselected.
        13. Finally, choose one or more output files by selecting those files from the Output Files list. Click
            Generate Output Files to produce the photoplot files that are saved to the nominated
            directory.
        Before we leave Gerber files, we will have a look at viewing the Gerber files we just generated.




P-CAD PCB User’s Guide                                                                                        77
Chapter 4: Tutorial - PCB Design Session                                         Generating manufacturing files


     Viewing Gerber photoplot files
        Perhaps no other function in PCB provides as positive visual verification as much as the photoplot
        file viewing facility. By viewing the files just generated on-screen, you can be assured that your
        aperture selection and options were correctly set.
        PCB lets you slide a Gerber file into a layer while the original design is open. As with superimposing
        two supposedly identical overheads, discrepancies become obvious. You can also read in multiple
        Gerber files to view a composite of the design.
        1.   Make the PCB file Rdemo1_p.pcb current.
        2.   Choose File » Import » Gerber and load RDEMO1_P.TSK from the Demo folder of the P-CAD
             installation directory. Also select View log file upon completion to check for errors and click
             OK.




        3.   Notice how a new layer named Gerber displays the Gerber file information overlaying the
             original design in the workspace ready for checking for any discrepancies. An error log also
             opens in Notepad.
        4.   Further isolate the Top Silk layer and the Gerber layer to show the overlay of these two layers
             only, by choosing Options » Layers and enabling only these layers.
        5.   Do not save the Gerber layers within your PCB file as they are usually only used for viewing
             and verification purposes. Once you have finished checking, close the PCB file without saving.

     Generating N/C drill files
        The procedure for generating drill files is similar to the procedure for creating prints and photoplot
        files.
        1.   Choose File » Export » N/C Drill. The File N/C Drill dialog displays.
        2.   Set up output files, layers, assign tools, set the drill file format and produce a compressed
             (.zip) file or a self-extracting compressed file by selecting the buttons of the File N/C Drill
             dialog.
        3.   Select the output files, click Generate Output Files and a drill file (.ncd) is created.
        For more information about generating manufacturing files, see the File Commands chapter.




78                                                                                     P-CAD PCB User’s Guide
                                                                                      CHAPTER             5


                                                     Documentation Tools

Documenting a Design with Document Toolbox
       With Document Toolbox you can accelerate the development of a complete, informative
       documentation package that details the fabrication and assembly of the printed circuit board. The
       information provided here is an overview of the documentation capabilities of the Document
       Toolbox.
       In this section you will learn about:
       •   Zoned borders and custom title blocks.
       •   Drawing and revision notes.
       •   Dynamically updated Design Views.
       •   Detail views of a design.
       •   Annotated depiction of the layer stack-up diagram.
       •   Tables of drill data.
       •   Picture graphics.
       •   Associative dimensions.

   Drawing Layers
       Assembly or fabrication drawings of the printed circuit board may be integral components of your
       PCB documentation package. Document Toolbox includes a variety of objects that accelerate the
       production of these drawings. It is recommended that you place these objects on a nonsignal layer.
       You may want to define an additional nonsignal layer for an assembly or fabrication drawing called
       a drawing layer. On this layer you can place graphics, including design detail views and layer stack-
       ups as well ad drawing-specific notes.




P-CAD PCB User’s Guide                                                                                     79
Chapter 5: Documentation Tools                              Documenting a Design with Document Toolbox


     PCB Title Sheets
        Document Toolbox helps you create a title sheet for your PCB design. Title sheets, and the
        information contained within, may be specific to a layer. Building a title sheet incorporates design
        borders, zones and title blocks. When combined, these objects make up the PCB title sheet similar
        to the one shown in the following figure:




        Each of the objects may also be used independently in whatever combination best fits your design
        needs.

     Borders and Zones
        With Document Toolbox you can place a zoned border on any layer. A design border and zones are
        two of the basics needed to create the PCB Title Sheet. The border and zones are set up in the
        Titles tab of the Options Layers dialog.

     Borders
        A layer with its zoned border is shown in the following figure:




80                                                                                 P-CAD PCB User’s Guide
Documenting a Design with Document Toolbox                                  Chapter 5: Documentation Tools


       The display and structure of borders and zones can be unique for each layer.
       The default settings for borders is that the border relative origin is 500 mils in and up from the
       workspace origin, and the default border width and height is 1000 mils smaller that the workspace
       height and width (as specified on the General tab of the Options Configure dialog). If, for example,
       the workspace size has a height and width of 10000.0 mil, the default height and width of the title
       sheet border would be 9000.0 mil, and the bottom left of the border would be 500 mils in and up
       from the workspace origin.
       The following diagram shows these calculations:




       The border is added to the layer that is selected in the Layers field of the Titles tab of the Options
       Layers dialog. It is only displayed when this layer is the current layer.

       Zones
       The perimeter of the design can be divided into alphanumeric zones similar to those found on a
       road map. Zones can be displayed whether or not you have selected to display the border. These
       zones are useful for locating or referencing drawing objects.




P-CAD PCB User’s Guide                                                                                          81
Chapter 5: Documentation Tools                               Documenting a Design with Document Toolbox


        Zones use the dimensions of the perimeter set in the Borders area. Zone width is set by the size of
        the label text as shown in the illustration above.

        To include zones in a border, complete the information in the Zones frame on the Titles tab of the
        Options Layers dialog.

     Title Blocks
        Title blocks can be placed on any layer. Title blocks, one of the basic building blocks of a PCB Title
        Sheet, include design information such as Title, Author, Drawing Number, etc.
        Several PCB title block (.tbk) files are included with the P-CAD PCB Editor. These sample files can
        be used directly in your design, or modified to create new title block files. Custom title blocks can
        also be created.
        The title block assigned to each layer can be unique and is specified for the layer through the Titles
        tab of the Options Layers dialog.
        To specify the contents of the title block, you can place fields within the block. These fields can also
        be unique to each layer by assigning different field sets to the layers. When a title block includes
        placed fields, design information from the layer’s assigned field set is displayed for the field’s value.
        Design information used to complete the fields on the title block resides in the Fields tab of the File
        Design Info dialog.
        By saving the placed fields within a title block file, you eliminate time spent repeating field
        placement in standard locations and automatically display the appropriate field values in their
        correct locations when the title block is included in a new design or on another layer of the current
        design.

     Design Views
        In documenting your design you may want to place various sections of the design on a single page
        for illustration purposes. By using a Design View, you can place a view of a portion of the design
        into another location in the design or place this same view inside the workspace multiple times.
        You can also place a Design View in its original state and mirror the same view alongside the
        original.

     Revision Blocks
        A revision block includes details about differences between versions of a design. An example
        revision block is seen in the following figure:




        In Document Toolbox, a revision block is placed as a Revision Notes Table.




82                                                                                    P-CAD PCB User’s Guide
Documenting a Design with Document Toolbox                                   Chapter 5: Documentation Tools


   Fields and Field Sets
       Field values can be grouped into distinct field sets. Each field set can contain different design
       information such as title, author, drawing number, notes, etc.


                                      Field Set 1              Field Set 2               Field Set 3
        Author                   M.Smith                  M.Smith                 T.Miller
        Title                    Fabrication              Fabrication             Assembly
        Drawing Number           FB-863-01                FB-863-02               AS-863-01
        Approved By              L. Brown                                         N. Chapman


       From the Options Layers dialog you can assign a field set to a particular layer of your PCB design.
       The field’s values change based on the field set of the layer on which they are located.
       You may want to create an assembly and a fabrication drawing of your PCB design. You can create
       two nonsignal layers on which to create these drawings and assign each to a unique field set. The
       drawing number for each drawing can be unique, for example, since it will be specific to its field set
       as defined in the Fields tab of the File Design Info dialog.
       Design or revision notes can be placed to informatively explain details of the drawing. These notes
       are also field set specific.

   Drawing and Revision Notes
       Notes are used to annotate your PCB drawing. With drawing or design notes, you can clarify details
       of the design. With revision notes, you can document changes made between drafts or versions of
       the design.
       Drawing and revision notes can be specific to a field set. If you created an assembly and a
       fabrication drawing of your PCB design, the notes for each drawing can be specific to its field set.

   Defining Drawing or Revision Notes
       You can annotate your design by placing a drawing note. Drawing notes can be field set specific
       and can be assigned to a field set in the Notes tab of the File Design Info dialog.
       You can also include revision notes specifically pertaining to design changes or revisions. Notes
       pertaining to design changes should be included on the Revisions tab of the File Design Info
       dialog. Notes can later be included in your design by placing a note field or a note table. These
       notes can be annotated using the industry-standard symbols: box, circle or triangle.




P-CAD PCB User’s Guide                                                                                        83
Chapter 5: Documentation Tools                               Documenting a Design with Document Toolbox


        The following figure shows a Notes table with standard note symbols:




     Design Details
        A magnified view of a region of your board is called a detail. Document Toolbox allows you to
        include details directly in your design. A detail is a picture containing objects created in the PCB
        editor; it is a magnified copy of a selected PCB design region.

        Details are intended to be used in drawing. Therefore, they should not be items required in the
        final film artwork or translated to another product using DXF.

        A detail can be placed from a file or directly from the clipboard onto any nonsignal layer. An
        example of a detail is shown in the following figure:




        Details can be cut or copied from one location to the clipboard and pasted into another location.
        This graphical information can be placed in picture format on the PCB drawing by choosing the Edit
        » Paste Special command. If you choose the DocTool » Mirror on Copy command, the selected
        objects are copied in the opposite perspective of the display, as if viewing the design from its
        underside.

        Detail, diagram and picture objects are not mirrored when copied to maintain the orientation of
        annotation text.



84                                                                                   P-CAD PCB User’s Guide
Documenting a Design with Document Toolbox                                   Chapter 5: Documentation Tools


   Graphic Files
       A graphic file can be used to permanently store a graphic object, including a detail of your PCB
       design. The file can be used repeatedly to place the same image in multiple designs or on multiple
       layers. It can be retained on your computer for use at a later time. Graphic files are ideal for
       building an archive containing commonly used images.
       Graphic images can be created automatically from a block file (.blk). You can place these block
       files as details on the PCB drawing by choosing the DocTool » Place Detail command. When a block
       file is placed as a detail it loses its design intelligence and becomes a scaleable snapshot of a
       region. The layer information of the block file is removed and the detail resides only on the layer
       on which it is placed. You can also uses graphic files in picture format (.emf) to place a detail.
       These picture files can be placed by choosing the DocTool » Place Picture, DocTool » Place Detail
       or Edit » Paste from File commands.

       Detail Colors
       A detail exists on a single layer, as a picture of design objects, which may be located on multiple
       layers. To indicate the detail’s layer, all design objects within the detail are drawn in the line color
       of the active layer.

       Updating Details
       Details are not automatically updates when change are made to the design. Since the detail is
       generally imported from a file, the block file or picture file containing the board region must be
       replaced when the detail needs to be updated. The detail of the modified board region can then be
       placed from the new block file.
       You can resize, move or delete a detail after placement, but you cannot rotate or flip it. The detail is
       a single discrete unit; individual objects within it may not be sub-selected or modified. If you
       included a scale factor in the detail’s title or subtitle, you can modify the value to reflect the current
       scaling factor by selecting the detail and choosing the Edit » Properties command. Your changes for
       the title, subtitle, text style and scaling can then be applied in the Detail Properties dialog, or if
       placed using the DocTool » Place Picture command, in the Picture Properties dialog.

   Layer Stackup Diagrams
       A depiction of the stacking of board layers is used to annotate the board layers. The layer stackup
       diagram is displayed in one of two ways, as shown in the following figure:




P-CAD PCB User’s Guide                                                                                            85
Chapter 5: Documentation Tools                                  Documenting a Design with Document Toolbox




        The layer stackup diagram is placed by choosing the DocTool » Place Diagram command. Once
        placed a diagram may be resized, moved or deleted, but not rotated or flipped. The diagram is a
        single discrete unit; individual object within it may not be sub-selected.
        Diagrams are not automatically updated when changes are made to the design unless you choose
        specifically to update it. If the board layer arrangement has been modified, the layer stack-up
        diagram should be updated to reflect the current design information by selecting a single diagram
        and choosing the DocTool » Update command or selecting multiple diagrams and choosing the
        DocTool » Update All command.
        The title, subtitle, text style, diagram style scale factor and line width properties of the diagram can
        be modified. The scale factor, if included in the diagram’s title or subtitle, can be modified to reflect
        the current scaling factor by choosing the Edit » Properties command after selecting the diagram.

     Drill Tables
        A drill table maps the drill symbol displayed on the PCB design to its physical characteristics. The
        information contained within a drill table includes: the hole diameter, the symbol used to identify
        the drill hole, the number of holes of type in the design, and whether the hole is plated.
        A basic drill table is shown in the following figure:




        You can also include user-defined columns in the table, which may include any additional
        information you require.




86                                                                                    P-CAD PCB User’s Guide
Documenting a Design with Document Toolbox                                 Chapter 5: Documentation Tools


       The contents of a placed drill table is modified only when you specifically choose to update it.
       When the drill information of the current design is modified, the drill table should be updated to
       reflect the design changes. To update a particular drill tale, select the table and choose DocTool »
       Update. To update all tables choose DocTool » Update All.

       Updates cannot be undone.

       You can also select a drill table, choose Edit » Properties and make changes in the Table Properties
       dialog for the table’s line width, name and text style.

       The drill table is updated when its properties are modified.

   Associative Dimensions
       Dimensions are used to document the distance between objects in your PCB design. Dimensions
       can be associated with their objects, they can include tolerances and you can modify the various
       properties of a dimension.
       Associative Dimensions are intelligent about the objects they are documenting. When the
       dimension is placed it becomes associated with dimensioned objects. When one of the objects
       move, the dimension follows it and marks the new object separation. Associative dimensions are
       dynamically updated whenever the objects are moved, resized, rotated, flipped or modified. If one
       of the dimensioned objects is deleted, an associative dimension will also be automatically deleted.
       A dimension is placed by choosing the Place » Dimension command. Use the information on the
       Prompt Line to guide you through the placement process.
       For Baseline and Datum type dimensions, you can unwind the last action performed, using either
       the BackSpace key or the CTRL-BackSpace keystroke.
       Once a dimension has been placed it can be modified. Click once to select a dimension, the
       choose Edit » Properties from the menus to display the Dimension Properties dialog, where you can
       edit dimension properties such as Units, Layer, Precision and Tolerance. Note that the precision
       setting applies to the dimension units, the tolerance always displays with 4 decimal places (unless
       the Suppress Trailing Zeros option is enabled).

       You can make a dimension non-associative if you clear the Associated Dimension check box in the
       Dimension Properties dialog. Once this option is disabled the dimension has no intelligence about
       its dimensioned objects, and will not move when a dimensioned object is moved.

       The dimension arrow and text position can also be altered, to do this click once to select the
       dimension, then click and hold on the small handle that appears to reposition.




P-CAD PCB User’s Guide                                                                                        87
Chapter 5: Documentation Tools                                                           Printer & Plotter Setup



Printer & Plotter Setup
       When you choose File » Print Setup, the following Print Setup dialog appears. This dialog lists any
       printers and plotters that have been installed on your system.




       In the Print Setup dialog, select a printer from the Name list. Then, click Properties to configure
       print parameters. Because print parameters are device-specific, the dialog, which appears, will
       depend upon the printer you select. After you configure your print parameters, click OK.

       Plotting is similar to printing. For plotting, choose File » Print Setup. Like printers, plotter properties
       are device-specific and customized to the plotter driver you are using.


Printing
       When printing from P-CAD PCB, you have access to many useful features, such as:
       •   Multiple and batch print jobs. You can define unique print options for each print job. For
           example, you can include or exclude specific layers and objects, X and Y offset, and more.
       •   Color options. You can customize color output, if you are using a color printer.
       •   Drill symbol assignments. You can include both manual and automatic describe and assign
           options.
       •   Printing the current workspace display based on your current zoom settings.
       •   Specify the number of pixels used to print the minimum line width.




88                                                                                    P-CAD PCB User’s Guide
Printing                                                                          Chapter 5: Documentation Tools


                                                        File Print
                                                      (generate output)




                                Setup Print Jobs       Drill Symbols            Colors
                                     (options)         (manual assign)
                                                         (unassign)
                                                        (auto assign)



    Setting Up Print Jobs
           In this section you will create three different print jobs to practice a typical printing scenario. First,
           you will set up the options for each of the three print jobs, assign drill symbols, set color options,
           and then do a batch print of all three jobs.
           1.   Choose File » Print to open the following dialog.




           2.   Click Setup Print Jobs. The following Setup Print Jobs dialog appears.




P-CAD PCB User’s Guide                                                                                              89
Chapter 5: Documentation Tools                                                                          Printing




       In this dialog you can specify layers, objects, print regions, and other design print criteria for
       multiple print jobs. For this tutorial, leave the dialog open and continue with Job One: Board and
       Top Layers.

       Job One: Board and Top Layers
       This first print job example prints all copper on the Top layer. The entire design is printed.
       1.   Press the CTRL key and select the Board and Top layers from the Layers list.
       2.   In the Display Options frame, select the Pads and Vias check boxes.
       3.   In the Print Region frame, select the Design Extent check box.
       4.   Make sure the Board and Top layers are selected in the Layers list. Then, type the following in
            the Print Job Name text box: TOP
       5.   Click Add. The job named TOP appears in the Print Jobs list. Leave the Print Setup dialog open,
            and continue with Job Two: Board and Top Silk Layers.

       Job Two: Board and Top Silk Layers
       1.   Click Clear All.
       2.   Hold down the CTRL key and click Board and Top Silk in the Layers list. You will define the
            desired region for printing.
       3.   In the Display Options frame, select the RefDes, Pads, and Vias check boxes.
       4.   Clear the Design Extents check box and click Define Print Region. The workspace appears.
       5.   Hold down the left mouse button and drag it diagonally across the workspace to draw a
            bounding outline around the desired print region.


90                                                                                  P-CAD PCB User’s Guide
Printing                                                                          Chapter 5: Documentation Tools


           6.   Right-click or press ESC. In the Information dialog that appears, click Yes to confirm the
                coordinates of your selected print region.
                The Setup Print Jobs dialog appears with the corners of the selected region displayed in the
                Print Region box.
           7.   In the Print Job Name text box, type: TOPSLK
           8.   Click Add. TOPSLK appears in the Print Jobs list. Leave the Print Setup dialog open and
                continue with Job Three: All Layers.

           Job Three: All Layers
           1.   Click Set All to highlight all the layers in the Layers list. The entire design will be printed with
                the output scaled to fit exactly to a page.
                You can also select all layers using the layer sets feature. Select All Layers from the Layer Set list
                and click Apply Layer Set.
           2.   Select the RefDes, Pads, and Vias check boxes.
           3.   Select the Design Extent and Scale Fit to Page check boxes.
           4.   In the Print Job Name text box, type: ALL
           5.   Click Add. ALL appears in the Print Jobs list.
           Now that you have set up your three print jobs, click Close to exit the dialog. In the File Print dialog,
           the following print jobs appear in the Print Jobs list: TOP, TOPSLK, and ALL. Leave the File Print
           dialog open and continue with Assign Drill Symbols.

    Assign Drill Symbols
           In the File Print dialog, click Drill Symbols. The following Drill Symbol Assignments dialog appears.




P-CAD PCB User’s Guide                                                                                                 91
Chapter 5: Documentation Tools                                                                       Printing


       P-CAD PCB includes alpha-character drill symbols (upper and lowercase). This feature makes it
       easier for you to provide manufacturing documentation. It also emulates Master Designer's drill
       symbol assignment feature, so anyone used to Master Designer will have little trouble
       documenting drill holes in P-CAD PCB.
       The available drill symbols are as follows:
       •    Uppercase characters A-Z, except T, X, and Y. P-CAD PCB already allows these as graphic
            shapes.
       •    Lowercase characters a-z, except x.
       These drill symbols appear toward the bottom of the Drill Symbols list in the Drill Symbol
       Assignments dialog.
       The printed, Gerber, and DXF output files display the new drill symbols as described in the
       following list:
       •    All drill symbols are printed in the default text style.
       •    The character size is approximately the same as the drill size you specify.
       •    The text stroke width is consistent with the appearance of drill symbols.
       •    The text character is centered on the location of the drill hole.
       The DBX applications, and Drilltab.dbx, also recognize the drill symbols and can handle them
       accordingly.

       Automatic Assign
       To assign all drill symbols automatically, click the Automatic Assign button in the Drill Symbol
       Assignments dialog. You can click Unassign All to clear everything, or Unassign to clear the hole
       diameter that is highlighted.
       The list of this dialog displays the hole diameters of the loaded design file and any drill symbol
       assignments that may exist for those hole diameters, allowing you to view which items are assigned
       and what those assignments are.
       In the Drill Symbol Assignments dialog, click Automatic Assign to automatically assign a drill
       symbol to each hole diameter in the design.

       Manual Assign
       To make manual drill symbol assignments:
       1.   Select 18.0 mil in the Hole Diameter list.
       2.   Select Diamond_X from the Drill Symbols list.
       3.   Click Assign. Diamond_X appears next to 18.0 mil in the list.
       4.   Click Close.




92                                                                                  P-CAD PCB User’s Guide
Printing                                                                        Chapter 5: Documentation Tools


           The File » Print and File » Export » Gerber features share common drill symbol assignments; when
           symbols are assigned in one, they will apply to the other.

    Setting up Print Colors and Other Options
           You can define colored, grayscale, or monochrome printer settings. You can also set the printed
           size of different reference points in a design. To set up print colors and other options, follow these
           steps:
           1.   Choose File » Print. The File Print dialog appears.
           2.   Click the Colors button to open the Printer Options dialog. This dialog contains two tabs:
                Colors and Miscellaneous. You can make changes in these tabs without affecting your Options
                Display settings.

                The Printer Options dialog is similar to the Options Display dialog. However, changes to your
                printer options do not affect your options display settings.

           3.   Click the Colors tab, then choose print colors using one of these methods:
           4.   If you have a color printer, click the appropriate buttons and choose a color from the color
                palette that appears.
           5.   If you have a black and white printer, click the Defaults button. This turns all colors to
                monochrome. We recommend that you use the default settings to avoid undesirable output
                when color settings are converted to grayscales.
           6.   Click OK to close the Print Options dialog. You return to the File Print dialog.
           For more information about the options in the Colors or Miscellaneous tab, see Options Display
           (page 442).

    Batch Print
           In the File Print dialog, you should now see the three print jobs listed. To set up batch printing,
           follow these steps:
           1.   Click Set All to select all three print jobs.




P-CAD PCB User’s Guide                                                                                           93
Chapter 5: Documentation Tools                                                                          Printing




       2.   Click Print Preview to verify that the output is what you want to print.
       3.   Click Generate Printouts, to print the jobs with the specifications that you set earlier.
       4.   Click Close to exit the dialog.
       When you close the File Print dialog, the three print jobs that you have created are saved.




94                                                                                     P-CAD PCB User’s Guide
                                                                                      CHAPTER               6


                                                                                        Routing

Routing Features
       This chapter contains information on how to select a router and set up your design for routing. It
       also explains how to perform manual, interactive, and miter routing in P-CAD PCB, and details
       using the advanced features such as Route Bus, Route MultiTrace, Route Fanout, Maximize
       Hugging, Minimize Length and Visible Routing Area..
       The section titled General Routing Features, (page 103) details features available with both manual
       and interactive routing.
       The table below shows which button accesses each of the routing tools:


        Click this button                          To access this routing tool:
                            Route » Manual: Runs the Route Manual tool. This tool allows you to
                            manually route and reroute existing connections or net copper items.
                            Route » Interactive: Runs the Route Interactive tool. This tool provides
                            obstacle avoidance, copper hugging, and intelligent route completion.
                            Route » Miter: Performs mitering. This tool converts square corners on
                            routed connections into mitered corners, tangent arcs, or T-routes using
                            an angle of your choice.
                            Route » Bus: Runs the Bus Route tool. The Bus Route tool allows you to
                            specify several connections to be guided simultaneously as a bus.
                            Route » MultiTrace: Runs the MultiTrace Route tool. The MultiTrace
                            Route tool allows you to specify several connections to be routed
                            automatically.
                            Route » Fanout: Runs the Fanout routing tool. The Fanout Route tool is
                            used for the systematic placement of fanout traces from a PCB
                            component. These traces can then be used by Bus Route as a start or




P-CAD PCB User’s Guide                                                                                       95
Chapter 6: Routing                                                                   Selecting a Route Tool


                           termination point.
                           Maximize Hugging: The Maximize Hugging feature sets trace placement
                           to hug obstacles between routes. This feature is used with the
                           InterRoute, Fanout Route, Bus Route, and MultiTrace Route tools.
                           Minimize Length: The Minimize Length feature sets trace placement to
                           seek the straightest line between routes. This feature is used with the b,
                           b, Bus Route, and MultiTrace Route tools.
                           Visible Routing Area: The Visible Routing Area feature analyzes the
                           design rules and displays the available routable area on your workspace.
                           This feature is used with the InterRoute and Bus Route tools.



Selecting a Route Tool
       When selecting a route tool, consider the board design, design rules, and the desired final trace.
       •   Manual Route is a flexible tool that allows you to place traces precisely. An individual trace can
           be routed along an arc, at any angle, and into loops. You can also T-route from an existing
           trace. Traces need not obey clearance rules, although online DRC is available. The flexibility of
           Manual Route is particularly useful for analog boards.
       •   Interactive Route is a more intelligent tool that allows you to place traces while obeying the
           clearance rules of the design. Routes can be completed automatically, hugging obstacles and
           entering pads as directed.
       •   Miter Route is a specific tool for easily creating 45 degree angles or arcs out of routed corners
           or T-junctions.
       •   Bus Route is ideal for situations with a one-to-one correlation of pins and no obstructions, as
           when routing to an edge connector. With Bus Route, you seemingly route a single, wide trace
           and all selected connections follow.
       •   MultiTrace Route automatically routes selected connections. It is ideal for regions of the
           design with collinear connections, which may or may not have obstacles; it can speed
           repetitive tasks without requiring user intervention. The placement of the traces can be
           steered by setting options such as minimum length, maximum hugging, and orthogonal mode.
           With MultiTrace, each trace is routed individually and automatically.
       •   Fanout Route allows you to specify a fanout configuration for a collection of connections as
           they exit from the pads of a PCB component.
       •   Maximize Hugging allows you to set trace placement to hug obstacles.
       •   Minimize Length lets you set trace placement to seek the straightest line between routes.
       •   Visible Routing Area analyzes the design rules and displays the available routing area on the
           workspace.




96                                                                                 P-CAD PCB User’s Guide
Routing Setup                                                                             Chapter 6: Routing


       MultiTrace, Fanout, and Bus Route tools route only on a single layer. When using Push Traces,
       Interactive route tool routes on a single layer unless you change layers, causing a via to be placed.


Routing Setup
       This section provides information on some basic setup functions you should perform before
       routing.

   Opening a File
       To open a design file, choose File » Open. If you want to backup your work before you make
       changes, choose File » Save As and save the file to a different name.

   Placing Connections
       Before routing, you must have already placed components and placed connections between the
       component pads (net nodes). To place connections, choose Place » Connection or click the toolbar
       button.
       For more information see Place Connection (page 377).

   Setting your Grids
       You need to set your grids for easier and more efficient routing. There are many different ways to
       set up grids depending on what is appropriate for your particular design. For through-hole designs,
       a typical Absolute grid spacing is 25 mils. For surface mount or mixed boards, the grid spacing
       selected should be appropriate for the pad spacing.
       For example, you may want to set the Absolute grid spacing to 25 mils and the Relative grid spacing
       to 8.3 mils.
       1.   Choose Options » Grids to open the following dialog.




       2.   In the Visible Grid Style frame, do the following:
            •   Select the Visible check box.
            •   Choose the Dotted button.



P-CAD PCB User’s Guide                                                                                         97
Chapter 6: Routing                                                                              Routing Setup


        3.   In the Mode frame, choose Absolute.
        4.   In the Grid Spacing text box, type: 25 OR select 25 from the Grids list box.
        5.   Now, choose the Relative button in the Mode frame.
        6.   In the Grid Spacing box, type 8.3 OR select 8.3 from the Grids list box. The relative grid origin
             can be set to any (x,y) coordinate relative to the absolute grid origin at the lower left hand
             corner of the workspace (0,0).
        7.   Click OK.

     Status Line Grid Toggle
        When you switch between Relative             and Absolute       , you will activate 8.3 mil and 25 mil
        grids, respectively. On the Status Line, switch between these two modes by clicking the Grid toggle
        button and see how the visible dotted grids change. The button appears as Rel and has a colored
        background when in Relative mode; it appears as Abs when in Absolute mode. The value of the
        relative or absolute grid setting appears next to it.
        For more information see, Options Commands (page 423).

     Changing Layers
        You need to be able to change layers easily while you are routing.
        The current layer name (e.g., Top) as well as the designated layer line color appear together on the
        Status Line at the bottom of your screen. The layer color is located between the layer combo box
        and up and down arrows (a reduced scroll bar) where you can view and change between the
        enabled layers (making another layer the current layer).
        To change to another layer you need only select it from the combo box or the select the layer line
        color by clicking the up and down arrows.

        Status line layer control
        To add, delete, enable, or disable layers (which affects the list of layers in the combo box on the
        Status Line), choose the Options » Layers command. It's better not to enable more signal layers
        than you will immediately need; this is to avoid having to cycle through too many existing layers.

        Since you can only route on signal layers, make sure that the signal layers you want to route on are
        enabled. Then when you want to change layers, you can press the L and SHIFT+L keys to switch
        between the signal layers. When you are using a route tool, the L key will switch between signal
        layers.

        For more information, see Options Commands (page 423).

     Setting Line Width
        The line width for placing lines and routing is determined by the default current line width. You
        have two ways to change line width:




98                                                                                  P-CAD PCB User’s Guide
Routing Setup                                                                             Chapter 6: Routing


       •    Choosing Options » Current Line.
       •    Select a width from the Line Width list box in the Status Line.
       Changing line width affects subsequent line drawings only and has no effect on existing lines.
       However, it does affect the thickness of any lines or arcs you use with the route tools, unless the
       net or net class has a WIDTH attribute.

       You can change the line thickness of an existing arc or line with Edit Properties. Line width settings
       do not affect the appearance of polygons, keepouts, copper pours, connections, etc.

       To set the default line width
       1.   Choose Options » Current Line to open the following dialog.




       2.   In the Line Width text box, type: 10 mil. Or select 10 mil from the list.
       3.   Click OK. Subsequent lines will be 10 mils wide.
       For more information see Options Current Line (page 457).

   Setting Up Via Style
       You can set up your via styles ahead of time before you place vias or before routing. Vias are placed
       automatically when you change layers in the middle of routing a segment.
       The following section contains an example of setting up a simple via. For more information on
       setting up vias, see Options Via Style (page 482).
       The route tools use the current via style unless you have a VIASTYLE attribute defined on the net or
       net class that you are routing.
       1.   Choose Options Via Style to open the Options Via Style dialog. This dialog allows you to add
            new styles, delete non-default styles, view the default via style, or modify a non-default via
            style.




P-CAD PCB User’s Guide                                                                                       99
Chapter 6: Routing                                                                               Routing Setup




        2.   Add a new via style based on (Default). Click Copy to open the following Copy Via Style dialog.




        3.   Type the new name (e.g., vianew) in the Via Name box and click OK. You return to the
             Options Via Style dialog.
        4.   Since the via style is simple, you can change the characteristics of vianew by selecting it in the
             list box and clicking Modify (Simple).




100                                                                                   P-CAD PCB User’s Guide
Routing Setup                                                                               Chapter 6: Routing




       5.   If the via style is complex, you can change the characteristics of the new via by selecting it in
            the list box and clicking Modify (Complex).




       6.   Click OK to close the Modify dialog and save any changes you made to the style. Click Close to
            exit Options Via Style.

   Orthogonal Modes (O key)
       You can press the O key to switch between the orthogonal modes while placing lines during
       manual routing. You can enable/disable certain orthogonal modes in the Route tab of the Options
       Configure dialog. The available orthogonal modes are provided as three mode pairs and a Tangent
       Arc mode. The mode pairs supply a total of six modes (three types, with two variations on each
       type). The F key flips the mode between the angles in the current mode pair.
       For more information, see Options Commands (page 423).

   Fixed Routable Objects
       The Edit menu includes three commands that allow a specific set of objects to be fixed in their
       design locations, which is especially useful during routing. The three commands are: Fix, Unfix and
       Unfix All. To fix an object first select it, then choose Edit » Fix » Fix from the menus.
       The following objects are all fixable within your design:



P-CAD PCB User’s Guide                                                                                          101
Chapter 6: Routing                                                                    Point-to-Point Routing


       •   Arcs
       •   Lines
       •   Pads (Free)
       •   Vias (Free)
       •   Test Points
       •   Copper Pours
       •   Components
       Once an object is fixed, it cannot be moved, rotated, flipped, cut, resized or deleted. A fixed object
       is displayed in the Fixed object color (setup in the Options Display dialog).
       The following commands will be ignored by a fixed component:
       •   Change Pattern
       •   Move
       •   Move by RefDes
       •   Rotate
       •   Flip
       •   Delete
       •   Cut
       •   Component Type Replacement
       •   Explode Component
       •   Align Component (PCB Only)
       •   Force Update (PCB Only)

Point-to-Point Routing
       To help ensure design integrity, PCB distinguishes between routes that provide a complete
       electrical connection and those that are physically connected but, depending on the manufacturing
       technique, may yield a less than satisfactory electrical connection on the finished board. A trace is
       point-to-point routed if the overlap at the trace endpoint between the trace and net copper to
       which it connects is at least half of the trace width. This includes lines and arc traces routed to
       copper polygons, pads, vias, or other traces.
       The DRC Unrouted Nets report includes a warning for those objects that are not point-to-point
       connected. The warning includes the location of the objects not satisfying point-to-point
       requirements.
       The Utils » Load Netlist, Utils » Optimize Nets, and Utils » Reconnect Nets commands generate PCB
       connections between those objects that are physically connected but not point-to-point routed.




102                                                                                P-CAD PCB User’s Guide
General Routing Features                                                                   Chapter 6: Routing



General Routing Features
       The following sections summarize the special features of P-CAD PCB that you will find useful while
       using the manual or interactive routing tools.

   Status Line Information
       The right side of the Status Line displays the orthogonal mode, measurement and net name
       information while you are routing.

   T-Routing
       To invoke T-routing, press the SHIFT key while the manual or interactive route tool is enabled. The
       mouse operations are the same for T-routing as they are for reroute: click (initiate), drag
       (rubberband), release (commit). Using the T-Route by Default option in the Route tab of the
       Options Configure dialog, you can T-route without pressing the SHIFT key.
       When selecting a trace, there are two possible ways to initiate the route depending on the T-route
       mode: If T-routing is disabled, the selection is treated as a reroute. If T-routing is enabled using the
       SHIFT key, the tool starts a T-route whereby the selected trace is broken at the selection point
       (unless that point is an endpoint) and routing continues with a new trace anchored at the selection
       point.
       A connection line is created from the selection point to the nearest, unconnected node to guide
       you in completing the route. When routing into a trace, the intersecting line is broken at the
       selection point. Just because this feature is called T-routing does not imply that it only works for T
       shaped intersections. Routing is permitted to and from any existing net traces on the board.




                                              Nearest Node


   Routing with Curved Arcs
       Curved traces can be incorporated into a route segment by enabling one of the Orthogonal Modes
       in the Options Configure dialog. The radius of the arc is controlled through the Options » Current
       Radius command or by selecting the desired radius from the Radius combo box on the Status Line.
       The ortho mode is displayed on the Status Line along with the net and measurement information.
       The current radius is used to determine the curve of the arc while maintaining tangency between
       the two line segments and the arc.
       You can modify or move a tangent arc by using the Miter tool. With the Miter tool active, grab the
       arc and drag it until the desired radius is achieved.
       The available orthogonal mode pairs are described below:




P-CAD PCB User’s Guide                                                                                      103
Chapter 6: Routing                                                                General Routing Features


       90/90 Line-Line
       Both lines are either horizontal or vertical (displayed perpendicular to each other). For long, the
       first segment is always longer than the second. For short, the first segment is shorter. You can
       switch between the two by pressing the F key.




       45/90 Line-Line:
       You can switch between the two modes by pressing the F key. The first mode makes the first
       segment display at a 45 degree angle and the second segment is either horizontal or vertical. The
       second mode makes the first segment either horizontal or vertical and the second segment is
       displayed at a 45 degree angle.
       If the plow mode is enabled during routing, the 45/90 Line-Line orthogonal mode is the only
       orthogonal mode available.




       90/90 Arc-Line
       You can switch between two modes by pressing the F key. The first mode makes the first segment
       display as an arc and the second segment is either horizontal or vertical. The second mode makes
       the first segment either horizontal or vertical and the second segment is displayed as an arc.




       Tangent Arc
       A curved arc can be incorporated into a route segment when Tangent Arc is the current orthogonal
       mode. To change the current radius, choose the Options » Current Radius command or the Radius
       combo box on the Status Line, is used to determine the curve of the arc while maintaining tangency
       between the two line segments and the arc. Once placed, the arc can be moved or modified by
       using the Miter tool, which allows you to grab and drag an arc handle to a new radius. If the radius
       is set to None, the maximum radius is used.

                                   r
           r




104                                                                                P-CAD PCB User’s Guide
General Routing Features                                                                   Chapter 6: Routing


       Drop Via
       When the plow mode is turned on during routing, you can place a via by choosing Layers in the
       shortcut menu. In the Options Layer dialog, select the layer on which the via should be placed and
       click Close. The next mouse click in the design places the via on the via grid closest to the current
       point as long as no violation with a fixed object exists. The probe continues from its current
       location to the center of the dropped via and the trace is laid.

   Unwind
       If you make a mistake, you can press the BACKSPACE key and the previous route action will
       unwind (disappear). Each press of the BACKSPACE key backs up to the previous point. A right click
       ends the temporary route mode, and you can then select another connection to route.
       To unwind segments that are connected by vias between layers, the BACKSPACE key will treat each
       via as a segment, automatically deleting it with a keystroke.

   Backtracking
       Committing a straight line segment on top of another straight line segment, backtracking, acts as an
       erase operation and the intersection of the two lines is removed.
       Vias cannot be erased with backtracking. You need to perform an unwind operation.
       Backtracking detects only lines that precisely trace back over previous lines and only during the
       routing operation. No backtracking is performed for lines already existing in the design.

   Routing to Free Copper
       Routing to the center of a pad, via, or the endpoint of a line that is not part of any net adds that item
       to the net being routed. This occurs as each route operation is completed, without choosing the
       Utils » Reconnect command or the Utils » Reconnect Nets option in the Utils » Load Netlist
       command.
       To add other objects (arcs and polygons) to the net, choose Utils » Load Netlist with the Reconnect
       Copper option enabled, or use the Utils » Reconnect Nets command after the routes intersecting
       free copper have been completed. Polygons and arcs maintain full net information and correctly
       remove connections after they are added to a net.

   Changing Layers
       To change to a different layer while routing press the L key, SHIFT+L keys, or use the Layer combo
       box. A via is automatically placed to connect the layers and the line from that point reflects the new
       color of the layer.

   Trace Cleanup
       When you choose the Utils » Trace Clean-up command, redundant trace segments (collinear and
       overlapping) and extra vertices are removed before the traces are added to the design. Trace
       cleanup also occurs between newly routed traces and preexisting traces.




P-CAD PCB User’s Guide                                                                                       105
Chapter 6: Routing                                                              Manually Routing Connections


      Overlapping Connections
        When connection lines overlap over a pad, priority is given to the connection line that has the
        same net ID as the pad. Priority is also given to SMD pads that are defined on the current layer.

      Copper Pours and Routing
        If the Auto Plow Copper Pours check box in the Options Configure dialog is selected, Copper
        Pours affected by new copper generated by these tools will autoplow when the route completes or
        suspends.


Manually Routing Connections

             The Manual Route tool allows you to place traces precisely. An individual trace can be routed
        along an arc, at any angle, and into loops. Traces need not obey clearance rules, although online
        DRC is available.
        The following section contains information specific to the Manual Route tool. See General Routing
        Features (page 103) for information common to both Manual and Interactive Route commands.

      Manual Routing Steps
        1.   Zoom in so that the unrouted connections are large enough to select. To zoom in, press the +
             key, the Z key, the Zoom button on the toolbar, or choose one of the View » Zoom commands.
        2.   Choose the Route » Manual command or click on the Route Manual toolbar button.
        3.   Change to the Top (signal) layer to begin routing. Press the L key to switch to the Top layer (or
             use the layer combo box or layer line color arrows on the Status Line).
        4.   Click directly over a connection near a pad where you want the manual routing to begin.
             Release at a location where you want the first vertex (you can see the color change in the
             segment you routed). Then click at the location you want for the third vertex. Press the O key
             to switch to the appropriate 45 degree orthogonal mode (in effect creating the second vertex).




        First Vertex                                          Third Vertex
        Click again at the location for the fifth vertex; the orthogonal mode will create the fourth vertex for
        you. Wherever you click, the route line follows, each click becoming a point where you can create a
        routing angle or change direction. The F key switches between pairs of the orthogonal mode.
        Notice, while routing, that part or all of the net is highlighted in the current highlight color. In the
        Route tab of the Options Configure dialog, you can select which items are highlighted in the
        Highlight While Routing box. Item highlight options are Pads Only or Pads, Traces and
        Connection.




106                                                                                    P-CAD PCB User’s Guide
Manually Routing Connections                                                               Chapter 6: Routing


       If you want to use the keyboard instead of the mouse, move the cursor over the connection (arrow
       keys or SHIFT+arrow keys), press the SPACEBAR, move the cursor to move the route, then press
       the SPACEBAR again to place the routed segment.

   Terminating a Route
       To terminate a route, you can choose do one of the following:
       •   Complete the remainder of the trace by right-clicking or pressing ESC.
       •   Stop routing without completing the trace by pressing one of the SLASH keys.
       The behavior of the right-click and the SLASH key can be switched using the Route tab in the
       Options Configure dialog.
       When you drag the trace over its termination pad, a diamond shape appears. The diamond symbol
       represents a zero length connection. It disappears when the connection is completed.

       If the diamond shape remains after completing the connection, it indicates the pad you are routing
       to is on a different layer than the end of the route.

       Right Mouse Button
       To route the remainder of a connection (in a straight line all the way to the next node), right-click.
       You can then left-click over another connection segment to begin routing it.
       If the current endpoint of the trace being routed is point-to-point with an object belonging to the
       same net (pad, via, line, or arc) pressing the right mouse causes the route to be recognized as
       completed, ending the route. The routing guide connection (the remaining connection displayed
       during manual routing) is not replaced with a line trace to the original guide connection
       destination point when the right mouse button is pressed. The guide connection will be updated as
       appropriate.
       The exception to this behavior occurs when routing to a pad that is the endpoint of the current
       guide connection. Right-click or press ESC to complete the route to the pad center.
       This behavior can be switched with the SLASH key as described in the following section.

       Slash Key
       The BACKSLASH and FORWARD SLASH keys stop a route in mid-connection without adding a final
       copper segment. An unrouted connection remains attached to the last routed segment. Both back
       and forward slashes stop a route.
       When the Optimize Partial Route check box is selected in the General tab of the Options
       Configure dialog, you can press the SLASH key during manual routing to terminate the route and
       cause the guide connection line to connect to the nearest net endpoint, if the net doesn’t have an
       OPTIMIZE=NO attribute.
       This behavior can be switched with the right mouse behavior using the controls in the Manual
       Route frame in the Route tab of the Options Configure dialog.




P-CAD PCB User’s Guide                                                                                      107
Chapter 6: Routing                                                                        Interactive Routing


      Arc Routing
         The arc orthogonal modes can be used in an area where arcs will make routing easier; you can
         change between different modes while you are routing.
         An orthogonal mode is in effect until you change it to a different one. Choose Options » Configure,
         click the Route tab, and select the 90/90 Arc-Line and Tangent Arc check boxes in the Orthogonal
         Modes frame. To switch between orthogonal modes, press the O key.

      Orthogonal Modes
         While routing, you can practice using the orthogonal modes. Use the Options » Configure
         command to enable them.
         Pressing the O key gives you the ability to gain access to the modes enabled in the Options
         Configure dialog.
         Three of the orthogonal modes are provided in mode pairs of 90/90 Line-Line, 45/90 Line-Line and
         90/90 Arc-Line. Press the F key to switch between the pair settings. The fourth orthogonal mode is
         the Tangent Arc mode, which provides access to available radii used in curved arc routing. When
         you press the F key, Tangent Arc mode is ignored. When the plow mode is enabled during routing
         the only orthogonal mode available is the 45/90 Line-Line mode.
         For more information regarding orthogonal modes, see PCB Basics (page 17).


Interactive Routing

               Choose Route » Interactive to gain access to a powerful P-CAD Interactive route tool.
         Interactive routing provides design rule intelligence to avoid obstacles, copper hugging, pad entry,
         and automatic route completion.
         The following section contains information specific to the Interactive route tool. See Manually
         Routing Connections (page 106) and General Routing Features (page 103) for information common
         to both Manual and Interactive Route commands for information common to both Route Manual
         and Route Interactive.

      Interactive Routing Steps
         To route connections with Interactive route tool, follow these steps:
         1.   Choose Route » Interactive or click the Route Interactive button on the Route toolbar.
         2.   Pick a connection to route. The end closest to the point where the connection is selected
              becomes the source point; the other end becomes the destination point. Notice that part or all
              of the net is highlighted in the current highlight color. In the Route tab of the Options
              Configure dialog, you can select which items are highlighted in the Highlight While Routing
              box. Item highlight options are Pads Only or Pads, Traces and Connection.
         3.   The Interactive Route tool rubberbands uncommitted copper with the proper net width and
              design rule clearances from the source point to the position of the cursor. The rubberbanding



108                                                                                 P-CAD PCB User’s Guide
Interactive Routing                                                                        Chapter 6: Routing


             copper tracks around obstacles, maintaining the proper design rule clearances for that net,
             from the point of origin to the cursor position. While you are moving the cursor, a connection
             rubberbands from the cursor to the second node of the connection, indicating what remains to
             be routed.
        4.   When you click a coordinate that is not the destination node, the previously uncommitted
             lines are placed on the board.
        5.   Right-click to open the Interactive Route shortcut menu and choose Complete. The trace will
             automatically complete.

             If there is an obstruction requiring a layer change, you will hear a beep. The trace remains
             incomplete.


                                                     OR

             Continue until you click a node that is the other end of the rubberband (this could be a pad,
             via, line, arc, polygon or copper pour island). The route completes automatically.
        6.   You are now free to choose another connection to route or cancel the tool.

    Obstacle Hugging
        Track segments follow the shortest path from start point to end point, hugging obstacles to within
        the clearance amount set using the Options Design Rules dialog.
        The routing area takes into account the following design rules, net attributes, and net class
        attributes: Clearance, PadToPadClearance, PadToLineClearance, LineToLineClearance,
        ViaToPadClearance, ViaToLineClearance, and ViaToViaClearance.
        A clearance indicator displays if you try to route through an obstruction. The clearance indicator
        appears as a semicircle with a radius showing the clearance amount between the object being
        routed and the obstruction.
        The router always routes on grid, except for off-grid pads where the route is centered on the pad
        but ends on a grid point.

    Pad Entry or Exit
        Pad entry or exit is calculated from the pad’s center regardless of whether or not the pad is on-grid.
        The stub length, set from the Route tab of the Options Configure dialog, lets you set the minimum
        number of grid points from the pad’s outside edge for the first track you route.
        When entering a surface mount pad, always place the trace to the pad parallel to the bias of the pad
        and aligned with the pad center.

        Fanouts
        When routing off-grid pad and via fanouts, the interactive routing tool routes a stub in the direction
        of the cursor of a length (stub length) at least as long as that specified in the Route tab of the




P-CAD PCB User’s Guide                                                                                       109
Chapter 6: Routing                                                                          Interactive Routing


        Options Configure dialog. If the cursor position is closer to the pad than the stub length, no stub is
        created; the route simply starts at the pad center and ends at the cursor position.

                                 90 Degree            45 Degree
        Major axis stubs         orthagonal mode      orthagonal mode




        Stubs for pads with matching width and height (e.g., round, square) are routable in four (90 degree
        orthogonal mode) or eight (45 degree orthogonal mode) directions.




        Stubs for elongated pads (e.g., rectangle) route along the major axis only. Stubs on off-grid pads go
        from the pad center and remain off-grid until the cursor position is reached and then snap first to
        the closest grid line. The remainder of the route (from the stub endpoint to the cursor) ends on a
        grid point because the cursor is always on-grid. Entering a pad with a route follows the same logic
        as leaving a pad. Stubs always go to pad center.

        Polygonal Pads


                           Polygonal pad shapes are supported by the Interactive route tool. However, edges that
                           are not 45 or 90 degrees won't hug closely.



      Terminating a Route
        To terminate a route with the interactive router, you can choose to:
        •    Route to the termination of the connection.
        •    Complete the remainder of the trace automatically (right-click and choose Complete from the
             shortcut menu).
        •    Stop routing without completing the trace (press the SLASH keys).




110                                                                                   P-CAD PCB User’s Guide
Miter Routing                                                                             Chapter 6: Routing


        When you drag the trace over its termination pad, a diamond shape appears. Then, you have
        reached the connection destination. The diamond symbol represents a zero length connection. It
        disappears when the connection is completed.

        If the diamond shape remains after completing the connection, it indicates the pad you are routing
        to is on a different layer than the end of the route.

        Complete
        Right-click and choose Complete from the shortcut menu to automatically complete the remaining
        portion of the route. The design rule intelligence of the Interactive Route tool neatly hugs obstacles
        along the trace path.

        Suspend
        Routing can be suspended by pressing the BACKSLASH or SLASH key and the unrouted portion
        becomes a new connection from the suspension point to the end node.

    Loop Removal
        The Interactive Route tool looks for loops in routed traces. If one is encountered, the loop, along
        with any resulting floating copper is removed.


Miter Routing
             The Route » Miter command converts corners on routed connections into arcs or T-routes.
        You can also use the Miter tool to miter T junctions and modify existing mitered T junctions.

        The line width must be the same for the connecting segments in order to miter a corner.

    Using the Route Miter Tool
        To use the Route Miter tool, follow these steps:
        1.   Select a corner style by choosing a button in the Miter Mode frame in the Route tab of the
             Options Configure dialog.
        2.   To create a curved, mitered corner, click and hold on the corner that you want to miter (see A
             in the following figure). Drag to create the mitered corner (see B in the following). Don't
             release the mouse button until you have the proper length of mitering.

             You cannot miter non-net traces.




P-CAD PCB User’s Guide                                                                                     111
Chapter 6: Routing                                                                               Miter Routing


             45 Degree Corner




                 A                          B

        3.   To create a 90 degree arc miter, click and hold on a 90 degree corner (A in the following figure),
             then drag to create the arc (B in the following figure). Release the mouse button when you
             have the arc miter that you want.
             90 Degree Arc




                 A                          B

        4.   For creating a T miter, click and hold on a selection point (A in the following figure), then drag
             to create the T miter (B in the following figure). Release the mouse button when you have the T
             miter that you want.
             T Miter with 45 degree Arc Miter Option




                     A                                    B

        5.   To create a corner whose degree is not 45 or 90, enable the Tangent Arc orthogonal mode in
             the Options Configure dialog. In the Properties dialog, enable the Show Fillet Handles option.
             Then grab and drag the corner’s fillet handle (A) until the desired radius is achieved (B). The
             illustration on the right shows how the ghosted lines of the tangent corner are displayed as
             you move the cursor in the workspace.




                 A                          B

        6.   To cancel a ghosted miter, right-click.




112                                                                                 P-CAD PCB User’s Guide
Modifying Routes                                                                         Chapter 6: Routing


   Orthogonal Modes
       While miter routing, you can toggle between the mode pairs by pressing the O key. Only 45 degree
       line miters are supported for T-routes.


Modifying Routes
       The following is a list of how to perform certain modifications to already routed segments.


        Modify Line                  You can select a segment or multiple segments, then click the right
                                     button and choose Properties from the popup menu to invoke the
                                     Line Properties dialog, where you can change the line width.
        Reroute                      Manual and Interactive route allow you to route the selected
                                     segment as if it were a connection. If you pick the exact junction of
                                     a connection and a routed segment, it will tend to choose the
                                     connection to route rather than rerouting the copper. Miter route
                                     allows you to alter the corners where traces meet.
        Edit Select and Move         Select the copper segment (Edit Select); while it is selected, click
        (moving an existing          and drag the copper to its new location. You can also rotate a
        routed, or copper,           copper segment by pressing the R key (90 degrees) while the
        segment)                     segment is selected. SHIFT+R will rotate, using the angle set in
                                     Options Configure. To undo the move or rotation, press the U key.
        Delete copper                Select the routed segment (Edit Select); press the DEL key, and the
                                     segment reverts back to a connection (displayed in whatever the
                                     connection color is) if a connection is necessary. If the Optimize
                                     after Delete option in the Options Configure dialog is enabled, and
                                     the net doesn’t have an OPTIMIZE=NO attribute, the connection
                                     added is added in an optimized manner.
        Delete connection            After you delete a routed segment and it reverts to a connection,
                                     you can select the connection and delete it completely. Caution
                                     this is a drastic move because the connections in the design will no
                                     longer match the netlist.
        Leave a partial net          If you want to leave an unfinished piece of copper (part
                                     connection, part copper), use the SLASH or BACKSLASH key. For
                                     manual routing, this behavior can be switched with the right mouse
                                     behavior using the Route tab of the Options Configure dialog.



Route Bus
       Choose Route » Bus or click the Route Bus toolbar button to enable the Bus Route tool. The Bus
       Route tool allows you to specify several connections to be guided simultaneously as a bus.




P-CAD PCB User’s Guide                                                                                       113
Chapter 6: Routing                                                                                  Route Bus


        The Bus Route tool is design rule intelligent. It allows you to guide the placement of a collection of
        traces. It is ideal for a board region containing signals that feed in the same direction, such as
        routing to an edge connector.
        With Bus Route you can pre-select a group of nets. The Bus Route tool routes the selected traces as
        a group, or bus. The bus width is the total spacing of the original selected connections.
        The Bus Route tool can be used in conjunction with Fanout Route to route a collection of signals
        using minimum spacing. This maximizes the routing area available on the board for other traces.
        The following example shows Bus Route and Fanout working together:



                      CON1


                                                          Traces bus routed simultaneously
                                                          from fanout end points
             U1

                                     Fanout of traces
                                     to minimum spacing

        While using Bus Route, Online DRC is automatically activated. This enables you to view possible
        design rule violations arising from bus width changes when routing at an angle.

      Using Bus Route
        To route a series of traces using the Bus Route tool, follow these steps:
        1.   Choose Route » Bus or click the Route Bus button in the Route toolbar.
        2.   Use the mouse to select multiple connections. You can make this selection in one of two ways:
             •    Select by window: Click the workspace, hold the left mouse button down, and drag. When
                  you release the mouse, all connections within the specified region are selected.
             •    Select by mouse click: By clicking a connection, you select that connection. You can select
                  more than one connection by holding down the CTRL key while clicking.

             The connections selected for Bus Route must be aligned either horizontally or vertically on at
             least one end.

        3.   Press and hold down the left mouse button while the cursor is within the selected region and
             drag the connections to begin routing. The end closest to the point where the connections are
             selected becomes the source point; the other end becomes the destination point.
             The Bus Route tool rubberbands uncommitted copper with the proper net width and design
             rule clearances from the source point to the position of the cursor.
             The Bus Route tool routes the collection of traces simultaneously, rubberbanding each bus
             element individually as the cursor is moved.



114                                                                                    P-CAD PCB User’s Guide
MultiTrace Routing                                                                        Chapter 6: Routing


            You cannot change layers during bus routing.

            While bus routing, pressing the F key switches between pairs of the orthogonal mode.
       4.   When you click a coordinate that is not the destination node, the previously uncommitted
            lines are placed on the board.
       5.   Press the SLASH key or right-click and choose Suspend from the shortcut menu. The bus
            routed traces up to the suspension point are placed on the board. The unrouted portion
            becomes a series of new connections from the suspension points to the end nodes

                                                   OR

            continue until you reach the nodes that are on the other end of the rubberband. When the
            cursor is positioned over a set of pads or trace end points associated with the termination of
            the selected connection lines, a diamond appears for each bus line that connects to the pad or
            trace ends. If the route is suspended over the termination points, these routes complete
            automatically.


MultiTrace Routing
       This button enables the MultiTrace Route tool. The MultiTrace Route tool is designed to
       automatically route several connections. In contrast to Bus Route, MultiTrace routes each
       connection individually allowing each trace to find its optimum path. MultiTrace has design rule
       intelligence to effortlessly avoid obstacles.
       The MultiTrace Route tool increases your productivity by automating repetitive tasks, to give you
       the ability to complete a region of the design without intervention. It is optimal in regions of the
       board with parallel connections.
       As with the Interactive Route tool, the MultiTrace Route tool honors routing design rules and net
       attributes in the appropriate net class hierarchy.
       In the following examples, several connections have been automatically routed with MultiTrace. In
       the first case, the Maximum Hugging feature has been enabled.




P-CAD PCB User’s Guide                                                                                    115
Chapter 6: Routing                                                                     MultiTrace Routing




        The second example shows the same configuration of pads and connections. In this case, the
        Minimum Length feature has been enabled when the connections were routed with MultiTrace.




        There are several options you can select to control trace placement, including Maximize Hugging,
        Minimize Length, and Orthogonal Mode. See the sections Maximize Hugging/Minimize Length
        (page 122) and Interactive Routing (page 108) for more information on these options.
        Other trace control opportunities are discussed in Controlling Trace Placement (page 117).

      Using MultiTrace
        To use the MultiTrace route feature, follow these steps:
        1.   Choose Route » MultiTrace or click the Route MultiTrace button in the Route toolbar.


116                                                                              P-CAD PCB User’s Guide
MultiTrace Routing                                                                         Chapter 6: Routing


       2.   Use the mouse to select multiple pads and connections. You can make this selection in one of
            two ways:
            •   Select by window: Click the workspace, press and hold the left mouse button down, and
                drag. When you release the mouse, all connections within the specified region are
                selected. The pads within the region and any connections to those pads are also selected.
            •   Select by mouse click: By clicking a connection, you select that connection. By clicking a
                pad, you automatically select every connection to that pad. You can select more than one
                connection or pad by holding down the CTRL key while clicking.
       3.   Right-click and choose Complete from the shortcut menu. All traces are automatically routed.
            If a route of a particular connection cannot be completed, the route is not made. The router
            continues until all connections have been processed.
            There are several options you can select to control trace placement, including Maximum
            Hugging, Minimum Length, and Orthogonal Mode. See the sections Maximize
            Hugging/Minimize Length (page 122) and Interactive Routing (page 108) for more information
            on these options.
            Other trace control opportunities are discussed in Controlling Trace Placement below.
       4.   When all connections have been routed, you remain in MultiTrace mode. Continue the
            process until you have completed MultiTrace routing.
            You can press ESC while routing to cancel the process. Routes made up to that point are in the
            database and can be undone.

   Controlling Trace Placement
       In the MultiTrace router, each connection is individually routed; it is as if, in the InterRoute tool,
       you had selected the beginning of the connection, and then selected Complete from the pop-up
       menu. No rip-up or rerouting is performed. Traces are placed only on the current layer.
       How do you control a trace whose placement is completed automatically? In MultiTrace, you have
       control of trace placement by defining design rules, setting routing options, and understanding the
       MultiTrace router rules. See the sections Maximize Hugging/Minimize Length (page 122) and
       Interactive Routing (page 108) for more information on design rules and routing options.
       This section covers the basics of the MultiTrace router rules and how, by knowing these rules, you
       can influence trace placement.

       Routing Priority
       The final trace placement is altered by the order that connections are routed. Traces become
       obstacles for other traces placed later. Try to select pads and connections in an order, which does
       not interfere with later traces.
       With MultiTrace routing, the connections closest to horizontal and vertical are routed first.
       Selecting the Honor Layer Bias check box in the Route Tab of the Options Configure dialog forces
       traces in the direction of the layer bias. Then the tool routes those connections closest to 45
       degrees.



P-CAD PCB User’s Guide                                                                                          117
Chapter 6: Routing                                                                                Route Fanout


        Of the traces that lie at the same angle, the shortest is routed first.
        To maximize route completion, sometimes connections must be routed in a different order. To
        modify the routing order, you can select connections individually that you would like routed first.
        Then, select a window of connections to complete the remaining connections in the region.

        Routing Direction
        The final trace placement is affected by the direction that connections are routed, e.g. right to left
        or left to right. Specifically, the path of the trace around obstacles may vary with routing direction.

                                           Routed left to right



                                           Routed right to left


        If a connection alone is selected or a connection and both terminating pads, the routing direction
        defaults to either bottom to top or left to right.
        If only one pad of a connection is selected, routing begins from that pad and continues to the other
        end of the connection.


Route Fanout
        Choose Route » Fanout or click the Route Fanout button in the Route toolbar to run the Fanout
        routing tool. The Fanout Route tool is used for the systematic placement of traces from a PCB
        component. These traces can then be used by Bus Route as a start or termination point. The
        component pads do not need to be net-connected when Fanout is applied but can be free objects,
        which are connected to the net at your discretion.
        The Fanout Route tool routes from a group of connection end points to a set of on-grid fanout
        points. Although the Fanout Route tool can route from the end points of traces, it is particularly
        useful when exiting pads from a placed component. Several fanout modes are available to specify
        how the traces leave the component pads.
        The fanout traces respect the stub length, and the design rules and attributes.
        While using Fanout Route, Online DRC is automatically activated. This enables you to view possible
        design rule violations arising in certain surface mount configurations.

      Using Fanout Route
        To use the Fanout route feature, follow these steps:
        1.   Choose Route » Fanout or click the Route Fanout button in the Route toolbar.
        2.   Use the mouse to select multiple connections. You can make this selection in one of two ways:
             •   Select by window: Click the workspace, hold the left mouse button down, and drag. When
                 you release the mouse, all connections within the specified region are selected. The



118                                                                                   P-CAD PCB User’s Guide
Route Fanout                                                                             Chapter 6: Routing


                window selection tool uses the current Options Block Select Mode (Inside Block, Outside
                Block, Touching Block) to select connections. For example, if the current block select
                mode is touching, all connections in contact with the specified window are automatically
                selected.
            •   Select by mouse click: By clicking a connection, you select that connection. You can select
                more than one connection by holding down the CTRL key while clicking. (The function of
                the CTRL and SHIFT keys may be interchanged; these keys are configurable in the Mouse
                tab of Options Preferences).

            The connections selected for fanout must be aligned either horizontally or vertically on at least
            one end. If both ends of the connections are horizontally or vertically aligned, a pop-up box
            appears asking you to left-click near the connection endpoints from which you would like the
            fanout to begin. More than one connection must be selected for fanout

       3.   Right-click to open the following shortcut menu.




       4.   Fanout route uses the stub length to calculate its route. Choose Options to modify the current
            settings.
       5.   In the shortcut menu, choose Fanout. The Select Fanout dialog appears:




       6.   Click the desired fanout configuration. The Select Fanout dialog includes the following
            options:
            •   Fanout Style: Click the button corresponding to the desired fanout style.




P-CAD PCB User’s Guide                                                                                    119
Chapter 6: Routing                                                                              Route Fanout


             •   Space Traces at Minimum Clearance: If enabled, this check box places the fanout
                 endpoints at their minimum spacing while satisfying the design clearance rules, line width,
                 and grid spacing. If not enabled, the fanout endpoints remain at the original pad spacing.
             •   When Fanout Style #4 is selected, the Space Traces at Minimum Clearance option is
                 disabled.
             •   Preview: Displays the fanout selection and orientation.
             •   Flip/Flop buttons: Specify the right/left and down/up orientation of the fanout.
             •   When Fanout Style #1 is selected, the fanout placement is centered with all trace
                 placement oriented towards the center-most connection. In this case, the Flop button (on
                 the right) is disabled.

             If the orthogonal mode is 90 degrees, only Fanout Styles # 1 and 2 are available

        7.   Click OK. The Fanout Route tool automatically places the fanouts for the specified
             connections.

      A Fanout Example
        In the following example three connections have been selected between vertically aligned pads.
        When Fanout is selected from the shortcut menu, a dialog appears asking from which end the
        fanouts should begin. Click OK. Click the connections near the pads on the left to begin the
        fanout. This confirmation dialog appears only when there is uncertainty about the fanout direction,
        as in this case when both ends are aligned and on the current layer.

        If the connection endpoints are not aligned on the current layer, there is no uncertainty about the
        fanout direction. The Select Fanout dialog appears immediately.

        The Select Fanout dialog appears:




120                                                                                 P-CAD PCB User’s Guide
Route Fanout                                                                            Chapter 6: Routing


       The Fanout Style # 1 is chosen and the Flip button toggled until the fanout display in the Preview
       box exited the pads to the right. The Space Traces at Minimum Clearance box was checked to
       minimize the spacing between traces at the fanout endpoints.
       When OK is clicked, a dialog appears asking from which end the fanouts should begin. Click a
       selected connection near the left end, where the fanouts in this example should begin. This
       confirmation dialog appears only when there is uncertainty about the fanout direction, as in this
       case when both ends are aligned and on the current layer.




       Again, choose Fanout from the shortcut menu. To complete the fanouts from the remaining pads,
       the Select Fanout dialog is modified by clicking the Flip button. Otherwise, the same fanout
       configuration is used.
       Click OK. Note that the traces are placed in the same fanout configuration, but in the opposite
       direction.




P-CAD PCB User’s Guide                                                                                      121
Chapter 6: Routing                                                   Maximize Hugging/Minimize Length




Maximize Hugging/Minimize Length
       The Maximize Hugging/Minimize Length features lets you set trace placement to hug obstacles or
       to seek the straightest line between routes. These features are available with InterRoute, Fanout,
       Bus Route, and MultiTrace Route tools. You can toggle between these two settings by clicking their
       buttons on the toolbar or in the Route Tab of the Options Configure dialog.
       When you click the Maximize Hugging button on the Route toolbar, trace placement is set to
       maximize the hugging of obstacles.




122                                                                             P-CAD PCB User’s Guide
Visible Routing Area                                                                         Chapter 6: Routing


        When you select the Minimize Length button from the Route toolbar, trace placement seeks the
        straightest (minimizing corners) possible vialess route. This feature optimizes the use of 45• traces.




Visible Routing Area
        The Visible Routing Area feature analyzes the design rules and displays on the workspace the
        available routable area. Specifically, it shows the grid points in the area that are legal to route over.
        The Visible Routing Area feature is available with the InterRoute and Bus Route tools.
        By viewing the routable area, you can plan ahead for board design and trace placement. You can
        see where a trace might go without attempting to place it.
        As with the InterRoute tool, the routing area takes into account the following design rules, net
        attributes, and net class attributes: Width, ViaStyle, Clearance, PadToPadClearance,
        PadToLineClearance, LineToLineClearance, ViaToPadClearance, ViaToLineClearance, and
        ViaToViaClearance.

        If the design rules or net attributes are modified while routing, the Visible Routing Area remains
        unchanged until a new connection is selected

        The Visible Routing Area is displayed as a region centered around the current cursor position. It
        expands as the cursor moves outside the region. Under Windows NT the routable area is a
        transparent hatch and under Windows 95 the area is gray.




P-CAD PCB User’s Guide                                                                                         123
Chapter 6: Routing                                                              Shortcut Menu Commands




Shortcut Menu Commands
        When you select a routing tool with InterRoute Gold and right-click, a shortcut menu appears
        providing shortcuts to frequently used menu commands. The commands in this menu change
        depending on the tool you select.
        The following section summarizes the commands, which appear on the shortcut menus:
        •   Cancel undoes all routing actions and puts the original connection back. The tool remains
            active.
        •   Complete routes the remaining portion of the trace automatically.
        •   Deselect All cancels the selection of all selected items.
        •   Fanout opens the Select Fanout dialog.
        •   Layers opens the Options Layers dialog.
        •   Options opens the Route tab of the Options Configure dialog.
        •   Suspend, equivalent to the SLASH key, leaves the unrouted portion as a connection.
        •   Unwind, equivalent to the BACKSPACE key, removes the last line or via that was committed.
        •   Via Styles opens the Options Via Style dialog.




124                                                                              P-CAD PCB User’s Guide
Options Configure Route Tab                                                               Chapter 6: Routing



Options Configure Route Tab
       The Route tab of the Options Configure dialog allows you to set options for the Manual and
       Interactive route tools. When the Route Interactive tool is active, you can access this dialog by
       right-clicking and choosing Options from the shortcut menu.




       This sections describes Interactive Route options.
       •   Honor Layer Bias: When enabled, the layer bias is honored. If the bias is set to Auto, bias is
           determined based on the following rule: The Top layer is biased in the direction of the longest
           side of the bound rectangle of the items on the Board layer. All layers then alternate with
           opposing bias until the Bottom layer is reached.
           You can set layer bias to horizontal or vertical for each signal layer with the Options » Layers
           command. See Options Layers (page 450) for additional information.
       •   Visible Routing Area: When enabled, the routable area is displayed on the workspace, taking
           into account the routing parameters such as clearance and trace width. Under Windows NT the
           area is shown as a transparent hatch; under Windows 95 the area is shaded.
       •   Stub Length: The suggested minimum Length or number of Grid Points to use for line
           segments that enter or exit pads. For nonuniform grids, one grid space is the sum of the grid
           values.
       •   Trace Length: When you select Maximize Hugging, trace placement is set to maximize the
           hugging of obstacles. The Minimize Length option generates the straightest (minimizing
           corners) possible vialess route. This option optimizes the use of 45 degree traces.



P-CAD PCB User’s Guide                                                                                        125
Chapter 6: Routing                                                                               Online DRC:



Online DRC:

             An interactive, online DRC capability notifies you of clearance and net width rule violations,
        shorts created during manual, interactive, and miter routing, and net references to non-existent via
        styles by placing DRC error indicators, beeping, and displaying an optional report file. Online DRC
        does not check tie nets.
        An edit operation or DBX command that changes lines, arcs, component and non-component
        pads/vias, polygons or text are checked for rule violations when online DRC is enabled. This
        includes the following commands
        •   Select move objects.
        •   Paste, paste from file and paste circuit.
        •   Modify objects.
        •   Move to layer.
        •   Place line.
        •   Place arc.
        •   Place text.
        •   Place polygon.
        •   DBX-in commands.
        You can enable or disable this feature by selecting the Online DRC toolbar button, or by selecting
        the Enable Online DRC check box in the Online DRC page of the Options Configure dialog. A View
        » Report option allows you to specify if a report should be presented at the completion of routing
        for each connection. You can also select from a variety of report options, gain access to the Design
        Rules and set Severity Levels in the Online DRC page.
        The File Reports dialog has a report called DRC Error Indicators. This generates a report of all DRC
        error indicator locations and descriptions in the active design. In addition, you can use the Utils
        Find Error command to find the errors.




126                                                                                P-CAD PCB User’s Guide
                                                                                    CHAPTER              7


                                                                         Auto Routing

       The P-CAD PCB Editor interfaces to a number of autorouters, including:
       •   Quick Route – a built-in grid based autorouter
       •   Shape-Based Router – a powerful and fast shape-based autorouter that is ideally suited to
           dense and complex designs. The Shape-Based Router is included with the P-CAD 2002 Suite.
       •   SPECCTRA Autorouter – from Cadence Design Systems, Inc.
       All of the autorouters are run from the Route Autorouters dialog. Select the required autorouter in
       the Autorouters drop-down list and clicking the Start button to start that autorouter.


Introduction to the Shape-Based Router
       The Shape-Based Router runs as a separate application in Windows. The Shape-Based Router
       requires very little setup or operator intervention, it analyses the board and selects a suitable
       routing strategy, based on the types of components, the line width and clearance, and the density
       of the board. The Shape-Based Router includes a number of routing passes, as it runs it adaptively
       selects the most appropriate routing pass, swapping back and forth between passes to achieve the
       best result.
       For more information on using the Shape-Based Router refer to the on-line help, which can be
       accessed from the PCB Editor Help menu, or the Shape-Based Router Help menu.


Routing with Quick Route
       This section describes how to use P-CAD Quick Route, the embedded autorouter. You select Quick
       Route from the Autorouter list in the Route Autorouters dialog. After selecting Quick Route the
       dialog will change to display the Quick Route control options. These options are described in detail
       in the Setting Up the Route Autorouter Dialog topic (page 132).
       Quick Route routes the active PCB design in a different window. When you start Quick Route an
       input PCB file is created which contains the PCB with only the placed components, special keepout
       areas (that Quick Route will not allow traces to cross) and prerouted connections. The design also



P-CAD PCB User’s Guide                                                                                  127
Chapter 7: Auto Routing                                                            Routing with Quick Route


        includes the netlist information created using a schematic capture program such as P-CAD
        Schematic, or defined in the PCB Editor.
        The netlist information in the PCB file tells Quick Route the connections it must make, while the
        component and board outline sections of the PCB file define the constraints that Quick Route must
        work within. When you are laying out your board, remember that the degree of autorouting
        success depends on the component placement.
        Before routing, you can define keepouts and preroutes. Keepouts are areas that you do not want
        lines to cross. Choose Options » Current Keepout to set the style and layer for the keepout. Then
        place it to define an area for the router to stay away with.
        Quick Route lets you preroute critical lines, such as high-speed ECL clock lines. In addition to
        performing a complete design rule check on all prerouted connections, Quick Route will not place
        lines that short the preroutes.

      P-CAD Quick Route Steps
        After you have finished placing components, keepouts and preroutes, P-CAD Quick Route is ready
        to go to work.
        Your PC board appears in the workspace. As connections are completed, they appear on screen,
        allowing you to monitor P-CAD Quick Route's progress. The Status Line displays the following
        messages, giving the status of each step in the routing process:
        •   Checking setup parameters: Checks setup information for errors and output files that already
            exist.
        •   Reading PCB file: Reads the input PCB file.
        •   Assigning pads to nets: Assigns pads to nets.
        •   Assigning lines to nets: Checks preroutes to make sure they belong to the proper nets.
        •   Optimizing prerouted lines: Reviews and arranges preroutes.
        •   Processing pads: Performs a design rule check on all pads.
        •   Processing polygons: Performs a design rule check on prerouted polygon fills.
        •   Processing lines: Performs a design rule check on prerouted lines.
        •   Processing keepouts: Records all keepout areas as defined in PCB.
        •   Processing polygons: (1) – Records all polygon fill areas as defined in PCB.
        •   Optimizing lines: Compresses the internal data.
        •   Optimizing nets: Processes all nets to find the optimum (shortest) connections.
        •   Processing surface pads: Places vias automatically beside surface pads to facilitate autorouting
            to them. Unnecessary vias are later removed by the Via Minimization pass, if enabled.




128                                                                                P-CAD PCB User’s Guide
Routing with Quick Route                                                           Chapter 7: Auto Routing


       •   The Routing Passes: Performs each enabled routing pass, listing on the Prompt Line the name
           of the pass, the percentage of connections completed and, in parentheses, the ratio of the
           number of completed connections to the total number of required connections.
       •   Writing no-route data: Writes information about uncompleted connections to the log file.
       •   Writing routed PCB file: Writes the routed board information to the output PCB file.
       •   Route completed: Indicates that routing is finished. P-CAD Quick Route displays the
           percentage of completed connections. In parentheses, the program displays the number of
           completed connections and the total connections (separated by a / ).
       The steps in the routing process fall into four categories:
       •   Loading files
       •   Design rule checking
       •   Routing passes
       •   Writing the log and PCB output files
       The following sections describe design rule checking, each of the routing passes and the contents
       of the log file.

       Design Rule Checking
       P-CAD Quick Route checks that all prerouted connections on the PC board match the netlist
       (electrical check) and that they maintain the minimum clearance between items in different nets
       (clearance check). These two checks comprise the Design Rule Check (DRC). The clearance can
       range from 1 mil up to a maximum number of mils determined by the grid selected.

       P-CAD Quick Route performs its DRC only on layers enabled for routing. You must place prerouted
       lines on the same layers you intend to use for autorouting, and then enable those layers, causing
       both the DRC to be performed and the preroutes to be processed.

       The DRC handles both off-grid and on-grid items. Line segments that cross at any angle are
       considered connected. Any connections between pads and/or line segments must be proper. The
       centerlines of connecting line segments must cross; lines that overlap only slightly cause a warning
       message to be issued. Similarly, if a pad overlaps a line segment, but does not lie on the line
       centerline, a warning message is issued.
       A check is also performed on uncommitted pins (all component pins that do not appear in the net
       information and therefore should be unconnected). If an uncommitted pin is connected to
       anything, an error message is issued. However, this does not apply to free pads or free vias (pads
       and vias that do not belong to a component). A free pad or via that is prerouted to a node in a net is
       considered a part of that net. P-CAD Quick Route can then use the free pad or via as an additional
       target for routing to that node.
       P-CAD Quick Route will actually clean up a few situations it encounters in the input PCB. This is not
       to be interpreted that the program will correct electrical or clearance violations – these must be




P-CAD PCB User’s Guide                                                                                    129
Chapter 7: Auto Routing                                                              Routing with Quick Route


        corrected manually. However, there are a few situations that the program looks for and will change
        for the better:
        •   If two lines are collinear (linked end-to-end in a straight line) and their common endpoint is
            not on a pad, polygon fill or other line, the lines are combined into a single line.
        •   If a line ends within a pad but not at the pad centerpoint, a small line is added to make that
            connection.
        •   If a pad centerpoint lies exactly on a line centerline, the line is divided into two lines at the pad.
        The DRC is useful on finished boards as well as partially routed boards. If P-CAD Quick Route does
        not achieve 100% completion, return the routed file to PCB to manually complete the remaining
        connections.

        Routing Passes
        After performing the DRC, P-CAD Quick Route sorts the net information. This involves analyzing
        each net and finding the optimum (shortest) connections for each node in a net.
        The Horizontal, Vertical, L, C, Z and Maze routing passes use these optimum connections.
        The Wide Lines, Any Node (2 vias) and Any Node (Maze) passes consider all of the possibilities. All
        prerouted connections are accounted for and P-CAD Quick Route attempts to complete the
        remaining net connections.
        By default, all routing passes are enabled. For more information see Passes (page 136).

      Completing the PC Board
        After you complete the routing passes and generate the output files, you can find uncompleted
        connections. If P-CAD Quick Route's completion rate is approximately 90 percent or more, you
        have the following options:
        •   Modify the component placement on the board and try routing it again.
        •   Manually route the remaining connections.

        The Iterative Approach
        If your completion rate is significantly less than 90 percent, you have the following options:
        •   Manually route the remainder of the board.
        •   Move components for better placement.
        •   Enable or disable the Power and Ground planes in the Nets section of P-CAD PCB.
        •   Immediately return to P-CAD Quick Route and try different passes, more layers, or finer grids.
        Advanced planning can help with later changes. For example, if you place your components on a 50
        mil grid, you can autoroute on a 25, 16.7 or 12.5 mil grid. However, if you use a 20 mil routing grid
        on the same placement, the pads on 50 mil centers will be off-grid, lowering the possible
        completion rate.



130                                                                                   P-CAD PCB User’s Guide
Routing with Quick Route                                                            Chapter 7: Auto Routing


       When you view the rat’s nest of unrouted connections in PCB, look for areas with obvious
       congestion. Often, you can relieve congestion by moving components. If you find bottlenecks,
       move the components on the board and then feed the board back into P-CAD Quick Route.
       Typically, this approach can be simpler that an attempt to route around the high-density areas in P-
       CAD PCB.
       With Quick Route, you can typically cycle through the following procedure several times, before
       completing the board manually in P-CAD PCB:
       1.   In P-CAD Quick Route, route the board.
       2.   In PCB, move the components to minimize the density of unrouted connections.
       3.   In P-CAD Quick Route, route the board again.
       4.   If necessary, repeat steps 2 and 3.

       Iterative Approach Guidelines
       A frequently asked question is: When should you attempt this iterative approach vs. when is it time
       to manually complete the board? While there is no absolute answer, the following conditions
       typically favor the iterative approach:
       •    The components can be moved: If design constraints do not require fixed component
            locations, try moving the components in PCB and run the board through P-CAD Quick Route
            again. A 100 mil grid is best, especially for through-hole designs.
       •    The PCB design contains few, if any, preroutes: This simplifies the process of moving
            components on the PC board.
       •    The routing grid can be changed: If you have selected a grid for placement such as 50 mil, you
            can be able to switch routing grids from say 25 mil to 16.7 mil without adding a lot of off-grid
            components. The finer routing grid can produce better results but must be within the
            fabrication capabilities of your board manufacturer.
       •    More signal layers can be added: This is a fast way to increase completion percentage, if you
            can afford the expense of multilayer board fabrication.
       •    Add Power and Ground layers: The Power and Ground layers can be added.
       •    The routing process is relatively short, for the potential gain in completion: If routing takes an
            hour and only leaves a few connections unfinished, it might be faster to complete them in PCB.
            On the other hand, if routing takes a few minutes and leaves 20 or more connections
            unrouted, it is worth a few iterations to reduce the number of no-routes.
       •    The completion improves with each iteration: After a while, the iterative process yields
            diminishing rates of return. You can even find that an iteration actually increases the number
            of no-routes. If this happens, it is time to back up one step and complete the design in PCB.




P-CAD PCB User’s Guide                                                                                      131
Chapter 7: Auto Routing                                                            Routing with Quick Route


      Verifying the Finished Board
         Once the board is finished, verify your work by requesting a DRC report, or by feeding the PCB file
         back into P-CAD Quick Route. Quick Route performs a design rule check on the entire board. Be
         sure to take the following steps:
         •   Choose P-CAD Quick Route with the finished PCB file as the active PCB design file.
         •   Set the DRC Clearances to match the capabilities of your PC board fabrication bureau. The
             program displays any clearance violations on the screen and saves the DRC results in the log
             file.
         •   Check the log file for any nets that are still not completely routed. These incomplete nets can
             result from removing lines in PCB while finishing the board.

      Setting Up the Route Autorouter Dialog
         Choose Route » Autorouters to open the Route Autorouters dialog. As shown in the following
         figure, Quick Route is selected by default in the Autorouter list.




         Use the options in the Route Autorouters dialog to select the autorouter that you want to use to
         route your designs. You also use these options to set autorouter options for the selected
         autorouter, as well as to start and restart the autorouting process.
         The following sections describe the Quick Route options that are available in the Route
         Autorouters dialog.




132                                                                                 P-CAD PCB User’s Guide
Routing with Quick Route                                                              Chapter 7: Auto Routing


       Strategy File
       You can save your routing options in a strategy file, which can be opened later for reuse. To open a
       strategy file, open the Route Autorouters dialog and click Strategy File. When the Select Strategy
       File dialog appears, select the name and location of a strategy file that you want to open.
       A strategy file is a collection of settings that you set up in the Route Autorouters dialog. It includes
       all data needed by Quick Route to route the board. The strategy filename initially appears as the
       same name as the current design file, but with an .str file name extension. This is the default
       filename. You can, however, save route strategies to a file with any name.
       All Quick Route router configuration settings are saved in the strategy file under the section
       [STRATEGY2]. The section [AUTOROUTER] contains keywords specific to all autorouters. One such
       keyword is Autorouter= which indicates the currently selected autorouter. The section
       [STRATEGY2] contains all the settings specific to Quick Route.

       Output Log File
       P-CAD Quick Route produces a comprehensive statistical autorouting report that is written to the
       file you specify using this button. Click Output Log File in the Route Autorouters dialog to open the
       Select Output Log File dialog, in which you can specify the name and location of your report file.
       Valuable information about your PCB design, routing strategy and route preference data is
       included in this report file.
       Click Output PCB File to save the routed design to a file. When you click this button, a dialog
       appears in which you can specify the name and location of your output design file. A name for the
       output file is provided by default. The letter R (for routed) precedes the current design filename.
       The last character is dropped if the new name exceeds eight characters. The file name extension is
       .pcb by default. You can override the default name by typing a new name over the default name.
       Before routing starts, the input PCB is analyzed. General information as well as your routing
       strategy and router-selected options are written to the log file. After each pass, per-pass and total
       routing statistics are written to the file. When routing is completed, summary information is written
       to the file.

       Load Button
       Click Load to open a previously saved strategy file. Choose the strategy filename, then click Load.
       The design and routing data is updated with the values from the strategy file. You will see these
       changes in the Route Autorouters dialog.

       Save Button
       Anytime after you have selected a strategy filename, you can capture the current strategy by
       clicking Save. The strategy file is also saved automatically when you start the route. Binary files can
       be saved in a compressed format if you select the Compress Binary Designs check box in the
       General tab of the Options Configure dialog.




P-CAD PCB User’s Guide                                                                                       133
Chapter 7: Auto Routing                                                            Routing with Quick Route


       Set Base Button
       Click Set Base to return the strategy and output files to their default filenames. This is a simple way
       to go back and start over again when assigning filenames. The default names are derived from the
       design filename, including the full path.

       Layers
       As a shortcut for choosing Options » Layers, click Layers in the Route Autorouters dialog. The
       following Options Layers dialog appears:




       You can add, delete, enable, disable and modify the routing bias of a layer. Changes made for
       autorouting apply to PCB.
       Quick Route supports up to four (4) plane layers. The nets connected to the planes are defined in
       PCB when the netlist is first loaded. These can also be defined manually when a plane layer is
       created.
       PCB provides Top, Bottom, Board, and several non-signal layers automatically. Additional signal
       layers (e.g., MID1-MID8) and power and ground plane layers are automatically defined when a PC
       board is loaded.




134                                                                                 P-CAD PCB User’s Guide
Routing with Quick Route                                                            Chapter 7: Auto Routing


       When you create a layer, you must give it a unique name, specify a layer number (one that is not
       already defined), a routing bias (signal layers only) and a layer type. When you create a plane layer,
       you must also give it a net name.

       Net Attrs
       As a shortcut for choosing Edit Nets, you can click Net Attrs in the Route Autorouters dialog. The
       Edit Nets dialog appears as follows.




       Use the controls in this dialog to display or hide connections, edit or view net and net layer
       attributes, change net names, get net information or select net(s) by attributes, attributes on
       specific layers or node count. It also allows you to view and highlight nets within the design, view
       nodes attached to a particular net and jump to a node. In addition, you can select one or more
       nodes and modify their pad or via styles.
       Setting net attributes is important for routing, because it lets you override the global values on a
       net-by- net basis (for example, the line width and via style). For more information on the options in
       this dialog, see Edit Nets (page 345).
       Quick Route supports the following net attributes. These attributes override the default settings for
       each net to which they are attached.
         AUTOROUTEWIDE             = <TRUE/FALSE>
         VIASTYLE                  = <via style name> (for wide nets)
         WIDTH                     = <routing track width in current units>
         NOAUTOROUT                = <TRUE/FALSE>
         MAXVIA                    = <number of vias> (for maze route only)



P-CAD PCB User’s Guide                                                                                      135
Chapter 7: Auto Routing                                                           Routing with Quick Route


       Passes
       Click Passes in the Route Autorouters dialog to enable different types of routing passes. When you
       click this button, the following Pass Selection dialog appears:




       All passes except Route Cleanup and Via Minimization default to ON. A description of each pass
       follows:

       Wide Line Routing
       This pass routes all specified Wide Line nets before executing other passes. Specify wide line nets
       by adding the AUTOROUTEWIDE attribute to them. The Wide Lines Routing pass makes horizontal
       or vertical connections only and uses any enabled layer. If you require a wide line that is not
       horizontal or vertical, preroute the line in PCB using the desired width. Quick Route maintains this
       width.
       All routing of wide lines is based on the same grid selected for routing single lines. To guarantee
       the correct clearance, it is necessary for the wide lines to occupy more than one grid point.
       To route the wide line nets, do the following:
       1.   Run the board through Quick Route with only the Wide Lines Routing pass enabled. Clear the
            check boxes for all other passes.
       2.   If Quick Route cannot complete the Wide Line nets, finish routing these nets manually using
            PCB.
       3.   Run the board though Quick Route again; this time select all routing passes. Clear the Route
            Cleanup and Via Minimization check boxes, post-routing passes until all nets on the board are
            completely routed.

       Horizontal
       This pass completes simple connections on any layer selected with a horizontal bias, with no vias
       and minimal deviations from a straight, horizontal line.



136                                                                                P-CAD PCB User’s Guide
Routing with Quick Route                                                              Chapter 7: Auto Routing


       Vertical
       This pass completes simple connections on any layer selected with a vertical bias, with no vias and
       minimal deviations from a straight, horizontal line.

       L Routes (1 via)
       This pass is formed by the intersection of two lines and one via, forming an L. The lines have
       minimal deviations from their center lines and can be placed on any two enabled layers with
       opposite bias (horizontal and vertical). The L can have any orientation.
       Lines are placed no more than 100 mils outside the rectangle defined by the two endpoints in the
       connection. Although the pass is enabled by default, it is automatically disabled if at least two layers
       are not set to route in opposite directions (i.e., horizontal and vertical).

       Z Routes (2 vias)
       This pass is formed with three lines and two vias, forming an orthogonal Z. The Z can have any
       orientation. Lines are placed no more than 100 mils outside the rectangle defined by the two
       endpoints in the connection. Although the pass is enabled by default, it is automatically disabled if
       at least two layers are not set to route in opposite directions (i.e., horizontal and vertical).

       C Routes (2 vias)
       This pass is formed with three lines and two vias, forming a C. The C can have any orientation. The
       C route is more flexible than the L or Z routes; it allows lines to be placed more than 100 mils
       outside the rectangle defined by the two endpoints in the connection. Any enabled layers can be
       used to complete the C route. Although the pass is enabled by default, it is automatically disabled if
       at least two layers are not set to route in opposite directions (i.e., horizontal and vertical).

       Any Node (2 vias)
       The previous passes attempted to route only the optimized connections (the set of connections for
       a net that would minimize the total line length). To attain the highest possible number of
       completed connections, the Any Node pass analyzes each net and attempts to make a connection
       between any nodes in the net.

       Maze Routes
       This pass attempts optimum connections only (rather than any node in a net). This pass is not
       restricted by line orientation. It allows the line orientation to differ from the standard orientation of
       lines on the board layer, to make turns, and to double back.
       The Maze pass inserts vias, as required to complete a connection. Specify the maximum number of
       vias that are allowed for each connection using the MAXVIAS net attribute. The default is 10.
       The lines generated by the Maze pass can block channels that you can need to hand-route
       remaining lines. If so, you might consider an iterative approach; run the board through Quick
       Route with maze routing disabled, hand-route the desired lines in PCB, and then re-route with
       Maze routing enabled.




P-CAD PCB User’s Guide                                                                                       137
Chapter 7: Auto Routing                                                            Routing with Quick Route


       Any Node (Maze)
       This pass uses the same routing strategy as the Maze pass. The Maze pass attempts to route only
       the optimized connections. The Any Nodes (maze) pass attempts to obtain the highest possible
       number of completed connections by analyzing each net and attempted to make a connection
       between any nodes in the net.

       Route Cleanup
       This pass is included to improve a board's aesthetics and manufacturability. The autorouter
       intentionally hugs lines during routing for efficiency and higher completion rates. The Route
       Cleanup pass re-routes some of the lines to eliminate extra jogs where possible. This pass uses the
       concept of copper sharing to combine lines in the same net. The reduction in line segments has the
       added benefit of reducing the size of your design file.

       Via Minimization and Route Cleanup passes should be run together as a separate operation from
       other routing passes.

       Via Minimization
       This pass attempts to reduce the number of free vias. During this pass, Quick Route checks all the
       lines connected to each free via. If the lines can be swapped to another enabled layer without
       violating the design rules, they are swapped and the via is removed.
       This pass doesn't affect pads. If you want to ensure that all prerouted vias remain intact, disable this
       pass or use a through-hole pad instead of a via for connecting prerouted lines on opposite signal
       layers.

       Via Style
       A via style defines a stack of shapes for each layer or layer type that make up the via. This option
       indicates the via style to be used for vias added by the autorouter. You can add, delete, or edit via
       styles by using the series of available dialogs. This command also sets the current via style for Place
       Via in P- CAD PCB. You can gain access to this command by choosing Options Via Style.




138                                                                                 P-CAD PCB User’s Guide
Routing with Quick Route                                                              Chapter 7: Auto Routing




       With this command you define the global defaults for nets as they relate to a via style. For wide
       routes, you can override these defaults on a net-by-net basis by adding the VIASTYLE attribute by
       choosing Edit Nets.

       You set the default routing via by setting the desired via to be current. The current via is marked
       with an asterisk (*). To make a via current, select the via style from the list and click Close.

       Do not inadvertently mistake the default routing via for the default via style. The default via style,
       which is seen as (Default) in the Options Via Style dialog, is a single style provided as part of PCB. It
       cannot be changed or deleted. The default routing via is the via style that the autorouter uses to
       route all nets, except ones with the VIASTYLE attribute set to override this default. The default
       routing via can be the default via style, or it can be any other style you choose. See Quick Route
       Limitations (page 145) for information on via use.

       You can create a new via style or modify an existing one directly from this dialog. In addition, you
       can view the default via style and delete an existing via style.

       Routing Grid and Line Width
       The Routing Grid list contains a list of grids allowed by Quick Route.




       The Line Width scroll box lets you select a legal line width whose minimum value is 0.1 mil and
       maximum value is a function of the Routing Grid selection. The routing line width can't exceed half
       the grid value.


P-CAD PCB User’s Guide                                                                                       139
Chapter 7: Auto Routing                                                             Routing with Quick Route




        For example, if a 25 mil grid is selected, the Line Width option varies from 0.1 mil (.01mm) to 12 mil
        (.30mm) in 0.1 mil (0.01mm) increments. If you type too large a value, the scroll box automatically
        self- adjusts to its maximum value when you move to another field. Use the up and down arrows to
        scroll through valid values.

        Error Messages
        Use the Error Messages box to set where you would like error messages to appear. You can direct
        the messages to appear on the screen only, only in the Output Log File, or both (the default
        setting). If you choose Output to Log File, routing continues uninterrupted, because you do not
        have to respond to error messages.

        Start Button
        Click Start in the Route Autorouters dialog to start the routing process. Several changes occur to
        the screen:
        •   The menu bar changes to offer route-specific commands.
        •   The Route toolbar appears replacing the existing toolbar.
        •   The Status Line displays each step of the routing process.
        The autorouter is then initialized, the board is prepared for routing, data is transferred to the router
        and the router analyzes your design. During this process, the Status Line keeps you informed of all
        activities. Routing begins, pass-by-pass, and the Status Line displays each completed line as it is
        routed.
        Because you are in Windows, you can gain access to other Windows-based programs during the
        routing process. However, autorouting is a resource-intensive process, which can affect the
        performance of the router and other programs as the demand for resources increases.
        P-CAD Quick Route routes the board using the current design and route strategy information. Your
        board must be saved prior to routing to ensure a known base.
        If you choose the command after editing a strategy file that contains an existing output filename,
        the program prompts you to overwrite the output file or cancel. This way, you can avoid
        overwriting any files that you want to keep.

      Commands Available during Routing
        During the routing process, you can gain access to a number of commands in the following P-CAD
        PCB menus. These include:

        View Commands
        During the routing process, you can choose one of the following commands without interrupting
        the routing process:




140                                                                                  P-CAD PCB User’s Guide
Routing with Quick Route                                                          Chapter 7: Auto Routing


       View Redraw
       Choose View » Redraw to clear everything in the workspace to the background color and then
       redraws the screen. To interrupt a redraw in progress, right-click or press ESC.

       View Extent
       Choose View » Extent to view the extent of all objects placed in the workspace. PCB computes and
       draws the workspace such that all placed objects on enabled layers are visible. Disabled layers are
       ignored.

       View Last
       Choose View » Last to redraw the previous view. This command is shaded and if you have not
       altered the view in any way. To make the command available, choose a View command and
       changes the view area.
       If you choose View » Last multiple times, you switch between the last two views. Scrolling,
       centering, and redrawing do not affect the previous view.

       View All
       Choose View » All to redraw the entire workspace. View All is the view that appears by default,
       when you start P-CAD PCB. The workspace size is determined by the settings in the Workspace
       Size frame of the Options Configure dialog. To change the workspace size, choose Options »
       Configure when the router is not running. The scroll bars do not appear at this zoom level.

       View Center
       Choose View » Center to redraw the screen using the cursor as the relative center point. When you
       choose this command, the cursor takes the shape of a magnifying glass to signify that you are in
       zoom mode. If you click the workspace, the point your click becomes the center of the screen. To
       cancel the zoom after the magnifying glass cursor appears, right-click or press ESC.

       View Zoom In
       Choose View » Zoom In to zoom in by the current zoom factor set in the Options Configure dialog.
       When you choose this command, the cursor takes the shape of a magnifying glass to signify that
       you are in zoom mode. You click the workspace to zoom in on the workspace. The point you click
       becomes the center of the zoomed-in area. You must reinvoke the command for every zoom
       action. To cancel the zoom action, right-click or press ESC when the cursor takes the shape of a
       magnifying glass.

       View Zoom Out
       Choose View » Zoom Out to zoom out by the current zoom factor set in the Options Configure
       dialog. When you choose this command, you are prompted to click for the center point of the
       zoomed area. The cursor position becomes the center of the zoomed-out area. You must re-invoke
       the command for every zoom action. To cancel the zoom after the zoom cursor appears, right-click
       or press ESC.




P-CAD PCB User’s Guide                                                                                   141
Chapter 7: Auto Routing                                                         Routing with Quick Route


       View Zoom Window
       Choose View » Zoom Window to zoom to an area of the workspace that is specified by a zoom
       window. When you choose this command, the cursor takes the shape of a magnifying glass to
       indicate that the zoom window tool is active. To learn how to use this tool, see View Zoom Window
       (page 363).

       View Toolbar
       Choose any View » Toolbar command to show or hide the toolbar of your choice. Toolbars contain
       buttons that act as shortcuts for frequently used menu commands.
       Disabling the command increases the space within the applicable window. The setting of the
       toolbar visibility is saved to your PCB.ini file when you quit the program, and restored when you
       restart it.

       View Status Line
       Choose View » Status Line to either show or hide the Status Line. The Status Line provides route
       status information. A check mark next to the command indicates that the Status Line is visible.
       Disabling the command increases the space within the applicable window.
       The state of the Status Line is saved to your Pcb.ini file when you quit the program, and restored
       when you restart it.

       Route Commands
       During the routing process, you can choose one of the following commands without interrupting
       the routing process:

       Route Info
       Choose Route » Info to open the Information dialog that shows up-to-the-minute statistics on your
       computer system, including available memory, disk size and disk space free.
       The top line for each pass provides information for the pass: the pass name and number, the
       number of connections, fanouts or nets scheduled and completed, the percentage completed,
       routing time and vias added or removed. Note that the numbers of items scheduled and completed
       differ from pass to pass.
       The second line for each pass contains overall routing statistics through completion of the pass.
       This includes the total connections routed, a total percentage of connections completed, overall
       routing time and the total number of vias. Routing is suspended when this information box
       appears.

       Route Pause
       Choose Route Pause to pause the routing process at the point where the command is invoked.
       While paused, you can change your view, obtain routing information or online help, or cancel the
       route. This command allows you to temporarily free computer resources to perform other CPU-
       intensive tasks without terminating the routing process.




142                                                                              P-CAD PCB User’s Guide
Routing with Quick Route                                                              Chapter 7: Auto Routing


       Route Resume
       Choose Route Resume to resume a route that has been paused. Routing starts at the point at which
       it was paused.

       Route View Log
       Choose Route » View Log to view the log file deriving from your routing session with P-CAD Quick
       Route. P-CAD PRO Route generates a comprehensive report file at the end of the routing session,
       detailing the results of the session. The report is presented in Notepad. Viewing the log file does
       not interrupt routing.
       Valuable information about your PCB design, routing strategy and route preference data is
       provided.
       Before routing starts, the input PCB is analyzed. General information as well as your routing
       strategy and router-selected options are written to the log file. After each pass, per-pass and total
       routing statistics are written to the file. When routing is completed, summary information is written
       to the file.
       The report file contains the following information:
       •   General: The report provides a list of the input PCB, output PCB and strategy filenames, your
           selected units, the available memory and the route start time. The report also lists the routing
           grid.
       •   Layer Settings: Provides a listing of the selected layers, indicating their directional bias
           (horizontal, vertical). Net names are provided for plane layers.
       •   Net Classes: Provides a listing of each net class and their defined width, via pad stack and the
           maximum number of vias. The autorouter routes all nets belonging to the same net class
           together in a pass.
       •   Pass Settings: Lists the scheduled passes and identifies the net classes to be routed during
           each. Some scheduled passes cannot be run, as explained in the next section.
       •   Pass Performance: For each routing pass completed, the report file lists a count and
           percentage of the lines scheduled and completed during the pass, and for the entire run so far.
           Also reported are vias that were added or deleted during the pass as well as for the entire
           routing session.
       •   Final Board Statistics: Final board statistics lists the total number of pads on the board, the
           number of equivalent 16-pin ICs (EICs), the dimensions and area of the design, the density (in
           square units per EIC; the lower this number is, the denser the board), the vias added during the
           routing process, the total number of routed lines (and percentage of routed lines to total lines),
           the total number of unrouted lines (and percentage of unrouted lines to total lines) and the
           total execution time for the routing session.

       If you abort the routing process, the report file reflects the final board statistics only up to the point
       of termination. A warning message appears in the report file, indicating the type of termination
       request made (stop and save or stop and don't save).




P-CAD PCB User’s Guide                                                                                        143
Chapter 7: Auto Routing                                                          Routing with Quick Route


        Route Cancel
        Choose Route Cancel to terminate a route before it is completed. When you choose this command,
        the following dialog appears:




        The Route Cancel dialog contains the following options:
        •   Stop routing and save: Stops routing and saves an output PCB file with the name provided in
            the Route Autorouters dialog.
        •   Stop routing and do not save: Stops routing and does not save an output PCB file. The input
            design file is restored to its original state.

        Options Commands
        During the routing process, you can choose one of the following commands without interrupting
        the routing process:

        Options Display
        Choose Options » Display to define color preferences, cursor style, and other display-related
        options. The Options Display dialog has two tabs: Colors and Miscellaneous.
        With the Colors tab, you set layer, item, and display colors for your workspace. With the
        Miscellaneous tab, you set various other options. Your settings are saved in the Pcb.ini file and
        remain in effect until you change them.
        For more information on the options in this dialog, see Options Display (page 442).

        Help Commands
        The commands in the Help menu give you the ability to gain access to the PCB Help file and the
        Help file for supported routers.

      Toolbar


        The following buttons appear from left to right:
        •   Route Info


144                                                                               P-CAD PCB User’s Guide
Routing with Quick Route                                                              Chapter 7: Auto Routing


       •   Route View Log
       •   Route Cancel
       •   View Zoom Window

   Quick Route Limitations
       Quick Route has the following limitations. If you fail to use it within these limits, you receive an
       error message when starting the routing process.
       •   Only simple pad and via styles are allowed. Quick route does not support the No Connect
           pad/via style.
       •   Only a single via style is allowed across all non-wide net classes. The current routing via as
           specified in the Route Autorouters dialog must be geometrically identical to any VIASTYLE
           attribute that exists for a net that is not routed with the wide pass.
       •   For nets routed with the wide pass, each of the net attributes VIASTYLE, WIDTH, and
           AUTOROUTEWIDE must be specified. There can be a different via style or line width for each
           wide net.
       •   The routing via can be no larger in diameter than twice the current routing grid. In the case of
           non-uniform routing grids, the smallest of the individual grid values is the limit.
       •   The allowed routing grids are 10 mil, 12.5 mil, 16.7-16.6-16.7 mil, 20 mil, and 25 mil. Metric grids
           are not supported, even in mm mode.
       •   The routing line width cannot exceed one half of the grid value. In the case of non-uniform
           grids, the smallest of the individual grid values is the limit.
       •   Global ripup and the RIPUP attribute are not supported.
       •   The MAXVIAS attribute is supported for maze routing only.
       •   There is no via grid multiple. Vias are placed on the routing grid.
       •   Blind and buried vias are not supported.
       •   Quick Route supports pads rotated in 90 degree increments only. If pads are rotated other than
           90 degrees, shorts can be created.

   Routing Fine Points
       There are several fine points to routing a board that will help you obtain a consistently high
       percentage of connections:
       •   Prerouted connections
       •   Keepouts
       •   Off-grid items
       •   Plane connections



P-CAD PCB User’s Guide                                                                                        145
Chapter 7: Auto Routing                                                             Routing with Quick Route


       •   Surface pads
       •   Grid selection
       •   Pad selection
       This chapter describes these fine points.

       Prerouted Connections
       P-CAD Quick Route allows you to preroute any critical connection, such as high-speed clock lines,
       using PCB. Quick Route checks all prerouted connections for electrical and clearance violations,
       and eliminates prerouted nets from its netlist so that they are not routed a second time. The
       preroute processing, however, is limited to layers enabled for routing.
       If a free pad or via is prerouted to a node in a net, the free pad or via is added to that net. This is
       useful for connecting surface-mount components and edge connectors to the Power and Ground
       planes, as described in Plane Connections (page 147).
       If a prerouted connection consists of several line segments, always try to place the segments end-
       to-end. Also, if an area needs to be filled with copper, use polygon fills instead of placing a number
       of criss-crossing line segments. These practices reduce the amount of memory required to process
       the preroutes and speed the processing of preroutes.

       Keepouts
       With PCB you can specify areas of the board where P-CAD Quick Route will not place lines. By
       placing a line segment or polygon fill on a Keepout, you are directing P-CAD Quick Route to avoid
       routing over these locations on all enabled layers of the PC board. A line segment, as opposed to a
       polygon fill, is really a “don't cross”, so lines can both restrict routing from a section or confine
       routing within a border.
       You can create a keepout on a particular layer by placing lines or a polygon fill on that specific
       layer. Quick Route will not place lines that cross a line or polygon fill.
       For example, in a typical board design, edge connectors are often placed so that they partially
       extend beyond the board outline, and are trimmed later during the manufacturing process to
       create a clean edge. The board outline (placed on the Board layer in PCB) acts as a barrier for Quick
       Route. All lines will be routed inside of the board outline. However, since part of your edge
       connector extends beyond the board outline, it is possible that Quick Route might connect edge
       connector pads using lines outside of the board outline.
       To avert this, create a keepout area over that portion of the edge connector, which extends beyond
       the board outline. The easiest way to do this is to place an all-layer polygon fill. Be sure the filled
       area extends at least 50 mils beyond the outside of the edge connector.

       Off-Grid Items
       If a pad is not centered on the selected grid, the program routes to the nearest grid point and then
       adds a small line segment between the grid point and the center of the pad. Off-grid pads and line
       segments tend to block subsequent routes more than do on-grid items, and they also lower the
       completion percentage. In PCB, try to place your components on the selected routing grid or some
       multiple thereof.



146                                                                                  P-CAD PCB User’s Guide
Routing with Quick Route                                                            Chapter 7: Auto Routing


       Plane Connections
       Quick Route derives its Power and Ground plane information from the net connection section of
       the PCB file. You can specify the nets to be connected to the Power and Ground planes when
       loading a netlist in PCB.
       If needed, you can specify a single plane net, such as for a board that has only a Ground plane (the
       power connections are routed).
       If you specify plane nets using Nets Load in PCB, every pad on the input PCB that appears in these
       nets is processed as follows:
       •   If the pad is not already connected to a plane, it is connected to the correct plane either
           directly or with a thermal relief, as determined by dialog selection in the Nets Load section of
           PCB, and no error message is issued.
       •   If the pad is connected in the original input file to the wrong plane, either with a thermal relief
           or a direct connection, it is connected to the correct plane either directly or with a thermal
           relief and an error message is issued.
       •   If the pad is already connected to the correct plane, P-CAD Quick Route does not modify the
           connection.
       After processing each pad in the plane nets, P-CAD Quick Route checks all the other pads on the
       PCB. If any of these pads are connected to a plane, the program removes the connection and
       displays a message to notify you of the removal.
       A free pad or via that is prerouted to a node in a net becomes a new node in that net. Preroutes are
       taken into account during the processing of plane nets. A free pad or via that is prerouted to a node
       in one of the plane nets is processed like any other node in that net.

       Split Planes
       P-CAD Quick Route does not support the split plane feature. It routes a net that is assigned to a
       split plane, unless you assign the NONAUTOROUTE attribute to the net.
       If the net contains SMD pads, you must add via fanouts to connect the pads to the split plane.

       Connecting Surface Pads to a Plane
       In PCB, you can place two types of pads:
       •   Through-hole pads (which belong to all PC board layers). The through-hole pads are used for
           component packages with leads that pass through all board layers.
       •   Surface pads (which belong to either the Top or Bottom layer). The surface pads are used for
           surface-mount components and edge connectors.
       You can connect through-hole pads directly to the Power or Ground plane. Surface pads, however,
       require that you connect the pad to a plane by means of a free via or free pad.
       Quick Route automatically places a via beside surface pads on the board, including SMDs and edge
       connectors, providing that:
       •   The surface pads are part of a net.


P-CAD PCB User’s Guide                                                                                      147
Chapter 7: Auto Routing                                                          Routing with Quick Route


       •   The surface pads are not already connected to a through hole pad.
       Vias connected to power or ground pins in the surface mount device are automatically connected
       to the appropriate power or ground plane. You can prevent connectivity by setting the plane layer
       Shape to No Connect or by selecting the Prohibit Copper Pour Connections check box in the
       Modify Via Style (Complex) dialog. If you have interrupted a via’s connectivity, PCB displays a blue
       connection line to indicate that you should route the connection.
       The Via Minimization post-routing pass removes a via if the program can swap the via's connecting
       lines to another layer without violating the design rules. The Via Minimization pass, however, does
       not affect vias connected to the Power and Ground planes. A via prerouted to a surface pad (for the
       purpose of connecting the surface pad to a plane) will not be removed.

       Direct Connections and Thermal Reliefs
       A component lead is connected to a plane by not clearing copper from the area on the plane where
       the hole will be drilled. This provides good conduction between the lead and the entire plane, both
       electrically and thermally. The first is desirable, the second is not necessarily so.
       When the board is soldered, any leads connected to a large area of copper will not rise in
       temperature as quickly as other leads. This can either cause poor solder joints or require more
       heat, neither of which is desirable.
       The solution is to connect the lead electrically, but not thermally, to the plane of copper, using a
       special symbol called a thermal relief. A thermal relief is a small island of copper around the lead,
       isolated from the plane by an annular gap. The plane is then connected to the island by two or four
       narrow bridges of copper (termed spokes). These spokes provide the electrical connection and the
       gap provides the thermal isolation.
       When the planes are interior to the PCB, thermal reliefs are generally used. If you are designing a
       double-sided PCB and you want a bare copper Ground plane for the Bottom layer (as is often the
       case for RF designs), use direct connections to the Ground plane.

       Surface Pads
       While P-CAD Quick Route permits you to set the orientation of routes on any layer, a typical
       double-sided board will be routed with horizontal lines on the Top layer and vertical lines on the
       Bottom layer. This convention makes it difficult to route a set of surface pads that are arranged
       horizontally on the Top layer or vertically on the Bottom layer.
       For example, consider an edge connector on the Top layer with surface pads arranged parallel to
       the bottom of the board. P-CAD Quick Route will have difficulty completing connections to the
       middle pads in the edge connector (all pads other than the first and last) since it cannot easily
       access these pads with horizontal lines.
       To ensure high rates of completions in these cases, P-CAD Quick Route automatically places a via
       beside surface pads on the board, including SMDs and edge connectors, providing that:
       •   The surface pads are part of a net
       •   The surface pads are not already connected to a through hole pad
       The via or pad then becomes a potential target for routes to the surface pad.



148                                                                               P-CAD PCB User’s Guide
Routing with Quick Route                                                            Chapter 7: Auto Routing


       Selecting the Right Grid
       Five different grids are available for use in P-CAD Quick Route. Selecting a finer grid permits one,
       two, three, even five lines to be autorouted between adjacent pads. This can result in higher
       completion rates on fewer board layers.
       With this flexibility comes the added responsibility for carefully planning the pad sizes, line widths
       and component placement grid so that you can get the most out of P-CAD Quick Route.
       The first step is to determine your board manufacturer's capabilities and to verify the yields
       available with various line densities. This will help you determine the best design rules to enforce
       both on your placement and prerouting, and on the autorouted lines in P-CAD Quick Route.
       Planning in advance is absolutely required. If you place your components on a 50 mil grid, you can
       autoroute on a 25, 16.7 or 12.5-grid. Placing components on a 20 mil grid suggests the use of the 20
       or 10 mil grids in P-CAD Quick Route. The least common denominator supporting all routing grids
       is a 100 mil grid for component placement. Changing grids in P-CAD Quick Route could result in
       many off-grid components and pads, thus lowering completion rates.

       Selecting the Right Pads
       In addition to selecting an optimum grid for placement of your components, pad sizes also effect
       the ability of the autorouter to place one or more lines between adjacent pads. The following table
       provides the maximum pad sizes for each routing grid, which give the desired effect.


          Grid Size     Recommended DIP           Recommended          SMT Pad Diameter
                          Pad Diameter             Via Diameter
        25            62                         40                   --
        20            50                         40                   --
        16.7          40                         40                   --
        12.5          54                         32                   30
        10            66,46                      24                   26




P-CAD PCB User’s Guide                                                                                     149
                                                                                     CHAPTER              8


                                                           Design Verification

Introduction to Design Verification
       This chapter discusses procedures used to verify your design. Included is a description of the
       attributes checked by DRC for each category of rules. There is also an explanation of the hierarchy
       used to obtain a value for an attribute’s DRC check, from lowest to highest. In addition, the effect
       of a copper tie on DRC is detailed.


Setting Up DRC Rules
       The rules for a board’s clearances, widths, lengths and placements are set in the Options Design
       Rules dialog, which is opened by selecting Design Rules from the Options menu.
       Design rules can be defined on each of six levels: Design, Layer, Rooms, Net Class, Net and Class-
       to-Class. Each of these levels, found on individual tabs in the dialog, is briefly described in the
       following sections. More information on the Options Design Rules dialog can be found in Options
       Design Rules (page 459).

   Design Tab
       The Design tab of the Options Design Rules dialog displays the clearance values that are applied at
       the “design” level of the rules hierarchy, as shown in the following figure:




P-CAD PCB User’s Guide                                                                                    151
Chapter 8: Design Verification                                                         Setting Up DRC Rules




        To add design rules, click the Add button to open the Place Attribute dialog. The Properties button
        opens the Attribute Properties dialog where the value of an attribute can be modified. For more
        information on the Place Attribute and Attribute Properties dialogs, see Edit Properties (page 292).

      Layer Tab
        As shown in the following figure, the Layer tab contains a list of enabled layers and the clearance
        values of the currently loaded design file.




152                                                                                 P-CAD PCB User’s Guide
Setting Up DRC Rules                                                              Chapter 8: Design Verification


       In the Layer tab, click Set All to select all layer names with items in the Layers list. Click Clear All to
       cancel the selection of all layers in the list. You can select or cancel the selection of a layer by
       clicking a layer in the list.
       Clearance values for the selected layer appear in the Pad to Pad, Pad to Line, Line to Line, Pad to
       Via, Line to Via, and Via to Via boxes. If you have a variety of settings and you click on two layers
       that contain conflicting values, the box will be blank.
       To modify a clearance value for the selected layers, type a value in one of the text boxes and click
       Update. Nets with clearance attributes defined will override the layer clearance values for DRC. The
       report produced by the DRC includes clearances specified for specific nets. Additionally, clearance
       violation tests report shorts except where two or more nets are tied with a copper tie and the
       TieNet values of the nets and copper tie are the same.
       Click Edit Rules to open the Attribute dialog where you can add, delete and view an attribute’s
       properties. To define a value for an attribute, click Add. The Attribute dialog appears. You can
       assign a value to any number of attributes in various categories. For information on the Attribute
       dialog, see Place Attribute (page 396).
       Click Set Defaults to return all layer/item settings to 12 mil clearances.
       Click OK when you have finished setting up the design rules (and return to the main DRC dialog).
       From the main dialog, click OK to begin the design rule checking process.

   Rooms Tab
       The Rooms tab displays the rooms in the design as shown in the following figure:




P-CAD PCB User’s Guide                                                                                          153
Chapter 8: Design Verification                                                         Setting Up DRC Rules


        The rules associated with a selected room are displayed in the Rules list box. The Placement Side
        frame shows the side of the layer where the room has been placed. Room rules can be modified by
        clicking the Edit Rules button or double-clicking the rule in the Rules list box.

      Net Class Tab
        The Net Class tab of the Options Design Rules dialog displays the defined Net Classes and their
        associated Rules, as shown in the following figure:




        The Net Class tab lists all net classes and the rules associated with each Net Class and Net Class
        Layer. In the Net Class tab you can access the Net Class and Net Class Layer Rules, select net classes
        by net class and layer rules, Edit the net classes and view rules.
        For more information on the Net Class tab options, see Net Class Tab (page 462).

      Net Tab
        The Net tab of the Options Design Rules dialog provides access to the net and net layer rules.
        When you click the Net tab, the dialog appears as follows:




154                                                                                 P-CAD PCB User’s Guide
Setting Up DRC Rules                                                          Chapter 8: Design Verification




       The options in the Net tab allow you to specify clearance rules for a specific net in the design. The
       dialog lists all nets and shows the net and net layer rules associated with the selected net. In
       addition, you can select nets by net rules or layer rules, view rules and edit the nets.
       For more information on using the Net tab of the Options Design Rules dialog, see Net Tab (page
       464).

   Class to Class Tab
       When you click the Class to Class tab, the dialog appears as shown in the following figure:




P-CAD PCB User’s Guide                                                                                     155
Chapter 8: Design Verification                                                            Setting Up DRC Rules


        Use the options in the Class-to-Class tab to specify clearance rules for a specific class-to-class in the
        design. The dialog lists all defined class-to-classes and shows the rules and layer rules associated
        with them. In addition, you can select class-to-classes by class-to-class rules or layer rules, view
        rules and edit the class-to-classes.
        For more information on using the Class-to-Class tab of the Options Design Rules dialog, see Class
        to Class Tab (page 466).

      Working with Design Rule Check
        In working with the rules you want to apply to your circuit board, you need to know not only which
        rules are included in the Design Rule Check, but also the valid hierarchical levels for those rules
        and the rule category to which they apply.

      Design Rules by Hierarchy
        The first table shows the rules included in the Design Rule Check to which values can be assigned
        in each test category. It also includes the order of precedence (hierarchy), from high to low, by
        which the Rule Check looks for the presence of the rule’s value. For instance, if the Clearance rule
        has a value only at the Layer level, the Design Rule Check would have searched and found no
        assigned Clearance value in the Class-To-Class, Net, and Net Class rules and would then use the
        value set at the Layer level.


                  Test Category                            Rules                            Hierarchy
          Netlist Compare                   None                                   None
          Clearance Violations              Clearance                              Class-To-Class Layer
                                            LineToLineClearance                    Class-To-Class
                                            PadToLineClearance                     Net Layer
                                            PadToPadClearance                      Net
                                            ViaToLineClearance                     Net Class Layer
                                            ViaToPadClearance                      Net Class
                                            ViaToViaClearance                      Layer (except Clearance)
                                            BoardEdgeClearance                     Layer
                                                                                   Design
          Width Violations                  Width                                  Net Layer
                                                                                   Net
                                                                                   Net Class Layer
                                                                                   Net Class
                                                                                   Layer
                                                                                   Design




156                                                                                   P-CAD PCB User’s Guide
Setting Up DRC Rules                                    Chapter 8: Design Verification



                 Test Category                Rules                Hierarchy
         Netlist Violations       MaxVias                 Net
                                  ViaStyle                Net Class
                                                          Layer
                                                          Design
         Unrouted Nets            None                    None
         Unconnected Pins         None                    None
         Net Length               MinNetLength            Net
                                  MaxNetLength            Net Class
                                                          Design
         Silk Screen Violations   SilkscreenClearance     Design
         Copper Pour Violations   Clearance               Class-to-Class Layer
                                  LineToLineClearance     Class-To-Class
                                  PadToLineClearance      Net Layer
                                  ViaToLineClearance      Net
                                  BoardEdgeClearance      Net Class Layer
                                                          Net Class
                                                          Layer
                                                          Design
         Plane Violations         Clearance               Class-to-Class Layer
                                  LineToLineClearance     Class-To-Class
                                  PadToLineClearance      Net Layer
                                  ViaToLineClearance      Net
                                                          Net Class Layer
                                                          Net Class
                                                          Layer
                                                          Design
         Component Violations     PlacementSide           Component
                                                          Room
                                                          Design


                                  MaxComponentHeight      Room
                                                          Layer
                                                          Design
         Drilling Violations      HoleToHoleClearance     Design




P-CAD PCB User’s Guide                                                            157
Chapter 8: Design Verification                                                         Setting Up DRC Rules



                  Test Category                           Rules                           Hierarchy
          Test Point Violations            TestPointAccuracy                     Design
                                           TestPointCenter                       Design
                                           TestPointGrid                         Design
                                           TestPointPermitted                    Design
                                                                                 Net Class
                                                                                 Net
                                           TestPointRequired                     Design
                                           TestPointSide                         Design
                                                                                 Net Class
                                                                                 Net
                                           TestPointSpacing                      Design
                                                                                 Net Class
                                                                                 Net


      Design Rules by Hierarchy
        The next table illustrates how the test categories apply to the hierarchical levels, and lists the
        applicable rules. This table begins with the most specific hierarchical level and graduates up to the
        most general level.


                    Hierarchy                        Test Category                           Rules
          None                             Netlist Compare                       None.
                                           Unrouted Nets
                                           Unconnected Pins
          Component                        Component Violations                  PlacementSide only.
          Room                             Component Violations                  PlacementSide
                                                                                 MaxComponentHeight




158                                                                                 P-CAD PCB User’s Guide
Setting Up DRC Rules                                      Chapter 8: Design Verification



                     Hierarchy            Test Category                 Rules
         Class-to-Class Layer    Clearance Violations       Clearance
                                 Copper Pour Violations     LinetoLineClearance
                                 Plane Violations           PadToLineClearance
                                                            PadToPadClearance
                                                            ViaToLineClearance
                                                            ViaToPadClearance
                                                            ViaToViaClearance
                                                            BoardEdgeClearance
                                                            NOTE: Lines, arcs and vias
                                                            cannot touch a keepout.
         Class-to-Class          Clearance Violations       Clearance
                                 Copper Pour Violations     LinetoLineClearance
                                 Plane Violations           PadToLineClearance
                                                            PadToPadClearance
                                                            ViaToLineClearance
                                                            ViaToPadClearance
                                                            ViaToViaClearance
                                                            BoardEdgeClearance
                                                            NOTE: Lines, arcs and vias
                                                            cannot touch a keepout.
         Net Layer               Clearance Violations       Clearance
                                 Width Violations           LinetoLineClearance
                                 Copper Pour Violations     PadToLineClearance
                                 Plane Violations           PadToPadClearance
                                                            ViaToLineClearance
                                                            ViaToPadClearance
                                                            ViaToViaClearance
                                                            BoardEdgeClearance
                                                            Width
                                                            NOTE: Lines, arcs and vias
                                                            cannot touch a keepout.




P-CAD PCB User’s Guide                                                               159
Chapter 8: Design Verification                                  Setting Up DRC Rules



                    Hierarchy             Test Category               Rules
          Net                    Clearance Violations     Clearance
                                 Netlist Violations       LinetoLineClearance
                                 Net Length               PadToLineClearance
                                 Copper Pour Violations   PadToPadClearance
                                 Plane Violations         ViaToLineClearance
                                 Test Point Violations    ViaToPadClearance
                                                          ViaToViaClearance
                                                          BoardEdgeClearance
                                                          MaxVias
                                                          ViaStyle
                                                          MinNetLength
                                                          MaxNetLength
                                                          TesPointRequired
                                                          TestPointGrid
                                                          TestPointSpacing
                                                          TestPointPermitted
                                                          TestPointAccuracy
                                                          TestPointSide
                                                          TestPointCenter
                                                          NOTE: Lines, arcs and vias
                                                          cannot touch a keepout.
          Net Class Layer        Clearance Violations     Clearance
                                 Width Violations         LinetoLineClearance
                                 Copper Pour Violations   PadToLineClearance
                                 Plane Violations         PadToPadClearance
                                                          ViaToLineClearance
                                                          ViaToPadClearance
                                                          ViaToViaClearance
                                                          BoardEdgeClearance
                                                          Width
                                                          NOTE: Lines, arcs and vias
                                                          cannot touch a keepout.




160                                                          P-CAD PCB User’s Guide
Setting Up DRC Rules                                      Chapter 8: Design Verification



                     Hierarchy            Test Category                 Rules
         Net Class               Clearance Violations       Clearance
                                 Netlist Violations         LinetoLineClearance
                                 Net Length                 PadToLineClearance
                                 Copper Pour Violations     PadToPadClearance
                                 Plane Violations           ViaToLineClearance
                                 Test Point Violations      ViaToPadClearance
                                                            ViaToViaClearance
                                                            BoardEdgeClearance
                                                            MaxVias
                                                            ViaStyle
                                                            MinNetLength
                                                            MaxNetLength
                                                            TesPointRequired
                                                            TestPointGrid
                                                            TestPointSpacing
                                                            TestPointPermitted
                                                            TestPointAccuracy
                                                            TestPointSide
                                                            TestPointCenter
                                                            NOTE: Lines, arcs and vias
                                                            cannot touch a keepout.




P-CAD PCB User’s Guide                                                               161
Chapter 8: Design Verification                                                          Setting Up DRC Rules



                      Hierarchy                       Test Category                           Rules
          Layer                             Clearance Violations                  Clearance
                                            Netlist Violations                    LinetoLineClearance
                                            Net Length                            PadToLineClearance
                                            Copper Pour Violations                PadToPadClearance
                                            Plane Violations                      ViaToLineClearance
                                            Component Violations                  ViaToPadClearance
                                                                                  ViaToViaClearance
                                                                                  MaxVias
                                                                                  ViaStyle
                                                                                  MinNetLength
                                                                                  MaxNetLength
                                                                                  TesPointRequired
                                                                                  TestPointGrid
                                                                                  TestPointSpacing
                                                                                  TestPointPermitted
                                                                                  TestPointAccuracy
                                                                                  TestPointSide
                                                                                  TestPointCenter
                                                                                  MaxComponentHeight
                                                                                  NOTE: Lines, arcs and vias
                                                                                  cannot touch a keepout


        Additional Design Rules
        The third table, shown on the following page, lists additional checks performed by DRC, which are
        not user, specified. You do not have to add attributes or specify values for attributes in order for
        DRC to check these constraints. For instance, DRC checks components for inclusion in a Room.
        You cannot set a value for this check since there is no attribute associated with it, but it is part of
        the verification that DRC performs.


             Test Category                              DRC Checks
          Clearance               Short
                                  Short to Copper Tie
                                  Uncommitted Pins Shorted




162                                                                                  P-CAD PCB User’s Guide
Setting Up DRC Rules                                                Chapter 8: Design Verification



            Test Category                         DRC Checks
         Component          Component Side
                            Component Height
                            Room Inclusion
                            Empty Room
         Copper Pour        Copper Pour Clearance
                            Unconnected Copper Pour Island
                            Unpoured Copper Pour
                            Copper Pour No Net
         Drilling           Drilling Clearance
                            Hole Range Same Layer
                            Hole Range Conflict
         Net Length         Net Length
         Netlist            Point-to-Point Connectivity
                            Pseudo Pattern
                            Undefined Via Style
                            Tie Net Connectivity to Copper Tie
                            Net Connectivity to Uncommitted Pins
         Plane              Plane Clearance
                            Fragmented Plane
                            Plane Partial Connections
                            Plane Shorts
                            Plane Unconnected
                            Plane No Net
                            Plane Overlap
         Silk Screen        Silk Screen
         Clearance
         Test Point         Test point not on net copper.
                            Test point not positioned on grid.
                            Test point violates spacing rule.
                            Test point not permitted on object.
                            Test point not centered on SMT.
                            Test point not centered on thru hole.
                            Test point pad and via accuracy.
                            Test point required by net.
                            Test point on wrong side.




P-CAD PCB User’s Guide                                                                        163
Chapter 8: Design Verification                                                                Configuring DRC



                Test Category                           DRC Checks
             Text                  Text Clearance
             Unconnected Pin       Unconnected Pin
             Unrouted Net          Unrouted net
                                   Hole Range No connect
                                   Hole Range Violation


      Copper Ties and DRC
        When Design Rules Checking encounters a copper tie the standards listed below are applied and
        errors or warnings are issued where appropriate:
        •      DRC does not report a short when two or more nets are connected by a copper tie. However, if
               two nets are already in a shorted condition, an error is reported even if a copper tie is laid on
               top of the shorted area.
        •      An error is issued when a copper tie is placed without physically touching at least two nets.
        •      A net with a TieNet value, which is not connected to a copper tie with the same TieNet value, is
               an error.
        •      An error occurs when a copper tie has a clearance violation or shorts with another net that
               does not have the same TieNet value.


Configuring DRC
        This section describes how to set up the report file destination and specify report options.
        1.     Choose Utils » DRC. The Utils Design Rule Check dialog appears as shown in the figure:




164                                                                                   P-CAD PCB User’s Guide
Configuring DRC                                                               Chapter 8: Design Verification


            The name of the destination report appears next to the Filename button. By default, the report
            has the same name as the design file with the .drc file name extension.
       2.   In the Report Options frame, select the following options:
            •   View » Reports: Select this check box to view the DRC report file when design rule
                checking is complete.
            •   Summarize Ignored Errors: Select this check box to include the number of ignored errors
                in the report. Ignored errors are not included in the output of the report unless this option
                is selected.
            •   Summarize Overridden Errors: Select this check box if you have overridden the display of
                errors in the design, but want them to be summed in the report.
       3.   In the Error Options frame, select the following options:
            •   Annotate Errors: Select this check box to create DRC error indicators, which will be
                displayed on your design. These indicators can then be selected for viewing of error
                information. The error information is determined by the other error/violation options that
                you enable in design rule checking.
            •   Clear All Overrides: Select this check box to clear all overridden errors.
       4.   Click Design Rules to open the Options Design Rules dialog. Use this dialog to add, delete and
            modify rules. For more information, see Options Design Rules (page 459).
       5.   In the Utils Design Rule Check dialog, click Severity Levels, The Rules Severity Level dialog
            appears as shown in the following figure:




            Use this dialog to change the severity of the design rules. In the Rules Severity Level dialog,
            select a rule from the Rule list and choose one of the buttons in the Severity Level frame: Error,



P-CAD PCB User’s Guide                                                                                      165
Chapter 8: Design Verification                                                               Configuring DRC


             Warning or Ignored. To restore the default settings, select the Set Default check box. Then,
             click OK to close the dialog.

             If you choose Ignored in the Summarize Errors frame, the error is not listed in the report, but
             will be summarized in the report if you select the Summarize Ignored Errors check box in the
             Report Options frame on the Utils Design Rule Check dialog.

        6.   In the Design Rule Checks frame, select the following options:
             •   Netlist Compare: Select this check box to compare a Tango, P-CAD ASCII, or PCAD ALT
                 format netlist file with the current nets in the design.
             •   Clearance Violations: Select this check box to enable air-gap and board edge clearance
                 checking and report shorts. If the Clearance Violations option is disabled, no clearance
                 errors will be reported.

             The clearance violation check considers items physically connected if they overlap or have a
             clearance of 0 mil. Arcs, polygons, pads, lines, copper pours and vias can be physically
             connected to one another, however, lines, arcs and vias cannot touch a keepout. In addition,
             the bounding rectangle of text placed in the design is checked to assure that it does not short
             to other copper on the signal layers.

             •   Text Violations: Select this check box to report all clearance violations between text and
                 other items on signal layers.
             •   Netlist Violations: Select this check box to enable electrical checking against the netlist
                 within the design. The report includes a warning for those objects that are not point to
                 point routed. If there are no nets in the design, this option is ignored.
             •   Width Violations: Select this check box to verify that the line and arc widths are within the
                 designated widths.
             •   Unrouted Nets: Select this check box to enable reporting of any nets that are currently
                 unrouted (unrouted connections still exist in the design). The warning includes the
                 location of the objects.
             •   Unconnected Pins: Select this check box to enable the reporting of all pins that are not
                 connected to other pins. This includes all of the single-node routes as well as pins that are
                 not connected or assigned to a net.
             •   Net Length: Select this check box to enable the reporting of net lengths, which exceed the
                 minimum, and/or maximum lengths set for lines and arcs within the net.
             •   Silkscreen Violations: Select this check box to enable checking on pad/via to silkscreen
                 violations. Silkscreen on pads on top layer can interfere with soldering process; on vias it
                 can cause paint dripping or collecting in unwanted areas.
             •   Copper Pour Violations: Select this check box to enable reporting of unflooded copper
                 pour entities, copper pours that are not part of a net, copper pour island clearance
                 violations, unconnected islands, fill areas and thermal connections that have clearance
                 violations.


166                                                                                  P-CAD PCB User’s Guide
Online DRC                                                                       Chapter 8: Design Verification


             •   Plane Violations: Select this check box to enable reporting of overlapping planes, invalid
                 pad and via copper connections, connected pad and vias that are not electrically
                 connected to the plane, isolated areas of copper in a plane.
             •   Component Violations: Select this check box to enable reporting of violations, which
                 occur when the desired space between components is less than the specified value.
             •   Drilling Violations: Select this check box to enable connectivity checking of pads/vias
                 through their attached layers, utilizing the layer ordering and hole range for determining
                 where the pad/vias begin and end.
             •   In addition, Drilling Violations checks for layer separation, interference between holes,
                 collocated holes, and vias existing solely on a signal layer.
             •   Test Point Violations: Select this check box to check for nets that do not have a required
                 test point. This option also checks for test points that do not fall on the correct object, or
                 on the specified test point grid or pad center. In addition, it checks for test points that fall
                 inside of the minimum spacing or on a different side of the board than the net requires.
       7.    Click OK to start the design rule check. If you selected the View Reports check box, the DRC
             report file appears when design rule checking is complete.


Online DRC
       Online DRC is available to interactively display rule violations as the board is being built. Online
       DRC checks for clearance and net width violations, shorts of traces (both lines and arcs) and vias,
       and net references to non- existent via styles that are added to a design during manual routing.
       Depending on the options chosen in the General tab of the Options Configure dialog, online DRC
       performs a check of the traces and vias against all items, excluding copper pours, on signal layers to
       determine if a DRC violation occurred. A violation occurring on a non-signal layer (such as a via
       intersecting a silk layer item) is not detected with Online DRC.
       Online DRC is activated by clicking the Online DRC button on the toolbar or selecting the Enable
       Online DRC check box in the Online DRC page of the Options Configure dialog. For complete
       information on the options available to Online DRC, see Options Design Rules (page 459).


Using DRC Error Annotation
       This section describes the steps for displaying and viewing DRC annotated errors. You will also
       learn how to override the display of error indicators individually and globally. The commands you
       will learn to use include the following:
       •     Utils Find Errors: This command opens the Find Errors dialog, which provides quick access to
             all annotated errors. For details, see Finding DRC Errors (page 168).
       •     Options Display: This command opens the Options Display dialog. If you select the Display
             Overridden Errors check box in the Miscellaneous tab, overridden error indicators will appear
             in the design. For details, see Overriding Error Displays (page 169).




P-CAD PCB User’s Guide                                                                                         167
Chapter 8: Design Verification                                                    Using DRC Error Annotation


        •    Options » Selection Mask: This command opens the Options Selection Mask dialog, in which
             you can set whether to include DRC annotated error indicators in block selection. For details,
             see
        •    Block Selecting Error Indicators (page 169).
        •    Edit Override/Unoverride: This command lets you set the shape used when individual error
             indicators are seen in the design. For details, see Overriding DRC Errors (page 170).
        •    Edit » Properties: This command gives you access to error information for a selected error
             indicator by providing another path to the Find DRC Errors dialog. For details, see Fixing DRC
             Errors (page 170).
        •    Edit Delete: This command gives you the ability to delete DRC error indicators from your
             design as they are resolved. For details, see Deleting DRC Errors (page 170).
        The DRC error annotations that are generated with the Utilities DRC command are displayed as
        graphic indicators in your design. Newly added indicators are always visible.

      Finding DRC Errors
        The recommended method for using DRC error annotation to find design errors is as follows.
        1.   Choose Utils Find Errors to view the errors in the Find DRC Errors dialog.




        2.   Show the error you want to correct and go directly to it in the design by clicking Jump To.

             If you do not want to see a particular error while scrolling through the list of errors, enable the
             Override - Don’t display this error again option. To scroll through only the overridden errors,
             enable the Show Only Overrides option.

             To view another error you can use any of these methods:
             •   If you know the number of the error, you can enter it in the Error Number box and click
                 Find. The error finder goes directly to that error and displays it in the Description area.
             •   You can scroll through the errors using the up and down arrows next to the Error Number
                 box until you find the error you want to view.
             •   If you have block selected an area in the design, and want to view only the errors in that
                 area, select the Show Only Selected check box.



168                                                                                   P-CAD PCB User’s Guide
Using DRC Error Annotation                                                     Chapter 8: Design Verification


       Click Jump To and the error finder positions the cursor in the center of the error indicator in your
       design.

   Overriding Error Displays
       To globally control the display of DRC error indicators, choose Options » Display. When the
       Options Display dialog appears, click the Miscellaneous tab. Then, select the Display Overridden
       Errors check box in the Miscellaneous frame.




       When the Display Overridden Errors check box is selected, any DRC error whose display has been
       overridden appears in the design as an inverted triangle.

       If you do not want to see a particular error while scrolling through the list of errors, enable the
       Override - Don’t display this error again option. To scroll through only the overridden errors,
       enable the Show Only Overrides option.




   Block Selecting Error Indicators
       To include DRC error indicators in a block selection, enable the DRC Error item in the Options
       Selection Mask dialog.




P-CAD PCB User’s Guide                                                                                       169
Chapter 8: Design Verification                                                   Using DRC Error Annotation


      Overriding DRC Errors
        To override the display of a DRC error indicator, select an error. Then, right-click the error and
        choose Override from the shortcut menu. When overriding an error indicator, you can hide it from
        view or change its shape.

        The Utils » DRC command ignores an error condition if the error was previously overridden.

        To show overridden errors, select the Display Overridden Errors check box in the Miscellaneous
        tab of the Options Display dialog. When selected, an overridden error indicator appears as an
        inverted triangle.
        To remove an override from an error indicator, select the error. Then, right-click and choose
        Unoverride from the shortcut menu.

      Fixing DRC Errors
        The recommended method for using DRC error annotation to fix design errors is as follows:
        1.   Choose Utils Find Errors to open the Find DRC Errors dialog.
        2.   Display the error to correct. Then, click Jump To to go directly to the design.
        3.   Continue resolving the errors in the design in this same manner until all errors are fixed.

      Deleting DRC Errors
        You can delete the DRC error indicators from your design as they are resolved. To delete an error
        indicator, choose one of these methods.
        •    To delete an error, select the error and press the DELETE key or choose Edit Delete.
        •    To delete resolved error indicators only, choose Utils » DRC. This deletes all resolved error
             indicators, leaving only unresolved errors. Each time you choose Utils » DRC, all existing DRC
             error indicators are removed automatically.
        You can also hide an error indicator by selecting an error and choosing Edit Override. To do this,
        clear the Display Overridden Errors check box in the Miscellaneous tab of the Options Display
        dialog.




170                                                                                 P-CAD PCB User’s Guide
                                                                                      CHAPTER             9


                                                                                                CAM

Introduction to CAM
       This chapter explains how to perform CAM functions for both Gerber and N/C Drill file output. We
       have provided you with a special design, Tutor3.pcb, for you to use in this chapter. Load this
       design using the File » Open command.


Gerber Output
       In this section, you will set up Gerber output files, assign and describe apertures both automatically
       and manually, set up the Gerber format, and then finally generate the output.
       Choose File » Export » Gerber to open the File Gerber Out dialog shown in the following figure:




P-CAD PCB User’s Guide                                                                                    171
Chapter 9: CAM                                                                                 Gerber Output


         From this dialog you can gain access to a number of dialogs and features, as shown in the following
         illustration.
                                          File Gerber Out
                                            (generate output)




         Setup Output Files       Apertures          Drill Symbols   Gerber Format
                                    (unassign)
                                  (auto assign)



                                     Assign
                              (manual describe/assign)


         Use the File Gerber Out dialog to generate the Gerber output, and where you set or clear files for
         output, produce compressed output or executable files in addition to accessing other important
         dialogs.
         The Generate Output Files, Set All, and Clear All buttons are shaded and not available until you
         define the output files.

      Set Up Output Files
         To set up output files, follow these steps:
         1.   Choose File » Export » Gerber to open the File Gerber Out dialog.
         2.   Click Setup Output Files. The following Setup Output Files dialog appears.




172                                                                                  P-CAD PCB User’s Guide
Gerber Output                                                                                Chapter 9: CAM


       3.   Your output files have the same base name as the design file, but each with a unique
            extension. Typical extensions used to differentiate files would be layer-specific, such as .top
            for Top layer, .bot for Bottom layer, .tsk for Top Silk, etc.
       4.   In the File Extension box, type: TEXT
       5.   In the Layers list, select Top.
       6.   Select the Pads and Vias check boxes. Then, click Add to add Tutor3.top to the Output File
            list.
       7.   In the File Extension text box, type: BOT
       8.   Select the Bottom layer in the Layers list.
       9.   Use the same options and output path as you did for TOP. Click Add to add Tutor3.bot to
            the Output File list.
       10. In the File Extension text box, type: TSK
       11. Select the Top Silk layer in the Layers list.
       12. Select the Ref Des, Type, and Value check boxes, and clear all other check boxes.
       13. Click Add to add Tutor3.tsk to the Output File list.
       14. Specify the Output Path as C:\PCAD\TUTORIAL. If you enter an invalid path, you'll get an error
           message when you try to close the dialog.




            The pathname (Output Path) is a global option – all output files are placed in the same
            directory.




P-CAD PCB User’s Guide                                                                                    173
Chapter 9: CAM                                                                                  Gerber Output


        15. Click Close to exit the dialog and return to the File Gerber Out dialog. The Gerber files
            Tutor3.top, Tutor3.bot, Tutor3.tsk appear in the Output Files list.

      Aperture Assignments
        In the File Gerber Out dialog, click Apertures. The Aperture Assignments dialog appears. Use the
        options in this dialog to create and assign apertures automatically or manually.




        Automatic Create and Assign
        To automatically create and assign apertures, select the Clear current apertures check box. If you
        don't want to clear your current apertures and assignments, clear the Clear current apertures check
        box. Then, click Auto. The program creates and assigns any additional apertures that are required.
        The list in this dialog displays the items of the loaded design file and any aperture assignments that
        may exist for those items, allowing you to view which items are assigned and what those
        assignments are.
        1.   Select the Clear current apertures check box.
        2.   Click Auto to automatically describe and assign all apertures for all items. The dialog displays
             the assignments, as shown in the following figure.




174                                                                                  P-CAD PCB User’s Guide
Gerber Output                                                                                  Chapter 9: CAM




       Assigning Apertures Manually
       To describe and assign an aperture manually (or to change an existing assignment), double-click an
       item line, or select an item line and click Assign. The Describe/Assign Apertures dialog appears.
       You will unassign certain apertures that were assigned automatically in the previous lesson, and
       then manually assign them.
       1.   In the Aperture Assignments dialog, select PAD EL 50 mil 50 mil 50.0 mil, then click Assign to
            open the following dialog.




       2.   Whatever item name you highlighted on the previous dialog appears in the Assign Aperture to
            field at the top of this dialog. The aperture names appear in the Apertures list.

       Modifying an Assignment
       The item characteristics are listed to the right of the list, and the aperture characteristics are listed
       there as well (if an aperture is assigned). You can change the characteristics by using the text boxes
       and the Shape and Type combo boxes. You can also enter a comment for future reference.



P-CAD PCB User’s Guide                                                                                       175
Chapter 9: CAM                                                                                    Gerber Output


         1.   The aperture D015 is already selected because it had been automatically created and assigned
              in the previous dialog. To select a different aperture to assign, select the item in the Apertures
              list.
         2.   Modify any of the options that appear on the right side of the dialog. For example, change the
              Type to Flash/Draw.
         3.   When you have entered the characteristics, click Modify.
              The changes you made are reflected in the selected aperture.
         4.   Click Close to return to the Aperture Assignments dialog, where the assignments you've made
              are now listed. From Aperture Assignments you can click Close to return to the main File
              Gerber Out dialog.

      Setting Drill Symbols
         From the File Gerber Out dialog, click Drill Symbols to open the Drill Symbol Assignments dialog.
         From this dialog, you can assign drill symbols manually or automatically.




         Automatic Assign
         To automatically assign drill symbols, you can either let the program automatically make all
         assignments, or you can clear (unassign) all existing assignments and then automatically assign all
         of them. You can click Unassign All to clear everything or Unassign to clear the hole diameter that
         is highlighted.
         The list of this dialog displays the hole diameters of the loaded design file and any drill symbol
         assignments that may exist for those hole diameters, allowing you to view which items are assigned
         and what those assignments are.


176                                                                                   P-CAD PCB User’s Guide
Gerber Output                                                                                 Chapter 9: CAM


       1.   Click Automatic Assign to automatically assign a drill symbol to each hole diameter in the
            design.

       Manual Assign
       To manually assign drill symbols:
       1.   Select 18.0 mil under Hole Diameter in the list.
       2.   Select Diamond_X from the Drill Symbols list.
       3.   Click Assign. Diamond X will appear next to 18.0 mil in the list.
       4.   Click Close.
       The File » Print and File » Export » Gerber features share common drill symbol assignments; when
       symbols are assigned in one, they will apply to the other.

   Gerber Format
       In this section you'll be setting output units, the numeric format, and other format options for
       Gerber output.
       From the File Gerber Out dialog, click the Gerber Format button to open the Gerber Format dialog.




       You will be using the default Gerber output format, RS-274-D. To output this format, clear the
       Include Aperture Definitions check box.
       Choose Inches in the Output Units frame. This option is selected by default.
       1.   Choose 4.4 in the Numeric Format frame. This option is selected by default.
            The format 4.4 means that there are four digits to the left of the decimal point and four digits to
            the right. The format 5.3 means that there are five digits to the left of the decimal point and
            three digits to the right.
       2.   Leave the G54 w/ apertures option disabled. It determines whether or not to send a G54 tool
            select code with each command to change apertures.



P-CAD PCB User’s Guide                                                                                      177
Chapter 9: CAM                                                                              Gerber Verification


        3.   Clear the Include aperture definitions check box.
             This option determines whether or not definitions, assignments, and macros are to be included
             in the body of the file. These options use RS-274-X format.
        4.   Click Close to exit the dialog (returning to the File Gerber Out dialog) and the format you
             specified will be applied when the output is generated.

      Compress Output Files
        You may elect to produce files in a compressed format by enabling the Compressed (.zip) or Self-
        Extracting (.exe) option.
        Both .zip and .exe files will compress the selected output files into one smaller file. The .zip
        option produces a smaller file than the .exe option but requires an unzip.exe program to
        decompress the file when you need to access it. The compression done in the self-extracting .exe
        option outputs a larger file than is output by the .zip option because its uncompress function is
        included in the compress program.

      Generating Gerber Output
        You have set up the output files, done aperture assignments, and set Gerber format. Now you can
        generate the output files.
        1.   Select the files you want to generate. If you want to generate all of the files you have set up,
             click Set All.
        2.   Click the Generate Output Files button in the File Gerber Out dialog.


Gerber Verification
        In this section you will use the File » Import » Gerber command to verify the accuracy of a Gerber
        file. With this command, you can open a series of Gerber files. You can load a Gerber file into the
        editor to check its accuracy. Each file is loaded onto a separate layer.
        You can load a Gerber file either into an empty workspace or superimpose it onto an existing
        design. If you are going to superimpose a Gerber file onto an existing design, be sure to save your
        design first. If you forget, see the Deleting Gerber Layers section. Loading a Gerber file can be
        useful for checking pad size, line width, etc. Superimposing a file onto a design is a good way to
        verify the Gerber file against the design.

        You can load multiple Gerber files onto your design file, each inhabiting its own layer. Therefore,
        the layer names must be unique. So, the first file loaded would be on the layer Gerber, the next file
        loaded would receive the default name Gerber1, then Gerber2, etc

        1.   Choose File » Clear to clear all items from the current workspace. You can only load the
             Gerber file into an empty workspace if you had opened the design file in the same window (so
             that the aperture definitions are still in memory).




178                                                                                   P-CAD PCB User’s Guide
Gerber Verification                                                                           Chapter 9: CAM


             Aperture definitions are saved and loaded in the design file. Loading a new design file can
             completely change the current aperture settings. The File » Clear command does not clear
             current aperture definitions. Choose File » Clear to clear the workspace without clearing
             current definitions before loading a newly created Gerber file. As soon as the Gerber file is
             loaded, choose File » Save As to save the Gerber file using a different design file name. This
             allows you to keep any image of the Gerber and apertures for later use.

        2.   Choose File » Import » Gerber to open the File Gerber In dialog.
        3.   Click Gerber Filename to open the following File Gerber In dialog.




        4.   Navigate to your Gerber file and select it (e.g., Tutor3.top). Then, click Open to return to the
             File Gerber In dialog.




        5.   In the File Gerber In dialog, type a layer name in the Layer Name box. Then select a layer
             number from the Layer Number list.
        6.   Select or clear the View log File upon completion check box. The layer name Gerber is
             provided as a default, but may be changed.
        7.   Click OK to load the Gerber file. A progress indicator appears, as shown in the following
             figure.




P-CAD PCB User’s Guide                                                                                        179
Chapter 9: CAM                                                             Deleting Gerber Layer Information




             Important: The D Code apertures that are called out by the loaded Gerber file must be present
             and be defined as they were in the original Gerber file. If a D Code is no longer present, then
             the program flags the error. If the D Code is present but its definition has changed, no error is
             flagged, but you may get unexpected results. This could occur if you loaded an old Tango
             Series II Gerber file without recreating the aperture definitions properly. Our advice is not to
             redefine D Codes at all between the creation of the Gerber file and reloading it for design
             file/Gerber file comparison.


Deleting Gerber Layer Information
        After a Gerber layer is loaded into PCB, you may inadvertently save it with the PCB design file.
        Generally, this information is used only for viewing, to verify that the Gerber files were generated
        correctly. If you inadvertently save those layers, the Gerber information and layers need to be
        deleted, leaving the rest of the file untouched.
        Layers can only be deleted one at a time, so the following procedure needs to be performed for
        each Gerber layer that was saved with the file. Depending on the items that are on the board, this
        can be done in one of two ways. The first procedure should be used if the board does not contain
        free pads. The second procedure should be used if the board does contain free pads.

      No Free Pads on the Board
        With no free pads on the board, the Gerber layer can be deleted as follows.
        1.   Choose Options » Selection Mask. The Options Selection Mask dialog appears.
        2.   Click Clear All in the Layers frame. Select the Gerber layer you want to delete. In the Items box,
             clear the component and via check boxes.
        3.   Block select the entire board by choosing the Edit Select command. Everything on the Gerber
             layer should selected.
        4.   Press the DELETE key.
        5.   Choose Options » Layers. The Gerber layer can now be deleted. Select the Gerber layer and
             then click Delete.

      Free Pads on the Board
        With free pads on the board, additional steps are needed to clear the Gerber layer. You must
        enable one Gerber layer at a time, otherwise the pads and vias are deleted from all layers, not just
        the Gerber layers.



180                                                                                  P-CAD PCB User’s Guide
Creating a Padmaster Gerber File                                                               Chapter 9: CAM


        1.   Choose Options » Layers. Disable all layers except the Gerber layer you want to delete. Your
             display should now show only the information found on the Gerber layer.
        2.   Choose Options » Selection Mask.
        3.   Clear all layers in the Layers box, then select the Gerber layer you want to delete. In the Items
             box, clear the component and via check boxes.
        4.   Block the entire board using the select command. Everything on the Gerber layer should be
             selected.
        5.   Press the DELETE key.
        6.   Choose Options » Layers. The Gerber layer can now be deleted. Click on the Gerber layer and
             then click Delete. Now enable all other layers by clicking Enable All.


Creating a Padmaster Gerber File
        Occasionally, a padmaster Gerber file containing all through hole pads and vias is requested by the
        service bureau that is generating the artwork for a board. To create a padmaster Gerber file:
        1.   Choose Options » Layers to create an unused signal layer.
        2.   Choose File » Export » Gerber in Setup Output File to create the padmaster Gerber file using
             the unused signal layer you just created and enabling only thru pads and vias.
        3.   Generate the Gerber file.


N/C Drill Output
        This section takes you through the steps for generating N/C Drill files.
        The features for N/C Drill are similar to that of Gerber output. If you have followed the Gerber
        output tutorial in the previous section, then you already understand much about how PCB handles
        N/C Drill output. Therefore this N/C Drill output tutorial is much less complex, taking you through
        the minimum number of steps to acquaint you with certain features and options that are different
        from the Gerber output.
        In this section you will set up one output file, perform automatic tool assignment, set some N/C
        Drill format options, and then generate the output file. Choose the File » Open command to open
        Tutor3.pcb.
        Choose File » Export » N/C Drill to open the File N/C Drill dialog shown in the following figure:




P-CAD PCB User’s Guide                                                                                      181
Chapter 9: CAM                                                                                 N/C Drill Output




         The File N/C Drill dialog gives you the ability to output individual or batch files in these formats:
         compressed, non- compressed or self-extracting executable. But before you generate output, you
         are going to establish N/C Drill settings in some of the multiple dialogs available from the File N/C
         Drill dialog, as shown in the following figure.

                                      File N/C Drill




         Setup Output Files               Tools                N/C Drill Format

                                             (unassign)
                                             (Auto assign)


                                         Assign


                              (manual describe/assign tools)

         When you have established all of the options for output files, tool assignments, and other drill
         settings, the resulting output files will be listed in the Output Files list.

      Setting Up Output Files
         In this section, you will setup an output file. Click Setup Output Files to open the following dialog.




182                                                                                  P-CAD PCB User’s Guide
N/C Drill Output                                                                              Chapter 9: CAM




        The filename for the output file you set up here is determined by the file name extension you
        assign to the file (e.g., Filename.ncd). Most of the time only one file is used for N/C Drill, so that
        you have the design filename as the root name, and the extension as .ncd. If you had two files, you
        could use extensions such as .nc1 and .nc2 (e.g., for designs with blind and buried vias). This is to
        differentiate it from the regular design file and Gerber files in the same directory (.pcb, .top,
        .bot, etc.)
        1.   Click Set All to select all the layers in the Layers list.
        2.   In the File extension box, type: NCD
        3.   Leave X offset and Y offset boxes blank.

             If you are using blind and buried vias, you need two or more .ncd files. Select only the layers
             spanned by your blind or buried vias for each .ncd file

        4.   Click Add to add NCD to the list of Output Files.
        5. In the Output path box, type the following: C:\PCAD\TUTORIAL
        6.   Click Close to return to the File N/C Drill dialog.
        7.   You now have set up an N/C Drill file for output: Tutor3.ncd. Next, you will assign tools.

    Assigning Tools
        In this section, you will make tool assignments. Click Tools in the File N/C Drill dialog to open the
        following Tool Assignments dialog.




P-CAD PCB User’s Guide                                                                                      183
Chapter 9: CAM                                                                               N/C Drill Output




       All the existing hole diameters in the Tutor3.pcb design file are listed in the Hole column.

       Assigning Tools Automatically
       This section describes how you would assign tools automatically.
       1.   Click Auto. All of the tool assignments will appear in the Tool column, each tool listed next to
            each hole.
       2.   Select Hole 18.0 mil and click Unassign.

       Assigning Tools Manually
       Now you will manually assign a tool (the same one you just unassigned in the previous section).
       With the same hole/tool assignment highlighted, click Assign to open the following dialog, where
       you can manually describe and assign tools.




184                                                                                P-CAD PCB User’s Guide
N/C Drill Output                                                                                  Chapter 9: CAM




        The hole/tool you highlighted on the previous dialog is displayed at the top of this dialog in the
        Assign Tool to field. The hole and its diameter are displayed in the Hole and Diameter fields.
        1.   Select the T01 18.0 mil tool code in the Tools list.
        2.   Click Close to complete the assignment and return to the Tool Assignments dialog.
             The Tool Assignments dialog should now display all of the tool assignments, performed both
             automatically and manually.
        3.   Now, click Close to exit the dialog and return to the File N/C Drill dialog.

    Set Format Options
        You will now set format options for File N/C Drill.
        1.   In the File N/C Drill dialog, click N/C Drill Format to open the following dialog.




P-CAD PCB User’s Guide                                                                                       185
Chapter 9: CAM                                                                                    N/C Drill Output




         2.   In the Output Units frame, choose Inches. The units are now in inches and the format is
              automatically set to 2.4, which is two digits to the left of the decimal point and four digits to the
              right. If you select Millimeters, the format is automatically set to 4.2, which is four digits to the
              left of the decimal point and two digits to the right.
         3.   In the Output Code Type frame, choose ASCII None.
         4.   In the Zero Suppression frame, choose None.
         5.   Click Close to save format options settings and return to the File N/C Drill dialog.

      Compress Output Files
         In the N/C Drill dialog, you have the ability to produce files in a compressed format by selecting the
         Compressed(.ZIP) or Self-Extracting (.EXE) check box in the Compress Output Files frame.
         Both (.zip) and (.exe) files will compress the selected output files into one smaller file. The
         (.zip) option produces a smaller file than the (.exe) option but requires an unzip.exe program
         to decompress the file when you need to access it. The compression done in the self-extracting
         (.exe) option outputs a larger file than is output by the (.zip) option because its uncompress
         function is included in the compress program.

      Generate N/C Drill Output
         Now you will generate your N/C Drill output files.
         1.   Choose File » Export » N/C Drill. The following File N/C Drill dialog appears.




186                                                                                     P-CAD PCB User’s Guide
Creating a Drill Symbol Legend                                                                Chapter 9: CAM




        2.   Click Set All to select all files in the Output Files list.
        3.   Click Generate Output Files.
        The output file is written to Tutor3.ncd. You can open this file with any text editor, such as
        WordPad or Notepad.


Creating a Drill Symbol Legend
        Many service bureaus wish to have a print out of the drill symbols for a board. We allow you to
        assign your own symbols for each hole on the board, however, a time may arise when you wish to
        attach a legend to the drill file itself explaining what the different symbols represent. This can be
        done in the following manner.
        1.   Choose File » Reports.
        2.   Generate a Statistics report. This report summarizes important design facts, such as physical
             dimensions and object quantities.
        3.   To create a drill symbol table, select an area for the legend.
        4.   Choose Options » Layers to create a non-signal layer called DRILL.
        5.   On the DRILL Layer, place the first pad listed on your Statistics report.
             Begin with the smallest hole size and then gradually increase in size, placing one pad after
             another in a column. Be sure to place pads, which are representative of every unique drill hole
             size on your board.




P-CAD PCB User’s Guide                                                                                       187
Chapter 9: CAM                                                                  Creating a Drill Symbol Legend


         6.   Next to each pad, directly to the right, choose the Place » Text command to place a label
              indicating the drill size associated with that pad.
         7.   To complete the legend, choose Place » Line and draw a rectangle around the pads and text
              just placed.

      Generating Drill Drawing
         When all the pads are placed and labeled you are ready to generate the Drill Drawing using the File
         » Print or File » Export » Gerber command.
         To generate the drill file, do the following:
         1.   Click Setup Print Files in the File Print dialog or click Setup Output Files in the File Gerber Out
              dialog.
         2.   In the Setup Print Files or Setup Output Files dialog, select all plane and signal layers. Then,
              select the new DRILL layer and close the dialog.
         3.   Generate the Gerber Output File or Printout.
         4.   If your design includes blind and buried vias, generate additional drill drawings having only
              those layers enabled that span the blind and buried vias in the design.
         Create a different drill drawing for each set of vias spanning different layers.
         When you generate your drill drawing, each pad with a unique hole size is represented by a unique
         drill symbol. The text indicating the hole size it represents appears to right of each symbol.
         Accordingly, each of the pads in your drill symbol table are replaced with its appropriate drill
         symbol, creating an annotated legend.




188                                                                                    P-CAD PCB User’s Guide
                                                                                       CHAPTER           10


                                                                         Copper Pours

Introduction to Copper Pours
       A copper pour is a polygonal shape that you can place on any layer of a PCB design. To place a
       copper pour in a design, you use the following two-step process:
       •   First, place the pour outline. For instructions, see Drawing a Pour Outline (page 387).
       •   Next, flood the pour outline with a copper fill. For instructions, see Filling a Copper Pour (page
           388).
       In a PCB design, you can choose various fill patterns, including a hatched, lined, or solid pattern.
       Typically, the flooded area will backoff from almost any object on the same layer, unless the object
       and filled area are associated with the same net. Two pours not associated with any net are
       common; they do not backoff from each other. When one pour is associated with a net and the
       other pour is not, they are considered different. Therefore, the order in which you select the
       copper pours is very important.
       When a copper pour is placed on a non-signal layer, it is a graphical object only. Typically, you will
       place copper pours on signal layers, as opposed to non-signal or plane layers. A pour on a non-
       signal layer, such as the Top Paste layer, adds the copper pour image to the layer's output, but the
       layer is not considered for DRC and connectivity.
       Because a copper pour has a polygonal shape, you can create rounded-corners for the copper
       pour. To learn how to create rounded-corners for a polygonal shape, see Polygon Properties (page
       315), or Place Polygon (page 383).


Properties
       You can modify various properties associated with a copper pour using the Copper Pours
       Properties dialog. For information on these properties, see Copper Pour Properties (page 317) and
       Edit Commands (page 279).




P-CAD PCB User’s Guide                                                                                     189
Chapter 10: Copper Pours                                                                             Islands



Islands
        Isolated islands of copper pour are areas of copper separated from the rest of a pour. They result
        when objects are avoided and when the backoff criteria is set too small. These islands can be
        minimized by increasing the line width (which inhibits the ability to penetrate small areas),
        increasing the backoff criteria, or avoiding these areas when defining the copper pour.
        For large designs, where manual island detection is slow, break pours into smaller pours to speed
        up editing.
        Otherwise, you can use the Copper Pours Properties dialog to automatically remove islands. You
        can also manually delete islands. To do this, hold down the SHIFT key, select the object and choose
        Edit Delete.


Repour
        Moving a filled pour automatically causes a repour. However, if you need to manually repour a
        copper pour, you can use the repour options in the Copper Pour Properties dialog. To manually
        repour a copper pour, do the following:
        1.   Select the copper pour.
        2.   Right-click and choose Properties from the shortcut menu. The Copper Pour Properties dialog
             appears.
        3.   In the State frame, choose Repour.
        4.   Click OK.

      Pour/Repour Options
        When you choose to pour or repour a group of copper pour outlines, you can control the order in
        which P-CAD PCB pours or repours the copper fill. This is useful when you have a number of
        unpoured copper pour outlines in a design, or when you want to repour a group of copper pours
        and control the order. This can be used to ensure that smaller copper pours that lie within larger
        copper pours are repoured correctly.
        To set your pour/repour options, follow these steps:
        1.   Choose Options » Configure. The Options Configure dialog appears.
        2.   Click the General tab, shown in the following figure.




190                                                                                P-CAD PCB User’s Guide
Connectivity                                                                       Chapter 10: Copper Pours




        3.     In the Pour/Repour Option frame, choose one of the following buttons:
               •   Smallest to Largest: Choose this button to have P-CAD PCB pour the copper fill according
                   to pour size, from smallest to largest. For best results, choose this button when you want
                   use the block selection method to select a group of copper pours.
               •   Select Order: Choose this button to have P-CAD PCB pour the copper fill according to the
                   order that you selected the copper pour. For best results, choose this button when you
                   want to select a group of copper pours using the CTRL+click selection method.

               If you do not choose a button in the Pour/Repour Option frame, the Smallest to Largest button
               is selected by default.

        4.     Click OK to close the Options Configure dialog.


Connectivity
        Individual islands of a pour are connectivity aware. This means that connection routing with a pour
        will work by removing connections between nodes that are connected to the pour, optimization of
        the net will take copper pour islands into account.




P-CAD PCB User’s Guide                                                                                     191
Chapter 10: Copper Pours                                                                      Setting Backoff



Setting Backoff
         To specify the distance that you want between the copper pour and any objects that may be inside
         the copper pour polygon, open the Copper Pour Properties dialog. In the Backoff frame, choose the
         Fixed button and type a value in the text box. This option also creates a backoff from any objects
         that are outside the copper pour polygon if they are too close to it. The copper pour backs off from
         any copper item that is not in the net associated with the pour. The backoff options takes the
         object’s thickness into account.
         To set backoff values for a specific net, choose Options » Design Rules. Backoff clearances are fixed
         at the greatest of the Line to Line or Line to Pad clearance amount in Options Design Rules dialog.


Thermals
         When enabled, copper pour thermal spokes are used to connect copper pour pads and vias of the
         same net to copper pour islands.
         The connectivity of pads and vias to the copper pour can be controlled using the Modify Pad/Via
         Styles (Complex) dialogs. The Prohibit Copper Pour Connections option in these dialogs, when
         enabled, prevents connections to the copper pours for selected nodes on specified signal layers.
         For more information on using the Modify Pad/Via Styles (Complex) dialogs, see Options
         Commands (page 423).


Circles
         When you create a full circle using a single arc, copper pours do not penetrate the arc. However, if
         you want to create a circular area and flood it with a backoff inside and out, use multiple arcs to
         create the circle.


Routing
      Autorouting
         None of the autorouters supplied with P-CAD PCB recognize copper pours. It unpours them and
         routes the connections. This can cause changes to the design once the pours are repoured, such as
         the addition of new islands, which can render the pour ineffective. Thus, it is recommended that
         pours should be placed last in a design.

      Manual and Interactive Routing
         You can manually route connections to copper pour islands using the Route Manual or Route
         Interactive tool. Routed lines and vias that belong to another net cause the pour to auto plow
         around the new copper.




192                                                                                 P-CAD PCB User’s Guide
Auto Plowing                                                                       Chapter 10: Copper Pours



Auto Plowing
       Copper Pours affected by new copper generated by the Route Manual or Route Interactive tool will
       auto plow when the route Completes or Suspends.
       Any new copper (e.g., lines, pads, vias) placed or routed so as to overlap islands of a filled copper
       pour cause those islands to regenerate so that the backoff rules are not violated.
       In the Options Configure dialog, you can enable or disable the Auto Plow Copper Pours option.
       Plowing can create more islands if you splinter existing islands, yet Automatic Islands Removal is
       still performed using the settings you established for that copper pour.


Overlapping Pours
       Overlapping pours of different net associations present unique problems. The order of pouring
       determines which pour occupies the area. The order of selection in a single pour request,
       determines the relative dominance.
       For the following examples, assume that the copper pours have been placed, but not associated to
       a net or poured.
       •   Pour A and B overlap: This example applies to multiple pours with overlapping areas. You have
           two copper pours, which are overlapping each other. Select the first pour, associate it to a net,
           and pour it. Now select the second placed pour, associate it to a different net, and pour it. The
           second pour backs off from the islands of the first pour.
       •   Pour A is inside Pour B: You have two copper pours, one inside the other. Always work from
           the inside out. Select and pour the inside pour first and then select and pour the outside pour.
       •   Pour A is inside Pour B inside Pour C: You have three copper pours, one inside the other.
           Always work from the inside out. Select and pour the inside pour first, pour the second, and
           finally, pour the third.

       For information on controlling the repour order, see Pour/Repour Options (page 190).




P-CAD PCB User’s Guide                                                                                      193
                                                                                      CHAPTER              11


                                        Interapplication Functions

Introduction to Interapplication Functions
       Several sophisticated features are available in PCB, which allow you to more fully integrate various
       aspects of the design process. These features include:
       •   Hotlinks
       •   ECOs
       •   Interapplication launches
       •   Custom application access


DDE Hotlinks
       With the DDE hotlinks feature, you can cross probe between an P-CAD Schematic and PCB design,
       to examine the relationships between the designs. To turn this feature on refer to Enabling DDE
       Hotlinks (page 196).
       This feature enables the exchange of hotlink data, which consists of highlighting and
       unhighlighting commands for parts, components, and nets. For example, when you apply the
       current highlight color to a net in P-CAD PCB, the current highlight color is also applied to the
       corresponding net in P-CAD Schematic.
       You can also change the highlight color of an object in P-CAD PCB, and the corresponding object
       in P-CAD Schematic is automatically updated with the highlight color. To set the current highlight
       color, see Setting the Current Highlight Color (page 196).
       When the DDE Hotlinks feature is turned on in both programs, you can cross probe between the
       following programs at one time:
       •   P-CAD PCB/Relay and P-CAD Schematic
       •   P-CAD PCB/Relay and P-CAD Schematic Viewer




P-CAD PCB User’s Guide                                                                                     195
Chapter 11: Interapplication Functions                                                            DDE Hotlinks


         •    P-CAD PCB Viewer and P-CAD Schematic Viewer
         •    P-CAD Schematic and P-CAD PCB Viewer.
         Once the feature is turned on, you can use several commands to invoke this feature. For details,
         see Unhighlighting Parts and Components (page 197) and Highlighting Nets (page 196).

      Enabling DDE Hotlinks
         To turn the DDE hotlinks feature on, follow these steps:
         1.   Choose Options » Configure. The Options Configure dialog box appears.
         2.   Select the DDE hotlinks check box.
         3.   Click OK to close the Options Configure dialog box.

         This feature hotlinks data between two P-CAD programs. To operate properly, you must turn on the
         DDE hotlinks feature in both programs.

      Setting the Current Highlight Color
         To set the current highlight color for P-CAD PCB, follow these steps:
         1.   Choose Options » Display. The Options Display dialog appears.
         2.   Click the Colors tab.
         3.   In the Display Colors frame, click the Highlight button. A color palette appears.
         4.   Select a color from the palette and click the Close button.
         5.   Click OK to close the Options Display dialog.
         To change the current highlight color, repeat this procedure. However, notice that the color
         change does not affect existing highlighted objects, unless a highlighted object is selected.

      Highlighting Parts and Components
         To apply the current highlight color to an object in your PCB design, choose one of these methods:
         •    Select an object. Then, choose Edit Highlight or right-click and choose Highlight from the
              shortcut menu.
         •    Choose Edit » Components. When the Edit Components dialog appears, select a component
              from the list and click Highlight.
         When you apply the current highlight color to an object, it remains highlighted until you
         unhighlight that object. For instructions, see Unhighlighting Parts and Components (page 197).

      Highlighting Nets
         To apply the current highlight color to components and nets attached to a particular part in your
         PCB design, choose one of these methods:




196                                                                                  P-CAD PCB User’s Guide
ECOs                                                                 Chapter 11: Interapplication Functions


       •   Choose Edit » Components. When the Edit Components dialog appears, select one or more
           components from the list and click Highlight Attached Nets. The highlight color is applied to all
           items in the net, including lines, polygons, arcs, copper pours, pads and vias.
       •   Choose Edit Nets. When the Edit Nets dialog appears, select one or more nets from the Nets
           list and click Highlight.
       To remove the highlight color from a net, see Unhighlighting Nets (page 197).

   Unhighlighting Parts and Components
       To remove the highlight color from a part or component, choose one of the following methods:
       •   Choose Edit Unhighlight All to remove the highlight color from all objects.
       •   Select an object. Then, choose Edit Unhighlight or right-click and choose Unhighlight.
       •   Choose Edit » Components. When the Edit Components dialog appears, select one or more
           component from the list and click Unhighlight.

   Unhighlighting Nets
       To remove the highlight color from a net choose one of the following methods:
       •   To remove the highlight color from the components and nets attached to a part, choose Edit »
           Components. When the Edit Components dialog appears, select one or more components
           from the list and click Unhiglight Attached Nets.
       •   To remove the highlight color from a net, choose Edit Nets. When the Edit Nets dialog appears,
           select one or more nets from the Nets list and click Unhiglight.


ECOs
       With P-CAD PCB, you have the ability to record Engineering Change Orders (ECOs) that can be
       used with P-CAD Schematic. You can also import ECOs generated by P-CAD Schematic into P-CAD
       PCB. In addition, pending ECOs can be viewed while still in memory.

   Types of ECOs
       The following types of ECOs can be recorded:
       •   RefDes change (Was-Is).
       •   Net name changes.
       •   Additions, deletions, and modifications of components.
       •   Component swaps (Replace).
       •   Additions and deletions of nets, net classes and class to classes.
       •   Net class name changes.




P-CAD PCB User’s Guide                                                                                   197
Chapter 11: Interapplication Functions                                                                        ECOs


        •    Net additions to and deletions from net classes.
        •    Additions and deletions of net nodes.
        •    Additions, deletions, and modifications of attributes (i.e., in nets, net classes, class to classes,
             etc.)
        The format of the ECO file is determined by the setting in the Options Configure dialog. Full Report
        ECO files have an .eco file name extension, and Was/Is ECO files have a .was file name extension.

      Utils Record ECOs
        Choose Utils » Record ECOs to record ECOs. When you choose this command, the following
        dialog appears:




        You can choose the buttons in the ECO Recorder frame to start or stop the ECO recorder. You can
        also start the ECO recorder by clicking the toolbar button. In either case, when the ECO recorder is
        started, the toolbar button is indented.

        If there are pending ECOs, you are prompted when a design is saved on whether to append the
        pending ECOs to the current ECO file.

      Utils Import ECOs
        Choose Utils Import ECOs to import an ECO file and apply the ECO changes to the current design
        file. The ECO file is created in P-CAD Schematic to capture schematic changes that impact your
        design. When you choose this command the following dialog appears:




        Selecting an ECO Filename
        1.   In the Utils Import ECOs dialog, click ECO Filename to open the following dialog:




198                                                                                     P-CAD PCB User’s Guide
ECOs                                                                 Chapter 11: Interapplication Functions




       2.   Type, or select from the list, the name of the file you want to open in the Filename box.
            •   .eco files are assumed to be full ECO format
            •   .was files are assumed to be Was/Is format.
       3.   Click Open to return to the Utils Import ECOs dialog.
       4.   To load components with placeholder pattern, select the Create Pseudo Patterns check box.
            For more information see Pseudo Patterns (page 199).
       5.   Click OK to import the ECOs.

       Previewing ECOs
       After you select an ECO filename in the Utils Import ECOs dialog, click PreView ECOs to view
       existing ECOs before you import them. ECOs appear in the Notepad.




       Pseudo Patterns
       You can select the Create Pseudo Patterns check box in the Utils Import ECOs dialog to load P-CAD
       Schematic components that don’t have attached patterns.




P-CAD PCB User’s Guide                                                                                  199
Chapter 11: Interapplication Functions                                                                 ECOs


        If a component does not have a pattern and matches a component in the open libraries, P-CAD
        PCB automatically creates a placeholder pattern.
        For each pseudo pattern created, a message appears to let you know which components are
        affected.

      Utils Export ECOs
        With the Utils Export ECOs command you can save ECOs to the ECO file at any time, without saving
        the design file. If there are pending ECOs, the following dialog appears when you choose Utils
        Export ECOs:




        View Pending ECOs
        When you click the View Pending ECOs button in the Utils Export ECOs dialog, you can view
        pending (outgoing) ECOs, which are still stored in memory. The pending ECO data are written to a
        temporary ASCII file and displayed in the Notepad. The format displayed is either full ECO or
        Was/Is, depending on the setting in the Options Configure dialog.

        Save ECOs Now
        1.   To save pending ECOs, click the Save ECOs Now button. A warning message appears:




             It is important to remember that if you save ECOs without saving the design, your file and the
             ECOs may be out of sync. That is, the ECOs might not reflect the current state of the design.
        2.   To continue, click Yes. The warning message closes and the Save ECOs dialog appears:




200                                                                                P-CAD PCB User’s Guide
Starting Other P-CAD Applications                                     Chapter 11: Interapplication Functions




        3.   The ECO filename appears at the top of the dialog. It is the last used ECO file. To change it,
             click the ECO Filename button and the following dialog appears.




        4.   Type, or select from the list, the name of the file you want to open in the Filename box. Click
             OK to return to the Save ECOs dialog.
        5.   Full ECO files must have an .eco extension, and Was/Is files must have a .was extension.
        6.   In the Comments box, type any comments that can help document the ECOs.
        7.   To append ECOs to the ECO file, click Append ECOs to File.
        8.   To discard ECOs, click Discard ECOs. Once ECOs are discarded, they cannot be recovered.


Starting Other P-CAD Applications
        With P-CAD PCB, you have the ability to gain direct access to other P-CAD design tools, including:
        •    P-CAD Schematic Editor
        •    P-CAD Library Executive




P-CAD PCB User’s Guide                                                                                        201
Chapter 11: Interapplication Functions                                            Customizing P-CAD PCB


        •   P-CAD Symbol Editor
        •   P-CAD Pattern Editor
        •   P-CAD InterPlace/Parametric Constraint Solver
        •   P-CAD Signal Integrity
        •   P-CAD AutoRFQ
        If the P-CAD tool that you select is installed on your computer it will automatically start, and
        become the active program. For PCB-related tools, such as InterPlace/PCS and Signal Integrity, the
        current PCB is passed to the chosen tool, ready for analysis.


Customizing P-CAD PCB
        With P-CAD PCB, you can create shortcuts that give you the ability to gain access to other programs
        and documents that you frequently use. To do this, you use the Utils Customize dialog and create a
        custom menu command and toolbar button for the program or document.
        For complete instructions, see Utils Customize (page 537).




202                                                                               P-CAD PCB User’s Guide
                                                                                      CHAPTER 12



                                                                    File Commands

Introduction to File Commands
       File commands allow you to open, close, save, and print designs, output reports and perform CAM
       output in PCB.
       Most of the File commands cannot be undone: once an action is taken, it cannot be reversed using
       the Undo command.


File New
       Choose File » New to open a new, untitled design window. When the new window appears, all
       styles and design parameters return to their default settings.


File Open
       Choose File » Open to open files. When you open a file, P-CAD PCB displays the file in a new
       window.

       If you attempt to reopen a file that is already open, P-CAD PCB loads another instance of the file in
       a new window. This is the same as the Window » New Window command. For details, see Window
       New Window (page 563).

       When you choose File » Open, the Open dialog appears.




P-CAD PCB User’s Guide                                                                                    203
Chapter 12: File Commands                                                                                     File Open




         The Look In list displays the current folder and a list of files in that folder appears directly
         underneath. The Filename boxes let you select or enter a design file name, with the file name
         extension specified in the Files of type list. Notice that the file name extension is .pcb by default.
         This is the default file name extension for P-CAD binary and Tango PCB ASCII files.

      Drag-and-Drop File Load
         You can use a simple drag-and-drop operation to open PCB design files (.pcb).

      Open a File
         To open a file, do the following:
         1.   Choose File » Open. The Open dialog appears.
         2.   Type, or select from the list, the name of the file you want to open in the Filename box.
              If the file you want is not in the current folder, then either type the folder name in front of the
              document name, or select the correct folder.

              Global and local attributes in PCB design files are merged when the files are loaded from
              versions 3.05 and earlier.

         3.   Click Open.

      Opening a Recently Used File
         To open one of the last four files, click the File menu and choose the name of the file you want to
         open. The most recently opened file will be the one at the top of the list.

      Opening an ASCII File
         A file filter in the List Files of Type list reads PCB ASCII files. The new file filter is ASCII Files
         (*.pcb).
         Errors and warnings generated while loading an ASCII file are written to a file named Design-
         name.log, which is automatically displayed using in the Notepad.




204                                                                                         P-CAD PCB User’s Guide
File Close                                                                     Chapter 12: File Commands


        If any of the design limits are exceeded, your design cannot be opened using P-CAD PCB (6/400).


File Close
        Choose File » Close to close all windows for the active design.
        If the file you want to close has any unsaved changes, a message dialog prompts you to save the
        changes. If you close the last design, it is automatically replaced with a new, untitled design.


File Save
        Choose File » Save to save any changes to the design in the active window and create a backup file
        with the .bak file name extension.
        When you choose File » Save, the active file remains open so you can continue working on it, and a
        backup file is copied. The current file name and location are unchanged by this command. To save
        the current file to a different name or location, choose File » Save As.
        When you enable the recording of Engineering Change Orders (ECOs), they are created in PCB to
        capture design changes. Pending ECOs are appended to an ECO file or discarded when you save a
        design file. If there are pending ECOs, the following dialog appears:




        1.   The ECO filename appears at the top of the dialog by default. To change it, click ECO Filename.
             The following dialog appears.




P-CAD PCB User’s Guide                                                                                     205
Chapter 12: File Commands                                                                           File Save As


         2.   Type, or select from the list, the name of the ECO file you want to use in the Filename box.
              Click Save to return to the Save ECOs dialog.
         3.   In the Comments box, type any comments that can help document the ECOs.
         4.   To append ECOs to the ECO file, click Append ECOs to File.
         5.   To discard ECOs, click Discard ECOs. Discarded ECOs cannot be recovered.
         For more information on ECOs, see Utils Record ECOs (page 502), Utils Import ECOs (page 503),
         and Utils Export ECOs (page 505).

      Saving an ASCII File
         If the current design was opened in PCB from an ASCII file, a PCB ASCII file is generated instead of
         a PCB binary file.
         ASCII File Save uses a temporary file for file generation. The file is named file.pc$, where file is
         the name you specify in the File Save As dialog or the current design name if you are using the File
         Save dialog. If you cancel the save process or it is interrupted by an error condition, the temporary
         file will contain the ASCII contents written up to the point where the process was terminated. A
         description of the PCB ASCII format can be found in the file ASCII.doc.

      Net Classes
         Net classes are saved to binary and ASCII design files.

         If any of the design limits are exceeded, your design cannot be opened using P-CAD PCB (6/400).


File Save As
         Choose File » Save As to save a copy of the active design file to the drive or directory you specify.
         You can either name a new file or save an existing file under a new name (the original file
         remaining the same, if there is an original). If you save to an existing file, this command creates a
         backup file (.bak). You can also use this command to save files in ASCII format.
         When you choose File » Save As, the Save As dialog appears. Use this dialog to enter a name for the
         file and to choose the drive and directory in which to save the file. The Save in box displays the
         current folder. The area just below shows all files in the current folder with the file name extension
         specified in the Save File as type list. Notice that your default file name extension is .pcb. Select a
         file or type a new filename in the File Name list.

      Save a File to a Name and Location
         To save a file to a different name and location:
         1.   Choose File » Save As to open the Save As dialog.
         2.   Type the filename you want to use in the Filename box.
              If the current folder is not appropriate, then either type the folder name in front of the
              document name, or select the folder.



206                                                                                   P-CAD PCB User’s Guide
File Clear                                                                         Chapter 12: File Commands


        3.   Make sure the file name extension is correct by selecting the Save file as type check list.
        4.   Click Save to save the file as you have specified.
        If there are pending ECOs, you are prompted to save them. See File Save (page 205) for detailed
        instructions.

    Saving an ASCII File
        If ASCII is selected in the Save as type list of the File Save As dialog, an ASCII file is generated
        instead of a PCB binary file. The output file is a complete design file, and it contains all design data
        represented in a PCB binary file. A description of the PCB ASCII format can be found in the file
        ASCII.doc.
        ASCII File » Save As uses a temporary file for file generation. The file is named file.pc$, where
        file is the is the name you specify in the File Save As dialog or the current design name if you are
        using the File Save dialog. If you cancel the save process or it is interrupted by an error condition,
        the temporary file will contain the ASCII contents written up to the point where the process was
        terminated.

        If any of the design limits are exceeded, your design cannot be opened using P-CAD PCB (6/400).


File Clear
        Choose File » Clear to clear the workspace and reset the title bar. When you choose this command,
        a message prompts you to save changes to the current file before it is cleared from the workspace.
        The File » Clear command does not clear the style or layer definitions setup by Options » Pad Style,
        Options Layers, etc. for the file that was open at the time the workspace is cleared. This allows you
        to use template information from that file. The command also does not clear the Aperture list
        defined by the File » Export » Gerber command, allowing you to load a photoplot file without
        redefining all of the apertures.


File Print
        This command prints a copy of the current PCB file, using the printing specifications you have set.
        When you choose File » Print, the following dialog appears.




P-CAD PCB User’s Guide                                                                                        207
Chapter 12: File Commands                                                                              File Print




         This dialog is used to generate individual or batch print jobs according to a variety of specifications.
         If you already have print jobs set up, you can generate them from this dialog. Additional dialogs for
         further specifications are accessible from this dialog:


                                        File Print


                                              (generate output)




               Setup Print Jobs       Drill Symbols               Colors


                  (options)          (manual assign)
                                       (unassign)
                                      (auto assign)


      Print Preview
         To view a print job before you print it, click Print Preview in the File Print dialog.
         When you click Print Preview, the specified print output appears on your screen. The Print Preview
         window offers the following options for viewing the print job output:
         •   Print: Sends the current print jobs to the printer.
         •   Next Page: Displays the next page of the print output in the Print Preview window.
         •   Prev Page: Displays the previous page of the print output in the Print Preview window.



208                                                                                     P-CAD PCB User’s Guide
File Print                                                                           Chapter 12: File Commands


         •    Two Page/One Page: Allows you to view two pages at a time or only one page.
         •    Zoom In: Zooms in on the center area of the current page. Use the scroll bars to move to the
              desired viewing region.
         •    Zoom Out: Zooms out on the current page.
         •    Close: Closes the Print Preview window.

    Generating Print Jobs
         After you have set up the print jobs, drill symbols, and colors, return to the File Print dialog to
         generate the print jobs. You can do a batch print by highlighting multiple print jobs in the list. You
         can individually highlight or de-highlight print jobs by clicking them in the list.
         When you click Generate Printouts, the highlighted print job(s) are processed and printed.
         Click Close to exit the dialog and save the settings for the File Print dialog and related dialogs.
         You can use this command to setup and generate custom print jobs.

         Using the Current Window
         When setting up a print job, you may specify a region of your workspace to print. Select the Use
         Current Window check box in the Print Job Overrides frame to override the regional settings
         specified for the print jobs. The layers and items printed are defined by the highlighted print job;
         the region is defined by the viewable area on your workspace.
         To print a print job with the region defined as the current window, follow these steps:
         1.   Use the View commands to select the desired window in P-CAD PCB.
         2.   Choose File » Print. The File Print dialog appears.
         3.   In the Override Settings frame, select the Use Current Window check box.
         4.   Select the desired print job and click Generate Printouts. P-CAD PCB prints out the print job
              with the region defined by the current window. The printout may be on one page, or on many
              pages, depending on the size of the window and the printer settings.

         Scaling to Fit Page
         When printing, you can override the scale settings for all print jobs so that their output fits exactly
         on a page.
         To print scaled print jobs, follow these steps:
         1.   Choose File » Print. The File Print dialog appears.
         2.   In the Override Settings frame, select the Scale to Fit Page check box.
         3.   Select the desired print job(s) in the Print Jobs list. To define a new print job, click Setup Print
              Jobs and follow the instructions in Setup Print Jobs (page 210).
         4.   Click Generate Printouts. P-CAD PCB prints out the contents of the selected print job. The
              print output is scaled to fit exactly on a page.


P-CAD PCB User’s Guide                                                                                          209
Chapter 12: File Commands                                                                                File Print


         5.   The File » Print Scale to Fit Page overrides the scale settings for all print jobs. To scale an
              individual print job to fit a single page, select the Scale to Fit Page check box in the Setup Print
              Jobs dialog.

      Setup Print Jobs
         Click Setup Print Jobs in the File Print dialog to open the Setup Print Jobs dialog shown in the
         following figure.




         In this dialog you can set up multiple print jobs, with each job including specific layers, a printing
         region, design items, and other print options. You can also modify existing print jobs to include or
         exclude layers, items, etc.

         Print Jobs
         Any print jobs that have been set up for the active design appear in the Print Jobs list. Each job can
         have its own particular layers, and other options specified.
         After you set up your print jobs, you can select a job and the layers and options associated with that
         job appear in the Print Job Selections frame. When you close the dialog, any jobs appearing in the
         Print Jobs list also appear in the File Print dialog.
         Below the Print Jobs list are three buttons: Add, Modify, and Delete.
         •    To add a print job, type a job name in the Print Job Name box, define any print job selections,
              and click Add.




210                                                                                     P-CAD PCB User’s Guide
File Print                                                                                 Chapter 12: File Commands


         •    To modify a print job, select a job from the Print Jobs list, edit the print job selections, and click
              Modify.
         •    To delete a print job, select a job from the Print Jobs list and click Delete.
         The collection of print jobs defined in the dialog are saved to the design file, so you can print them
         at any time.

         Print Job Selections
         The following controls appear in the Print Jobs Selections frame:
         •    Print Job Name: Shows the name of the job selected in the Print Jobs list. To add a print job,
              type a job name in this box, define any print job selections, and click Add.
         •    Layers: Shows any layers associated with the job selected in the Print Jobs list. Pads and vias
              must be enabled separately. For example, to include all items on the top layer in the print
              output, select Top in the Layers list. When creating output for a specific hole range, you need
              to select all the layers on which a pad and via’s hole has been defined.
         •    Set All: Click this button to select all of the layers in the Layers list.
         •    Clear All: Click this button to cancel the selection of all layers in the Layers list.
         •    Apply Layer Set: Click this button to apply a layer set to a print job.
         •    Layer Sets: Below the Apply Layer Set button is a drop-down list. You select a layer set from
              this list. To do this, follow these steps:
         1.   Select a layer set from the drop-down list.
         2.   Click Apply Layer Set. The layers in that set are selected in the Layers box.
         To create a layer set, choose Options » Layers. For instructions, see Adding or Modifying a Layer Set
         (page 455).
         Print Adjustments frame
         The Print Adjustments frame contains the following controls:
         •    Scale to Fit Page: Select this check box to scale the print job to fit on a single page. When
              selected the Scale, X offset, and Y offset boxes are shaded. Clear this check box to define the
              Scale, X offset, and Y offset.
         •    Scale: Enter a value in this box to increase or decrease the size of the print job by a specific
              factor. The value you enter affects the X axis and Y axis equally. For example, 0.100 reduces the
              output by a factor of 10, while 10.00 enlarges the output by a factor of 10.
         •    X and Y Offset: Enter a value in each box to offset your printout horizontally or vertically by the
              value you specify. Minus values go left and/or down; plus values go right and/or up. Default
              units are the values settings in Options Configure. You can override the default units by
              entering the units with the value (e.g., mil, mm, in).
         Print Region frame



P-CAD PCB User’s Guide                                                                                           211
Chapter 12: File Commands                                                                            File Print


       The Print Region frame contains the following controls:
       •    Design Extents: Select this check box to print the entire design for the current print job. When
            selected, the other controls in this frame are shaded. Clear this check box to define a region.
       •    Define Region: Click this button to define a specific area of your design to print. This button is
            active only when the Design Extents check box is clear.
       •    Lower Left Corner and Upper Right Corner: These boxes contain the X and Y coordinates of
            the selected print region. The Lower Left Corner and Upper Right Corner boxes are disabled
            when the Entire Design check box is selected.
       To define a print region:
       1.   Clear the Design Extents check box in the Setup Print Jobs dialog. Then, click the Define
            Region button. The dialogs close, uncovering the workspace.
       2.   Hold down the left mouse button to define the first corner of the print region rectangle.
       3.   Drag the cursor to define the rectangle. The coordinates of the rectangle are displayed in the
            Status Line. The View commands are available to help you navigate the design and define the
            region precisely.
       4.   Release the mouse button to fix the rectangle’s size and location. You may return to step 2 if
            you wish to edit the rectangle.
       5.   Right-click or press ESC key to commit the rectangle.
       6.   You are prompted to confirm the updated coordinates. Click Yes. The Setup Print Jobs dialog
            appears.
       The coordinates of the selected print region can be viewed or modified in the Print Region box in
       the Setup Print Jobs dialog.
       Display Options frame
       The Display Options frame contains the following check boxes. Select a check box to enable the
       display of an item. Clear the check box to disable the display of an item:
       •    Rotate: Select this check box to rotate the printed image clockwise by 90 degrees. If the Mirror
            check box is selected with this option, the image mirrors before it rotates.
       •    Mirror: Select this check box to print a mirror image of the design’s typical view. Generally,
            each layer is displayed as seen from the Top layer. Selecting the mirror option would print the
            board as it appears from the Bottom layer (as if you flipped the board over horizontally and
            looked at it with the Bottom layer facing up).
       •    Draft: Select this check box to allow an outline rough draft to be printed (normally speeding
            up the print job). This would be a printout of only the outlines for pads, vias, polygons, copper
            pours, etc.
       •    Thin Line Stroked Text: Select this check box to display text objects in a thin line form.




212                                                                                 P-CAD PCB User’s Guide
File Print                                                                          Chapter 12: File Commands


         •   RefDes, Type, Value, Pads, Vias, Pad/Via Holes, Pick and Place, Glue Dot, Test Point, Keepout,
             Cutouts, Connections, and Titles: Select a check box to include an item in the printout. Clear a
             check box to exclude an item from the printout.
         •   No Mt Hole Cut: Select this check box to exclude mounting hole copper from the printout.
             Clear this check box to include mounting hold copper in the printout.
         Drill Symbols frame
         The Drill Symbols frame contains the following controls:
         •   Drill Symbols: Select this check box to print drill symbols. When selected, the other controls in
             this frame become available.
         •   Size: Enter a value in this box to adjust the size of the drill symbol (usually for size reduction),
             which represents the drill hole location. For example, you would reduce the drill symbol size
             so that the drill symbols will not overlap in the printout if they are located close to one
             another.
         •   Plated Holes, Non-plated Holes or All Holes: Choose one of these buttons to select the type of
             holes to print.
         After you have set up your print job, click Close to return to the File Print dialog.

    Drill Symbols
         To define drill symbols in your printer output, click the Drill Symbols button in the File Print dialog.
         The Drill Symbol Assignments dialog appears.
         To generate a drill symbol drawing, you must enable all signal and power/ground layers on which
         the pad is defined. Enabling Drill Symbols excludes all copper from this print job and sends just the
         assigned symbol in its place.




P-CAD PCB User’s Guide                                                                                         213
Chapter 12: File Commands                                                                              File Print


         The purpose of this dialog is to list all of the currently used hole diameters in the design, along with
         their plating characteristics and corresponding drill symbols. Holes of equal size with different
         plating characteristics appear as separate entries in the list. An asterisk next to a drill symbol
         indicates that it is already assigned to a hole diameter.
         To attach a drill symbol to a hole diameter, highlight both of them and then click Assign. You can
         clear the assignment in the same way by clicking Unassign.
         If you click Automatic Assign, the drill symbol and hole diameter lists will automatically match up
         from top to bottom, the first hole diameter assigned to the first drill symbol, the second symbol to
         the second diameter, etc. Unassign All clears all of the drill symbol assignments.
         Click Close to save all of the assignments and return to the File Print dialog.

      Colors and Other Print Options
         You can define colored, grayscale, or monochrome printer settings. You can also set the size of
         various points that appear in a design. To set up print colors and other options, follow these steps
         from the File Print dialog:
         1.   Click the Colors button. This opens the Printer Options dialog shown in the following figure.




              The Printer Options dialog is similar to the Options Display dialog. However, changes to your
              printer options do not affect your options display settings. For more information about the
              Colors or Miscellaneous tab, see Options Display (page 442).




214                                                                                   P-CAD PCB User’s Guide
File Print Setup                                                                    Chapter 12: File Commands


        2.   Click the Colors tab, then choose print colors using one of these methods:
             •     If you have a color printer, click the appropriate buttons and choose a color from the color
                   palette that appears.
             •     If you have a black and white printer, click the Defaults button. This turns all colors to
                   monochrome. We recommend that you use the default settings to avoid undesirable
                   output when color settings are converted to grayscales.
        3.   Click OK to close the Print Options dialog. You return to the File Print dialog.


File Print Setup
        Displays a list of installed printers and allows you to set the current printer. You can also change
        device-specific parameters. When you choose File » Print Setup, the following dialog appears.




        Select a printer from the Name list and click Properties to configure print parameters. Because
        print parameters are device-specific, the dialog, which appears, is different depending upon the
        printer you selected.
        To select a printer, select the printer from the Printers list. Then, click OK to close the dialog.


File Reports
        Choose File » Reports to generate reports with specific output options.
        You can customize the standard reports and save the new report to a file that can be reused. The
        format you select in the Style Format frame determines the options available for each of these
        styles:
        •    Separated-List
        •    P-CAD Report



P-CAD PCB User’s Guide                                                                                          215
Chapter 12: File Commands                                                                        File Reports


       With the P-CAD Report style, in addition to setting Lines per Page and Report Destination, you may
       select the page format and define the Header and Footer. The Customize feature gives you the
       ability to choose which fields are displayed in the report, their sort order and other format options.
       These options are saved when you quit the program.
       The File Reports dialog appears as follows:




       Filename
       The Filename button gives you the ability to gain access to files other than the current design
       through a standard open file dialog. The Filename is the same as that of the current design by
       default, it is also saved to the location where saved reports are stored.

       Reports to Generate
       You may select the reports you wish to generate from the list of report types in the Reports to
       Generate list. The Reports to Generate box lists all the predefined reports along with any
       customized reports stored with the design. Each report has a unique file name extension, which is
       displayed alongside the report. These file name extensions cannot be changed.
       The available reports are as follows:
       •   Aperture Information: Lists aperture information such as units used, definitions (D code, type,
           etc.), and aperture assignments.
       •   Attributes: Contains component and net attributes.
       •   Bill of Materials: Lists the component attributes you have selected for inclusion in the report.
           Any attribute present in the design can be chosen to appear in the report.




216                                                                                P-CAD PCB User’s Guide
File Reports                                                                        Chapter 12: File Commands


        If you have special components that have hidden reference designators (RefDes) and you want to
        exclude them from the Bill of Materials, you can explode the component (Edit Explode Component)
        and delete the RefDes, or just delete the component from the report.

        •      Component Locations: Lists, for each component, the reference designator and location (the X
               and Y coordinates). Fixed components are also identified. If you have special components in
               the design, see the note with the BOM report option above.
        •      DRC Error Indicators: Generates a list of all the DRC error indicators, locations and text on the
               board. This allows you to generate a hardcopy for all the DRC error indicators generated by
               Online DRC.
        •      Glue Dot Locations: Lists the layer and position of all glue dots in the current design.
        •      Library Contents: Lists all of the components that are contained in all of the currently open
               libraries. See Library Setup (page 493) for information on opening libraries.
        •      Pick and Place Locations: Lists the layer and position of all pick and place points in the current
               design.
        •      Rooms: Lists the properties of the rooms such as Name, Placement Side, Rules and Included
               Components along with their value. Another section lists the components in the design and
               the room in which each component resides.
        •      Statistics: Contains a variety of information about the current design, such as primitives count,
               board dimension, line widths used, layer types used, etc.
        •      Test Point: Shows the X,Y coordinates of the test points in the current design, the net name to
               which points are attached, the side of the board the point is tested from, and whether or not
               the point is a fixed object.

        Report Destination Frame
        In the Report Destination frame, choose one of the following options:
        •      Choose Screen to save the report file and automatically display it in the Notepad.
        •      Choose File to send the report output to a file.
        •      Choose Printer to send the report output to the printer. This option does not create a report
               file.

        Report Origin Frame
        The X and Y coordinates of the default report origin are 0,0, which represents the lower left corner
        of the design. If you want to offset the report origin, enter the desired X and Y coordinates in the
        appropriate boxes. Coordinates printed in the report output indicate their position relative to the
        designated coordinates.
        Report origins are printed in the first line of the output report in the standard P-CAD Report format.




P-CAD PCB User’s Guide                                                                                         217
Chapter 12: File Commands                                                                            File Reports


        Style Format Frame
        Choose one of the following buttons in the Style Format frame.
        •   Separated List: Choose this option to place all data in character-separated format. You can
            import this format into other spreadsheet and database programs.
        •   P-CAD Report: Choose this option to produce a report format with columns and spaces, etc.
        If you choose Separated List, type the character you want to use as the separator or choose one
        from the List Separator list. The character that appears in this list by default is the list separator
        defined in your Regional Settings for Microsoft Windows.

        File Reports Buttons
        The buttons below the Reports to Generate list control report settings, provide access to the
        Customize Report dialog, and give you the ability to generate reports.
        The buttons perform the following functions:
        •   Delete: Removes a customized report from the design. You cannot delete the predefined
            reports described in Reports to Generate (page 216).
        •   Customize: Opens the Customize Report dialog where you can set many options to adapt a
            report and save it for future use. See Custom Report Option (page 218) for more information.
        •   Set Defaults: Returns all settings to the PCB reports default values.
        •   Set All: Selects all the reports in the list.
        •   Clear All: Cancels the selection of any selected reports in the list.
        •   Generate: Creates the selected reports using the options.

      Custom Report Option
        When you click Customize in the File Reports dialog, the following Customize Report dialog
        appears with the Format tab selected:




218                                                                                    P-CAD PCB User’s Guide
File Reports                                                                       Chapter 12: File Commands




        Format Tab
        The Format tab contains the following options:
        •      Header: Type a heading for the report. This option is only available with the P-CAD Report
               format.
        •      Footer: Type a footer for the report. This option is only available with the P-CAD Report
               format.
        •      Page Format: The check boxes in the Page Format frame apply to reports whose Style Format is
               the P-CAD Report. Select the desired check boxes from the following:
        •      Use Header: Select this check box to include the information you specified in the Header box.
        •      Use Footer: Select this check box to include the footer information entered in the Footer box.
        •      Design Info: Select this check box to include the information you entered in the File Design
               Info dialog.
        •      Date/Page: Select this check box to include the current date and the page number.
        •      Pagination: Select this check box to create your own pagination (lines per page).
        •      Lines per Page: Enter the number of lines you want printed on each page.
        •      Attribute Column Width: Defines the number of characters, up to 2000, used to display an
               attribute.
        •      File Extension: The File Extension box displays the default file name extension for the selected
               report. You can also enter a new file name extension if desired.




P-CAD PCB User’s Guide                                                                                        219
Chapter 12: File Commands                                                                             File Reports


       Selection Tab
       The Selection tab in the Customize Report dialog lists the report fields and gives you the ability to
       choose which fields appear in the report. With this tab, you can also define selection criteria, as
       shown in the following figure:




       The columns in the Selection spreadsheet are as follows:
       •        Field: The list of fields specific to the selected report.
       •        Show: Select the Show check box to display the corresponding fields in the report. Cleared
                check boxes do not appear in the report output.
       •        Criteria (And): Contains the selection criteria used to filter the report data.
       •        Or: Additional selection criteria can be entered here, if necessary.
       Operators available for use in the Criteria (And) and Or columns are shown in the table below:


               Operator                                           Function
           =                 Exactly equal to.
                             If used with a wildcard operator, * or ?, this operator becomes literal. It
                             searches for a set of characters with, for example, a question mark at the
                             end.
           <                 Less than.
           >                 Greater than.
           <=                Less than or equal to.
           >=                Greater than or equal to.




220                                                                                      P-CAD PCB User’s Guide
File Reports                                                                      Chapter 12: File Commands



               Operator                                      Function
         <>               Not equal to.
         IsLike           If used with a wildcard operator, IsLike means is similar to. For example,
                          IsLike 5* could be 50, 510, 5, etc.
                          If not used with a wildcard operator, IsLike is equivalent to =.
         IsNotLike        If used with a wildcard operator, IsNotLike means is not similar to. For
                          example, IsNotLike 5* could be 14 or 20 or 42, but not 50, 510 or 5.
                          If not used with a wildcard operator, IsNotLike is equivalent to <>.
         Exist            The attribute exists.
         NotExist         The attribute does not exist.
         AnyValue         The attribute exists and it has some value.
         NoValue          The attributes exists, but it is assigned no value.


        The columns in the spreadsheet can be resized by moving the column separation lines right or left.
        You can append another Or column with the Add Column button. To reposition fields in the list,
        click Up or Down, which determines the order in which they are output to the report.
        The system generates the value in the Count field when the report is produced. Selection criteria
        cannot be applied to the Count field.

        If you have installed P-CAD Library Executive, the File Reports Selection utility allows you to add
        attributes from a non-P-CAD source, if desired, using the Import Files button. See your P-CAD
        Library Executive User’s Guide for details on this feature.

        Sort Tab
        The Sort tab provides you with the ability to select the field(s) used to sort the report output and
        choose a sort order. The Sort tab appears as follows:




P-CAD PCB User’s Guide                                                                                         221
Chapter 12: File Commands                                                                         File Reports




       The Sort tab contains the following options:
       •   Available Fields: The list of fields in the selected report.
       •   Selected Fields: The fields used to sort the data, the order in which the sort is applied and the
           field’s sorting order (A) for Ascending or (D) for Descending, are displayed in the Selected
           Fields list.
           The Insert button takes a selected field from the Available Fields list and inserts it above the
           selected field in the Selected Fields list. The Append button moves the field to the bottom of
           the Selected Fields list. To move fields from the Selected Fields list back to the Available Fields
           list, select the field and click the Remove button.
       •   Sorting Order: The Sorting Order is set by clicking the desired option button to sort in
           Ascending or Descending order before moving a field to the Selected Fields list.

       Adding a Custom Report
       Once you have selected your report options, click Add to open the following Report Configuration
       dialog:




222                                                                                 P-CAD PCB User’s Guide
File Design Info                                                                Chapter 12: File Commands


        Type a name for the report in the Enter Report Name box and click OK. You are returned to the File
        Reports dialog where the new report is listed in the Reports to Generate list. You can select the
        reports and generate output by clicking Generate.

        If you select and generate both the custom report and the one on which it was based, both results
        are output in a single file or report. To get individual outputs, generate each report separately


File Design Info
        Choose File » Design Info to enter design information, review design statistics, and to query or
        modify design attributes and fields. You can also group fields into distinct field sets and
        incorporate design and revision notes into your design. When you choose this command, the
        Design Info dialog appears with the General tab selected:




        The fields placed in your design using the Place » Field command use the information entered in
        this dialog.
        For example, suppose you placed a Title field in your design. If you changed the value of the Title
        field on the Fields page of this dialog to design02, then the Title field in your design would be
        updated to display design02. If you had numerous Titles placed in your design, they would all be
        changed to reflect what you enter here. See Place Field (page 398) for information on placing fields.
        The information that you specify with this command is saved with and restored from the design file.




P-CAD PCB User’s Guide                                                                                     223
Chapter 12: File Commands                                                                        File Design Info


         The following sections describe the tabs in the File Design Info dialog.

      General Tab
         The General tab in the File Design Info dialog contains information about the design file, including
         its location, size, and creation date.
         Many of these fields appear in the Place Field dialog and may be placed in the design. Their values
         are automatically assigned based on the file information displayed on the General tab. These
         system generated fields include: Design Name, Location of Design, Size, and Last Modified Date.

      Fields Tab
         The Fields tab in the File Design Info dialog includes all the predefined and user-defined fields
         contained within the design. All fields listed in this dialog may be placed by choosing Place » Field.




         When a field value is modified in this dialog, all fields of that type in the design are automatically
         updated to reflect the new value.
         Predefined field types include: Approved By, Author, Checked By, Company Name, Current Date,
         Current Time, Date, Drawing #, Drawn By, Engineer, Filename, GUID, Layer Name, Modified Date,
         Revision, Time and Title.




224                                                                                    P-CAD PCB User’s Guide
File Design Info                                                                     Chapter 12: File Commands


        You can also create custom, user-defined fields to contain design data of your choice and group
        fields into Field Sets. The Fields tab contains the following options:
        •    Name: This list displays the non-system generated, predefined fields and their values. If there
             are any user-defined fields, their names and values are displayed here also.
        •    Value: The Value assigned to the field. For instance, the Value of the field Author may be John
             Doe. If the Value of a field is blank and you place that field in your design, the Name of the
             field, instead of its value, is displayed at the field location.
        To add a new field and its value:
        1.   Click Add.
        2.   Click Properties to modify only the Value of an existing field. When adding a new field, the
             Field Properties dialog appears, as shown in the following figure:




        3.   To modify the Location, Text Style or Justification of a field that has been placed in the current
             design, select the field in the design. Right-click and choose Properties from the shortcut
             menu.
             The Field Properties dialog contains the following options:
             •     Name: Enter the name of a new field. The name of an existing field is displayed here.
             •     Value: The Value assigned to the field.
             •     Text Style: The Text Style in which the Value of the field is displayed.
             •     Location: The current X and Y coordinates of the field’s location in the design.
             •     Justification: Displays the current chosen justification of the field’s value within its
                   boundaries.
             •     Flip: A check indicates that the field has been flipped.
             •     Rotation: When the field has been rotated the rotation degree is displayed here.
        4.   To remove a user-defined field, select the field in the Field Set list and click Delete.
        To add or delete field sets:




P-CAD PCB User’s Guide                                                                                        225
Chapter 12: File Commands                                                                       File Design Info


         1.   Click Field Sets in the Fields, Notes or Revisions tabs to open the Field Sets dialog as shown in
              the following figure:




         2.   Add a new field set by typing a name in the Field Set Name box and clicking Add.
         3.   Delete a field set by selecting the field set name in the Field Set list and clicking Delete. When
              a field set is removed, all layers referencing the removed field set are reassigned to the default
              field set. The default field set cannot be deleted. The field values contained within the removed
              field set are deleted.

      Attributes Tab
         The Attributes tab in the File Design Info dialog gives you the ability to view and modify design-
         level attributes:




         These are attributes that are attached to a particular design, rather than a component or net.



226                                                                                   P-CAD PCB User’s Guide
File Design Info                                                                  Chapter 12: File Commands


        You can view, add, modify, or delete a collection of design attributes. The dialog contains a two-
        column table showing the collection of design attributes. Within a collection, each attribute’s name
        and value appear in the column.
        •   Adding an Attribute: To add an attribute, click the Add button to open the Place Attribute
            dialog. Enter and name and value for the attribute and set the attribute properties. Click OK,
            and the attribute is added to the table.
        •   Viewing or Changing Attribute Properties: To view or change an attribute’s properties, select
            an attribute from the table and click Properties (or double-click the attribute) to open the
            Attribute Properties dialog.
        •   To Delete an Attribute: Select an attribute in the table and click Delete, or press DELETE.
        •   Launching a Reference Link: When the special attribute Reference, whose value is a reference
            link, is added to the component, you can select the Reference attribute and click Launch to
            start a program that displays a document, or to launch the Internet Explorer and go to a specific
            web site.
        For details about this function and a complete listing of attributes, see Place Attribute (page 396).

    Notes Tab
        In the Notes tab you can specify design or drawing notes, which can later be included in your
        design by placing a Note field or a Notes table. These notes can be annotated using the industry-
        standard symbols: box, circle, triangle or none. The Notes tab appears as shown in the following
        figure:




P-CAD PCB User’s Guide                                                                                          227
Chapter 12: File Commands                                                                        File Design Info


         The options available on the Notes tab are:
         •   Field Set: To modify a particular field set’s contents, select the field set name from the Field Set
             list. The notes for that field set can be modified directly by editing the entries in the dialog.
             Field sets can be added or deleted by clicking the Field Sets button.
         •   Number of Notes: The total number of notes.
         •   Note Text: Enter or modify notes text in the Notes box.
         •   Annotation: Select the Annotation type for the note number: box, circle, triangle or none.




         •   Add: Click Add to begin entering notes or to add a note to the end of the list.
         •   Delete: To remove a note, place the cursor in the note text and click Delete.
         •   Import/Export: To import a note from an ASCII text file, click Import. To export a note to an
             ASCII text file, click Export.

      Revisions Tab
         The Revisions tab is identical to the Notes tab, except that the Annotation options and the ability to
         Import/Export from an ASCII file are not present. Revision notes are used specifically to document
         changes between drafts of a design. See Notes Tab (page 227) for information on the options
         available on the Revisions tab.

      Statistics Tab
         The Statistics tab in the File Design Info dialog displays the design statistics, as shown in the
         following figure:




228                                                                                    P-CAD PCB User’s Guide
File Design Technology Parameters                                                    Chapter 12: File Commands




       This information in this dialog is read-only and details various statistics for the active file (a.k.a.,
       current file).


File Design Technology Parameters
       A File » Design Technology Parameters file (*.dtp) stores design data, such as pad styles, via styles,
       net classes, layer sets, and design rules. You can use this file as a template for other P-CAD designs.
       A .dtp file is organized in a hierarchy. The file is divided into technology groups. These groups can
       contain different, but related, types of design data and can be placed into a design. A technology
       group consists of one or more pre-defined sections; these sections contain sets of items of the
       same type. Each item possesses properties, which correspond to specific design data.
       A design technology parameters file is like a storage box. You can reorganize it, add or remove
       items, alter some of its contents, and use what is stored inside. For a project or series of projects,
       you may have several items that you will have to use repeatedly for creating PCB designs. The
       design technology parameters file is a perfect storage box for the following design items: class-to-
       class rules, global rules, layer sets, net class definitions, net class and net class layer rules, net and
       net layer rules, pad styles, and via styles.
       First you must build your storage box, and organize it so that you can find items when you need
       them. The starting point is the Design Technology Parameters dialog described below. From there
       you can build, browse, and modify the contents of the DTP file.




P-CAD PCB User’s Guide                                                                                            229
Chapter 12: File Commands                                                File Design Technology Parameters


      Creating or Opening a Design Technology Parameters File
        1.   Choose File » Design Technology Parameters from the menus.
        2.   If you have never used a DTP file before the Open dialog will appear, where you can browse
             and locate an existing DTP file. If you wish to create a new DTP file type in a Filename then click
             Open.
        3.   If you have previously used a DTP file this file will automatically be reopened. To select a
             different DTP file, or to create a new file, click the Technology Filename button. When the
             Open dialog appears browse to locate an existing file, or type in a Filename if you wish to
             create a new one.
        4.   When the correct DTP file is open you ready to work on the design technology parameters in
             the Design Technology Parameters dialog.
        5.   When you create a new DTF file it will be empty. The first thing you need to do is to create a
             new Group. To do this click on the icon for the DTP filename at the top of the hierarchy, then
             click the New Group button (this button is only available when you click on the DTP filename
             icon). The Group is where the various sections of the DTP file are stored, each section
             corresponds to a different technology parameter. The supported sections include:
             •   Apertures
             •   Class to Class Rules
             •   Design Rules
             •   Global Rules
             •   Layers
             •   Layer Sets
             •   Net Class Definitions
             •   Net Class Rules
             •   Net Rules
             •   Pad Styles
             •   Via Styles

      Design Technology Parameters Dialog
        When you choose File » Design Technology Parameters, the following Design Technology
        Parameters dialog appears:




230                                                                                  P-CAD PCB User’s Guide
File Design Technology Parameters                                               Chapter 12: File Commands




       Notice that information is arranged in a tree structure, similar to the arrangement of folders and
       files.
       From this dialog you can set up the design technology parameter, copy design technology
       parameter data to or from a design, view or modify data properties, and browse or modify the file’s
       hierarchy. The options in this dialog are described in the following sections.

       Technology Filename Button
       In the Design Technology Parameters dialog, click Technology Filename to open the Open dialog.
       With this dialog, you can choose the folder and file name of the file you want to open or create.
       •   To open a design technology parameters file, select the folder and file name of the file you
           wish to open. Click Open.
       •   To create a design technology parameters file, select the folder in which you want to create the
           file. Type the filename in the Filename box. Click Open. You are asked to confirm your new
           design technology parameters file creation.

       Read-only Files
       If a .dtp file is read-only, the Read-only check box just below the Technology Filename button is
       selected and the term “read-only” appears next to the filename. You can make a .dtp file read-only
       by selecting this check box.
       If a .dtp file is read-only, you cannot update it with data from a design, modify an item’s
       properties, rename an item, or delete an item.




P-CAD PCB User’s Guide                                                                                      231
Chapter 12: File Commands                                               File Design Technology Parameters


       The Design Technology Parameters Tree
       The contents of the open parameters file appear as a tree structure, or hierarchy, in the File Design
       Technology Parameters dialog. You can browse the tree to view its contents. Also, you can highlight
       groups, sections, or items in the tree to select them for copying to a design, editing properties, and
       completing other functions described in this section.




       The tree structure allows you to view your entire file at various levels of detail by expanding or
       collapsing the branches of the tree.
       Groupings containing collapsed levels are shown with a + sign. To expand the grouping, click the +.
       Expanded groupings are shown with a – sign. To collapse the grouping, click the – sign.

       When you open a new design technology file, only the filename appears in the tree.

       Update From Design Button
       Click Update From Design to add information from your current design to the design technology
       parameters file.
       To add design data to your design technology parameters file, select a group, section, or item. If
       you select a group or section, all items contained below it in the hierarchy are selected. Click
       Update From Design.
       •   If you select a group, the Select Section Type dialog appears. Select the sections you want to
           update. See New Section Button (page 240) for more details.
       •   If a selected item exists in the parameters file, you are asked to confirm its replacement by
           clicking the appropriate button: Yes To All, Yes, No or Cancel.
       •   If the selected item does not exist in the parameters file, it is added automatically.

       Copy To Design Button
       Click Copy to Design to modify your current design using data contained within your design
       technology parameters file.




232                                                                                 P-CAD PCB User’s Guide
File Design Technology Parameters                                                  Chapter 12: File Commands


       To modify your design using data in the design technology parameters file, select a group, section,
       or item. If you select a group or section, all items contained below it in the hierarchy are selected.
       Click Copy to Design.
       •   If a selected item exists in the design, you are asked to confirm its replacement by clicking the
           appropriate button: Yes To All, Yes, No or Cancel.
       •   With three exceptions, if the selected item does not exist in the design, it is added
           automatically. Net rule, net class definition, and global layer rule items are not created if they
           do not exist in a design.
       When you click Copy to Design, the design changes that occur depend on the type of item
       selected. For class-to-class rule, net class rule, and net rule items, you can choose to replace or
       merge the rules in the design with those of your design technology parameters file. Make this
       selection by choosing the Merge Attributes or Replace Design Attributes option button in the
       Design Technology Parameters dialog before clicking Copy to Design.
       The following sections describe options for each item type, and the design data changes that occur
       when that item is added to a design.

       Class-To-Class Rule Item
       If both net classes exist in the design, you have a choice of three options: to create, to merge, or to
       replace class-to-class rules. A class-to-class rule is created if it does not already exist. To choose
       between the merge or replace options, enable the corresponding option button in the Design
       Technology Parameters dialog before clicking Copy to Design.
       •   Replace Design Attributes: Replaces a design’s class-to-class rules with the rules from the
           Class-To-Class Rule Item.
       •   Merge Attributes: Merges the rules of the Class-To-Class Rule Item with the design’s class-to-
           class rules, favoring the Class-To-Class Rule Item rules over the design.
       If both net classes do not exist in the design, a class-to-class rule is not created.

       Global Layer Rule Item
       If a global layer rule item of the same name exists in the design, it’s layer rules are replaced with the
       layer rules defined by this Item.
       If a global layer rule item of the same name does not exist in the design, it is not created.

       Layer Set Item
       If a layer set of the same name exists in the design, then it’s layers are replaced with the layer
       members defined by this Item.
       If a layer set of the same name does not exist in the design, then a layer set with the layer names
       defined by this item is created in the design.

       Net Class Definition Item
       If a net class of the same name exists in the design, it’s net members are replaced with the net
       members defined by this Item. The net class and net class layer rules are not changed.



P-CAD PCB User’s Guide                                                                                       233
Chapter 12: File Commands                                                 File Design Technology Parameters


       If a net class of the same name does not exist in the design, it is not created.

       Net Class Rule Item
       If the net class already exists in the design, you have a choice of two options: to merge or to replace
       the net class and net class layer rules. To choose between the merge or replace options, enable the
       corresponding option button in the Design Technology Parameters dialog before clicking Copy to
       Design.
       •   Replace Design Attributes: Replaces a design’s net class rules with the rules from the Net Class
           Rule Item.
       •   Merge Attributes: Merges the rules of the Net Class Rule Item with the design’s net class rules,
           favoring the Net Class Rule Item rules over the design.
       The net class, with the Net Class Rule Item rules, is created if it does not already exist in the design.

       Net Rule Item
       If the net already exists in the design, you have a choice of two options: to merge or to replace the
       net and net layer rules. To choose between the merge or replace options, enable the
       corresponding option button in the Design Technology Parameters dialog before clicking Copy to
       Design.
       •   Replace Design Attributes: Replaces a design’s net rules with the rules from the Net Rule Item.
       •   Merge Attributes: Merges the rules of the Net Rule Item with the design’s net rules, favoring
           the Net Rule Item rules over the design.
       If the net does not already exist in the design, the net, with its Net Rule Item rules, is not created

       Pad Style Item
       Design technology parameters file pad style(s) are added to the design. A pad style of the same
       name is replaced.

       Replacing pad styles can change physical connections in your design file. Choose Utils » DRC to
       locate unconnected pins and shorts after copying a pad style to your design.

       Via Style Item
       Design technology parameters file via style(s) are added to the design. A via style of the same name
       is replaced.

       Replacing via styles can change physical connections in your design file. Choose Utils » DRC to
       locate unconnected pins and shorts after copying a via style to your design

       Properties Button
       Click the Properties button to view and modify an item’s properties. When you highlight an item in
       the design technology parameters file tree and click Properties, an item-specific dialog appears.
       When you modify properties of items in your parameters file using Properties, the changes are
       made immediately to the file. If you want to create a new design technology file based on an


234                                                                                  P-CAD PCB User’s Guide
File Design Technology Parameters                                                 Chapter 12: File Commands


       existing file, first make a copy of your original design technology file, saving the copy under the
       new name. Then, modify the design technology file copy.

       If the design technology parameters file is read-only, any changes you make to an item are
       discarded.

       The properties available to view or modify for each item are discussed in the following sections.

       Class-to-Class, Net Class, NetClass Layer and Net Rules Properties
       To open the DTP Item Properties dialog, select a class-to-class, net class, net class layer or net rule
       item. Then, click Properties. The DTP Item Properties dialog appears, as shown in the following
       example for a NetClass:




       The dialog contains two lists, depending on the selected item; one for the Item Rules and another
       for the Item Layer Rules. Within the lists, each attribute’s name and value appear in the column.
       To add, modify or delete an Item Rule, click Edit to open the Attributes dialog shown in the
       following figure:




P-CAD PCB User’s Guide                                                                                       235
Chapter 12: File Commands                                               File Design Technology Parameters




       The Attributes dialog contains a two-column table showing the collection of attributes. Within the
       collection, each attribute’s name and value appear in the column.
       •   Adding an Attribute: To add an attribute, click the Add button to open the Place Attribute
           dialog (shown below). Select an attribute category and name, or if the attribute is user-defined
           enter an attribute name. Give the attribute a value and click OK to add it to the table.
       •   Editing Attribute Properties: To edit an attribute’s properties, select an attribute from the table
           and click the Properties button (or double-click the attribute) to open the Place Attribute
           dialog.
       •   Deleting an Attribute: Select an attribute in the table and click Delete.
       •   Launching a Reference Link: When the special attribute Reference, whose value is a reference
           link, is added to the item, you can select the Reference attribute and click Launch to start a
           program or to launch Internet Explorer and go directly to a web site.
       The Attribute dialog appears as shown in the following figure:




236                                                                                 P-CAD PCB User’s Guide
File Design Technology Parameters                                                Chapter 12: File Commands




       For complete information on the Attribute dialog, see Attribute Properties (page 328).
       To add, modify or delete an item layer rule, click Edit to open the Edit Item Layer Rules dialog, as
       shown in the figure below:




       The Edit Item Layer Attributes dialog lists the Layers and indicates whether the layer Has Attributes
       with an asterisk. You can select layers having a specific attribute by clicking the Select by Attribute
       button to display the Set By Attribute dialog. See Set By Attribute (page 349). You can also modify
       layer attributes by clicking the Edit Layer Attributes button. See Edit Attributes (page 350).
       Global Layer Rules Properties




P-CAD PCB User’s Guide                                                                                        237
Chapter 12: File Commands                                               File Design Technology Parameters


       A Global Rules section can contain layer rule items. To open the Layer Clearance dialog, select a
       layer rule item and click Properties. The following dialog appears:




       The clearance values of the layer rule you selected appear in the Pad to Pad, Pad to Line, Line to
       Line, Pad to Via, Line to Via, and Via to Via boxes.

       Layer Set Properties
       When a layer set item is selected, and you click the Properties button, the Layer Sets Definition
       dialog appears:




       Layers sets let you group layers to control the selection, display, printing, Gerber output, N/C Drill
       output, and DXF output. For details, see Options Commands (page 423).
       1.   Type a layer name in the Layer Name box.



238                                                                                 P-CAD PCB User’s Guide
File Design Technology Parameters                                                  Chapter 12: File Commands


       2.   Click Add.
       3.   Repeat the process until you have added all layers to the layer set.

       Net Class Definition Properties
       When a net class definition item is highlighted and the Properties button is selected, the Net Class
       Definition dialog appears:




       This dialog allows you create net classes and add nets to the class. For details, see Options
       Commands (page 423).
       To add a net class definition, follow these steps:
       1.   Type a layer name in the Net Name box.
       2.   Click Add.
       3.   Repeat the process until you have added all nets to the class.

       Pad Style Properties
       When a pad style item is highlighted and the Properties button is selected, the Modify Pad Style
       (Complex) dialog appears:




P-CAD PCB User’s Guide                                                                                    239
Chapter 12: File Commands                                               File Design Technology Parameters




       From here you can modify the shape, dimensions, hole diameter and other properties of the
       selected pad style. For details, see Options Pad Style (page 472).

       Via Style Properties
       Via styles are almost identical to pad styles in the way that you add, edit, modify, view, delete and
       rename them.
       When a via style item is highlighted and the Properties button is selected, the Modify Via Style
       (Complex) dialog appears. For details, see Options Via Style (page 482).

       New Group Button
       When you highlight the filename in the tree, the New Group button allows you to create a new
       group in your design technology parameters file. When you click New Group, the following dialog
       appears:




       Type a name for the group in the New Name box. Then, click OK.

       New Section Button
       When you highlight a group name in the File Design Technology Parameters tree, the New Section
       button gives you the ability to create a new section within the selected group.
       To create a section, do the following:
       1.   Click New Section in the DTP dialog. The New Section Type dialog appears:




240                                                                                 P-CAD PCB User’s Guide
File Design Technology Parameters                                               Chapter 12: File Commands




       2.   In the Section Type frame, select the section type check boxes that you want to add to the
            group. Once you’ve added a section, it is shaded out in the dialog. Available sections are listed
            below:
            •   Class-to-Class Rules
            •   Global Rules
            •   Layer Sets
            •   Net Class Definitions
            •   Net Class Rules
            •   Net Rules
            •   Pad Styles
            •   Via Styles
       3.   Click OK.
       The selected section or sections are automatically named and added to the group.

       New Item Button
       When you select a section name in the File Design Technology Parameters tree, the New Item
       button allows you to create a new item in your design technology parameters file. When you click
       New Item, an item-specific dialog appears similar to the Enter Net Class Name dialog shown in the
       following figure:




P-CAD PCB User’s Guide                                                                                     241
Chapter 12: File Commands                                              File Design Technology Parameters




       Type the desired item name in the New Name box. Click OK. This item name should either match
       an item name found in your design, or be the name of a new item you are creating.

       Rename Button
       Click the Rename button in the Design Technology Parameters dialog to rename a group or item.
       Sections cannot be renamed.
       To rename a group or item, follow these steps:
       1.   Select the group or item.
       2.   Click Rename and a dialog appears similar to the Rename Net Class dialog shown in the
            following figure:




       3.   Type a name in the New Name box and click OK.

       Delete Button
       Use the Delete button in the DTP dialog to delete objects from the tree.

       IMPORTANT: When a group or section is deleted, all items contained within it will be removed.
       Your delete selection cannot be undone.

       To delete a group, section, or item:
       1.   Select a group, section, or item from the tree.
       2.   Click Delete.
       3.   When prompted to confirm your selection, click OK.

       Statistics Button
       Use the Statistics button in the DTP dialog to view statistics about the design technology
       parameters file. When you click this button, the following Statistics dialog appears.




242                                                                               P-CAD PCB User’s Guide
File Design Technology Parameters                                              Chapter 12: File Commands




       It contains the following information:
       •   The type of item.
       •   The user name of the person creating the .dtp file.
       •   The date the file was created.
       •   The user name of the person who last modified the file.
       •   The date of the last modification.

       Attribute Handling on Copy
       For Net Rule, Class-to Class Rule, and Net Class Rule Items you can choose to replace or merge
       attributes when copying these rule items to a design. The Attribute Handling on Copy group box in
       the Design Technology Parameters dialog contains the following options:
       •   Replace Design Attributes: Replaces a design’s rules with the rules from the design technology
           parameter file item.
       •   Merge Attributes: Merges the rules of the design technology parameter file item with the
           design’s rules, favoring the rules of the design technology parameter file item over the design.




P-CAD PCB User’s Guide                                                                                   243
Chapter 12: File Commands                                                          File Import Shape Route



File Import Shape Route
       The P-CAD Shape-Based Router runs as a separate program in Windows. As well as running the
       Shape-Based Router directly from the Route Autorouters dialog, you can launch it separately, load a
       Shape Route file that has been exported from P-CAD PCB, route it, save the routing results, then
       Import the routes back into the P-CAD PCB Editor by selecting the File » Import » Shape Route
       command.




File Import Gerber
       Choose File » Import » Gerber to load a series of Gerber files. You can load a Gerber file into the
       editor to check its accuracy. Each file is loaded onto a separate layer.
       You can load a Gerber file either into an empty workspace (choose File » Clear to clear the
       workspace) or superimpose it onto an existing design. Loading a file alone is usually for checking
       pad size, line width, or other possible errors. Superimposing a file onto a design is a good way to
       verify the Gerber file against the design.
       To avoid the risk of cluttering a working design with unwanted Gerber geometry, save the design in
       its current state (choose File » Save or File » Save As) before importing data from Gerber files.



244                                                                                P-CAD PCB User’s Guide
File Import Gerber                                                               Chapter 12: File Commands


        You can examine the Gerber file through the workspace display in addition to analyzing the error
        file displayed in Notepad.
        When you choose File » Import » Gerber, the following dialog appears.




        Click Gerber Filename to open the File Gerber In dialog, shown in the following figure.




        Select your Gerber file and click Open to return to the File Gerber In dialog. Then, specify the Layer
        Name and Layer Number and select or clear the View log file upon completion check box. The
        layer name Gerber is provided by default, but you can change this name.
        You can load multiple Gerber files onto your design file, each inhabiting its own layer. When you
        load a Gerber file, it automatically creates a non-signal layer named Gerber, using the next free
        layer in sequence. For example, if you have eleven layers, the twelfth is used.
        Therefore, the layer names must be unique. So, the first file loaded would be on the layer Gerber,
        the next file loaded would receive the default name Gerber1, then Gerber2, etc. Normally you
        would load multiple files to verify that the layers are aligned and registered properly.

        IMPORTANT: The D Code apertures that are called out by the loaded Gerber file must be present
        and be defined as they were in the original Gerber file. If a D Code is no longer present, then the
        program will flag the error. If the D Code is present but its definition has changed, no error will be
        flagged, and you may get unexpected results. For example, this could occur if you loaded an old
        Tango Series II Gerber file without first recreating the aperture definitions properly. Our advice is
        that you should not redefine D Codes at all between the creation of the Gerber file and reloading it
        for design file/Gerber file comparison.




P-CAD PCB User’s Guide                                                                                     245
Chapter 12: File Commands                                                                   File Import DXF


        Aperture definitions are saved and loaded in the design file. Loading a new design file can
        completely change the current aperture settings. The File » Clear command does not clear current
        aperture definitions, so you can choose File » Clear to clear the workspace before loading a newly
        created Gerber file.

        IMPORTANT: Do not save Gerber layers with your .pcb file. See Deleting Gerber Layer
        Information (page 180) for instructions on how to delete Gerber layers that were accidentally saved
        along with your design.

        Click OK to load the photoplot file.

        If the layer limit is exceeded, your design cannot be loaded using P-CAD PCB (6/400). P-CAD PCB
        (6/400) designs are restricted to a maximum of six copper layers, including a predefined Top and
        Bottom layer and four user-defined signal or plane layers. P-CAD PCB (6/400) designs can have a
        total of up to 1,000 layers.


File Import DXF
        DXF (Drawing Interchange Format) files generated using AutoCAD® Version 9.0 through 14 or other
        conforming CAD programs can be loaded into PCB. Using this command, you can create
        dimensions, board outlines, manufacturing instructions, artwork, logos, etc., and then import the
        resulting DXF file into PCB.

      Loading a DXF File
        To load a DXF file into PCB, choose the File » Import » DXF command. A standard Open File dialog
        appears where you can navigate to the file you want to load. When you click OK, the File DXF In
        dialog appears as shown in the following figure:




246                                                                               P-CAD PCB User’s Guide
File Import DXF                                                                Chapter 12: File Commands




        The File DXF In dialog contains the following options, which determine how the file is treated when
        loaded:

    DXF to P-CAD PCB Layer Map
        The DXF to P-CAD PCB Layer Map list displays the layers in the imported file and the PCB layer to
        which each is mapped. The P-CAD Layer box and the buttons located directly below it are used to
        specify layer mapping for selected layers.

        If a DXF file contains layers whose names use AutoCAD reserved keywords (i.e., vport, view), a
        syntax error occurs and causes the file load to abort. Rename the layer to work around this
        limitation.

        The buttons perform the following functions:
        •   Map Selected Layers: Each selected DXF layer is mapped to the layer chosen in the P-CAD
            Layer drop-down list by clicking the Map Selected Layers button after one or more layers has
            been selected.
        •   Create New Layer: Opens the Options Layer dialog where you can add a new layer if the
            desired layer does not appear in the drop-down list. To automatically create layers use the
            Default Map and Auto Map Layers options.




P-CAD PCB User’s Guide                                                                                    247
Chapter 12: File Commands                                                                     File Import DXF


        •   Default Map: Maps the selected layers to the default layer of DXF_1. If this layer already exists
            the default mapping is to DXF_2, etc.
        •   Auto Map Layers: Maps the selected DXF layer to a corresponding PCB layer of the same name.
            If the DXF layer has the same name as an existing signal layer in the design, you will have to
            map it to a non-signal layer. If the DXF layer name exceeds the number of characters allowed in
            a PCB layer, the PCB layer name is truncated.
        •   Unassign Layers: Removes whatever mapping is present for the selected layers and sets the
            mapping to <None>.
        •   Remove Unneeded Mappings: Clears layer mappings that don’t exist in the current DXF file.
            DXF layer mapping information is stored in the PCB.ini file.
        •   Set All: Selects all the layers in the list.
        •   Clear All: Cancels the selection of all the layers in the list.
        When you click the OK button, PCB verifies that no more than 999 layers exist. If a DXF layer is
        mapped to a PCB layer that does not exist, the PCB layer is created. PCB also verifies that there are
        no mappings to signal or plane layers.

      DXF Units
        The DXF Units frame of the File DXF In dialog provides the ability to choose which units will be
        used to apply proper scaling when loading the DXF file. Click the appropriate option button to set
        the unit for Inch, Cm or Mm.

      Locate DXF Origin
        The P-CAD PCB workspace uses positive X and Y coordinates. Since DXF items can be placed at
        negative X and Y coordinates, you may have to direct P-CAD PCB to adjust the position of your
        imported DXF geometry. On the File DXF In dialog, select a method of translation to positive
        coordinates using the Locate DXF Origin buttons.
        •   Absolute Workspace Origin: If your DXF geometry is positioned only at positive coordinates,
            click the Absolute Workspace Origin button. No coordinate translation is made.
        •   Relative Grid Origin: Loads the DXF geometry so its origin is placed at the Relative Grid Origin
            of your workspace. The Relative Grid Origin is specified with the Options » Grids command.
        •   Auto Adjust to Workspace: Automatically adjusts the placement of your DXF geometry into
            positive coordinates.
        When you import data into P-CAD PCB from a DXF file, and you enable the Auto Adjust to
        Workspace option, the P-CAD PCB automatically translates the position of the lower left extent of
        the DXF file data into the positive P-CAD PCB workspace. The DXF data's lower left extent is the
        coordinate defined by the EXTMIN variable in the header section of the DXF file. If the EXTMIN
        variable is absent from the DXF file, then P-CAD PCB automatically calculates a suitable solution
        based on the extents of the geometry in the DXF file.




248                                                                                 P-CAD PCB User’s Guide
File Import DXF                                                                   Chapter 12: File Commands


        It is suggested that you set the current grid to a uniform value consistent with the grid of your DXF
        design. This grid spacing optimizes the on-grid placement of components. Set your current grid
        with the Options » Grids command before importing your DXF file.
        If DXF geometry items still fall outside the P-CAD workspace, a warning is written to the log file and
        the items are not imported. Your DXF geometry can fall outside the workspace if the translated
        items are still positioned at negative coordinates or if the geometry is larger than the workspace
        size. If the geometry is larger than the workspace size, choose Options » Configure to increase
        your workspace size and import the DXF file again.

    View Log File Upon Completion
        To view the log file when the import is complete, select the View Log File Upon Completion check
        box in the File DXF In dialog.

    Items Supported for Translation
        The following items and features are supported for translation:

        Header Variables
        The AutoCAD® state variables are grouped together at the top of the file in the HEADER section.
        Supported variables are listed and described below, with default values in parentheses.


            Variable                                        Description
         $ACADVER          The AutoCAD® drawing database version number (must be 9.0 or higher.)
         $ANGBASE          The angle zero direction. The DXF coordinate system is rotated by this
                           angle. (0)
         $ANGDIR           The angular orientation: 1 = clockwise; 0 = counterclockwise. (0)
         $MIRR TEXT        Mirror text if non zero. (0)
         $TEXTSIZE         Default text height.


        Tables
        The DXF In command supports the LTYPE, LAYER and STYLE tables.

        Blocks
        The only entries in the BLOCKS section that are supported are the dimension blocks. All
        dimensions that are translated come from this section.

        Entities
        The majority of a DXF file is made up of entities. These include lines, arcs, text, block insertions and
        others. Only two-dimensional entities are supported; z-axis values are ignored. All block insertion
        entities are ignored. Information embedded in the entities for color and layer are also ignored.




P-CAD PCB User’s Guide                                                                                       249
Chapter 12: File Commands                                                                      File Import DXF



                  Element                                     Description
           LINE                DXF LINE entities have infinitesimal width. They are translated into
                               P-CAD lines of one mil.
           ARC                  DXF ARCs are translated into P-CAD arcs of one mil.
           CIRCLE               DXF CIRCLEs are translated into P-CAD arcs with a sweep angle of
                                360 degrees and a one mil width.
           POLYLINE             DXF POLYLINEs are a sequence of possibly tapered, straight and
                                curved lines that are connected end-to-end. These may be open or
                                closed. P-CAD does not support tapering and only supports
                                normal 2-D (unflagged) DXF vertices. POLYLINEs are translated
                                into P-CAD arcs and lines with a thickness equal to the initial
                                POLYLINE thickness.
           LWPOLYLINE           DXF POLYLINEs are translated into P-CAD arcs and lines with a
                                thickness equal to the initial LWPOLYLINE segment thickness.
           MTEXT               MTEXT is the same as TEXT except that MTEXT can handle multiple
                               lines.
           VERTEX              Vertices define DXF POLYLINEs. When translated, they become
                               the defining vertices of the translated P-CAD item. Only normal 2-
                               D DXF vertices are supported (no spline-fit, curve-fit, 3-D mesh, or
                               other special flags).
           SOLID                DXF solids are filled three or four sided polygons. They are
                                translated into P-CAD polygons. Four sided solids that form a
                                complex polygon will be ignored.
           TRACE                DXF traces are lines with thickness that can be filled or unfilled.
                                They are treated the same as DXF solids and are translated into
                                polygons.
           TEXT                 DXF text is translated using an appropriate text style in P-CAD.
                                True Type fonts are mapped to the same font and text height. Text
                                that cannot be mapped to an identical font is translated into the P-
                                CAD default font. Due to the difference in fonts, translated text
                                strings may be of different total width than the DXF version. The
                                bar over barred text may not align exactly with the text.


       The following is a specific (but not comprehensive) list of entries that are not supported:
       •     All BLOCKS, except the dimension blocks.
       •     SHAPE, ATTDEF, and ATTRIB entities.
       •     3DLINE, 3DFACE and 3DSOLID entities.




250                                                                                 P-CAD PCB User’s Guide
File Import PDIF                                                                 Chapter 12: File Commands


        •    Curve- or spline-fit vertices or meshes for POLYLINE and VERTEX entities. Tapering POLYLINEs
             are also not supported.
        •    Three-dimensional entities and coordinates; thickness for all entities will be ignored, and only
             the first two values of a coordinate-triplet will be used.
        •    Dashed and dotted lines are converted to the P-CAD thin width.
        •    Color values for individual entities. Color values for entities will depend on the P-CAD
             primitive and layer to which the entity is translated.

    DXF Import Notes
        The following is a list of notes that are important or useful when using the File » Import » DXF
        command:
        •    The EXPLODE command in AutoCAD® can be used to transform blocks into individual entities.
        •    An important item to be translated from a DXF file is the dimension. AutoCAD® creates a new
             dimension block every time a dimension is moved, edited, or altered in any way. The user
             should use the PURGE command to eliminate any unreferenced copies of the dimension
             blocks created by AutoCAD®. The user should then output the design to DXF format
             immediately after the PURGE command, before editing or modifying dimensions.
        •    Text fonts and styles are more accurately translated from AutoCAD® when the style has been
             defined prior to entering text.


File Import PDIF
        Choose File » Import » PDIF to open Pcad.pdf format design files.

    Open a File
        To open a PDIF file, do the following:
        1.   Choose File » Import » PDIF to open the following dialog.




        2.   Type, or select from the list, the name of the file you want to open in the Filename box.




P-CAD PCB User’s Guide                                                                                     251
Chapter 12: File Commands                                                                       File Import IDF


       3.   If the file you want is not in the current folder, then type the folder name in front of the
            document name, or select the correct folder.
       4.   Click Open.

       If any of the design limits are exceeded, your design cannot be loaded using P-CAD PCB (6/400).


File Import IDF
       The Intermediate Data Format (IDF) format is used to exchange design data between electrical and
       mechanical CAD/CAE systems.
       The IDF Import feature allows the mechanical designer to define the board outline in a mechanical
       CAD program, as well as pre-position placement-critical components and mounting holes, and
       then transfer this information to the PCB designer, who imports it by selecting File » Import » IDF.
       The IDF Import command can load version 2 and version 3 IDF files.




       When you select File » Import » IDF the File Import IDF dialog appears. Enable those options that
       you wish to import from the IDF file.

       Board Outline
       Select this option to import board outline details contained in the .brd file. The board outline
       section of the IDF file is translated into lines and arcs within the PCB design. Board cutout




252                                                                                  P-CAD PCB User’s Guide
File Export Shape Route                                                        Chapter 12: File Commands


       information will be imported as line segments only (arcs are converted to line segments). Existing
       lines and arcs found on the Board layer are removed during import.

       Drilled Mounting Holes
       A free pad is placed for each Drilled Mounting Hole in the IDF file. The pad styles defined in the
       PCB are first searched for a pad which has the correct hole size, and has its shape set to mounting
       hole. If a suitable pad is not found a new pad style is created for each unique mounting hole in the
       IDF file.

       Placement
       When this option is enabled existing PCB components are updated (location, orientation and side
       of board), and new components are imported. Note that components are only imported if a
       matching pattern can be found in the current libraries. Components are identified by their RefDes.
       If an existing component is Fixed on the PCB then it is owned by the PCB (ownership is assumed to
       be ECAD), and is not updated during IDF import. If a component in the IDF file is has its ownership
       set to MCAD it is set to Fixed in the PCB. In the case of an ownership conflict, the PCB ownership
       takes precedence.

       Placement Group Area and Placement Outline
       The Placement Group Area represents the name, position and dimensions of a room. When this
       option is selected, the importer tries to match any of these objects found in the IDF file to existing
       rooms on the PCB, if an exact match to an existing room is found the IDF definition is not imported,
       if there is no existing room then a new room is created.
       The Placement Outline defines the maximum allowed height of the room, whose name, position
       and dimensions are defined by the Placement Group Area.

       Routing Keepout
       When this option is selected any routing keepout information contained in the IDF file is imported
       as polygon keepouts in the PCB design.


File Export Shape Route
       The P-CAD Shape-Based Router runs as a separate program in Windows. As well as running the
       Shape-Based Router directly from the Route Autorouters dialog, you can launch it separately and
       load a Shape Route file. To create a Shape Route file select File » Export » Shape Route from the
       menus. The File PRF Out dialog appears, where you can select the location and name of the PRF file
       and create the PRF file.


File Export Gerber
       Choose File » Export » Gerber to output Gerber files with a variety of options and specifications.
       You can cancel this command before the dialog appears (while the program is searching the
       database for items) by clicking Cancel or pressing ESC.
       Choose File » Export » Gerber to open the following dialog.


P-CAD PCB User’s Guide                                                                                      253
Chapter 12: File Commands                                                                  File Export Gerber




         There are several dialogs that you can gain access to by clicking a button in the File Gerber Out
         dialog, as shown in the following chart.
                                         File Gerber Out
                                           (generate output)




        Setup Output Files       Apertures          Drill Symbols   Gerber Format
                                   (unassign)
                                 (auto assign)



                                    Assign
                             (manual describe/assign)



      Setup Output Files
         Click Setup Output Files to open a dialog where you can set up multiple output files with specific
         output options.




254                                                                                 P-CAD PCB User’s Guide
File Export Gerber                                                               Chapter 12: File Commands




        Output File List Box
        The Output File list contains the filenames of the output files you set up. Each set of options you
        specify (described in the following paragraphs) comprises a separate output file, differentiated by
        its filename extension. After you have set options and the extension for a particular file, you can
        click Add to add it to the list. After you have a file list, you can choose to change a file (click
        Modify), or delete it from the list (click Delete).
        Your output files will have the same base name as the design file, but each with a unique extension.
        Typical file name extensions used to differentiate files would be layer-specific, such as .top, .bot,
        and .tsk (i.e., Top, Bottom, and Top Silk layer).

        Output File Selections Area
        The Output File Selections frame allows you to set options for each output job such as: layer, file
        name extension, X and Y offset, drill symbol size, and items included (Pads, Type, etc.), and the
        output path of the particular file.
        •   File Extension should be a meaningful name for the output (e.g., .top). Avoid potentially
            conflicting file name extensions such as .exe and .pcb. When you click Add, the base
            filename with the file name extension you specify will be added to the file list.
        •   X Offset and Y Offset allow you to set the origin of the plot in a different position than the
            home position of the plotter. For X offset, enter a negative number to offset the plot towards
            the left, positive to the right. For Y offset, enter a negative number to offset downward, positive
            to offset upward.
        •   RefDes, Type, and Value check boxes are typically selected for silkscreen generation, with the
            silkscreen layers.
        •   Mirror is typically used to produce a mirror-image output for bottom layers (e.g., Bottom,
            Bottom Silk, Paste Mask, Solder Mask, Assembly, etc.). Some fabrication shops prefer to mirror
            the output themselves, so check with them before using Mirror.



P-CAD PCB User’s Guide                                                                                        255
Chapter 12: File Commands                                                                    File Export Gerber


        •   Pads, Vias and Pad/Via Holes should be selected if you want them included in the Gerber
            output.
        When producing an output file for a specific hole range, you need to select all the layers on which
        a pad and via’s hole has been defined.
        •   No Mt Hole Cu must be selected if you want to exclude the mounting hole copper from the
            output.
        •   Titles provides the option to include or exclude Title Sheets that exist on the selected layers in
            Gerber output. Select this box to include titles.
        •   Drill Symbols frame size value determines the sizes of the drill symbols output in the particular
            file.
        •   Select or clear the check boxes to include or exclude items and attributes from the output.
        •   Output Path allows you to output the files to a particular location. The default setting for the
            output is the directory of the current design. You may type a new output destination directly
            into the box, or click the Output Path button to open the Windows Search dialog where you
            can navigate to the desired directory.
        •   View error file upon completion opens WordPad where you can view the log file.
        •   The Layers box lists all current layers of the design. You can highlight any number of them for
            output to a particular file.
        •   The Layer Sets box is used to designate specific, predefined layer sets to output. Select a layer
            set from the list and click Apply Layer Set.
        To generate a drill symbol drawing, you must enable all layers that match the pad stack (plane and
        signal). Also, you must enable pads, vias, and drill symbols.
        After you have set up your output files list in the dialog, click Close and return to the Gerber File
        Out dialog, which will list the files that you set up for output.

      Apertures Assignments
        To assign/describe apertures automatically or manually, click the Apertures button in the File
        Gerber Out dialog to open the following Aperture Assignments dialog.




256                                                                                  P-CAD PCB User’s Guide
File Export Gerber                                                                  Chapter 12: File Commands




        The list of this dialog displays the items of the loaded design file and any aperture assignments that
        may exist for those items. You can click a line and the item's characteristics will be listed to the right
        of the list. If an aperture is assigned to the item, the aperture characteristics are listed there as well.
        To manually describe and assign an aperture (or change an existing assignment), double-click a
        line, or select a line and click Assign, to open the Describe/Assign Apertures dialog.
        Click Unassign to delete the aperture assignment for the item that is selected in the Assignment
        list.
        Click Unassign All to clear all aperture assignments. This allows you to describe and assign
        apertures using the Auto Assign feature.

    Auto (Automatic Describe/Assign)
        To automatically assign apertures, set the appropriate options and click Auto. PCB automatically
        assigns all apertures that have not been assigned manually.
        •   You can select the Pad/Via holes check box to have PCB create apertures with holes, but this is
            generally not recommended for two reasons:
        •   Drilling holes through the board could break drill bits if the flashed pad/via holes don't line up
            through the board exactly.
        •   Non-hole apertures are usually less numerous; a 50 x 50 round with no hole can be used for a
            50 x 50 on the Top layer and also for a 40 x 40 via with a 5 mil swell solder mask.
        •   Clear current apertures. This check box is selected by default. If the check box is cleared, the
            current apertures remain. Typically, you want to select this check box to clear apertures when
            you auto-assign.
        •   Draw Rotated or Offset Pads/Vias. Select this check box to assign the draw aperture to pads
            and vias with non-orthogonal rotations, or offset holes (non-orthogonal being rotations other
            than 0 or multiples of 90-degrees).



P-CAD PCB User’s Guide                                                                                         257
Chapter 12: File Commands                                                                  File Export Gerber


       •   Draw Polygon Pad/Via. Select this check box to have the program draw polygon pads. When
           the check box is cleared, polygon pads are assigned flash apertures.
       •   Draw Aperture Size. Enter a value in this box to define the default draw aperture size for any
           unassigned apertures, such as drawn drill symbols and polygons.
       After you have taken these steps, click Auto to automatically describe and assign all unassigned
       apertures to the appropriate items.

       Assign (Manual)
       To manually describe/assign apertures, click Assign to open the Describe/Assign Apertures dialog.
       You can also double-click an item line in the previous dialog to open the dialog, shown in the
       following figure:




       The item name you highlighted on the previous dialog appears in the Assign Aperture to field at the
       top of this dialog. If the item was already assigned an aperture, that aperture name appears
       highlighted in the Apertures list. The item characteristics are listed to the right of the list, and the
       aperture characteristics are listed there as well (if an aperture is assigned).
       In the D Code box, enter a value in the range of 10 through 999 for the draft code used to select the
       aperture. The program automatically prefixes the value with the letter D.
       The Shape combo box displays the aperture shape. The following shapes are supported:




       Elipse   Oval   Polygon     Rounded      Rectangle




258                                                                                 P-CAD PCB User’s Guide
File Export Gerber                                                                 Chapter 12: File Commands


        •    Ellipse is a rounded shape with separately specifiable X and Y dimensions; an ellipse with equal
             X and Y dimensions is a circle (frequently called a round).

             Embedded apertures for flashed elliptical pads are defined as ovals.

        •    Oval is a short line segment with round end caps (half-circles), the radius of which is 1/2 the
             length of the shortest side; if the X and Y dimensions are equal, this too is circular or round.
        •    Polygonal is a free-form polygonal shape defined using the Polygonal Pad Shapes dialog. For
             details about this dialog, see Options Pad Style (page 472).
        •    Rounded Rectangle contains 1/4 circles on the corners of a rectangle. The 1/4 circle radius is 1/4
             the length of the shortest side.
        •    Rectangle shapes are X=width and Y=height.

             If you want a circle pad, you use the ellipse shape with identical height and width (the example
             shown is an oblong ellipse). If you want a square pad, use a rectangle with identical height and
             width

        •    Thermal apertures are typically used for connection to planes, where heat is a factor. These
             apertures are constructed from two or four arc segments separated from each other by spokes.
             The other dimension is the diameter of the outer edge of the arc-segments, the inner
             dimension measures the inside edge, and the gap measures the spoke width, or amount of
             copper connection on a reverse-screened plane layer. Thermals are always circular, and the
             size is a function of the pad/via hole size.
        Thermal Spoke Apertures




               2 spoke        2 spoke 90            4 spoke        4 spoke 45

        Thermal Diameters and Spoke Width




          outer
                              inner         spoke
         diameter
                            diameter        width




P-CAD PCB User’s Guide                                                                                          259
Chapter 12: File Commands                                                                 File Export Gerber


       •    A Target is used for layer registration.




             Target

       •    Mounting Hole is a circle shape with a cross in it used to represent a mounting hole.




           Mounting Hole

       •    Drill Symbol could be any of the drill symbol shapes assigned in the Drill Symbols dialog.
       •    X Dim and Y Dim are the X (horizontal) and Y (vertical) dimensions for the aperture. These
            values may be entered with your choice of units.
       •    The H Dia is the hole diameter for the aperture. This value may be entered with your choice of
            units. The hole diameter cannot exceed the minimum aperture dimension.
       •    Angle is the amount in degrees that an aperture is rotated.
       •    X Off and Y Off are horizontal and vertical offset amounts of the hole in an aperture.




       The Type combo box lists the aperture types (type indicates whether the aperture can be flashed,
       drawn or both). The type is specified using either Flash, Draw, or Flash/Draw. Flash and Draw are
       typically specified for use with mechanical or vector photoplotters, because different holders must
       be used for the two types of apertures. Flash/Draw is used with laser photoplotters, which do not
       have this limitation.
       The Comment box allows you to enter a comment of up to 32 characters. This is especially helpful
       for further describing thermal reliefs and drill symbols.

       Available Procedures
       There are basically four procedures available in this dialog:



260                                                                                P-CAD PCB User’s Guide
File Export Gerber                                                             Chapter 12: File Commands


        •   To create a new aperture, enter information in the D Code, Shape, and other fields. Then, click
            Add. The Shape and Type combo boxes allow you to select the shape and type of the aperture.
            For polygonal pad shapes, X Dim and Y Dim options are unavailable and the Polygonal Pad
            Shapes dialog appears when you click the Add or Modify button. See Defining Polygonal Pad
            Shapes (page 477) for more information.
        •   To modify an existing aperture, change the aperture descriptions as appropriate. However,
            keeping the same name (D Code). When finished, click Modify. The assignment remains the
            same (item to aperture), but the characteristics of the aperture have been changed.
            For polygonal pad shapes, X Dim and Y Dim options are unavailable and the Polygonal Pad
            Shapes dialog appears when you click Modify.

            You can use the Polygonal Pad Shapes dialog to browse through the list of polygon apertures
            to see what they look like.

        •   To create a new aperture based on existing one, change the name (D Code) of the aperture
            and change the aperture descriptions as appropriate. Then, click Add.
        •   To delete an aperture assignment/description, click Delete.
        Click Close to save your changes. You return to the Aperture Assignments dialog, which lists your
        assignments. The currently selected aperture is used as the assignment for the item shown in the
        dialog.

    Setting Drill Symbols
        From the File Gerber Out dialog, click Drill Symbols to open the Drill Symbol Assignments dialog.
        From this dialog you can assign drill symbols either manually or automatically.




P-CAD PCB User’s Guide                                                                                  261
Chapter 12: File Commands                                                                     File Export Gerber


        Automatic Assign
        To automatically assign drill symbols, click Automatic Assign in the Drill Symbol Assignments
        dialog. PCB automatically clears (unassigns) all existing assignments and then automatically assigns
        all of them.
        The list of this dialog displays the hole diameters of the loaded design file, plating information, and
        any drill symbols that may exist for those hole diameters, allowing you to view which items are
        assigned and what those assignments are.
        1.   Click Unassign All to clear all existing drill symbol assignments.
        2.   Click Automatic Assign to automatically assign a drill symbol to each hole diameter in the
             design.

        Manual Assign
        To manually assign drill symbols:
        1.   Click Unassign All to clear any drill symbol assignments.
        2.   Click a hole diameter in the list to highlight it.
        3.   Click the drill symbol you want to assign to the hole diameter. The drill symbols are listed in
             the Drill Symbols combo box/list on the right of the dialog. The Assign and Unassign buttons
             become available.
        4.   Click Assign. The drill symbol will appear next to the hole diameter it is assigned to in the list.
        You can manually unassign drill symbols in the same manner.

      Gerber Format
        To gain access to the Gerber options, click Gerber Format in the File Gerber Out dialog. The
        following Gerber Format dialog appears:




        Select Inches or Millimeters from the Output Units frame.



262                                                                                    P-CAD PCB User’s Guide
File Export Gerber                                                               Chapter 12: File Commands


        Select one of the following options in the Numeric Format frame, on the basis of the required
        resolution.
        •   The format 4.4 means that there are four digits to the left of the decimal point and four digits to
            the right.
        •   The format 5.3 means that there are five digits to the left of the decimal point and three digits
            to the right.
        •   The default Gerber output format is RS-274-D. To output this format, clear the Include Aperture
            Definitions check box.
        The G54 With Apertures determines whether or not to send a G54 tool-select code with each
        command to change apertures.
        The Include Aperture Definitions check box determines whether definitions and assignments
        macros are to be included in the output. These embedded apertures use
        RS-274-X Gerber format.
        Click Close to exit the dialog, and the format you specified will be applied when the output is
        generated.

    Compress Output Files
        You may elect to produce files in a compressed format by selecting the Compressed (.ZIP) or Self-
        Extracting (.EXE) check boxes in the File Gerber Out dialog.
        Both (.zip) and (.exe) files will compress the selected output files into one smaller file. The
        (.zip) option produces a smaller file than the (.exe) option but requires an Unzip.exe program
        to decompress the file when you need to access it. The compression done in the self-extracting
        (.exe) option outputs a larger file than is output by the (.zip) option because its uncompress
        function is included in the compress program.
        If the process is canceled prior to execution, the output files are not compressed. If a compressed
        image exists, you must confirm that the file is to be overwritten. Compressed Gerber output files
        are identified by the .exe or .zip file name extensions added to the base name of the design file.
        For example, MyboardGbr.zip.

    Generate Output Files
        After you have set up the output files, aperture assignments, drill symbols, Gerber format, and
        optionally selected a compression format, you can generate the output files by selecting them from
        the Output Files list and clicking Generate Output Files in the File Gerber Out dialog.




P-CAD PCB User’s Guide                                                                                      263
Chapter 12: File Commands                                                               File Export N/C Drill




       A progress indicatory displays the name of the file being converted. When finished, the log file is
       displayed if the View error file upon completion box was selected in the Setup Output Files dialog.

       Text objects in TrueType font mode causes the Gerber output process to fail. An error is written to
       the Gerber log file. Change the display type of all text styles in the design to stroke font mode and
       generate the Gerber file again


File Export N/C Drill
       Choose File » Export » N/C Drill to output an N/C Drill file for your design in Excellon format. You
       can cancel this command before the dialog appears (while the program is searching the database).
       Choose File » Export » N/C Drill to open the following dialog.




264                                                                                P-CAD PCB User’s Guide
File Export N/C Drill                                                               Chapter 12: File Commands




        The File N/C Drill dialog allows you to output individual or multiple files in compressed, non-
        compressed or self-extracting executable formats. Before you generate output, you may need to
        establish N/C Drill settings in some of the multiple dialogs available from the File N/C Drill dialog,
        as shown in the following figure.


                                    File N/C Drill

                                            (generate output)



         Setup Output Files             Tools              N/C Drill Format


                                           (unassign)
                                           (auto assign)


                                       Assign


                              (manual describe/assign tools)

        When you have established all of the options for output files, tool assignments, and other drill
        settings, the resulting output files will be listed in the Output Files list. You can individually select
        the filenames to enable or disable a file for output. Set All selects all of the files for output (you can
        then deselect individually). Clear All cancels the selection of all files (you can then select files




P-CAD PCB User’s Guide                                                                                         265
Chapter 12: File Commands                                                                     File Export N/C Drill


         individually). Then, click Generate Output Files to generate drill files according to what you have
         specified.

      Setup Output Files
         When you click Setup Output Files in the File N/C Drill dialog, the following dialog appears.




         The filenames for the output files you set up here are determined by the individual file name
         extensions you give them (e.g., filename.nc1, filename.nc2). Most of the time only one file is
         used for N/C Drill, so that you have the design filename as the root name, and the extension as
         .ncd. This is to differentiate it from the regular design file and Gerber files in the same folder
         (.pcb, .top, .bot, etc.)
         The Layers list fills with defined signal layers; no non-signal layers appear.
         When producing an output file for a specific hole range, you need to select all the layers on which
         a pad and via’s hole has been defined. In this way it is possible to generate files for blind and
         buried vias. If your board contains only through-hole pads/vias (not blind or buried vias), then only
         one file is necessary, and it should contain all of the signal and plane layers.
         The Layer Sets box is used to designate specific, predefined layer sets to output. To select a layer
         set, select a layer set from the list and click Apply Layer Set.
         You can perform four basic procedures for output files from within this dialog:
         •   Create an output file. Specify an extension (e.g., nc1) and the X,Y offset settings. Choose the
             hole style to be output. Select layers to be included or use the Set All or Clear All button to
             select all or cancel the selection of all layers, respectively. For example, if you set all layers, you
             can then cancel the selection of one or two layers that you want to exclude. Click Add.
         •   Modify an existing output file. Select a filename from the list. Keep the same file name
             extension, but change the settings accordingly, including X, Y offset, and layers and hole styles
             to be included. Click Modify.



266                                                                                       P-CAD PCB User’s Guide
File Export N/C Drill                                                               Chapter 12: File Commands


        •    Create a new output file from an existing one. Select (highlight) a filename from the list.
             Change the extension of the file, and either change settings and included layers, or leave them
             alone, as appropriate. Select the desired hole style to be output. Click Add.
        •    Delete an output file from the list. Select (highlight) a filename from the list. Click Delete.
        Specify the destination of your output files by specifying the path in the Output Path box.
        You can also select or clear the View error file upon completion check box.
        Click Close to save your output files settings and return to the File N/C Drill dialog.

    Tools Assignments
        To assign N/C Drill tools, click Tools in the File N/C Drill dialog. The following Tool Assignments
        dialog appears.




        In this dialog you can unassign tools, and then either automatically or manually describe/assign
        what remains.
        To manually describe/assign tools, click a line to select it, then click Assign to open the
        Describe/Assign Tools dialog. Or you can double-click on a hole/tool line to open the dialog.
        To individually unassign a tool, select a tool assignment in the list to highlight it, then click
        Unassign. To unassign all tools, click Unassign All.
        Click Auto to automatically describe/assign all remaining unassigned tools. The Auto button always
        assigns unique drill tools to holes that have equivalent size, but differing plating. Select the Clear
        current tools check box and the tools will automatically clear when you click Auto.
        Click Close when your descriptions and assignments are set.




P-CAD PCB User’s Guide                                                                                         267
Chapter 12: File Commands                                                                     File Export N/C Drill


       Assign (Manual)
       Click Assign to open the following dialog, where you can manually describe/assign tools.




       The hole name of the hole or tool you highlighted on the previous dialog appears at the top of this
       dialog in the Assign Tool to field.
       All tools appear in the list; if the hole already has a tool assigned to it, then that tool is selected in
       the Tools list, and the tool's Tool code and Tool Diameter and Hole Plated and Hole Diameter
       values appear in the appropriate frames. If the hole has no tool assigned (no tool is highlighted)
       then the Tool frame boxes are blank. The non-editable Hole frame always displays the Hole
       Diameter, Yes if the hole is Plated or No if non-plated.
       In the Tool Code box, you can enter a value in the range of 1 through 80 for the tool code used to
       select the drill bit. The program automatically prefixes the value with the letter T and fills in the
       leading zero for codes T01 through T09.
       In the Diameter box, you can enter a value to determine the diameter of the drill bit.
       There are four procedures available in this dialog:
       •   Create a new tool assignment by describing/assigning the tool (filling in the T Code and
           Diameter) and clicking Add to assign it to the hole.
       •   Modify an existing tool assignment by changing the Diameter, but keeping the same T Code,
           then clicking Modify. The assignment remains the same (tool to hole), but the diameter of the
           tool has been changed.




268                                                                                     P-CAD PCB User’s Guide
File Export N/C Drill                                                               Chapter 12: File Commands


        •    Use an existing tool to create a new one by changing the name (T Code) of the tool, and then
             using the same diameter and hole assignment. You would then click Add, in effect creating a
             new tool assignment.
        •    Delete a tool assignment/description by clicking Delete. The tool assignment must be
             highlighted to delete it.
        Click Close to save changes. You then return to the Tool Assignments dialog, which lists your
        assignments.

    N/C Drill Format
        To establish N/C Drill format settings, click N/C Drill Format in the File N/C Drill dialog. The
        following N/C Drill Format dialog appears.




        In the Output Units frame, if you select Inches, the units are in inches and the format is
        automatically set to 2.4 (two digits to the left of the decimal point and four digits to the right). If you
        select Millimeters, the format is automatically set to 4.2 (four digits to the left of the decimal point
        and three digits to the right).
        Select the appropriate buttons in the Output Code Type and Zero Suppression frames. Check with
        the fabrication house for the appropriate settings. These options are saved in your Pcb.ini file.

    Compress Output Files
        As with File Gerber Out, you may elect to produce files in a compressed format by selecting the
        Compressed (.ZIP) or Self-Extracting (.EXE) check box in the File N/C Drill dialog.
        Both (.zip) and (.exe) files will compress the selected output files into one smaller file. The
        (.zip) option produces a smaller file than the (.exe) option but requires an Unzip.exe program
        to decompress the file when you need to access it. The compression done with the self-extracting
        (.exe) option outputs a larger file than the (.zip) option because its uncompress function is
        included in the compress program.


P-CAD PCB User’s Guide                                                                                          269
Chapter 12: File Commands                                                                    File Export DXF


       After you have established settings in N/C Drill Format, click Close to save settings and return to the
       File N/C Drill dialog.


File Export DXF
       The File » Export » DXF command is used to create DXF files of your PCB designs. These files can
       then be transferred to AutoCAD and other mechanical CAD packages. The output is compatible
       with AutoCAD® Version 9.0, and above.
       When you choose File » Export » DXF, the following File DXF Out dialog appears:




       To use this dialog, do the following:
       1.   Click DXF Filename. The following File DXF Out dialog appears, so you can select a file or enter
            a file name.




270                                                                                P-CAD PCB User’s Guide
File Export DXF                                                                     Chapter 12: File Commands




        2.   Type the name of the DXF file to you want to save in the Filename box.
        3.   Click Save. You return to the File DXF Out dialog.
        4.   Select the PCB layers you wish to output using the Layers list. Each PCB layer is output to a
             separate DXF layer. The Set All and Clear All buttons let you select and clear all the board layers
             at one time.

             You can use the Layer Sets box to designate specific, predefined layer sets to output by
             selecting a layer set from the list and clicking Apply Layer Set.

        5.   If you select Output Drill Symbols, you need to specify a size for the resulting drill symbols.
             The default value is 80 mils (or the equivalent if you're in metric mode). To use a different
             value, type it in the Size box. If you specify zero, the Drill Drawing layer is output without drill
             symbols.
        6.   Select your desired hole output options: Plated Holes, Non-plated Holes or All Holes.
             To make or examine drill symbol assignment, click Setup. The Drill Symbol Assignments dialog
             appears. For details, see File Export Gerber (page 253).
        7.   Choose the desired output unit, Inch, Cm or Mm, by clicking the appropriate option button in
             the DXF Units area.
        8.   If you want to output only certain objects, select those objects in the design and select the
             Selected Objects check box.
        9.   Select the Draft check box to output in draft mode.
             DXF polylines are normally used for all lines, arcs, and pad and via shapes. A room consists of a
             polyline and two vertices. Solids are normally used for polygons. Polylines are filled lines with
             thickness. Select the Draft check box to output DXF arcs, lines, and circles instead of polylines,
             and polygon outlines instead of DXF solids. Draft mode produces smaller files that process
             faster, but the drawings are not technically accurate since the lines have no width and areas are
             not filled.
        10. Check the Component Height box to output the component height. For more information, see
            Component Height Check Box (page 272).
        11. Suppress the output of mounting hole copper with a check next to the No Mt Hole Cu box.



P-CAD PCB User’s Guide                                                                                         271
Chapter 12: File Commands                                                                     File Export DXF


        12. Check the Include Title Sheet box to output title sheets.
        13. Check the Include True Type Fonts box to output true type text. Clearing this box allows you to
            export a DXF file that is compatible with Revision 9 DXF. True Type Fonts are compatible only
            with Revision 14 DXF when the Include True Type Fonts option is enabled, PCB outputs text as
            MTEXT; otherwise it is output as TEXT.
        14. Click OK to generate the DXF output file. While the file is generating, the Status Line indicates
            progress by displaying the current layer being output. While the file is being generated, you
            can press ESC or right-click to cancel the operation.

      Component Height Check Box
        When you select the Component Height check box, PCB automatically detects valid
        ComponentHeight attributes assigned to components, and writes corresponding component
        height geometry to the DXF.
        PCB uses the geometric primitives in a component’s pattern to produce component geometry in a
        DXF (circles, lines, arcs, and polygons). Pads, vias, text, and signal layer items are ignored.
        Component height geometry is created in the DXF on layers that are consistent with the source
        geometry.
        In the DXF, the height of an individual component extends upward or downward from the design,
        depending on whether the component resides on the top or bottom layer.
        When the DXF is read into a 3-D CAD system (such as AutoCAD), the specified heights are
        represented as geometric elements of the proper PCB components when viewed in 3-D mode.

      DXF Output Considerations
        •   Layers. Items are output to individual layers, which keep their PCB names. DXF substitutes the
            underscore for unsupported characters such as spaces to maintain compatibility with AutoCAD
            naming conventions. If AutoCAD reserved keywords are used in the PCB layer name, and you
            import this file back to PCB, a syntax error occurs causing the file load to abort.
        •   Blocks. DXF blocks are used to combine individual entities into a common unit, to be treated
            as a whole by the CAD package, analogous to a part or component. Blocks are used, where
            possible, to make CAD processing easier, and to reduce the size of the DXF file. For example, a
            component block has the name of the reference designator; exploding a component block
            produces text (for attributes) and a pattern block. This in turn can be exploded to produce
            some single items and padstyle blocks. These can be exploded to produce padshape blocks;
            which can be exploded to produce solids and polylines.
        •   Polygons. PCB polygons are also represented as blocks containing a collection of three- or
            four-sided solids. In this way they can be processed as a unit.
        •   Copper Pours. PCB copper pours are represented as blocks containing a collection of lines that
            outline and fill the copper pour. In this way they can be treated as a unit.
        •   Lines. When not in Draft mode, lines consist of a straight polyline and two round endcaps.
            Note that due to limitations in how blocks are scaled in DXF, lines are not blocks; the endcaps




272                                                                                 P-CAD PCB User’s Guide
File Export PDIF                                                                  Chapter 12: File Commands


             and polylines are separate from one another. In Draft mode, lines become DXF LINEs with no
             endcaps.
        •    Arcs. When not in Draft mode, arcs consist of a curved polyline and two round endcaps. Note
             that due to limitations in how blocks are scaled in DXF, arcs are not blocks; the endcaps and
             polylines are separate from one another. In Draft mode, arcs become DXF ARCs with no
             endcaps.
        •    Text. True Type font text styles are created and included in the DXF file. P-CAD stroke font text
             strings are converted into DXF text strings of the same height, rotation, mirroring, and
             justification; the AutoCAD® STANDARD font is used. Note that due to the difference in fonts,
             translated text strings may be of different total width than in PCB.
        •    Pads and Vias. These are blocks of pad shapes, which are in turn blocks of SOLIDs and
             POLYLINEs. For example, a rounded rectangle is a block consisting of two SOLIDs forming a
             thick “plus” and four circular POLYLINEs in the corners. A pad is a block containing a stack of
             what could be different shapes on different layers. When not in Draft mode, these shapes are
             filled; in Draft mode, only the outlines are represented with lines, arcs, and circles. Pads and
             vias are not output with holes.
        •    Selected Objects. When specific objects have been selected for inclusion in the DXF file, they
             are exported regardless of the layer on which they reside. A single layer object can be exported
             even if its layer is not selected. A selected multi-layer object includes all of its pieces, even
             when some of the pieces reside on unselected layers. Selecting objects overrides layer
             selection.
        •    Title Sheets. Title sheets can be included in the DXF output file by enabling the Include Title
             Sheet option. Block output of title sheets are named TITLE_SHEET_xx, where xx is the layer
             number on which the title sheet resides. The title blocks consist of lines, text and other objects
             that form the title sheet and title block.


File Export PDIF
        Choose File » Export » PDIF to create PDIF files of your PCB designs.

    PDIF File Export
        To export a PDIF file, do the following:
        1.   Choose File » Export » PDIF. The PDIF File Name dialog appears:
        2.   Type the filename you want to use in the Filename box.

             If the current folder is not appropriate, then either type the folder name in front of the
             document name, or select the correct folder.

        3.   Make sure the correct file name extension is selected in the Save File as Type list.
        4.   Click Save to save the file as you have specified.




P-CAD PCB User’s Guide                                                                                      273
Chapter 12: File Commands                                                                    File Export IDF



File Export IDF
       The Intermediate Data Format (IDF) format is used to exchange design data between electrical and
       mechanical CAD/CAE systems.
       The IDF Export feature allows you to transfer design data from the P-CAD PCB Editor to a
       mechanical designer, who can then perform solid model form-fit analysis of the assembled PCB in
       the product enclosure. You can export to an IDF file by selecting the File » Export » IDF command.
       The IDF file is created in the IDF version 3 format.




       When you select File » Export » IDF the File Export IDF dialog appears. Enable those options that
       you wish to include in the IDF file.
       When you click OK to complete the export process 2 files created, a BRD file, which details all the
       board information that you chose to export, and a PRO file, which is a library file detailing the
       components.

       Board Outline
       Select this option to export board outline details contained in the PCB design. The board outline is
       the largest closed shape on the board layer, made up of lines and arcs. All other lines and arcs that
       do not constitute this polygon are exported. If there is no closed shape on the board layer a



274                                                                               P-CAD PCB User’s Guide
File Export IDF                                                                 Chapter 12: File Commands


        bounding rectangle of all the primitives is used. Design cutout information is exported as line and
        arc segments.

        Drilled Holes
        Export the location and diameter of drill holes, according to the option selected in the Drilled
        Holes frame. For each hole exported, the entry in the IDF file contains information for diameter,
        position, plating style, hole type and owner (MCAD, ECAD or UNOWNED). Component pads and
        routing vias are set to ECAD, free pads are set to UNOWNED.
        •   All Holes: component thru hole pads, free thru hole pads, and vias are exported.
        •   Mounting Holes: free thru hole pads with their pad shape set to mounting hole are exported.
        •   Minimum Hole Diameter: component thru hole pads, free thru hole pads, and vias with a hole
            diameter greater than the amount specified are included in the IDF file.

        Placement
        When this option is selected, component information contained in the PCB design is exported.
        Information related to component RefDes, position, side, rotation and whether it is fixed or not, is
        exported into the Placement area of the .brd file. For each component that is exported, a library
        component is also created in the IDF Library File (.pro). Within this file, each component is defined
        by its outline information and also its height, which is taken from the ComponentHeight attribute.
        The set of components that are exported is determined by the option selected in the Components
        frame.
        •   All Components: all components are included in the IDF export. Components boundaries are
            defined either by the outline defined on the layer specified by the PackageOutlineLayer
            attribute, or if this can not be detected, by the outline on the silkscreen layer.
        •   Components with IDF_COMP Attribute: only those components that include a user-defined
            attribute IDF_COMP are exported.
        TO determine the component shape, each component is checked to see if it has a
        PackageOutlineLayer attribute, if it does the shape defined on this layer is used. If a component
        does not include a PackageOutlineLayer attribute then the design-level attributes are checked for a
        PackageOutlineLayer attribute, if found the shape on this layer is used. If no PackageOutlineLayer
        attribute can be found the component silkscreen boundary is used.

        Placement Group Area and Placement Outline
        The Placement Group Area represents the name, position and dimensions of a room. When this
        option is selected, one Placement Group Area is created for each of the existing rooms in the PCB
        design, in terms of name, specified position and dimensions.
        The Placement Outline defines the maximum allowed height of the room, whose name, position
        and dimensions are defined by the Placement Group Area.




P-CAD PCB User’s Guide                                                                                     275
Chapter 12: File Commands                                                         File Export RFQ Format


       Routing Keepout
       When this option is selected, any polygon keepouts in the PCB design are exported as routing
       keepouts in the IDF file.

       Routing Outline
       The IDF routing keepout is only created if there is a BoardEdgeClearance attribute defined for the
       PCB. This keepout is calculated from the board outline, contracted by the amount defined in the
       BoardEdgeClearance attribute.


File Export RFQ Format
       The WebQuote, or AutoRFQ feature allows you to request a quotation to fabricate or assemble
       your board from within the P-CAD PCB Editor. This feature extracts relevant PCB data, passes it to
       the Request For Quotation application (AutoRFQ), which then interfaces to the WebQuote web site
       (http://www.webquote.com) to configure and request for a quotation on the PCB.
       The WebQuote site is a portal to PCB fabricators all over the world. From this site you can select
       which manufacturers you wish to participate in the quoting process, and also choose if you wish to
       use an open bidding process, where each fabricator is notified of the other fabricators' quotes
       (allowing them to requote), or a closed bidding process, where they are not notified.
       The Request For Quotation feature can either be run by selecting the Utils » P-CAD AutoRFQ
       command, which creates the RFQ file and then loads it into the AutoRFQ program, or by selecting
       the File » Export » RFQ Format command to create the RFQ file. This file can then be opened
       manually in the AutoRFQ program.
       Once the RFQ file is loaded in the AutoRFQ program it is displayed as an RFQ for PCB Fabrication
       window. This file details the necessary design specifications that have been extracted from your
       PCB.
       From the AutoRFQ application you can then set up a new request for quotation by clicking the New
       RFQ button that appears at the top of the RFQ for PCB Fabrication window. The first time you
       attempt to do this you will be prompted to create an account, once this is done the job can be
       configured, ready for a quotation.
       When you click the New RFQ button the data in the RFQ file is passed to the PCB MarketPlace web
       site, and another window appears. Work your way down this window, clicking the Modify or Enter
       buttons and completing the information required on each page that appears. Once your RFQ has
       been successfully submitted you will receive a confirmation email, then when the quotes from the
       manufacturers are received you will be emailed these as well.


File Exit
       Choose File » Exit to quit the P-CAD PCB program.
       If any open designs have been modified since the last save, you are prompted whether you want to
       save the changes to each design.




276                                                                              P-CAD PCB User’s Guide
File Exit                                                                          Chapter 12: File Commands


            The program writes information to the Pcb.ini file when you choose Exit. This information, which
            will apply to subsequent PCB sessions, consists of parameters and settings such as workspace size,
            units and values set in Options Configure, report file settings from File » Reports and Utils » DRC,
            etc.




P-CAD PCB User’s Guide                                                                                       277
                                                                                     CHAPTER        13


                                                                   Edit Commands

Using the Edit Commands
       Use the commands in the Edit menu to modify objects that have been placed in a design. Shortcuts
       to a number of the Edit commands appear on the command toolbar as shown in the table directly
       below the command toolbar.




       Click this button         To do this:        Click this button         To do this:
                            Edit Select                                 Edit Undo

                            Edit Cut                                    Edit Redo


                            Edit Copy                                   Edit Measure

                            Edit Paste


       Most of the actions associated with the Edit commands can be undone by choosing Edit » Undo.
       Other actions can be unwound by pressing the BACKSPACE key when the action is finished. For
       details, see Edit Undo (page 280).
       Many Edit commands are available only when an object is selected. To learn how to select objects,
       see Edit Select (page 356).
       Two of the Edit commands, Edit » Paste and Edit » Fix, contain additional options:




P-CAD PCB User’s Guide                                                                                279
Chapter 13: Edit Commands                                                                         Edit Undo


       The Edit » Paste commands give you the ability to paste information from the Clipboard or file,
       include circuitry information, and control the way the objects are renamed when pasted. See Edit
       Paste (page 284) for more information.
       The Edit » Fix commands give you the ability to Fix or Unfix one or more selected objects. All fixed
       objects can be unfixed using the Unfix All command. See Edit Fix (page 342) for more information.


Edit Undo
       Choose Edit » Undo to undo the last completed action in the active design. As a shortcut for
       choosing this command, click the Undo button on the toolbar, press the U key, or press CTRL+Z.
       With this command, you can undo up to 10 of your last actions by default. To increase or decrease
       this number, you modify your Pcb.ini file. In this file, the keyword “UndoLimit” controls the
       number of stored activities for both Edit Undo and Edit Redo.

       IMPORTANT: Although you can set the undo limit to any number, keep in mind that each stored,
       undoable action requires memory. Setting a large UndoLimit may use up your computer’s available
       memory, which can slow down your system’s performance and cause unpredictable results.

       You can undo Place commands, Edit » Delete, Edit » Copy Matrix, and component modifications
       such as move, rotate, and flip (actions performed in select mode). If an action cannot be undone or
       there is no action to undo, the Edit » Undo command is shaded in the menu.
       You can only undo a finished Place command. For example, if you are placing an object that
       requires more than one click in the workspace (such as drawing lines, polygons, arcs), you must
       finish the segment or arc before you can undo it. To unwind line segments (delete the previous
       segment) before you finish the series of segments, press the BACKSPACE key.
       The list of undoable actions is deleted when you save the design. The Undo list is also cleared
       when you use any of the commands in the following list:
       •   File Close
       •   File Save
       •   File Save As
       •   Delete Textstyle
       •   Utils Renumber
       •   File DBX In
       •   File DTP (Close or ESC)
       •   File Design Info (Close or ESC)
       •   Utils Force Update
       •   Utils Record ECOs




280                                                                               P-CAD PCB User’s Guide
Edit Redo                                                                     Chapter 13: Edit Commands


       •    Import ECOs
       •    Delete Layer
       •    Delete Padstyle
       •    Delete Viastyle
       •    Place Autoplacement (can lead to file save)
       •    Route Autorouters (can lead to file save)
       •    Utils DRC
       •    Utils Reconnect Nets
       •    Utils Load Netlist
       •    Utils Trace CleanUp
       •    Utils Optimize Nets
       •    Edit Nets PadStyle Swap
       •    Modify TextStyle in use
       •    Connection tool (merging one or two plane nets with a connection line)
       •    Edit Nets (rename a net)
       •    Modify PadStyle in use
       •    Modify ViaStyle in use


Edit Redo
       Choose Edit » Redo to re-apply an action that has been undone. As a shortcut for choosing this
       command, click the Redo button on the toolbar, press SHIFT+U, or press CTRL+Y.
       Each modification made to a design results in a copy of the design being placed in the Undo list, as
       described in Edit Undo (page 280).
       If you have stepped backwards in the list using the Edit » Undo command, and find that you want to
       move forward to a later version of the modification, choose Edit » Redo.
       With this command, you can redo multiple actions. The keyword “UndoLimit” in the Pcb.ini file
       controls both the Edit » Undo and Edit » Redo commands.


Edit Cut
       Choose Edit » Cut to remove objects from your design and move them to the Clipboard. When
       objects are moved to the Clipboard, you can paste them into another design, to another location
       within the current design, or into another program.



P-CAD PCB User’s Guide                                                                                   281
Chapter 13: Edit Commands                                                                                Edit Cut


         To cut objects from a design and move them to the Clipboard, choose Edit » Select or press S to
         enable the select tool. Then, select at least one object. If you do not enable the select tool, the Edit
         » Cut menu command is shaded and the CTRL+X shortcut key is inoperative.
         Once you move items to the Clipboard, you can save them to a clipboard file (.clp). To do this,
         open the Clipboard Viewer and choose File » Save to create a clipboard file. To paste data from the
         clipboard file, you load the clipboard file into the Clipboard, then paste from the Clipboard into
         your design file.
         You can cut multiple objects by using multiple select and block select operations. See Edit Select
         (page 356) for information.

      Cutting Objects from Nets
         When you choose Edit » Cut to remove objects from nets, you can get a variety of results,
         depending on what you cut and the makeup of the net you remove it from. The function of smart
         nets is to maintain certain connections when objects such as copper connections, unrouted
         connections, and net nodes are removed. In general, the following can occur:
         •   If you remove free copper (no connections), then the copper disappears and no connection
             compensation occurs.
         •   If you remove a node (such as node a in the following connections figure), then the remaining
             nodes are still part of the net, and there will be compensation to maintain connections
             between the remaining nodes.
         •   If you remove a component, you are removing nodes from all nets to which the component's
             pads were connected. The connectivity feature of PCB reconnects the remaining nodes in each
             net in the most efficient way.
         •   If two nets become merged, and one net is a plane net, then the plane layer net takes
             precedence and the merged net is a plane net.
         •   If you remove a connection from the middle of a net, the net is split. One portion retains the
             net name and the other is given a new net name. For example, in the following figure, the net
             has three connections: ab, bc, and cd. If you remove connection bc, you cut the net into two
             nets: ab and cd.


                a                        b




                                         c                     d


         •   If you remove a connection that isolates a pad from the rest of the net, you end up with a
             disconnected node. For example, in the previous figure, if you remove connection cd, the
             node d becomes isolated from the net.




282                                                                                    P-CAD PCB User’s Guide
Edit Copy                                                                        Chapter 13: Edit Commands


       •    If you remove a copper segment that is part of a net, that segment is not removed, but instead
            becomes a connection (in effect unrouting the net. In this case, the net remains intact,
            although changed).


Edit Copy
       Choose Edit » Copy to copy objects to the Clipboard. From there you can paste them to another
       design, to another location within the same design, or to another program.
       To copy objects in a design and move them to the Clipboard, choose Edit » Select or press S to
       enable the select tool. Then, select at least one object. If you do not enable the select tool, the Edit
       » Cut menu command is shaded and the CTRL+X shortcut key is inoperative.

       Instead of choosing Edit » Copy and Edit » Paste, you can press CTRL+Left Mouse button (a drag-
       and-drop operation) to copy and paste objects within the same design. The CTRL+Left mouse
       action does not copy items to the Clipboard.

       Once items are in the Clipboard, you can either immediately paste them to another design
       location, or save them to a clipboard file (.clp). Choose File » Save in the Clipboard program to
       create a clipboard file. After you load a clipboard file into the Clipboard, you can paste a clipboard
       file into your design file.
       See Edit Paste (page 284) for the rules and parameters of pasting objects.


Edit Copy to File
       Choose Edit » Copy to File to copy selected objects to a block file (.blk) or P-CAD picture file
       (.emf). You can paste the objects in a block file into a design at a later time by choosing Edit » Paste
       From File or Edit » Paste Circuit From File.
       A block file is design intelligent in that it includes layer information, design rules, etc. When pasted
       back into a design using the Edit » Paste From File command, objects from the block file become an
       integrated part of the design. When a bock file is placed into PCB using the DocTool » Place Detail
       command, it loses its design intelligence but becomes an accurately scaled representation of the
       selected design objects.
       The P-CAD picture file includes no design intelligence. A picture is a snapshot of selected objects,
       which can be pasted into a PCB design as a dumb object with one of the following commands: Edit
       » Paste From File, DocTool » Place Picture or DocTool » Place Detail. When a P-CAD picture is
       created the Mirror on Copy setting is honored.
       To choose this command, you must be in select mode (choose Edit » Select or press S) and you
       must select at least one item; otherwise the command is shaded and not available. You can copy
       multiple objects by using multiple select and block select operations. for more information, see
       Edit Select (page 356).
       When you choose Edit » Copy to File, the following dialog appears:




P-CAD PCB User’s Guide                                                                                       283
Chapter 13: Edit Commands                                                                            Edit Paste




        The Save in list displays the current folder; the list below the box displays any files in that folder
        with the file name extension specified in the Save as Type list. The Filename box lets you enter or
        select a file name and the Save as type box allows you to select one of the following types of files:
        Block File (.blk) or P-CAD Picture File (.emf). Specify a location and name of the block file to
        which you wish to copy the selection.
        You may choose to save storage space by selecting the Compress Binary Designs check box in the
        General tab of the Options Configure dialog.


Edit Paste
        Choose Edit » Paste to paste objects/items into your design file from the Clipboard or a block file.
        You must be in select mode to choose this command.
        When you choose Edit » Paste, a submenu appears, from which you can choose a paste method.
        The methods range from the simple options such as Paste From Clipboard, Paste From File and
        Paste To Layer, in which objects are pasted without net information, to the more intelligent Paste
        Circuit and Paste Circuit From File commands which give you the ability to control changes to
        component and net names and retain net information.

        If any of the design limits are exceeded, the object/item cannot be pasted in your design using P-
        CAD PCB (6/400).

      Paste Behavior
        After items have been copied and you click in the workspace, the ghosted outline of the copied
        item(s) appears until you release the mouse button to commit them to the desired location. Before
        releasing the left mouse button, you can drag the items to a more precise location in the
        workspace.
        There must be sufficient space to accommodate the objects being pasted. Error messages inform
        you if the target space is not large enough or if you are attempting to paste too close to or outside
        of the edge of the workspace.
        To cancel a paste operation, right-click, press ESC, or choose another tool.




284                                                                                    P-CAD PCB User’s Guide
Edit Paste                                                                         Chapter 13: Edit Commands


        If an item is layer-specific, then it will be pasted onto the same layer that it was cut/copied from,
        regardless of the current layer setting. If the target layer doesn't exist, then the item(s) will not be
        pasted. To paste to a different layer, choose Edit » Paste to Layer.
        Components of the same type can be placed only if they have the same pin mapping (i.e.), pin
        number to pin designator to pad number. If you place the same component from different libraries,
        the first instance of the component type establishes the standard pin mapping for that type of
        component. Any components of that type placed subsequently have to conform to the pin logic of
        the first or they will be unplaceable.
        If you have cut or copied a room, and subsequently paste it to a new design where there is a room
        with the same name, the pasted room is given a new default name (i.e., Room1, Room2, etc.).

        If while pasting a component, components of the same name but from a different library already
        exist in the destination design, the component may not be able to be pasted due to the probable
        conflict in pin assignments. This conflict could also occur when components from a Tango Series II
        board are mixed with components of the same name in a P-CAD library. In effect, the first instance
        of the component name establishes the standard.

        When you paste vias, pads, and text (usually in a component) from a different design that contains
        styles that have the same names but different data than those in the current design, the incoming
        style name has a bracketed number appended to it to indicate the style name conflict. The
        following figure shows a duplicated text style.




        The new, bracketed style names will be added to the list of available styles in the current design.
        For object style information, see the following sections:
        •    Edit Properties (page 292).
        •    Options Pad Style (page 472).
        •    Options Text Style (page 482).
        When you choose Edit » Paste Circuit and Edit » Paste Circuit From File you acquire additional
        functionality and control. If you are pasting components you have the option to specify how their



P-CAD PCB User’s Guide                                                                                         285
Chapter 13: Edit Commands                                                                              Edit Paste


         names should be changed. When pasting nets you can specify not only how the net names are to
         be changed, but you can also choose to retain the current name by choosing Edit » Paste Circuit.
         With these commands, data can be pasted into your design multiple times without having to invoke
         the command each time you want to paste.

      Paste From Clipboard
         Choose Edit » Paste from Clipboard to paste objects from the Clipboard to your design. You must
         be in select mode to choose this command. The Paste From Clipboard command is shaded and
         unavailable when no data has been copied to the Clipboard.
         When you choose Edit » Paste From Clipboard, PCB places the copied information in the new
         location in the design, renames the design objects to the next sequentially available name and
         retains the component attributes and their values.

      Paste from File
         Choose Edit » Paste from File to paste items from a block file or a P-CAD Picture file into the
         current design. These files must have been created using Edit » Copy to File. When selected, the
         following dialog appears:




         The Look In list shows the current folder. Directly underneath, a list of files in that folder appear.
         The Files of type list shows the active file format. The Filename text box lets you select or enter a
         design file name.
         Select the block file containing the item(s) you wish to paste. Once the file is selected, this
         command works like the Edit » Paste command.

      Paste To Layer
         This command gives you the ability to paste items to a different layer from what they were cut or
         copied from, within the same design or to a different design. This feature includes single, multiple,
         or block selection cuts and copies.
         •   The Edit » Paste To Layer command accepts only Clipboard data in PCB format. Clipboard data
             from other programs cannot be pasted into the PCB workspace.
         •   If you block select items that reside on different layers, e.g., one line on the Top layer and one
             on the Bottom, they will both be pasted onto the current layer.



286                                                                                    P-CAD PCB User’s Guide
Edit Paste                                                                       Chapter 13: Edit Commands


        •    Multi-layer items, such as pads, will remain as multi-layer.
        •    When items are ghosted for pasting, you can press the L key to switch between layers before
             you do the final paste.
        •    You can paste to layer from a clipboard file (.clp) after you load the clipboard file onto the
             Clipboard. This data cannot be loaded or pasted to or from any other Windows utility; it is PCB-
             specific.

    Paste Special
        This command allows you to paste from the clipboard into the design as a P-CAD picture object. A
        P_CAD picture may be cut or copied to the clipboard using the Edit » Cut and Edit » Copy
        commands.
        When you choose the Edit » Paste Special command, the Paste Special dialog opens:




        The P-CAD Picture Format is selected. When you click OK you are returned to the workspace
        where you should click and drag the ghosted object to its desired location, placing it by releasing
        the mouse button.

        A P-CAD picture cannot contain a picture, detail, design view or diagram. If a picture, detail, design
        view or diagram has been copied to the clipboard, the clipboard contents cannot be placed using
        the picture format of the Edit » Paste Special command. Clipboard contents can, however, be
        pasted as a block file using the Edit » Paste from Clipboard command.

    Paste Circuit
        The Edit » Paste Circuit command provides a way to control the naming of components and nets
        being pasted into a design and stipulate net attribute bias. Circuit information pasted with the Paste
        Circuit command includes:
        •    Components
        •    Pads and Vias
        •    Lines, arcs, polygons (including copper tie polygons) and copper pours
        •    Points
        •    Cutouts and keepouts



P-CAD PCB User’s Guide                                                                                      287
Chapter 13: Edit Commands                                                                           Edit Paste


       •    Split Planes
       •    Rooms
       •    Text, attributes and fields
       •    Dimensions
       •    Global net information such as whether a net is attached to a plane, split plane or a
            component’s power pin
       •    Net names and IDs
       When you choose Edit » Paste Circuit, the following dialog appears:




       Reference Designators
       In the Reference Designators frame you can choose how the components are named when pasted.
       You can choose to have PCB to incrementally change the components names, or you can control
       the way components are renamed by adding a qualifier in a specific position in the new name. A
       qualifier is a set of characters that you can add to a reference designator to modify the RefDes.
       To rename the components using a qualifier, do the following:
       1.   Select the Create new refdes using qualifier check box.
       2.   Type up to four characters that you want to add to the name in the Qualifier box.
       3.   Choose the desired position within the RefDes name for the qualifier. Each choice in the
            following list places the qualifier in a different location:
            •   Add before name
            •   Add before numeric suffix
            •   Add to end of name


288                                                                                P-CAD PCB User’s Guide
Edit Paste                                                                       Chapter 13: Edit Commands


        A sample appears in the Example frame so that you can see how the qualifier will appear after the
        change is made.
        If you do not want to designate the way the RefDes names are modified on paste, select the Create
        new refdes using qualifier check box.

        Each time a component is pasted, the RefDes is sequentially incremented alphanumerically to the
        next available RefDes for that component. If you have added a qualifier, the qualifier is
        incremented in the same manner. Then, if the component name still conflicts with an existing
        component name, it will be incremented until it is unique.

        Net Attributes
        When pasting data containing net information, either from the same design or another design, you
        can choose how the net attributes are handled by enabling the desired action from one of the
        following choices:
        •    Merge Favor Circuit: With this option, incoming net attributes take precedence over existing
             net attributes. When the net attributes in the incoming circuit information match those already
             in the design, but the values are different, the design attributes are modified to match those of
             the incoming circuit. All other incoming net attributes are merged with those in the design.
        •    Merge Favor Design: Existing net attributes are retained when you merge net attributes
             favoring the design. When the design and incoming circuit have matching net attributes with
             different values, the design attribute values are retained. Other incoming net attributes are
             merged with those in the design.
        •    Replace Design: This option removes all existing net attributes and replaces them with those
             of the incoming circuit.
        •    Ignore Circuit: Net attributes attached to the incoming circuit are ignored and existing net
             attributes left unchanged.

        Nets
        In the Nets frame you can choose which nets are renamed and how they are named when pasted.
        This process is similar to the way the components are renamed in the Reference Designators frame.
        To rename the nets, do the following:
        1.   Select the Create new net name using qualifier check box.
        2.   Type the characters (no more than four) that you want to add to the name in the Qualifier box.
        3.   Choose the desired position for the qualifier within the net name. Each choice in the following
             list places the qualifier in a different location:
             •   Add before name
             •   Add before numeric suffix
             •   Add to end of name.




P-CAD PCB User’s Guide                                                                                      289
Chapter 13: Edit Commands                                                             Edit Move By RefDes


       A sample displays in the Example area, so that you can see how the addition will appear when the
       change is made.
       If you do not want to designate the way the net names are modified on paste, clear the Create new
       net name using qualifier check box.

       Each time a net is pasted, the net name is sequentially incremented alphanumerically to the next
       available net name. If you have added a qualifier, the qualifier is incremented in the same manner.
       Then, if the net name still conflicts with an existing net name, it will be incremented until it is
       unique.

       Choose which nets to rename using the qualifier and which nets will retain their current names.
       You can designate individual nets to retain the current name by clicking the specific nets in the Net
       Names list. You can also choose to retain all power net names and/or non-system net names by
       enabling the appropriate option in the Maintain Original Net Names frame.
       Nets connected to power pins, planes and split-planes are considered power nets.


Edit Move By RefDes
       Choose Edit » Move By RefDes to move components by reference designator. This opens the
       following Edit Move By RefDes dialog.




       Use this dialog to select the reference designators of the components you’d like to move. The
       following describes this dialog in more detail:
       •   RefDes: This list shows all of the components in your design, except for fixed components. To
           unfix a component, choose Edit » Properties, click the Pattern tab, and clear the Fixed check
           box.
       You can select one or more components from the RefDes list. To select multiple components, hold
       down the CTRL or SHIFT key and click the components of your choice.




290                                                                               P-CAD PCB User’s Guide
Edit Move to Layer                                                                   Chapter 13: Edit Commands


        If you select components in your design before you open this dialog, those components are
        selected in the RefDes list when the dialog appears.
        When you double-click a component in this list, the dialog closes. At this time, you can place the
        component into a new position by clicking a point on your design workspace.
        •    Select RefDes By: Type search criteria in this text box to search the RefDes list for a match. You
             can enter wildcard characters in this field.
        •    Select All: Click this button to select all of the items in the RefDes list.
        •    Clear All: Click this button to cancel the selection of all items in the RefDes list.
        After selecting components from the dialog, click OK to return to your workspace. The Status Line
        shows the Next RefDes to move. To skip to the next RefDes, press N. To move to the previous
        RefDes, press B.


Edit Move to Layer
        Choose Edit » Move to Layer to move selected objects to the active layer. This facility enhances the
        ability to clear out congested areas for routing. In addition, if you have inadvertently placed objects
        on the wrong layer, you can move them easily to the correct layer.

    Moving an Object
        To move one or more objects to a different layer, follow these steps:
        1.   Select the object or objects. For details on selecting objects, see Edit Select (page 356).
        2.   Switch to the layer to which you want to move the objects using the Layers list below the Status
             Line.
        3.   Choose Edit » Move to Layer or press SHIFT+T.
        All of the selected single-layer objects move to the current layer. You return to select mode and the
        objects remain selected.

    Restrictions
        •    If an object has net information, it can move between signal layers only.
        •    Multi-layer objects will not be moved (components, glue dot points, all layer keepouts, pads,
             pick and place points, reference points, or vias). Objects that can be moved are single layer
             objects (arcs, copper pours, cutouts, single layer keepouts, lines, polygons, attributes, fields,
             and text).
        •    If you select multi-layer and single-layer objects simultaneously, the tool will ignore the multi-
             layer objects and only move the single-layer objects.
        •    Single-layer objects on different layers will all be moved to the current layer.




P-CAD PCB User’s Guide                                                                                       291
Chapter 13: Edit Commands                                                                      Edit Properties


       •   If the single-layer objects are of mixed net and non-net types and you are moving them to a
           non- signal layer, a warning message will appear telling you that only the non-net objects will
           be moved. You can cancel this command at this time.
       •   The Edit » Move To Layer command performs auto-insertion of vias with a slight difference
           compared with the Route » Manual command. A via will not be inserted if a line segment is
           already connected to a pad or via. If the existing pad or via is incorrect for maintaining physical
           connectivity, the line segment will not be moved.
       •   When moving copper traces between layers, vias are not added for free copper, only for net
           copper. The net attribute VIASTYLE will be honored as it is in Route Manual.
       •   When multiple objects are moved and the physical connectivity cannot be maintained for
           some of the objects (e.g., if a via cannot be added), a warning message appears prompting you
           to continue or cancel the command. If you press Cancel, the objects moved before the cancel
           will not be moved back. If you press Continue, the object with the error will not be moved and
           the tool will skip to the next object.
       •   Test points can be moved to non-signal layers only. If you attempt to move a test point to a
           signal layer, a message appears to notify you that the object cannot be moved.
       •   If a copper pour is currently poured, it will be unpoured before the move and automatically
           repoured after a move. If the pour is not correct, use the Copper Pour Properties dialog to
           repour the pour. To open this dialog, select the copper pour, right-click and choose Properties
           from the shortcut menu. If the pour is not poured, it will remain unpoured after the move. A
           pour's net connectivity will be maintained.


Edit Properties
       To use this command, you select one or more objects in your design and then choose Edit »
       Properties. When you do, a Properties dialog appears for the selected object(s). Typically, you must
       you must enable the select tool (choose Edit » Select) before you can choose Edit » Properties,
       except when selecting components and nets.
       With the Properties dialog, you query and modify the selected object’s properties. If multiple
       objects are selected, they must all be of the same type (e.g., arcs), otherwise the Edit » Properties
       command is shaded and not available. If the objects are of the same type, the changes you make
       apply to all selected objects.
       As a shortcut for choosing Edit » Properties, there are other two methods for opening the
       Properties dialog box.
       •   Right-click method: Select an object. Then, right-click the object and choose Properties from
           the shortcut menu. The available commands in this menu depend upon the object you select.
       •   Double-click method: Double-click an object to open that object’s Properties dialog. Before
           you can use this method, select the Double Click Displays Properties check box in the Options
           Preferences dialog. For details, see Options Preferences (page 448).




292                                                                                 P-CAD PCB User’s Guide
Edit Properties                                                               Chapter 13: Edit Commands


    Component Properties
        When you select one or more components and choose Edit » Properties, the Component
        Properties dialog appears. As shown in the following figure, the Pattern tab is selected.




        Use the Component Properties dialog to examine and modify component properties. As shown in
        the previous figure, the selected component appears in the browse window in this dialog.
        The Component Properties dialog contains these provide tabs, which provide access to additional
        information:
        •   Pattern
        •   Pattern Pads
        •   Component
        •   Component Pins
        •   Attributes
        •   Pattern Graphics

        Pattern Tab
        The Pattern tab contains the following options:




P-CAD PCB User’s Guide                                                                                293
Chapter 13: Edit Commands                                                                            Edit Properties


       •   The RefDes box shows the reference designator name. To change the reference designator,
           type a new value in the RefDes box. If you selected more than one component, this value
           cannot be changed.
       •   The Value box shows the component’s value. To change the value, type a new value in the
           Value box.
       •   The Type box shows the component type. You may swap the component by selecting a
           different component from the Type list that appears when you click the down arrow button.

       The RefDes, Value and Type text boxes support two wildcard characters: ? to match any single
       characters and the * to match a sequence of zero or more characters. For example, typing U? in the
       RefDes text box matches all components with a two character RefDes string beginning with U.

       Swapping the component type follows the rules used by the Utils » Force Update command, when
       merging library component attributes with design component attributes:
       •   If an attribute exists in the library component and not in the design component, the library
           attributes and their values are moved into the design component.
       •   If the same attribute exists in both the design component and the library component with
           different values, the value of the library component attribute will replace the value of the
           design component attribute.
       •   An existing design component attribute, which has no matching library component attribute, is
           retained, unchanged, in the design component.

       When the Value attribute is present in both the design component and the library component, and
       has a different value in both places, you must choose which value to keep in the design when
       prompted.

       •   The Libraries box lets you select a library when you want to change the type of component.
       •   The Visibility check boxes apply to the attribute directly to their left. The Visibility option
           indicates whether the selected component(s) has visible, invisible, or undetermined RefDes,
           Value, and Type attributes.
           If a box is selected, the attribute is visible. If the box isn't selected, the attribute is invisible. If
           the box is shaded, then the attribute either does not exist (e.g., there is no Value attribute for
           the selected component), or there is a conflict between multiple components selected (e.g.,
           the attribute on one component is visible, but is invisible on another).
       •   The Text Style frame lets you select the text styles for the component’s RefDes, Value, and
           Type. To use another text style, select a style from the appropriate list.
           To add a new text style, or modify an existing text style, click Text Styles. See Text Styles Button
           (page 328).
       •   Change Pattern: Click this button to create a new component from the current component
           and a pattern selected from the current library. This button is shaded for fixed components.
       For more information, see Change Pattern Button (page 296).


294                                                                                       P-CAD PCB User’s Guide
Edit Properties                                                                  Chapter 13: Edit Commands


        •   The Pattern field displays the pattern name. An image of the pattern appears just below this
            field.
        •   The Location frame shows the X and Y coordinates of the component’s reference point.
        •   Flip: When this check box is selected, the pattern has been flipped. When the check box is
            clear, the pattern has not been flipped.
        •   The Fixed box indicates whether or not the component has been fixed into position. In your
            design, fixed components display in the color assigned to fixed components. You set this color
            in the Colors tab of the Options Display dialog.
        All commands that change the location of a fixed component ignore that component. This includes
        the following commands:
        •   Change Pattern
        •   Move
        •   Edit Move By Refdes
        •   Rotate
        •   Flip
        •   Edit Delete
        •   Edit Cut
        •   Component Type replacement
        •   Edit Explode Component
        •   Edit Align Component
        •   Utils Force Update
        •   The Rotation field shows the rotation amount, if the pattern has been rotated.
        •   The Glue Dot Locations list shows a list of all glue dot locations. Glue Dots hold components in
            place until they are soldered during manufacturing.
        You can change the size of the glue dots in the Miscellaneous tab of the Options Display dialog.
        For instructions, see Glue Dots (page 445).
        •   The Pick and Place Locations list shows a listing of all pick and place locations. Pick and Place
            points provide reference points in directing the pick and place mechanism (or auto insert) in
            manufacturing (picking up the component and placing it on the board).
            You can change the size of the pick and place points in the Miscellaneous tab of the Options
            Display dialog. For instructions, see Pick and Place (page 445).




P-CAD PCB User’s Guide                                                                                      295
Chapter 13: Edit Commands                                                                    Edit Properties


       Replacing a Component
       To replace the component(s) associated with this pattern with another component from any open
       library:
       1.   To select a component from another open library, select a new library from the Libraries list.
       2.   Select a new component from the Type list.
       3.   Click OK to replace the component or components with the new component.
       The new component is placed at the same Reference Point and same Rotation as the component
       you are replacing.
       The net connectivity is maintained after the swap. If connectivity can't be maintained, a warning
       message appears and the component is swapped.

       Using the Properties function to swap a component can result in changes to the netlist if the pin
       designators on the replacement component are not the same as those on the original component.

       If a warning message indicates that netlist changes have occurred, not only may some netlist nodes
       and their corresponding from-to connections be missing, but the net names may be removed if
       they result in a single node net. Additionally, any intelligent copper connected to the pads that are
       no longer netlist nodes are stripped of their netlist information. Choose Edit » Undo if you want to
       undo the component swap.

       Text Styles Button
       Click Text Styles in the Properties dialog to open the Options Text Style dialog. From this dialog you
       can add, delete, rename, or edit text styles. For more information, see Options Text Style (page 482).

       Change Pattern Button
       You can click Change Pattern in the Properties dialog to create a new component from the current
       component and a pattern selected from the current library.
       1.   In the Properties dialog, click Change Pattern. The following Library Browse dialog appears.




296                                                                                P-CAD PCB User’s Guide
Edit Properties                                                                   Chapter 13: Edit Commands




             Since this dialog shows a list of matching patterns from the current library, the Pattern list
             contains only patterns that have the exact same number of pads as the currently attached
             pattern.
        2.   Select a pattern name from the Pattern list.
        3.   Click OK. The Component Name dialog appears.




        4.   Type a name for the component or select one from the list. Then, click OK to save it to the
             current library. You can overwrite an existing component if that component is not used in your
             design.

             The Change Pattern button is shaded if more than one component is selected and the
             components are of differing types. It is also unavailable for fixed components.

        Pattern Pad Tab
        When you click the Pattern Pad tab, the Component Properties dialog appears as follows:




P-CAD PCB User’s Guide                                                                                        297
Chapter 13: Edit Commands                                                                       Edit Properties




       Use this tab to change the pad style of specific pads within the component and edit the pad style
       itself. This tab contains the following options:
       •   The Pads list lists the pin numbers of the pads in the selected component. The information
           fields to the right display information about the highlighted pad.
       •   Set All: Click this button to select all of the pads in the Pads list.
       •   Clear All: Click this button to cancel the selection of all pads in the Pads list.
       •   The Location fields show the X and Y coordinates of the selected pad. This field is read-only.
       •   The Flip check box indicates whether or not the pad has been flipped. This field is read-only.
       •   The Rotation field shows the rotation amount if the pad has been rotated. This field is read-
           only.
       •   The Net Name field shows the name of net to which the pad is attached. This field is read-only.
       •   The Default Pin Designator field shows the Pandas assigned to the pad. This field is read-only.
       •   The Tool Code field shows the code used to select the drill bit for the corresponding hole
           diameter. This field is read-only.
       •   Pad Style: Use this list to perform single or multiple pad editing. The pad numbers are
           highlighted in the Pads list and you can either change to another pad style for those pads, or
           you can click Pad Styles to open the Options Pad Style dialog, so you can modify an existing
           pad style, rename it, or create a new one based on an existing style.




298                                                                                   P-CAD PCB User’s Guide
Edit Properties                                                                Chapter 13: Edit Commands


        •   Apply: Click this button to apply any changes to the selected pad or pads.

        Component Tab
        When you click the Component tab, the Component Properties dialog appears as follows.




        This tab shows information for the component or components selected on a gate-by-gate basis.
        This information is view-only and can’t be modified from this dialog. To show information for a
        different gate, select the gate from the Gate Number list.
        The Reference button, when activated by the presence of the Reference attribute, quickly opens
        the program or Internet Explorer where the document or web site containing the reference
        information is located.
        See the P-CAD Library Executive User’s Guide for information about this dialog’s fields.

        Component Pins Tab
        When you click the Component Pins tab, the Component Properties dialog appears as follows:




P-CAD PCB User’s Guide                                                                                    299
Chapter 13: Edit Commands                                                                   Edit Properties




       With this tab, you view at pin information for the component pins within the symbol or
       component. In this tab, the following information appears:
       •   Pad #: The number of the corresponding pad on the attached pattern.
       •   Pin Des: The pin designator of each pin in the component.
       •   Gate #: This column indicates part number defines the part that the pin is associated with. In
           multi- part components, the parts are uniquely numbered from 1 through n.
       •   Pin #: This column shows the number of the corresponding pin on the attached symbol.
       •   Pin Name: This column indicates the pin name associated with that pin designator.
       •   GateEq: This column defines which gates are equivalent. All gates with the same GateEq
           number are equivalent. P-CAD Schematic uses this information when automatically
           incrementing reference designators (e.g., Place Part, Utils Renumber. P-CAD PCB uses this
           information to determine which gates can be swapped during manual or automatic gate
           swapping).
       •   PinEq: This column indicates which pins within a gate are logically equivalent and may be
           swapped using the Utils » Optimize Nets pin swap commands. The pin equivalence values
           must be non-zero and identical for a swap to occur between two pins. Non-swappable pins are
           indicated with a zero value.
       •   Elec Type: This column indicates the electrical type of the pin.




300                                                                              P-CAD PCB User’s Guide
Edit Properties                                                                 Chapter 13: Edit Commands


        Attributes Tab
        Use this tab to view and modify component attributes for the selected component. When you click
        the Attributes tab, the dialog appears as follows.




        You can view, add, modify, or delete a collection of component attributes. The dialog contains a
        two- column table showing the collection of component attributes. Within the collection, each
        attribute’s name and value appear in the column.
        •   Adding an Attribute: To add an attribute, click the Add button to open the Place Attribute
            dialog. You can select a pre-defined attribute from a specific category or define your own
            attribute by selecting the {user-defined} attribute. Type the name and value for the attribute
            and set the attribute properties. Click OK, and the attribute is added to the table.
        •   Viewing or Changing Attribute Properties: To view or change an attribute’s properties, select
            an attribute from the table and click Properties (or double-click the attribute) to open the
            Attribute Property dialog.
        •   To Delete an Attribute: Select an attribute in the table and click Delete, or press the DEL key.
        •   Launching a Reference Link: When the special attribute Reference, whose value is a reference
            link, is added to the component, you can select the Reference attribute and click Launch to
            start a program to view a document or a web site.

        Attribute Property Dialog
        The Attribute Property dialog appears as follows:




P-CAD PCB User’s Guide                                                                                       301
Chapter 13: Edit Commands                                                                        Edit Properties




       The following information appears in the dialog:
       •   Category list: Displays a list of the attribute categories: All, Component, Net, Clearance,
           Physical, Electrical, Placement, Manufacturing, Router, and SPECCTRA. Selecting a category
           brings up a list of predefined attributes for that category.
       •   Name list: Displays all predefined attributes for the specified category. The first entry in the list
           is User-defined.
       The currently-selected attribute also appears in the Name text box, unless User-defined is selected.
       In that case, the Name text box is blank so that you can enter a user-defined attribute name.
       •   Name Text Box: For user-defined attributes, enter a name for the attribute.

           If the dialog is accessed to display an attribute’s properties, then the Category list, Name list,
           and Name text box are filled in, but shaded. If the attribute doesn’t have a name, these options
           are enabled.

       •   Value: Use this text box to enter a value for the attribute.
       •   Visible: This check box indicates whether or not the attribute is visible.
       •   Location: This area shows the X and Y coordinates of the component’s reference point.
       •   Text Style: This area lets you select the attribute text style. Text styles appear in the Text Style
           list. To change the selected Text Style, click on the text style you want from the list. To modify
           the text style, click the Text Style button.
       •   Rotation: Shows the rotation amount if the pattern has been rotated.
       •   Flipped: A check mark in this box indicates that the pattern has been flipped.



302                                                                                  P-CAD PCB User’s Guide
Edit Properties                                                                 Chapter 13: Edit Commands


        •   Justification: Under Justification are nine buttons, which allow you to change text justification
            by setting the reference point of the text string. For example, if you enable the middle button,
            the text reference point (the lower-left corner) moves to the center of the text area).

        Pattern Graphics Tab
        P-CAD PCB supports alternate pattern graphics. The alternate pattern graphics feature allows you
        to define different pattern graphics (as part of the same component), which are used on the board
        in different circumstances. For example, it is common practice to use a different pattern for a top
        side SMD component to when the same component is mounted on the bottom side of the board.
        Different pattern graphics can be pre-assigned to the side of the board, as well as the rotation. If
        you enable the Auto Swap Graphics option during component placement then as you rotate or flip
        the component the pattern is automatically updated, according to the assignments defined for the
        component in the P-CAD Library Executive.




        •   Pattern Graphic Orientations: Note that the Auto Swap Pattern Graphic option is on, but is
            grayed out. This indicates that the component was originally placed with the Auto Swap Pattern
            Graphic option enabled. If this component was now rotated the pattern graphic would
            automatically change to the pattern specified in the layer and orientation table in the center of
            the dialog. The table shows the 8 pattern assignments defined for the component, in this case
            there are only 2 pattern graphics assigned, one called Primary, the other called Secondary.
            These side of board and orientation assignments are set up in the P-CAD Library Executive or
            the P-CAD Pattern Editor.
        •   Current Pattern Graphics: This component is currently using the Secondary pattern graphic.




P-CAD PCB User’s Guide                                                                                     303
Chapter 13: Edit Commands                                                                        Edit Properties


        •    Solder Flow Direction: The Solder Flow Direction is set up in the Manufacturing tab of the
             Options Configure dialog. This feature selects the pattern graphic based on the pre-defined
             assignments shown in the table below. The default solder flow direction is Top to Bottom. Note
             that the pattern graphic assigned to each rotation changes with the different solder flow
             direction option.
             If for some reason you change the solder flow direction after components have already been
             placed on the board, you should enable the Synchronize Components option in the Solder
             Flow Direction frame – each component on board is checked, and if required its pattern
             graphic is changed for the correct alternative.


              Solder Flow             Top (Non-Flipped)                       Bottom (Flipped)
               Direction        0°       90°      180°      270°       0°       90°       180°       270°
            Top to Bottom     Pat 1    Pat 2     Pat 3     Pat 4     Pat 5    Pat 6      Pat 7     Pat 8
            Left to Right     Pat 4    Pat 1     Pat 2     Pat 3     Pat 8    Pat 5      Pat 6     Pat 7
            Right to Left     Pat 2    Pat 3     Pat 4     Pat 1     Pat 6    Pat 7      Pat 8     Pat 5
            Bottom to Top     Pat 3    Pat 4     Pat 1     Pat 2     Pat 7    Pat 8      Pat 5     Pat 6



      Component Reference Links
        With the Attribute Properties or Place Attribute dialog, you can add a reference attribute to a
        component. A reference attribute is a link between a web site or document and a P-CAD
        component.
        When you place a component with a reference attribute in a design, you can gain access to the web
        site or document associated with the reference. To do this, right-click the component and choose
        Properties. For details, see Accessing a Reference Link (page 305).

        Adding a Reference Link
        To add the Reference attribute to a component, choose Place » Attribute. The following Place
        Attribute dialog appears:




304                                                                                   P-CAD PCB User’s Guide
Edit Properties                                                               Chapter 13: Edit Commands




        In the Place Attribute dialog, choose Component from the Attribute Category list and select
        Reference from the Name list. In the Value box, type the path and file name of a document (e.g.,
        C:\\PCAD\Text.doc) or the address of a web page (e.g., www.pcad.com). Then, click OK.
        Next, save the Reference attribute to a component in a library. For more information on placing
        attributes and creating components, see Place Attribute (page 396).

        Accessing a Reference Link
        Once you’ve added the reference attribute to a component, you can right-click the component and
        choose Properties from the shortcut menu. Then, you can choose one of the following methods to
        gain access to the reference link:
        •   Click the Component tab, and click Reference.
        •   Click the Attributes tab, and click Launch.
        For more information on the options in each tab, see Component Tab (page 299) and Attributes Tab
        (page 301).

    Connection Properties
        When you select a connection and choose Edit » Properties, the Connection Properties dialog
        appears. As shown in the following figure, the Net tab selected by default.




P-CAD PCB User’s Guide                                                                                     305
Chapter 13: Edit Commands                                                                Edit Properties




       For information on the options in this tab, see Net Tab (page 464).

       Connections Tab
       When you click the Connections tab in the Connection Properties dialog, the dialog appears as
       follows:




306                                                                            P-CAD PCB User’s Guide
Edit Properties                                                                Chapter 13: Edit Commands




        The options in the Connection tab show you the start and end points for the selected connection
        and the Net Name to which the net belongs, as described below:
        •   Net Name: The net name of the connection.
        For the connection Start and End points, you see:
        •   X and Y coordinates: The X and Y location of the start and end point.
        •   Node: The node name to which this connection is connected.
        •   Type: The type of start or end point shows what the connection is connected to (e.g., pad).

    Pad Properties
        When you select a pad and choose Edit » Properties, the Pad Properties dialog appears. As shown in
        the following figure, the Pad tab is selected by default.




P-CAD PCB User’s Guide                                                                                    307
Chapter 13: Edit Commands                                                                   Edit Properties




       The Pad tab contains the following options. The fields in this tab are read-only:
       •   Net Name: The name of the net associated with the selected pad.
       •   Tool Code: The tool code used to select the drill bit for the corresponding hole diameter. See
           File Export N/C Drill (page 264) for additional information.
       •   Flip: The Flip box indicates whether or not the pad has been flipped.
       •   Rotation: The Rotation field shows the degree of rotation.

       Changing Pad Properties
       You can change pad properties as follows:

       If the pad is part of a pattern, you can change only the pad style; you cannot change the pad
       number and location.

       •   Pad Number: Changing the pad number is useful when you only want to change one or two
           pads. If you want to renumber a series of pads, choose Utils » Renumber. For details, see Utils
           Renumber (page 497).
       •   Default Pin Designator: You can assign a pin designator for each pad which, when saved,
           becomes the pad’s default designator in the library. If you have selected multiple pads, which
           have different default pin designators, the Default Pin Designator text box displays
           “Hetero_Selection”.
       •   Location: Type new X and Y coordinates for the pad.



308                                                                                P-CAD PCB User’s Guide
Edit Properties                                                                  Chapter 13: Edit Commands


        •   Fixed: Select the Fixed check box to secure a free pad in its design location. When fixed, a free
            pad cannot be moved, flipped, rotated, cut or deleted. The Fixed box does not appear in the
            Properties dialog when the selected pad is part of a pattern.
        •   Pad Style: You can change the style of the selected pad by selecting one of the existing pad
            styles in the Pad Style list.

        Pad Styles Button
        In the Pad tab, click Pad Styles to open the Properties dialog for pad styles. From this dialog you can
        add a new style based on an existing style, modify a non-default pad style, or delete a non-default
        pad style.
        For detailed instructions on all the features, see Options Pad Style (page 472).

        Net Tab
        When you click the Net tab, the Pad Properties dialog appears as follows:




    Net Tab
        A number of objects have net information appearing on a Net tab with the object’s Properties
        dialog. This section describes the information you will find on the Net tab whenever that tab
        appears in a dialog.

        Net Name
        The Net Names text box contains the name of the net associated with this pad.




P-CAD PCB User’s Guide                                                                                      309
Chapter 13: Edit Commands                                                                     Edit Properties


       Nodes List Box
       The Nodes list contains the names of all nodes in the net associated with this pad.

       Layers List Box
       The Layers list contains the names of all layers associated with this net.

       Connection Lengths
       This area shows the Manhattan length, the Selected length, and the Total length of all connections
       in the net. The Manhattan length is an approximation of the final routed length of a diagonal
       connection.
             diagonal
                   connection




           Manhattan length
             (dashed)

       It only measures the X and Y distances, not depth (such as via length to another layer). Arc length is
       included (accurately) in the calculation of connection lengths.

       Copper Lengths
       This area shows the Selected length and the Total length of all copper in the net.
       It only measures the X and Y distances, not depth (such as via length to another layer). Arc length is
       included (accurately) in the calculation of copper lengths.

       Counts
       The Counts frame counts the following objects in the selected net:
       •   Arcs
       •   Lines
       •   Pads
       •   Polygons
       •   Pours
       •   Vias

       Net Attrs Button
       When you click Net Attrs in the Net tab, the following dialog appears.




310                                                                                 P-CAD PCB User’s Guide
Edit Properties                                                                   Chapter 13: Edit Commands




        This dialog shows a collection of net attributes for the selected net. You can add, change, edit and
        delete attributes for the net and launch a reference to a document or web site.
        For details about this function and a complete listing of attributes, see Edit Nets (page 345).

    Via Properties
        When you select a via and choose Edit » Properties, the Via Properties dialog appears. As shown in
        the following figure, the Via tab is selected by default.




P-CAD PCB User’s Guide                                                                                     311
Chapter 13: Edit Commands                                                                     Edit Properties


       Use this dialog to view or change the style of the selected via and to change its location. A Net tab
       provides net information when the via is part of a net.
       The following fields are available for viewing only:
       •   Net Name: The name of the net associated with the selected pad.
       •   Tool Code: The tool code used to select the drill bit for the corresponding hole diameter. See
           File Export N/C Drill (page 264) for additional information.
       •   Flip: The Flip box indicates whether or not the via has been flipped.
       •   Rotation: This field shows the rotation of the via.

       Changing Via Properties
       You can only change these properties if the via is not part of a net and is not connected to other
       objects.

       •   To change the via Location: The X and Y coordinates of the selected via appear in the Location
           box. You can move the via by entering new coordinates.
       •   Fixed: Select the Fixed check box to secure the free via in its design location. When fixed, a via
           cannot be moved, flipped, rotated, cut or deleted.
       •   To change the Via Style: Select the desired via style from the Via Style list.

       Via Styles Button
       In the Via tab, click Via Styles to open the Properties dialog for via styles. From this dialog you can
       add a new style based on an existing style, modify a non-default via style, or delete a non-default via
       style.
       For more information, see Options Via Style (page 482).

       Net Tab
       When you click the Net tab, the Via Properties dialog appears as follows:




312                                                                                 P-CAD PCB User’s Guide
Edit Properties                                                                   Chapter 13: Edit Commands




        For detailed information about this tab, see Net Tab (page 309).

    Line Properties
        When you select a line and choose Edit » Properties, the Line Properties dialog appears.




        The Line Properties dialog shows you the Length of the selected line.

        Changing Line Properties
        To change the line’s Width: Type a new width over the value in the Width box.
        To change the line’s End Points: Type new X and Y coordinates over the values in the X and Y boxes.
        To fix a free line in its location: Select the Fixed check box. A fixed line cannot be moved, flipped,
        cut, rotated, deleted or resized.




P-CAD PCB User’s Guide                                                                                       313
Chapter 13: Edit Commands                                                                        Edit Properties


      Arc Properties
         When you select an arc and choose Edit » Properties, the following Arc Properties dialog appears.




         The Arc Properties dialog shows you the start and end points for the selected arc.
         For the free arc Center Point, Start Point, and End Point, you see:
         •   X and Y coordinates: The X and Y location of the Start and End point.
         •   Tangent Slope Angle: The tangent slope angle of the arc.

         Changing Arc Properties
         You can change the following properties if the arc is not part of a net and if it is not connected to
         other objects.
         •   To change the arc’s start angle: Click the scroll buttons (up and down arrows) in the Start Angle
             box to scroll through arc start angles or type a new value.
         •   To change X and Y coordinates of the Center Point: Type over the existing X and Y values in the
             Center Point frame.
         •   To change the arc’s Sweep Angle: Click the scroll buttons (up and down arrows) to scroll
             through arc sweep angles.
         •   To change the arc’s Radius: Type a new radius over the existing value in the Radius box.
         •   To change the arc’s line width: Type a new Value over the existing one in the Width box.
         •   To fix a free arc in its location: Select the Fixed check box. A fixed arc cannot be moved,
             flipped, cut, rotated, deleted or resized.




314                                                                                   P-CAD PCB User’s Guide
Edit Properties                                                                  Chapter 13: Edit Commands


    Polygon Properties
        When you select a polygon and choose Edit » Properties, the following Polygon Properties dialog
        appears with the Polygon tab selected:

        You can only change end points if a line is not part of a net and is not connected to other objects.




        The Polygon tab of the Polygon Properties dialog contains the following options:
        •   Area: The area of the polygon.
        •   Definition Points: The X and Y location of each vertex in the polygon along with the total
            number of definition points it contains. If the corners of the polygon are filleted, the radius of
            the fillet is also displayed.
        •   Filleted Points: The X and Y location of each filleted point in the polygon, along with the total
            number of filleted points it contains.
        •   Chord Height: The chord height is the maximum distance between the actual arc and its
            representation as line segments. Curved edges are drawn using a series of line segments. The
            more line segments used to draw the arc, the closer the arc approaches a perfect curve,
            producing a small chord height. The default value is 5 mil and is stored in the .ini file.
        •   Show Fillet Handles: Turns on or off the display of the fillet handles in the polygon. The fillet
            handles are used to move or adjust filleted corners.
        The Tie tab of the Polygon Properties dialog contains the following options:
        •   Copper Tie: Select the Copper Tie check box to make the polygon a copper tie. When a
            polygon and two or more nets are given the same TieNet value, and positioned so that the nets
            are touching the polygon, the polygon becomes a copper tie. The nets cannot be touching



P-CAD PCB User’s Guide                                                                                      315
Chapter 13: Edit Commands                                                                       Edit Properties


             each other (i.e., shorted) except through the Copper Tie. This gives you the ability to tie nets
             together while treating each net separately for routing purposes.
         •   TieNet: Set the TieNet value of the polygon with an entry in this field. You may enter a TieNet
             value or select an existing value from the drop-down list. The TieNet value can be any
             combination of alpha and/or numeric characters (i.e., 123, Ab1, 5, A1, etc.). Selecting a TieNet
             value from existing values in the drop-down list moves all nets with the same TieNet value
             from the Existing Nets list to the Tied To list.
         •   Tied To: The nets listed in this area are those that have the same TieNet value selected for the
             copper tie polygon.
         •   Existing Nets: All nets in the design are listed here. You can move a net from the Existing Nets
             list to the Tied To list by selecting the net then clicking the left arrow button. Conversely, move
             a net from the Tied To list to the Existing Nets list by selecting it and clicking the right arrow
             button.
         When a net is moved into the Tied To nets list, the TieNet attribute value for that net is set to the
         current TieNet value of the copper tie. When a net is moved back to the Existing Nets list, its TieNet
         attribute reverts back to the value it had prior to being moved to the Tied To list. Any changes made
         in this dialog are applied when you close the dialog by clicking OK.

         Copper Ties must be hidden from the routers to prevent being seen as shorts. You must place a
         polygon keepout around each copper tie before routing the design.

      Test Point Properties
         To open the Properties dialog for test points, select a test point and choose Edit » Properties. Or,
         select a test point, then right-click and choose Properties from the shortcut menu. As shown in the
         following figure, you can view and modify test point properties with this dialog:




         The Test Point Properties dialog contains the following options:
         •   Side of Board frame: There are two options buttons in the Side of Board frame: Top and
             Bottom. The button you choose indicates whether the point is tested from the Top or Bottom
             of the board. Since test points are not layer-specific, you can physically place a point on the
             bottom non-signal layer and choose Top to test the point from the top of the board.



316                                                                                  P-CAD PCB User’s Guide
Edit Properties                                                                  Chapter 13: Edit Commands


        •   Fixed: Select the Fixed check box to make the point a fixed object. In your design, fixed points
            appear in the color assigned to fixed objects in the Options Display dialog. Clear the Fixed
            check box to indicate that the point is a moveable object. If a point is moveable (or unfixed), it
            appears in the appropriate layer color. If this check box is shaded, the test point is part of a
            pattern.
        •   Snap to Center: Select the Snap to Center check box when you want the test point centered
            on a pad or via. If you choose this option and the test point is on a pad or via, the point snaps
            to the center of the pad or via.
        •   Net: The Net text box shows the name of the net on which the point is located.
        •   Location frame: The text boxes in the Location frame show the X,Y coordinates of the test
            point. Both the Net and Location information is read-only. To modify these properties, you
            must move the test point from within your design.
        To learn more about test points see Test Points (page 376) and Placing Test Points (page 386).

    Copper Pour Properties
        When you select one or more copper pours and choose Edit » Properties, the Copper Pour
        Properties dialog appears. As shown in the following figure, the Style tab is active when you choose
        this command.




        Use the options in this dialog to set up or modify the properties associated with a copper pour.
        When a design contains more than one copper pour, you can modify all of the copper pours in the
        design at the same time.
        Typically, you will use this dialog to change the state of the copper pours in your design from
        Unpoured to Poured or from Poured to Repour. For example, assume you place three copper pour
        outlines in a design (for instructions, see Placing a Copper Pour (page 387). To flood all three pours
        with a copper fill, do the following:




P-CAD PCB User’s Guide                                                                                      317
Chapter 13: Edit Commands                                                                           Edit Properties


       1.     Hold down the CTRL key and select each pour.
       2.     Right-click and choose Properties from the shortcut menu.
       3.     When the Copper Pour Properties dialog appears, choose Poured in the State frame.
       4.     Click OK. P-CAD PCB floods all of the copper pours with the copper fill according to the pour
              order set in the Pour/Repour Option frame of the Options Display dialog. For details, see
              Pour/Repour Option (page 430).

       IMPORTANT: You can inadvertently split the copper pour in half (more than two pieces) by
       modifying lines or polygons that were inside the pour region to where they are longer than the
       copper pour polygon. In that case, the electrical connection would be severed and a connection
       line will be created between the two islands if the pour is associated with a net

       The Copper Pour Properties dialog contains the following tabs:
       •      Style tab
       •      Connectivity tab
       •      Island Removal tab
       •      Net tab
       •      Polygon tab

       Style Tab
       Use the options in this tab to select a fill pattern, set line characteristics, and choose backoff
       options.


           Click this button                        To choose this fill pattern
                               Solid copper fill will actually be banded (striped) with lines.

                               Horizontal fills the pour with horizontal lines (no hatching).

                               Vertical fills the pour with vertical lines (no hatching).

                               45-degree Cross is cross-hatched diagonally, at a 45-degree
                               angle (like X).
                               90-degree Cross is cross-hatched horizontally and vertically, at a
                               90-degree angle (like +).


       •      Line Width: Type a value in this box to determine the width of the lines used in filling and
              hatching.




318                                                                                         P-CAD PCB User’s Guide
Edit Properties                                                                 Chapter 13: Edit Commands


        •   Line Spacing: Type a value in this box to determine the separation between fill or hatch lines. If
            you selected Solid for the Fill Pattern, then the Spacing box is shaded and not available.
        •   Backoff: Choose one of the following buttons in this frame.
        •   Fixed: Choose this button and type a value in the text box to specify a value for the distance
            you want between the copper pour and any objects that may be inside of the copper pour
            polygon. This option also backs off from any objects that are outside the copper pour polygon
            if they are too close to it. The copper pour backoffs from any copper item that is not in the net
            associated with the pour. The backoff options takes the object’s width into account.
        •   Use Design Rules: Click this button to set backoff values for a specific net. Backoff clearances
            are fixed at the greatest of the Line to Line or Line to Pad clearance amount set for the current
            layer in Options Design Rules dialog.
        •   Backoff Smoothness: The irregularities and roughness around the copper pours can be
            smoothed using the options in the Backoff Smoothness frame. Choose one of the following
            buttons to set the smoothness of backoff polygons. There are three degrees of smoothness:
            •     Low specifies eight- to 10-sided polygons.
            •     Medium specifies 12- to 14-sided polygons.
            •     High specifies 16- to 18-sided polygons.
        •   State: Choose one of the following option buttons to set the state of the copper pour.
        •   Poured: Choose this button to flood the selected copper pours with a copper fill.
        •   Unpoured: Choose this button to leave the selected copper pours unfilled.
        •   Repour: Choose this button to repour an already filled pour to recalculate its islands. Typically,
            you will use this option when you load a netlist or move a copper pour. For details, see Repour
            (page 190).

        Changing the values of Line Width, Pour Backoff, or Backoff Smoothness causes the copper pour to
        regenerate if Poured is enabled. Changes to any other value merely redraws the pour with the new
        settings.

        •   Save Settings As Default: Select this check box to save the selected settings for Fill
            Characteristics, Thermals, Backoff Smoothness and Automatic Island Removal are retained and
            applied to the next copper pour created.

        Connectivity Tab
        When you click the Connectivity tab, the Copper Pour Properties dialog appears as follows:




P-CAD PCB User’s Guide                                                                                     319
Chapter 13: Edit Commands                                                                    Edit Properties




       The Connectivity tab contains the following options:
       •   Net: Select the net to which you want to connect the copper pour from this list. The copper
           pour will backoff from all copper items not in this net. If no net is specified, the copper pour
           backs off from all copper objects inside the pour region except other “no-net” copper pours.
       •   Thermals: Choose one of the following option buttons in this frame to determine whether to
           use thermals, and if so, what type.
       •   45 and 90 specify 45- or 90-degree thermals.
       •   Direct Connect specifies that the copper will pour right over pads and vias (no thermals) that
           belong to the same net as the copper pour.
       •   Spoke Width: Type a value in this box to specify a value for the width of the thermal spokes.

       Island Removal Tab
       When you click the Island Removal tab, the Copper Pour Properties dialog appears as follows:




320                                                                               P-CAD PCB User’s Guide
Edit Properties                                                                   Chapter 13: Edit Commands




        Automatic Island Removal
        Select the options in this frame to set criteria for the automatic removal of islands.
        •   Minimum Area: Select this check box and type a value in the box to specify a minimum area an
            island can have before being removed. Type a minimum value (in square units) in the text box.
            For example, to remove tiny islands about the size of the default via, enter 1600 as the area (40
            mil x 40 mil).
        •   Interior: Select this check box to specify that all islands in a pour that don’t have an edge in
            common with the perimeter of the copper pour are removed.
        •   Unconnected: Select this check box to automatically remove any copper pour island that is not
            connected to thermals or other copper. P-CAD PCB does not remove islands when all copper
            pour islands are unconnected.
        •   Do not repour: Select this check box to remove islands without repouring the copper pour.
            Because you do not have to wait for the pour to regenerate, selecting this check box is a quick
            way to remove unwanted islands.

        Net Tab
        When you click the Net tab, the Copper Pour Properties dialog appears as follows:




P-CAD PCB User’s Guide                                                                                         321
Chapter 13: Edit Commands                                                                     Edit Properties




       For detailed information about this tab, see Net Tab (page 309).

       Polygon Tab
       When you click the Polygon tab, you have the ability to gain access to the options shown in the
       following figure:




       The options in this tab are similar to the options in the Polygon tab of the Polygon Properties dialog.
       For details, see Polygon Properties (page 315).
       Copper Pours can be fixed in their location by selecting the Fixed check box. When a copper pour
       is fixed it cannot be moved, flipped, cut, rotated, deleted or resized.




322                                                                                P-CAD PCB User’s Guide
Edit Properties                                                               Chapter 13: Edit Commands


    Cutout Properties
        When you select a cutout and choose Edit » Properties, the Cutout Properties dialog appears as
        follows.




        The Cutout tab of the Cutout Properties dialog contains the following options:
        •   Layer: The layer on which the cutout appears. To change the layer, select a new layer from the
            list.
        The Polygon tab of the Cutout Properties dialog, shown in the following figure, provides you with
        the ability to gain access to the same information available on the Polygon tab of the Polygon
        Properties dialog.




        See Polygon Properties (page 315) for complete details.

    Plane Properties
        When you select a plane and choose Edit » Properties, the Plane Properties dialog appears with the
        Plane tab selected:


P-CAD PCB User’s Guide                                                                                   323
Chapter 13: Edit Commands                                                                      Edit Properties




       The Plane tab of the Plane Properties dialog presents the following information:
       •   Net: Use the list to assign the plane to an existing net or type in the net name.
       •   Boundary Width: This box defines the line width for the Polygonal outline. The default is the
           current default line width. Change the width by typing over the default value.

       Net Plane Color Button
       To select a net plane color, click Net Plane Color in the Plane tab of the Plane Properties dialog.
       When the color palette appears, select a color from the palette.

       Net Tab
       When you select the Net tab, the Plane Properties dialog appears as follows:




324                                                                                 P-CAD PCB User’s Guide
Edit Properties                                                                Chapter 13: Edit Commands


        For detailed information about this tab, see Net Tab (page 309).

        Polygon Tab
        The Polygon tab of the Plane Properties dialog, shown in the following figure, provides you with the
        ability to gain access to the same information available on the Polygon tab of the Polygon Properties
        dialog.




        See Polygon Properties (page 315) for complete details.

    Room Properties
        The Room Properties dialog, shown in the following figure, is used to modify the properties of one
        or more selected rooms.




P-CAD PCB User’s Guide                                                                                    325
Chapter 13: Edit Commands                                                                   Edit Properties




       The Rooms Properties dialog contains the following options:
       •   Name: The unique name of the Room. You may type a new name in the text box. A room’s
           name cannot be greater than 20 characters or contain spaces. The default Room name is the
           word Room followed by a number, which is incrementally allocated each time a Room, is
           created (i.e. Room1, Room2, etc.).
       •   Edit Rules: Click this button to open the Attributes dialog where you can assign attributes and
           their values to the Room rules. See Attributes Tab (page 301) for more information on the
           Attributes dialog.
       •   Placement Side: Choose one of the buttons in this frame to designate the Room placement on
           the board to the Top, Bottom, or Top or Bottom layer. The Top Or Bottom option is selected by
           default, giving you the ability to place rooms on either the Top or Bottom layer.
       •   Included Components: A list of the components included in the selected Room.
       •   Design Components: The list of all components in the design that are not already included in
           the room.
       You may select one or more components from the Design Components list and click <<Add to
       move them to the Included Components list. To remove selected components from the Included
       Components list, click Remove.
       In addition to selecting components by name from the Design Components list, you can select all
       components with the same Attribute and value for inclusion in the Included Components list. Click
       Select by Attribute to open the Set By Attribute dialog. You can then choose the Attribute to be
       used to select the desired components. The Set By Attribute dialog is explained in Set By Attribute
       (page 349).


326                                                                              P-CAD PCB User’s Guide
Edit Properties                                                                     Chapter 13: Edit Commands


        •   Fill Pattern: The pattern that fills the room when displayed can be Clear, Solid or Hatched.
        •   Fixed: Check this box to secure the Room in its location. When the Fixed check box is selected,
            the Room cannot be moved, rotated, flipped, stretched, cut or deleted.
        •   Location: The location coordinates are provided for viewing purposes and cannot be changed.

    Text Properties
        When you select one or more text items and choose Edit » Properties, the Text Properties dialog
        appears:




        The Text Properties dialog remains displayed in your workspace until you close it or choose
        another tool. Changes made to the text in the text box are instantly mirrored in the location of the
        selected text in the design. You can adjust the zoom factor in the design to more easily view the
        text while the dialog remains on the screen.
        From this dialog, you can change the text content, justification, style and location. The text can also
        be rotated and flipped, and any non-default text styles can be modified.

        Changing Text Properties
        To change the Text: Type over the text displayed in the text box and click OK. For multi-line text,
        ENTER creates a line break. You can enter a maximum of 2,000 characters.
        While the text box has focus, you can press CTRL+V to paste text from the Clipboard.
        To change the text Location: The X and Y coordinates of the selected text appear in the Location
        box. You can move the text by typing new coordinates.
        To change the text Justification: In the Justification frame, choose one of the buttons to change text
        justification. The reference point of the text string is, by default, at the location of the first character
        in the string and set to the lower left corner. When you change the Justification button, the text
        moves around the reference point. For instance, if the text “STRING” is displayed in its default
        settings, the reference point (the small solid square) is as shown in the following illustration:




P-CAD PCB User’s Guide                                                                                           327
Chapter 13: Edit Commands                                                                      Edit Properties




         If you change the Justification to the upper right corner button, the text “STRING” rotates around
         the reference point and appears in the design as shown in the following illustration:




         To Flip the Text: Select the Flip check box to flip the text.
         To Rotate the Text: Click Rotate to rotate the text by the number of degrees shown on the button.
         To change degree of rotation, type a value in the Rotation Increment box in the General tab of the
         Options Configure dialog. The number of degrees that the text has been rotated is displayed next
         to the Rotate button.
         To change the Text Style: Click the text style you want from the Text Style list.

         Text Styles Button
         Click Text Styles to open the Options Text Style dialog. From this dialog you can add, delete,
         rename, or edit text styles.
         For more information on the Text Style dialog, see Options Text Style (page 482).
         For more information on placing text, see Place Text (page 393).

      Attribute Properties
         When you select an attribute and choose Edit » Properties, the Attribute Property dialog appears as
         follows:




328                                                                                   P-CAD PCB User’s Guide
Edit Properties                                                                    Chapter 13: Edit Commands




        The following information appears in the dialog:
        •   Category list: Displays a list of all attribute categories: All, Component, Net, Clearance,
            Physical, Electrical, Placement, Manufacturing, Router, and SPECCTRA. Selecting a category
            brings up a list of predefined attributes for that category.
        •   Name list: Displays all predefined attributes for the specified category. The first entry in the list
            is User-defined.
        The currently-selected attribute also appears in the Name text box, unless User-defined is selected.
        In that case, the Name text box is blank so that you can enter a user-defined attribute name.
        •   Name: For user-defined attributes, enter a name for the attribute.

            If the dialog is accessed for an attribute that already has a name, then the Category list, Name
            list, and Name text box are filled in, and shaded. If the attribute doesn’t have a name, these
            options are enabled.

        •   Value: Use this text box to enter a value for the attribute.
        •   Visible: This check box indicates whether the attribute is visible or not.
        •   Location: This area shows the X and Y coordinates of the component’s reference point.
        •   Text Style: This area lets you select the attribute text style. Text styles appear in the Text Style
            list. To change the selected Text Style, click on the text style you want from the list. To modify
            the text style, click the Text Style button.
        •   Rotation: Shows the rotation amount if the pattern has been rotated.
        •   Flipped: This box indicates whether or not the pattern has been flipped.




P-CAD PCB User’s Guide                                                                                         329
Chapter 13: Edit Commands                                                                         Edit Properties


         •   Justification: In the Justification frame, choose one of the buttons to change text justification
             by setting the reference point of the text string. For example, if you enable the middle button,
             the text reference point (the lower-left corner) moves to the center of the bounding rectangle.

      Field Properties
         When you select a field and choose Edit » Properties, the Field Properties dialog appears as follows.




         The Field Properties dialog lets you view and/or change selected information about the selected
         field’s properties. You can modify the field’s Location, Text Style and Justification. The Value of the
         field can be modified using the File » Design Info command.
         The following information about the selected field can be viewed:
         •   Name: The name of the existing field is displayed here.
         •   Value: The Value assigned to the field.
         •   Flip: The Flip box indicates whether or not the field has been flipped.
         •   Rotation: The Rotation field shows the rotation amount if the field has been rotated.
         The following information about the selected field can be modified:
         •   Text Style: Choose text style from the list of styles that appear when you click the down arrow
             button.
         •   Text Styles: If the text style you need does not appear in the Text Style list, click the Text Styles
             button to display the Options Text Style dialog where you can define a new text style. For
             information on the Options Text Style dialog, see Options Text Style (page 482).
         •   Location: The current X and Y coordinates of the field’s location. You may enter new
             coordinates and the field will be placed in the new location when you exit the dialog by
             clicking OK.
         •   Justification: Choose the reference point of the field by clicking the desired button. For
             example, if you enable the middle button, the field reference point (the lower-left corner)
             moves to the center of the bounding rectangle of the field.




330                                                                                    P-CAD PCB User’s Guide
Edit Properties                                                                  Chapter 13: Edit Commands


    Design View Properties
        A view of a specific region of your design, or design view, can be defined and placed in a new
        location. When you select a design view in the design and choose the Edit » Properties command,
        the Design View Properties dialog opens:




        The Design View Properties dialog is identical in appearance to the Place Design View dialog. All
        fields are available for editing and use with the exception of the Define Region interactive tool. If
        the location of the Design view needs to be modified, you can enter the new X and Y coordinates
        directly into the appropriate boxes.
        For additional information on the Design View dialog, see Place Commands (page 369).

    Detail Properties
        A scaled region of a PCB board, or detail, can be places as a graphic into your PCB design. When
        you select a places detail and choose the Edit » Properties command, the Detail Properties dialog
        opens:




P-CAD PCB User’s Guide                                                                                      331
Chapter 13: Edit Commands                                                                          Edit Properties




        The Detail Properties dialog is identical to the Place Detail dialog. All fields are available for edit,
        with the exception of the File name.
        For additional information on the Detail dialog, see Place Commands (page 369).

      Diagram Properties
        An annotated diagram depicting the stack-up of board layers can be generated and placed into the
        PCB design. When you select a placed diagram and choose the Edit » Properties command, the
        Diagram Properties dialog opens:




        The Diagram Properties dialog is identical to the Place Diagram dialog. All fields are available for
        edit.
        For additional information on the Diagram dialog, see Place Commands (page 369).




332                                                                                     P-CAD PCB User’s Guide
Edit Properties                                                                     Chapter 13: Edit Commands


    Picture Properties
        An image in P-CAD picture format can be placed into your PCB design using the DocTool » Place
        Picture command. When you select a placed picture in your design and choose the Edit »
        Properties command, the Picture Properties dialog opens:




        The Picture Properties dialog allows you to specify the Scale of the picture. Enter the scaling factor
        for the picture (values > 0). A scaling factor of 1 specifies no size change. A scaling factor greater
        than 1 specifies magnification. A selected picture object can be resized by dragging one if its vertex
        handles to the desired size.

    Table Properties
        Several tables can be generated and placed into your PCB design. When you select a table and
        choose Edit » Properties, the Table Properties dialog opens:




        The Table Properties dialog is identical to the Place Table dialog. All fields are available for edit, with
        the exception of the Table Type. When the properties are modified, the table is automatically



P-CAD PCB User’s Guide                                                                                          333
Chapter 13: Edit Commands                                                                        Edit Properties


        updated. To update the information in the table if the design itself has been modified, choose
        DocTool » Update or DocTool » Update All.

      Dimension Properties
        When you select a dimension and choose Edit » Properties, the Dimension Properties dialog
        appears as follows.




        The Dimension Properties dialog lets you view information about the selected dimension’s
        properties. You can modify the dimension’s Text Style and Line Width.
        Information about the selected field includes:
        •   Style: Shows the dimension style entered in the Place Dimension dialog.
        •   Units: Displays the measuring units of the dimension.
        •   Layer: Indicates the layer on which the dimension has been placed.
        •   Precision: Indicates how many numbers are displayed after the decimal point.
        •   Symbol Size: Shows the selected size of the symbol for a Leader style dimension.
        •   Center Size: Shows the selected center size for the center of the symbol.
        •   Display Units: Select this check box to turn on the display of the specified Unit.
        •   Display Diameter Symbol: Select this check box to turn on the display of the Diameter Symbol.




334                                                                                 P-CAD PCB User’s Guide
Edit Delete                                                                        Chapter 13: Edit Commands


        •     Suppress Leading Zeros: Select this check box to turn off the display of leading zeros in the
              dimension’s value.
        •     Suppress Trailing Zeros: Select this check box to turn off the display of trailing zeros in the
              dimension’s value.
        •     Associated Dimension: Select this check box to associate the dimension with the objects it is
              measuring.

        Points
        The Points frame displays the points upon which the dimension is built. The numbers include the
        dimension endpoints and text location.

        Text Styles
        The Text Styles frame displays the current text style. To change the style, click Text Styles to open
        the Options Text Style dialog. From this dialog you can add, delete, rename or edit text styles. For
        more information, see Options Text Style (page 482).

        Line Width
        The Line Width frame displays the current value of the line width. To change the line width, click
        Line Width to open the Options Current Line dialog. From this dialog you can edit the current line
        width. For more information, see Options Current Line (page 457).

        Arrowhead
        The Arrowhead frame displays, and allows you to change, the Length and Width of the dimension’s
        arrowhead.

        Tolerance
        The Tolerance frame displays, and allows you to change, the Positive and Negative Tolerance
        values. To turn on the display of the tolerances, select the Display Tolerance check box. The
        tolerance is always displayed with 4 digits, unless the Suppress trailing Zeros option is enabled.


Edit Delete
        Choose Edit » Delete to delete all selected objects. As a shortcut for choosing this command, you
        can press the DEL key.
        Choosing this command does not move the selected data to the Clipboard, as does Edit » Cut. As
        there is nothing to paste, the only way to reverse a delete action is to use the Edit » Undo
        command.

     Delete Objects
        1.    Choose Edit » Select (or click the toolbar button or press the S key).
        2.    Select the object you want to delete.




P-CAD PCB User’s Guide                                                                                          335
Chapter 13: Edit Commands                                                                                  Edit Delete


         3.       Choose Edit » Delete (Or press the DELETE key, or right-click and choose Delete from the
                  shortcut menu). If you inadvertently delete an object, choose Edit » Undo to reverse the delete
                  action.
         This operation can also be performed with multiple objects by using multiple select and block
         select operations. See Edit Select (page 356).

      Deleting Objects from Nets
         When you delete objects from nets, you can get a variety of results, depending on what you delete
         and the makeup of the net you delete from. The function of smart nets is to maintain certain
         connections when objects such as copper connections, unrouted connections, and net nodes are
         deleted. In general, the following can occur.
         •        If you delete free copper (no connections), then the copper disappears and no connection
                  compensation occurs.
         •        If you delete a connection to a jumper pad, hidden connections to other jumpered pads are
                  removed.
         •        If you delete a connection to a jumper pad and no other net objects are connected to any of
                  the jumpered pads, then all jumpered pads are removed from the net.
         •        If you delete a node, then the remaining nodes are still part of the net, and there is
                  compensation to maintain connections between the remaining nodes.
         •        If you delete a component, you are removing nodes from all nets to which the component's
                  pads were connected. The connectivity feature of PCB reconnects the remaining nodes in each
                  net in the most efficient way.
         •        If you delete a connection from the middle of a net, the net is split. One portion retains the
                  original net name and the others are given new system-generated names. For example, in the
                  following example the net has three connections: ab, bc, and cd. If you delete connection bc,
                  you cut the net into two nets: ab and cd.


              a                            b




                                           c                         d


         •        If you delete a connection that isolates a pad from the rest of the net, you end up with a
                  disconnected node that is no longer part of any net. For example, in the above figure, if you
                  delete connection cd, the node d becomes isolated from the net.




336                                                                                       P-CAD PCB User’s Guide
Edit Copy Matrix                                                                  Chapter 13: Edit Commands


        •    If you delete a copper segment that is part of a net, that segment is not deleted, but instead
             becomes a connection (in effect unrouting the net. In this case, the net remains intact,
             although changed).


Edit Copy Matrix
        Choose Edit » Copy Matrix to duplicate all of the selected objects according to the parameters you
        specify. The objects must be selected before the Edit » Copy Matrix command is available.
        When you choose Edit » Copy Matrix the following dialog appears.




        In the Edit Copy Matrix dialog, the Number of Columns and Number of Rows determine the
        number of X (horizontal) and Y (vertical) duplications, respectively, of a selected object.
        In the Column Spacing and Row Spacing, you can enter a value, in current units, to determine the
        spacing between the duplicated objects. With column spacing, a positive value duplicates to the
        right, a negative value to the left. With row spacing, a positive value duplicates up, a negative value
        down. For example, if you specify 200 mil for Column Spacing and 200 mil for Row Spacing (and
        specify 3 rows and 3 columns), the result is a matrix with 9 objects 200 mils apart, as shown in the
        following illustration.




        The values represented default to mm (millimeters) or mil, depending on what you have set in
        Options Configure (your current units). You can specify a measurement value (overriding Options
        Configure) by typing in mil, mm, cm, or in after the numeric value.

    Duplicating an Object(s)
        To duplicate objects, do the following:
        1.   Choose Edit » Select. Then, select the object(s) you want to duplicate.
        2.   Choose Edit » Copy Matrix. The Edit Copy Matrix dialog appears.




P-CAD PCB User’s Guide                                                                                        337
Chapter 13: Edit Commands                                                            Edit Explode Component


        3.   In the Number of Columns box, specify how many duplications you want to perform
             horizontally. In the Column Spacing box, enter a value to determine the spacing between
             duplications and in which direction (positive=right, negative=left) to duplicate).
        4.   In the Number of Rows box, specify how many duplications you want to perform vertically. In
             the Row Spacing box, enter a value to determine the spacing between duplications and in
             which direction (positive=up, negative=down) to duplicate).
        5.   An error message appears if what you specify for your duplication is too large to fit in the
             workspace.
        6.   Click OK. If you are not satisfied with the object you duplicated, choose Edit » Undo to reverse
             the action and try again.

        P-CAD PCB (6/400) designs are restricted to a maximum of 400 components. Therefore, when using
        P-CAD PCB (6/400), do not exceed this number when duplicating components in your design.


Edit Explode Component
        Choose Edit » Explode Component to convert a component back to its basic primitives, creating a
        collection of editable graphic objects. When you explode a component, the collection of objects is
        no longer a component or a pattern.

        You cannot explode a fixed or exploded component.

        This feature is useful for modifying an existing component or creating a new pattern/component
        from an existing one. After you explode the component, you can then perform changes to the
        objects such as adding more pads, adding test points, changing line size or thickness, renumbering
        pin designators, etc. In addition, the default pin designators are updated with the value of the
        current pin designators after exploding.

      Exploding a Component
        To explode a component, do the following:
        1.   Click the Select button on the toolbar or choose Edit » Select to enable the select tool.
        2.   Select the object that you want to explode and choose Edit » Explode Component. The
             component becomes a collection of modifiable objects.
        To create a component again, you must save the objects as a pattern. To do this, select the objects
        and choose Library Pattern Save As. Then, attach the pattern to a component in P-CAD Library
        Executive.
        If you inadvertently explode a component, choose Edit » Undo to reverse the action.


Edit Alter Component
        Choose Edit » Alter Component to move, rotate, flip, or delete selected objects.




338                                                                                  P-CAD PCB User’s Guide
Edit Alter Component                                                              Chapter 13: Edit Commands


       With these editing processes you can alter certain component characteristics either for aesthetic
       reasons or manufacturing improvement, such as avoiding any co-location problems during
       manufacturing (e.g., through- holes and silkscreen paint). The rules/restrictions are as follows:
       •    Pads cannot be selected, and therefore cannot be edited in any way.
       •    When the Allow Single Select on All Enabled Layers check box is selected in the Mouse tab of
            the Options Preferences dialog, selections across enabled layers are done in the following
            order:
       1.   Current layer items.
       2.   Multi-layer items; i.e., all-layer keepouts, pads, vias, connections and points.
       3.   All other layer items in order.
            •   Reference designators (RefDes), Type, Value and reference points (RefPoints) cannot be
                deleted. However, you can hide the following items:
            •   To hide the RefDes, Value, or Type: Select the component and choose Edit » Properties.
                Then, clear the corresponding Visibility check box in the Pattern tab.
            •   To hide glue dot and pick and place points: Choose Options » Display and click the
                Miscellaneous tab. Then, choose the appropriate Hide option button.
            •   You cannot undo any alter actions until the operation is complete.

   Altering a Component
       To alter a component, follow these steps:
       1.   Choose Edit » Select. Then, select the component you want to edit.

            You may enable the Allow Single Select on All Enabled Layers option in the Mouse tab of the
            Options Preference dialog or by pressing the CTRL+L keys, to select a component across
            enabled layers.

       2.   Choose Edit » Alter Component. When the cursor takes the shape of a crosshair cursor, you
            are in edit mode.
       3.   Zoom in sufficiently. Change layers if necessary. You can select items individually if you are on
            the correct layer or you use a block select. The settings in Options » Selection Mask can affect
            your results here.
            Editable items typically reside on the Top Silk layer, except for Ref Points, which are not layer
            items, but this depends on how the pattern was originally created.
       4.   After you have selected individual item(s), you can then move, delete, or otherwise alter them
            (according to the restrictions mentioned previously). Right-click or press ESC to end the
            editing mode.




P-CAD PCB User’s Guide                                                                                      339
Chapter 13: Edit Commands                                                            Edit Align Components



Edit Align Components
         Components can be aligned around a selection reference point either horizontally or vertically,
         and as an option, the components can be equally spaced. If a number of components are off-grid,
         these components can be aligned back on-grid.
         •    The alignment of components is undoable.
         •    The alignment of components has full macro support.

         This command does not work on fixed components.

      Align Horizontally or Vertically
         To align a component, follow these steps:
         1.   Select the components to align. The Edit » Align Components command becomes available.
         2.   Right-click and choose Selection Point from the shortcut menu. Then, place a selection
              reference point, which is a point about which the components will be horizontally or vertically
              aligned.
         3.   Choose Edit » Align Components. The Edit Align Components dialog appears. Without
              selecting a selection reference point, the alignment and component spacing options are
              shaded.




         4.   Select either horizontal or vertical alignment.
         5.   To align the components with equal spacing, select the Space Equally check box and enter the
              Spacing value. The spacing value is the distance between the reference points of the
              components.
         6.   Press OK and the selected components will be aligned.

      Align to Grid
         To align a component to grid do the following:
         1.   Select the components. Only components can be selected for this command to be enabled.
         2.   Choose Edit » Align Components. The Edit Align Components dialog appears.


340                                                                                 P-CAD PCB User’s Guide
Edit Select All                                                                  Chapter 13: Edit Commands


         3.   Click OK and the selected components are aligned to grid. Each selected off-grid component is
              moved to the nearest grid point.


Edit Select All
         Choose Edit » Select All to selects all items on all enabled layers.


Edit Deselect All
         Choose Edit » Deselect All to cancel the selection of all items.


Edit Highlight
         Choose Edit » Highlight to highlight selected objects. To highlight an item in your design, select an
         object and then choose Edit » Highlight. The object is highlighted in the current highlight color.

         To change the highlight color, choose Options » Display. In the Colors tab, click Highlight and
         choose a new color. When you close the dialog, notice that the color change does not affect
         existing highlighted objects, unless a highlighted object was selected when you performed the
         color change.

         When you highlight objects, they retain the highlight color until they are unhighlighted. When you
         select a highlighted object, the selection color overrides the highlight color, so you won't see the
         highlight color until the items are deselected.
         You can also highlight objects using the shortcut menu. To do this, select an item or items. Then
         right-click and choose Highlight from the shortcut menu.

    DDE Hotlinks
         If PCB and P-CAD Schematic are both running, and if the DDE Hotlinks check box in the Options
         Configure dialog is selected in both programs, then component and net highlight information is
         communicated between the two programs. Highlighting a net in one program highlights the
         corresponding net in the other program; highlighting a pattern in PCB highlights the
         corresponding symbol(s) in P-CAD Schematic and vice versa.
         If you change the highlight color of an object in P-CAD PCB, the same object in P-CAD Schematic is
         automatically updated with the same highlight color.


Edit Unhighlight
         Choose Edit » Unhighlight to remove the highlighting from the selected item or items and restores
         the normal object colors.
         If PCB and P-CAD Schematic are both running, and if the DDE Hotlinks check box in the Options
         Configure dialog is selected in both programs, the highlight color is removed from the selected
         items in both programs.



P-CAD PCB User’s Guide                                                                                       341
Chapter 13: Edit Commands                                                                  Edit Unhighlight All


         You can also gain access to this command by selecting an item or items and then right-clicking to
         bring up the shortcut menu, and choosing Unhighlight.


Edit Unhighlight All
         Choose Edit » Unhighlight All to remove the highlight from all items on all layers in the design and
         to restore the normal object colors. This command applies to all highlighted objects, regardless of
         whether they are selected or not.
         If PCB and P-CAD Schematic are both running, and if the DDE Hotlinks check box in the Options
         Configure dialog is selected in both programs, the highlights are removed in both programs.


Edit Select Highlighted
         Choose Edit » Select Highlighted to select all highlighted objects. This is useful when you want to
         edit a group of highlighted objects.
         Your block selection criteria determines which highlighted objects are selected when you use this
         command. To set block selection criteria, see Options Selection Mask (page 423).
         If an item within a component is highlighted, it will not be selected when you choose the Edit »
         Select Highlighted command. For example, if you highlight two pins within a component and then
         choose Edit » Select Highlighted, neither the pins nor the component will be selected.
         If any items are selected, but not highlighted, when you choose Edit » Select Highlighted, those
         items remain selected. For example, highlight three components on a layer and then select another
         component, but do not highlight it. Now, choose Edit » Select Highlighted. P-CAD PCB selects the
         three highlighted components, and the other component remains selected.


Edit Fix
         Choose Edit » Fix to fix and unfix objects in their locations in the design. Fixed objects cannot be
         moved, rotated, flipped, cut, deleted or resized.
         When you choose Edit » Fix, the menu contains a sub menu, as shown in the figure on the left.
         Choose the appropriate command from the sub menu.

      Edit Fix
         Choose Edit » Fix to secure the selected objects in their location in the design and prevents them
         from being moved, rotated, flipped, cut, deleted or resized.

      Edit Unfix
         Choose Edit » Unfix to release the selected, fixed objects from their secured location, allowing
         them to be moved, rotated, flipped, cut, deleted or resized.




342                                                                                   P-CAD PCB User’s Guide
Edit Rooms                                                                       Chapter 13: Edit Commands


   Edit Unfix All
       Choose Edit » Unfix All to release all fixed objects in the design.


Edit Rooms
       Choose Edit » Rooms to edit rooms that exist in your design. When you choose Edit » Rooms, the
       Edit Rooms dialog appears. This dialog gives you the ability to find and select the components
       included in the selected rooms.




       When one or more Rooms are selected, the Edit Rooms dialog displays the following information:
       •     Rooms: The Rooms list contains the names of the Rooms in the design.
       •     Included Components: The Included Components lists the components that have been
             assigned to the selected Rooms. When multiple Rooms are selected, the Included
             Components list contains the components included in all of the selected Rooms. The Included
             Components list is blank when a Room with no included components is selected.
       •     Properties: Click Properties to open the Properties dialog for the Rooms in the design. In the
             Room Properties dialog you can assign components to the Included list, set the Placement Side
             and Fill Pattern and Fix the room to its location. See Room Properties (page 325) for more
             information.
       •     Highlight/Unhighlight Rooms: Click Highlight to display the selected rooms in the highlight
             color set in the Colors tab of the Options Display dialog. The Unhighlight button returns any
             highlighted rooms to its normal display color.
       •     Highlight Included/Unhighlight Included: Click Highlight Included to display the components
             included in all of the selected rooms in the highlight color set in the Colors tab of the Options
             Display dialog. The Unhighlight Included button returns the highlighted, included
             components to their normal display color.




P-CAD PCB User’s Guide                                                                                      343
Chapter 13: Edit Commands                                                                      Edit Components


         •   Set All/Clear All: Click Set All to select all rooms and the Clear All button to cancel the select of
             all rooms.


Edit Components
         Choose Edit » Components to edit the components in your design and to jump to a particular
         component. With this command, you can also highlight components and to highlight nets attached
         to a particular component.
         Choose Edit » Components to open the following dialog.




      Components List Box
         The Components list contains the names of all components in the active design. You can select
         individual or multiple components in the list. Once selected, you can highlight and unhighlight
         components and attached nets and jump to a component.

      Set All/Clear All
         If you want to select all components in the Components list, click Set All. If you don't want any
         components selected, click Clear All.

      Properties
         Click Properties to open the Component Properties dialog for the selected component or
         components. For details, see Edit Properties (page 292).

      Highlight/Unhighlight
         The Highlight button highlights one or more components selected from the Components list in the
         current highlight color set in the Colors tab of the Options Display dialog. You can use this feature



344                                                                                    P-CAD PCB User’s Guide
Edit Nets                                                                       Chapter 13: Edit Commands


        to highlight objects using different colors. When you change the highlight color of one object, it
        does not affect the highlight color of other highlighted objects, which are not selected.
        When you choose this command, the chosen components are drawn in the highlight color until
        they are unhighlighted. The selection color overrides the highlight color, so you won't see the
        highlights until the components are deselected.
        Component highlight information is communicated between the two programs when the following
        is true:
        •    Both PCB and P-CAD Schematic are running.
        •    The DDE Hotlinks check box in General tab of the Options Configure dialog is selected in both
             programs.
        Highlighting a component in PCB highlights the corresponding part in P-CAD Schematic. If you
        change the highlight color of an object in P-CAD PCB, the same object in P-CAD Schematic is
        automatically updated with the same highlight color.
        The Unhighlight button removes the highlighting from the selected components.

    Highlighting an Attached Net
        You can highlight nets, which are attached to the components selected in the Components list.
        1.   To highlight attached nets, select one or more components from the Component list (or, click
             Set All to select all components in the list),
        2.   Click Highlight Attached Nets to highlight all segments of the attached net, including lines,
             polygons, arcs, copper pours, pads and vias. The attached nets are highlighted in the highlight
             color set in the Colors tab of the Options Display dialog.
        3.   To remove a highlight, select one or more components from the Component list.
        4.   Click Unhighlight Attached Nets.

    Jumping to a Component
        To jump to a component, do the following:
        1.   Select one component from the list. The Jump button is shaded if more than one component is
             selected.
        2.   Click Jump to jump to the specified component. The specified component appears in the
             center of your workspace.


Edit Nets
        Choose Edit » Nets to show, hide, and rename nets, display net information, select net items, and
        edit net attributes. With this command you can also view and highlight nets within your design,
        view nodes attached to a particular net and to jump to a node. In addition, you can select one or
        more nodes and modify their pad or via styles and delete them from the net.




P-CAD PCB User’s Guide                                                                                       345
Chapter 13: Edit Commands                                                                          Edit Nets


       When you choose Edit » Nets, the Edit Nets dialog appears.




       The dialog contains the following options:
       •   Nets: The Nets list box contains the names of all nets in the active design. Directly beneath the
           Nets list are the command buttons, described below, that are used to set the nets you want to
           modify:
       •   Set All Nets: Selects all the nets in the Nets list box.
       •   Clear All Nets: Clears all selected nets.
       •   Set Nets By Attribute: Opens the Set Nets by Attribute dialog where you can select one or
           more attributes, which, if present in a net, result in the net being set in the Nets list.
       •   Set Net By Layer Attributes: Opens the Select Layer dialog where you can choose a specific
           layer whose attributes you want to use to set the nets.
       •   Set Nodes by Node Count: Allows you to select nets with a nod count between the range
           specified in the corresponding Min and Max edit boxes.
       •   Nodes: The Nodes list box contains the names of all nodes in the net(s) selected in the Net
           Names list box along with the Pad Styles for each node. Directly beneath the Nodes list are the
           command buttons, described below, that are used to set the nodes you want to modify:
       •   Set All Nodes: Selects all the nodes in the Nodes list.
       •   Clear All Nodes: Clears node selections.



346                                                                               P-CAD PCB User’s Guide
Edit Nets                                                                         Chapter 13: Edit Commands


        •   Jump to Node: Positions the cursor over a single, selected node, which is placed in the center
            of the workspace.
        •   Pad Properties: Opens the Pad Properties dialog when one or more nodes are selected. From
            the Pad Properties dialog, you can click the Pad Styles button to open the Options Pad Style
            dialog and make changes to the selected node(s) properties.
        •   Remove Nodes: When one or more nodes from one or more nets are selected in the Nodes
            list box, you can disconnect those nodes from the net by clicking the Remove Nodes button.

        When using the Pad Properties dialog to change the style properties for selected nodes remember
        that the changes you make are applied to all the selected nodes.

        The left side of the Edit Nets dialog contains a number of command buttons, which allow you to
        rename nets, show connections, highlight nets and modify net attributes. The buttons are:
        •   Rename: Allows you to rename the selected net. If more than one net is selected, the Rename
            button is grayed and unavailable.
        •   Info: Displays net information for the selected net. The Net Information dialog displays
            detailed information about length and characteristics of the selected net.
        •   Edit Attributes: Allows you to add and edit net attributes. When you click the Edit Attributes
            button, the Attributes dialog appears. For details, see Edit Attributes (page 350).
            You can view, add, modify, or delete a collection of net attributes. The dialog contains a two-
            column table showing the collection of net attributes. Within the collection, each attribute’s
            name and value appear in the column.
        •   Edit Net Layer Attributes: Allows you to select and edit the net attributes for a specific layer.
            When you choose Edit Net Layer Attributes, the Edit Net Layer Attributes dialog appears:




            The Edit Net Layer Attributes dialog lists the layers and indicates whether the layer has
            Attributes with an asterisk. You can select layers having a specific attribute by clicking the
            Select by Attribute button to display the Set By Attribute dialog. See Set By Attribute (page 349).
            You can also modify layer attributes by clicking the Edit Layer Attributes button. See Edit
            Attributes (page 350).


P-CAD PCB User’s Guide                                                                                          347
Chapter 13: Edit Commands                                                                           Edit Nets


       •   View » Attributes: Opens the Windows Notepad utility and displays a list of attribute names
           and values for each selected net.
       In conjunction with the Set Nets By Attributes button, the View option makes it easy to find nets
       with the same attribute value, and then view all attribute values for those nets.
       •   Show Conns: Displays the connections for the net(s) in the list box. A check in the check box
           in front of the net name means the connections are visible.
       •   Show Conns Only on Drag: Displays the connections for the net(s) selected in the list box
           when you drag a component within the net. An opaque check box in front of the net name
           means the connections are visible only when you drag a component.
       •   Hide Conns: Hides the connections for the net(s). An empty check box in front of the net
           name means the connections are invisible.
       •   Highlight: Highlights selected nets in the current highlight color chosen through the Options »
           Display command. All items of a selected net, including lines, polygons, arcs, copper pours,
           pads and vias, are highlighted by the Highlight command.
       You can use this feature to highlight objects using different colors. When you change the highlight
       color of one object, it does not affect the highlight color of other highlighted objects, which are not
       selected.
       When you choose this command, the selected nets are drawn in the highlight color until they are
       unhighlighted. The selection color overrides the highlight color, so you won't see the highlights
       until the nets are deselected.
       If PCB and P-CAD Schematic are both running, and if the DDE Hotlinks check box in the Options
       Configure dialog is checked in both applications, then net highlight information is communicated
       between the two applications. Highlighting a net in one application highlights the corresponding
       net in the other application.
       •   Unhighlight: The Unhighlight button removes the highlighting from the selected nets and
           restores the normal object colors.
           If PCB and P-CAD Schematic are both running, and if the DDE Hotlinks check box in the
           Options Configure dialog is checked in both applications, the highlights are removed from the
           selected nets in both applications.
       •   Select: Allows you to select a net or multiple nets in the design by highlighting the net names
           in the list box in the Edit Nets dialog, then clicking the Select button (the button is enabled
           only if a net is chosen). The nets in the design will highlight.
           The performance of Select Net is directly affected by the settings in Options » Selection Mask.
           For example, you could configure Options » Selection Mask to allow you to select line
           segments in a net while ignoring the vias (it ignores the inside/outside block specifications),
           allowing you to modify line widths for all segments in a net.
           This feature is useful for narrating a design (net by net) by highlighting routed copper items
           and deleting them. Be careful to disable selection of connections when unrouting nets. If a
           connection is deleted, the corresponding net is changed or destroyed.



348                                                                                P-CAD PCB User’s Guide
Edit Nets                                                                           Chapter 13: Edit Commands


    Set By Attribute
        When you click Set Nets By Attribute, the Set By Attribute dialog appears.




        If you select an attribute from the Name=Value list and click OK, you are returned to the Edit Nets
        dialog where all nets that have the selected attribute defined are highlighted in the Nets list.
        Selecting an attribute from the list allows you to find all nets containing that attribute, regardless of
        the attribute value. If you want to find nets with attributes with a specific value, select an attribute
        from the Name=Value list and click the Change Value button to display the Change Attribute Value
        dialog:




        The Change Attribute Value dialog lists all values assigned to the selected attribute and also
        includes the option to select {Any Value}. Select the desired Value and click OK to return to the Set
        By Attribute dialog.
        To set all of the attributes, click the Set All button. To clear the selected attributes, click the Clear
        All button. Choose the Clear Current Items check box if you want to remove previously selected
        items each time you modify your selection criteria.
        You can also select multiple attribute names and values in the Name=Value list. When you return to
        the Edit Nets dialog, only those nets with all of the selected attribute names and values are
        highlighted (i.e., the Nets list is cleared first.) Otherwise, those nets are added to the list of
        highlighted nets.




P-CAD PCB User’s Guide                                                                                              349
Chapter 13: Edit Commands                                                                             Edit Nets


      Set Nets By Layer Attribute
         To set nets by layer attributes, click Set Net By Layer Attribute to open the Select Layer Name dialog
         shown in the following figure:




         Select the layer whose attributes you want to used to set the nets. When you click OK, the Set By
         Attribute dialog appears and you can select the desired attributes and values. For more information
         on the Set By Attribute dialog, see Set By Attribute (page 349).

      Rename Nets
         When you highlight a single net name in the Nets list, the Rename button becomes active. Click
         Rename and the following Net Name dialog appears.




         Type in the new name and click OK to rename the net and return to the Edit Nets dialog.

      Edit Attributes
         Click Edit » Attributes to display and modify net attributes for the selected component. When you
         click this button, the following dialog appears:




350                                                                                  P-CAD PCB User’s Guide
Edit Nets                                                                        Chapter 13: Edit Commands




        You can view, add, modify, or delete a collection of net attributes. The dialog contains a two-
        column table showing the collection of net attributes. Within the collection, each attribute’s name
        and value appear in the column.
        •   Adding attributes: To add an attribute, click the Add button. The Place Attribute dialog appears,
            which is similar to the Attribute Properties dialog shown in the following figure, except that you
            can choose the desired Attribute Category and Name, and the Name and Value text boxes can
            be changed. To add a pre-defined attribute, choose the desired category and attribute name
            and enter the attribute values. To define a new attribute, choose the {user-defined} attribute
            and type the Name and Value for the attribute. Click OK, and the attribute is added to the
            table. For instructions, see Place Attribute (page 396).
        •   Viewing or changing attribute properties: To view or change an attribute’s properties, select an
            attribute from the table and click the Properties button (or double-click the attribute) to open
            the Attribute Property dialog (shown in the following figure).
        •   To delete an attribute: Highlight an attribute in the table and click Delete, or press the DEL key.
        •   Launching a reference link: When the special attribute Reference, whose value is a reference
            link, is added to the item, you can select the Reference attribute and click Launch to start an
            program or web address to display a document or web site.

        Attribute Property Dialog
        The Attribute Properties dialog appears as follows:




P-CAD PCB User’s Guide                                                                                      351
Chapter 13: Edit Commands                                                                              Edit Nets




       The following information appears in the dialog:
       •   Category list: Displays a list of all attribute categories, All, Component, Net, Clearance,
           Physical, Electrical, Placement, Manufacturing, Router, and SPECCTRA. Selecting a category
           brings up a list of predefined attributes for that category.
       •   Name list: Displays all predefined attributes for the specified category. The first entry in the list
           is User-defined. The currently-selected attribute also appears in the Name text box, unless
           User-defined is selected. In that case, the Name text box is blank so that you can enter a user-
           defined attribute name.
       •   Name Text Box: For user-defined attributes, enter a name for the attribute.

       If the dialog is accessed for an attribute that already has a name, then the Category list, Name list,
       and Name text box are filled in, but shaded. If the attribute doesn’t have a name, these options are
       enabled.

       •   Value: Use this text box to enter a value for the attribute.
       The following items appear shaded in the dialog:
       •   Visible: This check box indicates whether or not the attribute is visible.
       •   Location: This area shows the X and Y coordinates of the component’s reference point.
       •   Text Style: This area lets you select the attribute text style. Text styles appear in the Text Style
           list. To change the selected Text Style, click on the text style you want from the list. To modify
           the text style, click the Text Style button.
       •   Rotation: Shows the rotation amount if the pattern has been rotated.




352                                                                                  P-CAD PCB User’s Guide
Edit Nets                                                                         Chapter 13: Edit Commands


        •     Flipped: This check box indicates whether the pattern has been flipped or not.
        •     Justification: Under Justification are nine buttons, which allow you to change text justification
              by setting the reference point of the text string. For example, if you enable the middle button,
              the text reference point (the lower-left corner) moves to the center of the bounding rectangle.

        Attribute Description for Autorouting
        The following attributes are recognized by the autorouter. All other predefined net attributes are
        ignored for routing.


                    Attribute                                      Description
            WIDTH                     Overrides global line width settings for the selected nets. A valid
                                      line width should be entered as the value.
            VIASTYLE                  Overrides global via style settings for the selected nets. An
                                      existing via style name should be provided.
            MAXVIAS                   Defines the maximum number of vias that can be placed for this
                                      net. Valid values are 0 (no vias) - n (any specific number).
            RIPUP                     Overrides the global ripup setting for the selected nets. Valid
                                      values are No, 0 and False. All indicate that the net should not be
                                      ripped up. You can use Yes, 1, and True.
            NOAUTOROUTE               Indicates that the selected nets will not be routed. You can use
                                      Yes, 1, and True.
            AUTOROUTEWIDE             Indicates that the selected nets are scheduled as WIDE passes
                                      when you select passes manually. You can use Yes, 1, and True.


        Clearance Attributes
        Along with other predefined net attributes, which are available from the Names list, the following
        clearance attributes are available:
        •     PADTOPADCLEARANCE
        •     PADTOLINECLEARANCE
        •     PADTOVIACLEARANCE
        •     LINETOLINECLEARANCE
        •     LINETOVIACLEARANCE
        •     VIATOVIACLEARANCE
        •     CLEARANCE




P-CAD PCB User’s Guide                                                                                       353
Chapter 13: Edit Commands                                                                            Edit Nets


        In addition to the attributes listed above, a DRC error is reported whenever a line, arc or via
        touches a keepout. An error indicator is displayed in the design and an error explanation appears in
        the DRC report.

        By adding one of these attributes to a net and assigning it a value, the matching global default
        clearance is overridden for DRC. The value may have a suffix to define the units. If the units are left
        off, then the current global units are used. If the clearance value can't be converted to a valid
        number for DRC or auto routing, then the attribute is considered undefined and the corresponding
        global clearance is used.
        The last predefined attribute, CLEARANCE, defines a clearance value for all object pairs in this net.
        For example, if the net-specific clearance between every object pair in a net is the same value, then
        the CLEARANCE attribute can be used to store that value. This eliminates the need to assign the
        same value to each of the six clearance attributes.

        PCB PRO Route honors the clearances for all object pairs, but doesn’t use the clearance attributes
        defined in specific nets. The log produced by PCB PRO Route includes the clearance values used
        for all object pairs. QuickRoute clearances are set to approximately 1/2 of the routing grid. The
        SPECCTRA autorouter uses net specific clearance attributes, net class clearance attributes, and class
        to class clearance attributes.

      Pad Properties
        When a node is selected in the Nodes list, you can open the following Pad Properties dialog by
        clicking Pad Properties.




        The Pad Properties dialog is explained earlier in this chapter in Edit Nets (page 345). Remember that
        any changes made in this dialog are uniformly applied to all the selected nodes.



354                                                                                 P-CAD PCB User’s Guide
Edit Measure                                                                  Chapter 13: Edit Commands


   Info Button
       When you highlight a single net name in the Nets list, the Info button becomes active. Click Info to
       open the following Net Information dialog.




       This dialog displays detailed information about length and characteristics of the selected net. It
       only measures the X and Y distances, not depth (such as via length to another layer). Arc length is
       included (accurately) in the calculation of connection and copper lengths. The Manhattan length is
       an approximation of the final routed length of a diagonal connection.
               diagonal
                     connection




            Manhattan length
              (dashed)



Edit Measure
       Choose Edit » Measure to measure the X distance, Y distance, and total distance between two
       points. As a shortcut for choosing this command, click the Ruler button on the toolbar.
       You can measure vertical, horizontal, and diagonal distances and the results appear on the Status
       Line. The measurements are in either mils or millimeters, depending on current settings in Options
       Configure.
       Measure is a mode, meaning that if you were placing or selecting objects, when you use Measure
       you exit the mode to go into measure mode. After you have measured, you need to restart
       whatever mode you were in to resume editing.
       1.   Choose Edit » Measure or click the toolbar button.
       2.   Press and hold down the mouse button where you want to start the measurement. Then, drag
            the mouse cursor to the end point of the measurement and release the mouse button.
       3.   The measure line and the results stay until you perform another measurement of choose
            another command.

       Measurements do not snap to grid if the View » Snap to Grid command is disabled.



P-CAD PCB User’s Guide                                                                                  355
Chapter 13: Edit Commands                                                                               Edit Select



Edit Select
         Choose Edit » Select to enable the select tool (a.k.a., select mode). With this tool, you can perform
         operations on objects and items in your design. As a shortcut for choosing this command, click the
         toolbar button or press the S key.

      Select Actions
         •   single-, multiple-, block-select, or subselect
         •   move, resize, rotate, flip, copy, modify, highlight, unhighlight, and delete
         When you select an item, the Status Line information area identifies the item, either specifically
         (part reference designator) or generally (number of items selected).

      Select Commands
         The following commands are available when you are in select mode: Edit » Cut, Edit » Copy, Edit »
         Copy to File, Edit » Paste, Edit » Paste from File, Edit » Paste to Layer, Edit Select All, Edit Deselect
         All, Edit Delete, Edit Highlight, Edit Unhighlight, Edit » Copy Matrix, Modify, and Edit Explode
         Component. In addition, the Net Info and Select Net commands are available from the Select
         shortcut menu. To open the shortcut menu, select the item and then right-click. or choose Edit »
         Nets.
         Select actions are possible only if an object is selected. For example, you cannot move an arc unless
         it has been selected.
         Information included in this section only covers the mouse/cursor actions for Select.

      Selecting Objects
         To single select, click a single object; all other selected objects are deselected. You must be on the
         appropriate layer if the Allow Single Select on All Enabled Layers check box in the Options
         Preferences Mouse tab is not selected.
         To select multiple objects, first select a single object, then hold down the CTRL key and click on
         additional objects/items. The selected objects are surrounded by a selection box, which increases
         as you add items to the multiple selection. Click again on selected items (still using the CTRL key)
         to deselect them individually. To cancel the selection of all items, release the CTRL key and click
         anywhere other than one of the selected objects.
         To cancel the selection of all items, click an empty area of the workspace to cancel the selection of
         all items outside the selection region. Or, choose Edit Deselect All to cancel the selection of all
         items.
         To block select a group of items, press and hold down the left mouse button. Then, drag the cursor
         across your workspace to draw a bounding outline around a range or items. Then, release the
         mouse button to select any items that match your current block selection criteria. You can add
         objects to the block selection individually by doing a multiple select (see above paragraph). To
         cancel while dragging the selection box, right-click.




356                                                                                      P-CAD PCB User’s Guide
Edit Select                                                                     Chapter 13: Edit Commands


        If you choose the Outside Block option (with the Options » Selection Mask command), then the
        selection occurs outside of the selection block. If you have the Touching Block option enabled, a
        block selection includes everything inside and touching the selection block.
        A block selection mask can be used. Objects can be filtered or masked in a variety of ways,
        depending on how you set up the selection options. Choose the Options » Selection Mask
        command to alter or set the selection options. The selection mask can be setup to select
        components on the Top layer only or the Bottom layer only.
        To subselect, hold down the SHIFT key and click the part of the object you want to select. This
        allows you to select a single object, which is part of another object (e.g., a single pad in a
        component or an island in a copper pour).

    When Objects Overlap
        When objects overlap, it may seem difficult to select an underlying object. Continue clicking
        without moving the cursor and Select cycles through all objects underneath the cursor.
        The SPACEBAR is easier to use than the mouse in this situation (pressing the SPACEBAR twice
        equals click and release for the left mouse button). For multiple select, press and hold down the
        SHIFT key, then click the left mouse button without moving the mouse.

    Moving and Copying Objects
        To move an object, select it, then click the object and drag the cursor to the new location. Release
        to place the object.
        If you are moving multiple objects within a selection box, click anywhere in the selection box and
        drag; all the selected objects in the box follow. Release the button to place the objects.
        You can copy objects in the same manner; after you select the object(s), hold the CTRL key and left
        mouse button and drag a copy of the object(s) to where you want to place it. When copying a
        component, the RefDes (reference designator) will change in the copy, and connections will not
        copy. Any copper that is copied becomes free copper that is not associated with any net.
        To cancel a move or copy in progress, hold down the left mouse button and right-click. Then,
        release the left mouse button.

    Resizing Objects
        You can resize a selected object by clicking one of its handles, and dragging to stretch the object.
        The resize function varies for the different objects.
        For example, to resize an arc you click one of the endpoint resize handles and drag the endpoint to
        increase the sweep angle. To resize a polygon, you can grab one of its vertex handles and move it
        to change the polygon.




P-CAD PCB User’s Guide                                                                                      357
Chapter 13: Edit Commands                                                                           Edit Select


         When you move a handle that is on an edge between two vertices, a new vertex is created (allowing
         you even more reshaping). You can delete a vertex by moving it to an adjacent vertex and releasing.
         Lines, Arcs, Polygons, Copper Pours, Keepouts, Rooms and Cutouts can be resized with the select
         mode resize function.

         Rounding Corners of Polygonal Shapes
         The corners of polygonal shapes (polygons, copper pours, polygon keepouts, cutouts and planes)
         can be rounded. The rounded corner forms a filleted edge, which is the rounded intersection of
         two edges. This intersection of the two edges is created with an arc of a specified radius that is
         tangential to both edges.
         A new radius can be added by entering it directly into the Radius combo box on the Status Line or
         by choosing Options » Current Radius and entering the new values in the Current Radius dialog.
         You can select the desired radius from those in the Radius drop-down list on the Status Line. The
         radius displayed in the combo box is the current setting.
         When a polygonal shape has filleted corners additional handles appear in the shape as shown in
         the following figure:




         To change the radius of a filleted corner, grab the interior handle and drag it until you see the
         desired radius for the corner. The radius displayed in the Radius combo box on the Status Line
         affects the polygonal shape at the time of placement or during modifications. You can also access
         radius settings by double clicking the polygonal shape to display the Properties dialog where you
         can make modifications to the definition or filleted points.

      Rotating and Flipping
         Select an object. Press R to rotate 90 degrees counterclockwise. To flip the object in the X direction
         (about the Y axis), press F while the object is selected.
         SHIFT+R rotates the object by the value specified in the Rotation Increment field of the Options
         Configure dialog (default is 45 degrees).
         This function works on multiple- or block-selected objects as well.

         IMPORTANT: When you flip a pad or component, pad characteristics on Top, Top Silk, Top Paste,
         and Top Mask layers are swapped by corresponding characteristics on the Bottom, Bottom Silk, etc.
         layers. All other layers are left alone. Perform the operation with caution.

      Modifying (Edit Properties)
         To modify an object’s properties, press S as a shortcut for choosing Edit Select. Then, select an
         object in your design and choose Edit » Properties. When the Properties dialog appears, you can
         modify the object’s properties.



358                                                                                  P-CAD PCB User’s Guide
Selection Reference Point                                                        Chapter 13: Edit Commands


        You can modify the following objects: Components, Lines, Arcs, Pads, Vias, DRC error indicators,
        Copper Pours, Rooms and Text. Each entity is enabled in the same manner, but has its own
        particular Properties dialog and subsequent results. For information on modifying objects, see Edit
        Properties (page 292).

    Shortcut Menu Commands
        When you select an object and right-click, a shortcut menu appears. The shortcut menu provides
        you with access to frequently used menu commands. The options available in the shortcut menu
        depend on the object you select.


Selection Reference Point
        The selection reference point is used with all select operations, such as moving, copying, rotating,
        flipping, or pasting. However, a selection reference point is not required for these operations. If
        one is not selected, PCB uses a default reference point.
        The selection reference point is saved to the clipboard or to a block file and automatically restored
        when pasting from the Clipboard or block file. If the selection reference point is off-grid when a
        move operation begins, then it is automatically snapped to the nearest grid point and all the
        selected objects move the same relative distance.
        The selection reference point is automatically erased when all the objects are deselected.

    Placing a Selection Reference Point
        To place a selection reference point, do the following:
        1.   Select the object or objects.
        2.   Right-click and choose Selection Point from the shortcut menu.
        3.   Press and hold down the left mouse button. Then, drag the ghosted outline of the selection
             reference point into position.
             Right-click to cancel placement of the selection reference point.
             Dragging the selection reference point over pads (within a pattern or free pads), vias, or ref
             points (within a pattern or free), causes the selection reference point to snap to that object's
             center point. The shape of the selection reference point changes from a square to a diamond
             when it snaps to an objects' center point. If the selection reference point does not snap to an
             object, then it moves to the nearest grid point.
        4.   Release the left mouse button to place the selection reference point. The selection reference
             point is redrawn in the selection color.
        5.   To move a selection reference point, repeat the steps to place a selection reference point.

    Radial Placement
        1.   This function can be used for radial placement (e.g., of components). To do so, follow these
             steps:



P-CAD PCB User’s Guide                                                                                      359
Chapter 13: Edit Commands                                                       Selection Reference Point


       2.   Select the object to be radially copied.
       3.   Move the selection point to the point about which the object is to be rotated (right mouse
            down, and release the selection point).
       4.   Holding down the CTRL key, select the object, moving the mouse slightly so that the cursor
            snaps to the selection point (this copies the object), then release the mouse button and CTRL
            key.
       5.   Press R or SHIFT+R to rotate the copy.




360                                                                              P-CAD PCB User’s Guide
                                                                                    CHAPTER          14


                                                                View Commands

Using the View Commands
       Use the commands in the View menu to modify the view of the workspace to better pinpoint
       locations and objects in your design. You can also enable or disable the display of information and
       shortcut action buttons.
       For more permanent adjustments to your display characteristics, such as color display and style
       changes to objects, see Options Commands (page 423).


View Redraw
       Choose View » Redraw to redraw the view of your workspace. This command is useful when you
       make design changes and want to restore the screen or update your data. For example, you would
       choose View » Redraw to remove leftover traces or shapes that result from moving or deleting
       objects.
       To interrupt a redraw, right-click or press ESC.
       When you choose View » Redraw, the items that reside on the current layer are drawn last. For
       more information about layers, see Options Layers (page 450).
       This command also causes collocated Top and Bottom layer items to be drawn in the correct order.
       For example, if the current layer is Top, all Top layer SMT pads of an edge connector are drawn on
       top all Bottom layer SMT pads in the edge connector. Other View/Zoom commands do not
       necessarily draw collocated pads in the correct order.


View Extent
       Choose View » Extent to show the extent of all objects placed in the workspace. This command
       redraws the workspace such that all placed objects on enabled layers are visible. Any disabled
       layers are ignored.




P-CAD PCB User’s Guide                                                                                   361
Chapter 14: View Commands                                                                         View Last



View Last
       Choose View » Last to restore the previous view in your active window. For example, if you have
       the full design in view and then zoom in on an area, choose View » Last to restore the full design
       view.

       If you choose to scroll, center, or redraw the design, the View » Last command will not restore the
       view that was visible before the scroll, center, or redraw action.


View All
       Choose View » All to redraw the entire design workspace. The size of a workspace is set in the
       Options Configure dialog box.
       When you start P-CAD PCB, View All is the zoom level that appears by default. Notice that the scroll
       bars don’t appear at this zoom level.


View Center
       Choose View » Center to redraw the screen using the cursor location as the relative center point.
       When you choose View » Center, the cursor takes the shape of a magnifying glass. Move the cursor
       to a point on your design and click the workspace. The point where you click is centered on the
       screen. To cancel the zoom after the magnifying glass cursor appears, right-click or press ESC.
       As a shortcut for choosing this menu command, move the cursor to a point in your design and
       press the C key. This is quick way to pan across your workspace, if you've selected the Autopan
       check box in the Options Configure dialog. You don't need to click the mouse button, just move
       the cursor to the point you want centered and press C.
       View » Center is a temporary command. For example, if you choose Place » Pad and then choose
       View » Center, the point where you click in the workspace becomes the center of the screen. Then,
       if you click again, you will place a pad, resuming the previous tool.
       The selected point may not be in the center of the screen if you are near a workspace boundary.


View Zoom In
       Choose View » Zoom In to zoom in by the current zoom factor set in the General tab of Options
       Configure.
       When you choose this command, the pointer takes the shape of a magnifying glass. First, move the
       pointer over the area to zoom in on. Then, click the left mouse button. The cursor's position
       determines the center point of the zoomed-in area. You must choose View » Zoom In every time
       you want to zoom in on an area.
       As a shortcut, press the plus (+) key. The current cursor location determines the center point of the
       zoomed in area.



362                                                                               P-CAD PCB User’s Guide
View Zoom Out                                                               Chapter 14: View Commands



View Zoom Out
       Choose View » Zoom Out to zoom out by the current zoom factor set in the General tab of Options
       Configure.
       When you choose this command, the cursor takes the shape of a magnifying glass. First, move the
       cursor over the area to zoom out on and then click the left mouse button. You must choose View »
       Zoom Out every time you want to zoom out on your design.
       As a shortcut for choosing this command, you can press the minus (-) key. The current cursor
       location determines the center point of the zoomed out area.
       To cancel a zoom action, right-click or press the ESC key.


View Zoom Window
       Choose View » Zoom Window or click the toolbar button to zoom in on an area of the workspace.
       When you choose this command, the zoom window tool becomes active. You use this tool to draw
       a bounding outline around a selected region of your workspace.
       As a shortcut for choosing this command, press the Z key.

   Using the Zoom Window
       To zoom to an area using the zoom window tool, follow these steps:
       1.   Choose one of these methods to enable the zoom window tool:
            •   Click the Zoom Window toolbar button.
            •   Press the Z key.
            •   Choose View » Zoom Window.
            When the cursor takes the shape of a magnifying glass, you are in zoom mode.
       2.   Press and hold down the mouse button. Then, drag the cursor diagonally across the
            workspace. This draws a bounding outline around the region you select.
       3.   Release the mouse button when you've drawn your zoom window. The area enclosed within
            the bounding outline is enlarged.


View Jump Location
       Choose View » Jump Location to move the cursor to a specific X,Y coordinate on your design. As a
       shortcut for choosing this command, press the J key and enter the coordinates in the X and Y
       coordinate text boxes on the Status Line.
       If you are zoomed in, this command pans the workspace to the specified location, attempting to
       center the location. Your current zoom setting is not changed by the jump location panning




P-CAD PCB User’s Guide                                                                                  363
Chapter 14: View Commands                                                                      View Jump Text


        (except View Last will be updated). If the specified location is already visible on the screen, no
        panning is necessary.
        The units used for the location value (mil or mm) are determined by the setting in Options
        Configure. Choose Options » Configure to override the default settings.
        The location is also based on the Options Grids setting, either Absolute or Relative; e.g., if your grid
        setting is in Relative mode, then the location is a Relative coordinate. Also, you can use negative
        coordinate values when in Relative mode. For more information, see Options Grids (page 439).

      Jumping to a Location
        1.   Choose View » Jump Location. The View Jump Location dialog appears as follows:




        2.   Enter the coordinates you want to jump to in the X and Y boxes.
        3.   Click OK.


View Jump Text
        Choose View » Jump Text to search for a jump to a text character or text string in your design.
        When you choose this command, a dialog box appears in which you enter your search criteria. You
        can also enable on or both of these search options:
        •    Case Sensitive Search: Select this check box to search for matching text based on case. If you
             clear this check box, text case is ignored in the search.
        •    Search Entire Design: Select this check box to search all layers for the matching text. Clear this
             check box to search only the current layer.

      Jumping to Text
        To jump to text, follow these steps:
        1.   Choose View » Jump Text. The following dialog box appears:




        2.   Enter your search criteria in the text box.


364                                                                                  P-CAD PCB User’s Guide
View Command Toolbar                                                           Chapter 14: View Commands


       3.   To search for matching text based on the case you entered, select the Case Sensitive Search
            check box.
       4.   To search all layers or sheets for the matching text, select the Search Entire Design check box.
       5.   Click Search. If P-CAD PCB finds a match, you jump to the location of that text. If there is more
            than one match, click Next to move to the next match.
       6.   Click OK to close the View Jump Text dialog box.


View Command Toolbar
       Choose View » Command Toolbar to show or hide the Command Toolbar. This tool bar gives you
       the ability to gain access to frequently used menu commands.
       The toolbar is active and visible when View » Command Toolbar is a checked command. When no
       check mark appears next to the menu command, the toolbar is not visible. The following figure
       shows you the toolbar:




       Choosing to hide the Command Toolbar increases the space within the active window. The state of
       the toolbar is saved in the Pcb.ini file when you quit the program, and restored when you restart
       it.


View Placement Toolbar
       Choose View » Placement Toolbar to show or hide the Placement Toolbar. The toolbar gives you
       the ability to gain access to frequently used Place menu commands. The following figure shows you
       the toolbar:




       Choosing to hide the Placement Toolbar increases the space within the active window. The state of
       the toolbar is saved in the Pcb.ini file when you quit the program, and restored when you restart
       it.


View Route Toolbar
       Choose View » Route Toolbar to show or hide the route toolbar. The toolbar gives you direct
       access to frequently used routing commands, such as Route Manual, Route Interactive, and Route
       Miter.
       The following figure shows you the Route toolbar:




P-CAD PCB User’s Guide                                                                                    365
Chapter 14: View Commands                                                             View Custom Toolbar




       Choosing to hide the Placement Toolbar increases the space within the active window. The state of
       the toolbar is saved in the Pcb.ini file when you quit the program, and restored when you restart.


View Custom Toolbar
       Choose View » Custom Toolbar to either show or hide the custom toolbar. A check mark next to
       the Custom Toolbar menu item indicates that the Custom Toolbar is visible.
       If no tools have been added to the Custom Toolbar, the display of the toolbar is turned off. As soon
       as the first custom tool has been added using the Utils » Customize command in the Utils menu,
       the Custom Toolbar display is turned on. When custom tools exist in the Custom Toolbar, you can
       turn off the display of the toolbar by choosing View » Custom Toolbar.


View Prompt Line
       Choose View » Prompt Line to show or hide the Prompt Line. A check mark next to the Prompt Line
       menu item indicates that the Prompt Line is visible. The following figure shows you the Prompt
       Line.




       The Prompt Line, is a message line that provides useful instructions when a tool is selected. For
       example, while you are in one of the Place object modes, it tells you what to do next, depending on
       what action you have already taken.
       Choosing to hide the Prompt Line increases the space within the active window. The state of the
       Prompt Line is saved in the Pcb.ini file when you quit the program, and restored when you restart
       it.


View Status Line
       Choose View » Status Line to either show or hide the Status Line. A check mark next to the Status
       Line menu item indicates that the Status Line is visible. The Status Line provides status information
       and allows you to change layers and execute temporary macros.
       A check mark alongside the command indicates that the Status Line is visible. The following figure
       shows you the Status Line:




366                                                                                P-CAD PCB User’s Guide
View Snap to Grid                                                             Chapter 14: View Commands


       Choosing to hide the Status Line increases the space within the active window. The state of the
       Status Line is saved in the Pcb.ini file when you quit the program, and restored when you restart
       it.


View Snap to Grid
       Choose View » Snap to Grid to enable or disable a snappy cursor. When a check mark precedes the
       command, a snappy cursor moves from grid point to grid point. When the command is not
       checked, a free floating cursor moves freely between grid points.
       If View » Snap to Grid is disabled, P-CAD PCB uses a free-floating cursor. At times you may want to
       use a free- floating cursor to enhance your ability to select objects. For example, a line that does
       not run along true grid points may be easier to select with a free-floating cursor.
       The snappy cursor is active when View » Snap to Grid is a checked command. When no check mark
       appears, P-CAD PCB uses a free-floating cursor.

       The View » Snap to Grid command does not support the DataTips feature. When View » Snap to
       Grid is a checked command, the DataTips feature is temporarily disabled.

       The state of the View » Snap to Grid command (ON or OFF) is saved in the Pcb.ini file when you
       quit the program, and restored when you restart it.




P-CAD PCB User’s Guide                                                                                   367
                                                                                        CHAPTER         15


                                                                Place Commands

Using the Place Commands
       Use the commands in the Place menu to place various objects in a design. When you choose a
       Place command and click the workspace, one of the following occurs:
       •    P-CAD places an object at the cursor location (e.g., Place Pad).
       •    You can begin placing a segment (e.g., Place Line, Place Polygon).
       •    A dialog appears so you can define specific criteria for the type of object you want to place
            (e.g., Place » Component).
       The Placement Toolbar provides shortcuts to the Place commands:




  Click this button   To choose this command        Click this button     To choose this command
                      Place Component                                    Place Copper Pour

                      Place Connection                                   Place Cutout

                      Place Pad                                          Place Keepout

                      Place Via                                          Place Plane

                      Place Line                                         Place Room

                      Place Arc                                          Place Text




P-CAD PCB User’s Guide                                                                                      369
Chapter 15: Place Commands                                                                    Place Autoplace



  Click this button   To choose this command        Click this button     To choose this command
                      Place Polygon                                      Place Attribute

                      Place Point                                        Place Field

                                                                         Place Dimension


       To learn more about each command, see the appropriate section in this chapter.


Place Autoplace
       Choose Place » Autoplace to exchange placement data between P-CAD PCB and SPECCTRA. This
       includes the following items:
       •    Predefined SPECCTRA placement attributes that you can assign to components.
       •    P-CAD-to-SPECCTRA design file transfer program that interprets SPECCTRA placement
            attributes and component geometries, and automatically translates them to SPECCTRA as
            component placement rules, properties, and component image outlines.
       •    Autoplacement graphical user interface, which automates the autoplacement process
            sequence.
       •    SPECCTRA-to-P-CAD design file transfer program that accepts any of three SPECCTRA-
            generated file types: SPECCTRA session files (placement plus routing information), placement
            files (component placement information only), and/or routes files (routing information only).
       The SPECCTRA placement attributes appear in the following table:


        SPECCTRA Placement Attribute        Data Type                           Effect
       COMPONENT_HEIGHT                    real            Component height --- room placement
                                                           constraint, or “-1”
       LOCK_POSITION                       boolean         Locks a component in its current position
                                                           “n[*]”, f[*]”, “off”, or “0” (case insensitive)
                                                           equate to “FALSE”. Otherwise, “TRUE”.
       OPPOSITE_SIDE                       boolean         Permit/prohibit back-to-back placement
                                                           of components.
       PERMIT_ORIENT_FRONT                 string          Restrict orientation of front side
                                                           components --- “horiz[ontal]”,
                                                           “vert[ical]”, “0 90 180 270” (space-
                                                           separated list of angles in multiples of 90),
                                                           or “-1”



370                                                                                 P-CAD PCB User’s Guide
Place Autoplace                                                        Chapter 15: Place Commands



        SPECCTRA Placement Attribute    Data Type                       Effect
       PERMIT_ORIENT_BACK              string       Restrict orientation of back side
                                                    components --- “horiz[ontal]”,
                                                    “vert[ical]”, “0 90 180 270” (space-
                                                    separated list of angles in multiples of 90),
                                                    or “-1”
       PERMIT_SIDE                     string       Side restriction --- “top”, “front”, “upper”,
                                                    “bottom”, “back”, or “both”
       PROPERTY_POWER_DIS              real         Component power dissipation property,
                                                    or “-1”
       PROPERTY_TYPE                   string       Component type property --- “large”,
                                                    “small”, “cap[acitor]”, or “dis[crete]”.
       SPACE_PIN_PIN_FRONT             real         Min spacing between pin components on
                                                    front side, or “-1”
       SPACE_PIN_PIN_BACK              real         Min spacing between pin components on
                                                    back side, or “-1”
       SPACE_PIN_SMD_FRONT             real         Min spacing of pin to smd components
                                                    on front side, or “-1”
       SPACE_PIN_SMD_BACK              real         Min spacing of pin to smd components
                                                    on back side, or “-1”
       SPACE_PIN_AREA_FRONT            real         Min spacing of pin components to edges
                                                    on front side, or “-1”
       SPACE_PIN_AREA_BACK             real         Min spacing of pin components to edges
                                                    on back side, or “-1”
       SPACE_SMD_SMD_FRONT             real         Min spacing between smd components
                                                    on front side, or “-1”
       SPACE_SMD_SMD_BACK              real         Min spacing between smd components
                                                    on back side, or “-1”
       SPACE_SMD_AREA_FRONT            real         Min spacing of smd components to edges
                                                    on front side, or “-1”
       SPACE_SMD_AREA_BACK             real         Min spacing of smd components to edges
                                                    on back side, or “-1”
       SPACE_AREA_AREA_FRONT           real         Min edge to edge component spacing on
                                                    front side, or “-1”
       SPACE_AREA_AREA_BACK            real         Min edge to edge component spacing on
                                                    back side, or “-1”




P-CAD PCB User’s Guide                                                                              371
Chapter 15: Place Commands                                                                 Place Autoplace


        To keep SPECCTRA attributes consistent and to distinguish between placement and routing
        attributes, the existing SPECCTRA attributes category is now named “SPECCTRA Routing”
        attributes. Using the SPECCTRA placement attributes, you can export P-CAD PCB components to
        SPECCTRA for placement, then read the placed components back into P-CAD PCB.
        In cases where you specify component attributes and SPECCTRA placement attributes of the same
        name, the SPECCTRA placement attribute has priority. For example, if you specify the P-CAD
        placement attribute ComponentHeight and the SPECCTRA placement attribute
        COMPONENT_HEIGHT to the same component, P- CAD PCB translates the SPECCTRA placement
        attribute COMPONENT_HEIGHT to the SPECCTRA Router.
        The default component image outline is a rectangular boundary defined by the centers of the lines
        and arcs and the extents of polygons on all layers of a P-CAD PCB pattern. SPECCTRA augments this
        bounding rectangle with its default bounding box surrounding the component pads. The
        combination produces an outline that is representative of the pattern’s size and shape. SPECCTRA
        uses this image outline to determine intercomponent spacing during placement.
        Optionally, to further control the component outline, you can modify the pattern by adding a
        polygon and the P- CAD PackageOutlineLayer attribute to produce a specific component image
        outline in SPECCTRA. Attach a PackageOutlineLayer attribute to the P-CAD PCB pattern and set its
        value to a valid nonsignal layer name. Then, create a single polygon on the specified layer that
        defines the component outline and encloses all bounding boxes of the component’s pads. Include
        this polygon in the pattern’s geometry. The translator will use this polygon to produce the
        SPECCTRA image boundary for that component pattern. If any of the conditions listed above are
        not met, the translator reverts back to its default behavior.
        You can pass fixed components into the AutoPlace tool and they will be recognized as fixed by the
        SPECCTRA router. However, you must fix the component in P-CAD PCB to make sure that it
        remains fixed if the component is translated from SPECCTRA back to P-CAD PCB.

      Performing Autoplacement
        To perform auto placement in P-CAD PCB, follow these steps.
        1.   Choose Place » Autoplace. The following Place Autoplacement dialog appears:




372                                                                              P-CAD PCB User’s Guide
Place Autoplace                                                                Chapter 15: Place Commands




       2.   Click DO Wizard to create the DO file. The SPECCTRA DO File Wizard dialog appears.
       3.   Create the DO file, either manually or by clicking Auto Create DO File. P-CAD PCB either
            generates the DO file from the commands you entered, or creates a default DO file.
       4.   Click OK. P-CAD PCB returns you to the Place Autoplacement dialog.
       5.   Click Start. P-CAD PCB begins translating your design to the SPECCTRA file format. At this
            point, the program Accl2spw.exe transfers all design, routing, and placement rules and
            attributes to SPECCTRA as AutoRoute and AutoPlace rules and component properties.
       6.   Once done, the system launches SPECCTRA. SPECCTRA executes the DO file you specified in
            P- CAD PCB. At this point, you're ready to adjust component placement in SPECCTRA.
            Make any design and placement changes in SPECCTRA.
       7.   After making any design placement adjustments in SPECCTRA, remember to rewrite the
            session file or placement file using the filename that was originally written from the DO file.
            This safely captures the results of any interactive work that you performed in SPECCTRA.
       8.   When you are satisfied with your results, quit SPECCTRA.
       When you quit SPECCTRA, the system automatically merges the session or placement file
       (referenced in the DO file) with the original P-CAD PCB design (in ASCII form), to create a new
       design. The system then returns you to P-CAD PCB and loads the new design.




P-CAD PCB User’s Guide                                                                                        373
Chapter 15: Place Commands                                                               Place Component



Place Component
        Choose Place » Component or click the toolbar button to place named components at a specified
        location. You can place a component only when the following is true:
        •    Both the component and its corresponding pattern has been created and assigned to a library.
        •    The library containing that component is open.

        P-CAD PCB (6/400) designs are restricted to a maximum of 400 components.

      Placing a Component
        To place a component, do the following:
        1.   Choose Place » Component or click the toolbar button.
        2.   Click the workspace to open the Place Component dialog.
        3.   Click Browse to expand the dialog and view a picture of the part in the browse window, as
             shown in the following figure:




        4.   Select a component from the Component Name list. This list shows all of the components in
             the current library.

             If the component you want does not appear in the Component Name list, click the Library »
             Setup button to select the library that contains the component.

        5.   Type a reference designator in the RefDes box. If you leave this box blank, P-CAD PCB uses the
             RefDes prefix assigned to the component at component creation time by default. If you do not
             assign a number, P-CAD PCB automatically assigns the next available number.


374                                                                               P-CAD PCB User’s Guide
Place Component                                                                 Chapter 15: Place Commands


       6.   (Optional) Modify the value in the Value box. (e.g., electrical values for resistors and capacitors;
            typically you will leave this box blank for logical parts). The value you enter here overrides the
            value from the library component.

            When a component has a Value attribute, the value displays in the Value box based on the
            following rules: If the symbol has a Value attribute, but no component Value attribute, the
            symbol’s Value attribute value is used. If the component has a Value attribute, the
            component’s Value attribute value will take precedence and be used even if the symbol has a
            Value attribute.

       7.   Select the desired Pattern Graphic from the drop down list, or enable the Auto Swap Graphics
            check box. If this check box is enabled, and the component has alternate pattern graphics,
            then as you rotate and flip the component its pattern graphic will automatically change to the
            pattern graphic defined in the P-CAD Library Executive.
       8.   Click OK to close the Place Component dialog. In the workspace, the cursor takes the shape of
            a crosshair cursor.
       9.   Move the cursor to the location where you want to place the component. Then, choose one of
            the following methods to place the component:
            •   Hold down the left mouse and drag the ghosted outline of the component into position.
                Then, release the mouse button to place it.
            •   Click the workspace to place the component.

            Notice that before you place a component, the RefDes appears in the Status Line. To increment
            the component’s RefDes, press D before you click the workspace or while the cursor is still a
            crosshair. To decrement it, press SHIFT+D. To cancel component placement, right-click when
            the ghosted component outline is visible.

       10. Continue placing the same component by clicking in selected locations. Each component you
           place has a unique reference designator. In addition, each component will have displayed its
           type, name, and any other attributes previously specified (from the Place » Attribute function).
       11. If you want to place a different type of component, right-click or press ESC to exit the place
           mode for that particular component. As you are still in placement mode, you can click in the
           workspace to display the dialog and select another component to place.

   Rotating or Flipping a Component
       To rotate or flip a component after placement, select the component and choose one of the
       following methods:
       •    Press F to flip the component.
       •    Press R to rotate the object by 90-degrees.
       •    Press SHIFT+R to rotate the object by the current rotation increment set in Options Configure.
       To rotate or flip a component before you place it, hold down the left mouse button. When the
       ghosted outline of the component appears, press F, R, or SHIFT+R. When you use this method, any


P-CAD PCB User’s Guide                                                                                      375
Chapter 15: Place Commands                                                                   Place Component


         rotation applies to the next component you press R. For example, if you rotate a component 25-
         degrees before you place it, the next component is placed at the same 25-degree angle without any
         rotation. This lets you place multiple components at the same angle.
         If you right-click to end the temporary placement mode and then left-click to place another
         component, the rotation memory will not apply; the rotation memory applies only to the temporary
         placement mode.
         If a component has a test point, the point’s side of board property changes when you flip the
         component. For example, a test point on the Top side of the board switches to the Bottom when
         flipped. Likewise, a point on the Top Silk layer switches to the Bottom Silk layer when flipped. To
         learn more about test points see Test Points (page 376) and Placing Test Points (page 386).
         Placed components with connections can be rotated without attempting to reconnect if you hold
         down the left mouse button during the rotation. Only after the left mouse button is released will
         the connections be updated.

         Components of the same type can be placed only if they have the same pin mapping (i.e., pin
         designator to pin name to pad number). If you place the same component from different libraries,
         the first instance of the component type establishes the standard pin mapping for that type of
         component. Any components of that type placed subsequently have to conform to the pin logic of
         the first or they will be unplaceable.

         When you place components that include vias, pads, and text that are of styles that have the same
         names but different data than those in the current design, the incoming style names are bracketed
         to indicate the style conflict. The bracketed style names are added to the list of available styles in
         the current design. For object style information, see Edit Properties (page 292), Options Pad Style
         (page 472) and Options Text Style (page 482).

      Attributes
         If two parts of a component have the same attribute names, but different values, the first part’s
         attributes are preserved, and the second’s is overwritten.
         Attributes added to the symbol or the pattern in the design are not accessible from the Attributes
         dialog in P-CAD Library Executive.

      Jumper Pads
         Components with jumper pads are handled in a special way. Any time this command adds a node
         to a net, P-CAD PCB checks to see if the node is a jumper pad. If it is, the component behaves as if
         all of the pads marked as being jumpered together are connected. In PCB, if necessary, blue line
         connections may be added to the other pads.

      Test Points
         When test points are built into a component, the points typically appear in your design when you
         place that component.




376                                                                                   P-CAD PCB User’s Guide
Place Connection                                                                  Chapter 15: Place Commands


       If you flip a component with test points, P-CAD PCB changes the side of board property for that test
       point. For example, if a test point is on the Top side of the board, it will be on the Bottom after you
       flip the component.
       In addition, if a test point is on a predefined layer, the layer is affected. For example, if a point is on
       the Top Silk, it will be on the Bottom Silk when flipped. However, if a point is on a user-defined
       layer when flipped, it remains on that layer.
       You can place test points on non-signal layers. If you attempt to place a test point on a signal or
       plane layer, a message notifies you that test points cannot be placed on signal or plane layers.


Place Connection
       Choose Place » Connection to place a connection between pads and vias. To place a connection to
       a via, either the via or its connecting pad or via must be part of an existing net. Connections do not
       belong to a particular layer and do not have a user-definable width.
       To place a connection, you must have already placed free pads or vias and/or component pads. The
       connected pads become nodes of a net.
       You need to change layers to place connections between surface pads or vias that are on different
       layers. For example, switch the current layer to Top, begin the connection on one of the Top layer
       pads, change layers to the Bottom and complete the connection to a bottom layer pad.

   Placing a Connection
       To place a connection, do the following:
       1.   Choose Place » Connection. The pad or via must have a non-zero definition on the layer you
            are on.
       2.   Click over a pad or via, drag to another pad or via, and release. To place a connection to a via,
            either the via or its connecting pad or via must be part of an existing net.
            •   If you place a connection between nodes that do not share a node with an existing net,
                you are prompted for a new net name. Click OK for the default net name or enter a new
                net name.
            •   If you place a connection between pads or vias belonging to two different nets, you are
                prompted for a name for the merged net.




       3.   You can continue placing connections in the same manner, from pad to pad (node to node),
            from pad to via, or from via to via.




P-CAD PCB User’s Guide                                                                                          377
Chapter 15: Place Commands                                                                         Place Pad


        You can place connections to free pads, but the free pads will not appear in the netlist when you
        generate a netlist by choosing Utils » Generate Netlist.
        You can place connections to free vias, but the connecting pad or via must be a part of an existing
        net. Like free pads, vias do not appear in the netlist.
        Components can have unused pads that are electrically inactive (i.e., they have no designator). You
        cannot place a connection to an unused component pad.

      Merging Nets
        If you attempt to place a connection between two nets (i.e., if you attempt to merge nets) the
        following Merge Nets dialog appears. Use this dialog to choose to name the merged net one of the
        two net names that are being merged, or give it a new name.




        To route the connections, choose Route » Manual or Route » Interactive. For details, see Route
        Commands (page 405). To optimize the connections for minimum length, choose Utils » Optimize
        Nets. For details, see Utils Optimize Nets (page 525).

      Jumper Pads
        Any time a connection adds a node to a net, P-CAD PCB checks to see if the node is a jumper pad.
        If it is, the component behaves as if all of the pads marked as being jumpered together are
        connected.


Place Pad
        Choose Place » Pad to place a pad of the current style. Pads do not belong to a particular layer. To
        place a surface pad, for example, the current style must be set up to have a shape defined only on a
        surface layer.
        Choose Options » Pad Style to define new pad styles and to set the current pad style. For details,
        see Options Pad Style (page 472). Choose Edit » Properties to open the Pad Properties dialog, in
        which you change pad styles or pad numbers of already placed pads. For details, see Pad Properties
        (page 307).

      Placing a Pad
        To place a pad, do the following:




378                                                                                P-CAD PCB User’s Guide
Place Pad                                                                    Chapter 15: Place Commands


       1.   Choose Place » Pad or click the toolbar button.
       2.   Move the cursor to where you want to place the pad. Then, choose one of the following
            methods to place the pad:
            •   Hold down the left mouse button. Then, drag the ghosted outline of the pad into position
                and release the mouse button to place the pad.
            •   Click the mouse to place the pad.

   Rotating or Flipping a Pad
       To rotate or flip a pad, select a pad and choose one of the following methods:
       •    Press F to flip the pad.
       •    Press R to rotate the pad 90 degrees
       •    Press SHIFT+R rotates the pad by the rotation increment set in Options Configure.
       You can rotate a pad before you place it, and whatever angle is the result of the rotation will apply
       to the next pad you place. You must keep the button down while you are rotating it (before the pad
       is permanently placed). For example, you are placing a pad and you rotate it 25-degrees before you
       finish it (SHIFT+R, with 25-degrees set in Options Configure). Then you place another pad; it will be
       placed at the same 25-degree angle without any rotation action. If you decide to rotate the second
       pad, it will increment 25-degrees more, resulting in a 50-degree angle. Therefore, you can place
       multiple pads at the same angle but only have to perform the rotation action on the first pad.
       If you are rotating or flipping a placed pad that has associated connections, you can prevent the
       connections being changed each time you rotate or flip by pressing the left mouse button while
       changing the pad’s orientation.
       To flip a pad as you are placing it, press F while the pad is ghosted before final placement. When
       you flip a pad, the hole range does not flip with it.
       Pads and vias share the same rotation memory. In other words, if you place and rotate a pad at 90
       degrees, then immediately place a via, that via will be placed at a 90-degree angle. This rotation
       memory derives only from rotation action during placement, not from select-and-rotate actions
       that take place after object placement.

   Renumbering Pads
       If you want to number the pads you placed, you must enable the Select tool (choose Edit Select)
       and then choose Utils » Renumber. A dialog appears where you can choose Pad Num as the type,
       then specify the start value and increment value. Then you can click on each pad manually and they
       will be numbered in sequence. You can also use the Pad Properties command to assign a pad
       number. For more information, see Utils Renumber (page 497) and Pad Properties (page 307).

   Modifying Pad Styles
       If you want to place pads of a particular style, choose Options » Pad Style to modify the current
       style. New styles can also be added with this command. You can change the style of an existing (i.e.,



P-CAD PCB User’s Guide                                                                                      379
Chapter 15: Place Commands                                                                             Place Via


         placed) pad by opening the Pad Properties dialog. To open the dialog, select the pad, then right-
         click and choose Properties from the shortcut menu.


Place Via
         Choose Place » Via to place a via of the current style. Vias do not belong to a particular layer. To
         place a buried via, for example, the current style must be set up to have a shape defined only on
         particular layers.
         Choose Options Via Style to define new via styles and to set the current via style. To change the
         style of a via that has been placed, select the via, then right-click and choose the Properties
         command from the shortcut menu. The Via Properties dialog appears. For information on this
         dialog, see Via Properties (page 311).
         Vias are almost identical to pads in the way that they are placed, rotated, flipped, and edited. See
         Place Pad (page 378) for detailed information.


Place Line
         Choose Place » Line to place a line (or a series of line segments) of the current line width on the
         current layer. To change the current line width, choose Options » Current Line.

      Placing a Line
         To place a line, do the following:
         1.   Choose Place » Line or click toolbar button.
              While you draw a line or segments, the cursor is displayed as a crosshair shape. When you
              finish the line segments, the cursor returns to its normal shape.
         2.   With the cursor in the workspace, press and hold down the mouse button at the starting point,
              then drag the line to its second point and release to place the line. You can continue with
              connected segments in the same manner.
              You can use ALT+left mouse button instead so you don't have to hold the button down while
              dragging line segments.
              While you are drawing a line or segments, the cursor appears as a crosshair shape. When you
              finish the line or segments, the cursor returns to its typical shape.
         3.   To finish the line or line segments, right-click or press ESC. Then you can begin another line
              beginning at a new location.
         You will remain in Place Line mode until you enable another mode.

      Status Line
         The Status Line information area displays line measurements for delta X and delta Y while you are
         dragging a line segment. When the line segment is finished, the total length measurement of the




380                                                                                   P-CAD PCB User’s Guide
Place Line                                                                     Chapter 15: Place Commands


        segment(s) appears, each subsequent segment being included in the total measurement, and each
        segment with a delta X and delta Y length while it is being dragged.




        When the line is finally placed, all measurements on the Status Line disappear.

    Orthogonal Modes (for Line Segments)
        There are orthogonal modes that you can use while placing lines. While the Place » Line tool is
        enabled and you are dragging a line segment, you can press hold down the left mouse button and
        press the O key to cycle through the enabled orthogonal modes.
        Orthogonal modes use lines that are horizontal, vertical, and at 45-degree angles. The available
        orthogonal modes are provided as mode pairs. Press the O key to cycle through the mode pairs
        and the F key to switch between the current mode pair. You can enable or disable the orthogonal
        modes in Options Configure.
        For placing lines, only the linear orthogonal modes are available (no arcs).

        90/90 Line-Line
        Both lines are either horizontal or vertical (displayed perpendicular to each other). For long, the
        first segment is always longer than the second). For short, the first segment is shorter. You can
        switch between the two modes by pressing the F key.




        45/90 Line-Line
        You can switch between the two modes by pressing the F key. The first mode makes the first
        segment displayed at a 45-degree angle and the second segment is either horizontal or vertical. The
        second mode makes the first segment either horizontal or vertical and the second segment is
        displayed at a 45-degree angle.




        Press the BACKSPACE key to unwind any previous segments, unless you have finished the line or
        segments, in which case the Undo key (or toolbar button) will Undo the whole series of finished
        segments.




P-CAD PCB User’s Guide                                                                                        381
Chapter 15: Place Commands                                                                             Place Arc



Place Arc
         Choose Place » Arc to place an arc or circle of the current line width on the current layer. With this
         command, you can create arcs of varying length and radius and circles of varying radius.
         To change the current arc width (line width of the arc), choose Options » Current Line. For more
         information, see Options Current Line (page 457).
         Arcs are partial circles. Arcs and circles are constructed counter-clockwise; the click (down) and
         release (up) define the start and end point of the arc, therefore a stationary click/release comes full
         circle and defines a circle. In this case, the second click and drag moves the center point away from
         the defined point on the circumference.

      Placing an Arc
         To place an arc, do the following:
         1.   Choose Place » Arc or the arc icon on the toolbar. Move the cursor to the starting point of the
              arc.
              While you draw an arc, the cursor appears as a crosshair shape. When you finish the arc, the
              cursor returns to its normal shape.
         2.   Click and drag to the end point of the arc. Release and the start and end points are established
              as a 180-degree arc.
              The arc sweeps counterclockwise as you place it. (e.g., left-to-right the arc sweeps up; right-to-
              left the arc sweeps down, etc.) If you click and release without dragging (i.e., the start and end
              points are the same), you create a circle.
         3.   After the start and end points are established, click and drag the cursor to define or alter the
              center point, thereby increasing or decreasing the sweep angle and radius of the arc.

              You can flip the arc (swapping the end points) by pressing F while the arc is still unfinished.

         To cancel ghosting of an arc, right-click.

      Move, Rotate, Flip, Change
         •    To move, resize, rotate, flip or perform other types of changes to the arc (after it is permanently
              placed), use the Edit Select mode.
         •    To rotate or flip an arc, select it, and the hold down the left mouse button and press R to rotate
              or F to flip.
         •    For rotation, the default increment rotation is 90 degrees, which is activated by the R key. You
              can set a different rotation increment with Options Configure. For instructions, Options
              Configure (page 429). To rotate an arc the increment set in Options Configure, press SHIFT+R.
         •    To move the arc, click within the selection box (not on the handles) and drag the arc.




382                                                                                   P-CAD PCB User’s Guide
Place Polygon                                                                   Chapter 15: Place Commands


       •    To resize an arc, click and move the center handle to change the radius or move the start or
            end point to change the sweep angle.


Place Polygon
       Choose Place » Polygon to place a solid, filled polygon on the current layer.

   Placing a Polygon
       To place a polygon, do the following:
       1.   Choose Place » Polygon or click the Polygon button on the toolbar. If you want to place a
            polygon with square corners, select the (None) setting in the Radius combo box on the Status
            Line. Select a radius of your choice from the drop-down list or enter the desired value to create
            a polygon with rounded corners.
            While you draw a polygon, the cursor appears as a crosshair shape. When you finish the
            polygon, the cursor returns to its normal shape.
       2.   Put the cursor at the starting point of where you want your polygon. Hold down the left mouse
            button and drag the cursor to the second point. Then, release the mouse button.
       3.   Drag the cursor to a third point to draw a triangle. Any subsequent polygon points are
            connected by a line to the first point you selected, e.g., the fourth point of a polygon is
            connected to the first point automatically.

            Complex polygons are not allowed. A complex polygon is a self-intersecting or self-crossing
            polygon. Polygon sides can touch each other but not cross each other.

       4.   When you have established all your points in creating the polygon, right-click or press ESC to
            finish and fill the polygon.

   Draft or Outline Display Mode
       Polygons can be drawn and printed as outlines by choosing one of these options:
       •    To draw polygons in outline form, choose Options » Display. Then, click the Miscellaneous tab
            and select the Draft Mode check box.
       •    To print polygons in outline form, choose File » Print. Then, click the Setup Print Jobs button.
            In the dialog that appears, select the Draft check box in the Display Options frame.

   Rotating or Flipping a Polygon
       You can rotate or flip a polygon after you have placed it. Select the polygon and press R to rotate or
       F to flip while the polygon is selected.
       Press R to rotate the polygon by 90-degrees. You can press SHIFT+R to rotate the polygon by the
       rotation increment set in Options Configure. For information, see Options Configure (page 429).




P-CAD PCB User’s Guide                                                                                     383
Chapter 15: Place Commands                                                                          Place Point


      Altering the Shape of a Polygon
         You can alter the shape of a placed polygon (move, add, delete vertices and round the corners) by
         selecting the polygon, then clicking and dragging one of the handles.
         When you move one of the handles that lies between two vertices, a new vertex is created. To
         delete a vertex, grab its handle and move it to an adjacent vertex and release. A polygon can have
         square or rounded corners.
         To alter a polygon’s corners follow these steps:
         1.   Set the desired radius in the Radius combo box on the Status Line by selecting an existing
              radius or entering a new radius. You may also add a radius directly in the combo box or choose
              Options » Current Radius to open the Options Current Radius dialog where you can add and
              delete radius values. Choose the (None) radius setting if the polygon should have square
              corners.
         2.   Select the Polygon to be modified.
         3.   Enable the display of the fillet handles by choosing Edit » Properties or by double-clicking the
              shape and selecting the Show Fillet Handles check box in the Properties dialog.
         4.   Press and hold down the left mouse button to grab the fillet handle in the interior of the
              polygon.
         5.   Drag the handle to the location where the corner radius is the one you want. Release the
              mouse button to place it.


Place Point
         Choose Place » Point or click the toolbar button to place one of the following point types in a
         design:


                          Reference Point. When you place a reference point on an object, the object
                          moves with the cursor at that point. Objects also flip and rotate about this
                          point.
                          Glue Dot. Glue dots, or glue points, hold components in place until they are
                          soldered during manufacturing. A glue dot can be placed in a pattern before
                          saving the pattern in a library.
                          Pick and Place. Pick and place points direct the pick and place mechanism in
                          manufacturing. This mechanism, also called auto insert, picks up the
                          component and places it on a board.




384                                                                                  P-CAD PCB User’s Guide
Place Point                                                                      Chapter 15: Place Commands



                          Test Point. Test points can be placed only on non- signal layers. With test
                          points, you can evaluate the nets in a design for electrical connectivity.
                          Unlike other points (e.g., reference points, glue dots, etc.), you can assign
                          specific properties to a test point when you place one in your design
                          To learn more about test points, see Test Points (page 376) and Placing Test
                          Points (page 386).


        The following procedures show you how to place a point, set point size, and also how to show or
        hide points in your design.

    Placing Points
        To place a point, follow these steps:
        1.    Choose Place » Point or click the toolbar button.
        2.    Click the design workspace to open the following dialog:




        3.    In the Points frame, choose one of the following options buttons:
              •   RefPoint
              •   Glue Point
              •   Pick and Place
              •   Test Point

              If you choose the Test Point option button, you must also choose the appropriate options in
              the Test Point Details frame. To learn about these options, see Placing Test Points (page 386).




P-CAD PCB User’s Guide                                                                                          385
Chapter 15: Place Commands                                                                          Place Point


         4.   In the Place Point dialog, click OK. You are now in placement mode.
         5.   In your workspace, click where you want to place the point. If you want to place another point,
              click another location.
         6.   When you no longer want to place points of that type, right-click or press ESC The place point
              tool remains enabled until you select another tool.
         7.   To move a point, select it and then drag it to a new location.


      Placing Test Points
         When you choose the Test Point option button in the Points frame of the Place Point dialog, the
         controls in the Test Point Details frame become available.




         The following list describes each option:
         •    Top: Choose this option button to place the point on the top side of the board. When you
              choose this option, the point is tested from the Top of the board.
         •    Bottom: Choose this option button to place the point on the bottom side of the board. When
              you choose this option, the point is tested from the Bottom of the board.
         •    Fixed: Select this check box to make the test point a fixed object. Clear this check box to make
              the point a moveable object.
         •    Snap to Center: Select this check box to snap the test point to the center of a pad or via. Clear
              this check box to place a test point anywhere on a pad or via.

         You can place test points on non-signal layers.




386                                                                                   P-CAD PCB User’s Guide
Place Copper Pour                                                            Chapter 15: Place Commands


       As with other points, you can rotate and flip test points. However, when you flip a test point, the
       side of board property for that point changes. For example, a point on Top switches to the Bottom
       when flipped.
       In addition, the layer on which the point appears may also change when you flip a point. If a point
       is on the Top Silk layer, it switches to the Bottom Silk when flipped.
       For more information, see Test Points (page 376).

   Showing or Hiding Points
       In P-CAD PCB, you can show or hide points. To do this, follow these steps:
       1.   Choose Options » Display. The Options Display dialog appears.
       2.   Click the Miscellaneous tab.
       3.   Choose the Show or Hide option button in each of these frames:
            •   DRC Errors
            •   Glue Points
            •   Pick and Place

       You can also choose to include or exclude these items from your printer output (File Print) by
       specifying the items in the Setup Print Jobs dialog.



Place Copper Pour
       A copper pour is a polygonal shape that you can place on any layer of a PCB design. To place a
       copper pour in a design, you use the following two-step process:
       •    First, you place the pour outline.
       •    Next, you flood the pour outline with a copper fill.
       The following instructions show you how to place a copper pour.

   Placing a Copper Pour
       When you place a copper pour, you first draw the pour outline. Then, you flood the pour outline
       with a copper fill.

       Drawing a Pour Outline
       To draw a copper pour outline, follow these steps:
       1.   Choose Place » Copper Pour or click the toolbar button.
       2.   Click where you want to place the copper pour.




P-CAD PCB User’s Guide                                                                                   387
Chapter 15: Place Commands                                                               Place Copper Pour


       3.   Drag the cursor to another point and click. Drag the cursor to another point and click at each
            corner of the polygon you want to draw.

            Complex copper pour polygons are not allowed. A complex polygon is self-intersecting or self-
            crossing.

       4.   When you’ve finished drawing a polygonal shape, right-click to stop placing the pour outline.
            You remain in placement mode, so you can draw another copper pour outline.
       5.   If you don’t want to place another pour outline, choose another command to disable the Place
            » Copper Pour command.

       Filling a Copper Pour
       After you draw a pour outline, you flood the copper pour with a copper fill. To do this, follow these
       steps:
       1.   Select one or more copper pours using one of the following methods:
            •   To select one copper pour, click within the boundary of the pour outline.
            •   To block select a group of copper pours, set the appropriate block selection criteria in the
                Options Selection Mask dialog.
            •   To select a group of copper pours, hold down the CTRL key and click each copper pour
                you want to select.
       2.   Select the copper pours you want to fill and use one of the following methods to open the
            Copper Pour Properties dialog:
       3.   Choose Edit » Properties.
       4.   Right-click and choose Properties from the shortcut menu.




388                                                                               P-CAD PCB User’s Guide
Place Cutout                                                                  Chapter 15: Place Commands


       5.   In the Copper Pour Properties dialog, select the appropriate options in the Fill Characteristics
            frame. Whatever you specify here applies only to the selected copper pour(s).
       6.   In the State frame, choose Poured.
       7.   Click OK to close the dialog. P-CAD PCB floods the pours with a copper fill using the pour
            order set in the Pour/Repour Options frame of the Options Configure dialog.

   Rotate or Flip
       You can rotate or flip a copper pour after you have placed it.
       •    To rotate a copper pour by 90 degrees, select the pour and press the R key.
       •    To rotate a copper pour by the rotation increment set in the General tab of the Options
            Configure dialog, press SHIFT+R.
       •    To flip a copper pour, select the pour and press the F key.
       For copper pours with associated connections, press the left mouse button while rotating or
       flipping to prevent reconnection attempts each time you rotate or flip. Connections are committed
       when the left mouse button is released.


Place Cutout
       Choose Place » Cutout to place a cutout on your design. A cutout is a polygonal void area for
       planes, which will not be filled with copper when the pour is flooded. Cutouts do not affect solid
       polygons or keepout polygons. Cutouts are recognized only by pours.
       Since a cutout is a polygonal shape, the edges can be rounded if desired. For instructions on how
       to round the edges of a polygonal shape, see Polygon Properties (page 315), or Place Cutout (page
       389).

   Placing a Cutout
       1.   Choose Place » Cutout or click the toolbar button.
       2.   Move the cursor the first point of the cutout. The cursor will take on a crosshair shape while
            you are placing the cutout. Press and hold down the mouse button at the first point of your
            cutout. Then, drag the cursor to the second point of your cutout and release the mouse button
            to establish the first edge of the polygon cutout.
            Press and hold down the mouse button. Then, drag the cursor to the third point of your cutout.
            Release the mouse button to establish the outline of the cutout. Drag the cursors as described
            to establish subsequent points.

            Complex (self-intersecting or self-crossing) polygons are not supported.

       3.   Right-click or press ESC to establish the cutout polygon; it appears as an outline. When the
            pour is re-poured, the area defined by the cutout is not filled.
       Cutouts are drawn as polygon outlines using the polygon color for that layer.



P-CAD PCB User’s Guide                                                                                     389
Chapter 15: Place Commands                                                                       Place Keepout


      Rotate or Flip
         You can rotate or flip a cutout after you have placed it. Select the cutout and press R to rotate or F
         to flip while the cutout is selected.
         The R key rotation is 90 degrees. You can press SHIFT+R to rotate to whatever rotation increment is
         set in Options Configure.


Place Keepout
         Choose Place » Keepout to create a barrier to either keep in or keep out routing on a specific area
         of the board. You can place either a line keepout or polygon keepout.
         Keepouts are non-electrical items that affect only the autorouter; they are ignored by nets and
         planes.
         First, choose Options » Current Keepout to set the type of keepout you want to place (line or
         polygon) and on what layers (all or current).
         An all-layer Keepout is recognized on all layers of the design. For more specific control on a layer-
         by-layer basis, place current layer keepouts on multiple layers.
         Placement of line keepouts works like Place Line, except that a line keepout has no real width, and
         therefore cannot be modified like a line. Polygon keepouts work like Place Polygon. For specific
         instructions, see Polygon Properties (page 315), or Place Polygon (page 383).
         Since a polygon keepout is a polygonal shape, the edges can be rounded if desired. For
         instructions on how to round the edges of a polygonal shape, see Polygon Properties (page 315), or
         Place Polygon (page 383).


Place Plane
         Choose Place » Plane to create a split plane outline on a plane layer.
         To create a split plane, you place a polygon outline on a plane layer. The area within the polygonal
         outline is the split plane’s copper. A split plane is associated with a single net. When you select the
         net, all split planes in that net are selected. Split planes appear and are printed in negative video.
         Since a plane is a polygonal shape, you can round the edges of the shape. For instructions, see
         Polygon Properties (page 315), or Place Polygon (page 383).

      Placing a Plane
         To place a plane, do the following:
         1.   Choose Options » Layers and create a plane layer that will be split.
              When you create this layer, you can decide whether to assign a net to the plane layer. If you
              decide to assign a net, and then split the net in two, you need only place a single plane object.
         2.   Choose Options » Layers and make the plane layer the current layer.




390                                                                                   P-CAD PCB User’s Guide
Place Plane                                                                      Chapter 15: Place Commands


       3.     Choose Place » Plane or click the toolbar button.
       4.     Move the cursor to the first point of the plane. Click for the first point and drag to the second
              point and release to establish it.
              Place the third point in the same manner. (You can see the outline of the plane so far).
              Click and drag to establish subsequent points.
       5.     Right-click to terminate the placing of the outline and establish the outline of the plane shape.
       The plane is drawn using the polygon color defined for that plane layer.
       It is illegal to have two planes that intersect, because connectivity to the planes will not be correct.
       Design Rule Checking (DRC) will report this error if you enable Plane Violations in the Utils DRC
       dialog.

       The line width (set using the Option Current Line command) determines the clearance between
       two plane nets.

       Now you need to access the Plane Properties dialog. This name will change to establish the
       characteristics of your plane.
       1.     Select the plane outline, then choose Edit » Properties.




       For details about modifying the plane’s properties, see Plane Properties (page 323).

   Pads and Vias
       For a pad to electrically connect to a split plane, the pad and the split plane must be in the same net
       and the pad’s hole must intersect the split plane. If the pad’s hole partially intersects the split plane,
       the pad is still considered electrically connected to the split plane, but DRC reports this partial
       connection as a warning.
       Net connectivity is maintained with split planes, just as net connectivity is maintained with plane
       layers. For example, if two pads are electrically connected because they both connect to the same



P-CAD PCB User’s Guide                                                                                        391
Chapter 15: Place Commands                                                                       Place Room


         split plane, then a connection line is not necessary between the two pads. If two pads are
         electrically connected to the same split plane, P-CAD PCB assumes that copper in the split plane is
         continuous between these two pads.
         Connections between pads/vias and planes can be controlled using the Modify Pad/Via Styles
         (Complex) dialogs. If you choose the No Connect Shape, then the selected pads or vias are not
         connected to planes on the specified layers.

      Rotating or Flipping a Plane
         To rotate or flip a plane, select the plane and choose one of the following methods:
         •    Press F to flip the plane.
         •    Press R to rotate the plane by 90 degrees.
         •    Press SHIFT+R to rotate the plane by the rotation increment set in the General tab of Options
              Configure. For details, see Options Configure (page 429).


Place Room
         Choose Place » Room to place a room in the design. A room is a logical object, which creates a
         region to which you can assign components and rules. Placing components in a Room is an
         excellent way to help you control the layout of your design.
         The steps used to organize components in a room are as follows:
         •    Placing a Room in the Design.
         •    Defining Room Properties.
         •    Assigning Components to the Room.
         •    Verifying Placement with DRC.
         To place a room in your design, do the following:
         1.   Choose Place » Room or click the Place Room button on the toolbar.
         2.   Place the room by choosing one of the following methods:
              •   Position the cursor in the design where you want to place the room corner and click the
                  left mouse button. Go to the position of the room’s opposite corner and click the left
                  mouse button again.
              •   Position the cursor in the design where you want to place the room corner, press and hold
                  down the left mouse button and drag the cursor to the room’s opposite corner. Release
                  the mouse button.
              Performing either option displays the room’s boundaries in the workspace. You can place one
              room entirely inside of or overlapping another room, if desired.




392                                                                                P-CAD PCB User’s Guide
Place Text                                                                      Chapter 15: Place Commands



Place Text
        Choose Place » Text to enter or place text on your design using the following basic steps.
        1.   Choose Place » Text or by click the toolbar button.
        2.   Click the workspace at the location where the text is to be placed.
        3.   Type the text you want to place in the design in the Text area of the Place Text dialog.
        4.   Click Place in the dialog or click the Place Text tool again to commit the text in the design.

    Place Text Dialog
        Text entered in the Place Text dialog is instantly displayed at the location in the design where you
        clicked the mouse button to begin the place text function. You can change the location of the text
        by dragging it to a new location.
        The Place Text dialog can be displayed in the expanded version, an intermediate size or minimized
        to a one-line display. The display size and location at the time the dialog is closed become the
        default settings that are used the next time you enter the Place Text mode.
        To display the expanded version of the Place Text dialog, click More located directly beneath the
        scroll bar, on the right side of the text box. To reduce the dialog to the intermediate size, click
        <<Less. To reinstate the minimized dialog to its previous size, click Maximize. To reduce the dialog
        to its minimized size, click Minimize.
        The minimized version of the dialog appears as follows:




        The intermediate version of the dialog appears as follows:




        The expanded version of the dialog appears as follows:




P-CAD PCB User’s Guide                                                                                        393
Chapter 15: Place Commands                                                                         Place Text




       The Place Text dialog contains the following options:
       •   Text: The Text box is where you type the text you want to place in the design. You can also
           paste text from the Clipboard to the box, by pressing CTRL+V. If you want to enter multiple
           lines you can start new lines in the Text box by using a carriage return (press the ENTER key. A
           single text object can have up to 2, 000 characters.
       •   Location: If the text has not been placed yet, the Location section displays the X and Y
           coordinates of the location of the cursor when the mouse button was released. While placing
           the text the coordinates cannot be modified. When you select committed text and choose Edit
           » Properties, the location coordinates can be modified to move the text to a different area in
           the design.
       •   Flip: The Place Text dialog provides the option to flip the text by selecting the Flip check box.
       •   Rotate: You can rotate the text by clicking Rotate. Each time you click Rotate, the text rotates
           by the increment specified in the Options Configure dialog. For information, see Options
           Configure (page 429). The degree of rotation is displayed next to the button.
       •   Text Styles: You can view the default text styles and add, modify and delete a non-default text
           style by clicking Text Styles to open the Options Text Style dialog. Changes to the text style
           appear instantly in the design at the time they are made.
       The text style for the selected text or the text being placed can be changed by choosing the new
       style from the drop-down list in the Text Style list. Fonts and font sizes cannot be mixed within the
       same text item. Barred text can be inserted in the text item by placing a tilde (~) on either side of
       the text you want to bar. Type two consecutive tildes to cause a single tilde to be displayed.
       Changes that cause the text to placed outside the workspace are not allowed.
       See Options Text Style (page 482) for detailed information on adding, modifying, viewing and
       deleting text styles.
       •   Place/Cancel: Commit the text to the current location in the workspace by clicking Place or the
           place text toolbar button.
       To cancel the text placement dialog and remove the temporary text from the design, click Cancel or
       press ESC. The Text tool is still active, but the dialog disappears from view.




394                                                                                P-CAD PCB User’s Guide
Place Text                                                                        Chapter 15: Place Commands


        Whenever you are typing, flipping or rotating text, and zooming or panning the workspace, the
        dialog remains on the screen. At the time the text is committed to the design by clicking the Place
        button on the dialog, choosing the Place » Text command or the toolbar button, the dialog closes.
        The Place Text tool remains active so that you can click in the workspace to indicate the location for
        the next text item, display the dialog again and place more text.

    Place Text Features
        The Place Text tool provides additional features that enhance the basic placement functionality and
        make placing the text easier and more accurate. This section describes how to rotate, flip, zoom
        and pan text during or after placement.

        Rotating Text
        You can rotate text as you are placing it. Click and hold the left mouse button on the text, then
        press the R key. Clicking the Rotate button will also rotate the text. The R key and Rotate button
        functions rotate the text by the degree specified in the Options Configure dialog. For information,
        see Options Configure (page 429). The text moves about its reference point.
        To rotate text after it has been placed, select it and press R to rotate while the left mouse button is
        depressed or choose Edit » Properties to open the Text Properties dialog where you can click
        Rotate.
        For rotation, whatever angle is the result of the rotation will apply to the next text you place. For
        example, you are placing text and you rotate it 25 degrees before you finish it (SHIFT+R, with 25
        degrees set in Options Configure). Then you place more text; it will be placed at the same 25
        degree angle without any rotation action. (If you decide to rotate the second text string, it will
        increment 25 degrees more, resulting in a 50 degree angle.) Therefore, you can place multiple text
        objects at the same angle but only have to perform the rotation action on the first text string.
        Attributes, text, and fields share the same rotation memory. In other words, if you place and rotate
        text at 90 degrees, then immediately place a field, that field will be placed at a 90-degree angle.
        In the Place Text dialog, click the box again to continue typing new text.

        Flipping Text
        You can flip text as you are placing it if you change focus from the dialog to the workspace. To do
        this, press and hold down the left mouse button. When a ghosted outline of the text appears, press
        the F key. Then, release the mouse button.
        You can also flip text when in the dialog. To do this, select the Flip check box.
        The F key and Flip check box functions flip the text 180 degrees to the right or left of the original
        location. The text moves about its reference point.
        To flip text after it has been placed, select it and then press F to flip, or choose Edit » Properties to
        open the Text Properties dialog and select the Flip check box.
        Click again in the box of the Place Text dialog to continue typing new text.




P-CAD PCB User’s Guide                                                                                          395
Chapter 15: Place Commands                                                                        Place Attribute


      Zooming and Panning While Placing Text
        The Place Text dialog remains on the screen while you zoom or pan the workspace.
        Click the workspace to assure that the focus is in the workspace before choosing any of the zoom
        commands. To zoom in or out of the workspace while placing text, use one of the following
        methods:
        •   Press the (+) and (-) keys.
        •   Choose View » Zoom In and View » Zoom Out.
        •   Click the Zoom Window button on the command toolbar.
        The workspace can be panned by moving the scroll bars up, down, right and left, or by pressing
        one of the arrow keys.
        Click again in the box of the Place Text dialog to continue typing new text.

      Text Summary
        •   The text you enter is case-sensitive; what you enter is what you will get. Changes to text styles
            are displayed in the design at the time the change is made. Fonts and font sizes cannot be
            mixed within the same text item. Barred text is supported.
        •   If you want to enter multiple lines (e.g., a list), you can start new lines in the box by using the
            ENTER key.
        •   You can change the text justification by specifying one of nine justification points in the Place
            Text dialog or Text Properties dialog.
        •   With Text Properties, you can change the content of already placed text. Select the text, then
            right-click and choose Properties from the shortcut menu to open the dialog. You can change
            the text style, add/delete a text style, or modify the text justification in the Place Text or Text
            Properties dialogs. To change, add or delete a text style, click the Text Styles button, which
            activates the Options Text Style dialog, where you can add, modify, view, rename, or delete
            text styles.
        •   Text cannot be placed outside the workspace.

        You cannot delete a text style currently in use.


Place Attribute
        Choose Place » Attribute to place a free attribute according to the Name and Value options you
        select in the dialog.
        To edit a free attribute after it's been placed, select the attribute and choose Edit » Properties or File
        » Design Info. Then, click the Attributes button (Some attribute values can be specified elsewhere,
        such as component name in Component Manager when you create the component).




396                                                                                    P-CAD PCB User’s Guide
Place Attribute                                                                Chapter 15: Place Commands


    Placing an Attribute
        To place an attribute, do the following:
        1.   Choose Place » Attribute or click the Attribute toolbar button.
        2.   Click the workspace to open the following Place Attribute dialog.




        To place a predefined attribute, do the following:
        1.   Choose an attribute category from the Category list. All predefined attributes for the category
             appear in the Name list.
        2.   Select an attribute from the Name list. This name, unless you selected user-defined, appears in
             the Name box.
        To place a user-defined attribute:
        1.   Type an attribute name in the Name box.
        2.   Type a value for the attribute in the Value box.
        3.   Set Attribute Properties. See Attribute Properties (page 328) for more information.
        4.   Click OK.
        5.   Click the workspace, drag the attribute into position and release the mouse button place the
             attribute. Before you release the button to place it, you can move, rotate, or flip the placement
             box.

    Rotating or Flipping a Field
        To rotate or flip an attribute after it has been placed, select it and choose one of these methods:



P-CAD PCB User’s Guide                                                                                        397
Chapter 15: Place Commands                                                                          Place Field


       •   Press F to flip the field.
       •   Press R to rotate the field by 90 degrees.
       •   Press SHIFT+R to rotate the field by the rotation increment set in the General tab of the
           Options Configure dialog. For details, see Options Configure (page 429).
       You can rotate or flip an attribute as you are placing it. For rotation, whatever angle is the result of
       the rotation will apply to the next attribute you place. For example, you are placing an attribute and
       you rotate it 25-degrees before you finish it (SHIFT+R, with 25-degrees set in Options Configure).
       Then you place another attribute; it will be placed at the same 25-degree angle without any rotation
       action. You can place multiple attributes at the same angle by rotating the first attribute as you
       place it.
       Attributes, text, and fields share the same rotation memory. In other words, if you place and rotate
       text at 90-degrees, then immediately place an attribute, that attribute will be placed at a 90-degree
       angle. This rotation memory derives only from rotation action during placement, not from select
       and rotate actions that take place after object placement.
       If you don't specify a value for an attribute, the attribute key name appears in brackets, e.g., {Type}.


Place Field
       Choose Place » Field to place a field containing design information such as date, time, author, etc.
       The information that appears when you place certain fields is determined by what you specify in
       the File Design Info dialog. You can place a field from a selection of predefined field types
       including the following fields:
       •   Approved By
       •   Author
       •   Checked By
       •   Company Name
       •   Current Date, Current Time
       •   Date
       •   Drawing Number
       •   Drawn By
       •   Engineer
       •   Filename
       •   GUID (Globally Unique Identifier)
       •   Layer Name
       •   Modified Date



398                                                                                 P-CAD PCB User’s Guide
Place Field                                                                        Chapter 15: Place Commands


        •     Note
        •     Revision
        •     Revision Note
        •     Time
        •     Title

        The Globally Unique Identifier (GUID) field is targeted to P-CAD PDM users. However, this pre-
        defined field is available for placement in any design.

        You can also define additional fields using File » Design Info and then place them in your design.
        The current date and time fields use the settings from your computer’s Date/Time Properties. If you
        just select date then you must specify the date in the File Design Info dialog. The same is true for
        time (as opposed to current time).
        The value of a field placed in the design, with the exception of Current Date/Time, Filename and
        Modified Date, must be specified in the Field Properties dialog, otherwise you place a generic field,
        e.g., {Author} rather than “W. Shakespeare”. To open the Field Properties dialog, choose File »
        Design Info or select a field, then right-click and choose Properties from the shortcut menu.
        Fields are handy for use within title blocks.

    Placing a Field
        To place a field, do the following:
        1.    Choose Place » Field and click the workspace. The following Place Field dialog appears.




        2.    From the Name list, select the type of field you want to place. Click OK.
        3.    Move the cursor to where you want to place the field; click to place it. If you click again, the
              Place Field dialog opens, so you can place another type of field.
        4.    You can rotate or flip a field as you are placing it. See Rotating or Flipping a Field (page 397).
        To cancel before a field is placed, right-click.

    Rotating or Flipping a Field
        To rotate or flip a field after it has been placed, select it


P-CAD PCB User’s Guide                                                                                             399
Chapter 15: Place Commands                                                                    Place Dimension


        •    Press F to flip the field.
        •    Press R to rotate to rotate the field by 90 degrees.
        •    Press SHIFT+R to rotate to the field by the rotation increment set in the General tab of Options
             Configure. For details, see Options Configure (page 429).
        You can rotate or flip a field as you are placing it. For rotation, whatever angle is the result of the
        rotation will apply to the next field you place. For example, you are placing a field and you rotate it
        25 degrees before you finish it (SHIFT+R, with 25 degrees set in Options Configure).
        When you place another field; it will be placed at the same 25 degree angle without any rotation
        action. If you decide to rotate the second field, it will increment 25 degrees more, resulting in a 50
        degree angle. Therefore, you can place multiple fields at the same angle but only have to perform
        the rotation action on the first field.
        Attributes, text, and fields share the same rotation memory. In other words, if you place and rotate
        text at 90 degrees, then immediately place a field, that attribute will be placed at a 90-degree angle.
        This rotation memory derives only from rotation action during placement, not from select and
        rotate actions that take place after object placement.


Place Dimension
        Choose Place » Dimension to place a dimension at a specified location. A dimension is frequently
        used for describing distances, center points and angles between items. You can also choose to
        place an Associative Dimension: an intelligent dimension associated with its objects, which is
        dynamically updated whenever objects are moved. The selections made in the Place Dimension
        dialog are retained throughout your session in PCB. The default settings are applied at the
        beginning of each PCB session until changes are made for that session.

      Placing a Dimension
        To place a dimension, do the following:
        1.   Choose Place » Dimension or click the toolbar button.
        2.   Click the workspace to open the following Place Dimension dialog.




400                                                                                  P-CAD PCB User’s Guide
Place Dimension                                                                  Chapter 15: Place Commands




       3.   Select one of the following dimension styles from the Styles list:
            •     Point to Point: Measures the distance between two points.
            •     Baseline: Measures the distance between a single reference point and subsequent points.
                  The dimension text is placed between the extension lines.
            •     Leader: Leader is a dimensioning line extending from a piece of text or symbol to the
                  dimensioned object. It can be used for dimensioning or notation.
            •     Center: Center is a cross-hair marking of the center of an arc or circle. You can also
                  dimension two center dimensions.
            •     Radius: Measures the radius of an arc or circle.
            •     Diameter: Measures the diameter of a circle.
            •     Angular: Measures the angle between lines.
            •     Datum: Measures the distance between a single reference points and subsequent points.
                  The dimension text is placed at the end of the extension line. In datum dimensioning,
                  there are no dimension lines connecting the extension lines.
       4.   In the Orientation frame, select the Horizontal or Vertical option button to set the dimension’s
            orientation.
       5.   In the Text Orientation frame, select the Horizontal or Vertical option button to set the
            orientation of the text that appears between the dimension lines.
       6.   Select a measurement scale from the Units list.



P-CAD PCB User’s Guide                                                                                     401
Chapter 15: Place Commands                                                                 Place Dimension


       7.   Select the layer on which you will place the dimension from the Layer list. If, upon reentering
            the dimension dialogs, the selected layer does not exist in the design, the Board layer is used
            as the default.
       8.   Select the desired level of precision from the Precision list. This setting determines the number
            of significant digits used to display the dimension measurement.
       9.   Enable the Display Tolerance check box if you wish to include a tolerance with the dimension.
            The tolerance is always displayed with 4 digit precision.
       10. In the Symbol frame, choose one of these buttons to set the type of notation for a Leader style
           dimension: Text, Circle, Square or Triangle.
       11. Enter a symbol size in the Symbol Size box.
       12. When placing a dimension based on center points, specify a center size for the center of the
           symbol in the Center Size box.
       13. Click Text Style to open the Options Text Style dialog. Then, choose the desired text style. The
           default is always the current text style set by choosing Options Text Style. For more
           information, see Options Text Style (page 482).
       14. In the Line Width box, set a line width for the dimension lines.
       15. In the Arrowhead box, you can set the length and width of an arrowhead.
       16. Select the Display Units check box to display the specified units.
       17. Select the Display Diameter Symbols check box to turn on the display of the symbol.
       18. If you want to suppress zeros in the dimension, select the Suppress Leading Zeros or Suppress
           Trailing Zeros check boxes.
       19. To add intelligence to the dimension and its associated objects, select the Associated
           Dimension check box. An associative dimension follows its associated objects and updates the
           dimension value whenever the objects are moved.
       20. Click OK to return to the workspace.
       21. Point in the workspace to place the dimension.
            The mouse click procedure to place a dimension depends on the dimension style selected. If
            you need assistance placing a dimension, see the Prompt Line at the bottom of your workspace
            for instructions. To learn about the Prompt Line, see View Prompt Line (page 366).
       22. Select the location for the dimension text and lines.
            Hold down the left mouse button while placing the text. A ghosted outline of the dimension
            appears. While ghosted, the dimension can be moved. The dimension is placed in the desire
            location when the mouse button is released.
            When placing a Baseline or Datum dimension, you can unwind the last action performed by
            pressing the BACKSPACE key.




402                                                                                P-CAD PCB User’s Guide
Place Dimension                                                             Chapter 15: Place Commands


       23. Continue placing dimensions as necessary. To stop placing dimensions, press ESC or right-
           click.

           You cannot place dimensions on a test point. To learn more about test points, see Place Point
           (page 384).

   Modifying a Dimension
       A dimension can be modified after placement in a variety of ways:
       •   A selected dimension can be modified directly using the Dimension Properties dialog. This
           includes the ability to edit the dimension’s unit, layer, and precision.
       •   Dimension text can be moved and modified after placement by selecting the dimension and
           dragging the handle that appears over the text.
       •   After placement, dimensions can be moved along the dimensioning line to change the text
           position for Point to Point, Datum, Baseline and Angular dimensions. Simply choose the select
           tool, grab the handle on the dimension and drag it to the desired location on the dimension
           line.
       •   Leader, Radius and Diameter dimensions can be moved around the arrowhead point by
           grabbing the handle and repositioning the dimension in a new location once they have been
           placed.

   Rotating a Dimension
       To rotate a dimension after it has been placed, select it, and choose one of the methods:
       •   Press R to rotate the dimension by 90 degrees.
       •   Press SHIFT+R to rotate the object by the rotation increment set in the General tab of Options
           Configure. For details, see Options Configure (page 429).




P-CAD PCB User’s Guide                                                                                 403
                                                                                      CHAPTER           16


                                                              Route Commands

Using the Route Commands
       Use the commands in the Route menu give you the ability to gain access to a variety of routing
       options. For example, choose Route » Manual to manually route and reroute existing connections
       or net copper items.
       With the Route » Interactive command, you can gain access to InterRoute, the interactive routing
       tool, which provides obstacle avoidance, copper hugging, and intelligent route completion.
       With Route » Miter, you can convert 90 degree corners on routed connections into 45 degree
       mitered corners, 90 degree arcs, or T-routes. P-CAD PCB supports the following autorouters:
       •     QuickRoute
       •     PRO Route 2/4
       •     PRO Route
       •     SPECCTRA (valid for SP10, SP4P, SP2, and SP6 products)
       The look and feel of the user interface is consistent for all autorouters. The supporting dialogs are
       router-sensitive, so that router-specific data such as pass selection are different for each
       autorouter.
       The Route Toolbar provides shortcuts to the route commands:




           Click this button        To choose this command
                               Route Manual

                               Route Interactive




P-CAD PCB User’s Guide                                                                                     405
Chapter 16: Route Commands                                                                   Route Autorouter



         Click this button         To choose this command
                              Route Miter

                              Route Bus


                              Route MultiTrace

                              Route Fanout

                              Maximize Hugging

                              Minimize Length

                              Visible Routing Area



Route Autorouter
       When you choose Route » Autorouters, the Route Autorouters dialog appears. Use this dialog to
       choose the autorouter that you want to use to route your designs.
       In this dialog, you can also set autorouter options for the autorouter, as well as start and restart the
       autorouting process. The following figure shows you the Route Autorouters dialog:




406                                                                                  P-CAD PCB User’s Guide
Route View Log                                                               Chapter 16: Route Commands




       The Autorouter combo box defaults to QuickRoute, the embedded router. To select a different
       router, click the down arrow and choose a router from the list. Notice that the dialog changes
       depending on the router you select. To get information about a specific router, click a router from
       the list.


Route View Log
       Choose Route » View Log to view the log file generated from your autorouting session. Each router
       produces a comprehensive report file at the end of the routing session, detailing the results of the
       session. The report appears in the Notepad. You can view the log file without interrupting the
       routing process.
       Before routing starts, the input PCB is analyzed. General information as well as your routing
       strategy and router- selected options are written to the log file. After each pass, per-pass and total
       routing statistics are written to the file. When routing is completed, summary information is written
       to the file.
       The report file contains the information detailed in the following sections.

       Headers and Footers
       The name and version number of the router being used is found in the header. The footer displays
       the date and time the report was created. You can define your own header and footer by choosing
       File Reports in P-CAD PCB. This information is stored in the Pcb.ini file.




P-CAD PCB User’s Guide                                                                                    407
Chapter 16: Route Commands                                                                         Route Manual


       General
       The report provides a list of the input PCB, output PCB and strategy file names, your selected units,
       the available memory and the route start time. The report also lists the routing grid and via grid
       settings, the checkpoint interval, rip-up preroutes, diagonal routing and copper sharing options,
       the iterative and manufacturing pass counts and whether manufacturing passes should be run if
       the board is not completely routed.

       Layer Settings
       Provides a listing of the selected layers, indicating their directional bias (horizontal, vertical. Net
       names are provided for plane layers).

       Net Classes
       Provides a listing of each net class and their defined width, via pad stack and the maximum number
       of vias. The autorouter routes all nets belonging to the same net class together in a pass.

       Pass Settings
       Lists the scheduled passes and identifies the net classes to be routed during each. Some scheduled
       passes may not be run, as explained in Pass Performance (page 408).

       Pass Performance
       For each routing pass completed, the report file lists a count and percentage of the lines scheduled,
       completed and deferred during the pass, and for the entire run so far. Also reported are vias and
       copper length that were added or deleted during the pass as well as for the entire routing session.

       Final Board Statistics
       Final board statistics lists the total number of pads on the board, the number of equivalent 16-pin
       ICs (EICs), the dimensions and area of the design, the density (in square units per EIC; the lower
       this number is, the denser the board), the vias added during the routing process, the total number
       and length of routed lines (and percentage of routed lines to total lines), the total number of
       unrouted lines (and percentage of unrouted lines to total lines) and the total execution time for the
       routing process.

       If you abort the routing process, the report file reflects the final board statistics only up to the point
       of termination. A warning message appears in the report file, indicating the type of termination
       request made (stop and save or stop and don't save).


Route Manual
       Choose Route » Manual to manually route and reroute existing connections or net copper items.
       Route Manual gives you the ability to precisely place traces. An individual trace can be routed along
       an arc, at any angle, and into loops. You can also T-route from an existing trace. Traces need not
       obey clearance rules, although Online DRC is available. The flexibility of Route Manual is
       particularly useful for analog boards.




408                                                                                   P-CAD PCB User’s Guide
Route Manual                                                                  Chapter 16: Route Commands


       Before you route you must have already placed components and placed connections between the
       component pads (net nodes). For information about components and connections, see Place
       Component (page 374) and Place Connection (page 377). You can also get connections by loading a
       netlist. See Utils Load Netlist (page 520).
       Also, before you route, you should have all the layers enabled that you will be using during your
       routing procedure. To see the list of enabled layers, use the Layer combo box on the Status Line.
       You can change between these enabled layers (making each layer the current layer, in turn).
       Choose Options » Layers to alter the list of enabled layers (enable, disable, add to, delete, modify)
       as an alternate way to change the current layer. For details, see Options Layers (page 450).

       The program does not allow routing on a nonsignal layer. If you try to route on a nonsignal layer, an
       error message appears.

       See Routing (page 95) for additional information about setting up your board for routing and
       selecting a route tool.

   Manually Routing a Connection
       To manually route a connection, do the following:
       1.   Zoom in so that the connections you want to route are large enough to select.
       2.   Choose Route » Manual.
       3.   Click the connection. Notice that part or all of the net is highlighted in the current highlight
            color. In the Route tab of the Options Configure dialog, you can select which items are
            highlighted in the Highlight While Routing box. Item highlight options are Pads Only or Pads,
            Traces and Connection.
       4.   Drag the connection to where you want to route the connection and release. The new segment
            appears in the current layer color. The new copper segment starts from the end of the
            connection to which it is closest.

            An alternate method for click-and-drag is to press the ALT key, then click the left mouse button
            (ALT+left mouse). You can then drag the routed line anywhere without having to keep the
            mouse button depressed

       5.   You can continue routing by clicking at points where you want the route to go. Click to select a
            route point on the connection line, drag the line to the new location. Select the next point and
            do the same thing. Continue this process until the connection is completely routed.
       6.   To complete the routing of a segment, right-click.

   Terminating a Route
       To terminate a route, choose one of these methods:
       •    Complete the remainder of the trace (right-click or press ESC).
       •    Stop routing without completing the trace (press FORWARD SLASH (\) or BACKSLASH (/) keys).




P-CAD PCB User’s Guide                                                                                    409
Chapter 16: Route Commands                                                                        Route Manual


         The behavior of the right-click action and the SLASH key can be modified using the Route tab in the
         Options Configure dialog. For details, see Options Configure (page 429).
         When you drag the trace over its termination pad, a diamond shape appears. Then, you have
         reached the connection destination. The diamond symbol represents a zero length connection. It
         disappears when the connection is completed.

         If the diamond shape remains after completing the connection, it indicates the pad you are routing
         to is on a different layer than the end of the route.

         Right-Click
         To route the remainder of a connection (in a straight line all the way to the next node), right-click.
         You can then left-click over another connection segment to begin routing it.
         If the current endpoint of the trace being routed is point-to-point with an object belonging to the
         same net (pad, via, line, or arc) right-clicking causes the route to be recognized as completed,
         ending the route. The routing guide connection (the remaining connection is displayed during
         manual routing) is not replaced with a line trace to the original guide connection destination point
         when the right mouse button is pressed. The guide connection will be updated as appropriate.
         The exception to this behavior occurs when routing to a pad that is the endpoint of the current
         guide connection. Right-clicking completes the route to the pad center.
         The behavior of the right-click action and SLASH key can be modified using the Route tab of the
         Options Configure dialog. For details, see Options Configure (page 429).

         Slash Keys
         The SLASH keys (/) and (\) stop a route in midconnection without adding a final copper segment.
         Both back and forward slashes stop a route.
         When the Optimize Partial Route check box is selected in General tab of the Options Configure
         dialog, pressing the SLASH key during manual routing terminates the route and causes the guide
         connection line to connect to the nearest net endpoint if the net doesn’t have an OPTIMIZE=NO
         attribute.
         The behavior of the right-click action and the SLASH key can be modified using the Route tab of
         the Options Configure dialog. For details, see Options Configure (page 429).

      Status Line Information
         While you are manually routing, measurement information appears in the Status Line, along with
         the name of the net being routed, and the current orthogonal mode.
         For example, the Status Line in the following figure shows the delta X and delta Y measurements of
         a ghosted segment while you are dragging, and the total length of the segment being routed when
         you release. The measurement does not include already routed or yet-to-be route portions of a net.




410                                                                                   P-CAD PCB User’s Guide
Route Manual                                                                   Chapter 16: Route Commands


   Routing between Layers
       You must switch layers if you attempt to route from, or to, a pad on a different layer from the
       current layer. Changing layers is also useful when crossing a blockage.
       Press the L key or press SHIFT+L keys as a shortcut to cycle between enabled layers. A via of the
       current style is automatically inserted when you change layers, unless you have a ViaStyle attribute.
       The line from that point reflects the color of the new layer.

   T-Routing
       To invoke T routing, press the SHIFT key while the Route Manual tool is enabled. The mouse
       operations are the same for T routing as they are for reroute: click (initiate), drag (rubberband),
       release (commit). By selecting the T-Route by Default check box in the Route tab of the Options
       Configure dialog, you can T- route without pressing the SHIFT key.
       When selecting a trace, there are two possible ways to initiate the route depending on the T route
       mode: If T routing is disabled, the selection is treated as a reroute. If T routing is enabled using the
       SHIFT key, the tool starts a T route whereby the selected trace is broken at the selection point
       (unless that point is an endpoint) and routing continues with a new trace anchored at the selection
       point. You do not need to hold down the SHIFT key for the entire route, just to start the route.
       You can set T routing to be the default mode using the Route tab of the Options Configure dialog.
       Otherwise, rerouting is the default operation. For information, see Options Configure (page 429).
       A connection line is created from the selection point to the nearest, unconnected node to guide
       you in completing the route. When routing into a trace, the intersecting line is broken at the
       selection point. Just because this feature is called T routing does not imply that it only works for T
       shaped intersections. Routing is permitted to and from any existing traces on the board. If there is
       no unconnected node to anchor the end of the connection line, no connection line appears.




                                               Nearest Node


   Modifying Traces
       There are several ways to modify traces. In Route Manual mode, you can select a routed trace to
       reroute it. During trace placement, you can unwind or backtrack to remove or modify the
       previously placed segments. Also, Route Manual features trace cleanup to automatically remove
       overlapping trace segments.

       Unwind
       If you make a mistake, you can press the BACKSPACE key, and the previous segment disappears
       (unwinds). With each press of the BACKSPACE key, a previous segment or via is unwound.




P-CAD PCB User’s Guide                                                                                       411
Chapter 16: Route Commands                                                                     Route Manual


        Backtracking
        Committing a straight line segment on top of another straight line segment, backtracking, acts as an
        erase operation and the intersection of the two lines is removed.
        Vias cannot be erased with backtracking. You need to perform an unwind operation.
        Backtracking detects only lines that precisely trace back over previous lines and only during the
        routing operation. No backtracking is performed for lines already existing in the design.

        Trace Cleanup
        When you choose Utils » Trace Clean-up, redundant trace segments (collinear and overlapping)
        and extra vertices are removed before the traces are added to the design. Trace cleanup also occurs
        between newly routed traces and preexisting traces.

      Orthogonal Modes (O key)
        You can press the O key to switch between the orthogonal modes while placing lines during
        manual routing. You can enable/disable certain orthogonal modes in the Options Configure dialog.
        The available orthogonal modes are provided as three mode pairs and a Tangent Arc mode. The
        mode pairs supply a total of six modes (three types, with two variations on each type). Press the F
        key to flip the mode between the angles in the current mode pair.
        See Options Configure (page 429) for more information.

        90/90 Line-Line
        The 90/90 Line-Line modes are horizontal or vertical, as shown in the following. In long mode, the
        first segment is always longer than the second. In short mode, the first segment is shorter. To
        switch between the two modes, press the F key.




        45/90 Line-Line
        You can switch between the two modes by pressing the F key. The first mode makes the first
        segment display at a 45 degree angle and the second segment is either horizontal or vertical. The
        second mode makes the first segment either horizontal or vertical and the second segment is
        displayed at a 45 degree angle.




        90/90 Arc-Line
        You can switch between two modes by pressing the F key. The first mode makes the first segment
        display as an arc and the second segment is either a horizontal line or a vertical line. The second




412                                                                                P-CAD PCB User’s Guide
Route Manual                                                                 Chapter 16: Route Commands


       mode makes the first segment either horizontal or vertical line and the second segment is
       displayed as an arc.




       Tangent Arc
       A curved arc can be incorporated into a route segment when Tangent Arc is the current orthogonal
       mode. The current radius, controlled through the Options » Current Radius command or the
       Radius combo box on the Status Line, is used to determine the curve of the arc while maintaining
       tangency between the two line segments and the arc. Once placed, the arc can be moved or
       modified by using the miter tool, which allows you to grab and drag an arc handle to a new radius.

                                   r
          r


   Online DRC
       If Online DRC is enabled using Options » Configure or the toolbar button, online DRC checking is
       performed after each mouse or keyboard click fixes the end of a segment during manual routing.
       Each routing click can cause up to two trace segments (either lines or arcs) and a via to be placed in
       the design; all newly created items are checked for DRC violations. When a violation is detected, a
       beep is generated and a DRC error indicator is placed at the approximate location of the violation;
       no error message appears. Multiple violations result in two beeps and multiple error indicators.
       When a connection is completed, the number of DRC error indicators generated for the
       connection appears in the Status Info box on the Status Line, and a report of the violations is
       presented automatically if you selected the View » Report check box in the Options Configure
       dialog and there is at least one violation. This report includes a summary count of the violations
       created during the routing of the connection, plus the information from the individual DRC error
       indicators.
       The clearance values used for clearance testing of pads, vias, and lines on a particular signal layer
       are taken from the Options Design Rules dialog and the Clearance attributes on the nets. Clearance
       attributes on the nets take precedence. Net class and class to class rules are also honored. This
       dialog is discussed in the Clearances section.
       Associated DRC error indicators are automatically deleted when unwinding a route, and when
       undoing a completed connection with violations. Otherwise, DRC error indicators are not
       automatically removed when the violation is corrected. See Options Configure (page 429) for more
       information.




P-CAD PCB User’s Guide                                                                                    413
Chapter 16: Route Commands                                                                    Route Interactive


        Width Attribute
        DRC error indicators are generated if the width of any segment or arc of a net with a Width
        attribute differs (smaller or larger) from the that specified by the attribute. Both batch and online
        DRC generate DRC indicators.




      Overlapping Connections
        When connection lines overlap over a pad, routing selection priority is given to the connection line
        that has the same net ID as the pad. Priority is also given to SMD pads that are defined on the
        current layer.

      Routing to Free Copper
        Manual routing to the center of a pad, via, or the endpoint of a line that is not part of any net adds
        that item to the net being routed. This occurs as each route operation is completed, without
        choosing the Utils » Reconnect Nets command or the Utils Reconnect Nets option in the Utils Load
        Netlist dialog.
        To add other objects (arcs and polygons) to the net, choose Utils » Load Netlist with the Reconnect
        Copper option enabled, or use the Utils » Reconnect Nets command after the routes intersecting
        free copper have been completed. Arcs and polygons maintain full net information and correctly
        remove connections after being added to a net.

      Copper Pours
        Copper Pours affected by new copper generated by this tool will autoplow when the route
        completes or suspends.


Route Interactive
        Choose Route » Interactive to start the InterRoute tool. Interactive routing provides design rule
        intelligence for easy obstacle avoidance, copper hugging, pad entry, and automatic route
        completion.
        The InterRoute tool has many features and options for you to control trace placement, including T-
        routing from existing trace segments.

      Routing Connections
        To route connections, follow these steps:
        1.   Choose Route » Interactive or click the Route Interactive button on the InterRoute toolbar.
        2.   Pick a connection to route. The end closest to the point where the connection is selected
             becomes the source point; the other end becomes the destination point.


414                                                                                  P-CAD PCB User’s Guide
Route Interactive                                                                Chapter 16: Route Commands


             Notice that part or all of the net is highlighted in the current highlight color. In the Route tab of
             the Options Configure dialog, you can select which items are highlighted in the Highlight
             While Routing box. Item highlight options are Pads Only or Pads, Traces and Connection.
        3.   The Route Interactive tool rubberbands uncommitted copper with the proper net width and
             design rule clearances from the source point to the position of the cursor. The rubberbanding
             copper tracks around obstacles, maintaining the proper design rule clearances for that net,
             from the point of origin to the cursor position.
             While you are moving the cursor, a connection rubberbands from the cursor to the second
             node of the connection, indicating what remains to be routed.
        4.   When you click a coordinate that is not the destination node, the previously uncommitted
             lines are placed on the board.
        5.   Continue this process until you are ready to complete the route.
        6.   Right-click and Complete from the shortcut menu. The InterRoute tool automatically finds the
             optimal path to complete the trace.

                                                       Or

        7.   Click a node that is the other end of the rubberband (this could be a pad, via, line, arc, polygon
             or copper pour island). If the selected node is a termination point for the connection, the route
             completes automatically.
        You are now free to choose another connection to route or cancel the tool.

    Controlling Trace Placement
        The interactive routing tool has many features for controlling trace placement.
        You can initially route from a pad as if you were in Route Manual mode, with the added assistance
        of Route Interactive tool’s design rule intelligence.
        When you are ready to terminate the route, choose Complete from the shortcut menu. The trace
        completes automatically. Many options are available to steer this trace.
        This section discusses the following trace control features of P-CAD InterRoute:
        •    Status Line Information
        •    Obstacle Hugging
        •    Net Attributes
        For additional information on routing control, see Pad Entry or Exit (page 416) and T-Routing (page
        417).

        Status Line Information
        While you are manually routing using the InterRoute tool, the right side of the Status Line displays
        measurement information, the name of the net being routing, and the current orthogonal mode.



P-CAD PCB User’s Guide                                                                                         415
Chapter 16: Route Commands                                                                    Route Interactive


         For example, the Status Line in the following figure displays the delta X and delta Y measurements
         of a ghosted segment while you are dragging, and the total length of the segment being routed
         when you release. The measurement does not include already routed or yet-to-be route portions of
         a net.




         Obstacle Hugging
         Track segments follow the shortest path from start point to end point, hugging obstacles to within
         the clearance amount set using the Options Design Rules dialog.
         A clearance indicator appears when you try to route through an obstruction. The clearance
         indicator appears as a semicircle with a radius showing the clearance amount between the object
         being routed and the obstruction.
         The router always routes on grid, except for off-grid pads where the route is centered on the pad
         but ends on a grid point.

         Net Attributes
         The net attributes Width, ViaStyle, Clearance, PadToPadClearance, PadToLineClearance,
         LineToLineClearance, ViaToPadClearance, ViaToLineClearance, and ViaToViaClearance will be
         honored given the appropriate net class hierarchy.

      Pad Entry or Exit
         Pad entry or exit is calculated from the pad’s center regardless of whether or not the pad is on-grid.
         The stub length, set from the Route tab of the Options Configure dialog, lets you set the minimum
         number of grid points from the pad’s center for the first track you route.
         When entering a surface mount pad, always place the trace to the pad parallel to the bias of the pad
         and aligned with the pad center.

         Fanouts
         When routing off-grid pad and via fanouts, InterRoute tool routes a stub in the direction of the
         cursor of a length (stub length) at least as long as that specified in the Route tab of the Options
         Configure dialog. If the cursor position is closer to the pad than the stub length, no stub is created;
         the route simply starts at the pad center and ends at the cursor position.

                               90 Degree            45 Degree
         Major axis stubs      orthogonal mode      orthogonal mode




416                                                                                   P-CAD PCB User’s Guide
Route Interactive                                                             Chapter 16: Route Commands


        Stubs for pads with matching width and height (e.g., round, square) can go in four (90-degree
        orthogonal mode) or eight (45-degree orthogonal mode) directions.




        Stubs for elongated pads (e.g., rectangle) go along the major axis only. Stubs on off-grid pads go
        from the pad center and remain off-grid until the cursor position is reached and then snap first to
        the closest grid line. The remainder of the route (from the stub endpoint to the cursor) ends on a
        grid point because the cursor is always on-grid. Entering a pad with a route follows the same logic
        as leaving a pad. Stubs always go to pad center.

        Polygonal Pads
        Polygonal pad shapes are supported. However, edges that are not 45- or 90-degrees won’t hug
        closely.

    T-Routing
        T-Routing when using the interactive routing tool works the same as it does when using the manual
        routing tool described earlier in this chapter. Copper share capability found in the interactive
        routing tool is the same as in the manual routing tool. The Interactive routing tool avoids obstacles,
        and allows you to terminate the route on a track segment as well as start a T route from a track
        segment.

    Terminating a Route
        To terminate a route with the interactive router, you can choose to do one of the following:
        •   Route to the termination of the connection.
        •   Complete the remainder of the trace automatically and right-click when complete.
        •   Stop routing without completing the trace (SLASH keys).
        When you drag the trace over its termination pad, a diamond shape appears. Then, you have
        reached the connection destination. The diamond symbol represents a zero length connection. It
        disappears when the connection is completed.

        If the diamond shape remains after completing the connection, it indicates the pad you are routing
        to is on a different layer than the end of the route.




P-CAD PCB User’s Guide                                                                                     417
Chapter 16: Route Commands                                                                   Route Interactive


        Complete
        Right-click and choose Complete from the shortcut menu. The remaining portion of the route is
        completed automatically. The design rule intelligence of the InterRoute tool neatly hugs obstacles
        along the trace path.

        Slash Key
        Routing can be suspended by pressing the SLASH (\) or (/) keys and the unrouted portion becomes
        a new connection from the suspension point to the end node.
        Routing can also be suspended by right-clicking and choosing Suspend from the shortcut menu.

      Modifying Traces
        There are several ways to modify traces. With the Route Interactive tool enabled, you can simply
        select a routed trace to reroute it. During trace placement, you can unwind or backtrack to remove
        or modify the previously placed segments. Also, Route Interactive tool features trace cleanup to
        automatically remove overlapping trace segments.

        Rerouting Lines
        The routing of existing lines is supported by the interactive routing tool. While using the Route
        Interactive tool, select a trace. Route the trace along a new path and terminate when complete.
        The shortcut menu behaves the same as when rerouting connections.

        Unwinding
        Any segments or vias that are committed can be uncommitted by pressing the BACKSPACE key or
        by right-clicking and choosing Unwind from the shortcut menu.

        Backtracking
        Committing a straight line segment on top of another straight line segment, backtracking, acts as an
        erase operation and the intersection of the two lines is removed.
        The routing tool also looks for loops in routed traces. If one is encountered, the loop, along with
        any resulting, floating copper is removed.
        Vias cannot be erased with backtracking. You need to perform an unwind operation.

        Trace Cleanup
        When you choose Utils » Trace Clean-up, redundant trace segments (collinear and overlapping)
        and extra vertices are removed before the traces are added to the design. Trace cleanup also occurs
        between newly routed traces and preexisting traces.

      Changing Layers
        Changing layers adds vias in the same manner as is done with the Route Manual tool except that
        once you switch to a new layer, the Route Interactive tool recalculates its internal data structures to
        reflect obstacles on the new layer.




418                                                                                  P-CAD PCB User’s Guide
Route Interactive                                                             Chapter 16: Route Commands


        Blind and buried vias are handled as they are with the manual router. Changing layers while on a
        through hole pad simply changes layers (if the hole range allows it).

    Vias, Layers, and Line Widths
        Using the commands in the Options menu, you can select vias, layers and line widths during the
        routing operation. For information on these commands, see Options Commands (page 423).

    Loop Removal
        The Route Interactive tool looks for loops in routed traces. If one is encountered, the loop, along
        with any resulting floating copper is removed.

    Copper Pours
        If the Auto Plow Copper Pours check box is selected in the Options Configure dialog, copper
        pours affected by new copper generated by these tools will autoplow when the route completes or
        suspends. For more information, see Routing (page 192).

    Shortcut Menu
        You can open a shortcut menu during the routing process. To do this, right-click. The following
        shortcut menu appears:




        The following command appear in the shortcut menu:
        •   Complete: Autoroutes the remaining portion of the route.
        •   Suspend: Equivalent to press the / or \ keys, which leaves the unrouted portion as a
            connection.
        •   Cancel: Undo all routing actions and puts the original connection back. The Route Interactive
            tool remains active.
        •   Options: Opens the Route tab of the Options Configure dialog.
        •   Layers: Opens the Options Layers dialog.
        •   Via Style: Opens the Options Via Style dialog.
        •   Unwind: Removes the last line or via that was committed.



P-CAD PCB User’s Guide                                                                                     419
Chapter 16: Route Commands                                                                         Route Miter


      Keyboard Shortcuts
         The following keyboard shortcuts are available during the routing process:


                   Key                        Action
          ENTER             Same as left mouse, commits the
                            current routed series of lines.
          ESC               Opens the shortcut menu.
          / or \            Stops routing the connection and
                            leaves remaining, unrouted portion as
                            a connection.
          BACKSPACE         Undoes the last segment placed.
          O                 Switches between 45-degree and 90-
                            degree orthogonal mode.



Route Miter
         Choose Route » Miter to create 90-degree corners on routed connections into 45-degree mitered
         corners, 90- degree arcs, or T-routes. The 90-degree corner must be true horizontal and vertical
         segments and have the same line width.
         You can also use the Route Miter tool to miter T junctions and existing mitered T junctions.

      Using the Route Miter Tool
         To use the Route Miter tool, do the following:
         1.   Select a corner style using the Route tab of the Options Configure dialog.
         2.   To create a 45-degree mitered corner, press and hold down the left mouse button on the 90-
              degree corner that you want to miter (see Figure A as follows).
         3.   Drag to create the mitered corner (see Figure B. Don't release the mouse button until you have
              the proper length of mitering).




                    A                        B

         4.   To create a 90-degree arc miter, press and hold down the left mouse button over on a 90-
              degree corner (see Figure A as follows), then drag to create the arc (see Figure B. Release the
              mouse button when you have the arc miter that you want).



420                                                                                  P-CAD PCB User’s Guide
Route Miter                                                                  Chapter 16: Route Commands




                  A                          B

        5.    For creating a T miter, press and hold down the mouse button on a selection point (see Figure
              A as follows), then drag to create the T miter (see Figure B. Release the mouse button when
              you have the T miter that you want).




                      A                                  B

        6.    To cancel a ghosted miter, right-click.
        Press the O key while mitering to switch between 45 degree line and 90 degree arc miters.
        However, only 45 degree line miters are supported for T routes.
        You cannot miter non-net traces.
        Online DRC detects clearance or netlist violations for mitered traces.

    Editing Existing Miters
        Choose Route » Miter to pick an existing miter (line or arc) and change the miter distance as you
        would when creating new miters.




P-CAD PCB User’s Guide                                                                                      421
                                                                                      CHAPTER           17


                                                         Options Commands

Using the Options Commands
       You use the commands in the Options menu to change settings affecting many PCB actions. For
       example, you can use the Options commands to determine block selection criteria (selection
       mask), set default units (mm or mils), grid settings, object display colors, and object styles.


Options Selection Mask
       Choose Options » Selection Mask to open a dialog that you use to define your selection criteria for
       block select operations, and for defining the single selection behavior for collocated objects. With
       this command, you can configure the block select feature to select all objects, objects by type, or
       even objects with specific parameters. You can also specify your selection criteria on a layer-by-
       layer basis. For example, certain types of objects for one layer, another type for another layer, etc.
       The selection possibilities can be as specific or general as you choose. For example, if you want to
       change 10 mil lines to 15 mil lines on a specific layer set, you could do it very easily with this
       command with Edit Select and Line Properties, without affecting any other line widths on these or
       any other layers (not to mention ignoring all other objects within the block selection).
       After you set up your block selection criteria, you can block select a group of objects by drawing a
       bounding outline around a group of objects. A bounding outline is the dotted rectangle that
       appears when you drag the mouse cursor across your workspace, to select a range of items or a
       design region. For more information, see Edit Select (page 356).
       When you choose Options » Selection Mask, the Options Selection Mask dialog appears. From this
       dialog you can set criteria affecting the selection of specific objects and layers, as shown in the
       following figure.




P-CAD PCB User’s Guide                                                                                    423
Chapter 17: Options Commands                                                            Options Selection Mask




      Items
        In the Items frame of the Options Selection Mask dialog, you can specify the objects that you want
        to include or exclude in a block select. If you want to include or exclude only a few items, choose
        one of these methods:
        •     If you want to include only a few items in your selection, click Clear All to cancel the selection
              of all check boxes in this frame. Then, select the check boxes that correspond to the items you
              want to select.
        •     If you want to exclude only a few items from your selection, click Set All to select all of the item
              check boxes. Then, clear the check boxes that correspond to the items that you want to
              exclude from your selection.

        Items Buttons (Selection Mask Dialogs)
        Some of the check boxes in the Items frame have a corresponding item button (e.g., Arc,
        Component). These check boxes have three states:
        •     Included (The check box is selected).




424                                                                                    P-CAD PCB User’s Guide
Options Selection Mask                                                       Chapter 17: Options Commands


       •   Excluded (The check box is cleared).
       •   Masked (A shaded check mark appears).
       The following figure shows you an example of a check box in each state: selected (e.g., Arc), cleared
       (e.g., Attribute), and shaded (e.g., Component).




       When you click a check box so a shaded check mark appears, the corresponding item button
       becomes active. You can then click the button to open a Selection Mask dialog. You use this dialog
       to create a selection mask, which narrows the scope of your block selection criteria.
       For example, if you click the Arc check box so a shaded check mark appears, the Arc button
       becomes active. Then, when you click Arc, the following Arc Selection Mask dialog appears:




       In the Selection Mask dialog, you can specify the parameters for the particular object that you want
       as part of the selection block.
       For example, to create a selection mask for arcs, you set the search criteria (in this case, arcs with an
       arc width of 50 mil) in the Arc Selection Mask dialog. If you designate 50 mil for the Arc Width, then
       when you do a block select, only 50 mil arcs will be selected within the block.

   Layers
       Use the options in the Layers frame of the Options Selection Mask dialog to select any combination
       of layers for the selection mask. When you choose a layer, it becomes highlighted in the list. You
       can individually select or cancel the selection of a layer by clicking on a succession of layer names
       and they will become part of (or be excluded from) the selection list.
       If you want to exclude only a small number of layers, click Set All (the default setting) and
       individually choose the layers to exclude. To include only a limited number of layers, click Clear All,
       then individually choose the layers to include in your block selection.



P-CAD PCB User’s Guide                                                                                       425
Chapter 17: Options Commands                                                            Options Selection Mask


      Layer Sets
        Use the Layer Sets list to apply the selection to specific, predefined layer sets. To select a layer set,
        do the following:
        1.   Select a layer set from the Layer Sets list.
        2.   Click Apply Layer Set.
        The layers belonging to that set are selected in the Layers box.
        See Options Layers (page 450) for information on creating layer sets.

      Select Mode Frame
        The options in the Select Mode frame give you the ability to include or exclude items in a block
        select, depending on their position relative to the bounding outline of the selection block. These
        options are as follows:
        •    Inside Block: Choose this button to select all items completely inside the bounding outline of
             the selection block.
        •    Outside Block: Choose this button to select items that are outside of the bounding outline of
             the selection block. All of the selection criteria that you specify in the Options Selection Mask
             dialog will apply to objects that are outside the selection block, rather than inside the block.
        •    Touching Block: Choose this button to select all items that both touch and fall inside the
             bounding outline of the selection block. This is a more inclusive selection option than Inside
             Block.

      Selection Mask Parameters
        This is a basic summary of the parameters you can choose from in the Selection Mask dialog.
        •    Arc: You can specify line width of arcs for a block select. You can also block select arcs that
             have been fixed in place. For more information, see Edit Properties (page 292) and Arc
             Properties (page 314).
        •    Line: You can specify line segments for a block select and block select fixed lines. For more
             information, see Line Properties (page 313).
        •    Component: You can specify component type, reference designator, pattern, value, fixed
             property and attributes. For example, you can include a specific component of a certain value,
             and the block select will include only those of that value. For details, see Edit Properties (page
             292).
        •    Copper Pour: You can specify Pour Pattern, backoff, smoothness, state, thermal island
             removal, line properties and a specific net to include in the selection criteria. If the copper
             pour has filleted corners you can block select using the fillet handles and the chord height.
             You can also select copper pours that are fixed in place. For more information, see Copper
             Pour Properties (page 317).




426                                                                                    P-CAD PCB User’s Guide
Options Selection Mask                                                        Chapter 17: Options Commands


       •    Cutout: You can specify the layer as part of the selection criteria. If the cutout has filleted
            corners you can block select using the fillet handles and the chord height. For more
            information, see Cutout Properties (page 323).
       •    Polygon Keepout: You can specify the layer as part of the selection criteria. If the keepout has
            filleted corners you can block select using the fillet handles and the chord height. See Polygon
            Properties (page 315) for more information.
       •    Pad: You can include Pad Number, Pad Style and Fixed pads in the selection criteria. For more
            information, see Pad Properties (page 354).
       •    Plane: You can include Net and Boundary Width in the selection criteria. If the plane has
            filleted corners you can block select using the fillet handles and the chord height. See Plane
            Properties (page 323) for details.
       •    Polygon: You can include the copper tie, fillet handles and the chord height if the polygon has
            filleted corners. See Polygon Properties (page 315) for more information.
       •    Room: You can include Name, Rules, Placement Side, Fill Pattern and the Fixed Property in the
            selection criteria. For details, see Room Properties (page 325).
       •    Test Points: You can choose the Top or Bottom option button to select points that reside on
            either the Top or Bottom side of the board. You can also select the Fixed or Snap to Center
            check boxes to choose points with those properties. For more information, see Test Point
            Properties (page 316).
       •    Text: You can use the mask feature to search for a specific text string, justification, and text
            style in your block select. For more information, see Text Properties (page 327).
       •    Via: You specify the via style to include in the block select as well as selecting only fixed vias.
            See Via Properties (page 311) for more information.

   Selecting and Modifying
       This is a scenario for selecting and modifying all lines of a width of 12 mil and changing them to 15
       mil.
       1.   Choose Options » Selection Mask to open the dialog.
       2.   Click Clear All to cancel the selection all of the items in the Items frame (the X disappears from
            each box).
       3.   Click the Line check box until a shaded check mark appears. The Line button then becomes
            shaded.
       4.   Click the Line button to open the Line Selection Mask dialog.




P-CAD PCB User’s Guide                                                                                         427
Chapter 17: Options Commands                                                           Options Selection Mask




         5.   In the Width box, type: 12.0mil
         6.   Click OK to return to the Options Selection Mask dialog.
         7.   In the Layers frame, click Set All to select objects on all layers.
         8.   In the Select Mode frame, choose Inside Block.
         9.   Click OK to close the Options Selection Mask dialog.
         10. In you workspace, block select the entire design. To do this draw a bounding outline around
             the entire design. Only the 12 mil lines will be selected.
         11. Choose Edit » Properties. In the Width box, type: 15 mil
         12. Click OK.
         All 12 mil lines in the design will be converted to 15 mil.

         Items, which are part of a component (e.g., pads, silk attributes) are not affected.

      Single Selection Tab
         The Single Selection tab is used to control two selection features:
         •    Masking Objects during single selection – the options in the Single Selection tab are the same
              as the Block Selection tab, they are used to define exactly which object(s) on which layer(s) are
              able to be selected.
         •    How Collocated Objects are dealt with – the options in the Single Select Mode frame
              determine what happens when you click on collocated objects. If the Cycle-Picking option is
              selected then each collocated object is selected in turn as you continue to click on the
              collocated objects. If Popup dialog is selected a small dialog is displayed, from which you can
              click to choose the object to be selected.

         The popup dialog is also displayed when you use the CTRL click feature to perform a multiple
         selection at a location where there are collocated objects. In this case each entry in the popup
         dialog includes a check box, enable the check box for each collocated object you want to select.
         Click on the exclamation mark at the top left of the dialog to carry out the selection.




428                                                                                   P-CAD PCB User’s Guide
Options Configure                                                           Chapter 17: Options Commands



Options Configure
       Choose Options » Configure to set various configuration options and parameters for P-CAD PCB.
       When you choose this command, the Options Configure dialog appears with the General tab
       active, as shown in the following figure:




       For details on the options available in each tab, see the following sections:
       •   General Tab, page 429.
       •   Online DRC Tab, page 433.
       •   Route Tab, page 435.
       •   Manufacturing Tab, page 437.



   General Tab
       The General tab contains the following options:




P-CAD PCB User’s Guide                                                                               429
Chapter 17: Options Commands                                                             Options Configure


       Units
       You can alter your display units between mils and millimeters with this option. Dimensions are not
       altered, only the unit of measurement of dimension. A mil equals 0.001 inch or.0254 mm. A mm
       equals 0.001 meter. When the selected unit is mm, you can control the number of digits displayed
       to the right of the decimal point by modifying the MillimeterPrecision setting in the .ini file. The
       default displayed precision is three decimal digits, but can be changed to an integer value of 2
       through 5.
       This setting affects all dialogs, reports, Status Line displays, etc., containing measurements. For
       example, setting Units to mm causes dialogs such as DXF Out, Pad Style, Via Style, etc., to display
       measurements in millimeters. These units can be overridden in many command settings.

       Workspace Size
       You can set your workspace size to the specified dimension. If you change units, then the values in
       this box will change to reflect the units (although the size will remain constant).

       Pour/Repour Option
       Choose one of the buttons in the Pour/Repour Option frame to define the pour order that P-CAD
       uses when you select a group of copper pours.
       •   Smallest to Largest: Choose this button to pour or repour a group of selected copper pours
           according to size, from smallest to largest. This option is selected by default.
       •   Selected Order: Choose this button to pour or repour a group of selected copper pours in the
           order you select them.

       ECO Format
       To generate Engineering Change Orders (ECOs), you turn on the ECO recorder by choosing Utils »
       Record ECOs. From the Options Configure dialog, you can select a format for these ECO files. This
       format applies to the active design.
       The ECO file is generated in a ECO format or a Was/Is format. Choose the ECO Format or the
       Was/Is Format radio button to select a format.
       ECO format records full ECOs. The Was/Is format records only RefDes changes.

       Connection Options
       Select the Optimize Partial Route check box to indicate whether the guide connection is to be
       optimized for Manhattan length after manual routing. When this option is selected, pressing the
       SLASH key during manual routing terminates the route and causes the guide connection line to
       connect to the nearest net endpoint. This optimization doesn’t occur if the check box is not
       checked, or if the net being routed has an “OPTIMIZE=NO” attribute.
       The Optimize After Delete check box is used to indicate whether any connections added after a
       trace is deleted should be added in an optimized manner. If it is not necessary to add a connection
       to maintain connectivity, none will be added. If a connection is necessary, and either the check box
       is not checked or the net has an “OPTIMIZE = NO” attribute, the connection is added at the same
       location as the deleted trace.



430                                                                                P-CAD PCB User’s Guide
Options Configure                                                          Chapter 17: Options Commands


       The Optimize Max Node Count check box is used to specify the maximum node count desired
       when determining whether a net is automatically optimized. If a net has more than the number
       entered here it is not optimized. The default count is 20 and the count specified is saved in the
       Pcb.ini file.
       To prevent a net(s) from optimizing, set the net attribute OPTIMIZE = “False”. See Edit Commands
       (page 279) for more information on setting net attributes.

       IMPORTANT: If you have chosen to include Connections in the Options Selection Mask dialog,
       and select a block of data in the design, any connections present in the group of selected items are
       not optimized.

       AutoSave
       Use the options in the AutoSave frame to enable the AutoSave feature, which regularly saves your
       files at a user-defined interval, in a compressed or non-compressed format. AutoSave won’t be
       performed during autorouting or if a tool is busy.
       The AutoSave frame contains the following options:
       •   Enable AutoSave: Select this check box to turn on the AutoSave feature.
       •   AutoSave Time Interval: Enter the time between saves. AutoSave uses a rolling backup to save
           files, incrementing each subsequent autosave file.
       •   Purge Previous Backups: When selected, the option causes all backups saved from the
           previous design session to be deleted when you begin a new design session.
       •   Number of Backup Files: Allows you to specify the number of design files to be archived
           before file names are reused. This must be a number between 1 and 99.
       •   Compress AutoSave Files: Compresses the file so that it uses less space when saved.

       Autopan
       Enter a value in the Autopan box to adjust the amount of autopanning that occurs when you move
       the cursor to the edge of the screen with the arrow keys. An autopan of 25 moves anything at the
       edge of the screen 25% nearer to the center of the screen; 50 moves fringe objects to the center,
       etc.

       Rotation Increment
       Enter a value in the Rotation Increment box to set a rotation value. The value you set here is
       activated when you select an object and press SHIFT+R to rotate it. Values must be between 0 and
       360 degrees, and can be specified down to tenth degree resolution.
       You can also press the R key to rotate a selected object by 90 degrees; R is not affected by what you
       specify in this dialog.




P-CAD PCB User’s Guide                                                                                     431
Chapter 17: Options Commands                                                              Options Configure


       Zoom Factor
       Enter a value in the Zoom Factor box to adjust the amount of zoom that occurs when you use the
       View » Zoom In or View » Zoom Out commands. A factor of 2.00 will double (or halve) the size of
       objects in the workspace, etc. Zoom factors must be greater than 1.00.

       File Viewer
       In the File Viewer box, enter the name of the program that you want to use as your system’s default
       file viewer. For example, type: Notepad. Then, when you view a report, log file, or error report, the
       document appears in the default file viewer you selected. If the program is in a directory that is not
       included in your Autoexec.bat path statement, include the complete pathname here.

       DDE Hotlinks
       Select the DDE Hotlinks check box to enable the exchange of hotlink data with P-CAD Schematic.
       Hotlink data consists of highlighting and unhighlighting commands for components and nets. The
       state of the DDE Hotlinks option is saved in the Pcb.ini file. For more information, see DDE
       Hotlinks (page 195).

       Solder Mask Swell
       Enter a value in the Solder Mask Swell box to set the solder mask swell value globally for all pads on
       the Top and Bottom solder mask layers. You can override the global swell value by specifying a pad
       style for the Top Mask and Bottom Mask layers (Options Pad Style).
       A Solder Mask Swell resists the solder mask on the mask layers, in effect allowing solder to be
       placed both on the pad and the swell around it. The swell that is created conforms to the shape of
       the pad increasing the pad shape by the swell value. The swell value is added to the pad as a radius,
       enlarging the pad shape in all directions; therefore, if you have a 60 mil diameter pad and add a
       swell of 10 mil, the total diameter of the swell would be 80 mils. When you define a pad size for the
       Mask layer (creating a local swell value), the global swell value is ignored.
       You can view the increased size by making the Mask layer current, and then redrawing (View
       Redraw) to see the results.

       Paste Mask Shrink
       Enter a value in the Paste Mask Shrink box to set the paste mask shrink value globally for the Top
       and Bottom Paste layers. You can override the global value with a local value by specifying a
       reduced pad size for the Top and Bottom Paste layers (Options Pad Style.
       A Paste Mask Shrink reduces the size of the area that paste will be applied to when components are
       attached to the board in manufacturing (to prevent paste from squeezing out when it shouldn't.
       The shrink is a radius value and should be figured as such when subtracting it from the diameter
       value of a pad. For example, a 60 mil pad with a 10 mil shrink value will create a 40 mil diameter
       entity. When you define a pad size on the Paste layer (creating a local shrink value), the global
       shrink value is ignored.
       You can view the reduced size by making the Top Paste layer current, and then redrawing (View
       Redraw) to see the results.




432                                                                                P-CAD PCB User’s Guide
Options Configure                                                          Chapter 17: Options Commands


       Plane Swell
       Enter a value in the Plane Swell box to define the global plane swell setting. You can override the
       global value by enabling and setting the Local Swell option in the Pad Style Properties dialog.
       A Plane Swell is the gap between the copper on the plane layer and the hole on a pad or via which
       is not connected to the plane. A plane swell would not be applicable to pads or vias that are
       thermally or directly connected to the plane.

       Auto Plow Copper Pours
       When you select the Auto Plow Copper Pours check box, copper pours affected by new copper
       generated by the Route Manual or Route Interactive tools will autoplow when the route Completes
       or Suspends. Plowing can create more islands if you splinter existing islands, yet Automatic Island
       Removal is still performed using the settings you established for that copper pour.

       Compress Binary Designs
       Select the Compress Binary Designs check box to automatically compress binary files when you
       save them.

   Online DRC Tab
       You can enable several Online DRC features by selecting various options in the Online DRC tab, as
       shown in the following figure:




P-CAD PCB User’s Guide                                                                                       433
Chapter 17: Options Commands                                                               Options Configure




       With the Online DRC function, select the Enable Online DRC check box to check for clearance and
       net width violations, shorts of traces (both lines and arcs) and vias, and net references to non-
       existent via styles that are added to a design during manual routing. Depending on the options
       chosen in the General tab of the Options Configure dialog, online DRC performs a check of the
       traces and vias against all items, excluding copper pours, on signal layers to determine if a DRC
       violation occurred. A violation occurring on a non-signal layer (such as a via intersecting a silk layer
       item) is not detected with Online DRC.
       When Online DRC is enabled, the following DRC checks can be included if you select the
       appropriate check boxes in the Report Options list: Netlist Violations, Clearance Violations, Text
       Violations, Silk Screen Violations, Component Violations and Width Violations. The following DRC
       options are not available with Online DRC: Netlist Compare, Unrouted Nets, Unconnected Pins,
       Net Length, Copper Pour Violations, Plane Violations, Tie Nets and Drilling Violations.
       In addition to setting report options, you can open the Options Design Rules dialog by clicking the
       Design Rules button. See Options Design Rules (page 459) for details.
       Severity Levels can be set for each rule in the design. In the Online DRC tab, click Severity Levels to
       open the Rules Severity Level dialog shown in the following figure.




434                                                                                 P-CAD PCB User’s Guide
Options Configure                                                          Chapter 17: Options Commands




       You can select one or more rules and, in the Severity Level frame, choose one of the three levels
       (Error, Warning or Ignored) by clicking the appropriate radio button. When a rule is in violation and
       its severity level is set to Ignored it is summarized in the report if the Summarize Ignored Errors
       option is enabled in the Utils Design Rule Check dialog. For more information, see Utils DRC (page
       506).
       If you select the View Report check box, a report of violations created during routing is
       automatically presented after the command is complete.
       Although you can enable or disable the Online DRC feature at any time, the feature defaults to
       disabled when you create a new design. The current Online DRC setting is saved to a design file
       and restored when a design file is opened.
       A button for Online DRC is included on the toolbar. When the button is indented, Online DRC is
       turned ON; otherwise, it is OFF. You can also enable and disable Online DRC from within macros.
       See Route Manual (page 408) for additional information.

   Route Tab
       When you click the Route tab, the Options Configure dialog appears as follows:




P-CAD PCB User’s Guide                                                                                   435
Chapter 17: Options Commands                                                            Options Configure




       Use the Route tab to set options for the Route Manual and Route Interactive tools. When the Route
       Interactive tool is active, you can open this dialog by right-clicking and choosing Options from the
       shortcut menu.
       This dialog contains the following options:

       T-Route Default
       •   T-Route Default: When the check box is selected, T-routing is the normal mode. You don’t
           need to press the SHIFT key first.

       Highlight While Routing
       •   Highlight While Routing: Use these radio buttons to select which items to highlight while
           routing. Choose Pads Only to highlight only pads. Choose Pads, Traces and Connections to
           highlight the pads their connections and traces as you lay them down.

       Miter Mode
       Choose one of the buttons in the Miter Mode frame to select a miter mode for the Route » Miter
       command. You can choose Line (45° corners) or Arc (90° rounded corners).




436                                                                              P-CAD PCB User’s Guide
Options Configure                                                         Chapter 17: Options Commands




           A                         B

       Manual Route
       Choose one of the buttons in the Manual Route frame to set the behavior of the SLASH key and
       right-click action while manual routing:
       •   Choose Right Mouse to Complete/Slash Key to Suspend when you want to be able to right-
           click to complete a route and press the SLASH key to suspend routing.
       •   Choose Slash Key to Complete/Right Mouse to Suspend when you want to be able to press the
           SLASH key to complete a route and right-click to suspend routing.

       Orthogonal Modes
       Orthogonal modes are used while routing (Route Manual) or placing lines (Place Line) using lines
       that are horizontal, vertical, at 45-degree angles or with arcs. Orthogonal modes provided consist of
       three mode pairs, along with the tangent mode. Press the O key to switch between orthogonal
       modes and press the F key to switch between the current mode pair.
       •   90/90 Line-Line: Creates true 90-degree angles, long and short.
       •   45/90 Line-Line: Creates 45/90 and 90/45 angles.
       •   90/90 Arc-Line: Creates a combination straight line and arc, in long and short.
       •   Tangent Arc: Creates arcs that are tangential to their connected lines using the current radius.

       Interactive Route
       The options in the Interactive Route frame apply to the actions you can perform with the Route
       Interactive tool:
       •   Stub Length: The suggested minimum length in grid points of the line segment, which is used
           to enter or exit the pad. For non-uniform grids, one grid space is the sum of the grid values.

   Manufacturing Tab
       Use the Manufacturing tab of the Options Configure dialog to specify the solder flow direction and
       other physical behaviors for the manufacturing process.




P-CAD PCB User’s Guide                                                                                   437
Chapter 17: Options Commands                                                              Options Configure




       Solder Flow Direction
       The Solder Flow Direction group allows the user to specify the direction the solder flow is
       traversing the board. The available options are: Top to Bottom, Left to Right, Right to Left and
       Bottom to Top.

       Synchronize Components to solder flow, on OK
       The Synchronize Components to solder flow, on OK, checkbox determines whether the patterns in
       the design will be updated in line with the chosen solder flow direction. If the check box is
       checked, then upon pressing OK, after changing the direction of solder flow, the patterns on the
       board will be updated automatically with the appropriate alternate pattern graphics for the new
       solder flow direction.

       Solder Mask Swell
       Allows you to set the solder mask swell value globally for all pads on the Top and Bottom solder
       mask layers. You can override the global swell value by specifying a pad style for the Top Mask and
       Bottom Mask layers (Options Pad Style).
       The swell that is created will conform to the shape of the pad, increasing the pad shape by the swell
       value. The swell value is added to the pad radially, enlarging the pad shape in all directions. When



438                                                                                P-CAD PCB User’s Guide
Options Grids                                                                Chapter 17: Options Commands


       you define a pad size for the Mask layer (creating a local swell value), the global swell value is
       ignored.
       You can view the swell size by making the Mask layer current, and then redrawing (View Redraw) to
       see the results.

       Paste Mask Shrink
       Allows you to set the paste mask shrink value globally for the Top and Bottom Paste layers. You can
       override the global value with a local value by specifying a reduced pad size for the Top and
       Bottom Paste layers (Options Pad Style).
       The shrink value is applied radially to all sides of the pad. For example, a 60 mil pad with a 10 mil
       shrink value will create a 40 mil diameter entity. When you define a pad size on the Paste layer
       (creating a local shrink value), the global shrink value is ignored.
       You can view the reduced size by making the Top Paste layer current, and then redrawing (View
       Redraw) to see the results

       Plane Swell
       Allows you to set the plane swell value for all pads, which applies unless a pad has its local swell
       option enabled.
       Plane Swell is the gap between the copper on the plane layer and the hole on a pad or via which is
       not connected to the plane. Plane swell is not applicable to pads or vias that are thermally or
       directly connected to the plane.


Options Grids
       Choose Options » Grids to define the current editing grid. Grid options and settings are saved in
       your design file.




       The grid units used are determined by the Units setting in Options Configure. For details, see
       Options Configure (page 429).




P-CAD PCB User’s Guide                                                                                         439
Chapter 17: Options Commands                                                                      Options Grids


      Mode
         In the Mode frame, choose Absolute when you want the grid origin point to be the lower-left
         corner of the workspace. Choose Relative to allow any point as an origin point.
         A typical setting is to set your Absolute mode to 100 mil grid spacing and Relative to 25 mil grid
         spacing. You can then click the Abs and Rel toggle buttons on the Status Line to switch between
         100 mil and 25 mil grid. (The relative grid origin should be set to Absolute 0,0 for this to work.)

      Visible Grid Style
         Select the Visible check box to show or hide grids. When you select this check box, the grid style
         options are available. Dotted pinpoints grid points, while Hatched draws lines along the grids to
         show grid intersections (similar to graph paper).

      Relative Grid Origin
         To specify your X and Y relative grid origins, enter the coordinates in the X and Y boxes. When you
         do this, you must clear the Prompt for Origin check box.
         If you switch to a relative grid (by choosing Relative in the Options Grids dialog) and the Prompt
         for Origin check box is selected, you will be prompted for the new origin point after you click OK.
         You will be prompted every time you change from absolute to relative grids by clicking the Abs or
         Rel toggle button on the Status Line. Or, by pressing the A key.

      Grid Spacing: Uniform/Non-uniform
         You can select appropriate values for grid spacing for specific modes in the Grids list. You are not
         limited to using the grids in the list; you can specify your own custom grid spacing in the Grid
         Spacing box, then click Add to add it to available choices in the list. To delete a grid-spacing value,
         select the value in the Grids list and click Delete.
         The routing grid defines the spacing pattern of the grid points. The grid pattern may be uniform
         (equal spaces between all lines) or it may be non-uniform to allow one or more lines to pass
         between component pads, while keeping the number of grid points to a minimum.
         Uniform grids are generally used for relatively simple, low-density PC-boards. The illustration
         below shows 60-mil pads spaced 100-mils apart, 50-mil grid spacing (using the hatched grid option),
         with one routing connection running between the pads.




440                                                                                   P-CAD PCB User’s Guide
Options Grids                                                              Chapter 17: Options Commands




       Non-uniform grids are typically required on complex, high-density PC-boards to achieve
       completion of the connections in the minimum amount of time.
       The main benefit of the non-uniform grid over the uniform grid is performance: it produces far
       fewer grid positions without the loss of route paths. Thus, completion time is shortened and more
       freedom in placement is allowed.
       For example, if you have 100-mils between grid points, you can set non-uniform grid spacing to 40-
       20- 40, which would allow two grid points between pads spaced 100 mils apart.




       Remember to set up your grids correctly before you place your components. It is important that
       you place the components on the appropriate grids (e.g., standard DIP components on 100-mil
       absolute). You can subsequently alter your grid spacing for routing purposes (such as non- uniform
       as described above).

   Grid Toggle Button (or G key)
       You can switch between your absolute and relative grid settings by clicking the Abs or Rel grid
       toggle button. Or, you can press the G key. Your absolute and relative grids are determined by
       what you have set in the Options Grids dialog. For example, if you have Relative set to 25 mils and
       Absolute set to 100 mils, the Status Line will read 25 mil when you are in Relative grid and 100 mil
       when you are in Absolute grid.



P-CAD PCB User’s Guide                                                                                    441
Chapter 17: Options Commands                                                                   Options Display


        If you click the Grid toggle button or press the G key to switch to Relative grid, you will be
        prompted for the origin point if you have the Prompt for Origin check box selected in the Options
        Grids dialog. The crosshair cursor (the cursor displayed when the system is awaiting input) is
        displayed; when you click in the workspace, that becomes the relative origin point (X=O, Y=O) and
        the cursor returns to normal.


Options Display
        Choose Options » Display to open the Options Display dialog. There are two tabs in this dialog:
        Colors and Miscellaneous. With these tabs, you define your workspace preferences.




      Colors
        This tab contains two frames and a Defaults button. Click Defaults to return your display setup to
        the default scheme. Any color settings established here are saved in your Pcb.ini file when you
        close the dialog. These settings affect your designs in subsequent sessions, until you change them.

        If you have a color printer, clicking the Defaults button also restores default color settings for
        printing. For information on print colors, see Colors and Other Print Options (page 214).

        The following sections describe how to use the controls in the Layers/Items Colors frame and the
        Display Colors frame. If you have a color printer, any changes you make in these frames also affect
        your print colors.




442                                                                                  P-CAD PCB User’s Guide
Options Display                                                              Chapter 17: Options Commands


       Layer/Item Colors
       The Layer/Item frame contains a color matrix with item buttons across the top and layer buttons
       along the side. Use the arrows or slider in the scroll bar to scroll down to any of the available layer
       buttons.
       There are three ways to choose color options:
       •    To select a color for everything that appears on a layer, click the corresponding layer button
            and select a color from the palette that appears. For example, click the Top button to select a
            color for everything that appears on the top layer of your design.
       •    To choose a color for an object on a layer, click an Item button. For example, click Via to
            choose a color for vias on all layers of your design.
       •    To choose a color for an object on a specific layer, right-click the colored square where the
            object and the layer meet in the matrix. Then, choose a color from the palette.
       You can also set a custom color. To learn how, see the following section. To close the color palette
       without choosing a color, press ESC or click Close.
       Setting A Custom Color
       To set a custom color, click Custom in the color palette. This opens a Color dialog that is standard
       to Windows. Next, choose a color from this dialog using one of these methods:
       Method 1: Select a Defined Custom Color
       1.   Click one the colors in the Basic colors frame.
       2.   Click OK to return to the color palette.
       Method 2: Define a Custom Color
       1.   Click the color matrix to define the Red/Green/Blue settings, or type the desired settings in the
            Red/Green/Blue boxes.
       2.   Click Add to Custom Colors.
       3.   When selected color appears in the Custom Colors area, click OK to return to the color
            palette.
       Some custom colors can display only when supported by your screen settings. If your screen
       supports 256 Colors, custom colors are approximated to the nearest solid color, while retaining the
       Red/Green/ Blue settings. If your screen supports more than 256 colors, custom colors display
       accurately.
       Once custom colors are selected, they appear as the chosen item or display color on the Options
       Display dialog or the Printer Colors dialog. These colors are saved in the .ini file for use in later
       design sessions. In the Custom Colors section of color palette, however, colors not selected for an
       item/display color are forgotten once you quit the P-CAD program.




P-CAD PCB User’s Guide                                                                                      443
Chapter 17: Options Commands                                                                   Options Display


        Display Colors
        In the Display Colors frame, there are several command buttons. Click one of these buttons to
        determine various PCB display colors. The settings configured with these buttons appear in your
        workspace, regardless of layer or item colors.

        When setting your display colors, make sure that the colors you pick do not conflict with any layer
        or item colors. For example, if the background color is set to be the same as the line color, lines will
        not be visible in your design.

        When you click a display color button, a color palette appears, so you can select a color for that
        item. For example, click Highlight to choose a color for highlighted objects. Later, if you choose to
        highlight an object during a PCB design session, the object color changes to the color set here. To
        highlight an object, click an object in your workspace and choose Edit Highlight.
        You can use highlight colors to highlight objects using different colors. To do so, change the
        highlight color, select the object, and choose Edit Highlight. Repeat this process for each object
        you want to highlight, so that each object selected has a different highlight color. When you
        change the highlight color of one object, it does not affect the highlight color of other highlighted
        objects, which are not selected.

      Miscellaneous
        To set up other display options for your workspace, click the Miscellaneous tab in the Options
        Display dialog. As shown in the following figure, this tab contains a number of options:




444                                                                                  P-CAD PCB User’s Guide
Options Display                                                            Chapter 17: Options Commands


       DRC Errors
       DRC error indicators contain information about design errors and the layer on which errors appear.
       In the DRC Errors frame, you have these options:
       •   Show: Choose this button to show DRC error indicators in your design.
       •   Hide: Choose this button to hide DRC error indicators.
       •   No Change: Choose this button to keep the current display setting.
       For information on DRC errors, see Utils DRC (page 506).

       Glue Dots
       Glue dots hold components in place until they are soldered during manufacturing. In the Glue
       Dots frame, you have these options:
       •   Show: Choose this button to show glue dots in your design.
       •   Hide: Choose this button to hide the display of glue dots.
       •   No Change: Choose this button to keep the current display setting.
       To learn more about glue dots, see Place Point (page 384).

       Pick and Place
       A reference point that directs the pick and place mechanism (or auto insert) in manufacturing. In
       the Pick and Place frame, you have these options:
       •   Show: Choose this button to display Pick and Place points in the workspace. A pick and place
           point can be part of a pattern when you create it.
       •   Hide: Choose this button to hide the display of pick and place points.
       •   No Change: Choose this button to keep the current display setting.
       For instructions on placing pick and place points, see Place Point (page 384).

       Cursor Style
       To change the style of your cursor, choose one of the following option buttons:
       •   Arrow
       •   Small Cross
       •   Large Cross
       The large cross extends horizontally and vertically to the edges of the PCB screen. There is no
       default setting for this frame. When you click Defaults, your current setting remains in effect.

       The Large Cross cursor style does not support the DataTips feature. Enabling this option clears the
       Show DataTips check box and makes the feature unavailable.




P-CAD PCB User’s Guide                                                                                     445
Chapter 17: Options Commands                                                                 Options Display


       Free Pads
       Choose one of these option buttons to change the display options for free pads:
       •   Pin Des. Show the default pin designators
       •   Number. Show the pad numbers.




       There is no default setting for this frame. When you click Defaults, your current setting remains in
       effect.

       Miscellaneous
       The Miscellaneous frame contains a number of check boxes. To enable an option, select its check
       box. Clear a box to disable an option. To restore the default settings at any time, click Defaults.
       •   Draft Mode. Enables the display of two items: (1) a thin (single-pixel) outline for pads, vias, and
           text. (2) a segmented and outlined representation of arcs, lines, and any line segment objects
           such as, polygons, cutouts, etc.
           When enabled, draft mode helps with faster redraws and viewing of any segment overlaps.




       •   Thin Stroked Text. Select this check box to display text in thin line mode. Clear this check box
           to display text in regular mode.
       •   Display Pad Holes. Select this check box to display pad holes in the active window. If the
           Translucent Drawing check box is also selected, pad holes are disabled from display.
       •   Display Pin Designators. Select this check box to display pin designators. Designators appear
           just above the pad center, but only when you are zoomed in sufficiently. This setting also
           affects the display of default pin designators and free pad numbers.




446                                                                                 P-CAD PCB User’s Guide
Options Display                                                           Chapter 17: Options Commands


       •   Display Plane Indicator. This option sets whether or not the plane indicator is displayed,
           allowing you to see to which plane a pad is attached.

           When viewing Gerber drill files, be sure to disable this option so they are not confused with
           drill symbol output.




       •   Display Pad Net Names. This option enables or disables the display of the pad net names just
           below the pad centers. To view net names, you must be zoomed in sufficiently. The following
           illustration shows the net names NET00001 and NET00002.




       •   Display Overridden Errors. Select this check box to display overridden errors in your design.
           Clear this check box to disable the display of overridden errors. To learn more about overrides,
           see Utils DRC (page 506).
       •   Drag by Outline. Clear this check box to show a ghosted image of the part and a bounding
           outline when you move or copy objects in your design. Select this check box to show only the
           bounding outline. This setting affects only the move and copy operations associated with the
           Edit Select command.
       •   Silkscreen in Background. Select this check box if you want silk layers to be drawn in the
           background. Clear the check box to have silk layers drawn in the foreground.
       •   Translucent Drawing. Select this check box to show objects in translucent mode. Clear this
           check box to show objects in opaque mode.
       •   Use Fixed Color. Select this check box to have fixed components drawn in the fixed
           component color. To set this color, click Fixed in the Colors tab.
       •   Scroll Bars. Select this check box to show Windows scroll bars in the active window. Clear this
           check box to hide the display of scroll bars.
       •   Show DataTips. Select this check box to show DataTips in the workspace. Clear the check box
           to hide the display of DataTips.




P-CAD PCB User’s Guide                                                                                     447
Chapter 17: Options Commands                                                        Options Preferences


        The Large Cross cursor style and the View » Snap to Grid command do not support the DataTips
        feature. For details, see Cursor Style (page 445) and View Snap to Grid (page 367).


Options Preferences
        Choose Options » Preferences to set up your keyboard and mouse preferences for P-CAD PCB.
        When you choose this command, the Options Preferences dialog appears with the Keyboard tab
        selected, as shown in the following figure.




      Keyboard Tab
        Use the options in the Keyboard tab to customize key assignments for menu commands, shortcut
        key commands, and macros.
        •   Command Type: Choose the type of command for which you want to change shortcut key
            assignments.
        •   Menu Commands/Shortcut Commands/Macros: Select the command or macro you want to
            add a shortcut key assignment to or from which you want to remove a shortcut key
            assignment.
        •   Current Keys: Displays the existing key assignments for the command or macro you select in
            the Menu Commands/Shortcut Commands/Macros list.




448                                                                            P-CAD PCB User’s Guide
Options Preferences                                                        Chapter 17: Options Commands


       •   Press a Shortcut Key: Press the keys you want to assign to the selected command or macro.
           You can press the CTRL or SHIFT key plus any other combination of numeric or alphabetic
           keys and function keys.

           F10 is reserved by Windows and cannot be assigned to any other command or macro.

           If the shortcut is currently assigned, the current assignment appears in the Current Binding
           field just below this box.
       •   Assign: Assigns the key appearing in the Press a Shortcut Key box to the selected command or
           macro. If the shortcut is currently assigned, the current assignment disappears
       •   Remove: Removes the key you select in the Current Keys box.
       •   Key File: Allows you to select or create a key binding file to use with this application. When the
           Select Key File dialog appears, select the file you want to use. The current key file appears at
           the top of the dialog, and is written to the Pcb.ini file.
       •   Defaults: Restores original default shortcut key assignments to all commands or macros.

   Mouse Tab
       When you click the Mouse tab, the Options Preference dialog appears as follows:




       The Mouse tab lets you customize certain mouse behaviors.




P-CAD PCB User’s Guide                                                                                    449
Chapter 17: Options Commands                                                                   Options Layers


       •   CTRL/SHIFT Behavior: Allows you to choose which keys to use (CTRL or SHIFT) for multiple
           (extended) selections and for subselections.
       •   Cycle-Picking Threshold: The number of pixels you can move the mouse during cycle-picking.
       •   Double-Click Displays Properties: When enabled, this option allows you to double-click an
           object to bring up the Properties dialog for that object.
       •   Allow Single Select on All Enabled Layers: When enabled this option provides the ability to
           single select across multiple, enabled layers. This option can also be enabled/disabled by
           pressing CTRL+L. The search order is as follows:
           1.   Current layer items.
           2.   Current layer components if on the Top or Bottom layers.
           3.   Multi-layer items; i.e., all-layer keepouts, components, pads, vias, connections and points.
           4.   All other layers in order.
           In addition, the Status Line shows the layer name of the selected object.


Options Layers
       Choose Options » Layers to view layers and make modifications to layer properties.
       When you choose Options » Layers, the Options Layers dialog appears. This tab contains the
       following tabs: Layers, Sets and Titles. When the dialog first appears, the Layers tab is selected, as
       shown in the following figure:




450                                                                                  P-CAD PCB User’s Guide
Options Layers                                                              Chapter 17: Options Commands




       This dialog allows you to set the current layer for the Place and Select commands. You can also
       arrange layers in a specific order. You can also add, delete, reorder, enable, and disable layers, and
       modify the routing bias of a layer.

   Layers Tab
       The Layers tab contains the following options:

       Layers
       In the Layers box are listed all existing layers of your design. The letter codes between the layer
       name and layer number represent the following:
       Type: S = Signal, P = Plane, N = Non-Signal
       E = Enabled, D = Disabled
       Routing Bias: A = Auto, H = Horizontal, V = Vertical (signal layers only)



P-CAD PCB User’s Guide                                                                                       451
Chapter 17: Options Commands                                                                 Options Layers


       Layers can be moved up and down the list by clicking Move Up and Move Down.

       Layer Name
       Shows the name of the currently selected layer.

       Layer Number
       Shows the number of the currently selected layer.

       Line Color
       Shows the line color for the current layer.

       Routing Bias
       These options are applied to a new signal layer (Add) or an existing signal layer (Modify). The bias
       values are used only by the autorouter; the Route » Manual command does not use these options.

       Type
       These options are applied to a new layer (Add). You cannot modify the Type of an existing layer.

       Actions
       The following list shows the actions performed for each button in the dialog:
       •   Move Up/Move Down: Arranges layers in your design to reflect the actual layer order of your
           board. However, signal and plane layers must be between the Top and Bottom layers.
       •   Add: Adds to the list whatever Layer Name you have specified, with the Layer Number, Routing
           Bias, and Type specified.
       •   Modify: Changes the routing bias on a signal layer and to change the net name of a plane layer.
           To modify the routing bias, select a signal layer, choose a routing bias option and click Modify.
           To modify a plane layer net name, select a plane layer, click Modify and enter the new name in
           the Plane Layer Net Name dialog.
           You can rename a layer although you can't change the Type or layer number. You can also
           reassign a plane net name.
       •   Delete: Removes a selected layer. You can delete any user-defined layer that is empty. You
           cannot delete a predefined layer.

           When you delete a layer, components are processed and stripped of any items that existed on
           the deleted layer; this is done without warning.

           When you delete a layer that a pad/via style’s hole range is dependent on, an error message
           appears explaining the dependency and which style you should correct. You are not allowed to
           delete a layer until there are no styles that are dependent on it.
       •   Current: Makes the selected layer the current layer (indicated by an asterisk).




452                                                                               P-CAD PCB User’s Guide
Options Layers                                                                 Chapter 17: Options Commands


            The current layer cannot be disabled. Also, items on disabled layers don’t appear and can't be
            edited.

       •    Enable/ Disable: Enables or disables the selected layer.
       •    Enable All/Disable All: Enables or disables all existing layers regardless of which layer is
            selected in the Layers list.

       Add a Layer
       When you add (create) a layer, you must give it a unique name, specify a layer number (one that is
       not already occupied), a routing bias, and a layer type. When you create a plane layer, you must
       give it a net name.
       1.   In the Options Layers dialog, type the new layer name in the Layer Name box and specify the
            Layer Number to enter the Add mode. The Add button is shaded until you specify layer name
            and number.
       2.   If you are adding a signal layer, click on the Routing Bias you want to use (used only by the
            autorouter).
       3.   Click the layer Type you want.
       4.   Click Add. The new layer will be listed in the list, with the layer type (S, P, or N), E for enabled,
            and the layer number you specified.
            Once a layer has been created/added, you cannot change its layer number or type.
            Signal/plane layers are placed just above the Bottom layer. Non-signal layers are placed at the
            bottom of the list.
       5.   Click Move Up and Move Down to arrange the layers in the appropriate order.
       6.   If this is a plane layer, you are prompted for a net name.

       P-CAD PCB (6/400) designs are restricted to a maximum of six copper layers, including a predefined
       Top and Bottom layer and four user-defined signal or plane layers. P-CAD PCB (6/400) designs can
       have a total of up to 999 layers.

       L key and Status Line
       You can press the L key or the Layer box on the Status Line (combo box and scroll arrows) as a
       shortcut for selecting the current layer. The current layer is identified by name and color on the
       Status line. Press SHIFT+L to scroll backwards through the enabled layers.

   Sets Tab
       When you click the Sets tab, the dialog appears as follows:




P-CAD PCB User’s Guide                                                                                         453
Chapter 17: Options Commands                                                                  Options Layers




       Layers sets let you group layers to control the selection, display, and printing of your design,
       Gerber output and N/C Drill output, DXF output.

       Current Layer
       The Current Layer list displays the name of the current layer for the selected layer set. You can
       change the current layer by selecting a different layer from the list.

       Layers
       The Layers box displays a list of all layers in the design.

       Set Name
       The Set Name box allows you to add a layer set name.

       Layer Sets
       The Layer Sets box displays a list of all layer sets in the design.



454                                                                                 P-CAD PCB User’s Guide
Options Layers                                                                Chapter 17: Options Commands


       Set Contents
       The Set Contents box displays a list of all layers in the currently selected layer set.

       Adding or Modifying a Layer Set
       To add or modify a layer set, follow these instructions:
       To add a new layer set, type a new name in the Set Name box and press New. The newly-added
       layer set is empty.
       1.   To add a layer to the set, select the layer set from the Layer Sets box. Select the layer to be
            added from the Layers box and click Add.
       2.   To remove a layer from a layer set, select the layer set from the Layer Sets box. Select a layer
            from the Set Contents box and click Remove.
       3.   Click Enable Layers to save the layer set.
       4.   To delete a layer set, select it and click Delete.

   Titles Tab
       The Titles tab of the Options Layers dialog allows you to specify the look of your title block, design
       boundary and zones for each layer in your design. You can also assign a field set to a layer, so that
       each layer can be uniquely annotated. The Titles tab appears as shown in the following figure:




P-CAD PCB User’s Guide                                                                                         455
Chapter 17: Options Commands                                                                       Options Layers




        When setting up output files (Gerber, Print and DXF) only the data displayed in the workspace is
        output. It is important, therefore, to turn on the appropriate display options (Display Border and
        Annotate Zone Information) on the Titles tab of the Options Layers dialog.

        The options available in the Titles tab are:

      Layers
        Lists the layers of the design. To specify the Titles options of a layer(s), select the desired layer(s) in
        the list.

        Border Frame
        In the Border frame you can set the following options:
        •   Height/Width: Shows the height and width of the border that surrounds the design. The
            default border height and width have a 1/2 inch buffer from the workspace bounds.



456                                                                                     P-CAD PCB User’s Guide
Options Current Line                                                            Chapter 17: Options Commands


       •   Display Border: To display the border in the workspace or on the printed output or to include
           it in a Gerber output file, select the Display Border check box. The border outline the
           boundaries of the design.

       Zone Frame
       The Zone frame accesses the following settings in both the Horizontal and Vertical frames:
       •   Alpha or Numeric for the zone label display.
       •   Ascending to specify zone labels increasing vertically from top-to-bottom or horizontally from
           left- to-right.
       •   Descending to specify zone labels decreasing in the same directions as the Ascending option.
       •   # of Zones.

       Annotate Zone Information
       Select the Annotate Zone Information check box to display the zone labels.

       Text Style
       Select the style of text you want to use from the list of Text Styles.

       Title Block Frame
       The following information appears is the Title Block frame:
       •   File » Name: Display the currently selected title block file name. To change the to another
           block file, click the Select button. To remove the selected title block, click the Remove button.
       •   Lower-Right Offset: If the origin of the border differs from the default in the lower left hand
           corner of the workspace, specify different X and Y coordinates in this frame.

       Field Set
       Select the field set you want to assign to the currently selected layer(s) from the list. Click the Field
       Sets button to modify, delete or add a field set. Click the Fields button to open the File Design Info
       dialog where you can assign fields and notes to each field set.

       Modify/Close
       Click the Modify button to update the Titles options of the layers selected in the Layers list with the
       current settings. Click Close to exit the Options Layers dialog and save the modifications.


Options Current Line
       Choose Options » Current Line to set the current line width for the Place Line, Place Arc, and Route
       Manual commands. The current line setting doesn't affect placing of line segments for polygons,
       copper pours, keepouts, connections, etc.




P-CAD PCB User’s Guide                                                                                        457
Chapter 17: Options Commands                                                            Options Current Keepout




         When the dialog appears, the Line Width box contains the current line width value. The current
         line width is highlighted in the list.
         To choose a new line width value, select a new value from the list.
         To add a new line width value, type the new value in the Line Width box and click Add. The new
         value is inserted in the list before the highlighted value. To add a new value and make it the current
         value in one step, type the new value in the Line Width box and click OK.
         To delete a value, select it from the list and click Delete.

      Overriding Default Units
         The units displayed as default in Options » Current Line are determined by what is set in Options
         Configure. To reset units, use Options Configure, or you can override the default units by typing in
         an explicit suffix (e.g., in) in the Options Current Line dialog. Valid suffixes are: mm, mil, in, and cm.
         The current line settings are saved to the Pcb.ini file.
         To change the line width (thickness) of existing lines and arcs (routed lines and arcs as well),
         choose Edit » Properties.


Options Current Keepout
         Keepouts are used to designate certain areas of your design as off limits to certain processes, for
         example routing. Keepouts can be either polygons or lines, and they can be specific to a layer, or
         can apply to all layers.
         Choose Options » Current Keepout to set the keepout Style and Layer in the Options Current
         Keepout dialog. These settings will apply when you select the Place » Keepout command. The
         following figure shows you the Options Current Keepout dialog:




458                                                                                     P-CAD PCB User’s Guide
Options Current Radius                                                       Chapter 17: Options Commands


       In the Style frame, choose the style of the keepout barriers (Line or Polygon). In the Layers frame,
       choose Current to restrict keepouts to only certain layers (the current layer) or All to place one
       object that applies to all signal and plane layers.
       For related information, see Place Keepout (page 390).


Options Current Radius
       When you choose Options » Current Radius, the following Options Current Radius dialog appears:




       Use the Options Current Radius dialog to select the radius to be used when rounding the corners
       of polygonal shapes, including copper pours, cutouts, polygon keepouts, planes and polygons. The
       Current Chord Height, which is the maximum distance between a perfect arc and the actual arc,
       can be designated in the Options Current Radius dialog as well.
       The radius setting you choose determines the curvature of the arc used to draw the rounded
       corner. Since the majority of polygonal shapes have on-grid corners with fillet radii that are
       multiples of the placement grid, it is suggested that the radius setting be a multiple of the grid.
       You can add new settings and delete those that you have added in the Options Current Radius
       dialog. The predefined settings shown above cannot be deleted. The current radius setting is
       displayed in and can also be controlled from the Current Radius combo box on the Status Line.
       See Edit Commands (page 279) for related information on rounding the corners of the polygonal
       shapes listed above.


Options Design Rules
       The rules for a board’s clearances, widths, lengths and placements are set in the Options Design
       Rules dialog, which is opened by choosing the Options » Design Rules command. Design rules can
       be defined on each of six levels: Design, Layer, Rooms, Net Class, Net and Class-to-Class. Each of
       these levels, found on individual tabs in the dialog, is described in the following sections.

   Design Tab
       The Design tab displays the clearance values that are applied at the “design” level of the hierarchy:




P-CAD PCB User’s Guide                                                                                       459
Chapter 17: Options Commands                                                           Options Design Rules




        To add design rules, click Add to open the Place Attribute dialog. The Properties button opens the
        Attribute Properties dialog where the value of a rule can be modified. For more information on the
        Place Attribute and Attribute Properties dialogs, see Edit Attributes (page 350).

      Layer Tab
        As shown in the following figure, the Layer tab contains the default clearance values for signal
        layers:




460                                                                                P-CAD PCB User’s Guide
Options Design Rules                                                          Chapter 17: Options Commands




       In the Layer tab, the following options are available:
       •   Set All: Click Set All to select all layer names with items in the Layers list.
       •   Clear All: Click Clear All to cancel the selection of all layers in the list. You can select or cancel
           the selection of a layer by clicking a layer in the list.
       •   Update: The clearance values of the layer you select appear in the Pad to Pad, Pad to Line, Line
           to Line, Pad to Via, Line to Via, and Via to Via boxes. If you have a variety of settings and you
           click on two layers that contain conflicting values, the box is blank. The value you enter in the
           box is applied to the selected layer(s) when you click Update.
       To modify a clearance value for the selected layers, type a value in one of the text boxes and click
       Update. Nets with clearance rules defined will override the layer clearance values for DRC. The
       report produced by the DRC includes clearances specified for specific nets. Additionally, clearance
       violation tests report shorts except where two or more nets are tied with a copper tie and the
       TieNet values of the nets and copper tie are the same.
       •   Edit Rules: Click Edit Rules to open the Attribute dialog where you can add, delete and view a
           rule’s properties. For information on the Attribute dialog, see Place Attribute (page 396).
       •   Set Defaults: Click Set Defaults to return all layer/item settings to 12 mil clearances.
       •   OK: When you have finished setting up the design rules, click OK.

       Clearance Rules
       When a clearance rule for a specific object is requested (e.g., DRC), the design rules category
       determines which rules apply and the order in which they are applied.



P-CAD PCB User’s Guide                                                                                         461
Chapter 17: Options Commands                                                             Options Design Rules


        The order of evaluation matches the order of evaluation used by the SPECTRA Router. P-CAD PRO
        Route uses only layer and net clearance rules.
        P-CAD DRC ignores SPECTRA Router clearance rules that have been added as attributes.

      Rooms Tab
        Clicking the Rooms tab displays the Rooms in the design, as shown in the following figure:




        The following information appears in the Rooms tab:
        •   Rooms: The Rooms list shows the rooms in the design.
        •   Rules: The Rules list shows the rules that have been defined for the selected Room.
        •   Placement Side frame: The Placement Side frame shows whether the Room has been placed
            on the Top, Bottom or Top or Bottom of the layer.
        To add, delete or edit the rules click the Edit Rules button and make the appropriate changes in the
        Attribute dialog. You can also access a rule’s properties by double clicking the rule in the Rules list.

      Net Class Tab
        When you click the Net Class tab, the dialog appears as follows:




462                                                                                  P-CAD PCB User’s Guide
Options Design Rules                                                       Chapter 17: Options Commands




       The Net Class tab lists all net classes and the rules associated with each Net Class and Net Class
       Layer. The options available on the Net Class tab are:
       •   Net Classes: The Net Classes list shows the name of each Net Class and indicates the presence
           of Net Class or Layer rules. Net Class rules are indicated with an N, while Net Class Layer rules
           are indicated with an L.
       •   Net Class Rules: The Net Class Rules list shows the net class rule names and values. To modify
           the Net Class Rules, click the Edit button to open the Attributes dialog to make changes (see
           Edit Attributes (page 350) for details on the Attribute dialog) or double-click a rule in the list
           box to modify the rule’s value.
       •   Net Class Layer Rules: The Net Class Layer Rules list shows the net class layer rule names and
           values. To modify the Net Class Layer rules, either double-click the rule in the list box to make
           changes to the rule’s value or click Edit to open the Edit Net Class Layer Rules dialog:




P-CAD PCB User’s Guide                                                                                      463
Chapter 17: Options Commands                                                             Options Design Rules




        The Edit Net Class Layer Rules dialog lists the Layers and indicates whether the layer has Rules with
        an asterisk. You can select net classes having specific layer rules and values by clicking the Select
        by Rule button to open the Set By Attribute dialog (for details on the Set By Attribute dialog see Set
        By Attribute (page 349). You can also click the Edit Layer Rules button to open the Attributes dialog
        for modifications.
        •   Select Net Class by frame: The Select Net Class by frame allows you to set Net Classes by Net
            Class Rules or Net Class Layer Rules.
        Click Net Class Rules to go directly to the Set By Attribute dialog (for details on the Set By Attribute
        dialog see Set By Attribute (page 349). The Layer Rules button opens the Select Layer dialog where
        you can choose the layer with the attributes you intend to use to set the Net Classes, and then
        opens the Set By Attribute dialog when you click OK (for information on the Select Layer dialog,
        see Set Nets By Layer Attribute (page 350).
        •   View Rules: Opens the Notepad and displays a list of rule names and values for each selected
            Net Class.
        •   Edit Net Classes: Click Edit Net Classes to open the Net Classes dialog where you can define a
            group of nets that share the same rules as a Net Class. The Net Classes dialog also displays the
            Net Class and Net Class Layer rules and their values. For complete information on the Net
            Classes dialog see Options Net Classes (page 469).

      Net Tab
        When you click the Net tab, the dialog appears as follows:




464                                                                                   P-CAD PCB User’s Guide
Options Design Rules                                                        Chapter 17: Options Commands




       Use the options in the Net tab to specify rules for a specific net in the design. The dialog lists all
       nets and shows the net and net layer rules associated with the selected net. The following options
       are available in the Net tab:
       •   Nets: The Nets list shows the name of each Net and indicates the presence of Net or Net Layer
           rules using the legend shown in the Has Rules frame. Net rules are indicated with an N, while
           Net Layer rules are indicated with an L.
       •   Net Rules: The Net Rules list shows the net attribute name and values. To modify the Net
           Rules, click Edit to open the Attributes dialog. See Edit Attributes (page 350).
       •   Net Layer Rules: The Net Layer Rules list shows the net layer rule names and values. To modify
           the Net Layer rules, click Edit to open the following Edit Net Layer Rules dialog:




P-CAD PCB User’s Guide                                                                                      465
Chapter 17: Options Commands                                                              Options Design Rules


             Similar to the Edit Net Class Layer Rules dialog, the Edit Net Layer Rules dialog lists the Layers
             and indicates whether the layer Has Rules with an asterisk. You can select layers having specific
             rules and values by clicking the Select by Rule button to open the Set By Attribute dialog (see
             Set By Attribute (page 349) for details).
         •   Select Net by: The Select Net by frame provides access to the Set by Attribute dialog where
             you can select the attributes and values you want to use to set the Nets. Click the Net Rules
             button to go directly to the Set by Attribute dialog (see Set By Attribute (page 349). The Layer
             Rules button opens the Select Layer dialog where you can choose the layer with the attributes
             you intend to use to set the Nets (for information on the Select Layer dialog see Set Nets By
             Layer Attribute (page 350).
         •   View Rules: Opens the Notepad and displays a list of rule names and values for each selected
             item.
         •   Edit Nets: Click Edit » Nets to open the Edit Nets dialog, where you can view and modify net
             information. See Edit Nets (page 345) for details.

      Class to Class Tab
         When you click the Class to Class tab, the dialog appears as follows:




         Use the options in the Class to Class tab to specify clearance rules for a specific class-to-class in the
         design. The dialog lists all defined class-to-classes and shows the rules associated with them. The
         Class to Class tab contains the following options:
         •   Class to Class: The Class to Class list shows the name of each Class-to-Class and indicates the
             presence of Class-to-Class or Class-to-Class Layer rules using the legend shown in the Has



466                                                                                    P-CAD PCB User’s Guide
Options Design Rules                                                        Chapter 17: Options Commands


           Rules frame. Class-to-Class rules are indicated with a C, while Class-to-Class Layer rules are
           indicated with an L.
       •   Class to Class Rules: The Class to Class Rules list shows the Class-to-Class rule name and
           values. To modify the Class-to-Class Rules, click Edit to open the Attributes dialog. See Edit
           Attributes (page 350).
       •   Class to Class Layer Rules: The Class to Class Layer Rules list shows the class-to-class layer rule
           names and values. To modify the Class-to-Class Layer rules, click Edit to open the Edit Net Class
           To Net Class Layer Rules dialog:




           Similar to the Edit Net Class Layer Rules dialog, the Edit Net Class to Net Class Layer Rules
           dialog lists the Layers and indicates whether the layer Has Rules with an asterisk. You can select
           layers having specific attributes and values by clicking the Select by Rule button to open the
           Set By Attribute dialog (see Set By Attribute (page 349) for details).
       •   Select Class-to-Class by: The Select Class-to-Class by frame provides access to the Set by
           Attribute dialog where you can select the attributes and values you want to use to set the Class-
           to- Classes. Click Class-to-Class Rules to open the Set by Attribute dialog (see Set By Attribute
           (page 349) for details). The Layer Rules button opens the Select Layer dialog where you can
           choose the layer with the attributes you intend to use to set the Class-to-Class (for information
           on the Select Layer dialog see Set Nets By Layer Attribute (page 350).
       •   View Rules: Opens the Notepad utility and displays a list of rule names and values for each
           selected item.
       •   Edit Class to Class: Click Edit » Class to Class to open the Edit Net Class to Net Class Definition
           dialog, where you can view and modify Class to Class information:




P-CAD PCB User’s Guide                                                                                      467
Chapter 17: Options Commands                                                           Options Design Rules




       The following information is available in the Net Class To Net Class Definition dialog:
       •   Net Class To Net Class Definitions: Lists the defined net class combinations.
       •   Net Class Name: These combo boxes are used to combine two Net Classes into a Class To
           Class.
       •   Modify Definition: Click this button to make changes to a selected Class To Class.
       •   Delete Definition: Click this button to remove a selected Class To Class.
       •   Add Definition: Click this button to create a Class To Class when you have selected the two
           desired Net Class Names.
       •   Rules: The Rules list shows the rules and values assigned to the Class To Class. Click Edit to
           open the Attributes dialog to make changes to the rules. See Edit Attributes (page 350) for more
           information.
       •   Layer Rules: The Layer Rules list shows the attributes and values assigned to the layers in a
           Class To Class. To modify the layer rules, click Edit to open the following Edit Net Class To Net
           Class Layer Attributes dialog:




468                                                                                P-CAD PCB User’s Guide
Options Net Classes                                                        Chapter 17: Options Commands




       Similar to the Edit Net Class to Net Class Layer Rules dialog, the Edit Net Class to Net Class Layer
       Attributes dialog lists the Layers and indicates whether the layer has Rules with an asterisk. You can
       select layers having specific rules and values by clicking the Select by Rule button to open the Set
       By Attribute dialog (see Set By Attribute (page 349) for details).
       The order of evaluation matches the order of evaluation used by the SPECTRA Router. P-CAD PRO
       Route uses only layer and net clearance rules.
       P-CAD DRC ignores SPECTRA Router clearance rules that have been added as attributes.


Options Net Classes
       Choose Options Net Classes to define a group of nets that share common rules. Collections of nets
       sharing the same rules are referred to as a net class.
       When you click Net Classes, the following Net Classes dialog appears.




P-CAD PCB User’s Guide                                                                                    469
Chapter 17: Options Commands                                                            Options Net Classes




       This class editor allows you to create named net classes using predefined clearance rules or
       predefined SPECCTRA autorouter clearance rules and then assign nets to that class. You can also
       add user-defined attributes to the net classes for your own use.
       Net classes are transferred from the Schematic design to PCB via the P-CAD format netlist or
       through ECO’s. PCB Design Rules Checking verifies clearances and the attributes listed below
       when they have been defined in the net class:
       •   MaxNetLength
       •   MaxVias
       •   MinNetLength
       •   ViaStyle
       •   Width
       For net clearances the rules can be further refined by specifying clearance rules for pairs of objects,
       like pad to pad clearances or line to via clearances.
       The net class information is written to binary and ASCII design files. P-CAD Master Designer PCB
       does not support Net Classes so this information is lost when exporting a P-CAD design to P-CAD
       format.
       To create named net classes, do the following:



470                                                                                P-CAD PCB User’s Guide
Options Net Classes                                                         Chapter 17: Options Commands


       1.   Enter a class name in the Class Name box.
       2.   Click Add.
       3.   To include a net from the Unassigned Nets list to the new net class you may use any of the
            following methods:
            •   Select a single net and click Add.
            •   Double click on a net to move it from Unassigned to Nets in this Class and vice versa.
            •   Select multiple nets in a block by either 1) holding down the SHIFT key while selecting the
                first and last nets in the block or, 2) select the first net in the list, hold the left mouse
                button and drag the cursor to the last net in the list and release. Then click Add.
            •   Select individual nets by holding the CTRL key while clicking on each net, then click Add.
       4.   To remove a net from the Nets in this Class list, use the same methods detailed above, but click
            Remove instead of Add.

            In addition to the normal selection process you may employ the Set Nets From Design
            Selection buttons to quickly place all currently selected nets in the design into either the
            Unassigned Nets or Nets in this Class lists. When no nets are selected in the design, the
            inactive Set Nets From Design Selection buttons are gray. If nets in either list are selected and
            you click the Set Nets From Design Selection button, the other selected nets become
            unselected.

       5.   The Net Class Attributes assigned to the Net Class are listed in the list. To make modifications
            to any of the existing attributes, or to add new attributes, click Edit to open the Attributes
            dialog. See Edit Attributes (page 350).
       6.   Net Class Layer Attributes and their values are shown in this list. To modify these attributes,
            click Edit which opens the following Edit Net Class Attributes dialog:




            The Edit Net Class Attributes dialog lists the Layers and indicates whether the layer has Rules
            with an asterisk. You can select net classes having specific layer attributes and values by
            clicking the Select by Rule button to open the Set By Attribute dialog (for details on the Set By



P-CAD PCB User’s Guide                                                                                        471
Chapter 17: Options Commands                                                              Options Pad Style


           Attribute dialog see Set By Attribute (page 349). You can also click Edit Layer Rules to open the
           Attributes dialog for modifications.


Options Pad Style
       Choose Options » Pad Style to set the current pad style (a.k.a., pad stack) for the Place Pad
       command. You can add, delete, purge unused pad styles, edit pad styles and set hole ranges using
       the series of dialogs available.
       A pad style (or pad stack) is a collection of pad information concerning pad shape relative to layer,
       hole size, offset, etc.
       Choose Options » Pad Style to open the following Options Pad Style dialog.




       The Default pad style cannot be modified. When the Default pad style is selected, the Modify
       buttons become View (Simple) and View (Complex).
       Surface-only (SMT) pads have a default paste mask shape and a default solder mask shape, which is
       automatically based on the shape and size of the pad on the top or bottom signal layer. However,
       the default paste and solder mask definitions are not appropriate for surface pads in edge
       connectors. To be sure that no solder and/or paste is applied to the edge connector pads, you must
       explicitly define the component's padstyle with values of zero on the paste and solder mask layers.
       •   To add a new pad style, select a similar pad style and click Copy. The Copy Pad Style dialog
           appears.
       •   To modify a simple pad style, select a simple non-Default pad style (e.g., new1), and then click
           Modify (Simple). The Modify Pad Style (Simple) dialog appears. Simple and complex pad styles
           are defined below. If the pad style is complex, this button appears gray, and cannot be clicked.
       •   To modify a complex pad style, select a non-Default pad style (e.g., new1), and then click
           Modify (Complex). The Modify Pad Style (Complex) dialog appears. Simple and complex pad
           styles are defined below.



472                                                                                P-CAD PCB User’s Guide
Options Pad Style                                                            Chapter 17: Options Commands


       •   To view the default pad style, select Default, and then click View Simple or View Complex
           (View appears instead of Modify when Default is highlighted). The read-only View Default Pad
           Style dialog appears.
       •   To delete a pad style, select a non-Default pad style name in the list and click Delete. The pad
           style name will disappear from the list. You can only delete a style if it is not currently used by a
           pad.
       •   To purge unused pad styles, click Purge Unused Styles. All unused pad style definitions are
           deleted from the current PCB design.
       •   To rename a pad style, highlight the non-Default pad style you want to rename and click
           Rename. The Rename Style dialog appears.
       •   To set a pad style hole range, click Hole Range. The Options Pad/Via Hole Range dialog
           appears. If you don’t set a hole range, PCB assumes a through-hole.
       •   To Merge Pad Styles click Merge. The Merge Style dialog appears.

   Simple and Complex Pad Styles
       A simple pad style must meet the following criteria:
       •   Shapes can be defined only on the built-in Top, Bottom, (Signal), (NonSignal), and (Plane)
           layers. No other custom layer definitions are allowed.
       •   The shapes and dimensions on the Top, Bottom, and (Signal) layers must either be identical (a
           uniform thru-pad), be defined on the Top layer only (a top surface pad), or be defined on the
           bottom layer only (a bottom surface pad).
       •   To qualify as a simple, uniform thru-pad, the signal layer shape must be an ellipse, an oval, a
           rectangle, a rounded rectangle, a target, or a mounting hole. If a signal layer shape is an ellipse,
           oval, rectangle, or rounded rectangle, the (Plane) shape must be a Direct Connect or a 45-
           degree, 4-spoke Thermal.
       •   To qualify as a simple, top surface pad, the shapes must have zero width and zero height on
           the Bottom, (Signal), (NonSignal), and (Plane) layers. The Top shape must be an ellipse, an oval,
           a rectangle, or a rounded rectangle.
       •   To qualify as a simple, bottom surface pad, the shapes must have zero width and zero height
           on the Top, (Signal), (NonSignal), and (Plane) layers. The Bottom shape must be an ellipse, an
           oval, a rectangle, or a rounded rectangle.
       •   If there is a hole defined for the pad, the X and Y hole offsets must both be zero.
       Any pad style that does not meet all of the above criteria is considered a complex pad style.

   Adding a Pad Style
       To add a pad style, click Copy. The following Copy Pad Style dialog appears.




P-CAD PCB User’s Guide                                                                                       473
Chapter 17: Options Commands                                                                Options Pad Style




         Type the new pad name (e.g., mypad) and select a pad style to copy it from (e.g., *(Default)). Click
         OK to return to the Options Pad Style dialog.

      Modify a Simple Pad Style
         To modify a simple pad style, select a simple pad style and click Modify (Simple). The following
         Modify Pad Style (Simple) dialog appears. This button is shaded and unavailable if you select a
         complex pad style.




         Use this dialog to set the width, height, hole diameter and shape, select a pad type. For thru type
         pad styles, you can select either a thermal or direct plane connection. You can designate the hole
         to be Plated and change its Diameter. You can also set the plane swell value; either enable the Use
         Global Swell option (set in Options Configure), to use the global plane swell setting in Options
         Configure, or disable it and specify a Local Swell option, overriding the global Options Configure
         setting.

      Modify a Complex Pad Style
         To modify a complex pad style, select a complex pad style and click the Modify (Complex) button.
         The Modify Pad Style (Complex) dialog appears.




474                                                                                  P-CAD PCB User’s Guide
Options Pad Style                                                          Chapter 17: Options Commands




       The values represented will default to mil or mm (millimeters), depending on what you have set in
       Options Configure (your current units). You can specify a measurement value (overriding Options
       Configure) by typing in mil, mm, cm, or in after the numeric value.
       The Pad Definition frame allows you to add a new pad definition to the Layers list, or modify an
       existing pad definition for a layer. You can change the Width and Height dimensions and choose a
       Shape from those available in the drop-down list.
       The connectivity of pads to planes and copper pours are controlled in the Pad Definition frame as
       well. If you choose the No Connect Shape for the pad or a plane layer, you can prevent the
       connection to the plane. When you select the Prohibit Copper Pour Connections check box, a
       thermal connection between the pad and copper pours is prevented.

       If you choose to prohibit a copper pour or plane connection, and by doing so cause a break in the
       net connectivity, a blue connection line from the pad to a neighboring net node is displayed. You
       must manually add the necessary connection.

       The Hole frame lets you define the pad hole diameter, specify the plating characteristics and
       designate X and Y offsets. The Hole frame applies to all layers of the pad and are not part of the
       Add/Modify/Delete function for pad definitions. Specify the Hole dimensions, plating on or off, and
       the X and Y offset. X Off and Y Off are horizontal and vertical offset amounts of the hole in an
       aperture.
       With the Plane Swell options you can set the plane swell value; either select the Use Global Swell
       check box to use the global plane swell setting in Options Configure, or disable it and enter a value
       in the Local Swell box, overriding the global Options Configure setting.

       Pad Definitions
       The Add, Modify, and Delete buttons in the Pad Definition frame of the dialog work as follows:
       1.   To add a pad definition to a layer in the Layers list select a layer from the Layer combo box in
            the Pad Definition frame, select a shape from the Shape drop-down list, set the hole
            dimensions, plating, width, height and spoke width, then click Add. The new layer is added to
            the list.



P-CAD PCB User’s Guide                                                                                    475
Chapter 17: Options Commands                                                                  Options Pad Style


            For polygonal pad shapes, Width and Height options are unavailable and the Polygonal Pad
            Shapes dialog appears when you click Add. See Defining Polygonal Pad Shapes (page 477) for
            details.
       2.   To modify a pad definition for one of the layers in the Layers list highlight a layer name in the
            list; then you can change pad shape (Shape options), and (in the case of thermal pads) define
            the dimensions for Outer Dia and Inner Dia and Spoke Width; then click Modify.
            You can view the pad definition of a layer by clicking on the layer name in the list. The pad
            definitions are listed by shape, width, and height in the Pad Definition frame.
       3.   To delete a pad definition, highlight a layer in the list and click Delete (a reverse action to
            number 1 above). If the layer is predefined (e.g., Top), it cannot be deleted.
       4.   Click OK and all of the changes or settings will be saved and applied. All pads that currently
            use this style will be immediately updated.

       For further clarification, the basic difference between adding and modifying a pad style is as
       follows:
       To add a pad style, you copy an existing style, choose a unique name, and then modify it to new
       specifications.
       To modify a pad style, you edit an existing style (but not the default style) without renaming it.

       After you have set the pad style(s), the available pads that you place in Place Pad mode have the
       style you set here. When you choose to change to a different pad style with the Edit » Properties
       command, the available pad styles will be listed. See Pad Properties (page 307) for related details.

       Standard Pad Shapes
       This section shows and describes some standard pad shapes and thermal spoke pads.




       Elipse   Oval   Polygon    Rounded      Rectangle     Target     Mt. Hole

       •    Ellipse is a rounded shape with separately specifiable X and Y dimensions; an ellipse with equal
            X and Y dimensions is a circle (frequently called a round).
       •    Oval is a short line segment with round end caps (half-circles), the radius of which is 1/2 the
            length of the shortest side; if the X and Y dimensions are equal, this too is circular or round.
       •    Polygonal is a free-form polygonal shape defined using the Polygonal Pad Shapes dialog.
       •    Rounded Rectangle contains 1/4 circles on the corners of a rectangle. The 1/4 circle radius is 1/4
            the length of the shortest side.
       •    Rectangle shapes are X=width and Y=height.




476                                                                                   P-CAD PCB User’s Guide
Options Pad Style                                                          Chapter 17: Options Commands


       If you want a round pad, you use the ellipse shape with identical height and width (the example
       above is an oblong ellipse). If you want a square pad, use a rectangle with identical height and
       width.
       Spoke width, and the inner and outer diameters, are specifications for thermals. There are four
       thermal pad styles, which appear as follows:




              2 spoke         2 spoke 90          4 spoke         4 spoke 45

       Thermal diameters and spoke width:




         outer
                                inner         spoke
        diameter
                              diameter        width




       Offset aperture hole




       •    Direct Connect pads directly touch the plane layer.
       •    No Connect pads are holes with swell.
       •    Target pad style provides a way to line up board layers.
       •    Mounting Hole pads are manufacturing indicators for securing components or board layers.

       Defining Polygonal Pad Shapes
       You can define polygonal pad shapes from the Modify Pad Style (Complex) dialog. To do so:
       1.   Select Polygon from the Shape list.


P-CAD PCB User’s Guide                                                                                    477
Chapter 17: Options Commands                                                                Options Pad Style


            Notice that the Width and Height boxes are no longer available.
       2.   Click Add.

       To modify a polygonal pad shape, select it and click Modify. The Polygonal Pad Shape dialog
       appears with it’s current polygon set to correspond with the pad being modified. You can then
       specify a different polygonal shape for the pad.

       The Polygonal Pad Shape dialog appears:




       This dialog is used as to select polygonal shapes using several methods:
       •    Specification of parameters that define a simple regular polygon shape.
       •    Selection of a polygon shape from those that currently reside within existing pad styles.
       •    Selection of a polygon shape from polygon aperture definitions.
       •    Selection of an irregular custom polygon shape from those currently selected in the design
            workspace.
       The Polygonal Pad Shape dialog options are as follows:
       Regular Polygons
       To create regular polygons, use the following options:
       •    Click Regular Polygons to specify simple polygon shapes.
       •    Use the arrows to set the Sides box. You can select a value from 3 to 10. The default setting is 3.
       •    The Diameter box allows you to specify polygon pad size. Its default setting is 60 mil. This value
            represents the diameter of a circle that circumscribes the polygon.




478                                                                                 P-CAD PCB User’s Guide
Options Pad Style                                                            Chapter 17: Options Commands


       •   The Rotation box allows you to specify orientations of polygon pads individually within their
           pad styles. The default setting is 0.0.
       •   Click Update to update the Polygonal Shape with the new settings. If any of the settings are
           blank or contain erroneous data, the display window is cleared and an appropriate error
           message appears.
       Existing Pad Style Polygons
       To select existing polygon shapes, use the following options:
       •   The Pad Style Polygons button allows you to select polygon shapes that currently reside within
           existing pad styles in their designs.
       •   The Pad Style combo box is automatically populated with the names of all the pad styles that
           contain polygon shapes (sorted alphabetically). The default setting is its first list entry.
       •   The Layer combo box is consistently updated so as to contain layer names on which polygon
           shapes reside within the currently selected Pad Style. The default setting is its first list entry.
       When you change the current settings of either combo box, the display window is automatically
       updated to display the proper polygonal shape. If the currently selected pad style polygon happens
       to be a regular shape, then the Regular Polygons fields are automatically updated.
       If no pad styles in the current design contain polygon shapes, then the Pad Style Polygons button,
       the Pad Style combo box, the Layer combo box are all disabled.
       Existing Aperture Definitions
       To select polygon shapes based on existing aperture definitions, use the following options:
       •   The Aperture Polygons button allows you to select polygon shapes from polygon apertures
           definitions.
       •   The Aperture combo box is automatically populated with the names of all polygon apertures
           definitions.
       When you select a new definition, the display window is automatically updated to display the
       proper polygonal shape. If the currently selected pad style polygon happens to be a regular shape,
       then the Regular Polygons fields are automatically updated.
       If there are no polygonal aperture definitions in the current design, then these options are all
       disabled.
       Currently Selected Polygon/Reference Point Pairs
       To select irregular custom polygon shapes, use the following options:
       •   The Selected Polygons button allows you to select irregular custom polygon shapes from
           polygon/Reference Point pairs that are currently in the design workspace selection list.
       When you open the Polygonal Pad Shape dialog, the P-CAD PCB (6/400) examines the list of
       currently selected items, looking for polygons and reference points. It matches each polygon with a




P-CAD PCB User’s Guide                                                                                       479
Chapter 17: Options Commands                                                                Options Pad Style


        single currently selected Reference Point touching the polygon’s boundary to construct a list of
        polygon/Reference Point pairs. The list uses the following criteria:
        •   Selected items that are not polygon/Reference Point pairs are discarded.
        •   Polygons comprised of more that 48 sides are discarded.
        •   Polygons that fail to match to a selected Reference Point are discarded.
        •   Polygons that match to more than one Reference Point are discarded.
        Click the Next button to view the next item in the list; click Previous to see the previous item.
        If no valid polygon/Reference Point pairs are found on the current selection list (or the selection list
        is empty), then the Selected Items button and the Previous and Next buttons become shaded an
        unavailable.

      Purging Pad Styles
        To purge Pad Styles click Purge Unused Styles. A confirmation dialog appears:




        Click Yes to confirm purging of all unused styles.

      Renaming a Pad Style
        To add a pad style, click Rename. The Rename Pad Style dialog appears:




        Type a new pad style name in the New style name list, and click OK.

      Setting a Hole Range
        To set a pad style hole range, click Modify Hole Range. The Options Modify Pad Hole Range dialog
        appears.




480                                                                                  P-CAD PCB User’s Guide
Options Pad Style                                                          Chapter 17: Options Commands




       This dialog allows you to set up the hole ranges for pads. Only those styles with a hole diameter is
       greater than zero appear.
       The Hole Range Layers list reflects the signal/plane layer ordering of your board as you established
       in the Options Layers dialog.
       To set a hole range, do the following:
       1.   Select a pad from the Styles list.
       2.   Select the beginning and ending layers for the hole range.
       3.   Select another pad and repeat the process.
       4.   Upon completion, click OK.

   Merging Pad Styles
       To merge Pad Styles click Merge. The Merge Styles dialog appears:




P-CAD PCB User’s Guide                                                                                    481
Chapter 17: Options Commands                                                                  Options Via Style


       Select the Pad styles you want to merge and click Apply to perform the merge. Click Close when
       you complete merging Pad Styles.


Options Via Style
       Choose Options Via Style to set the current via style for the Place Via command. You can add,
       delete, rename, or edit via styles by using the series of available dialogs. This dialog can also be
       used to set hole ranges for vias.
       Choose Options Via Style to open following the Options Via Style dialog.




       Via styles are almost identical to pad styles in the way that you add, edit, modify, view, delete, and
       rename them in PCB. You can also purge unused via styles and create hole ranges. See Options Pad
       Style (page 472) for more information.
       Vias don't support Mounting Hole and Target shapes.


Options Text Style
       Choose Options Text Style to set the current text style for the Place Text command and allows you
       to add, delete, rename, or edit text styles by using the series of available dialogs. The text styles you
       create or edit here are available when you use the Place » Text command, or when you want to
       modify already placed text with the Edit » Properties command.
       The Default style can't be deleted, renamed, or modified. The DefaultTTF style can be displayed in
       TrueType or stroke font, but can otherwise not be modified, renamed or deleted. The other default
       styles can be modified, but not deleted or renamed.

       When you flip text that is currently displayed in TrueType font the result is a mirrored version of
       the text in its stroke definition.

       Choose Options Text Style to open the following dialog:




482                                                                                  P-CAD PCB User’s Guide
Options Text Style                                                            Chapter 17: Options Commands




    Adding Text Style
        To add a text style, do the following:
        1.   In the Options Text Style dialog, click Add. The following Add Text Style dialog appears.




        2.   Select the style of text you want to base the new style on.
        3.   Specify the text style name you are adding (e.g., busstyle).
        4.   Click OK and the Text Style Properties dialog appears. For details on this dialog, see Text Style
             Properties (page 484).

    Changing Text Display
        You may change text display from Stroke to TrueType and vice versa. From the Options Text Style
        dialog follow these steps:
        1.   Select one or more text styles from the list provided.
        2.   Click Display Stroke or Display TrueType for the type of display style you desire.
        The Display Stroke button displays all selected text styles in their stroke font definitions.
        The Display TrueType button displays all selected text styles that allow TrueType in their TrueType
        font definitions. Selected text styles that do not allow TrueType are not affected by pressing the
        Display TrueType button.




P-CAD PCB User’s Guide                                                                                      483
Chapter 17: Options Commands                                                                    Options Text Style


      Text Style Properties
         Remember, you cannot change the properties of Default text style; you can only query it. The
         DefaultTTF text style can be changed to the equivalent stroke font style for display purposes only.
         To query and edit text style properties:
         1.   In the Options Text Style dialog, select a text style from the Text Style list.
         2.   Click Properties and the Text Style Properties dialog appears. To learn about this dialog, see
              Text Style Properties (page 484).
         3.   Modify the Height, Thickness, and Font fields for non-default fonts.

      Purging Text Styles
         To purge Text Styles click Purge Unused Styles. A confirmation dialog appears:




         Click Yes to confirm purging of all unused styles.

      Renaming Text Style
         To rename a text style, follow these steps:
         1.   In the Options Text Style dialog, select the non-default text style that you want to rename.
         2.   Click Rename to open the Rename Style dialog.
         3.   The text style appears in the list.




         4.   Specify the new name by typing over the existing name.
         5.   Click OK.

      Deleting Text Style
         To delete a text style, do the following:
         1.   In the Options Text Style dialog, select the non-default text style you want to delete.
         2.   Click Delete.
              A message appears asking you to confirm your deletion.



484                                                                                      P-CAD PCB User’s Guide
Options Text Style                                                             Chapter 17: Options Commands


        3.   Click Yes, and the highlighted text style disappears from the list.

        You cannot delete default text styles or a text style that is currently in use.

    Text Style Properties Dialog
        This Text Style Properties dialog appears when you click the OK button in the Options Add Text
        Style dialog or the Properties button in the Options Text Style dialog.




        This dialog lets you add and modify font properties of the selected (non-default) text style.
        The values represented appear as mm (millimeters) or mil, depending on what you have set in
        Options Configure (your current units). You can specify a measurement value (overriding Options
        Configure) by typing in mil, mm, cm or in after the numeric value.
        You can set the following stroke font properties.
        •    Height: The font’s height.
        •    Thickness: The text thickness.
        •    Font: Choose between QUALITY, BASIC, or LCOM fonts. QUALITY and BASIC fonts are
             interchangeable. Basic is simpler and therefore draws faster. LCOM is a serif font (a little
             fancier).




        When working with a TrueType font style other than DefaultTTF, the following options are enabled
        in the TrueType Font Properties and Display areas of the dialog:
        TrueType Font Properties:
        •    Size: Enter the desired size of the font.
        •    Font: Click Font to open the Font dialog shown in the following figure, where you can choose
             the font, font style, font size, and script style.



P-CAD PCB User’s Guide                                                                                      485
Chapter 17: Options Commands                                                                Options Text Style




         Click OK to confirm and apply your choices.
         Display:
         •   Stroke Font: Click Stroke Font to enable the text display in the Stroke Font style.
         •   TrueType Font: Click TrueType Font to enable the text display in the TrueType Font style.
         When you click OK, the new (or modified) text style is available for assignment.

      Merging Text Styles
         To merge Text Styles click Merge. The Merge Styles dialog appears:




         Select the Text Styles you want to merge and click Apply to perform the merge. Click Close when
         you complete merging Text Styles.




486                                                                                  P-CAD PCB User’s Guide
                                                                                      CHAPTER           18


                                                           Library Commands

Using the Library Commands
       Use the Library commands to create aliases, copy items from one library to another, delete library
       items, rename library items, open libraries, and save patterns that you create to component
       libraries.
       P-CAD libraries are a combination of components, PCB patterns, and Schematic symbols (not used
       by PCB). The component section of a library contains component information, such as what pattern
       is attached to a particular component, what its pin assignments are, etc. The pattern section
       contains the structural information about the pattern that is attached to a component. Without a
       pattern, a component has no graphical representation and cannot be placed. A pattern by itself is
       only a graphical structure. A component and its pattern reside in the same library; the component
       references a particular pattern, its structure, when that pattern is attached to it. For example, an
       SN7400N component with its component attributes and pin assignments occupies the same library
       with a DIP14 pattern, which it references.
       It is typical for multiple components within a library to reference the same pattern. A library could
       conceivably contain 100 components while only containing five patterns (multiple components
       referencing the same pattern). If you change one of the patterns, then all of the components
       referencing that pattern are affected.


Library New
       Choose Library » New to create a new library. The new library is empty; it has no components,
       patterns, or symbols.
       When you choose Library » New, the Library New dialog is opened and you can specify the
       filename of your new library.




P-CAD PCB User’s Guide                                                                                    487
Chapter 18: Library Commands                                                                        Library Alias



Library Alias
         Choose Library » Alias to create an alias for an item in a library. In P-CAD PCB, an alias is an
         alternate name for component or pattern. You can create multiple equivalent names for the same
         item with this command.
         When you create aliases for an item, it is not the same as creating copies or renaming. For details,
         see page Library Copy (page 489).
         Aliases allow you flexibility of using a variety of naming conventions for components or patterns,
         without renaming them. For example, what P-CAD calls an SN7400N, you may want to use as a
         generic alias of 7400. Or, if you are using components from a vendor using a particular naming
         convention, and you want to continue using that system, you can use alias names and display them
         on your design as such.
         The library that you use in the execution of Library Alias, Library Delete, or Library Rename remains
         current if you re-invoke any of the commands during the same session.

      Creating an Alias
         To create an alias, follow these steps:
         1.   Choose Library » Alias. The Library Alias dialog appears.
         2.   If the name of the current library does not appear next to the Library button, click Library. The
              Library Select dialog appears.
         3.   In the Library Select dialog, navigate to the appropriate library, select it, and click Open. You
              return to the Library Alias dialog.
         4.   In the Alias Item frame, choose Component or Pattern. The Symbol button is shaded and not
              available in P-CAD PCB.
         5.   Click the Component or Pattern button. The Library Browse dialog appears.
         6.   Select the item from the Component or Pattern list, as shown in the following figure:




488                                                                                    P-CAD PCB User’s Guide
Library Copy                                                               Chapter 18: Library Commands




       7.   Click OK. You return to the Library Select dialog.
       8.   Enter the new alias for the item in the New Alias box.
       9.   Click Add to add it to the Aliases list.
       10. Click Close to close the Library Select dialog.


Library Copy
       Choose Library » Copy to copy an item from one file and save it the current library or to another
       library.

       To copy a component with its associated Schematic symbols, use the Library » Copy command in P-
       CAD Library Executive. P-CAD PCB does not support the management of symbol data.

       It's important to note that a library part has these sections:
       •    A component section (type, reference designator, etc.)
       •    A pattern section (the PCB graphics)
       •    A symbol section (the Schematic graphics).
       Generally, you need to copy the component and its pattern when copying between different
       libraries (notice that the Copy Item section of the dialog has a choice between Pattern and
       Component). When you copy a component, you are prompted as to whether you want to include
       its associated pattern; you would normally respond Yes. When you copy a pattern, no components
       will be included in the copy.
       Also, when copying items from one library to another, you can choose to preserve items in the
       destination library or overwrite them. And when copying components, you can choose to copy the
       corresponding patterns.



P-CAD PCB User’s Guide                                                                                     489
Chapter 18: Library Commands                                                                    Library Copy


        The dialog allows you to select source library and item name as well as destination library and item
        name.
        The source library and destination library that are used with Rename will remain current if you re-
        invoke the command during the same session.
        If you are copying a component or pattern but are not changing its name, you can leave the Single
        Destination Name box blank.

      Copying Patterns/Components
        To copy one or more patterns or components, follow these steps:
        1.   Choose Library » Copy. The Library Copy dialog appears:




        2.   Click Select Source Library. The Library Select dialog appears.
        3.   Select the source library. Then click OK. Notice that the source library you selected appears in
             the Library Copy dialog.
        4.   Click Destination Library. The Library Select dialog appears again.
        5.   Select the destination library. Then click OK. The Library Copy dialog appears with the paths
             and filenames of the source and destination libraries you selected.
        6.   In the Copy Item section of the dialog, select which type of item you want to copy. The
             available items are Component and Symbol. For the item type you select, the names of the
             available items appear in the Multiple Source Names box. In the example above, the dialog lists
             all the components available in the source library Demo2.lib.




490                                                                                 P-CAD PCB User’s Guide
Library Delete                                                                  Chapter 18: Library Commands


        7.   Select the item(s) to copy by using the standard Windows selection key combinations. You can
             select either a single item, a group of items, or all the items in the list. The table below explains
             how to select items for copying:


                   Use these keys                                        To select
              Shift+Left mouse             all items between the last selected (highlighted) item and the
              button                       item you click on.
              CTRL+Left mouse              add items to or subtract items from the selection.
              button


             You can also click the Browse to Add button to add single items to the your selection. To do
             this, click Browse to Add. When the Library Browse dialog appears, select the desired item,
             then click OK. The program highlights the selected item in the Multiple Source Names list box.

        8.   In the Destination Preferences section of the dialog, indicate whether to overwrite existing
             items in the destination file, preserve existing items, and copy patterns and symbols with a
             component. The last two check boxes are only available if you're copying components.
        9.   Click Copy. P-CAD Library Executive copies the selected objects from the source library to the
             destination library.
        10. Click Close to exit the dialog.


Library Delete
        Deletes a library item.
        This command deletes the item in name only. The alternate names (aliases) still exist unless you
        delete them. If the item has only one name and no aliases and you delete it, then the item itself is
        deleted from the library. Use the Library » Alias command to check whether an item has aliases.
        The library that you use in the execution of Library Alias, Library Delete, or Library Rename remains
        current if you re-invoke any of the commands during the same session.

        IMPORTANT: If you delete a pattern, then all of the components in the library that reference that
        pattern will be without structure, and would therefore be unplaceable. Normally you would want to
        delete a pattern alias only, which is not dangerous unless a component used a pattern alias.


    Deleting from a Library
        To delete items from a library, follow these steps:
        1.   Choose Library Delete to display the dialog.




P-CAD PCB User’s Guide                                                                                         491
Chapter 18: Library Commands                                                                     Library Rename




        2.   Select the Delete Item type (Component or Pattern radio button) for your delete action. The
             Symbol option button is grayed in PCB.
        3.   Click the Library button. The Library Select dialog is displayed, from which you can select the
             library in which you want to delete an item.
        4.   The library you selected in Library Select is displayed in the Library Delete dialog.
        5.   Click the item button (Pattern... or Component...) and the items within the displayed library
             will be listed in the Library Browse dialog. Select one and it will then be listed in the Library
             Delete dialog.
        6.   Click the Delete button and the item box becomes blank. This way you can continue to delete
             items from the same library.
        7.   Click Close to exit the dialog.


Library Rename
        Renames a pattern or a component.
        The library that you use in the execution of Library Alias, Library Delete, or Library Rename will
        remain current if you re-invoke any of the commands during the same session.

        IMPORTANT: If you rename a pattern, then all of the components in the library that reference that
        pattern by the original name will have no pattern reference, and will therefore be unplaceable. If
        you want to use a different naming convention for a pattern, and then create an alias for the pattern
        (Library » Alias command) and use that alias name. Likewise for components: if you want to use a
        different naming convention, using aliases is much safer than renaming.

      Renaming a Pattern/Component
        To rename a pattern or component, follow these steps:
        1.   Choose Library Rename to open the dialog.




492                                                                                    P-CAD PCB User’s Guide
Library Setup                                                                   Chapter 18: Library Commands




        2.   First select the Rename Item type (Component or Pattern radio button). The Symbol option
             button is grayed in PCB.
        3.   Click the Library button to open the Library Select dialog, where you can choose the library to
             access.
        4.   The library you selected in Library Select appears in the Library Rename dialog.
        5.   Click the item button (Pattern... or Component...) and the items within the displayed library
             will be listed in the Library Browse dialog. Select one and it will then be listed in the Library
             Rename dialog.
        6.   In the New Name section type the new name of your item, then click Rename. Both the old
             name and new name disappear if the rename action is successful. You can continue renaming
             items in the same library.
        7.   Click Close to exit the dialog.


Library Setup
        The Library » Setup command opens libraries from which you can access components.
        The Place » Component and Utils » Load Netlist commands use the Open Library list to place
        components. The Library Pattern Save As command also uses the Open Library list.
        When you want to place a component, the library file where the component resides must be open.
        You can open up to 100 libraries at one time.

    Drag and Drop File Load
        You can use the drag and drop method for opening library files (.lib) from the File Manager or
        other Windows file maintenance utilities. Drag the .lib icon(s) onto your PCB icon or workspace.

    Setting Up a Library
        To set up a library, follow these steps:
        1.   Choose Library » Setup to open the dialog.




P-CAD PCB User’s Guide                                                                                           493
Chapter 18: Library Commands                                                            Library Pattern Save As




             The dialog lists any libraries that are already open in the Open Libraries list box.
        2.   To add another library to the list, click Add to display the Library File Listing dialog. From there
             you can access the library directory to select a library file.
             When you select a file from the Library File Listing (and click OK), that filename appears in the
             Open Libraries list box in the Library Setup dialog.
        3.   To rearrange the list order, select a library name and click the Move Up or Move Down
             buttons.
        4.   To remove a library from the list, select the library name from the Open Libraries list box and
             click Delete.
        5.   Click OK and the libraries that you have specified are now open and accessible for component
             placement or saving patterns.
        In order to save a pattern or a component, you will need to setup the library in advance. The list of
        open libraries is saved to the pcb.ini file and therefore saved for subsequent sessions.

        Many commands start looking for components in the first open library. To ensure your component
        is found in the correct library, open custom libraries first or move them to the top of the list.


Library Pattern Save As
        The Library » Pattern Save As command saves a pattern to a library.
        This command allows you to group a selected collection of objects as a pattern, and save the
        pattern to a library. From the library you can later attach the pattern to a component. You must
        have a library already open to save a pattern to it.

      Saving a Pattern
        To save a pattern, follow these steps:
        1.   Use the block select function to select the objects you want included in your pattern.
        2.   While the objects are selected, choose Library » Pattern Save As to display the dialog.



494                                                                                    P-CAD PCB User’s Guide
Library Archive Library                                                       Chapter 18: Library Commands




        3.   Select a library that you want to save the pattern to, and then specify a pattern name. If you
             want to just create a pattern (not a component), click OK.
        4.   To automatically create a component that corresponds to the pattern, enable the Create
             Component option before you click OK.
             The auto-created component has pin designators, which match the Default Pin Designator of
             the individual pads. Give the component a new name in the Save Component As dialog;
             otherwise the component will be named the same as the pattern name.
             If the Create Component box is cleared, the pattern is created without a component; to create
             a component that uses this pattern use the Library Executive to build the component and then
             attach this pattern to it. The Library Executive User’s Guide includes a detailed tutorial on
             creating a 7400 component.
        5.   Enable the Match Default Pin Designators to Pad Numbers option if you want to apply default
             pin designators that match the pad numbers. If the pattern’s pads have existing default pin
             designators, you must confirm that you want them overwritten with the pad numbers.
             Duplicate default pin designators are not allowed, except blank. If any duplicates are found, an
             error message is displayed and the offending pads are highlighted.


Library Archive Library
        Choose Archive Library to store component information from open libraries for components used
        in the active design file. Saving the component information in one library file can be extremely
        helpful, especially for large designs, to keep the design component information in a single, readily
        accessible location. This eliminates the need to store the complete set of libraries used to create
        the design.
        When the Archive Library command is chosen, the following file search dialog appears:




P-CAD PCB User’s Guide                                                                                        495
Chapter 18: Library Commands                                                          Library Archive Library




       The definitions for each component in the current design must reside in at least one open library.

       The Save in area displays the current folder and any files in that folder. The File name area lets you
       enter or select a file name with the extension specified in the Save as Type area.
       1.   If the folder you want is not displayed in the Save In area, move through the directory tree to
            select the proper folder.
       2.   Type a new library file name in the File » Name area or select one from the list displayed in the
            Save In area.
       3.   Click Save.
       If the library already exists, and you want to replace the data in the file, you must confirm that you
       want the file to be overwritten.
       The results of the Archive Library command are displayed in an output file named
       ArchiveLibrary.err located in the same directory as the destination library. This file contains
       errors, warnings and informational messages logged during the archive process.




496                                                                                 P-CAD PCB User’s Guide
                                                                                     CHAPTER             19


                                                                 Utils Commands

Using the Utils Commands
       The Utils commands provide handy functions such as renumbering pads and reference
       designators, running design rule checking, and performing a variety of netlist tasks along with
       adding customized access to other applications.
       The Utils menu has additional command options if you have purchased P-CAD Library Executive.
       Utils commands P-CAD Library Executive, P-CAD Pattern Editor, and P-CAD Symbol Editor launch
       their respective P-CAD application. Refer to your Library Executive User’s Guide for details on these
       products.


Utils Renumber
       Utils » Renumber is a triple-function command for assigning pad numbers and default pin
       designators to free pads, and assigning reference designators to components manually or
       automatically.
       For components, you can also specify designator templates (e.g., U) and increment values (e.g., 1)
       for reference designators (U1, U2, etc.).

   Renumbering Reference Designators
       1.   Choose Utils » Renumber. The following Utils Renumber dialog appears:




P-CAD PCB User’s Guide                                                                                   497
Chapter 19: Utils Commands                                                                   Utils Renumber


       2.   In the Type frame, choose RefDes. The options in the dialog change accordingly (for RefDes),
            such as the Starting RefDes (e.g., U1) and Increment Value (e.g., 1. You also have the option of
            Manual or Auto, Top to Bottom or Left to Right.
       3.   If you choose Manual in the Method frame, you are in a temporary mode of assigning
            numbers, so every left-button click on a component for Manual renumbering will increment
            the value next to the designator. Notice that the Top to Bottom and Left to Right options are
            unavailable.
            You can enter the starting value in the Starting RefDes box. For example, if you entered the
            value U100 in the Starting RefDes box, then specify the Increment Value as 10, the first
            component you click is designated U100, the next one U110, then U120, etc. If you started at
            U000 and incremented by 1, the first would be U000, the second U001, etc.
       4.   Right-click or press ESC to end the temporary mode of Utils Renumber.
       To choose Auto in the Method frame, you must have multiple components selected before you use
       this command (Auto is shaded if you don't). After you click OK, the reference designators will
       automatically increment according to your specification. Only the selected components will be
       renumbered. For example, you have selected nine components positioned horizontally that are
       numbered randomly C1 through C9, you renumber them with the Increment Value of 1,
       automatically (Auto) and enabled Top to Bottom. When you click OK, they will renumber C1, C2,
       and C3, etc. in rows as shown in the following figure:




       If you choose Left to Right, with an increment value of 1, they will be numbered C1, C2, C3, etc. in
       columns as shown in the following figure.




498                                                                                P-CAD PCB User’s Guide
Utils Renumber                                                                 Chapter 19: Utils Commands




   Renumbering Pads
       To renumber pads, do the following:
       1.   Choose Utils » Renumber. The following Utils Renumber dialog appears.




       2.   In the Type frame, choose Pad Num; the rest of the choices in the dialog change accordingly.
            Then specify Starting Number, and Increment Value, as appropriate. Manual is the only choice
            for pad numbering; Auto is shaded.
       3.   You are in a temporary mode of assigning numbers. Click a pad to assign that pad a number.
            For example, the first pad you click on would be number 1 (if Start Value was specified as 1),
            the second pad number 2 (if the Increment Value was specified as 1). As you click on a pad
            while in the Renumber mode, it highlights to show that a number has been assigned.
            The Status Line shows the pad number every time you (re)number a pad.
            You can use the unwind feature to reverse the renumbering process. The BACKSPACE key
            unwinds the renumbering.
       4.   Right-click or press ESC to end the Renumber temporary mode.

       The renumber feature is sensitive to layers when renumbering pads. You must be on the
       appropriate layer for the pad to renumber it. For example, the current layer must be Top for a top
       SMT pad.




P-CAD PCB User’s Guide                                                                                       499
Chapter 19: Utils Commands                                                                 Utils Force Update


      Renumbering Default Pin Designators
        1.   Choose Utils » Renumber. The following Utils Renumber dialog appears.




        2.   In the Type frame, choose Default PinDes; the rest of the choices in the dialog will change
             accordingly. Then specify Starting PinDes, and Increment Value, as appropriate. Manual is the
             only choice for default pin designator numbering; Auto is shaded.
        3.   You are in a temporary mode of assigning numbers. Click a pad to assign that pad a number.
             For example, the first pad you click on would be assigned a default pin designator of A1 (if Start
             Value was specified as A1), the second pad’s default pin designator is A2 (if the Increment
             Value was specified as 1). As you click on a pad while in the Renumber mode, it highlights to
             show that a default pin designator has been assigned.
             The Status Line shows the default pin designator number every time you (re)number a pad.
             To reverse the renumbering process, press the BACKSPACE key. This unwinds the
             renumbering one pad at a time.
        4.   Right-click or press ESC to end the Renumber temporary mode


Utils Force Update
        Choose Utils » Force Update to replace all components of a given type in your design with the first
        component of that type in an open library. This is useful when you modify a component in P-CAD
        Library Executive and want to replace the original component in a PCB design with the modified
        component.
        For example, suppose you change the number of pins in a component or add a test point to a
        component in a library. When you try to place the modified component in the design, an error
        message appears. Choose Utils Force Update to update all occurrences of that component in the
        design to reflect the changes. When all existing components of that type have been changed in the
        design, you can place more of the newly modified component into the design without incurring an
        error.

        You cannot Force Update a fixed component in the design with a modified component of the same
        type.

        Choose Utils » Force Update to open the following Force Update dialog.




500                                                                                 P-CAD PCB User’s Guide
Utils Force Update                                                             Chapter 19: Utils Commands




        Select a component from the Components list, or click Set All to select all components. Then, click
        Update. To cancel your selections, click Clear All. The command looks in all open libraries in the
        order they are listed in the Library Setup list for the replacement components.
        Select the Maintain Rotation check box to maintain the rotation of any rotated components. It does
        not maintain rotations for components in designs loaded from Tango Series II.
        The buttons in the Attributes Handling frame let you choose the method used to update
        component attributes in your design with the same type of components from the library.
        Remember that there are rules used to determine an attribute value. For more information see the
        P-CAD Library Executive User’s Guide.
        •   Merge Attributes (Favor Library): This merge option combines library and design component
            attributes in the component being used in the design. It favors component attributes from the
            library over the component attributes of the same name in the design.
        The following rules determine which attributes and values are kept in the design component:
        •   If an attribute exists in the library component and not in the design component, the library
            attributes and their values are copied into the design component.
        •   If the same attribute exists in both the design component and the library component with
            different values, the value of the library component attribute will replace the value of the
            design component attribute.
        •   An existing design component attribute, which has no matching library component attribute, is
            retained, unchanged, in the design component.
        •   Merge Attributes (Favor Design): Again, this merge option combines library and design
            component attributes in the component being used in the design. This merge option favors
            component attributes in the design over the component attributes of the same name in the
            library.
        These rules decide which attributes and values are kept in the design component:




P-CAD PCB User’s Guide                                                                                     501
Chapter 19: Utils Commands                                                               Utils Record ECOs


        •   If an attribute exists in the design component and not in the library component, the design
            attributes and their values are kept, unchanged, in the design component.
        •   If the same attribute with different values exists in both the design component and the library
            component, the value of the design component attribute takes precedence and is retained in
            the design.
        •   Replace Attributes in The Design: Choose this option to replace all of the attributes and their
            values in the design component with those defined in the library component. Current design
            attributes are removed from the component.
        •   Ignore Attributes From Library: Keeps attributes in the design and ignores those in the library.
            This feature gives you more control over what to update in the design if you want to preserve
            any specific attribute modifications. With this feature, you can handle attributes in the same
            manner that is used when loading netlists in P-CAD PCB.


Utils Record ECOs
        Choose Utils » Record ECOs to record Engineering Change Orders (ECOs). The following Utils
        Record ECOs dialog appears.




        In the ECO Recorder frame, choose On or Off to enable or disable the ECO recorder. If there are
        pending ECOs, you are prompted when a design is saved on whether to append the pending ECO
        to the current ECO file.
        This function can also be activated using the ECO icon on the toolbar. When this function is
        activated (either from the toolbar or the Record ECOs dialog), the toolbar button is enabled).

      Types of ECOs
        The following types of ECOs can be recorded:
        •   RefDes change (Was-Is).
        •   Net name changes.
        •   Additions, deletions, and modifications of components.
        •   Component swaps (Replace).
        •   Additions and deletions of nets.
        •   Additions and deletions of net nodes.



502                                                                                P-CAD PCB User’s Guide
Utils Import ECOs                                                              Chapter 19: Utils Commands


       •    Additions, deletions, and modifications of attributes.
       •    Pin and gate swap changes.
       The format of the ECO file is determined by the setting in the Options Configure dialog. Full ECO-
       format files have an .eco file name extension, and Was/Is ECO files have a .was file name
       extension.
       PCB ECO was-is format differs from Tango-PCB ECO format to be more consistent with other
       industry was-is formats. In particular, temporary refdes names are different. To read these files into
       Tango- Schematic or Tango-PCB, you will need to edit the file and add a colon (:) before any
       temporary RefDes name.


Utils Import ECOs
       Choose Utils » Import ECOs to import an ECO file and apply the ECO changes to the current
       design file. The .eco file is created in P-CAD Schematic to capture schematic changes that impact
       your design.

       Fixed components can be deleted by importing an ECO file.

       When you choose this command the following dialog appears:




   ECO Filename
       1.   Click ECO Filename to open the following ECO Filename dialog.




       2.   Type, or select from the list, the name of the file you want to open in the Filename box.
       3.   .eco files are assumed to be full ECO format; .was files are assumed to be Was/Is format.



P-CAD PCB User’s Guide                                                                                    503
Chapter 19: Utils Commands                                                              Utils Import ECOs


        4.   Click Open to return to the Utils Import ECOs dialog.
        5.   To load components with a pseudo pattern, check the Create Pseudo Pattern check box. See
             for details.
        6.   Click OK to import the ECOs.

      Preview ECOs
        When you select an ECO filename and then click PreView ECOs, you can view ECOs, if there are
        any, before importing them. The ECOs are displayed in the Notepad.




        If you have added the same attribute to two parts in the same component from P-CAD Schematic,
        PCB rejects the multiple additions when it reads the ECO file with these changes. You need to
        delete the extra CompAttrAdd statements from the ECO file before reading it into PCB.

      Pseudo Patterns
        You can use the Create Pseudo Pattern option to load components that don’t have attached
        patterns. If a component does not have a pattern and matches a component in the open libraries, P-
        CAD PCB automatically creates a pseudo pattern.
        For each pseudo pattern created, a message appears to let you know which components are
        affected. A DRC error is reported for each pseudo pattern on the design.
        Output is restricted on designs with pseudo patterns. You can print the design, but Gerber Out,
        NC Drill, and PDIF Out are disabled. You can use the Utils Force Update command to replace
        components with pseudo patterns after you have finished creating and attaching the correct
        patterns for your components.




504                                                                              P-CAD PCB User’s Guide
Utils Export ECOs                                                            Chapter 19: Utils Commands



Utils Export ECOs
       Choose Utils » Export ECOs to save ECOs to the ECO file at any time, without saving the design file.
       If there are pending ECOs, the following dialog appears when you choose this command:




   View Pending ECOs
       When you click View Pending ECOs, you can view pending (outgoing) ECOs, which are still stored
       in memory. The pending ECO data are written to a temporary ASCII file and displayed in Windows
       Notepad. The format displayed is either full or Was/Is, depending on the setting in the Options
       Configure dialog.

   Save ECOs Now
       1.   To save pending ECOs, click Save ECOs Now. The following warning message appears:




            It is recommended that you save ECOs at the same time you save your design using the File »
            Save command. If you save ECOs without saving the design, your file and the ECOs may not
            match. That is, the ECOs might not reflect the current state of the design.
       2.   To continue, click Yes.
            The Save ECOs dialog appears:




P-CAD PCB User’s Guide                                                                                  505
Chapter 19: Utils Commands                                                                          Utils DRC


       3.   The ECO filename appears at the top of the dialog. It is the last used ECO file. To change it,
            click ECO Filename and the following dialog appears:




       4.   Type, or select from the list, the name of the file you want to open in the Filename box. Click
            Save to return to the Save ECOs dialog.
            Full ECO files must have an .eco extension, and Was/Is files must have a .was extension.
       5.   In the Comments box, type any comments that can help document the ECOs.
       6.   To append ECOs to the ECO file, click Append ECOs to File.
       7.   To discard ECOs, click ECOs. Once discarded they cannot be recovered.


Utils DRC
       Choose Utils » DRC to set up Design Rule Checking (DRC). This process ensures that all electrical
       connections in the design layout match the connections in the netlist; the program also checks to
       see if minimum clearances have been maintained throughout the design.
       DRC uses the design rules to determine the minimum clearance allowed between two objects. See
       for the order in which the rules are searched.
       This minimum clearance is calculated as follows:
       •    The minimum allowed clearance for each object is determined by searching the design
            clearance rules in a specific order.
       •    Then the maximum of these two clearance rules is used as the minimum clearance allowed
            between the objects.
       If the calculated clearance between the two objects is less than the minimum clearance, DRC
       reports a clearance violation.

       DRC ignores SPECCTRA Router clearance rules.

       Choose Utils » DRC to open the following dialog:




506                                                                                 P-CAD PCB User’s Guide
Utils DRC                                                                    Chapter 19: Utils Commands




   Filename
       Click Filename to open the Design Rule Check Report dialog. From this dialog you choose a DRC
       report file to which you can save the report information.




   View Report
       In the Report Options frame, select the View Report check box to open the DRC report file when
       the DRC is complete.

   Design Rules (DRC Setup)
       You can specify the rules for the design in Options » Design Rules. To open this dialog from the
       Utils Design Rule Check dialog, click Design Rules. The Options Design Rules dialog appears




P-CAD PCB User’s Guide                                                                                    507
Chapter 19: Utils Commands                                                                           Utils DRC




       In the Options Design Rules dialog, each of the six tabs allows you to set design rules on different
       hierarchical levels: Design, Layer, Rooms, Net Class, Net and Class to Class.

       Design Rules by Test Category
       Each rule in the Design Rules Check is associated with a test category. The test categories are linked
       to the order, or precedence, by which Design Rules Check applies the rules to the design.
       The following table shows the DRC rules to which values can be assigned for each test category. It
       also includes the order of precedence (hierarchy), from high to low, by which DRC looks for the
       presence of the rule’s value. For instance, if the Clearance rule has a value only at the Layer level,
       the Design Rule Check would have searched and found no assigned Clearance value in the Class-
       To-Class, Net, and Net Class rules and would then use the value set at the Layer level.


              Test Category                        Rules                              Hierarchy
        Netlist Compare             None                                  None
        Clearance Violations        Clearance                             Class-To-Class Layer
                                    LineToLineClearance                   Class-To-Class
                                    PadToLineClearance                    Net Layer
                                    PadToPadClearance                     Net
                                    ViaToLineClearance                    Net Class Layer
                                    ViaToPadClearance                     Net Class
                                    ViaToViaClearance                     Layer (except Clearance)
                                    BoardEdgeClearance                    Layer
                                                                          Design




508                                                                                 P-CAD PCB User’s Guide
Utils DRC                                                      Chapter 19: Utils Commands



              Test Category                   Rules                Hierarchy
        Width Violations         Width                 Net Layer
                                                       Net
                                                       Net Class Layer
                                                       Net Class
                                                       Layer
                                                       Design
        Netlist Violations       MaxVias               Net
                                 ViaStyle              Net Class
                                                       Layer
                                                       Design
        Unrouted Nets            None                  None
        Unconnected Pins         None                  None
        Net Length               MinNetLength          Net
                                 MaxNetLength          Net Class
                                                       Design
        Silk Screen Violations   SilkscreenClearance   Design
        Copper Pour Violations   Clearance             Class-to-Class Layer
                                 LineToLineClearance   Class-To-Class
                                 PadToLineClearance    Net Layer
                                 ViaToLineClearance    Net
                                                       Net Class Layer
                                                       Net Class
                                 BoardEdgeClearance    Layer
                                                       Design
        Plane Violations         Clearance             Class-to-Class Layer
                                 LineToLineClearance   Class-To-Class
                                 PadToLineClearance    Net Layer
                                 ViaToLineClearance    Net
                                                       Net Class Layer
                                                       Net Class
                                                       Layer
                                                       Design




P-CAD PCB User’s Guide                                                                509
Chapter 19: Utils Commands                                                                         Utils DRC



               Test Category                       Rules                             Hierarchy
        Component Violations        PlacementSide                        Component
                                                                         Room
                                                                         Design
                                    MaxComponentHeight                   Room
                                                                         Layer
                                                                         Design
        Drilling Violations         HoleToHoleClearance                  Design
        Test Point Violations       TestPointAccuracy                    Design
                                    TestPointCenter                      Design
                                    TestPointGrid                        Design
                                    TestPointPermitted                   Design
                                                                         Net Class
                                                                         Net
                                    TestPointRequired                    Design
                                    TestPointSide                        Design
                                                                         Net Class
                                                                         Net
                                    TestPointSpacing                     Design
                                                                         Net Class
                                                                         Net


       Design Rules by Hierarchy
       The next table illustrates how the test categories apply to the hierarchical levels, and lists the
       applicable rules. This table begins with the most specific hierarchical level and graduates up to the
       most general level.


                 Hierarchy                    Test Category                           Rules
        None                        Netlist Compare                      None.
                                    Unrouted Nets
                                    Unconnected Pins
        Component                   Component Violations                 PlacementSide only.
        Room                        Component Violations                 PlacementSide
                                                                         MaxComponentHeight




510                                                                                P-CAD PCB User’s Guide
Utils DRC                                                    Chapter 19: Utils Commands



                Hierarchy               Test Category               Rules
        Class-to-Class Layer   Clearance Violations     Clearance
                               Copper Pour Violations   LinetoLineClearance
                               Plane Violations         PadToLineClearance
                                                        PadToPadClearance
                                                        ViaToLineClearance
                                                        ViaToPadClearance
                                                        ViaToViaClearance
                                                        BoardEdgeClearance
                                                        NOTE: Lines, arcs and vias
                                                        cannot touch a keepout.
        Class-to-Class         Clearance Violations     Clearance
                               Copper Pour Violations   LinetoLineClearance
                               Plane Violations         PadToLineClearance
                                                        PadToPadClearance
                                                        ViaToLineClearance
                                                        ViaToPadClearance
                                                        ViaToViaClearance
                                                        BoardEdgeClearance
                                                        NOTE: Lines, arcs and vias
                                                        cannot touch a keepout.
        Net Layer              Clearance Violations     Clearance
                               Width Violations         LinetoLineClearance
                               Copper Pour Violations   PadToLineClearance
                               Plane Violations         PadToPadClearance
                                                        ViaToLineClearance
                                                        ViaToPadClearance
                                                        ViaToViaClearance
                                                        BoardEdgeClearance
                                                        Width
                                                        NOTE: Lines, arcs and vias
                                                        cannot touch a keepout.




P-CAD PCB User’s Guide                                                               511
Chapter 19: Utils Commands                                                      Utils DRC



               Hierarchy               Test Category                Rules
        Net                  Clearance Violations      Clearance
                             Netlist Violations        LinetoLineClearance
                             Net Length                PadToLineClearance
                             Copper Pour Violations    PadToPadClearance
                             Plane Violations          ViaToLineClearance
                             Test Point Violations     ViaToPadClearance
                                                       ViaToViaClearance
                                                       BoardEdgeClearance
                                                       MaxVias
                                                       ViaStyle
                                                       MinNetLength
                                                       MaxNetLength
                                                       TesPointRequired
                                                       TestPointGrid
                                                       TestPointSpacing
                                                       TestPointPermitted
                                                       TestPointAccuracy
                                                       TestPointSide
                                                       TestPointCenter
                                                       NOTE: Lines, arcs and vias
                                                       cannot touch a keepout.
        Net Class Layer      Clearance Violations      Clearance
                             Width Violations          LinetoLineClearance
                             Copper Pour Violations    PadToLineClearance
                             Plane Violations          PadToPadClearance
                                                       ViaToLineClearance
                                                       ViaToPadClearance
                                                       ViaToViaClearance
                                                       BoardEdgeClearance
                                                       Width
                                                       NOTE: Lines, arcs and vias
                                                       cannot touch a keepout.




512                                                               P-CAD PCB User’s Guide
Utils DRC                                                 Chapter 19: Utils Commands



               Hierarchy             Test Category               Rules
        Net Class          Clearance Violations      Clearance
                           Netlist Violations        LinetoLineClearance
                           Net Length                PadToLineClearance
                           Copper Pour Violations    PadToPadClearance
                           Plane Violations          ViaToLineClearance
                           Test Point Violations     ViaToPadClearance
                                                     ViaToViaClearance
                                                     BoardEdgeClearance
                                                     MaxVias
                                                     ViaStyle
                                                     MinNetLength
                                                     MaxNetLength
                                                     TesPointRequired
                                                     TestPointGrid
                                                     TestPointSpacing
                                                     TestPointPermitted
                                                     TestPointAccuracy
                                                     TestPointSide
                                                     TestPointCenter
                                                     NOTE: Lines, arcs and vias
                                                     cannot touch a keepout.




P-CAD PCB User’s Guide                                                            513
Chapter 19: Utils Commands                                                                     Utils DRC



                Hierarchy                   Test Category                          Rules
        Layer                     Clearance Violations                Clearance
                                  Netlist Violations                  LinetoLineClearance
                                  Net Length                          PadToLineClearance
                                  Copper Pour Violations              PadToPadClearance
                                  Plane Violations                    ViaToLineClearance
                                  Component Violations                ViaToPadClearance
                                                                      ViaToViaClearance
                                                                      MaxVias
                                                                      ViaStyle
                                                                      MinNetLength
                                                                      MaxNetLength
                                                                      TesPointRequired
                                                                      TestPointGrid
                                                                      TestPointSpacing
                                                                      TestPointPermitted
                                                                      TestPointAccuracy
                                                                      TestPointSide
                                                                      TestPointCenter
                                                                      MaxComponentHeight
                                                                      NOTE: Lines, arcs and vias
                                                                      cannot touch a keepout.


       Additional Design Rules
       The third table, shown below, lists additional checks performed by DRC, which are not user
       specified. You do not have to add attributes or specify values for attributes in order for DRC to
       check these constraints. For instance, DRC checks components for inclusion in a Room. You cannot
       set a value for this check since there is no attribute associated with it, but it is part of the
       verification that DRC performs.


            Test Category                    DRC Checks
        Clearance                Short
                                 Short to Copper Tie
                                 Uncommitted Pins Shorted




514                                                                              P-CAD PCB User’s Guide
Utils DRC                                                            Chapter 19: Utils Commands



             Test Category                    DRC Checks
        Component               Component Side
                                Component Height
                                Room Inclusion
                                Empty Room
        Copper Pour             Copper Pour Clearance
                                Unconnected Copper Pour Island
                                Unpoured Copper Pour
                                Copper Pour No Net
        Drilling                Drilling Clearance
                                Hole Range Same Layer
                                Hole Range Conflict
        Net Length              Net Length
        Netlist                 Point-to-Point Connectivity
                                Pseudo Pattern
                                Undefined Via Style
                                Tie Net Connectivity to Copper Tie
                                Net Connectivity to Uncommitted
                                Pins
        Plane                   Plane Clearance
                                Fragmented Plane
                                Plane Partial Connections
                                Plane Shorts
                                Plane Unconnected
                                Plane No Net
                                Plane Overlap
        Silk Screen Clearance   Silk Screen




P-CAD PCB User’s Guide                                                                      515
Chapter 19: Utils Commands                                                                           Utils DRC



                 Test Category                   DRC Checks
          Test Point                Test point not on net copper.
                                    Test point not positioned on grid.
                                    Test point violates spacing rule.
                                    Test point not permitted on object.
                                    Test point not centered on SMT.
                                    Test point not centered on thru
                                    hole.
                                    Test point pad and via accuracy.
                                    Test point required by net.
                                    Test point on wrong side.
          Text                      Text Clearance
          Unconnected Pin           Unconnected Pin
          Unrouted Net              Unrouted net
                                    Hole Range No connect
                                    Hole Range Violation

         When you have finished setting up the design rules click Close to return to the Utils Design Rule
         Check dialog.

      Annotate Errors
         To show DRC error indicators on your design, select the Annotate Errors check box in the Error
         Options frame. These error indicators can then be selected to view error information. The error
         information is determined by the other error/violation options that you enable in design rule
         checking.
         To view the error associated with an error indicator, select it and choose Edit » Properties. This
         opens the Find DRC Errors dialog. The display of the error indicators can also be controlled in the
         Miscellaneous tab of the Options Display dialog; the selection criteria for DRC error indicators (for
         block selecting) is determined by the Options » Selection Mask command. For details, see
         Miscellaneous (page 444) and Options Selection Mask, (page 423).
         The DRC error indicators can be output to a report, which lists all of the locations and the errors
         that they are indicating.
         When you are finished setting up the DRC options, click OK to begin the design rule checking
         process. Error indicators are cleared when you choose Utils » DRC.

      Severity Levels
         In the Utils Design Rule Check dialog, click the Severity Levels button to open the Rules Severity
         Level dialog where you can set the severity level of each design rule.




516                                                                                  P-CAD PCB User’s Guide
Utils DRC                                                                         Chapter 19: Utils Commands




       By choosing one of the Severity Level option buttons, you can set one of three severity levels: error,
       warning, or ignored.
       •    If you choose the Error button, DRC error indicators are created for you to display, select, and
            view.
       •    If you choose the Warning button, DRC errors are included in the DRC report but not
            annotated in the design.
       •    If you choose the Ignored button, DRC errors are not annotated in the design. An error
            summary appears in the report only if you select the Summarize Ignored Checks check box in
            the Report Options frame of the Utils Design Rule Check dialog.
       Select one or more rules and click the appropriate option button to change the severity level of the
       rule(s). Rule categories include the following: clearance, netlist, unconnected pints, copper pour,
       drilling, unrouted nets, silkscreen, text, width, component, plane, and test point.
       To restore the default values for the severity level of all rules, select the Set to Default check box
       and click OK.

   Summarize Ignored Errors
       If a design rule has a severity level set to Ignored, it is not listed in the output report. The count of
       Ignored errors can be summarized in the report, however, by enabling the Summarize Ignored
       Errors option.

   Summarize Overridden Errors
       When a design has a number of errors that you do not wish to see again, such as unconnected pins,
       you can override their appearance in the design by choosing the Edit Override command and
       disabling the Display Overridden Errors option in the Miscellaneous tab of the Options Display
       dialog. To summarize this type of error in the DRC report, enable the Summarize Overridden Errors
       option in the Utils DRC dialog.




P-CAD PCB User’s Guide                                                                                          517
Chapter 19: Utils Commands                                                                             Utils DRC


      Clear All Overrides
         When errors in the design have been overridden, and you want to clear or delete them from the
         design, enable the Clear All Overrides option.

      Design Rule Checks
         The Design Rule Checks frame contains a number of report options. When a check box is selected,
         that option appears in the DRC report. When a check box is clear, the option is not included in the
         report.
         •   Netlist Compare. Compares a Tango, P-CAD ASCII, or Master Designer ALT format netlist file
             with the current nets in the design.
         •   Clearance Violations. Enables air-gap and board edge clearance checking and reports existing
             shorts. Items are considered to be physically connected if they overlap or have a clearance of 0
             mil. Items that can be physically connected to one another are arcs, polygons, pads, lines,
             copper pours and vias. The bounding rectangle of text placed in the design is checked to
             assure that it does not short to other copper on the signal layers. If this check box is clear, no
             clearance errors will be reported.
         •   Text Violations. Reports all clearance violations between text and other items on signal layers.
         •   Netlist Violations. Enables electrical checking against the netlist within the design. If there are
             no nets in the design, this option is ignored. The report includes a warning for those objects
             that are not point-to-point routed. The warning includes the location of the objects.
         •   Width Violations. Verifies that the line and arc widths do not exceed the DRC designated
             widths.
         •   Unrouted Nets. Enables reporting of any nets that are currently unrouted (unrouted
             connections still exist in the design). Unconnected Pins enables the reporting of all pins that
             are not connected to other pins. This includes all of the single-node routes as well as pins that
             are not connected to anything at all.
         •   Net Length. Enables the reporting of net lengths, which exceed the minimum, and/or
             maximum lengths set for lines and arcs within the net.
         •   Silkscreen Violations. Enables checking on pad/via to silkscreen violations. Silkscreen on pads
             on top layer can interfere with soldering process; on vias it can cause paint dripping or
             collecting in unwanted areas.
         •   Copper Pour Violations. Enables reporting of unflooded copper pour entities, copper pours
             that are not part of a net, copper pour island clearance violations, unconnected islands, fill
             areas and thermal connections that have clearance violations.
         •   Plane Violations. Enables reporting of overlapping planes, invalid pad and via copper
             connections, connected pad and vias that are not electrically connected to the plane, isolated
             areas of copper in a plane.
         •   Component Violations. Enables error reporting when violations occur in a component’s height
             and layer side placement. In addition, a violation is reported when a Room’s Included



518                                                                                   P-CAD PCB User’s Guide
Utils Find Errors                                                                  Chapter 19: Utils Commands


             Component list is empty, or if any of the Included Components have not been properly placed
             in the Room.
        •    Drilling Violations. Enables connectivity checking of pads/vias through their attached layers,
             utilizing the layer ordering and hole range for determining where the pad/vias begin and end.
             Also enables checking for layer separation, interference between holes, collocated holes, and
             vias existing solely on a signal layer.
        •    Test Point Violations. Select this check box to check for nets that do not have a required test
             point. This option also checks for test points that do not fall on the correct object, or on the
             specified test point grid or pad center. In addition, it checks for test points that fall inside of
             the minimum spacing or on a different side of the board than the net requires.

    Area To DRC
        If you are working in a specific area of the board and only want to check violations in that area, you
        can choose where to apply the DRC with one of the following options:
        •    Entire Workspace: This default setting checks rules violations for the entire design.
        •    Room: If your design has one or more rooms, you can choose a specific room to DRC by
             clicking the Room radio button and selecting the desired room from the drop down list
             provided. PCB checks the design rules on all layers for design objects that intersect the room.
        •    Region: When you click the Region button, you can define the exact area to DRC. The Region
             can be defined in two ways:
        •    Click the Define Region button. PCB takes you back to the design. Press and hold the left
             mouse button on the first corner of the area you want to define. Drag the cursor until the
             target zone is completely within the rectangle and release the button. Click the right mouse
             button or press the ESC key and confirm that you want to update the region coordinates
             provided in the message.
             To set the Region Coordinates directly, enter the X and Y coordinates for the Lower Left and
             Upper Right in the appropriate boxes.
        Click OK to begin the design rule checking process.


Utils Find Errors
        Choose the Utils Find Errors command to open the Find DRC Errors dialog. In this dialog, you can
        view and find the rules violations in your design:




P-CAD PCB User’s Guide                                                                                             519
Chapter 19: Utils Commands                                                                Utils Load Netlist




       If you have not run the Utils » Design Rules Check, then the Find DRC Errors dialog displays a
       message informing you that there are no DRC error points. When you choose the DRC command,
       you have access to all the errors through the Find DRC Errors dialog.
       The sections of the dialog are as follows:
       •   Categories: Displays the rule categories in a drop down list. You can view the errors for one or
           all categories by selecting the desired category.
       •   Description: Displays the error number along with an explanation for the error.
       •   Error Number: In the Error Number box you can type the number of the error you want to see
           and click the Find button to go directly to it. If you want to scroll through the errors
           sequentially, use the up and down arrows next to the box.
       •   Show Only Selected: If you have block selected an area in the design, and want to see just the
           errors in that location, enable the Show Only Selected option.
       •   Jump To: When you find an error in the report that you want to locate in the design, click the
           Jump To button. The error finder positions the cursor in the center of the error indicator.
       •   Override: Don’t display this error again: As you display each error in the design, individual
           errors can be removed from the error display by checking the Override - Don’t display this
           error again option. The overridden errors can be summarized in the reports by enabling the
           Summarize Overridden Errors option in the Utils Design Rule Check dialog.
       The Find DRC Errors dialog remains on the screen until you click the Close button. As long as there
       are error indicators in the design, you can retrieve the error information in the Find DRC Errors
       dialog with the Utils Find Errors command.


Utils Load Netlist
       Choose the Utils » Load Netlist command to load a netlist from a .net file into your design. If you
       have a board outline created, the components will be placed directly above the board outline. If
       there is no board outline, the components will be placed into the lower-left corner of the
       workspace.

       If any of the design limits are exceeded, your design cannot be loaded using P-CAD PCB (6/400).
       See Chapter 1, Introduction to P-CAD PCB, for a listing about the actual limit.



520                                                                               P-CAD PCB User’s Guide
Utils Load Netlist                                                                 Chapter 19: Utils Commands


    Loading a Netlist
        1.   Choose the Utils » Load Netlist command. The Utils Load Netlist dialog appears.




        2.   To choose a netlist file, click the Netlist Filename button. The Netlist File dialog appears from
             which you choose a netlist file.
        3.   Use the Netlist Format field and combo box to select the correct source file format for the
             netlist file so that the PCB file filter can read the format.
             Your choices are P-CAD ASCII, Master Designer ALT, and Tango format. P-CAD ASCII format
             includes attributes attached to each net and component in the netlist. Tango format is the
             standard Tango format.
        4.   If you select P-CAD ASCII, four options for attribute handling are available: attributes may be
             merged with current design attributes, favoring either the netlist or the design attribute if the
             attribute exists in both; attributes may be ignored; or all design attributes may be removed and
             replaced with those present in the netlist.
             If you select P-CAD ASCII, two net class options are available. You can choose to replace
             existing net classes with net classes in the netlist, or to ignore the net class information in the
             netlist.
        5.   If you select the Master Designer ALT file format, use the Xref Filename button to open a cross-
             reference file (.xrf) for type mapping.
        6.   To load components with pseudo patterns, check the Create Pseudo Pattern check box.




P-CAD PCB User’s Guide                                                                                         521
Chapter 19: Utils Commands                                                                   Utils Load Netlist


         7.   When you select a file from the Netlist File dialog, you will return to the Netlist File Load
              dialog, where the filename will appear. Click OK and the netlist from the file will load onto
              your design.

      Loading a Netlist on an Existing Board
         You can load a netlist into an existing board (which already has items), with the following rules and
         results:
         •    Components with matching RefDes must also have matching Types. If there is any conflict with
              the component section of the netlist, the load is aborted.
         •    Any existing components on the board that are not part of the netlist will be preserved.
         •    Any components in the netlist being loaded that are new to the design will be added.
         •    For components that include, pads and text that are of styles that have the same names but
              different data than those styles in the current design, the incoming style names will be
              bracketed to indicate the style conflict. The new (bracketed) style names will be added to the
              list of available styles in the current design.
         •    The net information and connections of the existing design will be replaced by the new net
              information.
         •    If you enable the Reconnect Copper check box, an analysis done by the program may find nets
              that are shorted. Shorted nets are listed in the error log file.
         •    When a new net is found to be open, a connection will be created. When extra connections, or
              misconnections, are found, a warning message appears.
         •    In the event that existing copper and new nets match, no connection lines will appear because
              the nets are already routed.

      Pseudo Patterns
         You can choose the Create Pseudo Pattern option to load netlist components that don’t have
         attached patterns. If a netlist component does not have a pattern and matches a component in the
         open libraries, P-CAD PCB automatically creates a pseudo pattern.
         For each pseudo pattern created, a message appears to let you know which components are
         affected.

      Jumper Pads
         Components with jumper pads behave as if all of the pads marked as being jumpered together are
         connected.

      Optimize Nets
         The Optimize Nets check box can be used to inhibit the automatic optimization of the rats nest
         connections. If optimization is disabled, the connections are made in the order given in the netlist.
         Disabling this option also speeds up the netlist load process since the time-consuming



522                                                                                  P-CAD PCB User’s Guide
Utils Generate Netlist                                                           Chapter 19: Utils Commands


        optimization phase is skipped. Once the netlist is loaded, you can choose the Utils » Optimize Nets
        command at any time.

    Reconnect Copper
        Select the Reconnect Copper check box to inhibit the automatic “reconnect” of existing copper on
        the board. If reconnect is disabled, the net connections match the netlist exactly, and all existing
        copper on the board is converted to “free” (non-intelligent) copper. Free copper isn't associated
        with any net. If there is existing copper on the board, and the reconnect option is enabled, the
        reconnect phase can take a long time. Therefore, it is recommended that you only disable the
        reconnect option if you want to quickly load a netlist into a board with existing copper, and you are
        willing to accept having free copper.
        When the Reconnect Copper check box is enabled, Utils Load Netlist generates connections
        between those objects that are physically connected but not point-to-point routed.

        If you disable reconnect, it is possible that existing free copper on the board will short one or more
        nets together. This can only be detected by choosing the Utils » DRC command.

        After you have loaded the netlist, you can select the components and connections either as a group
        (a block select) or individually (single select) to move them into their appropriate positions in the
        design.



    Check for Copper Sharing
        If the Check for Copper Sharing option is enabled, line to line trace intersections and line traces
        crossing the center of a pad or via are detected. Intersecting line traces are split at the point of
        intersection and lines are split at pad or via centers, creating point-to-point routes.


Utils Generate Netlist
        Choose the Utils » Generate Netlist command to create a netlist from the combination of
        connections you have established (or loaded) in a design file.
        Free copper (non-net connections) will not generate a netlist. Free pads, which are a valid part of a
        net, are not listed as net nodes in the netlist.

    Generate a Netlist
        1.   Choose the Utils » Generate Netlist command to open the dialog.




P-CAD PCB User’s Guide                                                                                         523
Chapter 19: Utils Commands                                                                Utils Compare Netlist


         2.   To choose a netlist file, click the Netlist Filename button. The Netlist File dialog appears from
              which you can choose a file.
         3.   If you want to generate your netlist to a different format, use the Netlist Format box and combo
              box to specify the destination format.
              Your choices are Tango format and P-CAD ASCII format. Tango format is the standard Tango
              format. P-CAD ASCII format includes attributes attached to each net and component in the
              netlist.
         4.   Enable the Include Library Information check box if you want an optional library section to be
              written to the netlist.
              Library information is read by PCB but not processed; it is merely informational. The Library
              section may be used to create a P-CAD library, however, by removing the non-library
              information from the file and using the Library Executive to translate the ASCII form of the
              Library into a binary library.
         5.   Click OK in the Netlist Generate dialog and the netlist will be created with the filename and
              netlist format you have specified.


Utils Compare Netlist
         Choose the Utils » Compare Netlist command to compare the current nets of the design you have
         in memory with the netlist file that you specify. This useful feature verifies the integrity of your
         design against the original netlist. For example, if you mistakenly deleted a component or net, this
         command will show you the discrepancy. This command compares logical net information. That is,
         it works even if there are open (unrouted) nets. Use the Utils » DRC command to check existing
         copper.

      Comparing a Netlist
         1.   Choose Utils » Compare Netlist to open the dialog.




524                                                                                    P-CAD PCB User’s Guide
Utils Optimize Nets                                                             Chapter 19: Utils Commands


        2.   Click the Netlist Filename button to display the Netlist File dialog. From here you can access
             the netlist filename of the original netlist, which you loaded into your design file.
             You can use this command to compare the design file with any of the available file formats,
             which are:
             •   Tango
             •   P-CAD ASCII
             •   Master Designer ALT
             If you compare the design against a P-CAD ASCII netlist, P-CAD PCB reports on the differences
             between the design and netlist attributes for netlist and component attributes, as well as net
             classes. This feature enables you to check attributes as well as connectivity in your design.
             The Master Designer ALT file format also supports the use of a cross-reference file (.xrf) for
             type mapping.
        3.   The Attributes area allows you to choose the categories you want to compare from the list of
             Categories in the Netlist file. Move selected attribute categories from the Categories listbox to
             the Compare listbox, or vice versa, by clicking the appropriate direction arrow. You can also
             double click a category in either list box to move it to the opposite box.
             Attributes placed in the Compare listbox are retained throughout your PCB session.
        4.   Click OK and any discrepancies appear on the screen.


Utils Optimize Nets
        Choose the Utils » Optimize Nets command to perform netlist optimization to shorten the length
        of connections between net nodes. Further, this command allows you to perform pin and gate
        swapping to rearrange connections logically in order to produce shortened or more direct
        routings, or dispersed routings to ease congestion in certain areas.
        Generally, you apply a gate or pin swap on logical connections created as a result of placing
        components in PCB. You can convey gate and pin swaps, which result in net list modifications, back
        to P-CAD Schematic from PCB with the ECO utility.

    Utils Optimize Nets Command
        The Optimize Nets command allows you to select automatic or manual pin and gate swapping. To
        choose this command, you must be in Select mode.
        1.   Choose the Utils » Optimize Nets command to open the Utils Optimize Nets dialog.




P-CAD PCB User’s Guide                                                                                        525
Chapter 19: Utils Commands                                                              Utils Optimize Nets




       The dialog defaults to Auto, with the Gate Swap and Pin Swap options disabled. To perform only a
       minimization of the nets connection, click OK.
       When you click OK, connections are rearranged to shorten the total connection length. If Gate
       Swap or Pin Swap are checked the gate and pin swaps occur in accordance with the rules found
       later in this section.

       Automatic Pin and Gate Swapping
       1.   Be sure that the Auto radio button in the Method box is selected.
       2.   For gate swapping, click the Gate Swap box.
       3.   For pin swapping, click the Pin Swap box.
       4.   To perform gate and pin swapping in the entire design, click the Entire Design radio button.
       5.   To perform gate and pin swapping on selected objects, click the Selected Objects radio button.
            This button is grayed out unless you have selected objects before choosing the Utils »
            Optimize Nets command.
       6.   Click OK.
       The Not-Undoable Operation warning message appears. If you press No, you are returned to the
       Optimize Net dialog. If you press Yes, the Optimize Nets Progress dialog appears.
       The Optimize Nets Progress dialog provides you with the current and cumulative status of the
       command. You can stop the command at any time without losing the accumulated results by
       clicking Stop.
       The Current Status box describes the current activity. The current activity can show swapping gates
       or pins, or minimizing connection length. Any swaps that occur follow the swapping rules.

       Entire Design/Selected Objects
       If you selected the Entire Design radio button on the Utils Optimize Nets dialog, the following
       actions occur:
       •    If you selected Gate Swap or Pin Swap, pin or gate swapping occurs between any components
            in the design following the swapping rules outlined in the section below entitled When
            components and net connections are selected. All nets are guaranteed to not have their
            connection lengths increase.
       •    Minimum length optimization occurs for all nets.




526                                                                               P-CAD PCB User’s Guide
Utils Optimize Nets                                                               Chapter 19: Utils Commands


        If you selected the Selected Objects radio button, the following actions occur:
        When only components are selected:
        •    If you selected Gate Swap or Pin Swap, swapping is restricted to pins and gates among the
             selected components. Swapping occurs only to improve (decrease the Manhattan connection
             length of) those nets with connections to the selected components' pads. Other nets'
             connections may increase in length.
        •    Minimum length net optimization occurs on the connections between the selected
             components.
        When only net connections are selected:
        •    If you selected Gate Swap or Pin Swap, swapping occurs only to improve (decrease the
             Manhattan connection length) the selected connections' nets. This means that all gates and
             pins are eligible for swapping, as long as a selected net improves from the swap. Connections
             that are not selected may increase in length.
        •    Minimum length net optimization occurs on the selected connections.
        When components and net connections are selected:
        •    If you selected Gate Swap or Pin Swap, swapping is restricted to pins and gates among the
             selected components. Swapping occurs only to improve (decrease the Manhattan connection
             length) the selected connections' nets. Those un-selected connections may increase in length.
        •    Minimum length net optimization occurs on the selected connections.



    Manual Gate Swap
        You can use the Manual Gate Swap options to perform gate swapping manually on selected pads.
        To perform manual gate swapping,
        1.   Select Manual Gate Swap on the Utils Optimize Nets dialog.
        2.   Click the OK button. The Optimize Nets dialog disappears, and the cursor changes to the
             “more points” shape. If you click the right mouse button or press the ESC key, the command is
             aborted and you are returned to the Select tool. The cursor shape returns to the original shape.
        3.   Click a pad and all pads of that gate, along with the connections that are attached to those
             pads, appear highlighted in cyan, the first swap color.
             All the pads of the eligible equivalent gates (as defined by the gate swapping rules), and their
             connections, appear highlighted in magenta, the second swap color.
             If you click a pad that isn't part of a gate that can be swapped you will hear a beep. If you click
             the right mouse button or press the ESC key, the command restarts at the initial state, with all
             of the pads and their connections being unhighlighted.




P-CAD PCB User’s Guide                                                                                        527
Chapter 19: Utils Commands                                                                Utils Optimize Nets


            The current layer must be a layer on which the pad is defined for the pad to be selected.
            Otherwise you hear a beep, indicating no action can take place.

       4.   Click one of the eligible pads (those highlighted in the second swap color). Its gate and its
            connections now appear in the first swap color, and the Manual Gate Swap dialog now
            appears.




            The dialog presents you with a list of the affected nets and their new connection lengths. The
            Manhattan connection length is calculated by determining the Manhattan length after an
            optimization. The percent changed is the percentage of the difference of the connection
            lengths before and after swapping. Below the list box the total for all of the nets appears.
            If net copper is attached to any pads of the two selected gates, then the Swap button is grayed
            and a warning appears in the dialog. Nets that have copper attached are preceded by an
            asterisk. The warning tells you that net copper is attached to a gate's pad, and it must be
            removed before swapping can occur. Free copper is ignored.
       5.   To perform the gate swap, click Swap.
            All of the nets attached to the first gate are swapped with all the nets attached to the second
            gate. The dialog disappears and the cursor returns to its original shape, ready for the next gate
            swap. All of the highlighted pads and connections are unhighlighted.
       6.   Click Cancel to cancel the operation.
       The dialog disappears, no swap occurs, and the pads of the second gate, with their connections,
       revert to highlight color two. You can now select another gate for swapping.

       Manual Pin Swap
       You can use the Manual Pin Swap options to perform pin swapping manually on selected pads. To
       perform manual pin swapping,
       1.   Check Manual Pin Swap button on the Utils Optimize Nets dialog.
       2.   Click the OK button. The Optimize Nets dialog disappears, and the cursor changes to the
            “more points” shape. If you click the right mouse button or press the ESC key, the command is
            aborted and you are returned to the Select Tool. The cursor shape returns to the original
            shape.



528                                                                                 P-CAD PCB User’s Guide
Utils Optimize Nets                                                              Chapter 19: Utils Commands


        3.   Click a pad. That pad, along with the connections that are attached to that pad, appear
             highlighted in cyan, the first highlight color. All of the eligible equivalent pads (as defined by
             the pin swapping rules), and their connections, appear in magenta, the second highlight color.
             If you click the right mouse button or press the ESC key, the command restarts at the initial
             state, with all of the pads and their connections being unhighlighted.

             The current layer must be a layer that the pad is defined on for the pad to be selected.
             Otherwise you hear a beep.

        4.   Click a pad. The pad and its connections appear in cyan, the first highlight color. If the selected
             pad is not an equivalent pad, a warning message appears stating: “The selected pad is not
             recommended for swapping, proceed with caution.” This action constitutes a forced swap. The
             Swap Pins dialog now appears.




             The dialog presents you with a list of the affected nets and their new connection lengths. The
             Manhattan connection length is calculated by determining the Manhattan length after an
             optimization. The percent changed is the percentage of the difference of the connection
             lengths before and after swapping. Below the list box the total for all of the nets appears.
             If net copper is attached to either of the two selected pads, then the Swap button is grayed and
             a warning appears in the dialog. Nets that have copper attached are preceded by an asterisk.
             The warning tells you that net copper is attached to one of the pads, and it must be removed
             before swapping can occur. Free copper is ignored.
        5.   To perform the pin swap, click Swap.
             All of the net connections attached to the first pad swap with all the net connections attached
             to the second pad. The dialog disappears, and the cursor returns to its original shape, ready for
             the next pin swap. All of the highlighted pads and connections are unhighlighted.
        6.   Click Cancel to cancel the operation.

    Rules for Pin Swapping
        The rules for pin swapping are:
        •    Pin swapping occurs within a gate between logically equivalent pins. The equivalence values
             must be non-zero and identical for a swap to occur between two pins. Swapping is allowed
             between non-equivalent pins, but only after you give confirmation (a forced swap). Forced


P-CAD PCB User’s Guide                                                                                       529
Chapter 19: Utils Commands                                                                Utils Reconnect Nets


             swaps can occur only during a manual pin swap; they do not occur during automatic pin
             swapping.
         •   No swapping occurs if net copper is connected to either pad.
         •   Swapping does not occur if a net connected to the pin has the OPTIMIZE attribute set with a
             value of “NO”.
         •   Swapping does not occur if the component has the NOSWAP attribute set to Yes.

      Rules for Gate Swapping
         The rules for gate swapping are:
         •   The gates must be logically equivalent.
         •   The gates must be of the same component type with equivalent value if swapping across
             components. The component values must be the same so that gate swapping with discrete
             parts works correctly. (For example, a gate swap between two RES components, one with a
             value of 50 ohm and the other 100 ohm, isn't allowed).
         •   The swapping of gates between components can be further restricted by use of the swap
             eligibility attribute (SWAPEQUIVALENCE). For example, one circuit might be used to monitor
             another circuit on the board. It would defeat the purpose of the monitor circuit to have its
             gates swapped with the gates in the other circuit. By setting the components in the monitor
             circuit to have a swap eligibility attribute different than the other circuit, swapping can be kept
             from occurring between the two circuits.
         •   Swapping does not occur if the component has the NOSWAP attribute set to Yes.
         •   Swapping does not occur if net copper is connected to either of the gates.
         •   Swapping does not occur if any net connected to the gate has the OPTIMIZE attribute with a
             value of “NO”.

      Impact on the Library Executive
         Gate Equivalency maintenance: Currently, the Library Executive allows the gate equivalency of
         pins in the same gate to be different. This causes gates to be non-equivalent by ambiguity. To
         correct this problem, when you change a part number, or gate equivalence for some gate, the
         spreadsheet automatically updates the gate equivalence field of the other pins of that gate to
         match. Existing components with this problem can be read in but cannot be saved until the
         ambiguity is corrected.
         Pin Equivalence: Pin equivalence is allowed only between pins with the same electrical type. The
         electrical types Unknown and Passive are considered the same for purposes of pin equivalence.


Utils Reconnect Nets
         Choose the Utils » Reconnect Nets command to use the current design netlist to re-establish the
         net information for copper traces, arcs, pads, polygons, and vias having point-to-point routes to



530                                                                                   P-CAD PCB User’s Guide
Utils Reconnect Nets                                                             Chapter 19: Utils Commands


        copper in an existing net. You can also create system-generated nets for circuits composed entirely
        of objects that are not in any net. This makes it easy for you to bring non-net circuits into your
        design. You can bring in these non-net circuits either from the Clipboard, a PCB block file, or by
        using the PCB Editor's drag/copy feature. Then, at a later time, you can convert these non-net
        circuits into net circuits with unique net names.
        When you choose this command, the Reconnect Nets dialog appears.




        This command is like the Reconnect Copper option within the Load Netlist command, except that it
        uses the current design netlist information instead of an external netlist file.
        Point-to-point routing is not required. Routes that are physically connected but not point-to-point
        routed are indicated by a connection (blue-line).
        When a copper tie with a TieNet value is encountered, connectivity is halted. This keeps the
        polygon from being assigned to a net and the nets from being merged. Any nets without a TieNet
        attribute value that touch a copper tie will be merged or shorted.
        Shorted nets are indicated in the log file with a warning. These nets are not merged.

    Check for Copper Sharing
        If the Check for Copper Sharing option is enabled, line to line trace intersections and line traces
        crossing the center of a pad or via are detected. Intersecting line traces are split at the point of
        intersection and lines are split at pad or via centers, creating point-to-point routes.

    Jumper Pads
        Components behave as if all of the pads marked as being jumpered together are connected. In
        PCB, if necessary, blue line connections may be added to the other pads.

    Create Nets From Free Copper
        To create system-generated nets, follow these steps:
        1.   Choose Utils » Reconnect Nets. The Utils Reconnect Nets dialog appears.
        2.   Click Create Nets From Free Copper. This instructs P-CAD PCB to create a unique, system-
             generated net for each free circuit found in the design. This process essentially turns a free
             circuit into a net circuit.




P-CAD PCB User’s Guide                                                                                         531
Chapter 19: Utils Commands                                                                  Utils Trace Clean-up


            A free circuit consists of two or more component pads connected with lines, arcs, polygons,
            vias, and pads to form a circuit with no net intelligence. A “net circuit” is similar to a free circuit
            except that it has net intelligence. Each free circuit must have at least two free component
            pads.
       3.   Click Yes to reconnect free circuits or No to abort.


Utils Trace Clean-up
       Choose the Utils » Trace Clean-up command to go through the nodes of each net contained in the
       design and remove all redundant trace segments (collinear and overlapping) and any extra vertices.
       When you choose this command, a dialog appears warning the your that this operation is
       undoable. Click Yes to begin the trace cleanup process.


Utils Shortcut Directory
       When you installed P-CAD PCB, a sub-directory called Shortcut was created in the P-CAD directory.
       The Shortcut contains a list of web addresses for semiconductor manufacturers.
       Choose the Utils » Shortcut Directory command to open the Shortcut in Windows Explorer. Select
       the desired address and, from the right mouse menu, choose the Open command.
       Shortcuts to any web site can be added to the Shortcut.


Utils P-CAD Schematic
       If P-CAD Schematic is installed on your computer, choose this command to start P-CAD Schematic.
       If P-CAD Schematic is not running, it is launched. If Schematic is already running, it becomes the
       active program. See for how to start Schematic if it is installed in a different directory than PCB.


Utils P-CAD Library Executive
       Choose this command to start P-CAD Library Executive, if P-CAD Library Executive is installed on
       your computer. Refer to your Library Executive User’s Guide for additional information.


Utils P-CAD Pattern Editor
       Choose this command to start P-CAD Pattern Editor, if P-CAD Pattern Editor is installed on your
       computer. Refer to your Library Executive User’s Guide for additional information.


Utils P-CAD Symbol Editor
       Choose this command to start P-CAD Symbol Editor, if P-CAD Symbol Editor is installed on your
       computer. Refer to your Library Executive User’s Guide for additional information.




532                                                                                    P-CAD PCB User’s Guide
Utils P-CAD InterPlace/PCS                                                     Chapter 19: Utils Commands



Utils P-CAD InterPlace/PCS
        The Utils » P-CAD InterPlace/PCS command provides access to both P-CAD Parametric Constraint
        Solver and P-CAD InterPlace. Refer to your InterPlace/PCS User’s Guide for additional information.


Utils P-CAD Signal Integrity
        Choose this command to launch the P-CAD Signal Integrity Analyzer. The Signal Integrity Analyzer
        allows you to check the board for noise effects like ringing and crosstalk, as well as calculate the
        impedances of the nets.
        The Signal Integrity Analyzer is based on a Fast Reflection and Crosstalk Simulator which produces
        very accurate simulations, using industry-proven algorithms. The P-CAD Signal Integrity simulator
        uses the characteristic impedance of the traces calculated through a transmission line calculator
        and I/O buffer macro-model information as input for the simulations. Where model information is
        not available the system utilizes fallback models.

    Running a Signal Integrity Analysis
        When you select the Utils » P-CAD Signal Integrity command the P-CAD Signal Integrity window
        opens. This window is your interface to the various features available in the Signal Integrity
        Analyzer. This window is shown below.




P-CAD PCB User’s Guide                                                                                    533
Chapter 19: Utils Commands                                                       Utils P-CAD Signal Integrity


       Getting the Nets
       When the Signal Integrity window first opens it will be blank, because there are no nets loaded. To
       load the nets select File » Get Nets from the menus.


             Selecting the Nets to Analyze
       The entire set of nets on the board are listed in the All Nets frame on the left. To perform any
       analysis you must select the net (or nets) you are interested in, then choose Edit » Take Over (or
       click the Takeover Over Selected Nets button).
       Generally, you will be doing one of 2 things when you take over nets – take over all nets to perform
       a net screening, or take over one or 2 nets to perform a reflection or crosstalk analysis. You can use
       the standard Windows selection strategies to select the nets: click and drag a window to select a
       block of nets, use the Shift+left click to select multiple nets, or Ctrl+left click to select individual
       nets.


            Performing a Net Screening
       The net screening feature is used to do a quick analysis of the chosen nets. It displays the results in
       a spreadsheet-like window, which can then be sorted to identify problem nets. After taking over
       the required nets, choose Simulation » Screening from the menus (or click the Net Screening
       button on the main toolbar). The P-CAD Signal Integrity Screening window will appear.




534                                                                                 P-CAD PCB User’s Guide
Utils P-CAD Signal Integrity                                                     Chapter 19: Utils Commands


        Changing the Displayed Information
        By default the screening window will open to display all possible information, each in a separate
        column in the table. There are 4 type of information that the screening window can display, these
        are:
        •    Net Data – this includes net length, number of components and number of traces.
        •    Impedance – this includes the average impedance, maximum impedance and minimum
             impedance.
        •    Voltage – this includes the voltage top value, maximum overshoot (rising edge), maximum
             undershoot (rising edge), base value, maximum overshoot (falling edge) and maximum
             undershoot (falling edge).
        •    Timing – this includes the flight time and slope for the rising edge, and the flight time and
             slope for the falling edge.
        You can selectively hide and display information in the View menu, or by clicking the appropriate
        view button on the main toolbar.

        Sorting the Displayed Information
        As well as filtering the screening results to only display the information that you are interested in,
        you can also sort the entire table to order the results from smallest to largest, or from largest to
        smallest.
        In the previous figure only the Voltage information is displayed. This has then been sorted to
        display the largest value for Maximum Overshoot on the rising edge. To do this you click the title of
        the Max. Overshoot (Rising Edge) column                         . You will notice that the amount
        of overshoot on DX7 is 1.07. The next step would be to examine this net in more detail by
        performing a reflection analysis.


              Performing a Reflection Analysis
        A reflection analysis is performed from the main P-CAD Signal Integrity window. It is important to
        note that you should not attempt to perform a reflection analysis on all nets, this would take a long
        time, and would result in a waveform window so many waveforms that you would not be able to
        analyze the results. To perform a reflection analysis:

        1.   First take over     the net that you are interested in.

        2.   Select Simulation » Reflection from the menus, or click the Reflection Simulation button        .
        3.   The P-CAD WaveAnalyzer window will appear, displaying the reflection analysis results. An
             example is shown below. Use the measurement options in the Analyze menu to give more
             accurate information about the waveforms.




P-CAD PCB User’s Guide                                                                                       535
Chapter 19: Utils Commands                                                      Utils P-CAD Signal Integrity




             Exploring Termination Options
       The P-CAD Signal Integrity Analyzer is an excellent tool in helping you ensure that your board is
       not going to have signal integrity issues when it is built. As the designer you will have to decide
       how to resolve problem nets, perhaps changing the device family, modifying the component
       layout, or adding termination to critical nets.
       The P-CAD Signal Integrity Analyzer includes a Termination Advisor, which you can use to explore
       different what-if scenarios with different termination options. There are 2 approaches to
       termination, adding termination to the output pin on the net, or terminating the last input on the
       net.
       To explore the termination options:

       1.   First take over    the net that you are interested in.
       2.   Select the pin on the net that you want to apply the termination to, for this example we have
            selected the output pin.
       3.   Select Simulation » Termination to display the Termination Advisor dialog. As we are adding
            termination to an output pin the appropriate termination method is Serial R (all other
            termination methods are for input pins).
       4.   Click OK to add the theoretical termination to the net.
       5.   Rerun the Reflection Analysis and examine the results.




536                                                                                P-CAD PCB User’s Guide
Utils P-CAD AutoRFQ                                                         Chapter 19: Utils Commands



Utils P-CAD AutoRFQ
       The WebQuote, or AutoRFQ feature allows you to request a quotation to fabricate or assemble
       your board from within the P-CAD PCB Editor. This feature extracts relevant PCB data, passes it to
       the Request For Quotation application (AutoRFQ), which then interfaces to the WebQuote web site
       (http://www.webquote.com) to configure and request for a quotation on the PCB.
       The WebQuote site is a portal to PCB fabricators all over the world. From this site you can select
       which manufacturers you wish to participate in the quoting process, and also choose if you wish to
       use an open bidding process, where each fabricator is notified of the other fabricators' quotes
       (allowing them to requote), or a closed bidding process, where they are not notified.
       When you choose the Utils » P-CAD AutoRFQ command an RFQ file is created and loaded into the
       AutoRFQ program. Once the RFQ file is loaded in the AutoRFQ program it is displayed as an RFQ
       for PCB Fabrication window. This file details the necessary design specifications that have been
       extracted from your PCB.
       From the AutoRFQ application you can then set up a new request for quotation by clicking the New
       RFQ button that appears at the top of the RFQ for PCB Fabrication window. The first time you
       attempt to do this you will be prompted to create an account, once this is done the job can be
       configured, ready for a quotation.
       When you click the New RFQ button the data in the RFQ file is passed to the PCB MarketPlace web
       site, and another window appears. Work your way down this window, clicking the Modify or Enter
       buttons and completing the information required on each page that appears. Once your RFQ has
       been successfully submitted you will receive a confirmation email, then when the quotes from the
       manufacturers are received you will be emailed these as well.


Utils Customize
       Choose the Utils » Customize command to set up a quick and easy way to access other programs
       from P-CAD PCB. This quick and easy access is accomplished by adding items to the Custom Tools
       toolbar and the Utils menu.
       When you select Utils » Customize the following dialog appears:




P-CAD PCB User’s Guide                                                                                537
Chapter 19: Utils Commands                                                                 Utils Customize




       The Utils Customize dialog is used to add new tools or delete and modify existing tools on the
       Custom Tools toolbar and Utils menu. The fields on the dialog are as follows:
       •   Custom: Provides a list of the custom tools that currently exist.
       •   Menu Text: Enter the description of the tool being added. The Menu Text field allows up to 40
           characters. The buttons on the toolbar display as many letters as can fit on the button. If the
           name of a tool being added to the custom toolbar is too long to be displayed in its entirety, you
           can change the display by using lower case letters or shortening the name of the new tool.
           You may insert an ampersand (&) anywhere in the text string to designate a menu shortcut key.
           For instance, if the Menu Text entry is &Notepad, the menu shortcut key for the tool is the
           letter N.
           The Utils menu displays the list of custom tools as shown to the left.
       •   Command: Enter the path to the executable file of the new tool. Click the Browse button to
           display a standard File Open dialog where the desired file can be chosen. A warning is issued if
           a non-existent path is entered, but the entry will still be added.
       •   Arguments: Optional entry used to pass information into the targeted program, if desired.
       •   Initial Directory: Sets the initial working directory for the program.
       •   Display: Selects the way the program appears on the screen when initialized. Normal (the
           default) to display the program as a window in the workspace, Minimized to start the program
           and display it as an icon at the bottom of the screen, or Maximized to start the program and
           display it across the full screen.
       •   Prompt for arguments: Check this box to automatically display the Arguments dialog to enter
           input that must be passed to the program at execution time. The entry is saved and recalled the
           next time the program is run.



538                                                                                 P-CAD PCB User’s Guide
Utils Customize                                                              Chapter 19: Utils Commands


        •   Add: Click the Add button to begin adding a new tool. You can add a maximum of 16 tools to
            the Customized Toolbar.
        •   Remove: Select a tool from the custom area and click Remove to delete it from the customized
            toolbar.
        •   Move Up/Move Down: Select a tool from the Custom list and change its position in the list by
            clicking the Move Up or Move Down buttons.
        Once all selections and entries have been made, click OK to apply them.

    Displaying the Custom Toolbar
        The Custom Toolbar is not displayed in the workspace until a custom tool has been added. Once a
        tool has been added, the toolbar automatically appears with the other PCB toolbars.
        You may control the appearance of the Custom Toolbar in the workspace using the View » Custom
        Toolbar command.

    Executing a Custom Tool
        To launch a program added as a Custom Tool, you may choose any of these methods:
        •   Click the desired button on the custom toolbar.
        •   Select the tool from the list at the bottom of the Utils menu.
        While the Utils menu is active select a custom tool by pressing the menu shortcut key assigned to
        it. For instance, select Notepad by pressing the N key.




P-CAD PCB User’s Guide                                                                                  539
                                                                                      CHAPTER 20



                                                        DocTool Commands

Using the DocTool Commands
       With the documentation tools in P-CAD PCB, you can detail the fabrication, assembly, and testing
       of the printed circuit board. Using the commands in the DocTool menu, you can perform the
       following tasks:
       •   Create versatile zoned borders and custom title blocks.
       •   Include drawing and revision notes.
       •   Insert tables that include design data such as: net locations, power and ground net data, as well
           as last used, not used, and spare gate information.
       •   Place annotated sheet connectors.
       •   Track nets between schematic sheets.
       This chapter contains a detailed explanation of each command in the DocTool menu.


DocTool Place Table
       Choose the DocTool » Place Table command in P-CAD PCB to place a table in your design or
       drawing. When you choose this command, the Place Table dialog box opens.
       The basic method of setting up, placing, and modifying a table is summarized in The Basic Place
       Table dialog box. For several of the table types additional options are available when the table is
       selected. These options are detailed in this chapter.
       Once placed in the design, a table can be moved, rotated, flipped, deleted, cut, copied, and pasted,
       but only as a single unit; text inside the table cannot be selected, edited, or removed.
       The design data displayed in a table can be updated if the design changes using the DocTool »
       Update or DocTool » Update All commands.




P-CAD PCB User’s Guide                                                                                       541
Chapter 20: DocTool Commands                                                                 DocTool Place Table


      The Basic Place Table Dialog
         The Place Table dialog is shown in the following figure:




         Click Advanced in the Place Table dialog box to gain access to various drill table options.
         In the Place Table dialog you can specify the following options:
         •   Table Type: Choose the type of table you wish to place.
             If you select the Drill Table, the Advanced button becomes active. If you select a Power, Note,
             or Revision Note table, other additional options appear.
         •   Line Width: The width of the lines surrounding a table cell is specified by the line width. The
             line color is set by the Line option in the Options Display dialog box.
         •   Table Name: Enter the table name. This name appears above the table.
         •   Text Style: Select the text style for the table. Click Text Styles to modify text styles.
         To place a table, click OK to confirm the selections in the dialog box. You are returned to the
         design workspace. Click the location where you would like to place the lower left hand corner of
         the table. To more precisely place the table, click and hold the mouse button to drag a ghosted
         outline of the table borders.

         The table cannot be placed outside the workspace.

      Note and Revision Note Table Options
         When you choose to place a Note or Revision Note table, the Place Table dialog box contains the
         following fields:
         •   Note Numbering frame: Choose Top to Bottom or Bottom to Top to indicate the direction of
             incrementing note numbers.




542                                                                                     P-CAD PCB User’s Guide
DocTool Place Design View                                                  Chapter 20: DocTool Commands



       •   Width of Note Column: Type a value in this text box to specify the column width in number of
           characters. When a note exceeds the column width, the text wraps to the following line.

       Note number or symbols do not appear in a revision notes table. The Note Numbering option
       specifies the order of the placed notes, with or without the numbers displayed.

   Drill Table Advanced Options
       When placing a Drill table in PCB, click the Advanced button to expand the Place Table dialog, as
       shown in the following figure:




       With the advanced options, you can customize your Drill Table as follows:
       •   Hole Dia Units: Choose Inch or mm as the units for the hole diameter column.
       •   Label: Type a name for the column label in this text box.
       •   Width: Type the column width in this text box.
       •   Add: Enter values in the Label and Width text boxes. Then, click Add to add the column to the
           table. Use the scroll bars to scroll to the new column.
       •   Delete: To delete a user-defined column click the column header and then click Delete.
       •   Table Viewer: Displays the drill table with the current specifications. In this view you can select
           a column to make it current by placing the cursor in a column cell. Enter data for the user-
           defined columns directly in the cells of this table viewer.


DocTool Place Design View
       Choose the DocTool » Place Design View command to make an image of a specific region of the
       design and place it in one or more locations in the workspace. The image is dynamically updated
       whenever the original data changes.




P-CAD PCB User’s Guide                                                                                     543
Chapter 20: DocTool Commands                                                     DocTool Place Design View


       The Design View can be moved, scaled, printed and mirrored. You can include specific layers and
       assign title and subtitle information. Items imaged in the Design View are displayed even when
       layers in the original section have been disabled. Title Sheet information included in the Design
       View is not displayed.

       Design views may be placed only on a nonsignal layer.

       The Place Design View dialog box appears as follows:




       In the Place Design View dialog, the following options are available:
       •   Title: The name assigned to the Design View.
       •   Subtitle: The subtitle assigned to the Design View.
       •   Text Style: Select a text style for the Design View from the drop down list or click Text Styles to
           open the Options Text Style dialog box where you can add or modify any non-default style.
       •   Scaling: Enter the scale factor (greater than or equal to zero) for the Design View.
       •   Region Coordinates: The X and Y coordinates for the defined region can be entered in the
           Lower Left and Upper Right boxes or you can click the Define Region button to use the
           interactive definition tool. With this interactive tool, you can draw a bounding outline around
           the target area in the design that automatically enters the X and Y coordinates of that region in
           the Region Coordinates boxes. To exit the interactive tool, right-click and confirm that you
           want to update the coordinates with the newly defined region.




544                                                                                P-CAD PCB User’s Guide
DocTool Place Detail                                                         Chapter 20: DocTool Commands


        •   Layers: Select the layers whose objects are to be included in the Design View. You can select
            individual layers, Set All layers, Clear All layers or Apply a Layer Set by clicking the appropriate
            button.
        •   Mirror Design View: If you want to show a mirror image of the objects in the Design View,
            select the Mirror Design View check box.


DocTool Place Detail
        Choose the DocTool » Place Detail command to place a close-up perspective of the board into your
        PCB design or drawing.
        The board region in the close-up view is imported from a block file or a P-CAD picture file. These
        files can be created using the Edit » Copy to File command.

        Details may be placed only on a nonsignal layer.

        The detail can be moved, deleted, cut, copied, and pasted, but only as a single unit; individual
        objects inside the detail cannot be selected, edited, or removed. A detail may not be rotated or
        flipped.
        A scaling factor can be specified when the detail is placed. This indicates the magnification of the
        detail from its original size. You can also specify a value for the line width when you do not want to
        retain the default value of 10.0 mils.
        To update a detail if the design changes, the block file or P-CAD picture file from which the detail
        was placed must be recreated.
        The Place Detail dialog is shown in the following figure:




        In the Place Detail dialog you can specify the following options:
        •   File: A block file (.blk) or a P-CAD picture (.emf) containing the board region must be
            imported. Click Browse and navigate to the desired block file or P-CAD picture file.

        To place a detail from a block file, that block file must be generated from P-CAD PCB. Also, the file
        cannot contain P-CAD picture, detail, or diagram objects.




P-CAD PCB User’s Guide                                                                                        545
Chapter 20: DocTool Commands                                                            DocTool Place Diagram


       •   Title: The title text is centered beneath the detail.
       •   Subtitle: The subtitle text is centered beneath the title. It is suggested that you include the
           scale factor in the detail’s subtitle.
       •   Text Style: Select the text style for the detail. Click Text Styles to modify text styles.
       •   Scaling: Enter the scaling factor (>0) for the detail. A scaling factor of 1 specifies no size
           change. A scaling factor greater than 1 specifies magnification.
       To place the detail complete the dialog box options. After clicking OK, you are returned to the
       workspace. Use the mouse to drag the detail to its desired location. Release the mouse button to
       place the detail.


DocTool Place Diagram
       Choose the DocTool » Place Diagram command in P-CAD PCB to place a depiction of the layer
       stackup of the board into your PCB design or drawing.

       Diagrams may be placed only on a nonsignal layer.

       The layer stackup diagram displays the configuration of the signal and plane layers in an annotated
       illustration. There are two types of layer stackup diagrams. An example of each layer stackup
       diagram is shown as follows:




       The diagram can be moved, deleted, cut, copied, and pasted, but only as a single unit; individual
       objects inside the diagram cannot be selected, edited, or removed. A diagram may not be rotated
       or flipped.
       The scaling factor, which indicates the magnification of the diagram from its original size, can be
       modified when the diagram is placed. Because the specified scale factor is not applied to the
       diagram’s line widths and text, you must designate a specific line width and/or text font size to
       maintain their relative locations in the diagram.



546                                                                                    P-CAD PCB User’s Guide
DocTool Place Diagram                                                        Chapter 20: DocTool Commands


       The design data displayed in a diagram can be updated if the design changes using the DocTool »
       Update or DocTool » Update All commands.
       The Place Diagram dialog is shown in the following figure:




       In the Place Diagram dialog you can specify the following options:
       •   Diagram Type: Shows the diagram type. The Layer Stackup diagram expands and documents
           each layer in the board.
       •   Title: The title text is centered beneath the diagram.
       •   Subtitle: The subtitle text is centered beneath the title. It is suggested that you include the
           scale factor in the diagram’s subtitle.
       •   Text Style: Select the text style for the diagram. Click Text Styles to modify text styles.
       •   Scale: Enter the scaling factor (>0) for the diagram. A scaling factor of 1 specifies no size
           change from the diagram’s initial placement size. A scaling factor greater than 1 specifies
           magnification.
       •   Line Width: Enter the line width to be used in the layer stackup diagram. The default value is
           10.0 mils.

       Line widths and text are not scaled when the scale factor is changed. To maintain the relative
       location of the lines and text in the diagram you must provide line widths and text fonts sized
       proportionately to the designated scale factor.

       •   Diagram Style: Choose the style of the Layer Stackup diagram: Style #1 or Style #2. An example
           of each style is displayed above.
       To place the diagram, complete the dialog box options. After clicking OK, you are returned to the
       workspace. Use the mouse to drag the diagram to its desired location. Release the mouse button to
       place the diagram.




P-CAD PCB User’s Guide                                                                                       547
Chapter 20: DocTool Commands                                                            DocTool Place Picture



DocTool Place Picture
       Choose the DocTool » Place Picture command in P-CAD PCB to place a P-CAD picture file (.emf) in
       your PCB design or drawing. This picture can be a magnified image of objects in the PCB design, a
       detail.
       P-CAD pictures of the design may be created by choosing the Copy to File command. For details
       about creating a picture of a selected region of your board design, see Edit Copy to File (page 283).
       The Place Picture dialog is used to navigate to the directory containing the picture by following
       these steps:
       1.   Choose P-CAD Picture File (.emf) in the Files of Type box.
       2.   Select the desired picture file and click Open.
       3.   Use the mouse to drag the picture to its desired location.
       4.   Release the mouse button to place the picture.

       P-CAD pictures may be placed only on a nonsignal layer.

       A picture object can be moved, deleted, cut, copied, and pasted, but only as a single unit; individual
       objects inside the picture object cannot be selected, edited, or removed. A picture may not be
       rotated or flipped. Picture objects may be scaled by selecting the object and dragging the handles
       at its vertices or by specifying a scaling factor in the Picture Properties dialog box. For instructions,
       see Edit Properties (page 292).


DocTool Titles
       Choose the DocTool » Titles command to customize a title sheet for your design or drawing.
       The DocTool » Titles command provides direct access to the Titles tab of the Options Layers or
       Options Sheets dialogs. From there you can custom build a title sheet for your design or drawing.
       This title sheet can include any or all of the following elements: title block, border, and zones.


DocTool Notes
       Choose the DocTool » Notes in to define or import notes that you can place in your design or
       drawing.
       The DocTool » Notes command provides direct access to the Notes tab of the File Design Info
       dialog box. From there you can define or import notes that can later be placed in your design.


DocTool Update
       Choose the DocTool » Update command in to recalculate the design data and update the selected
       tables or diagrams embedded in the design.




548                                                                                  P-CAD PCB User’s Guide
DocTool Update All                                                        Chapter 20: DocTool Commands



DocTool Update All
       Choose the DocTool » Update All command to recalculate the design data and update all tables or
       diagrams embedded in the design.


DocTool Mirror On Copy
       Choose the DocTool » Mirror On Copy command to copy selected objects in the opposite
       perspective of the display, as if viewing the design from its underside.
       To turn this feature ON, choose the DocTool » Mirror On Copy command. The feature is ON when
       a check mark appears next to the menu command.
       To turn the feature OFF, choose the DocTool » Mirror On Copy command. The feature is OFF when
       no check mark appears next to the menu command.
       When the feature is on, you can choose the following commands:
       Choose the Edit » Copy command to move a mirror image of the selected objects to the Clipboard.
       Detail, diagram, and picture objects within the selected region are not mirrored.
       Choose the Edit » Copy to File command to copy the mirror image of a P-CAD picture format to a
       file.

       If the block file format is chosen using Edit » Copy to File, the Mirror On Copy option is ignored.

       These picture objects can be placed back in the design using the Edit » Paste Special, Place Detail,
       or Place Picture commands.




P-CAD PCB User’s Guide                                                                                       549
                                                                                     CHAPTER          21


                                                             Macro Commands

Using the Macro Commands
       You use the commands in the Macro menu to setup, record, modify, and run macros. A macro is a
       shortcut for a sequence of actions. After you record a macro, you can assign a keyboard shortcut to
       a macro. Then, you can press the keyboard shortcut to playback the series of actions associated
       with the macro.


Macro Setup
       Before you record a macro, choose Macro » Setup to specify the directory in which you want to
       store the macros you record. If you do not specify a directory, your macros are stored in the P-CAD
       directory by default.
       When you choose Macro » Setup, the Macro Set Up dialog appears. Use the controls in this dialog
       to set up your directory options and to change the playback speed for your macros.

   Setting Up a Macro
       To set up a macro, do the following:
       1.   Choose Macro » Setup. The Macro Set Up dialog appears.




       2.   Click Browse. The Open dialog appears.
       3.   Select the directory that you want to use as your default macro directory. Then, click Open.
            You return to the Macro Set Up dialog.




P-CAD PCB User’s Guide                                                                                     551
Chapter 21: Macro Commands                                                                   Macro Record


        4.   Type a value in the Playback Delay (seconds) box to control the playback speed for each action
             in a macro. You can set the interval to the thousandths (.001 of a second.
        5.   Click OK to save your settings.


Macro Record
        Choose Macro » Record to name and record a macro. When you choose Macro » Record, the
        Macro Recorder dialog appears. Use this dialog to assign a name to the macro you are about to
        record. For instructions on using this dialog, see Macro Recording Tool (page 552).
        After you name your macro, click OK in the Macro Recorder dialog. P-CAD PCB begins recording
        your actions and the Macro Recording Tool appears. For details on this tool, see Macro Recording
        Tool (page 552).

      Macro Recording Tool
        The Macro Recording Tool contains various buttons that give you the ability to control the
        recording process:




        The buttons in the Macro Recording Tool perform the following functions:


             Click this button                           To perform this function:
                                 Stop Recording: Click this button to stop the recording process and
                                 save the recorded events in the designated macro file. To stop
                                 recording, you can also press M or click M button on the status bar.
                                 Pause Recording: Click this button to pause the recording process.
                                 When you pause a recording this button changes to the Resume
                                 Recording button.
                                 Recording Suspend: Click this button to suspend the recording process.
                                 This creates a pause during playback. You can also suspend recording
                                 by pressing the Pause/Break key.
                                 Resume Recording: When you pause the recording process, this button
                                 appears in place of the Pause Recording button. It also appears during
                                 playback whenever the playback reaches a recorded suspend activity.
                                 Recording Origin: Click this button to place an origin in the macro.
                                 When a recorded origin is encountered, you can click the left mouse
                                 button in the workspace to set a relative playback location during
                                 playback.




552                                                                               P-CAD PCB User’s Guide
Macro Record                                                               Chapter 21: Macro Commands



            Click this button                          To perform this function:
                                Cancel Recording: Click this button to cancel the recording process.
                                Recorded information is not saved when you click this button.


   Recording a Macro
       To record a macro, do the following:
       1.   Choose Macro » Record. The following Macro Recorder dialog appears.




       2.   Type a name for the macro in the Macro Name box.
       3.   Click OK. The following Macro Recording Tool appears. For details on the options associated
            with this tool, see Macro Recording Tool (page 552).




       4.   Perform any actions that you want to record.
       5.   Click the Stop button in the Macro Recording Tool.
       P-CAD PCB saves the macro in the directory you specified in the Macro Set Up dialog. Your macro
       is given the .mac file name extension by default.
       After you record a macro, you can assign a keyboard shortcut to a macro. Then, you can press the
       keyboard shortcut to playback the series of actions associated with the macro. Or, you can add the
       macro to the Utils menu.
       •    To assign a keyboard shortcut to a macro, choose Options » Preferences. For instructions, see
            Options Preferences (page 448).
       •    To add a command for the macro in the Utils menu, choose Utils » Customize. For instructions,
            see Utils Customize (page 537).

       A macro command that moves or deletes a component has no effect on a fixed component.

   Recording a Temporary Macro
       A temporary macro is a macro that is stored in your computer’s memory and named
       Pcb_default.mac by default. To playback a temporary macro, you press the E key. Only one
       temporary macro is available; each time you record a temporary macro, it overwrites the previous
       one.



P-CAD PCB User’s Guide                                                                                 553
Chapter 21: Macro Commands                                                                     Macro Delete


       To record a temporary macro, do the following:
       1.   Click the M button on the Status Line or press M to begin recording. The button has a red
            background while the recording process is ON.
       2.   Complete the actions that you want to record. The entire group of macro functions is available
            to a temporary macro, including pause and suspend.
       3.   To stop recording, click the M button on the Status Line or press M. The button has a white
            background when the recording process is OFF.
       To playback the temporary macro, press E. The actions you record will repeat each time you press E.
       If you want to record a macro, but don’t want to save it as the temporary macro, choose the Macro
       » Record command. You can rename a macro or temporary macro by choosing the Macro »
       Rename command.


Macro Delete
       Choose Macro » Delete to delete a macro. When you choose this command, the following Macro
       Delete dialog appears.




       To delete a macro, select the macro to delete from the Macro Name list and click Delete. The
       Macro Name list displays all of the *.mac files that are saved in your default macro directory.


Macro Rename
       Choose Macro » Rename to change the name of a macro. You can rename any macro, including the
       temporary macro named Pcb_default.mac. However, if you rename Pcb_default.mac, it is no
       longer the temporary macro.
       When you choose this command, the following Macro Rename dialog appears.




554                                                                               P-CAD PCB User’s Guide
Macro Run                                                                    Chapter 21: Macro Commands


       Select the file to rename from the Old Macro Name list. The combo box lists all the *.mac files
       found in the default macro directory set in the Macro Setup dialog. Enter a new name in the New
       Macro Name box. Then, click Rename and click Close.


Macro Run
       Choose Macro » Run to playback a named macro. When you choose this command, the following
       dialog appears.




       To run the macro, enter the macro name by typing it in or selecting it from the combo box. The
       combo box lists all the *.mac files found in the default macro directory set in the Macro Setup
       dialog. Click OK. The M button on the Status Line is green when a macro is running.
       To playback the temporary macro, press E. To record a temporary macro, press M, complete a
       series of actions, and press M again to stop recording.
       After you record a macro, you can assign a keyboard shortcut to a macro. Then, you can press the
       keyboard shortcut to playback the series of actions associated with the macro. Or, you can add the
       macro to the Utils menu.
       •    To assign a keyboard shortcut to a macro, choose Options » Preferences. For instructions, see
            Options Preferences (page 448).
       •    To add a command for the macro in the Utils menu, choose Utils » Customize. For instructions,
            see Utils Customize (page 537).


Recording Efficient Macros
       The macro recording process records every keystroke and mouse click you make in the workspace.
       As a result, you may find it more efficient to use the menu and keyboard shortcuts when recording
       a macro. To help you record efficient macros, the following list provides some helpful hints that
       you can use during the recording process:
       •    If you click a toolbar button during the recording process, the toolbar must be in the exact
            same location during playback. To minimize possible playback issues, use the keyboard
            shortcuts instead of the toolbar buttons.
       •    Choose menu commands instead of shortcut menu commands. For example, choose Edit »
            Properties instead of right-clicking an object and choosing Properties from the shortcut menu.
            The position of the shortcut menu changes based on mouse location.




P-CAD PCB User’s Guide                                                                                     555
Chapter 21: Macro Commands                                                             Other Macro Features


         •   When a dialog prompts you for a response during the recording process, insert a suspend
             command by clicking the Pause/Break button in the Macro Recording Tool. This gives you the
             ability to interact with various dialogs during the playback process.
         •   There are times when you may select an item from a drop down list during event recording. If
             the order of the items in the list is subject to change due to additions or deletions, the most
             effective way to eliminate choosing the wrong item is to type the desired value in the box
             instead of selecting from the list. Then you are assured that the correct item is incorporated
             into the event.
         •   Whenever options on the Status Line are recorded, such as changing a layer, make sure that
             the Status Line view is enabled when running the macro. If the Status Line is not visible during
             macro playback, the location of the recorded command cannot be identified nor executed.
         •   When working with text it is best to make changes using keys such as DELETE, BACKSPACE,
             etc.
         •   Retain the same size workspace and focus during playback as you used when recording.
             Changing the workspace size or zoom factor causes adjustments in location coordinates. For
             instance, if you place a component in the outer regions of a design and change the zoom so
             that those coordinates are no longer visible in the workspace, the component cannot be
             placed during playback.
         •   The resolution of the system in which you are running a recorded macro should match the
             resolution of the system in which the macro was recorded.


Other Macro Features
         The macro tool features extend beyond the record and play functions. This section describes these
         additional features.

      Running a Macro
         You can start P-CAD PCB and a macro from the command line by entering the correct system path
         to the executable and then the macro file name.
         <full path>.PCB.exe /e
         <full path><macro name>
         If PCB is already running, this command plays back the macro in the current PCB session. If PCB is
         not currently running, the program starts and the macro opens.

      Status Line Recording Indicators
         When the Status Line is visible, the background of the Macro toggle button (M) changes color to
         indicate the type of activity being performed.
         •   Red indicates the recording process is active.
         •   Green indicates the playback process is active.



556                                                                                 P-CAD PCB User’s Guide
Macro File Syntax                                                            Chapter 21: Macro Commands


        •   Yellow indicates a pause in the recording, or shows that a suspend or origin command has
            been encountered during playback.

    Automatic Delays
        Whenever you open a Print Setup, Font, or Custom Color dialog during the recording process, P-
        CAD PCB automatically inserts a delay. This allows the dialog time to appear in the workspace. If
        the delay interval is not large enough for the playback to accommodate the next event, you can
        increase the delay interval by editing the *.mac file or by editing the Pcb.ini file and changing
        the MacroCommonDialogDelay value to a larger number.

    Editing Macro Files
        You can use a text editor, such as the Notepad, to create or edit macro files. For example, you may
        want to modify a file to add or change delays, start other applications, etc.
        However, you should be familiar with the proper syntax before you modify a macro file.


Macro File Syntax
        Before you modify a macro file with a text editor, such as the Notepad, you should be familiar with
        the syntax used to record the events in the macro file. Syntax is very important in the macro files.
        Each macro command is case sensitive and each line must contain a carriage return.
        A sample macro, opened in a text editor, is shown in the following figure:




        In a macro file, there are several event types: Mouse Events, Keyboard Events, Special Events, and
        Edit Events. Each event type has its own keywords and syntax. In the following sections, syntax
        descriptions show a comma to separate the parts of the format for readability. The commas are not
        to be inserted into the actual format of the command. An example of an actual syntax is provided as
        well.



P-CAD PCB User’s Guide                                                                                      557
Chapter 21: Macro Commands                                                                      Macro File Syntax


      Mouse Events
        Mouse events occur when the cursor is positioned over the workspace or another part of the P-
        CAD PCB window (e.g., over a menu, toolbar, dialog, etc.). Events that occur when the cursor is
        over the workspace are recorded as appunit locations. Events occurring when the cursor is over a
        menu, toolbar, etc., are recorded in pixels.
        •         Syntax: Keyword, white space, positive integer, white space, unit string, white space, positive
                  integer, white space, unit string.
                       LeftMouseDown 21 appunits 150 appunits
                       LeftMouseUp 18 pixels 583 pixels
                       LeftMouseDown&KeyStroke 179 appunits 50 appunits Shift
        •         Keywords: LeftMouseDown, LeftMouseUp, LeftMouseDoubleClick, RightMouseDown and
                  RightMouseUp, LeftMouseDown&KeyStroke appunits or pixels Ctrl,
                  LeftMouseDown&KeyStroke appunits or pixels Shift, LeftMouseDown&KeyStroke appunits or
                  pixels Alt.
        •         Unit Strings: A unit string in a mouse event is either pixels or appunits. In the example above,
                  20 and 150 are the X and Y coordinates of the left mouse down action, and pixels indicates that
                  the mouse click was made on a toolbar or within a dialog command. If the unit string contains
                  appunits, then the mouse click was made in the workspace at the indicated X and Y
                  coordinates.

      Keyboard Events
        •         Syntax: Keyword, white space, quoted character string.
                       SendKeys “{Shift+N}{E}{W}”
        •         Keywords: SendKeys
        •         Character Strings: Each key stroke, and combinations thereof, must be enclosed in curly
                  brackets and the string of curly bracketed strokes enclosed in quotations. In the example
                  above, the word New is recorded using the keyboard syntax format.
        •         Keyboard Codes: The following list defines the recordable keys and how they are represented
                  in the macro file.


                        Keys                        Codes
            a -z                        A-Z
            A -Z                        Shift+A - Shift+Z
            0-9                         0-9
            F1 - F12                    F1 - F12
            Alt                         Alt
            Back Space                  Backspace



558                                                                                      P-CAD PCB User’s Guide
Macro File Syntax                              Chapter 21: Macro Commands



                    Keys               Codes
        Ctrl               Ctrl
        Delete             Delete
        End                End
        Escape             Esc
        Home               Home
        Insert             Insert
        Num Lock           Not recordable
        Page Down          PageDown
        Page Up            PageUp
        Pause Break        Not recordable
        Print Screen       Not recordable
        Scroll Lock        Not recordable
        Space              Space
        Tab                Tab
        Down Arrow         Down
        Left Arrow         Left
        Right Arrow        Right
        Up Arrow           Up
        Numpad 0           Numpad0
        Numpad 1           Numpad1
        Numpad 2           Numpad2
        Numpad 3           Numpad3
        Numpad 4           Numpad4
        Numpad 5           Numpad5
        Numpad 6           Numpad6
        Numpad 7           Numpad7
        Numpad 8           Numpad8
        Numpad 9           Numpad9
        Numpad /           NumpadDivide
        Numpad -           NumpadMinus
        Numpad *           NumpadMultiply
        Numpad +           NumpadPlus
        Numpad Clear       Clear
        ‘                  Backquote



P-CAD PCB User’s Guide                                                559
Chapter 21: Macro Commands                               Macro File Syntax



               Keys                        Codes
        -                    Minus
        =                    Equal
        \                    Backslash
        ;                    Semicolon
        ‘                    Singlequote
        /                    Slash
        .                    Period
        ,                    Comma
        [                    LeftBracket
        ]                    RightBracket
        ~                    Shift+Backquote
        !                    Shift+1
        @                    Shift+2
        #                    Shift+3
        $                    Shift+4
        %                    Shift+5
        ^                    Shift+6
        &                    Shift+7
        *                    Shift+8
        (                    Shift+9
        )                    Shift+0
        _                    Shift+Minus
        +                    Shift+Equal
        |                    Shift+Backslash
        {                    Shift+RightBracket
        }                    Shift+LeftBracket
        “                    Shift+Singlequote
        :                    Shift+Semicolon
        ?                    Shift+Slash
        >                    Shift+Period
        <                    Shift+Comma
        Special Windows      Not recordable
        Keys




560                                                P-CAD PCB User’s Guide
Macro File Syntax                                                            Chapter 21: Macro Commands


    Special Events
        •   Syntax: Keyword.
                Origin
                Suspend
                Delay 1.001
        •   Keywords: Origin, Suspend and Delay.
        •   Exception: The Delay keyword is generated by the macro utility whenever a print setup, font or
            custom color dialog is invoked in the macro. Inserting a one-time delay interval pauses the
            playback so that there is time to set up the next recorded event. The Delay keyword is followed
            by a positive floating number. This delay time is added to the global playback interval set using
            the Macro » Setup command.

    Edit Events
        •   Syntax: Keyword, qualifier.
                Wait 4
                ExecuteCommand “C:\P-AD\PATED.EXE”
        •   Keywords: Wait, ExecuteCommand.
        •   Qualifier: Each keyword has its own type of qualifier. The Wait keyword is followed by a
            positive number indicating the pause interval in seconds. During playback the wait interval is
            counted down in the status bar and the playback resumes when the interval is complete.
        The ExecuteCommand launches another application and requires the application name enclosed in
        quotes. It may also require the path to the application name or file.

    File Syntax
        •   Beginning: The first line of the macro file begins with the keyword PcbMacro, followed by the
            name of the macro and a comment string. The comment string, which can also be added to any
            line in the macro, must begin with a single quote.
        •   Ending: Every macro must end with the keyword End.
        •   Other: Every line must begin with one of the keywords. Although optional, a tab at the end of
            each line helps increase a macro’s readability when it is edited.




P-CAD PCB User’s Guide                                                                                    561
                                                                                    CHAPTER          22


                                                       Window Commands

Using the Window Commands
       Use the commands in the Windows menu to arrange and manage open windows.
       In P-CAD PCB, you can open multiple design files at the same time. You can also open multiple
       views of a single design.
       The window you are working in is the active window; the design you are working with is the active
       design. The work that you perform is entered in the active design, and the commands that you use,
       for the most part, affect only the active design.


Window New Window
       Choose Window New Window to open a new window that contains an alternate view of the active
       design. You can move independently in each window, making it easy to compare different parts of
       the same design.
       A number identifying the window is added to the file name in the title bar and at the bottom of the
       Window menu. For example, C:\PCAD\TUTORIAL\CHAP9.PCB:2.


Window Cascade
       Choose Window Cascade to arrange all open windows so that the title bar of each open window is
       visible. All windows overlap, starting in the upper-left corner of your workspace. You can see each
       window's title, making it easy to switch between windows.
       As a shortcut for choosing this command, you can press SHIFT+F5.


Window Tile
       Choose Window Tile to arrange all open windows so each open window is visible. Windows are
       resized and arranged side-by-side so that all windows are visible and none overlap.



P-CAD PCB User’s Guide                                                                                  563
Chapter 22: Window Commands                                                       Window Arrange Icons


       As a shortcut for choosing this command, you can press SHIFT+F4.


Window Arrange Icons
       Choose Window Arrange Icons to arrange design file icons in the P-CAD PCB window.
       Design files can be minimized into icons using the Control menu or by clicking the down arrow in
       the upper-left corner of the screen. This command arranges these icons so that they are evenly
       spaced and don't overlap.
       You can open one of these design icons by double clicking it or choosing Restore from the icons
       Control menu.


Selecting a Window
       The bottom of the Window menu lists all open windows. To make a window active select it from
       this list. Designs appear on the Windows menu in the order that you opened them.
       If there are more than nine windows opened, a More Windows... command appears. Choose this
       command to view additional windows.
       To close a window, double click the control button in the upper-left corner of the window. Closing
       the last window automatically opens a new, untitled window.




564                                                                             P-CAD PCB User’s Guide
                                                                                  CHAPTER          23


                                                               Help Commands

Help P-CAD PCB Help Topics
       Choose Help P-CAD PCB Help Topics to open the P-CAD PCB Help file. The Contents tab is
       structured to match the order of commands as they appear in the product and the Index tab, gives
       you the ability to look up a specific concept, definition, or keyword.


How to Use Help
       Choose Help How to Use Help to open the Windows Help file. This file contains instructions on
       how to use the help system.


Series II Commands
       Choose Help Series II Commands to open a list that shows the mapping relationship between P-
       CAD PCB (6/400) Series II commands and P-CAD PCB commands and features.


About P-CAD PCB
       Choose Help About P-CAD PCB to open a dialog that contains information such as the product
       version number, release date, memory used, memory available, and license number.




P-CAD PCB User’s Guide                                                                                 565
                                                                                      APPENDIX           A


                                                        Keyboard Reference

         This appendix summarizes the commands and functions that you can gain access to using P-CAD
         shortcut keys and standard Windows accelerators.
         Standard Windows key combinations are functional for all of the menu commands; use the normal
         combination ALT, X, Y, where x equals the underlined menu character, and y equals the underlined
         command character.
         You can use the Options Preference dialog to change shortcut keys for commands and macros.


Keyboard Shortcuts in P-CAD PCB

ALT+F4                        A shortcut for choosing File » Exit, which quits the P-CAD program. If
(File Exit)                   the current design has been modified since the last save, you will be
                              prompted (YES or NO) as to whether you want to save the changes to
                              the file. The program writes this information to the PCB.ini file.
ALT+ Mouse Click              For any click-and-drag or drag-and-drop operations, you can hold down
                              the ALT key, click the left mouse button, then move or drag the object
                              wherever you want without having to keep the mouse button
                              depressed. Without the ALT key, you would typically have to click and
                              drag with the button depressed while you are dragging.
arrow keys                    The arrow keys move the cursor to the next grid point. Press
                              CTRL+arrow to move the cursor 10 grid points.
CTRL+C                        A shortcut for choosing Edit » Copy. Copies objects from your design to
(Edit Copy)                   the clipboard.
CTRL+Mouse Click              You can copy-and-drag an object by first selecting the object, holding
(drag and drop copy)          down CTRL and clicking the left mouse button in the selected object
                              region, and dragging a copy of the object to a location and releasing to
                              paste it.




P-CAD PCB User’s Guide                                                                                   567
Appendix A: Keyboard Reference                                       Keyboard Shortcuts in P-CAD PCB



CTRL+N                    A shortcut for choosing File » New. This command opens a window
(File New)                containing a new, untitled window.
CTRL+O                    A shortcut for choosing File » Open, which opens the Open dialog box.
(File Open)               Use the controls in this dialog to navigate to the file that you want to
                          open.
CTRL+P                    A shortcut for choosing File » Print.
(File Print)
CTRL+S                    Saves changes to the current design without closing it. To save the
(File Save)               design to a different file, choose the File » Save As command. To clear
                          the workspace, choose File » New.
CTRL+V                    A shortcut for choosing Edit » Paste. You can paste objects from the
(Edit Paste)              clipboard to the your design.
CTRL+X                    A shortcut for choosing Edit » Cut. Cuts objects from the design to the
(Edit Cut)                clipboard.
CTRL+Z                    A shortcut for choosing Edit Undo. If you have not completed your
(Edit Undo)               action (e.g., you are in Place Line mode and have not finished a series of
                          segments), Undo will not reverse the action. Press the BACKSPACE key
                          to unwind the unfinished actions when you are in a placement mode.
CTRL+F4                   Closes the active window.
CTRL+F6 or CTRL+TAB       Switches focus to the next window. Press CTRL+SHIFT+F6 or
                          (CTRL+SHIFT+TAB) to switch focus to the previous window.
SHIFT+T                   A shortcut for choosing Edit » Move to Layer.
(Move to Layer)
SHIFT+F4                  A shortcut for choosing Windows Tile. Windows are resized and
(Window Tile)             arranged side-by-side so that all windows are visible and none overlap.
SHIFT+F5                  A shortcut for choosing Windows Cascade. All windows overlap, start-
(Window Cascade)          ing in the upper-left corner of your Workspace. You can see each win-
                          dow's title, so you can click a title bar to switch between windows.
DEL                       Deletes all selected objects
(Delete)
F1                        The F1 key displays context-sensitive help. If you put focus on a com-
(Help)                    mand or dialog (by mouse or keyboard) and press F1, the Help window
                          appears containing information specific to the focus item.
PAGE DOWN                 Scrolls down by one page in the workspace. Press CTRL+PAGE DOWN
                          to scroll one page to the right.
PAGE UP                   Scrolls up by one page in the workspace. Press CTRL+PAGE UP to scroll
                          one page to the left.



568                                                                            P-CAD PCB User’s Guide
Keyboard Shortcuts in P-CAD PCB                                        Appendix A: Keyboard Reference



SPACEBAR                  To simulate a click and release of the mouse button, you need to press
                          the SPACEBAR twice. To simulate pressing and holding down the left
                          mouse button, you press the SPACEBAR once.
BACKSPACE *               Used as unwind command while placing objects with multiple
(Unwind)                  segments (e.g., lines, polygons, route manual). Each backspace * stroke
                          unwinds the previously placed item.
ESC                       Terminates placement of objects with multiple segments; it also cancels
(Escape)                  a redraw in progress. It is often equivalent to right-clicking. ESC also
                          exits from dialogs (equaling the Close or Cancel button), which is a
                          Windows feature.
PLUS Key                  Press the plus (+) key on either the keyboard or keypad to zoom in at
(Zoom In)                 the cursor location. This is a shortcut for choosing View » Zoom In.
                          When you press the plus (+) key, the zoom cursor does not appear. The
                          zoom cursor only appears when you choose a zoom command from
                          the View menu.
MINUS Key                 Press the minus (-) key on either the keyboard or keypad to zoom out
(Zoom Out)                from the cursor location. This is a shortcut for choosing View » Zoom
                          Out. When you press the minus (-) key, the zoom cursor does not
                          appear. The zoom cursor only appears when you choose a zoom com-
                          mand from the View menu.
A key                     Switches between absolute and relative grid settings.
(Grid Toggle)
C Key                     A shortcut for choosing View » Center. This command allows you to
(View Center)             center your cursor location. Place the cursor in the area of your design
                          that you want centered and press C. Pressing the C key is an effective
                          way of panning across the workspace.
D Key                     Increments the RefDes if while the Place Component tool is enabled.
(Increment RefDes)        Press SHIFT+D to decrement the RefDes.
F Key                     Flips an object during place and move operations. Not all objects can
(Flip Object)             be flipped.
                          The F key also switches between orthogonal mode pairs.
G Key                     Scrolls forward through the list of grid settings. Press SHIFT+G to scroll
(Grid Select)             back through the list.
J Key                     Places focus on the X coordinate text in the Status Line. From there, you
(Enter Coordinate)        can enter new X and Y coordinates.
L and SHIFT+L             L cycles downward through the board's layer list, duplicating the func-
(Change Layer)            tion of the down arrow on the layer list/combo box on the Status Line.
                          Press SHIFT+L to cycle upward through the layer list.




P-CAD PCB User’s Guide                                                                                 569
Appendix A: Keyboard Reference                                       Keyboard Shortcuts in P-CAD PCB



O and SHIFT+O             O sequences forward through the orthogonal modes during placement
(Orthogonal Mode)         of line objects or manual routing; SHIFT+O sequences backward
                          throughout the modes. The F key switches between orthogonal mode
                          pairs. Orthogonal modes are set in the Options Configure dialog.
Q Key                     Turns draft mode on and off.
(Draft Mode)
R and SHIFT+R             Press R to rotate objects by 90 degrees during Place and Select opera-
(Rotate)                  tions. Press SHIFT+R to rotate objects by your current rotation incre-
                          ment. For more information about rotating objects with place and
                          select operations.
S Key                     A shortcut for choosing Edit » Select (also the toolbar Select button).
(Select)                  When enabled, you are able to click objects to highlight them, then
                          move, rotate, delete, duplicate, and otherwise modify them.
U Key                     A shortcut for choosing Edit » Undo. For the unwind feature, See the
(Undo)                    BACKSPACE key description in this section.
Y Key                     A shortcut for choosing Options » Layers. This key opens the Options
(Options Layers)          Layers dialog.
W Key                     Scrolls forward through the list of line widths established in the design.
(Line Width Scroll)       Press SHIFT+W to scroll back through the list.
X Key                     Switches between the cursor styles: Arrow, Small Cross, and Large
(Cursor Style)            Cross.
Y Key                     A shortcut for choosing Options » Layers. This key opens the Options
(Options Layers)          Layers dialog.
Z Key                     A shortcut for choosing View » Zoom Window. Just press Z and then
(Zoom Window)             draw the zoom window; the cursor takes the shape of a magnifying
                          glass to indicate that you are in zoom mode. Whatever you surround
                          with the zoom window will fill the screen.
Slash Keys (/ or \)       Stops a route in mid-connection without adding a final copper
                          segment. A backward slash functions identically to a forward slash.




570                                                                             P-CAD PCB User’s Guide
                                                                                     APPENDIX          B


                                            P-CAD System Messages

        This appendix documents the messages that you might encounter when importing or exporting a
        PDIF file in P- CAD PCB or Schematic.


Error Messages

          Error Message                          Cause                           Solution
A reference designator is            The reference designator is     Enter the reference designator
required in instance <name>          missing.                        and try again.
near line <line number>.

Attribute <key name> near (x, y)     The system found an             N/A
does not exist in original symbol.   attribute in the normalized
                                     symbol that does not exist in
                                     symbol being translated.
Bad PIN_DEF record #<number>         A syntax error was              Check the PDIF file at the
near line <line number>. Pad         encountered. A PIN_DEF          designated line number to
ignored.                             entry is malformed.             determine the cause. Then
                                                                     consult your PDIF manual to
                                                                     correct the syntax.
Component instance <name>            The net does not exist.         Either create it in Master
(<ref des>) pin <pin des> refer-                                     Designer or reset the pin’s net
ences an unknown net <name>                                          name.
near line <line number>.
Data in this design extends          P-CAD PCB allows a              Either make it smaller or break
beyond 60 square inches. Load        maximum of 60 square            up the design.
aborted.                             inches for a design. This
                                     design is too big.




P-CAD PCB User’s Guide                                                                                 571
Appendix B: P-CAD System Messages                                                            Error Messages



         Error Message                           Cause                            Solution
Device expected on line <line       Each entry in a cross             Add the device name at the
number> of <file name>.             reference file has a device,      specified line number.
                                    but one was not found.
Duplicate pin designator <pin       P-CAD PCB and Schematic           Edit the PDIF file to change the
des> in instance <name> near        do not allow duplicate pin        pin designators.
line <line number>. Pin ignored.    designators. The duplicate
                                    pins will not show up in the
                                    resulting component.
Duplicate reference designator      A duplicate reference             Either change the reference
<reference designator> in           designator was found. P-CAD       designator in Master Designer
instance <name> near line <line     PCB and Schematic do not          or edit the PDIF file and
number>. Instance ignored.          support duplicate reference       change the Rd statement.
                                    designators. This instance
                                    was ignored.
Equal sign expected on line <line   A syntax error was                Enter an equal sign. The
number> of <file name>.             encountered. An entry in a        format is (<pin des> = <net
                                    cross reference file may have     name>,...). The system logs this
                                    the power and ground pins         error if it encounters a pin
                                    listed.                           designator, which is not
                                                                      followed by an equal sign.
File revision number is unrecog-    The PDIF version number           Use a PDIF file from Master
nized.                              was not recognized.               Designer version 6.0 or later.
Gate number expected on line        A syntax error was                Check the PDIF file at the
<line number> of <file name>        encountered. Each entry in a      designated line number to
                                    cross reference file has a gate   determine the cause. Then
                                    number, but one was not           consult your PDIF manual to
                                    found.                            correct the syntax.


Instance <name> referenced an       A syntax error was                Check the PDIF file at the
undefined component                 encountered. An instance          designated line number to
(COMP_DEF=<name>) near line         references the name of a          determine the cause. Then
<line number>.                      COMP_DEF that was not             consult your PDIF manual to
                                    defined prior to the instance.    correct the syntax.
Keyword expected on line <line      A syntax error was                Check the PDIF file at the
number>                             encountered.                      designated line number to
                                                                      determine cause. Then consult
                                                                      your PDIF manual to correct
                                                                      the syntax.




572                                                                                P-CAD PCB User’s Guide
Error Messages                                                         Appendix B: P-CAD System Messages



          Error Message                          Cause                             Solution
Left paren expected on line <line   A syntax error was                 Correct the syntax. The format
number> of <file name>.             encountered.                       is
                                                                       (<pin des> = <net name>,...).
                                                                       The system logs this error if it
                                                                       encounters a net name, which
                                                                       is not followed by a left, paren
                                                                       or comma.
Load failed near line <line num-    A syntax error was                 Check the PDIF file at the
ber>.                               encountered.                       designated line number to
                                                                       determine the cause. Then
                                                                       consult your PDIF manual to
                                                                       correct the syntax.
Net name expected on line <line     A syntax error was                 Correct the syntax. The format
number> of <file name>.             encountered                        is
                                                                       (<pin des> = <net name>,...).
                                                                       The system logs this error if it
                                                                       encounters an equal sign,
                                                                       which is not followed by a net
                                                                       name.
No {Lystr...} section found.        A syntax error was                 Check the PDIF file at the
                                    encountered.                       designated line number to
                                                                       determine cause.

No pad stacks defined near line     PDIF PCBs require an               Edit the PDIF file at the
<line number>.                      attached PAD_STACK record          designated line number to
                                    to load properly into P-CAD        include the name of the
                                    PCB.                               attached pad stack.


Not enough memory                   This means the system could        Close some applications and
                                    not allocate enough memory         try again.
                                    to do its work.

Pad stack <name> has shape          A pad type (Pt) is trying to set   Either change the default
<PDIF object>                       too big a hole. The hole is        pad/via hole sizes in the
(<number>X<number>) that is         assigned either through the        PCB.ini file, or change the
smaller than both the pad hole      tool table file or the pad/via     specified tool table. See
size (<number>) and the via hole    default sizes specified in the     Cleanup Tips in the Using P-
size (<number>) near line <line     PCB.ini file.                      CAD Files chapter.
number>. Hole size set to 0.




P-CAD PCB User’s Guide                                                                                    573
Appendix B: P-CAD System Messages                                                            Error Messages



          Error Message                         Cause                             Solution
Part file name expected on line    Each entry in a cross              Check the PDIF file at the
<line number> of <file name>.      reference file has a part file     designated line number to
                                   name, but one was not              determine the cause.
                                   found.
P-CAD attribute near (x, y) has    This message means that the        N/A
no value.                          system found a Master
                                   Designer attribute that does
                                   not have a value.
PDIF item <PDIF object> is not     Some PDIF objects are not          Remove the object and try
supported in nets.                 supported in P-CAD PCB or          again.
                                   Schematic nets.

Pin <pin des> of part <part num-   A memory or resource limit         N/A
ber> of component <name>           has been reached.
could not be added near line
<line number>.
Pin number expected on line        A syntax error was                 Correct the syntax. The format
<line number> of <file name>.      encountered. An entry in a         is
                                   cross reference file may have      (<pin des> = <net name>,...).
                                   the power and ground pins          The system logs this error if it
                                   listed.                            encounters a equal sign,
                                                                      which is not preceded by a pin
                                                                      number.
Power or ground pin <pin des>      A power pin was found that         Check the PDIF file at the
for component <name> does not      does not have a net name or        designated line number to
have a net name or a pin name.     does not have a pin name.          determine the cause.
Right paren expected on line       An entry in a cross reference      Check the PDIF file at the
<line number> of <file name>.      file may have the power and        designated line number to
                                   ground pins listed. The            determine the cause.
                                   format is (<pin des> = <net
                                   name>,...).
                                   The system logs this error if it
                                   encounters a equal sign
                                   which is not preceded by a
                                   pin number
Symbol file name expected on       A syntax error was                 Check the PDIF file at the
line <line number> of <file        encountered. Each entry in a       designated line number to
name>.                             cross reference file has a         determine the cause.
                                   symbol file name, but one
                                   was not found.




574                                                                                P-CAD PCB User’s Guide
Error Messages                                                            Appendix B: P-CAD System Messages



          Error Message                            Cause                               Solution
Too many power and ground            If a component is                    Edit the cross-reference file
pins for error file.                 heterogeneous, the system            and add any pins that are
                                     writes the cross-reference           missing.
                                     file lines to the error file. The
                                     cross-reference file line
                                     consists of the number of
                                     gates, the device, the part file
                                     name, the power and ground
                                     pins, and the symbol file
                                     name. There is a limit to how
                                     many power and ground pins
                                     can be written to the error
                                     file. This message means that
                                     limit was exceeded.
Too many symbols on this sheet       P-CAD symbol instances               Create a new sheet and move
to create P-CAD symbol name.         require a name. This name’s          some of the parts onto it.
                                     format consists of
                                     NCssssxxxx; where ssss is
                                     sheet number and xxxx is a
                                     symbol number. This only
                                     allows for 9999 symbols on a
                                     sheet. If the system detects
                                     that there are more than 9999
                                     symbols on a sheet, which
                                     require a symbol name, it
                                     logs this error.
Unable to open file <file name>.     This could mean that the file        Make sure the specified file
                                     does not exist, or that the          exists and that it is not a read-
                                     system is trying to open for         only file.
                                     writing a read-only file.

Unable to rename file <file          This could mean that the file        Make sure the specified file
name> to <file name>.                the system is trying to              exists and that it is not a read-
                                     rename does not exist, or            only file.
                                     that a file already exists that it
                                     is trying to rename it to.
Unable to translate text object      The system was unable to get         N/A
near (x, y).                         the data from a text object so
                                     that it could be translated.
Unable to translate text style for   The system found a text              N/A
text object near (x, y).             object that is using an
                                     unrecognizable text style.



P-CAD PCB User’s Guide                                                                                        575
Appendix B: P-CAD System Messages                                                            Warning Messages



          Error Message                           Cause                              Solution
Unrecognized CN format in             A syntax error was                Make sure the CN syntax is
instance <name> near line <line       encountered.                      correct. The CN format can be
number>.                                                                of 2 styles:

                                                                        {CN <net name> ...}

                                                                        or

                                                                        {CN <pin name> <net name>
                                                                        ...}.
Unrecognized justification style.     You are using a justification     Use a justification style that
                                      style that is currently           the system recognizes.
                                      unrecognizable to the
                                      system.



Warning Messages

        Warning Message                                               Cause
Attribute key too long near (x, y).   PDIF format allows only 23 characters for an attribute key. The
                                      system found a key with more than 23 characters.
Attribute object near (x, y) has      The system found an attribute with no value. PDIF format
no value.                             requires a value so this attribute was ignored by the system.
Attribute value too long near (x,     PDIF format allows only 255 characters for an attribute value.
y).                                   The system found an attribute value with more than 255
                                      characters. The attribute value is translated truncated to 255
                                      characters.
Cannot open file <file name>.         This could mean that the file does not exist, or that the system
                                      is trying to open for writing a read only file.
COMP_DEF <name> has a pack-           The pin number specified in the SPKG Sp record does not map
age pin number (<number>) that        to any pad in the PIN_DEF record. Either the pin des number is
is out of range near line <line       greater than the number of pads or a pad with the same name
number>.                              (number) could not be found.
COMP_DEF <name> has no                The COMP_DEF has no pin to pad mapping (packaging)
SPKG section near line <line          information. The components pins created will have pin
number>. Pin names will start at      designators that match the pad's position in the PIN_DEF array.
'1'.                                  The component is most likely a PCB only component.




576                                                                                   P-CAD PCB User’s Guide
Warning Messages                                                        Appendix B: P-CAD System Messages



        Warning Message                                              Cause
COMP_DEF <name> references           A pad references a padstack number (Pt) that is not defined in
unknown pad stack <number>.          the PAD_STACK record. The PCB “(Default)” padstack will be
Style <name> used instead.           used instead.
Component <name> has had its         A component’s type in Master Designer is used as the file name
name changed to <name>. This         for the symbol data. This limits the component’s type to 8
is required to maintain              characters. In P-CAD PCB and Schematic, the component’s type
uniqueness in P-CAD.                 can be 17 characters. This means that the type is truncated to 8
                                     characters and slightly modified to make it unique if there is
                                     more than one component that has that 8 character prefix.
Component <name> is                  Master Designer does not allow heterogeneous components.
heterogeneous and will be            During translation the heterogeneous components are
written as <number> separate         separated into homogeneous components. The cross reference
COMP_DEFs. Cross reference           file data is included in the error file for your convenience.
file data follows:
Component <Ref Des>, type            The PRT attribute value is the file name for the PCB part data.
<type> was given a PRT attribute     The value is created by combining the type with “.prt”. In P-
of <PRT attribute value> which       CAD PCB and Schematic, the type can be longer than 8
may cause packaging errors in P-     characters.
CAD.
                                     If the type is longer than 8 character, this is an illegal file name.
                                     You will need to fix this attribute in Master Designer before
                                     you can package the schematic.
Copper Pour not allowed in pat-      PCB does not support copper pours in patterns. The pour was
tern <name> (<ref des>) near         converted to a polygon, which is supported.
line <line number>. Pour
demoted to polygon.
Could not create pad/via style for   A memory or resource limit has been reached. Reduce the
pad <number> near line <line         number of padstack in the design or simplify their
number>.                             construction.
Cross reference file missing         The attached symbol name could not be added to the compo-
entry for <name>. Unable to          nent because there was no cross reference file entry for the
attach symbol name for multi-        part.
part component.
Heterogeneous component              Heterogeneous components are found in the cross reference
<name> is missing gates <part        file but the PDIF data is not found in the PDIF file. If you place
number>. Parts <ref des> cannot      the missing gates in Master Designer, re-create the PDIF file,
be placed. Place the missing         the PDIF data will be included and a complete heterogeneous
gates as spares and reload.          component can be created in Schematic.




P-CAD PCB User’s Guide                                                                                       577
Appendix B: P-CAD System Messages                                                         Warning Messages



        Warning Message                                             Cause
Homogeneous part <name> has           Master Designer does not store gate equivalence. The system is
non-constant gate equivalencies.      warning you that it found a homogeneous part with non-
                                      constant gate equivalencies.
Iat value too long at line <line      PDIF format allows only 255 characters for an Iat value. The
number>                               system found an Iat value with more than 255 characters. The
                                      attribute value is translated truncated to 255 characters.
Instance <name> does not spec-        The instance Pl record is missing.
ify a location, (0,0) assumed, near
line <line number>.
Instance <name> has an illegal        The number of entries in the instance Ipt record does not
IPT record near line <line num-       match the number of entries in the COMP_DEF PIN_DEF
ber>.                                 record.
Instance <name> referenced a          An instance of a heterogeneous component references a part
package number (<part                 number that is not defined for the number of parts in the
number>) that does not exist in       component. The heterogeneous information in the cross
COMP_DEF <name> near line             reference file may be incorrect.
<line number>.
Layer name <name> has been            The layer name is used as the PDIF file name. File names are
truncated to <name>.                  limited to 8 characters. The system truncates the layer name to
                                      8 characters and if necessary, slightly modifies it to make it
                                      unique if there are more than one layer that have the same first
                                      8 characters.
Missing pad stack name for pad/       A syntax error was encountered. The padstack name is missing
via <number> near line <line          from the PAD_STACK record.
number>.
Name <name> truncated to              The object’s name was too long and truncated so that it would
<number> characters near line         be a valid PCB or Schematic name.
<line number>.
Net <name> attribute lost. <key>      Master Designer does not have net attributes. When the system
= <value>.                            warns you when it detects a net attribute.
<number> pin(s) were created          The number of entries in the PIN_DEF record does not match
for a <number> pin symbol             the number of Sp records in the SPKG record.
(COMP_DEF=<name>,
I=<name>) near line <line
number>.
Object near line <line number>        A syntax error was encountered. Check the PDIF file at the
failed to load.                       designated line number to determine cause.




578                                                                                 P-CAD PCB User’s Guide
Warning Messages                                                       Appendix B: P-CAD System Messages



         Warning Message                                            Cause
Pad stack <name> does not have       1. The padstack shape defined for the Top layer does not match
consistent enough shapes to set      the shape defined for the Bottom layer.
the predefined (Signal) layer
                                     2. The padstack shapes defined for internal signal layers are not
near line <line number>. Pad/via
                                     all the same.
style layer (Signal) set to 0.


PDIF item <PDIF object> is not       Some PDIF objects are not supported in PCB or Schematic nets.
supported in nets.                   It could be a DRC error indicator.
PDIF item <PDIF object> is not       Some PDIF objects are not supported in PCB pad stacks. These
supported in pad stacks              include polygons, text, flashes and lines.
PID too long at line <line num-      Master Designer’s PID is equivalent to PCB’s type attribute. The
ber>. Truncated.                     PID is limited to 15 characters. If PCB’s type attribute is longer
                                     than 15 characters, it is truncated to 15 characters.
Power and ground attribute is        If you get this warning and are not using Master Designer
too long for symbol <name>.          Version 8.0 software, switch to Version 8.0 if possible. Version
                                     8.0 uses multiple PWGDi attributes to handle case. If you are
                                     using Version 8.0 and still get this message the PWGDi attribute
                                     is truncated. If you cannot use Version 8.0 and are getting this
                                     message, the PWGD attribute is truncated.
Power pin <pin des> of compo-        A duplicate power pin was detected in the component. Check
nent <name> could not be             the cross reference file or the PWGD(i) attribute(s) and try
added near line <line number>.       again.
Probably duplicate.
Rotation rounded to <angle> at       Master Designer Schematic can only be rotated to 0, 90, 180,
line <line number>.                  270. If a rotation other than those values is detected, the object
                                     is rotated to the nearest allowable angle.
Symbol <name> already exists in      A duplicated symbol file name was found in the cross reference
table on line <line number> of       file. First one found is used. Others are discarded.
<file name>.
Text height is less than 2 at line   P-CAD PCB and Schematic’s text height is used as the text size
<line number>.                       for PDIF translation. Master Designer’s text size cannot be less
                                     than 2. If a text height is found to be less than 2, 2 is used.
Text object near (x, y) has no       An empty text object was found and ignored.
string, object ignored.
Text too long near (x, y).           Text is limited to 255 characters. Text is truncated to 255.




P-CAD PCB User’s Guide                                                                                    579
Appendix B: P-CAD System Messages                                                           Warning Messages



        Warning Message                                             Cause
The number of components pins        The number of P statements in the COMP_DEF’s PIN_DEF
created for <name> does not          section determines the number of pins.
match the number of PIN_DEF
entries near line <line number>.
Power pins might be missing.
The number of pins in section        A PKG part section does not have the same number of entries
<part number>                        (pins) as the PIN_DEF record.
(COMP_DEF=<name>) is not
equal to the number of pins
defined (PIN_DEF) near line
<line number>.
Translating TangoPRO polygon         Master Designer Schematic does not have a filled polygon
object near (x, y) as P-CAD lines.   object. If the system detects a polygon object is translates it as
                                     lines for Master Designer.
Unrecognized keyword <key>           A syntax error was encountered. Check the PDIF file at the
near line <line number>. Key-        designated line number to determine cause.
word ignored.
Via references unknown pad           The padstack number referenced by a via does not exist. The
stack <number>. Style <name>         via style used will be <name>, probably (Default).
used instead.




580                                                                                  P-CAD PCB User’s Guide
                                                                                                                             Index

Index
                                                                                   modifying .............................................. 175
                                      -A-                                       setting up for Gerber ............................. 174
     accessing a Reference Link.......................305                       shapes........................................................ 258
     adding                                                                     thermal ...................................................... 259
       a new field.................................................225          types........................................................... 260
       attributes ...........................227, 236, 301, 351               arc
       Custom Reports .......................................222                changing centerpoint ...............................18
       DTP groups ...............................................240            curved................................................ 104, 413
       DTP items ..................................................241          flipping ...................................................... 382
       DTP sections .............................................240            mitering............................................. 112, 420
       Layer Sets...................................................455         moving ...................................................... 382
       layers ..........................................................453     placing....................................................... 382
       notes...........................................................228      properties ................................................. 314
       Pad Styles...................................................473         rotating...................................................... 382
       Reference Links .......................................304               routing....................................... 104, 108, 412
       Text Styles .................................................483         selection criteria ..................................... 426
       tools to Customized Toolbar ................539                        Arc, Place command .................................. 382
     advanced                                                                 Archive Library, Library command ......... 495
       drill table options ....................................543            assign
     alias                                                                      apertures for Gerber .............................. 174
       creating ......................................................488       apertures manually................................. 175
     Alias, Library command .............................488                    N/C Drill tools.................................. 184, 268
     Align Components, Edit command.........340                               Attribute, Place command........................ 396
     align to grid ..................................................340      attributes
     All, View command ....................................362                  adding........................................ 302, 329, 352
     Alter Component, Edit command ...........338                               deleting ..................................... 227, 301, 351
     altering a component ................................339                   modifying.................................. 302, 329, 352
     annotate errors............................................165             net 310, 350
     any node routes                                                            placing....................................................... 397
       (2 vias) ........................................................137     properties ......................... 301, 303, 328, 351
       (maze) ........................................................138     automatic
     aperture                                                                   assign/describe apertures ..................... 174
       assign/describe (Gerber) .......................256                      assignment of drill symbols.... 92, 176, 262
       assigning manually..................................175                autopanning, adjusting............................. 431
       assignment                                                             Autoplace, Place command ..................... 370



P-CAD PCB User’s Guide                                                                                                                         581
Index


        Autorouter, Route command ...................406                            colors
        autorouting                                                                  display........................................................ 444
         attribute description ...............................353                      options ................................................... 442
         selecting.....................................................407           layer/entity ................................................ 443
         supported autorouters ...........................405                        print............................................................ 214
        autosave                                                                     setting highlight color............................ 196
         adjusting ....................................................431          Command Toolbar......................................... 7
                                                                                    Command Toolbar, View command ...... 365
                                          -B-                                       Compare Netlist, Utils command ........... 524
        backtracking................................ 105, 412, 418                  complex polygon, defined ....................... 383
        basics .................................................................5   component
        batch printing ............................... 93, 209, 210                  align to grid .............................................. 340
        blind and buried vias                                                        altering .............................................. 338, 339
          violations (DRC) ...............................167, 519                   deleting from a library ........................... 491
        block select ....................................................21          exploding .................................................. 338
          procedure....................................................23            highlight an attached net ...................... 345
          select mode frame...................................426                    jump to a component .............. 14, 344, 345
        bounding outline ........................................363                 pin properties .......................................... 299
          View Zoom Window ...............................363                        placing ....................................................... 374
        bus routing                                                                    connections .......................................... 377
          changing layers ........................................115                properties ......................................... 293, 299
        Bus, Route command .................................113                      reference links......................................... 304
                                                                                     renaming................................................... 492
                                          -C-                                        replacing ................................................... 500
        C Routes (2 vias) ..........................................137              rotating and flipping............................... 375
        CAM                                                                          selection criteria...................................... 426
          File Gerber In............................................244              violations (DRC) .............................. 167, 518
          File Gerber Out ........................................253               Component, Place command .................. 374
          File N/C Drill .............................................264           components
          tutorial........................................................171        aligning........................................................ 52
        Cascade, Window command....................563                               moving by RefDes..................................... 60
        Center, View command.............................362                        Components, Edit command................... 344
        changing layers............................................418              Compress binary designs ......................... 433
        circles, placing .............................................382           Configure, Options command ................ 429
        class editor....................................................470         connection
        Class to Class clearances...........................466                      deleting from a net ................................. 336
        cleaning up traces.......................................532                 jumper pads ............................................. 378
        Clear, File command ..................................207                    length................................................. 310, 355
        clearances                                                                   manually routing ..................................... 409
          attributes....................................................353          optimizing................................................. 524
          design rules...............................................461             options ...................................................... 430
          DRC.....................................................151, 507           physical...................................................... 102
          violations ...................................................166          properties ................................................. 305
        clipboard file, pasting ........................280, 284                    Connection, Place command .................. 377
        Close, File command..................................205                    coordinates, X and Y.................................... 10
        closing a window ........................................205                copper length...................................... 310, 355
        collocated objects                                                          copper pour................................. 106, 414, 419
          how PCB redraws.....................................361


582                                                                                                             P-CAD PCB User’s Guide
                                                                                                                                            Index


       auto plowing.............................................193             drill symbol legends............................... 187
       autorouting ...............................................192           DTP file ...................................................... 231
       backoff .......................................................192       DTP groups............................................... 240
       circles .........................................................192     DTP items.................................................. 241
       connectivity ..............................................191           DTP sections ............................................ 240
       drawing an outline ..................................387                 graphic images ...........................................85
       filling...........................................................388    macros ..........................................................11
       hatched ......................................................391        manual routing ........................................ 106
       interactive routing...................................192                mitered corners............................... 111, 420
       islands ........................................................190      nets from free copper............................ 531
       manual routing.........................................192               padmaster Gerber file............................ 181
       options.......................................................190        pseudo patterns ...................................... 199
       overlapping pours ...................................193                 title blocks ...................................................82
       properties..........................................189, 317             title sheets ...................................................80
          line options............................................318          Cross-probing................... see DDE Hotlinks
          state option............................................319          current highlight color.............................. 196
       repour ........................................................190      Current Keepout, Options command ... 458
       rotating and flipping ...............................389                Current Line, Options command ..... 98, 457
       routing .......................................................192      current radius ..................................... 104, 413
       selection criteria ......................................426            Current Radius, Options command. 12, 459
       solid ............................................................391   current zoom factor................................... 141
       thermals.....................................................192         for View Zoom In .................................... 362
       violations (DRC)...............................166, 518                  for View Zoom Out ................................ 363
     Copper Pour ..................................................68          cursor
       Plowing Tracks, Cutouts ..........................69                     free floating.................................................19
     Copper Pour, Place command .................387                            snappy ..........................................................19
     copper tie .....................................................315        snappy vs. free-floating ......................... 367
     copper, free (copied) .................................357                 style............................................................ 445
     Copy Matrix, Edit command.....................337                          tracker ..........................................................10
     Copy to File, Edit command .....................283                       curved traces....................................... 104, 412
     Copy, Edit command..................................283                    routing....................................................... 108
     Copy, Library command............................489                      custom toolbar ................................................9
     copying                                                                    displaying.................................................. 539
       an object (drag and drop)........................27                     Custom Toolbar, View command........... 366
       Design Technology Parameters ...........232                             custom tools
       items between libraries..........................490                     executing .................................................. 539
       library items ..............................................489         Customize, Utils command ..................... 537
       matrix of objects ................................28, 337               Customizing P-CAD PCB .......................... 202
       objects..........................................27, 283, 357           cut and paste............................... 280, 281, 284
       to a file .................................................27, 283       between designs ........................................27
     copy practice;paste practice.......................53                     Cut, Edit command .................................... 281
     corner, mitering ..........................................111            Cutout, Place command ........................... 389
     creating                                                                  cutouts
       a new file ...................................................203        defined ...................................................... 389
       a new library .............................................487           placing....................................................... 389
       apertures ...................................................174         properties ................................................. 323
       Custom Toolbar ...........................................9              rotating and flipping .............................. 390



P-CAD PCB User’s Guide                                                                                                                          583
Index


          selection criteria ......................................427               adding a group......................................... 240
                                                                                     adding a section ...................................... 240
                                          -D-                                        adding an item ......................................... 241
        D Code (Gerber) .........................................258                 attribute handling ................................... 243
        DDE Hotlinks .............................. 195, 341, 432                    browsing ................................................... 232
         enabling the feature................................196                     building the hierarchy ........................... 240
         highlighting nets......................................196                  copying to a design................................. 232
         setting the current highlight color ......196                               delete button ........................................... 242
         unhighlighting nets .................................197                    dialog ......................................................... 230
         unhighlighting parts and components                                         merge attributes ...................................... 243
              ...............................................................197     opening ..................................................... 231
        default pin des                                                              properties ................................................. 234
         renumbering.............................................500                 rename ...................................................... 242
        Delete, Edit command ...............................335                      replace attributes .................................... 243
        Delete, Library command..........................491                         statistics button ....................................... 242
        Delete, Macro command ..........................554                          tree ............................................................. 232
        deleting                                                                     updating .................................................... 232
         attributes............................................227, 236            Design Technology Parameters, File
         copper pour islands ................................190                   command ..................................................... 229
         DRC error indicators.......................168, 170                       design verification...................................... 523
         DTP groups, sections, or items .............242                           Design Verification ...................................... 70
         field sets.....................................................226          Design Rule Checking ............................. 70
         Gerber layer info......................................180                  Netlist Verification.................................... 70
         items from a library .................................491                 dialog convention .......................................... 6
         items in a block ........................................426              dialogs
         macros........................................................554           Aperature Assignments ......................... 174
         Net objects ................................................336             Copy Via Style.......................................... 100
         notes ...........................................................228        Describe/Assign Tools............................ 184
         objects................................................282, 335             Drill Symbol Assignments............... 91, 176
         pad styles ...................................................480           ECO Filename .......................................... 198
         previous segments ............................18, 105                       ECO Warning ........................................... 200
         print jobs ...................................................211           Edit Nets .................................................... 135
         Text Styles..................................................484            File Gerber In ........................................... 179
         vertexes........................................................26          File Gerber Out ....................................... 171
        Deselect All, Edit command......................341                          File N/C Drill..................................... 181, 186
        design                                                                       File Print ...................................................... 89
         print current window..............................209                       Find Errors................................................. 168
         printing ........................................................74         Gerber Format ......................................... 177
        Design Info, File command.......................223                          Modify Via Style (Complex).................. 101
        design rules ..................................................459           Modify Via Style (Simple) ...................... 100
         additional DRC checks ...................162, 514                           N/C Drill Format ...................................... 185
         by category........................................156, 508                 Options Configure ................................. 125
         by hierarchy ......................................158, 510                 Options Current Line............................... 99
         checking ............................................445, 506               Options Design Rules
         clearances..................................................459               Class To Class tab ................................ 155
        Design Rules, Options command ...........459                                   Design tab ............................................. 151
        design technology parameters                                                   Layer tab................................................. 152



584                                                                                                             P-CAD PCB User’s Guide
                                                                                                                                            Index


         Net Class tab..........................................154             fields sets .....................................................83
         Net tab ....................................................154        graphic files.................................................85
         Rooms tab ..............................................153               detail colors .............................................85
       Options Display (Misc)...........................169                        update details ..........................................85
       Options Grids.............................................97             layer stackup diagrams .............................85
       Options Layers .........................................134              revision blocks ...........................................82
       Options Via Style...............................99, 138                  title blocks ...................................................82
       Pass Selection...........................................136             title sheets ...................................................80
       Print Setup ..................................................88         zones ............................................................81
       Route Autorouters...................................132                 Documentation Toolbox .............................79
       Route Cancel ............................................144            draft mode
       Rules Severity Level ................................165                 for polygons............................................. 383
       Select Fanout ............................................119            for printing ............................................... 212
       Setup Output Files ..........................172, 182                   drag and drop ............................................. 357
       Setup Print Jobs .........................................89            Drawing
       Tool Assignments ....................................183                 a board outline ...........................................58
       Utils Design Rules Check ......................164                      Drawing Interchange Format .................. 246
       Utils Export ECOs ....................................200               drawing order ................................................16
       Utils Import ECOs ...................................198                DRC
       Utils Record ECOs...................................198                  clear overrides......................................... 518
       View Photoplot File.................................179                  configuration ........................................... 164
     diameter values in N/C Drill file ..............268                        copper ties................................................ 164
     dimension                                                                  define area................................................ 519
       defined.......................................................400        errors ......................................................... 445
       properties..................................................334             annotation ............................................. 167
     Dimension, Place command ....................400                              block selection ..................................... 169
     Display Colors                                                                finding.................................................... 168
       setting highlight color ............................196                     flags......................................................... 165
     Display, Options command......................442                             global display........................................ 169
     DocTool Commands                                                              ignored................................................... 517
       Mirror on Copy ........................................549                  overridden ............................................ 517
       Notes ..........................................................548         overrides................................................ 170
       Place Design View ...................................543                 rules ........................................................... 151
       Place Detail ...............................................545          setup .......................................................... 507
       Place Diagram...........................................546              Severity Levels ......................................... 516
       Place Picture .............................................548          DRC, Utils command......................... 445, 506
       Titles ...........................................................548   drill drawing
       Update .......................................................548        generating ................................................ 188
       Update All .................................................549         drill symbols
     DocTools                                                                   alpha-character...........................................92
       associative dimensions ............................87                    assign for printing......................................91
       borders ........................................................80       automatic assignment...................... 92, 176
       design details..............................................84           emulating Master Designer .....................92
       design views ...............................................82           Gerber output.......................................... 261
       drawing and revision notes.....................83                        legends...................................................... 187
       drawing layers ............................................79            manual assignment................... 92, 177, 262
       drill tables....................................................86       print ........................................................... 213



P-CAD PCB User’s Guide                                                                                                                          585
Index


         setting in Gerber......................................176                 Paste Special............................................. 287
        drill table.......................................................543       Paste To Layer .......................................... 286
        Drill, N/C .......................................................264       Properties............................................ 28, 292
        duplicating objects .....................................337                Redo ........................................................... 281
        DXF file                                                                    Rooms........................................................ 343
         items supported for translation............249                             Select ......................................................... 356
         loading .......................................................246         Select All ............................................. 24, 341
         view log file ...............................................249           Select Highlighted .................................. 342
        DXF In, File command................................246                     Undo .................................................. 279, 280
        DXF Out                                                                     Unfix........................................................... 342
         component Height ..................................272                     Unfix All..................................................... 343
        DXF Out, File command ............................270                       Unhighlight .............................................. 341
        DXF output ...................................................272           Unhighlight All ........................................ 342
                                                                                  editing
                                         -E-                                        attributes........................... 236, 301, 310, 351
        ECO ................................................................197     components ..................................... 338, 344
         export .................................................200, 505           existing miters.......................................... 421
         filename .....................................................198          items in a block........................................ 426
         format .........................................................430        Layer design rules ................................... 153
         import.................................................198, 503            macros ....................................................... 557
         pseudo patterns .......................................504                 Nets .................................................... 135, 345
         record .................................................198, 502           objects ......................................................... 24
         saving..........................................................200        overriding errors ..................................... 168
         types of changes ..............................197, 502                    properties ................................................. 292
         view pending ............................................505                 Arc 314
        Edit Commands                                                                 Attributes ............................................... 328
         Align Components ..................................340                       connections .......................................... 305
         Alter Component.....................................338                      Copper Pour ......................................... 317
         Attributes...................................................350             Cutout .................................................... 323
         Components .............................................344                  Design View .......................................... 331
         Copy ...........................................................283          Detail ...................................................... 331
         Copy Matrix ..............................................337                Diagram.................................................. 332
         Copy to File ...............................................283              Dimension ............................................. 334
         Cut...............................................................281        Field ........................................................ 330
         Delete .........................................................335          Line.......................................................... 313
         Deselect All .........................................24, 341                Pad........................................................... 307
         Explode Component...............................338                          Picture .................................................... 333
         Fix 280, 342                                                                 Plane ....................................................... 323
         Highlight ....................................................341            Polygon .................................................. 315
         Measure .....................................................355             Room ...................................................... 325
         Move By RefDes .......................................290                    Table ....................................................... 333
         Move to Layer ...........................................291                 Test Point ............................................... 316
         Nets.............................................................345         Text.......................................................... 327
         Paste....................................................280, 284          Rooms design rules ................................ 154
         Paste Circuit ..............................................287            Text Styles ................................................. 485
         Paste From Clipboard .............................286                    electrical pin type....................................... 300
         Paste from File ..........................................286            enabling DDE hotlinks .............................. 196



586                                                                                                           P-CAD PCB User’s Guide
                                                                                                                                               Index


     Engineering Change Orders ....198, 430, 502                                   Save............................................................ 205
     error annotation                                                              Save As ...................................................... 206
       DRC.............................................................167      files
     error messages ............................................571                compression
     errors                                                                          binary...................................................... 433
       annotate.....................................................165            drag and drop .......................................... 204
     examining design relationships                                                drag and drop file load .............................31
       DDE Hotlinks ............................................195                Gerber Out............................................... 171
     existing aperture definitions....................479                          loading and saving.....................................31
     existing pad style polygonals ...................479                          N/C Drill command ................................ 181
     Exit, File command......................................276                   opening a recently used file................. 204
     Explode Component, Edit command .....338                                      opening an ASCII file ............................. 204
     Export ECOs, Utils command...................505                              saving an ASCII file......................... 206, 207
     exporting                                                                     types..............................................................31
       ECOs...........................................................505       Find Errors, Utils command ..................... 519
     Extent, View command..............................361                      flipping objects..............................................17
                                                                                font
                                       -F-                                         changing text style.................................. 485
     Fanout, Route command...........................118                           style examples ......................................... 485
     fanouts ..........................................................109      Force Update, Utils command ................ 500
     features .............................................................1    format
     field properties............................................330               Gerber ....................................................... 262
     Field, Place command ................................398                      N/C Drill .................................................... 269
     File Commands                                                              free floating cursor .................................... 367
       Clear ...........................................................207     free pads ...................................................... 180
       Close...........................................................205         displaying.................................................. 446
       Design Info ...............................................223
         Attributes tab.........................................226                                              -G-
         Fields tab ................................................224         gate swapping
         General tab ............................................224              manual....................................................... 527
         Notes tab ................................................227            rules ........................................................... 530
         Revision tab ...........................................228            Generate Netlist, Utils command........... 523
         Statistics tab...........................................228           generating a netlist .................................... 523
       Design Technology Parameters ...........229                              Gerber
       DXF In.........................................................246         deleting layer information .................... 180
       DXF Out .....................................................270           format ................................................ 177, 262
       Exit...............................................................276     output........................................................ 171
       Gerber In ...................................................244             compress files............................... 178, 263
       Gerber Out ...............................................253                files.......................................................... 172
       N/C Drill.....................................................264            generating ............................................. 178
       New.............................................................203        verification................................................ 178
       Open ..........................................................203       Gerber In, File command ......................... 244
       PDIF In .......................................................251       Gerber Out, File command...................... 253
       PDIF Out....................................................273          glue dots ...................................................... 445
       Print ............................................................207    grid
       Printer Setup.............................................215              non-uniform............................................. 440
       Reports.......................................................215          origin ......................................................... 440



P-CAD PCB User’s Guide                                                                                                                             587
Index


         setup for routing........................................97                Optimize Nets............................................ 60
         snap cursor to.............................................19              Replace Components............................... 57
         spacing .......................................................440       Installation and Setup ................................... 3
         Status Line toggle button.........................98                       installing P-CAD products......................... 4
         style (visible, dotted, hatched)..............440                          system requirements.................................. 3
         toggle                                                                   interactive routing...................................... 108
           absolute and relative settings ..............10                          backtracking............................................. 418
         uniform ......................................................440          changing layers.................................. 98, 418
        Grid Toggle button .....................................441                 complete ........................................... 111, 418
        Grids, Options command .........................439                         controlling trace placement ................. 415
                                                                                    copper pours............................................ 419
                                         -H-                                        layers.......................................................... 419
        hardware requirements.................................3                     line widths ................................................ 419
        Help                                                                        loop removal .................................... 111, 419
          About P-CAD PCB....................................565                    modifying traces...................................... 418
          How to Use Help .....................................565                  net attributes.................................... 109, 416
          P-CAD PCB Help Topics .........................565                        obstacle hugging............................. 109, 416
          Series II Commands ................................565                    options ...................................................... 437
        Help Commands .........................................565                  pad entry or exit .............................. 109, 416
        hiding                                                                      polygonal pads ........................................ 417
          connections ..............................................348             pop-up menu ........................................... 419
          points..........................................................387       rerouting lines ......................................... 418
        highlight                                                                   slash lines.......................................... 110, 418
          an attached net.........................................345               status line information........................... 415
          nets .............................................................348     suspend............................................. 111, 418
          while routing ............................................436             terminating a route......................... 110, 417
        Highlight, Edit command ..........................341                       Trace Cleanup.......................................... 418
        hole range.............................................480, 482             T-routing ........................................... 103, 417
        horizontal                                                                  unwinding................................................. 418
          alignment...................................................340           vias.............................................................. 419
          routing pass ..............................................136          Interapplication Functions
        hotlinks,enabling ........................................432               DDE hotlinks ............................................ 195
        how to use help...........................................565             InterPlace/PCS, Utils command ...... 533, 537
                                                                                  InterRoute Gold
                                          -I-                                       maximum hugging.................................. 122
        icons, toolbar ...................................................6         minimum length...................................... 122
        imperial units ...............................................430           right mouse menu .................................. 124
        Import ECOs, Utils command ..................503                            visible routing area ................................. 123
        importing                                                                 InterRoute, Route command ................... 414
          ECOs ...........................................................503     island removal............................................. 320
        Info, Net ........................................................355     items................................................................ 22
        Initial Board Layout.......................................57
          Creating a Board Outline.........................58                                                       -J-
          Loading a Netlist ........................................58            jump
          Moving Components................................59                       to a location.............................................. 364
        Initial Board Setup                                                         to text......................................................... 364
          Aligining Components .............................52                    Jump Commands
          Finite Rotation ............................................52


588                                                                                                            P-CAD PCB User’s Guide
                                                                                                                                             Index


       Jump to a Component..............................14                        Pattern Save As ........................................ 494
     Jump Location, View command ........14, 363                                  Rename ..................................................... 492
     Jump Text                                                                    Setup.......................................................... 493
       Case Sensitive Search.............................364                    line
       Search Entire Design...............................364                     length, measuring................................... 380
     Jump Text, View command.................15, 364                              orthogonal mode.......................................17
     Jump to a Node .............................................15               placing....................................................... 380
     jumper pads .................................376, 522, 531                   properties ................................................. 313
       connections ..............................................378              selection criteria ..................................... 426
                                                                                  shapes (orthogonal modes).................. 381
                                       -K-                                        width.................................................. 139, 419
     keep                                                                           setting up for routing ............................98
      selection criteria ......................................427              Line Width Combo Box ...............................12
     keepout styles and layers..........................458                     Line, Place command ................................ 380
     Keepout, Options Current........................458                        Load Button ................................................. 133
     Keepout, Place command .........................390                        Load Netlist, Utils command ................... 520
     Keyboard preferences ...............................448                    loading a file...................................................97
                                                                                loading PDIF files ....................................... 251
                                       -L-                                      location, jumping to .....................................14
     L Routes (1 via).............................................137
     Last, View command ..................................362                                                   -M-
     layers................................................23, 134, 419         macro
       adding or deleting.....................................35                 defined ...................................................... 551
       changing for routing.................................98                   deleting ..................................................... 554
       enabling/disabling.............................15, 451                    file syntax.................................................. 557
       Layer Sets.............................................23, 426            recording .................................................. 553
       nonsignal.....................................................15          renaming................................................... 554
       photoplot file............................................256             running.............................................. 555, 556
       print ............................................................211     setting up.................................................. 551
       selecting items ...........................................19             using effectively ...................................... 555
       selection mask..........................................425              Macro Commands ..................................... 551
       setting ..........................................................61      Delete ........................................................ 554
       signal ............................................................15     Macro Record toggle button...................11
       status line ..................................................453         Record/Stop ............................................. 552
       using .............................................................15     Rename ..................................................... 554
     Layers, Options command..................12, 450                            Run ............................................................. 555
     library                                                                     Setup.......................................................... 551
       alias .............................................................488   manual
       definition...................................................487          assignment of drill symbols.... 92, 177, 262
       deleting pattern/component.................491                           manual gate swap....................................... 527
       opening with drag-and-drop file load 493                                 manual routing ........................................... 106
       setting up...................................................493          arcs ..................................................... 104, 412
     Library Commands .....................................487                   backtracking............................................. 412
       Alias ............................................................488     between layers ........................................ 411
       Archive Library .........................................495              changing layers...........................................98
       Copy ...........................................................489       completing a trace .......................... 107, 409
       Delete.........................................................491        copper pours ........................................... 414
       New.............................................................487


P-CAD PCB User’s Guide                                                                                                                           589
Index


          crossing a blockage.................................411                    simple pad style....................................... 474
          curved traces ............................................108              traces.................................................. 411, 418
          incomplete traces ............................107, 409                    mounting hole apertures.......................... 260
          modify ........................................................411        mouse preferences .................................... 449
          online DRC................................................413             Move By RefDes, Edit command............. 290
          options .......................................................437        Move to Layer
          orthogonal modes .......... 101, 102, 412, 437                             restrictions................................................ 291
          overlapping connections .......................414                        Move to Layer, Edit command................. 291
          rerouting a trace ......................................411               moving
          right mouse button .................................107                    by RefDes.................................................. 290
          routing to free copper ............................414                     filled pour ................................................. 190
          Slash key ....................................................107          items in a block........................................ 426
          status line information ...........................410                     objects ........................................... 17, 25, 357
          temporary stop.........................................107                 objects to another layer................... 18, 291
          trace cleanup ............................................412             Moving Components
          T-routing ............................................103, 411             by RefDes.................................................... 60
          unwinding .................................................411            multiple windows......................................... 13
          Width attribute.........................................414               MultiTrace routing ..................................... 115
        Manual, Route command..........................408                           routing direction ..................................... 118
        matrix, delete and copy ...............................28                    routing priority ........................................ 117
        maximum hugging......................................122                     trace placement....................................... 117
        maze routes..................................................137
        Measure, Edit command............................355                                                       -N-
        menu bar...........................................................6        N/C Drill
        messages.......................................................571           assigning/describing tools .................... 183
        metric units ..................................................430           compress output files .................... 186, 269
        MillimeterPrecision setting ......................430                        format options ................................. 185, 269
        minimum length..........................................122                  generating files ................................ 186, 265
        mirror                                                                       output tutorial.......................................... 181
          image, printing .........................................212               setup output files .................................... 182
          photplot plot file......................................255               N/C Drill, File command ................... 181, 264
        Mirror on Copy, DocTool command......549                                    net
        miscellaneous options...............................446                      attributes................................... 109, 135, 416
        miter route....................................................111           clearances ................................................. 464
        Miter tool                                                                   creating named net classes................... 470
          editing existing miters ............................421                    deleting net objects........................ 282, 336
          options .......................................................436         edit attributes................................... 347, 350
          T-routing ............................................112, 421             information............................................... 347
          using ...................................................111, 420          jump to node ........................................... 347
        Miter, Route command..............................420                        layer attributes......................................... 347
        modes, changing absolute and relative                                        length (DRC) ............................................ 166
        grid .................................................................440    name, specifying ..................................... 377
        modifying                                                                    Net Attrs button....................................... 310
          complex pad style....................................474                   Net Class tab ............................................ 462
          display text ................................................483           Net Info button........................................ 355
          existing routes ..........................................113              optimizing................................................. 525
          object properties .......................................28                renaming................................................... 347



590                                                                                                           P-CAD PCB User’s Guide
                                                                                                                                             Index


      renaming ...................................................350           selecting.......................................................19
      selecting ..............................................24, 348           selection and modification......................16
      tab properties...........................................309              selection and placement ..........................16
      unhighlight ...............................................348            selection mask......................................... 424
      view attributes..........................................348              what can be placed....................................16
     Net Classes, Options command..............469                            obstacle hugging................................ 109, 416
     netlist                                                                  offset
      check for copper sharing.......................523                        X, Y in drill file.......................................... 266
      compare, DRC violations .......................166                        X, Y in photoplot file .............................. 255
      comparing .................................................524          Online DRC ......................................... 126, 167
      format.........................................................521      Open, File command................................. 203
      generating .................................................523         opening
      jumper pads..............................................522              a file............................................................ 203
      loading .......................................................520      Optimize Nets, Utils command .............. 525
      loading on an existing board ................522                        options
      optimization .............................................525             route .................................................. 429, 435
      optimize nets............................................522            Options
      pseudo patterns.......................................522                 Block Selection...........................................56
      reconnect copper....................................523                 Options Commands .................................. 423
      violations ...........................................166, 518            Configure.................................................. 429
     Nets, Edit command ...................................345                  Current Keepout ..................................... 458
     New Window, Window command .........563                                    Current Line ....................................... 98, 457
     New, File command....................................203                   Current Radius .................................. 12, 459
     New, Library command .............................487                      Design Rules ............................................ 459
     No Mt Hole Cu ............................................256              Display....................................................... 442
     nodes                                                                      Grids .......................................................... 439
      clear all.......................................................346       Layers................................................... 12, 450
      set all ..........................................................346     Net Classes ............................................... 469
     non-signal layer...........................................451             Pad Style.................................................... 472
     non-uniform grid spacing.........................440                       Preferences .............................................. 448
     no-route zones (keepouts).......................458                        Selection Mask ........................................ 423
     note tables....................................................542         Text Style................................................... 482
     Notes, DocTool command........................548                          Via Style............................................... 99, 482
     numbering pads..........................................497              Options Configure
                                                                                General tab............................................... 429
                                      -O-                                       Online DRC tab ............................... 429, 433
     objects                                                                    Plow tab..................................................... 437
      cutting, copying, and pasting..................27                         Route tab................................... 125, 429, 435
      deleting......................................................335       Options Display
      editing ..........................................................24      setting highlight color ........................... 196
      moving .........................................................25      orthogonal modes ........................................17
      moving to another layer...................18, 291                         routing with.............................. 101, 102, 412
      object/action interaction..........................16                   output
      pasting................................................280, 284           plotter...........................................................88
      placing....................................................15, 16       output files
      resize ............................................................26     setting up.......................................... 182, 266
      rotating and flipping .................................25                   for Gerber.............................................. 172



P-CAD PCB User’s Guide                                                                                                                           591
Index


        Output Log File............................................133            pasting
        overlapping objects, selecting .................357                         circuits ................................................. 28, 287
                                                                                    clipboard file ............................ 280, 284, 286
                                         -P-                                        from a file.................................................... 28
        pad properties                                                              limitations ................................................... 28
         chaning ........................................................54         mask shrink ...................................... 432, 433
        Pad Style, Options command...................472                            merging net attributes ........................... 289
        Pad, Place command ..................................378                    paste behavior ......................................... 284
        Padmaster Gerber file ................................181                   renaming
        pads                                                                          Nets......................................................... 289
         entry or exit.......................................109, 416                 RefDes .................................................... 288
         jumper pads ..............................................376            pattern
         modifying styles .......................................379                deleting from a library ........................... 491
         net names                                                                  pad properties ......................................... 297
           displaying ...............................................447            placeholder .............................................. 199
         no connect pads, no connect shape ...392                                   pseudo....................................................... 522
         number ......................................................300           renaming................................................... 492
         placing........................................................378       Pattern Save As, Library command ......... 494
         placing connections................................377                   P-CAD
         properties ..................................................307           launching applications................... 201, 532
         renumbering.....................................379, 499                   Pattern Editor
         rotating and flipping ...............................379                     running................................................... 532
         selection criteria ......................................427               PCB
         shapes                                                                       DDE Hotlinks ........................................ 195
           polygonal pads......................................477                    ECOs ....................................................... 197
         stacks (pad styles) ....................................472                  features ...................................................... 1
         style                                                                        Help Topics ........................................... 565
           complex ..................................................473            PCB (6/400)
           hole range ..............................................480               features ...................................................... 2
           modify pad definition..........................476                       Relay and DDE Hotlinks......................... 195
           modifying complex pad style.............474                              Schematic
           modifying simple pad style ................474                             DDE Hotlinks ........................................ 195
           plated pads.............................................474                ECOs ....................................................... 197
           renaming ................................................480             Scout
           shapes .....................................................476            DDE Hotlinks ........................................ 195
           simple......................................................473          Symbol Editor
           thermal spokes (diameter and width                                         running................................................... 532
                ............................................................477     Tango PCB
         vias, pad/via holes....................................256                   component restrictions...................... 374
        panning ...........................................................14     P-CAD Library Executive
         screen, adjusting......................................431                 Utils command ........................................ 532
        part number .................................................300          P-CAD Pattern Editor, Utils command... 532
        Passes button ...............................................136          P-CAD Schematic, Utils command ......... 532
        Paste from File, Edit command.................286                         P-CAD Symbol Editor, Utils command .. 532
        Paste Special, Edit command....................287                        PDIF In, File command .............................. 251
        Paste To Layer, Edit command .................286                         PDIF Out, File command .......................... 273
        Paste, Edit command ..........................280, 284                    photoplot file, generating ........................ 253



592                                                                                                          P-CAD PCB User’s Guide
                                                                                                                                              Index


     photoplot file, viewing ................................78                  copper pour ............................................. 387
     Pick and Place                                                              cutout ........................................................ 389
       show or hide.............................................445              dimension................................................. 400
     pin                                                                         line ............................................................. 380
       designators ...............................................300            pad ............................................................. 378
       equivalence...............................................300             plane .......................................................... 390
       name...........................................................300        points......................................................... 385
       pin and gate swapping ...........................525                      polygon ..................................................... 383
         automatic ...............................................526            test points ................................................. 386
         impact on Library Manager ................530                           text ............................................................. 393
       pin swapping                                                              text summary ........................................... 396
         manual ....................................................528        plane
       swapping                                                                  indicator
         rules.........................................................529         displaying .............................................. 447
     PinEq ..............................................................300     layer ........................................................... 451
     Place Commands ........................................369                  pads and vias............................................ 391
       Arc 382                                                                   properties ................................................. 323
       Attribute ....................................................396         selection criteria ..................................... 427
       Autoplace ..................................................370           swell ........................................................... 433
       Component...............................................374             Plane, Place command .............................. 390
       Connection ...............................................377           plated pads .................................................. 474
       Copper Pour .............................................387            Point, Place command............................... 384
       Cutout ........................................................389      points
       Dimension.................................................400             Glue Dot ................................................... 384
       Field ............................................................398     Pick and Place .......................................... 384
       Keepout .....................................................390          placing....................................................... 385
       Line .............................................................380     point-to-point routing ........................... 102
       Pad ..............................................................378     Reference Point....................................... 384
       Plane ...........................................................390      showing or hiding................................... 387
       Point ...........................................................384      size, setting............................................... 386
       Polygon ......................................................383         Test Point .................................................. 385
       Room ..........................................................392      Polygon, Place command ......................... 383
       Text .............................................................393   polygons
       Via 380                                                                   altering the shape ............................. 19, 384
     Place Design View, DocTool command.543                                      draft mode................................................ 383
     Place Detail, DocTool command.............545                               polygonal pads ................................ 417, 477
     Place Diagram, DocTool command ........546                                  properties ................................................. 315
     Place Picture, DocTool command...........548                                reference point pairs ............................. 479
     placeholder patterns..................................199                   rotating and flipping .............................. 383
     placement practice.......................................40                 rounded corners ............................... 26, 358
     Placement Toolbar..........................................7                selection criteria ..................................... 427
     Placement Toolbar, View command.......365                                 pop-up menu .............................................. 419
     placing                                                                   Preferences, Options command............. 448
       an arc ..........................................................382    preview ECO file ................................ 199, 504
       attributes ...................................................397       Print, File command................................... 207
       component ...............................................374            Printer Setup, File command ................... 215
       connections and merging nets.............378                            printing............................................................88



P-CAD PCB User’s Guide                                                                                                                            593
Index


          batch ............................................ 93, 209, 210            commands available during routing... 140
          current window........................................209                  completing the PC board ...................... 130
          design extents ..........................................212               design rule checking .............................. 129
          drill symbol assignments ...................88, 91                         error messages ........................................ 140
          job name....................................................211            grid selection ........................................... 149
          print jobs ...................................................210          iterative approach ................................... 130
            generating ..............................................207               guidelines .............................................. 131
            setting up................................. 89, 209, 210                 keepouts ................................................... 146
          print preview ............................................208              limitations ................................................. 145
          printer setup .......................................88, 215               netlist information .................................. 128
          scaling to fit page.....................................209                off-grid items............................................ 146
          setting up colors ................................93, 214                  optimizing
          thin line text ..............................................212             lines and nets........................................ 128
        Probing............................... see DDE Hotlinks                        pre-routed lines ................................... 128
        prompt line                                                                  pad selection............................................ 149
          displaying ......................................................9         plane
        Prompt Line, View command ...............9, 366                                connecting surface pads to a plane. 147
        properties                                                                     connections .......................................... 147
          arc 314                                                                      split planes ............................................ 147
          attributes................................... 301, 303, 328                pre-routed connections ........................ 146
          component........................................293, 299                  processing
          component pins.......................................299                     keepouts ................................................ 128
          connection ................................................305               lines......................................................... 128
          copper pour ..............................................317                pads......................................................... 128
          cutout .........................................................323          polygons ................................................ 128
          dimension..................................................334               surface pads .......................................... 128
          field .............................................................330     reading PCB file ....................................... 128
          line ..............................................................313     Route Autorouter dialog ....................... 132
          multiple objects .........................................29               routing
          pad ..............................................................307        fine points.............................................. 145
          pattern pad................................................297               grid and line width .............................. 139
          plane ...........................................................323         passes ............................................. 129, 130
          polygon ......................................................315            route completed .................................. 129
          rooms .........................................................325           steps........................................................ 128
          test point....................................................316          strategy file ............................................... 133
          text ..............................................................327     surface pads ............................................. 148
          using the edit command ..........................28                        verifying the finished board ................. 132
          via 311                                                                    via styles .................................................... 138
        Properties, Edit command...................28, 292                           writing
        pseudo patterns ..................................504, 522                     no-route data ........................................ 129
                                                                                       routed PCB file ..................................... 129
                                         -Q-
        Quick Route                                                                                                -R-
         assigning                                                                 radial placement ......................................... 359
           lines to nets............................................128            radius
           pads to nets............................................128               rounded and filleted corners ............... 358
         checking setup parameters ...................128                          Radius Combo Box....................................... 12



594                                                                                                           P-CAD PCB User’s Guide
                                                                                                                                              Index


     rats nest, defined ..........................................59             Printing your Design .................................74
     Reconnect Nets                                                              Viewing Photoplot Files............................78
       creating nets from free copper ............531                          Reports, File command ............................. 215
       jumper pads..............................................531            rerouting lines ............................................ 418
     Reconnect Nets, Utils command.............530                             resizing
     Record ECOs, Utils command .................502                             objects ................................................. 26, 357
     Record, Macro command .........................552                        revision notes table ................................... 542
     Redo, Edit command ..................................281                  right-click mouse
     Redraw, View command ...........................361                         button........................................................ 292
     reference                                                                   commands ...................................................29
       attribute .....................................................304      Room, Place command ............................. 392
       designator .................................................300         rooms.................................................... 392, 462
       links                                                                     design components................................ 326
          accessing a link .....................................305              fill pattern ................................................. 327
          adding a link ..........................................304            fixed ........................................................... 327
          launching .......................................227, 301              highlight.................................................... 343
          linking to a component.......................304                       highlight included .................................. 343
     regular polygons .........................................478               included components.................... 326, 343
     removing                                                                    properties ......................................... 325, 343
       current highlight color ...........................197                    selection criteria ..................................... 427
       free copper ...............................................282            unhighlight............................................... 343
       leftover traces...........................................361             unhighlight included ............................. 343
     Rename, Library command.......................492                         Rooms, Edit command .............................. 343
     Rename, Macro command........................554                          rotating
     renaming                                                                    items in a block ....................................... 426
       a net ............................................................350     objects ..........................................................17
       a pattern or component.........................492                        rotation increment ................................. 431
       pad styles...................................................480          when printing .......................................... 212
       Text Styles .................................................484        Route Autorouters dialog
     renumber                                                                    Net Attrs button ...................................... 135
       pads ............................................................497      Start button .............................................. 140
       reference designators ............................497                   Route Commands ...................................... 405
     Renumber, Utils command ......................497                           Autorouter................................................ 406
     report                                                                      Bus.............................................................. 113
       custom .......................................................218         Fanout........................................................ 118
          adding custom reports........................222                       Interactive................................................. 414
          format .....................................................219        Manual ...................................................... 408
          selection .................................................220         Miter .......................................................... 420
          sorting.....................................................221        View Log ................................................... 407
       DRC files....................................................164        Route Tool
       list separator .............................................218           arcs and curved trace routing .............. 103
       origin ..........................................................217    Route Toolbar ..................................................8
       style format ...............................................218         Route Toolbar, View command .............. 365
       types ...........................................................216    routing .............................................................95
     Reports and Output .....................................72                  backtracking............................................. 105
       Generating N/C Drill Files .......................78                      between layers ........................................ 411
       Gerber Output ...........................................76               bias ............................................................. 451



P-CAD PCB User’s Guide                                                                                                                            595
Index


          bus routing................................................113            View Toolbar ............................................ 142
          changing layers ..................................98, 105                 View Zoom In........................................... 141
          cleanup ......................................................138         View Zoom Out ....................................... 141
          clearance rules .........................................507              View Zoom Window............................... 142
          connections ........................................97, 414              Routing Connections .................................. 61
          copper pours ....................................106, 192                 Changing Routed Connections ............. 65
          curved traces ....................................104, 412                Routing the Connections ........................ 63
          drop via ......................................................105        Setting Layers............................................. 61
          Fanout routing..........................................118              Run, Macro command............................... 555
          features ........................................................95
          free copper........................................105, 414                                                 -S-
          general features .......................................103              Save As, File command.............................. 206
          grid..............................................................139    Save Button.................................................. 133
          grid setup.....................................................97        Save, File command ................................... 205
          interactive..................................................108         saving
          manual........................................................106          a file............................................................ 205
          miter ...........................................................111       a file to a name or location ................... 206
          modifying existing routes ......................113                        a pattern to a library ............................... 494
          options .......................................................125         ASCII file ........................................... 206, 207
          orthogonal modes ...........................108, 113                       AutoSave ................................................... 431
          overlapping connections .......................106                         ECOs .................................................. 200, 505
          placing keepouts .....................................458                  fields within a title block ......................... 82
          ploygons ....................................................105           files ............................................................... 31
          point-to-point ...........................................102              routing options........................................ 133
          selecting a tool ...........................................96           scale, print.................................................... 211
          setting options..................................429, 435                Scout
          setup .............................................................97      and DDE Hotlinks.................................... 196
          Status Line information ..........................103                    scroll bars....................................................... 14
          toolbar........................................................144         displaying.................................................. 447
          tools ..............................................................95   select actions............................................... 356
          trace cleanup ............................................105              copying objects ....................................... 357
          trace styles.........................................104, 412              drag and drop .......................................... 357
          T-routing ....................................................103          moving....................................................... 357
          unwinding routed segments...........18, 105                                resizing ...................................................... 357
        routing bias ....................................................35          rotating and flipping............................... 358
        Routing Commands                                                           Select All, Edit command .......................... 341
          Cancel ........................................................144       Select Highlighted, Edit command......... 342
          Help ............................................................144     Select, Edit command ................................ 356
          Info..............................................................142    selecting
          Options Display .......................................144                 block ............................................................ 21
          Pause...........................................................142        deselect ....................................................... 24
          Resume ......................................................143           embedded layers............................. 339, 356
          View All ......................................................141         filter (for object selection) .................... 423
          View Last....................................................141           items in a block........................................ 426
          View Log ....................................................143           mask parameters ..................................... 426
          View Redraw .............................................141               multiple ....................................................... 20
          View Status Line.......................................142                 objects ......................................... 19, 341, 356



596                                                                                                             P-CAD PCB User’s Guide
                                                                                                                                               Index


       Reference Point .................................25, 359                  layer box ................................................... 453
       Select Mode area.......................................23               Status Line, View command................. 9, 366
       selection commands...............................356                    stopping a macro ....................................... 552
       single ............................................................19   subselect .........................................................47
       sub select.....................................................20       swapping
     selecting objects, block...............................56                   pin and gate ............................................. 300
     Selection Mask dialogs..............................424                   swell
     Selection Mask, Options command .......423                                  plane .......................................................... 433
     Set Base Button ...........................................134              solder mask .............................................. 432
     Set By Attribute ...........................................349           symbols, drill............................................... 176
     setting                                                                   system
       point size ...................................................386         requirements ................................................3
     Setting up the Design ..................................33                  setup .......................................................... 429
       Grids .............................................................39
       Line Width...................................................39                                           -T-
       Options Configure....................................33                 T_routing.............................................. 112, 421
       Options Display .........................................38             tables
       Options Layers ...........................................35              drill ............................................................. 543
       Title Blocks..................................................36          note............................................................ 542
     Setup, Library command ...........................493                       revision note ............................................ 542
     Setup, Macro command............................551                       tabs
     setup, printer ...............................................215           Attributes, Component Properties .... 301,
     shortcut                                                                        303
       right-click mouse commands .................29                            Attributes, File Design Info................... 226
     ShortcutDirectory, Utils command ........532                                Class To Class, Options Design Rules 155
     showing or hiding points..........................387                       Component Pins, Component Properties
     shrink, paste mask ..............................432, 433                        .............................................................. 299
     signal layer....................................................451         Component, Component Properties . 299
       clearances..................................................460           Design, Options Design Rules............. 151
     silkscreen, violations (DRC) .............166, 518                          Fields, File Design Info .......................... 224
     single select                                                               Format, Customize Report dialog ....... 219
       on enabled layers ............................339, 356                    General, File Design Info ...................... 224
     slash                                                                       General, Options Configure ................ 429
       key...............................................................410     Layer, Options Design Rules ................ 152
       lines ............................................................418     Net Class, Options Design Rules ........ 154
     Snap to Grid, View command ..................367                            Net, Options Design Rules ................... 154
     snappy cursor ..............................................367             Notes, File Design Info .......................... 227
     software requirements ..................................3                   Pattern Pad, Component Properties... 297
     solder mask swell .......................................432                Pattern, Component Properties .......... 293
     SPECCTRA                                                                    Revisions, File Design Info.................... 228
       placement attributes...............................370                    Rooms, Options Design Rules ............. 153
       placement tool support .........................370                       Route, Options Configure .................... 125
     split plane                                                                 Selection, Customize Report ............... 220
       violations (DRC)...............................167, 518                   Sets, Options Configure........................ 453
     Status Information area...............................12                    Sort, Customize Report ......................... 221
     status line                                                                 Statistics, File Design Info ..................... 228
       information .................................................19         Tango PCB



P-CAD PCB User’s Guide                                                                                                                             597
Index


          features ..........................................................2         automatically......................................... 184
        target apertures ...........................................260                manually................................................. 184
        technology files                                                               N/C Drill ......................................... 183, 267
          browsing ....................................................232           code in N/C Drill ..................................... 268
          building the hierarchy ............................240                   Trace Clean-up, Utils command ............. 532
          copying to a design .................................232                 traces
          opening......................................................231           cleanup.............................................. 412, 418
          updating.....................................................232           curved................................................ 104, 412
        technology parameters..............................229                       routing curved ......................................... 108
        test point.......................................................376       translucent drawing................................... 447
          flipping...............................................376, 377          T-Route option............................................ 436
          online DRC................................................519            T-routing....................................... 103, 411, 417
          placing........................................................386       type swapping ............................................. 294
          printing ......................................................213
          report..........................................................217                                          -U-
          selection criteria ......................................427             unconnected pins (DRC) .................. 166, 518
          signal and plane layers ...........................377                   Undo, Edit command......................... 279, 280
        text                                                                       Unhighlight All, Edit command ............... 342
          changing display text ..............................483                  Unhighlight, Edit command..................... 341
          flipping...............................................328, 395          uniform grid spacing ................................. 440
          jumping to text .........................................364             unify value practice...................................... 55
          justification ...................... 303, 327, 330, 353                  units of measurement, changing ............ 430
          location ......................................................327       unrouted nets (DRC) ................................. 166
          properties ..................................................327         unwinding.................................................... 418
          rotating/flipping .......................................395                routes................................................. 105, 411
          selection criteria ......................................427             Update All, DocTool command .............. 549
          style                                                                    Update, DocTool command .................... 548
             deleting...................................................484        Updating Design Technology Parameters
             fonts.........................................................485     ........................................................................ 232
             properties...............................................484          user guide
             renaming ................................................484             layout ............................................................. 2
             TrueType Font .......................................482              user interface
          style, change .............................................328              menu bar....................................................... 6
          violations(DRC) ................................166, 518                    P-CAD PCB.................................................... 6
          zooming and panning.............................396                         prompt line................................................... 9
        Text Style Properties dialog ......................485                        status line...................................................... 9
        Text Style, Options command..................482                           Using the Zoom Window ......................... 363
        Text, Place command .................................393                   Utils Commands
        thermal apertures .......................................259                  Compare Netlist ...................................... 524
        Tile, Window command ............................563                          Customize................................................. 537
        Title sheets....................................................256           DRC ............................................ 164, 445, 506
        Titles...............................................................548      Export ECOs ..................................... 200, 505
        Titles, DocTool command .........................548                          Find Errors................................................. 519
        toolbars .............................................................6       Force Update............................................ 500
          custom toolbar .........................................366                 Generate Netlist ...................................... 523
        tools                                                                         Import ECOs .................................... 198, 503
          assigning                                                                   InterPlace/PCS ................................. 533, 537



598                                                                                                              P-CAD PCB User’s Guide
                                                                                                                                                Index


        Load Netlist...............................................520            View log
        Optimize Nets ..........................................525                 final board statistics................................ 408
        P-CAD Library Executive ........................532                         general ...................................................... 408
        P-CAD Pattern Editor ..............................532                      headers and footers ............................... 407
        P-CAD Schematic.....................................532                     layer settings ............................................ 408
        P-CAD Symbol Editor..............................532                        net classes................................................. 408
        Reconnect Nets........................................530                   pass
        Record ECOs ....................................198, 502                      performance ......................................... 408
        Renumber..................................................497                 settings................................................... 408
        ShortcutDirectory....................................532                  View Log, Route command ...................... 407
        Trace Clean-up.........................................532                View Snap to Grid
                                                                                    free-floating cursor................................. 367
                                        -V-                                         snappy cursor .......................................... 367
     verification of a netlist .................................70                visible routing area .................................... 123
     vertical
       alignment ..................................................340                                             -W-
       routing pass ..............................................137             warning messages...................................... 571
     via ...................................................................419   wide line routing ........................................ 136
       location ......................................................312         width violations(DRC)....................... 166, 518
       minimization.............................................138               window............................................................13
       placing connections................................377                      selecting a................................................. 564
       properties..................................................311            Window Commands.................................. 563
       selection criteria ......................................427                Arrange Icons .......................................... 564
       setting up a style........................................99                Cascade..................................................... 563
       style hole range........................................482                 New Window ........................................... 563
     Via Style, Options command ...................482                             Tile.............................................................. 563
     Via, Place command ...................................380                    workspace
     View Center                                                                   setting size...................................................33
       Autopan .....................................................362            size ....................................................... 13, 430
     View Commands...........................................13
       All 14, 362                                                                                                 -X-
       Center ..................................................14, 362           X and Y distance, measuring.................... 355
       Command Toolbar ..................................365
       Custom Toolbar .......................................366
                                                                                                                   -Z-
       Extent....................................................14, 361          Z Routes (2 vias).......................................... 137
       Jump Location ....................................14, 363                  zoom
       Jump Text ............................................15, 364                commands ...................................................13
       Last..............................................................362          zoom in/out..............................................13
       Placement Toolbar ..................................365                        zoom window..........................................14
       Prompt Line ..............................................366                factor.......................................................... 432
       Redraw .................................................14, 361              level
       Route Toolbar...........................................365                    View All is default ................................ 362
       Snap to Grid........................................19, 367                  window...................................................... 363
       Status Line .................................................366           Zoom In, View command......................... 362
       Zoom In .....................................................362           Zoom Out, View command ..................... 363
       Zoom Out..................................................363              Zoom Window, View command ............. 363
       Zoom Window .........................................363



P-CAD PCB User’s Guide                                                                                                                              599
P-CAD PCB User’s Guide   600


==========================================
FILE: Signal_IntegrityWP.pdf
==========================================

Signal Integrity Basics
By Anritsu Field Application Engineers
TABLE OF CONTENTS



1.0   Bits, Bytes and Hertz

2.0   Eye Patterns

3.0   Pulse Composition

4.0   Common Causes of Pulse Distortion

5.0   Measurements




Introduction

Digital Signal Integrity (SI) can be described simply as the study of pulse distortion. Historically,
pulsed signals were measured with an oscilloscope or digital signal analyzer. With the advent of
today’s Gigabit data rates, Bit Error Rate Testing (BERT) has become the measurement of choice.
Since PC‘s are targeted to reach eight Gigabits per second (Gbps) in the near future, the digital
community has been forced to solve the types of analog problems that RF/MW engineers live
with on a daily basis. Therefore, measurements such as SWR, insertion loss, leakage between
printed tracks and delay times, have become parameters that now must be evaluated by digital
designers to assure “pulse fidelity.” Testing is further complicated by the fact that balanced lines
and circuits are used to reduce interference. And, when many complex circuits are compressed
onto a multilayer PC board, the difficulty increases. On top of that, it is a challenge to contact the
desired point on the circuit, since it may be accessed only by using destructive procedures. Test
connectors located at strategic points in the circuit offer one solution; however, they not only
occupy valuable real estate, they may introduce their own set of problems.

Bits, Bytes and Hertz

The Frequency (Hz) is the speed of the pattern at 1 cycle / second in the frequency domain, while
the bits are a logical 1 or 0 in the pattern itself, measured as 1 bit / second within the time domain.
Without any modulation or compression, 1 Hz = 1 bit, so 100hz is equal to 100 bits/. However,
this is not always the case. For example, 100BASE-TX has a specified data rate of 100 Mbits /
second and operates at 33 MHz. This is because 100BASE-TX uses compression. Hertz and bits
can be interchangeable and it is possible to go back and forth mathematically between the
frequency and time domains with the Fast Fourier transform. Test tools, such as network
analyzers, perform these calculations.




                                                                                                    1
Of course, in this high-speed world, these basic units become Gigabits, Gigabytes, and Gigahertz.
A path capable of passing 8 GHz with minimal roll-off will be able to pass a clock rate of 16 Gbps.
This equates to two Gigabytes per second, since a nominal byte has eight bits. Figures 1, 2 and 3
illustrate how logic circuits must distinguish “1”s from “0”s:




         .
                                             Figure 1.

                                        Good pulse pattern.




                                             Figure 2.

                                     Acceptable pulse pattern.




                                                                                                 2
                                              Figure 3.

                                         Poor pulse pattern.

Eye Patterns

An eye diagram is the result of superimposing the 1’s, 0’s and corresponding transitions of a high-
speed digital signal onto a single amplitude, versus time display. As shown in Figure 4, the
resulting waveform resembles an eye, hence the name eye diagram. The time axis can be
normalized for 2 bits (as shown) for easy viewing, with the 1-bit “eye opening” in the center of the
display and one-half bit on both left and right of the center eye (for viewing transitions).

        Transitions in the digital signal that infringe on the center of the eye can eventually cause
        errors.
        In general, the more open the eye, the lower the likelihood that the receiver in a
        transmission system may mistake a logical 1 bit for a logical 0 bit, or vice versa. The
        percentage of bits that have errors compared to the overall bits is called Bit Error Ratio
        (BER); the lower the BER the better.
        It’s important to note that the eye diagram does not show protocol or logic problems.
        Using this eye diagram, we can easily view signal impairments in the physical layer – in
        terms of amplitude and time distortion.




                                                                                                    3
       Figure 4.

   Ideal eye pattern.




       Figure 5.

Acceptable eye pattern.




                          4
                                             Figure 6.

                                         Poor eye pattern.

Pulse Composition (X axis is time)

An ideal rectangular waveform is formed by adding odd multiples of a sine wave at the data rate.
(To be exact, it is formed by summing 1/N of the amplitude of N multiples of the harmonic.)


 Repetitio
 n                                   Only Ref
 Freq                                Freq

 ３x Freq
                                     Ref Freq +
                                     3x

 5x Freq
                                     Ref Freq + 3x +
                                     5x         Gradually changes from sine wave
                                                  to rectangular waveform as more
                                                  components are added




                                             Figure 7.

                               Composition of a pulse from sinusoids.

When the N multiples of the frequency components are superimposed, the Sine wave gradually
changes to a rectangular waveform. The high frequency components determine rise time, the
point where 0 becomes 1 and 1 becomes 0. Lower frequencies make up the “flat top.” The
transition becomes sharper, as seen by the green arrows in Figure 7, as more components are
added. When viewed on a spectrum analyzer, the individual spectral lines described above can
be seen clearly (Figure 8). It is a pulse composition (X axis is frequency) shown on a Spectrum
Analyzer:


                                                                                                  5
                                                 Figure 8.

                       Spectral lines are spaced by the pulse repetition frequency;
                       The faster the rise time, the wider the occupied bandwidth.

Common Causes of Pulse Distortion

Dispersion

As the signal above passes through a micro-strip line, all of the spectral lines do not propagate at
the same rate. This is called dispersion. Since the individual spectral lines do not propagate at the
same rate, they do not arrive at the termination at the same time. This causes pulse distortion.

Attenuation / Loss (reduction of signal level)

                                                                                         2
At the Gigabit rates in use today, PC board tracks can have appreciable copper loss (I R), skin
effect (loss due to the microwave portion of the signal traveling only on the surface of the trace),
as well as dielectric loss (absorption of energy due to substrate material). These are all frequency
dependent losses. Loss can reduce the level to the point where a “one” is below the trigger point.
Longer paths and higher frequencies lead to predictably greater losses. Figure 9 shows the
frequency characteristics of a PC board. The x-axis is frequency and the y-axis is attenuation in
dB.




                                                                                                   6
                    High frequency         Increased attenuation               Small amplitude

                     0.0                                 Attenuation increases as
                                                         frequency increases
                     5.0
 Attenuation (dB)




                                                                        Amplitude is reduced by
                    10.0                                                half at 5 GHz (6dB).

                    15.0


                      0.0   2.0      4.0       6.0      8.0      10.0     Frequency (GHz)

                                                     Figure 9.

                                       Pc board track loss versus frequency.

As a consequence of utilizing low-cost but lossy FR4 materials – which have become widespread
recently – a transmission technology known as pre-emphasis is employed. Emphasis improves
the eye pattern by increasing the amplitude at the      and      changeover point – high
frequency components. These are overemphasized with respect to the low frequency
components. Emphasis can only be applied to predictable distortion. Noise and cross talk are
examples of non-predictable distortion. This technique is covered in greater detail in the
Measurements section.

Noise

Noise is present in every electronic device. For example, when the input to a TV is disconnected,
audible noise is heard. The same mechanism displays “visible” noise on the screen of the TV as
random sparkling colors. Noise covers a wide frequency range instantaneously and, in actuality,
is called white noise. Well-designed systems have sufficient noise margins, called signal-to-noise
ratio. The higher the ratio, the better the system immunity to noise. As a digital signal becomes
attenuated and approaches noise level, the trigger point becomes unstable. Appreciable noise on
the clock will manifest itself as jitter. Noise is asynchronous and should not be confused with
linear power supply regulator ripple (60 or 120 Hz). When systems incorporate switching
regulators, the chop rate can appear as noise on the lines – DC power lines as well. However,
these waveforms can be viewed and synchronized on an oscilloscope, whereas white noise
cannot be synchronized. Radiated noise, which comes from diathermy and auto ignitions, can
also affect a data stream, the topic falls under the domain of engineers working in the field of
Electromagnetic Compatibility (EMC).

Standing Wave Ratio

Standing Wave Radio (SWR) was originally the domain of antenna designers; however, any high
frequency generator (i.e., chip output), conducting medium (track) or a load (the following chip
input), must all be impedance-matched to transfer maximum power. While logic circuits are not
dependent on transferring maximum power, when maximum power is not transferred, the portion
that is not transferred is reflected back to the source, causing standing waves. The result of SWR
on a pulsed signal is ripple on the “flat top.” Ripple can cause false triggers, as seen in Figure 10.




                                                                                                     7
When laying out a circuit, the shortest distance between chip outputs and inputs, as well as their
return paths, should be kept as short as possible with reference to wavelength. Each of the
frequencies which make up the pulse has its own wavelength (velocity / f). This means that a
small percentage of a wavelength at the Bit Rate will be a much higher percentage of a
wavelength at the higher order components of the Bit Rate. For instance, a .05 wavelength
(velocity / “Bit Rate”) represents a .25 wavelength at the fifth harmonic. Since each spectral line
has its own SWR, swept frequency SWR measurements are required across the range of
frequencies – which is five to ten times wider than the data rate. SWR data is in linear terms.
Corresponding data in logarithmic terms is Return Loss (dB). Standing waves may be generated
when test connectors are added for the purpose of troubleshooting. Prototypes may be built with
strategically located test connectors that can be removed in production units. Refer to:
http://www.fourier-series.com/rf-concepts/flash_programs/Reflection/index.html for an in depth
view of SWR. If this is a soft copy, it can be accessed by pointing the mouse at the link, pressing
control and left click. Otherwise, follow normal web access procedure.


Insufficient Bandwidth

As demonstrated in Figure 10, a pulse applied with a fast 0 → 1 transition that has a clean flat top
may be highly degraded when it passes through a band limited device or filter. This degradation
manifests itself as ripple and slower 0 → 1 rise time. If the ripple is of sufficient amplitude, it may
appear as false transitions to high-speed circuitry.




                                              Figure 10.

                                    Ripple can cause false transitions.
                     (Data taken with Anritsu 37397 VNA in time domain step mode.)




                                                                                                      8
                                                Figure 11.

                                      Ringing effect on eye pattern.

Cross Talk

As a consequence of micro-strip tracks or unshielded balanced cables in close proximity to each
other, undesired coupling (known as crosstalk) occurs. This is due to capacitive coupling and
inductive coupling along the lines. Maintaining several line widths of physical separation on the
board is ideal, but difficult to implement, since space is always at a premium. Printing grounded
areas between the tracks or adding ground vias provide a measure of decoupling of the “E” fields,
but also requires additional board space. Parasitic coupling can occur anywhere along a line;
however, the end terminations are especially problematic. This is referred to as Near End Cross
Talk (NEXT) and Far End Cross Talk (FEXT). NEXT and FEXT are in respect to the port to which
the stimulus is applied. In actuality, crosstalk can occur anywhere along a line, whether it is
balanced or unbalanced. For example, Figure 12 shows an unbalanced line with the required
connections to measure NEXT and FEXT simultaneously.




                                                Figure 12.

               Closely spaced parallel micro-strip lines can couple signals unintentionally.




                                                                                               9
Cross talk is generally specified as a percentage of the signal that appears on the relative victim
line, relative to the aggressor line. It can also be expressed in terms of db below the driven line
level. When using a VNA to perform this measurement, the frequency span should be the same
as the intended use for the path under test – so leakage levels will be accurate. This subject is
discussed further in the Measurements section of this paper.

Balanced Conductors

Balanced lines provide rejection of external fields and have minimal radiation in accordance with
the Figure 13:




                                               Figure 13.

                               Effect of external fields on balanced pair.

Slight imperfections in the lines due to manufacturing tolerances and nearby metallic objects
distort the fields, so the common mode signal is never zero. The degree to which cancellation is
accomplished is known as the Common Mode Rejection Ratio (CMRR). Despite these
imperfections, balanced lines are commonly used to interconnect devices, boards and layers. An
added benefit of using balanced geometry is that ground planes are not required to maintain
characteristic impedances, which would be the case if unbalanced micro-strip geometry were
employed.

Modeling a simple Gigahertz micro-strip balanced transmission line is difficult enough on its own;
creating a model for a complex back plane is even more difficult. Shielding, grounding and
physical location of lines and components present a set of hurdles for those tasked with laying out
multilayer boards. A characteristic impedance of 100 Ohms is common in the industry. In the
absence of 100 Ohm balanced test equipment, conventional microwave test equipment can be
used (since each line is 50 Ohms to ground).

High Speed Balanced Links such as OC768 (40 Gbps) and OC192 (10 Gbps) are examples of
systems that use balanced circuitry. Extremely wide band signals can be distributed with lower
frequency cables by driving multiple parallel paths at lower rates and then combining them. For
instance, a 40 Gigabit system can utilize four parallel 10 Gigabit paths. Where this is done, care
must be taken to ensure that the propagation time through the various paths is the same. The
difference in propagation time is called skew.




                                                                                                  10
Skew

In systems where parallel paths are used to increase speed, all paths must have the same
propagation time. If the connecting medium is coaxial cable, tight control of mechanical length
and dielectric tolerances will produce minimal problems with skew. However, when balanced
twisted pairs are the conducting medium, the number of turns per inch is a critical factor in
determining propagation time. Commercial CAT5e/6 cable can have as much as 10 nanoseconds
of skew between the paths in a one hundred foot run. This equates to as much as ten feet of
electrical length within the same cable!

Mode Conversion (Balanced to Common Mode)

Whenever there is imbalance in a balanced system, the fields no longer completely cancel, which
causes them to radiate in proportion to the imbalance. Similarly, external fields can induce
currents in a balanced pair that are not equal in amplitude and opposite in phase, so they no
longer cancel. The resultant current is called common mode current, which produces cross talk.

On multilayer PC boards, “Vias” are used to pass the signal from one layer to another. While they
are designed to make a seamless transition, they do not. Therefore, a portion of the signal is
reflected back to the source. In a balanced system, if the two reflections are not identical, mode
conversion is introduced. Differential end connections are another area where SWR is a problem
and where mode conversion may take place. Again, whenever there is imbalance in a balanced
system, the fields no longer completely cancel, which causes them to radiate in proportion to the
imbalance. In unbalanced circuits, undesired coupling between tracks is also problematic.

Measurements

RF/MW Measurement Overview

Unbalanced Interconnect Measurements are taken by using one of two instruments, a Time
Domain Reflectometer (TDR), which uses a fast rise time pulse as the stimulus, or a Vector
Network Analyzer (VNA), which uses a series of sine waves that are swept across a wide
frequency range as the stimulus. Both are capable of displaying characteristic impedance
/reflection coefficient with a single-port measurement. The TDR is a more straightforward
instrument to use than the VNA; on the other hand, the VNA is more versatile and can acquire
and display additional information over a wider amplitude range, but comes at a higher cost. Data
can be displayed in the frequency domain or time domain acquired with either the TDR or VNA.

Time Domain Reflectometer (TDR)

The original instrument used to display reflection coefficient / impedance versus distance was the
TDR, which supplies a fast rise time stimulus pulse to the path under test and displays the
amplitude of the return signal versus time. In order to measure distance accurately, the
propagation velocity or dielectric constant must be entered into the instrument. The display
provided by a TDR is the same as shown in Figure 14.

Vector Network Analyzer (VNA)

Since it measures both phase and amplitude, the VNA has significantly more dynamic range and
better resolution than the TDR. Figure 14 shows a section of 25 Ohm line in the same manner as
a TDR.




                                                                                               11
                                             Figure 14.

                 Impedance versus distance measurement of a section of 25 ohm track.

In addition to Time Domain measurements, the VNA is capable of performing measurements
known as “S” parameters. This is a shorthand method to fully characterize a two-port linear
device – active (amplifiers) or passive (cables and printed lines) in terms of transmission and
reflection. “S” parameter nomenclature follows the following convention: The first digit after the
“S” is the analyzer port at which the signal is measured in magnitude and phase. The second digit
is the analyzer port from which the signal emanates.

S11 - Input Reflection in linear terms (SWR) or dB (input return loss)
S21 - Forward Transmission – Gain / Loss in linear terms or dB
S12 - Reverse Transmission – Gain / Loss in linear terms or dB
S22 - Output Reflection in linear terms (SWR) or dB (output return loss)

SWR data taken from “S” parameter measurements indicates the quality of the line. The location
of mismatch, reflection or fault (in terms of distance from the stimulus port) is derived from the
S11 after applying the Inverse Fourier Transform. The calculation uses amplitude and phase to
calculate time; therefore, these measurements are referred to as Time Domain measurements,
even when the “X” axis has been converted to distance. As with the TDR, time measurements are
as accurate as the instrument time base, but for distance to be accurate, the propagation velocity
or dielectric constant of the medium under test must be entered. In the Time Domain mode, the
VNA displays the real part of impedance (Ohms) versus distance like the TDR. To produce a
TDR type display, the stimulus consists of a series of harmonically-related sine waves that are
swept over a wide frequency range and applied to the path under test through the desired test
port. Reflections are measured at the same port. When the Inverse Fourier transform (IFFT) is
applied to this frequency, domain data is displayed as time / distance. Simply put, the pulsed
spectrum display in Figure 8 is approximated by the VNA and is plotted as a mathematically
derived pulse. The rise time of this derived “pulse” is the reciprocal of the frequency span. Note
the VNA-generated spectral lines are all the same amplitude, not the Sine X /X shown in the
spectrum display. Rise time is a critical parameter that dictates the minimum spacing between
two discontinuities that an instrument can resolve. Wide bandwidth VNA’s (110 GHz) can produce
an equivalent rise time of 9 picoseconds, whereas current TDR’s are limited to 25 Psec. Bench
top VNA’s can have as much as 70 dB more dynamic range than a TDR, so the smallest
discontinuity can be detected. Hand-held VNA’s have slightly higher dynamic range than the TDR.
While low-level discontinuities alone will not impact pulse performance, a series of smaller
reflections can add at one or more frequencies to significantly degrade the SWR, thus distorting
the pulse. For best results, discontinuities should be corrected – beginning with the largest and
working down to the smallest.




                                                                                               12
Another type of time domain measurement is Time Domain Transmission (TDT), a two-port VNA
or TDR measurement that displays the location of the coupling, as well as the level of the cross
talk. Bear in mind that the amplitude displayed in VNA TDR and TDT mode is the average of all
the frequencies to which the IFFT was applied.

Differential VNA Measurements

Differential VNA Measurements (See Figure 15) require a four-port analyzer, using the
terminology listed below. The data can be acquired either with a VNA four-ports (two balanced
pairs) or with a four-port VNA that uses four unbalanced measurements and the superposition
theorem applied to calculate balanced measurements. The theorem provides accurate data,
provided the device under test is in its linear region.




                                            Figure 15.

Sixteen parameters (See table below) are required to describe the various combinations of
differential and common mode signals, which may be used to characterize a balanced path.
Unbalanced VNA measurements are taken with the analyzer connected as shown below, then
calculated to determine balanced characteristics.

        PARAM.           Meas.                   Stim. Port*   Meas. Port*
        SD1D1           Return loss               P! Diff         P! Diff
        SD1D2           Rev Transmission         P2 Diff          P! Diff
        SD1C1           Return loss               P1 Com          P! Diff
        SD1C2           Rev Transmission          P2 com          P! Diff
        SD2D1           Fwd Transmission          P1 Diff         P2 Diff
        SD2D2           Return loss               P2 Diff         P2 Diff
        SD2C1           Fwd Transmission          P1 Com          P2 Diff
        SD2C2           Return loss               P2 Com          P2 Diff
        SC1D1           Return loss               P1 Diff         P1 Com
        SC1D2           Rev Transmission          P2 Diff         P1 Com
        SC1C1           Return loss               P1 Com          P1 Com
        SC1C2           Rev Transmission         P2 Com           P1 Com
        SC2D1           Fwd Transmission          P1 Diff         P2 Com
        SC2D2           Return loss               P2 Diff         P2 Com
        SC2C1           Fwd Transmission          P1 Com          P2 Com
        SC2C2           Return loss               P2 Com          P2 Com


Common mode STIM indicates that the signals on both conductors are calculated to be in phase
with each other – and common mode MEAS is calculated as though the received signals are in
phase with each other. SD1D1 as well as SD2D2 with the inverse Fourier transform applied
become the balanced TDR response. These special cases can be measured with a two-port VNA
and special software.


                                                                                                13
Cross Talk

Cross talk is the undesired coupling between lines in unbalanced configuration and pairs of lines
in a balanced configuration. Ends of the track or cable not being tested must be terminated in the
characteristic impedance of the line (nominally 100 Ohms). NEXT and FEXT can be measured
simultaneously, as shown in Figure 16 .The addition of quality baluns to a two-port VNA provides
another means to generate and receive balanced signals. In this configuration, NIST traceable
fifty Ohms (to ground) calibration components can be used to calibrate the VNA. Figure 16 shows
NEXT and FEXT measurements of a standard CAT 5 cable with RJ45 connectors. When
measuring FEXT, the analyzer’s signal must travel the length of the cable and then return back to
the analyzer. Since the analyzer measures round trip time, in this mode the measured time must
be divided by two (when calculating the distance to the origin of the cross talk).




                                              Figure 16.

                         Simultaneous NEXT and FEXT measurement set-up.




                                              Figure 17.
                              Effect of far end reflection on cross talk.



                                                                                               14
Jitter Testing

Jitter testing (also called Timing Jitter) is of growing importance to SI engineers, due to the
industry trend of increased clock frequencies in digital electronic circuitry. Higher clock
frequencies have commensurately smaller eye openings, and thus impose tighter tolerances on
jitter. For example, modern computer motherboards have serial bus architectures with eye
openings of 160 picoseconds or less. This is extremely small compared to parallel bus
architectures with equivalent performance, which may have eye openings on the order of 1000
picoseconds. Major contributors to jitter are: thermal noise, cross talk and “noisy ground
connections.” They all cause signal instability at the trigger point form pulse to pulse. Jitter can
artificially be injected into the system to test jitter tolerance.

Bit Error Rate Testing (Bit Error Rate Tester)

Progress in Gbps-class interconnects is causing a stir in other application fields, such as
supercomputers that require massive computational power. However, achieving Gbps-class
speeds in future equipment is not just a matter of using Gbps devices, it also requires quick
adoption of technologies that support high-speed processing for PC boards (PCBs).
Consequently, various Gbps-class standards have been adopted to achieve high-density, high-
speed PCBs.




                                                   Figure 18.




                                                   Figure 19.

                 Example of insertion / omission errors from an internally-generated pattern.

                  Error detection (total error (c), insertion error (d), and omission error (e)).

Insertion/omission - counts errors where the bit pattern changes between 0 and 1. Insertion error: an error
where the bit pattern changes from 0 to 1omission error: an error where the bit pattern changes from 1 to 0.




                                                                                                         15
                                          Figure 20.

     Example of transition/non transition errors from an internally-generated pattern.

     Error detection (total error (c), transition error (d), and non transition error (e)).

  Transition/non transition - counts errors that occur in a transition or non-transition bit.




                                          Figure 21.

                Insertion (Ins) Omission (Omi) bit error rate measurement.

BERTS: Data Pattern Dependency Frequency characteristics impact the frequency
components included in the transmitted pattern itself.


          ①                                               ←Pattern reversed every 1 bit


          ②                                               ←Pattern reversed every 2 bits

Example includes higher frequency components than example . As a result, pattern
tends to have smaller amplitude than pattern . In an actually sent pattern, the 1 and 0
reversal occurs at various timings so the pattern includes many frequency components.




                                                                                                16
BERTS: Pre-Emphasis (which is commonly used in IC design, simulation, and de-
emphasis is often used in test and validation vocabulary) results in the same waveform
shape. The difference in terminology can be explained as follows: de-emphasis considers
the second bit in a series of ones or a series of zeroes to be attenuated, whereas pre-
emphasis considers the first bit as sent with larger drive level.

Boosting the amplitude of the first bit of a series of one or more identical bits has the
effect of increasing spectral energy at high frequency. This boosting helps to counteract
the high frequency loss of circuit board transmission lines. The result is a far-end eye
diagram that is less distorted, due to the effects of Inter Symbol Interference (ISI).

An increasing number of high-speed serial bus standards require the use of transmitter
pulse shaping such as pre-emphasis. High frequency transmission paths, as used in
printed circuit boards, experience high signal loss. When a Non-Return-to-Zero (NRZ)
signal is transmitted without pulse shaping, there are problems with a drop in the signal
level at the receive side and increased pattern-dependent jitter. Pre-emphasis is used to
solve these problems because it increases the amplitude of the first bit at the transmit
side where the data changes.




                                    Figure 22.

                   Effect of Pre-Emphasis on Pulse Leading Edge

When using two PPG modules to generate pre-emphasis signals, each PPG can have
variable phase for data output. Adjust the phase between clock and data in a full band:
±1 UI (1-mUI steps) under independent mode. Further, if two PPG modules are used and
set in Channel Synchronization mode, 64 UI can be adjusted between the data output of
the two PPG modules. In MP1800A, multiple PPG synchronous control easily makes the
phase adjustment. In addition, when adjusting the data output amplitude on each PPG
module and the phase between the data output of PPG modules, multiple PPG modules
may be used to generate multi-level signals. Finally, the test pattern on each PPG
module may be programmed up to 128 MBits.




                                                                                        17
                                               Figure 23.

                                 Effect of pre-emphasis on data stream.
Additional Test Equipment

General-purpose test equipment (such as oscilloscopes and spectrum analyzers) is not
discussed here, but does have utility to perform specific tests. Keep in mind their bandwidth and
characteristic impedance when connecting them to the circuit.

Skew

Skew is an electrical length measurement and is easily done with a TDR or VNA. Where both
ends of the cable are available (prior to installation), it becomes a straightforward insertion phase
measurement. After installation, reflection phase or TDR techniques can be used to measure
differences in propagation time. For this measurement, the far end is shorted, so a high reflection
is presented to the instrument. This makes it easy to find for comparisons of round trip time.
Round trip time must be divided by two, either offline or within the measuring instrument. All
Anritsu instruments perform the divide by two, by default in time domain reflection mode.

Conclusion

As seen in Figure 23, designing a system for Signal Integrity requires a great deal of knowledge
and tremendous effort from all disciplines involved. Painstaking modeling will improve the
situation, but implementation is the key to designing a successful system. If Signal Integrity is not
of prime concern from concept through production, the result may require a costly redesign.
Addition of test connectors simplifies testing at the cost of additional real estate, but the inclusion
of test points with pitch suitable for wafer probing makes for non-destructive troubleshooting with
minimum perturbation of the circuit.

Both the package design and design verification stages require a multichannel BERTS that
supports pattern synchronous measurements. BERTS is needed to verify the logic and package
designs from the perspective of: the effects of signal separation; wiring lengths; adjacent signal
crosstalk; PCB frequency characteristics; and other aspects of output waveform quality. Currently,
there are increasing problems with reduced transmission quality resulting from adjacent signal
effects in multilane PCBs, as well as problems with establishing compatibility. In addition, high-
density designs are experiencing drift, due to differences in lane wiring lengths, as well as drift in
paired differential signals. In high-speed signal transmission, frequency and data-pattern
dependencies cause worries about reduced waveform quality. As a result, it is no longer sufficient
to perform evaluations by measuring the BER, jitter and waveform quality of each lane
independently. Today’s high-speed, multi-lane serial communications standards require total
evaluation of multi-lanes using a multichannel BERTS to perform quantitative measurements – as
well as RF/MW instrumentation that improves pulse performance.


                                                                                                     18
©
Anritsu   Signal Integrity Basics White Paper_2009-04134 -09




                                                  19


==========================================
FILE: Signal_and_Power_Integrity_Practices.pdf
==========================================

Signal and Power Integrity
     Design Practices
          Csaba SOOS
           PH-ESE-BE
Outline
• Introduction
• Signal and interconnect bandwidth
• Time and frequency
      • Scattering parameters
• Transmission lines
      • Theory
      • Losses, ISI, discontinuities, crosstalk, mode conversion
• Power Delivery Network
• Related activities in the group


PH-ESE seminar, 9/6/2015   Csaba SOOS, Signal and Power Integrity Design Practices   2
Introduction
• High-speed design challenges:
      • Front-end electrical links: very light cables and flexible circuits
      • Readout and control systems: complex FPGA boards, backplanes
• Data rate from 100’s of Mbits to 10Gbits per sec per channel
      • Maximum speed increases rapidly in back-end systems, >10Gb/s soon
• Design iterations cost money and take extra time (=money)
• Activities in the group offer the possibility to gather, share and preserve
  know-how
                            High-speed boards




 HDI on flex                                                                Crate systems
PH-ESE seminar, 9/6/2015   Csaba SOOS, Signal and Power Integrity Design Practices          3
Sources
• Istvan Novak’s courses
      • Signal Integrity: Advanced High-Speed Design and Characterization
      • Power Distribution Design
• Eric Bogatin’s courses
      • Essential Principles of Signal Integrity
      • Advanced Gibabit Channel Design
      • http://www.bethesignal.com/bogatin/
• Eric’s book
      • ISBN-13: 978-0132349796




PH-ESE seminar, 9/6/2015   Csaba SOOS, Signal and Power Integrity Design Practices   4
Signal bandwidth

                                                                                                        A = Vhi - Vlo

• Time domain: periodic signal (e.g. clock)                                            tr         tf
                                                                                                                        Vhi

      • Period, T                                                                           DT            (1-D)T


      • Rise/fall times, tr/tf                                                   Vlo

      • Duty cycle, D                                                                        T = 1/Fo



• Time-domain to frequency domain using Fourier
  transformation
• Spectrum of an ideal square wave (D=0.5, tr/tf = 0)
      • DC (0th harmonic) + infinite odd harmonics (1,3,5…)
      • Amplitudes decrease with 1/f (-6dB/octave), An=(2 x A)/(π x n)




PH-ESE seminar, 9/6/2015   Csaba SOOS, Signal and Power Integrity Design Practices                                            5
Signal bandwidth

• Trapezoidal signal (duty cycle D, tr/tf > 0)
• DC (0th harmonic) + infinite harmonics                                   log              -6dB/octave
                                                                           G(f)
• If D is not 0.5, we have even harmonics                                                                 -12dB/octave

  too
• First corner frequency (f1) depends on the                                      f0   f1           f2          log f
  duty cycle, but has less impact than
  rise/fall times
• Second corner frequency (f2) depends
  ONLY on rise/fall times, f2 = 1/(π x tr)




PH-ESE seminar, 9/6/2015   Csaba SOOS, Signal and Power Integrity Design Practices                             6
Signal bandwidth
• How many harmonics should be preserved ?
• First approach
      • Use only harmonics which are more than 70% of the amplitude (-3dB) of
        the equivalent ideal square wave => e.g. up to 5th harmonic
• Second approach
      • Sum up harmonics until the rise/fall time reaches required value =>
        BW=0.35/tr(10-90), or BW=0.22/tr(20-80) which is about the same as the
        second corner frequency
• Do not use higher bandwidth than required, because it costs money




PH-ESE seminar, 9/6/2015   Csaba SOOS, Signal and Power Integrity Design Practices   7
       Bandwidth of the interconnect
       • The bandwidth definition is subjective
             • Highest sine-wave frequency at which the interconnect still meets the
               specs.
       • We typically use -3 dB => 70% of the incident amplitude
       • Bandwidth limitation increases rise time
                                                𝑅𝑇𝑜𝑢𝑡 =     𝑅𝑇𝑖𝑛 + 𝑅𝑇𝑐ℎ𝑎𝑛𝑛𝑒𝑙
       • To quantify, we can use the frequency dependent Insertion Loss of the
         interconnect


log                -6dB/octave                             log
G(f)                                                       H(f)
                                  -12dB/octave

                                                   +                                                  = ?

       f0     f1           f2           log f                                                   f

       PH-ESE seminar, 9/6/2015             Csaba SOOS, Signal and Power Integrity Design Practices         8
Time-domain and frequency-domain
• Time-domain is our real world where the design has to meet
  the specifications
• Frequency-domain is a mathematical ‘world’ where we can
  solve some problems faster than in the time-domain
• Different interpretations of the SAME thing
• Fourier transform links the two domains

                                                  FT

                           Time                                   Frequency

                                                 IFT




PH-ESE seminar, 9/6/2015   Csaba SOOS, Signal and Power Integrity Design Practices   9
Scattering or S-parameters
• Behavioural model of N-port linear electrical networks
• Frequency domain description
      • Sine wave in, sine wave out
• Inherited from RF and now widely used by SI/PI engineers
       a1
                                                                                   2-port network
       b1           N-port
                               aN
                                                  Sij                            𝑏1   𝑆      𝑆12 𝑎1
                   Network                                                          = 11
                                                                                 𝑏2   𝑆21    𝑆22 𝑎2
                               bN           output      input
                                                                                 𝑏1 = 𝑆11 𝑎1 + 𝑆12 𝑎2
                                                                                 𝑏2 = 𝑆21 𝑎1 + 𝑆22 𝑎2
                𝑏 = 𝐒𝑎


PH-ESE seminar, 9/6/2015     Csaba SOOS, Signal and Power Integrity Design Practices                    10
S-parameter plots (frequency
domain)




       • S11 should be large negative number if the port is matched to the reference impedance
       • Mag(S21) shows the frequency dependent loss (FOM dB/inch/Hz)
       • Ang(S21) should start from 0 and decrease with increasing frequency (saw tooth)




PH-ESE seminar, 9/6/2015      Csaba SOOS, Signal and Power Integrity Design Practices            11
S-parameters (time domain)
S parameters can be converted back to time domain (IFFT). Some artifacts may
appear if the S parameter data does not meet certain criteria.




     Impedance (TDR)                     Step response (TDT)                    Impulse response (TDT)




PH-ESE seminar, 9/6/2015   Csaba SOOS, Signal and Power Integrity Design Practices                       12
Mixed-mode S-parameters




       Single-ended S parameters can be converted to mixed-mode S parameters
       to describe differential signals.




PH-ESE seminar, 9/6/2015   Csaba SOOS, Signal and Power Integrity Design Practices   13
Transmission line
• Critical part of the channel that connects the source (driver) to the
  destination (receiver)
• It can be described with its electrical characteristics: Z0, tpd, loss, etc.
      • Do not uniquely determine the geometry (no solution or many solutions)
• Typical aspect ratio (trace width/dielectric height) of 50 ohm
  traces: from 2 (microstrip) to 1 (stripline)

                                                          ∆𝑅 + 𝑗𝜔∆𝐿               𝛾=        (∆𝑅 + 𝑗𝜔∆𝐿)(∆𝐺 + 𝑗𝜔∆𝐶)
                                                   𝑍0 =
                                                          ∆𝐺 + 𝑗𝜔∆𝐶                       𝛾 = 𝛼 + 𝑗𝛽 = 𝛼 + 𝑗𝜔𝑡𝑝𝑑

                                                                Lossless case (R = 0, G = 0)
                                                                                     𝑡𝑝𝑑 = 𝐿𝐶
 Equivalent circuit of a TL segment, length = Δx                    𝐿                  𝑙       𝑐
                                                            𝑍0 =                 𝑡𝑝𝑑 = , 𝑣 =
                                                                    𝐶                  𝑣      𝜀𝑒𝑓𝑓



PH-ESE seminar, 9/6/2015        Csaba SOOS, Signal and Power Integrity Design Practices                       14
  Losses, resistive vs. dielectric




Standard FR4 dielectric, Dk=4.3, tanδ=0.02              Better dielectric, Dk=3.7, tanδ=0.002
h=150um, w=250um, Z0 ~ 50 Ohm                           h=150um, w=300um , Z0 ~ 50 Ohm
dielectric loss dominates above 900MHz                  conductor loss dominates, wasting the expensive dielectric
                                                        with tight coupling and surface roughness it gets worse
Surface roughness of the conductor increases the resistive loss at higher frequency. Use wider
traces to reduce the impact.
                     1
𝑎𝑡𝑡𝑒𝑛 𝑑𝐵 𝑖𝑛 ~                𝑓[𝐺𝐻𝑧] + 2.3 × 𝑓[𝐺𝐻𝑧] × 𝐷𝑓 × 𝐷𝑘, Figure of Merit ~ 0.1 – 0.3 dB/in/GHz
                   𝑤[𝑚𝑖𝑙𝑠]

  PH-ESE seminar, 9/6/2015        Csaba SOOS, Signal and Power Integrity Design Practices                     15
Coupled traces, differential
impedance

                           200um                                                             Coupled microstrip traces




                           400um




                                                                                             Coupled stripline traces


 FR4, Dk=4.3, tanδ=0.02




PH-ESE seminar, 9/6/2015           Csaba SOOS, Signal and Power Integrity Design Practices                              16
 Tight vs loose coupling
                                                                     HyperLynx v8.2.1

                            HyperLynx v8.2.1




     h=150um                                                                            h=200um
     w=180um                                                                            w=350um
     s=150um                                                                            s=1000um
     Zdiff=100.8ohm              GND
                                                                           GND
                                                                                        Zdiff=100.3ohm




Tight coupling decreases differential impedance. Need either narrower traces, or higher
dielectric. This may lead to more losses. Loose coupling may compromise routing density.


 PH-ESE seminar, 9/6/2015    Csaba SOOS, Signal and Power Integrity Design Practices              17
 Loss in coupled microstrip traces

                                         Sdd21                                                     Sdd21


                                                                              S41
                                                                                                      S21
               S21          S41



              Tight coupling                                                      Loose coupling

Judging the loss of the interconnect using only S21 is difficult, if traces are coupled.
If the coupling is intentional (differential trace), use SDD21 instead.



 PH-ESE seminar, 9/6/2015         Csaba SOOS, Signal and Power Integrity Design Practices                  18
       Inter-symbol Interference (ISI)

Frequency dependent (!) loss causes rise time degradation.
      Design File: Losses_time_domain
      HyperLynx LineSimv8.2.1


                                        TL1



                 U1                     51.1 ohms         R1
                                        2.413 ns
                         1              40.000 cm
                                        Coupled Stackup
                                                          100.0 ohms
                         2
                                        TL2
           TX_diff
                                                                           Rise time degradation causes vertical and
                                        51.1 ohms
                                        2.413 ns
                                                                           horizontal eye collapse. State of the signal is
                                        40.000 cm
                                        Coupled Stackup                    influenced by previously transmitter bits.




       PH-ESE seminar, 9/6/2015               Csaba SOOS, Signal and Power Integrity Design Practices             19
  Attenuation at Nyquist
                             Sdd21

                                  20cm, FR4 microstrip




                      40cm, FR4 microstrip


10Gb/s, 5GHz Nyquist
                                 Practical limits:
                                 -8dB limit without EQ,
                                 -15dB CTLE,
                                 -25dB CTLE+FFE+DFE

  PH-ESE seminar, 9/6/2015       Csaba SOOS, Signal and Power Integrity Design Practices   20
Mode conversion, frequency domain

                                             Mode conversion (differential skew), check SCD terms
 Mixed-mode S parameters                                                                                                        SDD21_3ps



                                                                                                                                SDD21_18ps
                                                       SCD21_18ps         Design File: S_params_mode_conversion
                                                                          HyperLynx LineSimv8.2.1


                                                                                                              TL1
                                                                                 N1                                                       N2


                                                                                                              51.1 ohms
                                                                                                              603.206 ps
                                                                                                              10.000 cm
                                                                                                              Coupled Stackup
                                                       SCD21_3ps                                              TL2               TL3
                                                                                 N3                                                       N4


                                                                                                              51.1 ohms       51.2 ohms
                                                                                                              603.206 ps      18.112 ps
                                                                                                              10.000 cm       0.300 cm
                                                                                                              Coupled Stackup Stackup




PH-ESE seminar, 9/6/2015   Csaba SOOS, Signal and Power Integrity Design Practices                                                         21
Mode conversion, time domain


                                     Differential                                           Differential
                                      Common                                                 Common




                           No skew                                                   18ps skew




PH-ESE seminar, 9/6/2015        Csaba SOOS, Signal and Power Integrity Design Practices                    22
Mode conversion summary
• There is no perfect interconnection, there is always mode
  conversion
      • Skew (driver, traces, connectors, PCB dielectric etc.), asymmetries
• Issues related to mode conversion
      • Distorted differential signal, EMI, ISI (reflected common signal
        converts back to differential)
• Solutions
      • Reduce skew to achieve << 10% UI, match near mismatch
      • Terminate common signal (no conversion back to differential)
      • Use symmetrical ground return vias (GSSG)
      • Use better dielectric glass weave (1086, 3313), better glass fill or
        zig-zag routing

PH-ESE seminar, 9/6/2015   Csaba SOOS, Signal and Power Integrity Design Practices   23
Crosstalk
• Near-end crosstalk (NEXT)
      • In all forms of coupled lines
      • Depends on the mutual capacitance and inductance
                           𝐾𝑛𝑒𝑥𝑡 = (𝐶𝑀 𝐶 + 𝐿𝑀 𝐿) 4
      • Does not depend on coupled length for long traces (tr<2tpd)
                             𝑉𝑛𝑒𝑥𝑡 = 𝐾𝑛𝑒𝑥𝑡 𝑉
      • Proportional to the coupled length for short traces (tr>2tpd)
                       𝑉𝑛𝑒𝑥𝑡 = 𝐾𝑛𝑒𝑥𝑡 𝑉 2𝑡𝑝𝑑 𝑡𝑟


                           aggressor     TX                      RX



                           victim             RX                      TX

PH-ESE seminar, 9/6/2015     Csaba SOOS, Signal and Power Integrity Design Practices   24
Crosstalk
• Far-end crosstalk (FEXT)
      • Only in inhomogeneous coupled lines (e.g. MS)
      • Depends on the difference in velocity between even and odd
        propagation modes (no difference in stripline, no FEXT)
                      𝐾𝑓𝑒𝑥𝑡 = (𝐶𝑀 𝐶 − 𝐿𝑀 𝐿) 4
      • Proportional to the coupled length
                        𝑉𝑓𝑒𝑥𝑡 = 𝐾𝑓𝑒𝑥𝑡 𝑉(2𝑡𝑝𝑑 𝑡𝑟 )



                           aggressor     TX                      RX



                           victim        TX                      RX

PH-ESE seminar, 9/6/2015     Csaba SOOS, Signal and Power Integrity Design Practices   25
        Crosstalk, frequency and time domain
                                               S21
Microstrip




                                                                                           NEXT lasts for 2TD

                                               S31
                                   S41




                                               S21
Stripline




                                               S31


                                   S41


        PH-ESE seminar, 9/6/2015     Csaba SOOS, Signal and Power Integrity Design Practices                    26
        Crosstalk, frequency and time domain
                                               S21
Microstrip




                                                                                               FEXT in UI

                                               S31
                                   S41




                                               S21
Stripline




                                               S31


                                   S41                                                          No FEXT



        PH-ESE seminar, 9/6/2015     Csaba SOOS, Signal and Power Integrity Design Practices                27
Crosstalk, mitigation
• Use stripline, no FEXT
      • Loosely coupled allows to reduce dielectric height, less fringe fields




• Microstrip should be very short
      • If you need microstrip traces, use large separation (s > 3w)
      • Reduce coupled length as much as possible
• Use 2D field solver for estimating the crosstalk

PH-ESE seminar, 9/6/2015   Csaba SOOS, Signal and Power Integrity Design Practices   28
Discontinuities
• Discontinuities cause reflections
      • May impact the channel for MANY bit periods (difficult to
        compensate with equalization)
• Depends on many factors
      • Rise time, data rate, length and location of the discontinuity, losses
• Single reflection is tolerated if driver is terminated
      • Multiple discontinuities are much worse
• Losses could help, if you cannot avoid a discontinuity make
  the reflected signal travel longer
• Typical discontinuities
      • Stubs (routing, termination), via, imperfect return, connectors,
        packages


PH-ESE seminar, 9/6/2015   Csaba SOOS, Signal and Power Integrity Design Practices   29
Routing via
• Provide connection between different PCB layers
• Consists of the thru and stub part
• Features:
      • Hole diameter
      • Capture pad size
      • Clearance diameter
      • Non-functional pads (NFP)
      • Differential via pitch
      • Via length
• LC pi approximation only
  at low frequencies
• Use 3D field solver to explore design space

PH-ESE seminar, 9/6/2015   Csaba SOOS, Signal and Power Integrity Design Practices   30
Via optimization
• Get rid of stubs - first priority
                    1 1     1       𝑐
      • 𝑓𝑟𝑒𝑠 =            =               should be > 2 x signal bandwidth (@TX)
                    4 𝑡𝑝𝑑   4 𝑙𝑠𝑡𝑢𝑏 𝐷𝑘𝑒𝑓𝑓

• Try to match impedance
      • Capture pads, and clearance hole diameter affect capacitance
      • Drill diameter affect inductance
      • Remove NFPs, they increase C and Dkeff (electrical length increase)
• Differential via pitch
      • Tight spacing will reduce noise injected into cavity
      • BUT, also decreases differential impedance => compensate
• Return vias help to reduce ground bounce from common
  signal
      • No impact on differential signals

PH-ESE seminar, 9/6/2015    Csaba SOOS, Signal and Power Integrity Design Practices   31
Power Delivery Network
• Deliver power from source to ICs                                    PDN            ZPDN
• Provide return path for signals
                                                                         V
• Keep radiation within EMI limits
                                                                 VRM                              IC
• Complex system consisting of:
      • Voltage Regulator Module(s) (VRM)
                                                                     𝑉𝑟𝑖𝑝𝑝𝑙𝑒 > 𝑉𝑃𝐷𝑁 = 𝐼 𝑓 × 𝑍𝑃𝐷𝑁 𝑓
      • Decoupling capacitors                                                                      𝑉𝑟𝑖𝑝𝑝𝑙𝑒
      • Vias, traces, planes on the PCB                               𝑍𝑡𝑎𝑟𝑔𝑒𝑡 𝑓 = 𝑍𝑃𝐷𝑁 𝑓 <
                                                                                                    𝐼(𝑓)
      • Packages, etc.                                                                 𝑉𝑑𝑑 × 𝑟𝑖𝑝𝑝𝑙𝑒
                                                                           𝑍𝑡𝑎𝑟𝑔𝑒𝑡 <
                                                                                         𝐼𝑡𝑟𝑎𝑛𝑠𝑖𝑒𝑛𝑡
• Need to design Z(f) according to                           Assuming:
                                                                                              𝑃
  the power rail requirements =>                             𝐼𝑡𝑟𝑎𝑛𝑠𝑖𝑒𝑛𝑡 ≈ 0.5𝐼𝑝𝑒𝑎𝑘 , 𝐼𝑝𝑒𝑎𝑘 = 𝑚𝑎𝑥 , 𝑟𝑖𝑝𝑝𝑙𝑒 = 5%
                                                                                            𝑉𝑑𝑑
                                                                                                    2
                                                                                𝑉𝑑𝑑 × 5%           𝑉𝑑𝑑
• Take into account the limits set                                    𝑍𝑡𝑎𝑟𝑔𝑒𝑡 <
                                                                                 0.5𝐼𝑝𝑒𝑎𝑘
                                                                                          = 0.1 ×
                                                                                                  𝑃𝑚𝑎𝑥
  by the package and chip
PH-ESE seminar, 9/6/2015   Csaba SOOS, Signal and Power Integrity Design Practices                       32
PDN design challenge

                                                                                           Package inductance:
                                                                                                ~nH - ~pH




                DC-10kHz     10-100kHz        100kHz-100MHz                Beyond 100MHz
                                                                                           On-die Capacitance
                                                                                           130nm technology:
                                                                                                     𝑛𝐹
                                                                                                130 2
                                                                                                    𝑐𝑚

                           We can influence this region.
PH-ESE seminar, 9/6/2015       Csaba SOOS, Signal and Power Integrity Design Practices                   33
Decoupling
• Bulk capacitors
      • Electrolytic: high C, high ESR, high L
      • Tantalum: high C, medium ESR, medium L
• Multi-layer Ceramic Capacitors (MLCC)
    • Medium C, low ESR, low L
    • Low ESR could mean high Q, which is not always good
    • ESL depends also on mounting
• How to achieve ESL = 0.5-2nH
      • We have to reduce parasitic inductances
      • Bring planes close to the IC
      • Use thin dielectric between planes
      • Use short and wide surface traces


PH-ESE seminar, 9/6/2015   Csaba SOOS, Signal and Power Integrity Design Practices   34
Ansys Capacitor Library Browser
• Define VRM
• Define target Z
• Select capacitors
      • Vendor
      • Size
• Use automatic
  optimization
• Adjust manually




PH-ESE seminar, 9/6/2015   Csaba SOOS, Signal and Power Integrity Design Practices   35
Tools
• Impedance calculators
      • Quick answer but not always accurate, good for estimation
      • PCB Saturn, Qucs
• Field solvers
      • 2D/3D, hybrid
      • Slightly more complicated to set up, but accurate
• CERN
      • ANSYS EM (HFSS, Q3D, Siwave, Designer, Via wizard, PI advisor)
      • HyperLynx (not supported)
      • Cadence
      • Other tools: CST (3D EM solver), Qucs


PH-ESE seminar, 9/6/2015   Csaba SOOS, Signal and Power Integrity Design Practices   36
Measurement




                                                                                          TDR
• TDR uses voltage step with
  certain rise time (=> BW)
• TDR has a broadband receiver
      • Higher noise floor
• TDR source power roll-off
  limits dynamic range
• VNA uses single-tone sine
  wave
• VNA has narrow IF bandwidth
      • Lower noise floor




                                                                                            VNA
      • Higher dynamic range

PH-ESE seminar, 9/6/2015   Csaba SOOS, Signal and Power Integrity Design Practices   37
TDR vs VNA, dynamic range
                S-parameters (measurement)                                Eye diagram (simulation, ANSYS)


                                                                                     5Gb/s PRBS-7
                                                                                        (PNA)




                                                                                     5Gb/s PRBS-7
                                                                                        (TDR)




PH-ESE seminar, 9/6/2015   Csaba SOOS, Signal and Power Integrity Design Practices                  38
         Controlled impedance on very high
         density flex circuits
   • G. Blanchot, M. Kovacs, T. Gadek, Gianluca Traversi, Francesco De Canio
   • Investigated the impedance of various routing topologies
   • Built test board to measure impedances and compared with previously calculated values




Edge coupled microstrip                          Edge coupled stripline                              Broadside coupled stripline                             Broadside coupled offset stripline
                              U.Fl                   U.Fl
                           connector              connector                                                                               U.Fl                   U.Fl
                                                                                                                                       connector              connector

                                       93 mm                   8.3 mm                 3 mm
                                                                                                                                                   93 mm                   20 mm                   3 mm
                      PCB cut          TR line                TR line                 TR line
                                                                                                                                  PCB cut          TR line                 TR line                 TR line
        Wire bond                                                                                Wire bond          Wire bond                                                                                      Wire bond
       pads of chip                                                                             pads of chip       pads of chip                                                                                   pads of chip
                      PCB cut          TR line                TR line                 TR line                                     PCB cut                                  TR line
                                                                        Termination                                                                TR line                                         TR line
                                                                                                                                                                                     Termination


                                                              Shorter test line = 101 mm                                                                                  Longer test line = 113 mm
                              U.Fl                   U.Fl                                                                                 U.Fl                   U.Fl
                           connector              connector                                                                            connector              connector
         PH-ESE seminar, 9/6/2015                                       Csaba SOOS, Signal and Power Integrity Design Practices                                                                              39
Controlled impedance on very high
density flex circuits, measurement
                                 Longer transmission lines impedance, resistance compensated
                           110

                           100

                            90
                                                                                     Edge_coupled_microstrip_long_corre
                            80
                                                                                     cted_R
                            70                                                       Edge_coupled_stripline_long_correct
                                                                                     ed_R
                            60
                                                                                     Broadside_cp_offset_stripline_long_
                            50                                                       corrected_R

                            40                                                       Broadside_cp_stripline_long_correct
                                                                                     ed_R
                            30
                                 -88.1
                                 -78.6
                                 -69.1
                                 -59.6
                                 -50.1
                                 -40.6
                                 -31.1
                                 -21.6
                                 -12.1
                                  -2.6
                                   6.9
                                  16.4
                                  25.9
                                  35.5
                                  45.0
                                  54.5
                                  64.0
                                  73.5
                                  83.0
                                  92.5
                                 102.0
                                 111.5
                                 121.0
                                 130.5
                                 140.0
                                                                 Length [mm]

• Impedance measurements are well in line with simulation results, small
  difference observed for the broadside coupled striplines.
• Edge-coupled microstrip and stripline differential pairs showed 80 Ω –
  90 Ω impedance, close to the target 100 Ω value.

PH-ESE seminar, 9/6/2015   Csaba SOOS, Signal and Power Integrity Design Practices                       40
Light weight readout cable for inner
barrel pixel readout




PH-ESE seminar, 9/6/2015   Csaba SOOS, Signal and Power Integrity Design Practices   41
Light weight readout cable for inner
barrel pixel readout, S parameters




PH-ESE seminar, 9/6/2015   Csaba SOOS, Signal and Power Integrity Design Practices   42
      Light weight readout cable for inner
      barrel pixel readout, time domain
Eye diagram simulation on built-in cable model, L=2.7m TD=0.008,       Eye diagram simulation using FFE on built-in cable model, L=2.7m
1.2Gbps                                                                TD=0.008, 1.2Gbps

                                                   Simulation                                                          Simulation




Eye diagram simulation on measured S parameters, L=2.7m                Eye diagram simulation using FFE on measured S parameters ,
TD=0.008, 1.2Gbps                                                      L=2.7m TD=0.008, 1.2Gbps
                                              Simulation using                                                       Simulation using
                                              measured model                                                         measured model




      PH-ESE seminar, 9/6/2015               Csaba SOOS, Signal and Power Integrity Design Practices                                 43
ALICE ITS upgrade, Outer Barrel
• Gianluca Aglieri, Antoine Junique
• Transmission lines on Flexible Printed Circuits (Al/Polyimide
  or Cu/Polymide)
      • specifications, design, modelling
      • identification of critical parameters (resistive losses in ITS case)
      • identification of architectural trade-offs e.g. bit-rate vs physical
        constraints (material, thickness, lengths) and definition of system
        specs
• Frequency domain synthesis/analysis, S parameters models
  transient domain simulation (including the "virtual" eye-
  diagrams)


PH-ESE seminar, 9/6/2015   Csaba SOOS, Signal and Power Integrity Design Practices   44
                   ALICE ITS upgrade, Outer Barrel
Frequency domain




                          Al, L=1500 mm, Roughness=5 um                            Cu, L=1500 mm, Roughness=5 um
Time domain




                         PRBS @ 320Mb/s, no pre-emphasis                          PRBS @ 320Mb/s, no pre-emphasis
                   PH-ESE seminar, 9/6/2015   Csaba SOOS, Signal and Power Integrity Design Practices         45
ALICE ITS upgrade, Outer Barrel
• Transmission of 1.2 Gb/s on Al Flex over 27cm robust
• Transmission of 160 Mb/s on Al/Cu Flex over 1.5m robust
             • Pre-emphasis desirable
• Transmission of 320 Mb/s on Flex over 1.5m possible
             • Pre-emphasis necessary
             • Copper and differential microstrips facilitate




PH-ESE seminar, 9/6/2015    Csaba SOOS, Signal and Power Integrity Design Practices   46
GBTx test board PDN
• 4-port sensing (Kelvin method) for measuring low impedance (plane)
• Simulation carried out using Ansys
  SIwave
• Nice match above 1 MHz
• Mismatch at low frequency could be
  due to capacitor model




                                                                                     David Porret
PH-ESE seminar, 9/6/2015   Csaba SOOS, Signal and Power Integrity Design Practices          47
 PCIe40 PDN, current density
                                                                      Jean-Pierre Cachemiche, Fred Rethore (CPPM)
                                                                      Cadence Sigrity


                                                                         Current density too high




Reshaping and splitting planes to
reduce current




 PH-ESE seminar, 9/6/2015   Csaba SOOS, Signal and Power Integrity Design Practices                    48
    PCIe40 PDN, IR drop
                                                                         Jean-Pierre Cachemiche, Fred Rethore (CPPM)
                                                                         Cadence Sigrity
                  VCCT (0.9V, 5A) ~ 60mV
                  VCCR (0.9V, 13A) ~ 160mV




Redesigned shapes to reduce drop


                                                                        VCCT (0.9V, 5A) ~ 15mV
                                                                        VCCR (0.9V, 13A) ~ 50mV
    PH-ESE seminar, 9/6/2015   Csaba SOOS, Signal and Power Integrity Design Practices                    49
PH-ESE seminar, 9/6/2015   Csaba SOOS, Signal and Power Integrity Design Practices   50
Backup slides

                           Csaba SOOS, Signal and Power Integrity Design
PH-ESE seminar, 9/6/2015                                                   51
                                             Practices
         PDN analysis, mounting inductance



                                                                             Bottom

                                                                                          Top




         Capacitor Model                         Mounting Quality Total Mounting Estimated ESL, Actual Resonance Resonance
                                                                  Inductance, nH nH             Frequency, MHz   Frequency w/o
                                                                                                                 Mounting, MHz
Bottom   C6       C=0.1uF, ESL=Auto, ESR=25mOhms good             1.52           0.31           12.89            27.71
Top      C10      C=0.1uF, ESL=Auto, ESR=25mOhms good             0.63           0.28           19.98            27.71
         PH-ESE seminar, 9/6/2015         Csaba SOOS, Signal and Power Integrity Design Practices                          52
PDN analysis, laminate thickness
• Thinner laminate helps to reduce the impedance, but watch out for anti-
  resonance (Cplane + decoupling inductance)
                                                                      Anti-resonance




                                                       Thinner laminate




PH-ESE seminar, 9/6/2015   Csaba SOOS, Signal and Power Integrity Design Practices     53
Unwanted coupling seen on S21


                           Design File: S_params_coupled_resonator
                           HyperLynx LineSimv8.2.1


                                                               TL1
                                  N1                                                         N2


                                                               50.7 ohms
                                                               298.538 ps
                                                               5.000 cm
                                                               Coupled Stackup

                                                               TL2



                                                               60.2 ohms
                                                          R1 296.567 ps          R2
                                                               5.000 cm
                                                               Coupled Stackup

                                                          1.0 Mohms              1.0 Mohms




PH-ESE seminar, 9/6/2015                   Csaba SOOS, Signal and Power Integrity Design Practices   54
            HyperLynx, PCIe Gen3 channel

Design File: Kintex7_IBIS_AMI_PCIe_channel
HyperLynx LineSimv8.2.1


           U2                     J1                    J3                      J2                              U3
                      1p           Port1 Port3          Port1 Port2              Port1 Port3          2n

                                   Port2 Port4          Port3 Port4              Port2 Port4
                      1n          Xilinx_7k325t_ff...   PCIeGen3_14in_...       Xilinx_7k325t_ff...   2p
     xilinx_7gtx_tx                                                                                        xilinx_k7_gtx_ami_rx
     xilinx_7gtx_tx                                                                                        rx_n




            PH-ESE seminar, 9/6/2015                                        Csaba SOOS, Signal and Power Integrity Design Practices   55


==========================================
FILE: Tektronix_Fundamentals_of_Signal_Integrity.pdf
==========================================

Fundamentals of Signal Integrity
Primer
Primer



Table of Contents
Signal Integrity Described . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3

Digital Technology and the Information Age . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3

Rising Bandwidth Challenges Digital Design . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3 - 4

Review of Signal Integrity Concepts . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4 - 8
    Problems Created by Digital Timing Issues . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5
    Isolating Analog Deviations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6
    Eye Diagrams: A Shortcut for Quickly Detecting Signal Integrity Problems . . . . . . . . . . . . . . . . . . . . 8

Signal Integrity Measurement Requirements . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9 - 25
    Discovering Digital Faults Using Logic Analyzers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9
    Logic Analyzer Probing Solutions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
    Uncovering Analog Diviations with Digital Oscilloscopes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12
    Oscilloscope Probing Solutions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16
    Revealing the Frequency Domain with Real-Time Spectrum Analyzers . . . . . . . . . . . . . . . . . . . . . . 17
    Identify Signal Integrity Problems with Integrated Measurement Tools . . . . . . . . . . . . . . . . . . . . . . . 19
    Simplifying Complex Measurements with Jitter Analysis Tools . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20
    Providing Critical Impedance Measurements with Time Domain Reflectometry Solutions . . . . . . . . . 22
    Signal Generators Complete the Measurement System . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24

Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26




2    www.tektronix.com/signal_integrity
                                                                                              Fundamentals of Signal Integrity



Signal Integrity Described                                        These dramatically increased rates support computer
                                                                  applications such as 3D games and computer-aided design
By definition, “integrityÓ mean s “complete and unimpaired.”
                                                                  programs. Sophisticated 3D imagery requires a huge amount
Likewise, a digital signal with good integrity has clean, fast
                                                                  of bandwidth at the circuit board level, where the CPU, the
transitions; stable and valid logic levels; accurate placement
                                                                  graphics subsystem, and the memory has to move data,
in time and it would be free of any transients.
                                                                  constantly, as the image moves.
Evolving technology makes it increasingly difficult               Computers are just one facet of the bandwidth-hungry
for system developers to produce and maintain                     Information Age. Digital communication equipment designers
complete, unimpaired signals in digital systems.                  (and particularly those developing the electrical and optical
                                                                  infrastructure elements for both mobile and fixed networks)
The purpose of this primer is to provide some insight into
                                                                  are moving toward 40 Gb/s data rates. And digital video
signal integrity-related problems in digital systems, and to
                                                                  product development teams are designing a new generation
describe their causes, characteristics, effects, and solutions.
                                                                  of transmission equipment for high-definition, interactive
                                                                  video.
Digital Technology and the
                                                                  Numerous technologies are pushing these data rate
Information Age                                                   advancements. Serial buses are emerging to break the speed
It’s been over twenty years since the personal computer           barriers inherent in older, parallel bus architectures. In some
emerged and almost as long since cellular telephony went          cases, system clocks are intentionally dithered to reduce
from being a novelty to a consumer necessity. For both, one       unintended radiated emissions. And smaller, denser circuit
trend has remained constant: the demand for more features         boards using ball grid array ICs and buried vias have become
and services, and the need for more bandwidth to deliver          common as developers look for ways to maximize density
them. First-generation PC users were excited about the            and minimize path lengths.
power of creating a simple spreadsheet. Now they demand
detailed graphics, high-quality audio, and fast-streaming         Rising Bandwidth Challenges Digital
video. And, cell phones are hardly a tool anymore for just
                                                                  Design
conversation.
                                                                  Today’s digital bandwidth race requires innovative thinking.
Our much-smaller world now depends on increasingly more
                                                                  Bus cycle times are now up to a thousand times faster
content and its rapid, reliable delivery. The term “Information
                                                                  than they were twenty years ago. Transactions that once
Age” was coined to describe this new interwoven, interde-
                                                                  took microseconds are now measured in nanoseconds.
pendent, data-based culture.
                                                                  To achieve this improvement, edge speeds today are now
With the Information Age has come a steady stream of              a hundred times faster than before.
technology breakthroughs in the fields of semiconductors,
                                                                  Circuit board technology, however, has not kept pace
PC bus architectures, network infrastructures, and
                                                                  because of certain physical realities. The propagation time of
digital wireless communications. In PCs— and especially
                                                                  inter-chip buses has remained virtually unchanged. Although
in servers— processor speeds have escalated into the
                                                                  geometries have shrunk, circuit boards still need sufficient
multi-GHz range, and memory throughput and internal bus
                                                                  space for IC devices, connectors, passive components, and
speeds have risen right along with them.
                                                                  of course, the bus traces themselves. This space equates to
                                                                  distance, and distance means delay— the enemy of speed.




                                                                                                www.tektronix.com/signal_integrity   3
Primer



It’s important to remember that the edge speed – or rise            Review of Signal Integrity Concepts
time – of a digital signal can carry much higher frequency
                                                                    At frequencies in the gigahertz range, a host of variables
components than its repetition rate might imply. It’s actually
                                                                    can affect signal integrity: signal path design, impedances
the higher frequency components that create the desired
                                                                    and loading, transmission line effects, and even power
fast transitions in a digital signal. With today’s high-speed
                                                                    distribution on or off the circuit board.
serial buses, there is often significant energy at the 5th
harmonic of the clock rate.                                         The design engineer’s mission is to minimize
As a result, circuit board traces just six inches long become       these problems from the start, and to correct
transmission lines when driven with signals exhibiting edge         them when they do appear.
rates below four to six nanoseconds. Circuit board traces
                                                                    To do that, they must investigate both of the fundamental
are no longer simple conductors. At lower frequencies, a
                                                                    sources of signal degradation: digital issues and analog
trace exhibits mostly resistive characteristics. As frequencies
                                                                    issues.
increase, a trace begins to act like a capacitor. At the highest
frequencies, a trace’s inductance plays a larger role.              Problems Created by Digital Timing Issues
Signal integrity problems increase at higher frequencies.           An engineer working with an evolving digital system design
Transmission line effects are critical. Impedance discontinu-       is likely to encounter signal integrity problems in their
ities along the signal path create reflections, which degrade       digital form. Binary signals on the bus or device outputs
signal edges. Crosstalk increases. Power supply decoupling          produce incorrect values. The errors may appear in the
becomes far less effective, as ground planes and power              waveform (timing measurement) view on a logic analyzer,
planes become inductive and act like transmission lines.            and they may also show up at the state or even the protocol
EMI (electromagnetic interference) goes up as faster edge           level. It only takes one bad bit to dramatically affect the
speeds produce shorter wavelengths relative to the bus              outcome of an instruction or transaction.
length, which creates unintended radiated emissions.                Digital signal aberrations stem from many root causes.
These emissions increase crosstalk and can cause a digital          Timing-related issues are especially common:
device to fail EMC (electromagnetic compliance) testing.
                                                                      Bus Contention - Bus contention occurs when two driver
Faster edge speeds generally also require higher currents             devices try to use the same bus line at the same time.
to produce them. Higher currents tend to cause ground                 Normally, one of the drivers should go to a high imped-
bounce, especially on wide buses in which many signals                ance state and not hinder the other while it sends data.
switch at once. Also, higher current increases the amount             If the high impedance device doesn’t change in time,
of radiated magnetic energy and, with it, crosstalk.                  the two drivers then contend for the bus. Neither driver
                                                                      prevails, forcing the bus to an indeterminate amplitude
As data rates increase to the gigabit range and beyond,
                                                                      that may fail to reach the threshold voltage. This creates,
digital designers face all the frustrations that come with high
                                                                      for example, a “0” logic level where there should be a “1.”
frequency design. An ideal digital pulse is cohesive in time          With a high-speed bus, this situation is complicated further
and amplitude, is free from deviations and jitter, and has fast,      by the time of flight between the contending sources and
clean transitions. As system speeds increase it becomes               the receiver.
increasingly more difficult to maintain ideal signal characteris-
tics, requiring careful consideration of signal integrity issues.




4   www.tektronix.com/signal_integrity
                                                                                           Fundamentals of Signal Integrity



                                                                 Metastability - Metastability is an indeterminate or unsta-
Every Design Detail is Important                                 ble data state that results from a timing violation, such as
                                                                 a setup and hold problem. As a result, the output signal
At clock frequencies in the hundreds of megahertz
                                                                 might be late or achieve an illegal output level, such as a
and above, every design detail is important to
                                                                 runt, a glitch, or even the wrong logic level.
minimize signal integrity problems:
                                                                 Undefined Conditions - Undefined conditions can occur
   Clock distribution                                            when the switching states on multiple inputs of a logic
   Signal path design                                            device are not correctly aligned in time. This may be
   Stubs                                                         caused by variations or errors in the delay on these input
                                                                 signals.
   Noise margin
                                                                 Inter-Symbol Interference (ISI) - ISI is when one symbol
   Impedances and loading
                                                                 interferes with subsequent symbols, creating distortion
   Transmission line effects                                     of the signal. It is caused by jitter and noise due to high
   Signal path return currents                                   frequency losses and reflections.
   Termination                                                 Logic analyzers have powerful tools to help users acquire and
   Decoupling                                                  analyze digital signals in many formats. Today’s advanced
                                                               logic analyzers can capture data from thousands of test
   Power distribution
                                                               points simultaneously, then display streams of digital pulses
                                                               and their placement in time relative to each another.
                                                               With this type of conventional logic analyzer acquisition,
Setup and Hold Violations - Setup and hold violations
                                                               amplitude errors and glitches can appear to be valid logic
are increasing as digital systems push to faster speeds.
A clocked device, such as a D flip flop, requires the data     levels even though they contain incorrect data. It may be
to be stable at its input for a specified time before the      possible to see an error value in the hexadecimal code,
clock arrives. This is known as “setup” time. Similarly, the   for example, but the display won’t show why the error is
input data must remain valid for a specified time after        occurring. It can be very difficult to find the cause of a
the leading edge of the clock. This is known as “hold”         logic error if there is no means to probe further into the
time. Violating setup and/or hold requirements can cause       signal’s behavior.
unpredictable glitches on the output, or can cause there
to be no output transition at all. Setup and hold times are
decreasing as device speeds increase, making the timing
relationships harder to troubleshoot.




                                                                                            www.tektronix.com/signal_integrity   5
Primer



Isolating Analog Deviations
Many digital problems are much easier to pinpoint if you         Common causes of analog deviations:
can probe deeply into the signal’s behavior and see the
analog representation of the flawed digital signal. Although
the problem may appear as a misplaced digital pulse,
the cause of the problem signal often is due to its analog
characteristics. Analog characteristics can become digital
faults when low-amplitude signals turn into incorrect logic
states, or when slow rise times cause pulses to shift in time.
Seeing a digital pulse stream with a simultaneous analog
view of the same pulses is the first step in tracking down
these kinds of problems.
Oscilloscopes are commonly used to identify the root
cause of signal integrity problems by analyzing a signal’s
analog characteristics. They can display waveform details,
                                                                 Figure 1. Amplitude problems.
edges and noise, and they can also detect and display
transients. With powerful triggering and analysis features,      Amplitude Problems – Amplitude problems include
an oscilloscope can track down analog aberrations and help       ringing (oscillation), “droop” (decreased amplitude at the
the design engineer find device problems causing faults.         start of a pulse), and “runt” pulses (those which don’t
                                                                 reach full amplitude).




                                                                 Figure 2. Edge aberrations.



                                                                 Edge Aberrations – Edge aberrations can result
                                                                 from board layout problems or from improper termination
                                                                 or even quality problems in the semiconductor devices.
                                                                 Aberrations can include preshoot, rounding, overshoot,
                                                                 ringing, and slow rise time.




6   www.tektronix.com/signal_integrity
                                                                                        Fundamentals of Signal Integrity




Figure 3. Reflections.                                     Figure 5. Ground bounce.


Reflections – Reflections can be caused by termination     Ground Bounce – Ground bounce, caused by excessive
and board layout problems, where the outgoing signal       current draw (and/or resistance in the power supply
bounces back toward its source and interferes with         and ground return paths), can cause a circuit’s ground
subsequent pulses.                                         reference level to shift when current demands are high.




Figure 4. Crosstalk.                                       Figure 6. Jitter.


Crosstalk – Crosstalk can occur when long traces           Jitter – Jitter is defined as edge placement variations
running next to each other couple their signals together   from cycle to cycle. Some important causes of jitter are
through mutual capacitance and inductance. In addition,    noise, crosstalk and timing instability. This can affect timing
the higher current embodied in fast edges increases the    accuracy and synchronization throughout a digital system.
amount of radiated magnetic energy, and with it,
crosstalk.




                                                                                          www.tektronix.com/signal_integrity   7
Primer




    Eye Diagrams: A Shortcut For Quickly                          possible positive-going and negative-going transitions
    Detecting Signal Integrity Problems                           (edges) and both data states in a single window. The
                                                                  resulting image resembles an eye.
                                                                  Ideally, each new trace would align perfectly on top of
                                                                  the ones coming before it. In reality, however, signal
                                                                  integrity factors cause the composite trace to “blur” as
                                                                  it accumulates, with jitter causing a horizontal ‘blur’ and
                                                                  noise causing a vertical one.
                                                                  Because an eye diagram presents all possible logic
                                                                  transitions in a single view, it can also provide a fast
                                                                  assessment of a signal’s condition. It can reveal such
    Figure 7. Example of an eye diagram.
                                                                  analog problems as slow rise times, inter-symbol interfer-
    The eye diagram is a visual tool to observe the               ence and attenuation levels. Some engineers start
    general signal integrity on a clocked bus. It is a required   their evaluations by looking first at eye diagrams, then
    compliance testing tool for many of today’s buses,            tracking down any deviations.
    particularly serial types, but any signal line can be
                                                                  Many modern digitizing oscilloscopes offer tools that
    viewed as an eye diagram.
                                                                  can expedite complex clock recovery, triggering and
    The eye diagram (see Figure 7) is built up by overlaying      scaling, then perform quantitative measurements on
    the waveform traces from many successive unit intervals       the data. These new software and hardware tools have
    (UI). Eye diagrams display serial data with respect to        now incorporated the eye diagram measurement as a
    a clock recovered from the data signal using either           standard, one-button operation.
    hardware or software tools. The diagram displays all




8   www.tektronix.com/signal_integrity
                                                                                                       Fundamentals of Signal Integrity



Signal Integrity Measurement
Requirements
Direct signal observations and measurements are the only
ways to discover many causes of signal integrity-related
problems. As always, using the right tool will simplify
any task. Most signal integrity measurements are made
with the familiar combination of instruments found in
most electronics engineering labs: the logic analyzer, the
oscilloscope and, in some cases, the spectrum analyzer.
Probes and application software – to perform tasks like
jitter analysis – round out the basic toolkit. Signal sources
can be used to provide distorted signals for stress testing
and evaluation of new devices and systems. They can
also provide missing system inputs, or they can replicate        Figure 8. Logic analyzer display showing a timing diagram.

sensor signals to the device during test. A time-domain
reflectometry solution is helpful for tracking signal path       correctly. These waveforms are usually the starting point in
impedance problems, such as impedance mismatch and               the search for problems that compromise signal integrity.
other signal integrity problems that cause reflections or        Logic analyzers offer two different data acquisition modes:
amplitude loss.                                                  "state" and “timing”. State (or synchronous) acquisition is
                                                                 used to acquire the “state” of the device under test (DUT).
Discovering Digital Faults Using Logic
                                                                 A signal from the DUT defines when and how often data will
Analyzers
                                                                 be acquired. The signal used to clock the acquisition may be
As mentioned earlier, the logic analyzer is the first line of
                                                                 the device’s clock, a control signal on the bus or a signal that
defense for digital troubleshooting, especially for complex
                                                                 causes the DUT to change states. Data is sampled on the
systems with numerous buses, inputs and outputs. A logic
                                                                 active edge and represents the condition of the DUT when
analyzer has the high channel count to acquire digital
                                                                 the logic signals are stable.
information from many test points, and then display that
                                                                 Timing (or asynchronous) acquisition captures signal timing
information coherently to identify problems.
                                                                 information to create timing diagrams. In this mode, a clock
Because it’s a digital instrument, the logic analyzer detects
                                                                 internal to the logic analyzer is used to sample data. There is
threshold crossings on the signals it’s monitoring, then
                                                                 no fixed-timing relationship between the target device and the
displays the logic signals. Figure 8 shows a typical timing
                                                                 data acquired by the logic analyzer. This mode is used when
diagram from a logic analyzer. The resulting digital waveforms
                                                                 a long, contiguous record of timing details is needed.
are clear and understandable, and can easily be compared
with expected data to confirm that the device is working




                                                                                                         www.tektronix.com/signal_integrity   9
Primer



                                                                                      Triggering Flexibility
     CLK
                                                                                      Triggering flexibility is the key to fast, efficient detection of
                                                                                      unseen problems. In a logic analyzer, triggering is used to
                                                                                      set conditions that, when met, will tell the logic analyzer to
     D                                                                                acquire data and display the result. When a logic analyzer
                                                                                      triggers on an error, it is proof that the error has occurred,
                                              Glitch                                  which enables fast detection. Most logic analyzers today
     Q
                                                                                      include triggers to detect events that compromise signal
                ∆t = timing resolution                                                integrity, like glitches and setup and hold time violations.
                                                                                      A unique strength of a logic analyzer is that these trigger
                                                                                      conditions can be applied across hundreds of channels
                           Logic Analyzer Sampling                                    at once.

Figure 9. A logic analyzer’s timing resolution determines its ability to detect and
                                                                                      With its ability to analyze hundreds to thousands of digital
display signal deviations.                                                            lines at a time, the logic analyzer is a powerful tool for
                                                                                      discovering device faults for further analysis. For fast and
Timing Resolution
                                                                                      efficient debugging, it’s important to carefully look at usability
Timing diagrams are useful in detecting intermittent glitches.
                                                                                      features like triggering, as well as performance attributes,
These erratic pulses are unpredictable and often irregular
                                                                                      when choosing a logic analyzer solution.
in amplitude and duration, which makes them difficult to
detect and capture. The logic analyzer’s timing resolution                            Logic Analyzer Probing Solutions
will determine its ability to detect and display glitches, as                         A logic analyzer’s probing scheme plays a critical role in
shown in Figure 9. The higher the timing resolution, the more                         high-speed digital acquisition. It's critical that the probe
likely an event will be seen and triggered on, enabling further                       deliver the signal to the logic analyzer with the highest
analysis of the problem.                                                              possible fidelity. Most logic analyzer probes fulfill this
                                                                                      fundamental requirement, but some take the concept
Memory Depth
                                                                                      even further.
Memory depth will impact a logic analyzer’s ability to detect
elusive problems. Memory depth, along with timing resolu-                             Some logic analyzers require separate probing connections
tion, determines how much “time” and detail can be captured                           for timing and state acquisitions. This is known as “double
in a single acquisition. The total acquisition time at a given                        probing”, which is a technique that can compromise the
sample rate (or timing resolution) will increase as memory                            signal environment, affecting the actual measurements
depth increases. Likewise, deeper memory allows for a                                 themselves. For example, connecting two probes at once
higher sample rate, enabling more signal detail to be                                 to the test point can create unacceptable levels of signal
captured. Acquiring more samples increases the chance                                 loading. Connecting them individually exposes the test point
of capturing an error as well as the fault that caused it.                            to double the risk of damage or misconnection. Moreover,
                                                                                      it is time-consuming to connect two probes.




10   www.tektronix.com/signal_integrity
                                                                                                         Fundamentals of Signal Integrity



Some logic analyzers have the ability to measure both timing
and state acquisitions through one probe. This simultaneous
timing/state acquisition speeds troubleshooting and supports
signal integrity analysis tasks by minimizing the impact of
probes on the DUT.
Recent advancements have taken logic analyzer probing
technology to a new level. The latest generation of probes
can carry both digital information to the logic analyzer while
also delivering the same information to an oscilloscope as
analog signals. Any pin of the probe can be used for both
digital and analog acquisition. The analog signal routes
through the logic analyzer to an external oscilloscope, making
it possible to determine, almost instantly, if a digital error is
associated with an analog fault.
In high performance digital systems, a dedicated test point
is usually the most practical way to measure signals. Some
dedicated test points are fitted with pins to simplify their
connection with clip-on probes and leadsets. These types
                                                                    Figure 10. D-MaxTM connectorless analyzer probe.
of test connectors have an effect on the target device’s
signal environment, even when they aren’t connected to a
                                                                    Figure 10 shows a D-Max™ connectorless probe installed
logic analyzer.
                                                                    on a circuit board, which is held in place by threaded inserts.
A logic analyzer’s probes can also mount to dedicated
                                                                    Connectorless probes address lead inductance and also
connectors on the DUT. The matched impedance connector,
                                                                    offer very low capacitive loading. They also provide both
MICTOR, is a compact, high-density connector joined to a
                                                                    single-ended and differential measurements with no tradeoffs
matching connector on the logic analyzer probe. Board-
                                                                    in channel count.
mounted connectors add cost to the target device, and they
                                                                    A D-Max™ connectorless logic analyzer probe has much
can affect high-speed signal operation, but they do provide
                                                                    less of an impact on the circuit board than a MICTOR-style
fast, positive connections.
                                                                    connection, but land pads still must be designed into the
High-density (HD) compression logic analyzer probes and
                                                                    board layout. The location at which a bus is probed can
D-Max™ probing technology have emerged to provide an
                                                                    make a difference in the appearance of the signals. Because
alternative to conventional MICTOR probe connectors.
                                                                    of that, it’s preferable to place test connection points close
These probes don't require connectors on the DUT. Instead,
                                                                    to the receiving devices, where signals exhibit the
they mate directly to land pads on the circuit board.
                                                                    characteristics that will be “seen” by the logic ICs. The
                                                                    D-Max™ connectorless probe’s small footprint offers flexibility
                                                                    in this placement.




                                                                                                           www.tektronix.com/signal_integrity   11
Primer



Uncovering Analog Deviations with
Digitizing Oscilloscopes
Another major signal integrity measurement solution is the
digitizing oscilloscope. The oscilloscope is used to isolate
analog problems once they have been captured, in their
digital form, by the logic analyzer. The oscilloscope can
display waveform details, edges and noise; it can detect
and display transients and it can precisely measure timing
relationships like setup and hold times. Since digital errors
are often related to analog signal integrity problems, the
oscilloscope is a valuable tool in determining the cause of
a digital fault.                                                Figure 11. A digital phosphor oscilloscope with an intensity-graded display offers fast
                                                                insight into elusive problems.
Digitizing oscilloscopes come in different forms, such as
the digital storage oscilloscope (DSO), the digital phosphor    A digital sampling oscilloscope is a better-suited tool when
oscilloscope (DPO), and the sampling oscilloscope. The          the bandwidth (or the accuracy at high bandwidth) of a real-
DSO is ideal for low-repetition rate signals with fast edges    time oscilloscope isn't enough. The sampling oscilloscope
or narrow pulse widths. The DSO also excels at capturing        is an ideal tool for accurately capturing repetitive signals with
one-time events and transients, and is the best solution for    frequency components that are much higher than the oscillo-
high-speed, multi-channel design applications.                  scope’s sample rate. The digital sampling oscilloscope is
The DPO is the right tool for digital troubleshooting, for      capable of measuring signals of nearly an order of magnitude
finding intermittent signals, and for many types of eye         faster than any other oscilloscope. By using sequential
diagram and mask testing. The DPO’s extraordinary               equivalent-time sampling of repetitive signals, it can achieve
waveform capture rate overlays sweep after sweep of             bandwidths of up to 100 GHz.
information more quickly than any other oscilloscope,           When choosing an oscilloscope, there are several key
providing frequency-of-occurrence details, in color and         performance considerations that impact the quality of signal
intensity, with unmatched clarity. Figure 11 shows a DPO        integrity measurements. These include bandwidth, rise time,
display with intensity-grading.                                 sample rate, waveform capture rate, record length, and
                                                                triggering flexibility.




12   www.tektronix.com/signal_integrity
                                                                                                               Fundamentals of Signal Integrity



                                                                                  Figure 12 shows a typical frequency response plot for a
                                                                                  1 GHz oscilloscope, including the characteristic roll-off and
                         100
                                                                                  specified -3 dB point.
   Amplitude error (%)




                                                                                  Without adequate bandwidth, an oscilloscope will not be
                                                                                  able to resolve high-frequency changes. Amplitude will be
                          85                                                      distorted, edges will disappear and details will be lost.
                                                                                  Without adequate bandwidth, all the strengths and special
                                                                                  features of the oscilloscope will mean nothing.

                                                                       -3 dB      To determine the oscilloscope bandwidth needed to accu-
                   70.7
                       0.1                      0.5                         1.0   rately characterize signal amplitude for a specific application,
                                   Frequency (GHz)                                the “5 Times Rule” is useful:

Figure 12. Typical frequency response plot for a 1 GHz oscilloscope.                                     The 5 Times Rule:

                                                                                       Oscilloscope Bandwidth ≥    Highest Frequency x 5
Bandwidth                                                                                                         Component of Signal
When troubleshooting designs with high data rates or fast
rise time signals, oscilloscope bandwidth is critical. The edge                   An oscilloscope selected using the 5 Times Rule will have
speed (rise time) of a digital signal can carry much higher                       less than a +/- 2% measurement error. In general, a higher
frequency components than its repetition rate might imply.                        bandwidth will provide a more accurate reproduction of the
An oscilloscope must have sufficient bandwidth to capture                         signal of interest.
the higher frequency components, and therefore show signal                        For debug of today’s high-speed serial buses, achieving the
transitions accurately.                                                           5 Times Rule can be challenging given the fast data rates.
All oscilloscopes have a low-pass frequency response that                         For design debug, it’s common to choose an oscilloscope
rolls off at higher frequencies. Traditionally, oscilloscope                      bandwidth that's three times higher than the fastest digital
bandwidth has been specified as being the frequency at                            clock rate in the DUT – and therefore able to capture the
which a sinusoidal input signal is attenuated to 70.7% of the                     3rd harmonic of the clock rate. For characterization and
signal’s true amplitude. This is known as the “-3 dB point”,                      compliance testing of high-speed buses, the oscilloscope
which is a term based on a logarithmic scale. It means that                       often needs to capture the 5th harmonic, requiring a band-
a sine wave measured at the oscilloscope’s bandwidth rating                       width that is five times higher than the DUT’s clock rate.
will have an amplitude error of -3 dB, or almost 30%.




                                                                                                                  www.tektronix.com/signal_integrity   13
Primer




     Serial Bus              Clock                3rd                5th                 Logic Family                        Typical Signal Rise Time
     Data Rate             Frequency           Harmonic           Harmonic
                                                                                         TTL                                             2 ns
     3.0 Gbps                1.5 GHz            4.5 GHz            7.5 GHz
     (SATA II)                                                                           CMOS                                           1.5 ns
     4.25 Gb/s              2.125 GHz          6.375 GHz         10.625 GHz
     (Fibre Channel)                                                                     GTL                                             1 ns

     4.8 Gb/s                2.4 GHz            7.2 GHz            12.0 GHz              LVDS                                           400 ps
     (FBD)
                                                                                         ECL                                            100 ps
     5.0 Gb/s                2.5 GHz            7.5 GHz            12.5 GHz
     (USB 3.0)                                                                           GaAs                                            40 ps
     5.0 Gb/s                2.5 GHz            7.5 GHz            12.5 GHz
     (PCI-Express II)
                                                                                    Chart 2. Some logic families produce inherently faster rise times than others.
     6.0 Gb/s                3.0 GHz            9.0 GHz            15.0 GHz
     (SATA III)
     6.25 Gb/s              3.125 GHz          9.375 GHz         15.625 GHz         To calculate the oscilloscope rise time required for a specific
     (2x XAUI)                                                                      signal type, the following equation is useful:
     8.0 Gb/s                4.0 GHz           12.0 GHz            20.0 GHz
     (PCI-Express III)
                                                                                                                                                                     1
     8.5 Gb/s               4.25 GHz           12.75 GHz          21.25 GHz            Oscilloscope Rise Time ≤ Fastest Rise Time of Signal x
     (Fibre Channel)                                                                                                                                                 5
     10.0 Gb/s               5.0 GHz           15.0 GHz            25.0 GHz
     (XFI)                                                                          The basis for the oscilloscope rise time selection is similar to
                                                                                    that for bandwidth. In general, an oscilloscope with faster rise
Chart 1. Common serial bus data rates and the required oscilloscope bandwidths to
capture the 3rd and 5th harmonics.
                                                                                    time will more accurately capture the critical details of fast
                                                                                    transitions. Just as with bandwidth, achieving this rule of
Chart 1 shows common serial bus data rates and the
                                                                                    thumb can be difficult when dealing with the extreme speeds
resulting oscilloscope bandwidths to capture the 3rd and
                                                                                    of today’s high-speed serial buses.
5th harmonics. It illustrates how today’s high-speed buses
                                                                                    The rise time measured by the oscilloscope will depend on
require substantial oscilloscope bandwidths.
                                                                                    both the actual signal rise time and the oscilloscope rise time.
Rise Time                                                                           The faster the oscilloscope rise time, the more accurate the
In the digital world, rise time measurements are critical. Rise                     measured rise time will be. A general formula for the net
time may actually be a more appropriate performance con-                            measured rise time is:
sideration than bandwidth when choosing an oscilloscope to
measure digital signals like pulses and steps. Since semicon-                           Measured                                         2                       2
ductor device technology advances have brought faster edge                              Rise Time =                 (Oscilloscope      Signal
                                                                                                                      Rise Time ) + ( Rise Time)
performance to virtually every logic family, it’s important to
remember that many digital systems that are designed with
slower clock rates may still have very fast edges (Chart 2).




14   www.tektronix.com/signal_integrity
                                                                                                    Fundamentals of Signal Integrity



If the rise time of the oscilloscope is unknown, it can be          Waveform Capture Rate
calculated from the specified bandwidth by using the follow-        The waveform capture rate, expressed as waveforms per
ing equation:                                                       second (wfms/s), determines how frequently the oscilloscope
              Bandwidth =           k                               captures a signal. While the sample rate indicates how
                                Rise Time                           frequently the oscilloscope samples the input signal within
                                                                    one waveform, or cycle, the waveform capture rate refers to
Where k is a value between 0.35 and 0.45, depending on
                                                                    how quickly an oscilloscope acquires the whole waveform.
the shape of the oscilloscope’s frequency response curve
and pulse rise time response.                                       Oscilloscopes with high waveform capture rates provide
                                                                    significantly more visual insight into signal behavior. They
Most oscilloscopes with a bandwidth specification of less
                                                                    can dramatically increase the probability that the oscilloscope
than 1 GHz have a slow frequency response roll-off, similar
                                                                    will quickly capture transient anomalies like jitter, runt pulses,
to a Gaussian response, and they can be modeled with
                                                                    glitches, and transition errors.
a k value of 0.35. Higher bandwidth oscilloscopes typically
have a maximally flat frequency response with a sharp               Record Length
roll-off, closer to a brick wall filter, and can be modeled         Record length is the number of samples the oscilloscope
with a k value of 0.42.                                             can digitize and store in a single acquisition. Since an oscillo-
Sample Rate                                                         scope can store only a limited number of samples, the
                                                                    waveform duration – or length of “time” captured – will be
Sample rate – specified in samples per second (S/s) –
                                                                    inversely proportional to the oscilloscope’s sample rate.
refers to how frequently a digital oscilloscope takes a sample,
or a visual snapshot, of the signal. A faster sample rate
                                                                                                        Record Length
provides greater resolution and detail of the displayed                           Time Interval =
                                                                                                         Sample Rate
waveform, making it less likely that critical information or
events will be lost.                                                Today’s oscilloscopes allow the user to select the record
In order to accurately reconstruct a signal and avoid aliasing,     length for an acquisition to optimize the level of detail
the Nyquist theorem states that the signal must be sampled          needed for the application. If a very stable sinusoidal signal is
at a rate of at least twice as fast as its highest frequency        being analyzed, a 500-point record length may be sufficient.
component. But, the theorem assumes an infinite record              However, if a complex digital data stream is being analyzed
length and a continuous signal. Since no oscilloscope is            for the causes of timing anomalies, a record length of over
capable of infinite record length, and because, by definition,      a million points may be required. A longer record length
glitches aren't continuous, sampling at only twice the rate         enables a longer time window to be captured with high
of the highest frequency component is usually insufficient.         resolution (high sample rate).
In reality, accurate reconstruction of a signal depends on
both the sample rate and the interpolation method used to
fill in the spaces between the samples. Some oscilloscopes
offer sin(x)/x interpolation for measuring sinusoidal signals,
or linear interpolation for square waves, pulses, and other
signal types.


Oscilloscope Sample Rate > 2.5 x highest frequency component of signal
(For sin(x)/x interpolation)


Oscilloscope Sample Rate > 10 x highest frequency component of signal
(For linear interpolation)




                                                                                                     www.tektronix.com/signal_integrity   15
Primer



Trigger Flexibility
The triggering functions in an oscilloscope are just as critical
as those in the logic analyzer. Like a logic analyzer, the
oscilloscope’s trigger is proof that a specified type of event
occurred. Modern oscilloscopes offer triggers for a host of
analog events:
     Edge levels and slew rate conditions
     Pulse characteristics, including glitches,
     low-amplitude events and even width conditions
     Setup and hold time violations
     Serial digital patterns
All of these trigger types can assist engineers in detecting
and isolating signal integrity problems. There are also
various combinations of voltage, timing, and logic triggers,         Figure 13. Probe loading effects on a high-speed signal.

as well as specialty triggers, for applications such as serial
data compliance testing.                                             Figure 13 demonstrates the probe loading effects on a typical
The oscilloscope is a critical piece of the signal integrity         high-speed signal (ground-referenced 250 mV step with
measurement solution. Once a digital fault has been isolated,        about 200 ps rise time). This screen shows the same signal,
the oscilloscope can provide detailed analysis of the digital        loaded and unloaded, on a 4 GHz oscilloscope. The addition
signal to identify possible analog problems. For quality meas-       of the probe has loaded the original signal (the white trace),
urements, and for efficient debug, it’s important to look care-      as shown by the green trace, with the front corner of the step
fully at the performance of the oscilloscope to ensure it can        being somewhat slowed. Simply stated, as capacitance and
meet the challenges of the signals being analyzed. The key           inductance increase, loading on the signal also increases.
to fast and efficient debug is usability features like triggering    Similarly, lead length inductance can cause significant distor-
flexibility and tools to efficiently navigate long record lengths.   tion in the signal being measured. Probe input characteristics
                                                                     and lead length inductance can actually cause signal integrity
Oscilloscope Probing Solutions                                       problems.
The oscilloscope probe is a critical element in signal integrity     A new generation of ultra-low-capacitance oscilloscope
analysis measurements. Essentially, the probe must bring the         probes is the answer to signal integrity and high-speed
system’s full bandwidth and step response performance to             measurement problems. With wide bandwidths at the probe
the test point. Also, it must be durable and small enough to         tip, very short probe tip lead lengths and ultra-low input
probe densely-packed circuit boards.                                 capacitance, these probes better preserve the signal as it
During troubleshooting for signal integrity problems, it’s           travels to the oscilloscope input. They bring the signal to the
usually necessary to have one probe “fixed” on a test point          acquisition system accurately, with aberrations and all.
at which an error appears and another probe that can follow          The probe’s performance is critical because it’s the first link,
the signal path to isolate the source of the problem.                in a chain of measurement subsystems, that must preserve,
For high-speed work, two important characteristics of a              capture and display the signal as accurately as possible. A
probe are its capacitance and its inductance. Every probe            high-bandwidth, low-capacitance probe with both a very
has resistance, inductance, and capacitance. The effects             short probe tip and ground lead lengths ensures that the
of capacitance and inductance, however, increase with                bandwidth of the oscilloscope is not wasted.
frequency. Their combined effects can change the signal
and its measurement results.




16    www.tektronix.com/signal_integrity
                                                                                                      Fundamentals of Signal Integrity



Identifying Signal Integrity Problems with                           Revealing the Frequency Domain with
Integrated Measurement Tools                                           Mixed Signal
                                                                     Real-Time          Oscilloscopes:
                                                                                  Spectrum     Analyzers Visualize Analog
                                                                       and  Digital  Domains     on One Instrument
                                                                     For some elusive events, a measurement tool with improved
In today’s digital systems, with their fast edges and data
rates, the analog characteristics underlying digital signals            With a mixed
                                                                     frequency            signal
                                                                                   resolution   mayoscilloscope
                                                                                                      be required   (MSO),
                                                                                                                      to seetime-correlated
                                                                                                                              subtle frequency
have an ever-increasing impact on system behavior—reliabili-            digitalsuch
                                                                     events      andas analog
                                                                                          clocksignals    can be
                                                                                                  phase-slip,       visualized onand
                                                                                                                microphonics,      onep hase
ty and repeatability in particular. Efficiently troubleshooting         display.    The  digital  channels    of the   MSO   acquire
                                                                     lock loop (PLL) settling. Since a spectrum analyzer provides     and
signal integrity problems requires looking at both the analog           display
                                                                     much         a signal
                                                                             greater         in its digital
                                                                                       frequency            form than
                                                                                                     resolution    whileanthe  analog chan-
                                                                                                                            oscilloscope,  it
and digital domains.                                                    nels  capture    the  same    signal  in its analog   form.
                                                                     can be an invaluable tool for tracking down these events. It isSeeing
                                                                        these
                                                                     also  a goodtwo tool
                                                                                      separate    views together
                                                                                           for measuring              makes ittolerance
                                                                                                             the frequency       easy to visu-
                                                                                                                                          of
As mentioned earlier, digital signal deviations can arise from
                                                                        alize,  for  example,    how   a digital  timing
                                                                     dither generation, which is becoming more common as  problem   can  result
problems in the analog domain like impedance mismatches,
                                                                        from an
                                                                     today’s        analog glitch.
                                                                                high-speed     clocks are being intentionally dithered for
transmission line effects, and crosstalk. Similarly, signal devia-
                                                                     EMI   suppression.
                                                                        With   the MSO's digital and analog channels, many points
tions may be a by-product of digital issues like setup and
hold violations. There is a high degree of interaction                  of athe
                                                                     Since    design  can beanalyzer
                                                                                 spectrum       simultaneously    monitored.
                                                                                                        is inherently           This allows
                                                                                                                        bandwidth-limited
                                                                        the  design  engineer    to see  a  system-level   view
                                                                     as it is tuned over its frequency range, it also provides   of hisexcel-
between digital and analog signal effects.
                                                                     lentdesign  while
                                                                           dynamic      troubleshooting.
                                                                                     range   for measuringDoes      the glitch
                                                                                                              low-level         onthat
                                                                                                                          signals  onemay
For devices with just a few digital lines, a mixed signal oscillo-      signal  happen    at the  same   time  as a  rising edge  on
                                                                     be otherwise masked by noise. Examples include impulse
scope (MSO) provides both analog and digital measurement                another
                                                                     noise,  clocksignal,  indicating
                                                                                    glitches          a cross-talk
                                                                                              from metastable         problem?
                                                                                                                  events,    and crosstalk
capabilities. That enables simultaneous analysis of both                Understanding      the context   in which  an   event  occurred
                                                                     signals in the presence of higher amplitude signals.
domains with one instrument.                                            can be valuable while debugging digital systems. Some
For more complex devices, with many digital signals, a full-            performance MSOs offer advanced triggering in which
featured logic analyzer integratedwith an oscilloscope is the           the MSO's digital channels can be used to qualify analog
right choice.                                                           triggers. The MSO looks for a digital pattern first before
Efficient troubleshooting calls for tools and methods that can          applying the analog trigger, capturing only the important
address both the analog and digital domains. Capturing the              signal changes.
interaction between multiple domains, and displaying time-              To view both domains, both the analog and digital
                                                                     To help detect signal integrity problems, a spectrum analyzer
correlated signals in both analog and digital forms, is the key         channels of the MSO must be connected to the signal.
                                                                     is typically used to determine how frequency and amplitude
to efficient troubleshooting as shown in Figure 14.                     Depending on the MSO, this may require attaching two
                                                                     parameters behave over short and long intervals of time.
                                                                        probes to the signal - one analog probe and one logic
                                                                     Common measurement tasks include:
                                                                        probe. To minimize the effect of probe loading on the
                                                                         Observing signals masked by noise
                                                                        signal under test, the capacitance of both probes must
                                                                         Seeing
                                                                        be       tonal clock
                                                                            minimized,        signals masked
                                                                                         as discussed  earlier. within spread
                                                                                                                For high-speed
                                                                         spectrum   signals
                                                                        signals, even low capacitance probes may significantly
                                                                         Finding
                                                                        load  theand   analyzing
                                                                                  signal,        transient
                                                                                          impacting        and dynamic signals
                                                                                                     measurements.
                                                                       Capturing burst
                                                                       Performance       transmissions,
                                                                                      MSOs                 glitches
                                                                                              offer a unique          and
                                                                                                                feature  toswitching
                                                                                                                            address this
                                                                       transients
                                                                       problem - analog multiplexing. This allows the design
                                                                       Characterizing
                                                                       engineer        PLL
                                                                                 to view     settling
                                                                                          a signal    times, frequency
                                                                                                    connected     to any ofdrift
                                                                                                                             theand
                                                                                                                                 logic
                                                                       microphonics
                                                                       probe connections in simultaneous analog and digital
                                                                       views.  This minimizesclock
                                                                       Frequency-stepped        probe   loading since only one
                                                                                                     signals
                                                                       probe
                                                                       Testingisand
                                                                                 connected,
                                                                                    diagnosingan important
                                                                                                  transient EMIfeature  for high-speed
                                                                                                                   effects
                                                                       signals.
                                                                       Characterizing time-variant modulation schemes
                                                                       With an MSO, logic analyzer functionality is combined
                                                                       with an oscilloscope, providing a powerful tool for
                                                                       troubleshooting signal integrity problems.




                                                                                                        www.tektronix.com/signal_integrity   17
Primer



                                                                                      Common measurement tasks include:
                                                                                        Observing signals masked by noise
                                                                                        Seeing tonal clock signals masked within spread
                                                                                        spectrum signals
                                                                                        Finding and analyzing transient and dynamic signals
                                                                                        Capturing burst transmissions, glitches and switching
                                                                                        transients
                                                                                        Characterizing PLL settling times, frequency drift and
                                                                                        microphonics
                                                                                        Frequency-stepped clock signals
                                                                                        Testing and diagnosing transient EMI effects
                                                                                        Characterizing time-variant modulation schemes
Figure 14. Crosstalk errors are quickly identified with time-correlated digital and     Isolating software and hardware interactions
analog measurements on the same display.
                                                                                      Traditional swept spectrum analyzers (SA) and vector signal
Revealing the Frequency Domain with
                                                                                      analyzers (VSA) provide snapshots of the signal in the fre-
Real-Time Spectrum Analyzers
                                                                                      quency domain or in the modulation domain. But often that's
For some elusive events, a measurement tool with improved                             not enough information to confidently describe the dynamic
frequency resolution may be required to see subtle frequency                          nature of modern signals. Spectrum analyzers are not all
events such as clock phase-slip, microphonics, and phase                              equal in their capabilities to see transient events.
lock loop (PLL) settling. Since a spectrum analyzer provides
                                                                                      Each of the measurement tasks listed above involves
much greater frequency resolution than an oscilloscope, it
                                                                                      high-frequency (RF) signals that change over time, often
can be an invaluable tool for tracking down these events. It is
                                                                                      unpredictably. To effectively characterize these signals,
also a good tool for measuring the frequency tolerance of
                                                                                      engineers need a tool that can discover elusive events,
dither generation, which is becoming more common as
                                                                                      effectively trigger on those events and isolate them into
today’s high-speed clocks are being intentionally dithered for
                                                                                      memory so that signal behavior can be analyzed in the
EMI suppression.
                                                                                      frequency, time, modulation, statistical and code domains.
Since the spectrum analyzer is inherently bandwidth-limited
as it is tuned over its frequency range, it also provides excel-
lent dynamic range for measuring low-level signals that may
be otherwise masked by noise. Examples include impulse
noise, clock glitches from metastable events, and crosstalk
signals in the presence of higher amplitude signals.
To help detect signal integrity problems, a spectrum analyzer
is typically used to determine how frequency and amplitude
parameters behave over short and long intervals of time.




18   www.tektronix.com/signal_integrity
                                                                                                             Fundamentals of Signal Integrity



                                                                               With the RTSA’s unique architecture, it is possible to trigger
   DPX Technology: a Revolutionary Tool for                                    on an event in the frequency domain, capture a continuous
   Signal Discovery                                                            time record of changing RF events and perform time-correlat-
                                                                               ed analysis in all domains, speeding troubleshooting of RF
                                                                               signal integrity issues.
                                                                               Since an RTSA must take all of the information contained
                                                                               in a time domain waveform and transform it into frequency
                                                                               domain signals, there are several important signal processing
   Figure 14. DPX Spectrum display shows tonal clock signals within a
   spread spectrum clock. The tonal signals are temperature colored “hot” to   requirements to consider when choosing an RTSA for signal
   demonstrate the proportionality of occurrence in the time domain. The       integrity analysis: frequency range, capture bandwidth,
   spread spectrum clock is “cool” to demonstrate the time-varying nature of
   the signal over time.                                                       sample rate, analysis interval and minimum event duration.

   Tektronix’ patented Digital Phosphor technology, or                         Capture Bandwidth and Frequency Range
   DPX, reveals signal details that are completely missed                      The RTSA’s frequency range and capture bandwidth are
   by conventional spectrum analyzers and vector signal                        critical parameters. It’s important to choose the right RTSA
   analyzers. The spectrum display is an intuitive live                        for the signal of interest, with considerations for things like the
   color view of signal transients changing over time in                       signal's fundamental frequency, modulation type, frequency
   the frequency domain, giving immediate confidence in                        spread, and PLL tuning steps.
   the stability of a design or instantly displaying a fault
   when it occurs. For example, Figure 14 is a spectrum                        Sample Rate
   taken for system level EMI diagnostics. It shows the                        The RTSA’s analog-to-digital converter (ADC) clock rate must
   emissions and abundance of clock sources that are                           be high enough to exceed the Nyquist criteria for the capture
   increasing the overall energy at a given frequency.                         bandwidth that's necessary for a particular measurement.
   At up to 48,000 spectrum updates per second,
   only the DPX spectrum can give the insight needed                           Analysis Interval
   that energy from multiple signals exists within the                         The analysis interval must be long enough to support the
   spread-spectrum clock frequency.                                            narrowest resolution bandwidth of interest when repetitive
                                                                               Fourier transforms are being used to discover, capture and
The Real-Time Spectrum Analyzer (RTSA) is designed to                          analyze infrequent transient events in the frequency domain.
overcome the measurement limitations of the SA and VSA to
                                                                               Minimum Event Duration
better address the challenges associated with transient and
                                                                               A minimum event is defined as the narrowest, non-repetitive
dynamic RF signals. The RTSA performs signal analysis using
                                                                               rectangular pulse that can be captured with 100% certainty
real-time digital signal processing (DSP) that occurs prior
                                                                               at the specified accuracy. Narrower events can be detected,
to memory storage unlike the post-acquisition processing
                                                                               but the accuracy and probability may degrade. Minimum
common in the VSA architectures. Real-time processing
                                                                               event duration will depend largely on the RTSA’s DFT trans-
allows the user to discover and trigger on events with 100%
                                                                               form rate. For example, an RTSA with a 48,000 spectrums
certainty, given the minimum event duration of the signal and
                                                                               per second DFT transform rate can detect RF pulses as
the bandwidth of the spectrum analyzer. Once captured, the
                                                                               short as 24 microseconds with 100% probability and with
data can then be extensively analyzed in multiple domains –
                                                                               full specified accuracy. By comparison, a swept spectrum
time, frequency and modulation - using batch processing.
                                                                               analyzer with 50 sweeps per second requires pulses longer
                                                                               than 20 milliseconds for 100% probability of detection at
                                                                               full accuracy.




                                                                                                               www.tektronix.com/signal_integrity   19
Primer




                                   Ideal Edge                                                                Measured
                                    Positions                                                                Waveform



                         TIE1                                           TIE2                                  TIE3                             TIE4




Figure 15. Time-interval error is the difference between the recovered clock and the actual waveform edge.



Multi-Domain Analysis                                                                     timing jitter in a system becomes a significant percentage of
An RTSA may be integrated in with a logic analyzer and oscil-                             the signaling interval. Under these circumstances, jitter
loscope, allowing the user to trigger in the frequency domain                             becomes a fundamental performance limit. Understanding
and capture time-correlated frequency (RTSA), time (oscillo-                              what jitter is, and how to characterize it, is the first step to
scope) and digital (logic analyzer) signals, for in-depth analy-                          successfully deploy high-speed systems that dependably
sis of signal integrity problems. A RTSA is an indespensible                              meet their performance requirements.
tool for detecting and analyzing subtle frequency events that                             Conceptually, jitter is the deviation of timing edges from their
require a measurement tool with tight frequency resolution.                               “correct” locations. In a timing-based system, timing jitter
Also, its high dynamic range enables the measurement of                                   is the most obvious and direct form of non-ideal behavior.
low-level signals that may otherwise be masked by noise. As                               As a form of noise, jitter must be treated as a random
designs drive to high-speed data rates, requiring fast timing                             process and characterized in terms of its statistics.
and techniques like clock dithering, the RTSA will become a                               Jitter is divided into two generalized categories: deterministic
critical part of the signal integrity measurement tool set.                               jitter and random jitter. Deterministic jitter is predictable and
Simplifying Complex Measurements with                                                     consistent, and it has specific causes. Random jitter exhibits
Jitter Analysis Tools                                                                     a Gaussian distribution which is theoretically unconstrained
Signal integrity analysis is not always a matter of finding a                             in amplitude. Since random jitter normally fits a Gaussian
slow edge or a low signal amplitude somewhere in the                                      distribution, certain statistical rules apply.
system. As explained earlier, factors like timing jitter can play                         Time-interval error (TIE) is the basis for many jitter measure-
a large role in system stability. Jitter typically originates in the                      ments. TIE is the difference between the recovered clock
clock circuitry but can also arise from power supply noise,                               (the jitter timing reference) and the actual waveform edge,
crosstalk, and PLL circuits. Jitter can affect data, addresses,                           as shown in Figure 15. Performing histogram and spectrum
enable lines and, in fact, virtually any signal in the system.                            analysis on the TIE waveform provides the basis for
In today’s high-speed designs, as signaling rates climb above                             advanced jitter measurements, which is a key step in tracking
2 GHz and voltage swings shrink to conserve power, the                                    down the root cause of jitter in the DUT.




20   www.tektronix.com/signal_integrity
                                                                                                      Fundamentals of Signal Integrity




Figure 16. Total jitter spectrum.



With the spectrum approach, jitter is measured by using an
oscilloscope to acquire a single shot or real-time acquisition
of the data signal. To most accurately capture the jitter,
it’s essential that the oscilloscope have the best available
timing accuracy, signal-to-noise ratio, effective bits and signal   Figure 17. TDR impedance measurement screen.

fidelity.
After the acquisition is complete, the record is parsed by soft-    software packages, oscilloscopes provide other useful func-
ware to determine the TIE for each of the clock edges. Then         tions like cycle-to-cycle measurements, trend and spectrum
the TIE results are passed through an FFT to compute their          plots, data logging and worst case capture. When more
spectrum. The result is a spectrum of the acquired signal’s         dynamic range is needed, a real-time spectrum analyzer
jitter, which shows the various components of the total jitter,     (RTSA) may be the best solution, especially if jitter needs
as shown in Figure 16. Once that is complete, the Bit Error         to be measured in the presence of interfering signals.
Rate (BER) resulting from jitter can be estimated.                  Regardless of the approach, software tools are available to
                                                                    simplify complex jitter measurements.
In cases where more dynamic range is required, a real-time
spectrum analyzer (RTSA) may be the right choice for jitter         Providing Critical Impedance Measurements
measurements. Because an RTSA is, by definition, band-lim-          with Time Domain Reflectometry Solutions
ited to its capture bandwidth (which in turn is processed by
                                                                    The ideal tool for measuring impedances and channel loss
a resolution bandwidth filter), the noise floor of an RTSA
                                                                    is a sampling oscilloscope equipped with a Time Domain
measurement is much lower than that of an oscilloscope.
                                                                    Reflectometer (TDR) module. The TDR module enables the
That makes the RTSA much more sensitive to low level spuri-
                                                                    signal transmission environment to be analyzed in the time
ous signals that are embedded in noise. The RTSA is also
                                                                    domain, just as the signal integrity of live signals will be
capable of measuring the jitter on a small signal that's in the
                                                                    analyzed in the time domain.
presence of larger ones.
                                                                    Time domain reflectometry measures the reflections that
Jitter measurement is a challenge that grows in importance,
                                                                    result from a signal traveling through transmission environ-
with each new advancement in system performance and
                                                                    ments like circuit board traces, cables or connectors. The
data rates. There are several approaches to jitter measure-
                                                                    TDR display will show the impedance variations in the
ment, and each has its own strengths and tools. The oscillo-
                                                                    signal path. Figure 17 is an example of a TDR impedance
scope offers the ability to observe jitter, using techniques
                                                                    measurement screen.
like histograms and eye diagrams. With back-end processing




                                                                                                        www.tektronix.com/signal_integrity   21
Primer



                                                                            TDR Display
                                            Incident
                   Step
                  Source                      Reflected                                        A      B                        C        D      E
                                                                             ±5%


              Sampler                                        DUT




Figure 18. Block diagram of a TDR acquisition setup using a TDR module.



To make impedance measurements, the TDR instrument
sends a fast step pulse through the medium and displays                                         PCI Express                     Via
                                                                                                                                            BGA
the reflections from the observed transmission environment.                                                                                 Pad
Figure 18 is a simplified block diagram of this scheme.
The resulting TDR display is a voltage waveform that includes             Figure 19. In this example, the TDR impedance display reveals how PCB features
the incident step and the reflections from the transmission               such as connectors and vias can cause deviations in the impedance environment.

medium. The reflections increase or decrease the step ampli-
                                                                          capability.
tude depending on whether the resistance is higher or lower
at the mismatch, or if the nature of the discontinuity is more            Channel Count
inductive or capacitive, respectively.                                    Some device designs require TDR measurements on multiple
The impedance display is read from left to right. The left-most           signal paths. For instance, a multi-lane, differential bus could
events are those physically closest to the step generator,                require measurements on several differential pairs for multi-
which is the origin of the signal. The reflections on the display         lane impedance characterization. Crosstalk and through
are produced by the elements along the signal path when                   measurements require connection to at least two different
they receive the energy from the incident step, as shown in               points on the DUT. When choosing a TDR solution, channel
Figure 19. A perfect path with perfect terminations would                 count should be a consideration.
produce no reflections.
                                                                          Rise Time
The same measurement tools can also be used to visualize
                                                                          The physical spacing of any two discontinuities determines
and measure the transmission of the signal through the chan-
                                                                          how closely their reflections will be positioned relative to each
nel; this TDT (time domain transmission) simply replaces
                                                                          other on the TDR waveform of the signal path. To distinguish
acquisition of the reflected signal by the acquisition of the
                                                                          between two neighboring discontinuities, the distance
transmitted waveform.
                                                                          between them must be less than half of the rise time for the
The ability of a TDR/TDT instrument to accurately capture                 TDR instrument. A faster rise time will result in more accurate
and measure impedance discontinuities along a signal path                 impedance measurements.
depends on four key parameters: channel count, system rise
time, incident step quality and differential TDR measurement




22   www.tektronix.com/signal_integrity
                                                                                               Fundamentals of Signal Integrity



Incident Step Quality                                              Signal Generators Complete the
The quality of the incident step pulse provided by the TDR         Measurement System
instrument is also critical, especially when measuring short       An oscilloscope, logic analyzer or other acquisition instrument
traces. The step pulse must have a fast rise time, accurate        can only make a measurement when there is some kind of
amplitude and, to ensure quality measurements, it must be          signal to acquire. And there are many instances in which no
free of aberrations.                                               such signal is available unless it is externally provided.
                                                                   Checking the characteristics of a trace or determining the
Differential TDR Measurements
                                                                   impedance of a connector are both examples of debug situa-
Many of today’s high-speed serial standards rely on differen-      tions where an external signal is required to make the meas-
tial transmission techniques, using complementary signals.         urement. In other situations, an external stimulus is needed to
Two “wires”, or PCB traces, carry simultaneous mirror images       replicate sensor signals or simulate other missing system
of the signal. Although it's more complex than the single-         inputs for the DUT to even function.
ended approach, differential transmission is less vulnerable to
                                                                   Signal generators are also needed for functional verification,
external influences like crosstalk and induced noise, and it
                                                                   characterization and stress testing of electronic designs.
generates less of both.
                                                                   Engineers need to characterize their emerging designs to
Differential paths require TDR measurements just the same as       make sure that new hardware meets design specifications
in other transmission environments. The incident pulse must        across the full range of operation and beyond. This is known
be sent down both sides of the differential pair and the reflec-   as “margin” or “limit testing”. It’s a measurement task that
tions measured. With true differential TDR measurements, the       requires a complete solution; one that can generate signals
DUT receives a differential stimulus signal similar to what it     as well as make measurements.
will encounter in the end user application, providing insight
                                                                   Most signal generators today are based on digital technology.
into the device’s real-world response. True differential TDR
                                                                   Many of them can fulfill both analog and digital requirements,
measurements require a TDR instrument capable of launch-
                                                                   but the most efficient solution is usually a signal generator
ing simultaneous and complementary incident pulses.
                                                                   that has features that can be optimized for the particular
TDR measurements provide critical information on impedance         application – either analog or digital.
discontinuities within a device, which can reveal potential
                                                                   Arbitrary waveform generators (AWG) and arbitrary function
causes for signal integrity problems. Analyzing the transmis-
                                                                   generators (AFG) are aimed primarily at analog and mixed-
sion environments of circuit board traces, cables or connec-
                                                                   signal applications, with faster AWGs also being used for
tors may be necessary to track down the root cause of a
                                                                   high-speed serial data testing. These instruments use sam-
problem.
                                                                   pling techniques to build and modify waveforms of almost
                                                                   any imaginable shape. For example, with the AWG, it’s
                                                                   possible to create signals with specific jitter profiles that
                                                                   encompass full channel characteristics without the need
                                                                   for other external generators or hardware.




                                                                                                 www.tektronix.com/signal_integrity   23
Primer



Digital waveform generators encompass two classes of               Memory Depth
instruments. Pulse generators drive a stream of square waves       Memory depth determines the maximum number of samples
or pulses from a small number of outputs, usually at very          that can be stored to define a waveform. Particularly in
high frequencies. These tools are most commonly used to            the case of complex waveforms, memory depth is critical
exercise high-speed digital equipment. Pattern generators,         in reproducing signal details accurately, since many samples
also known as data generators (or data timing generators),         are necessary to create the transitions and fluctuations
typically provide eight, sixteen or even more synchronized         in the signal.
digital pulse streams as a stimulus signal for computer buses
or other devices.                                                  Sample Rate
There are several ways to create waveforms with a signal           Sample rate is also a critical factor affecting the frequency
generator. The method of choice depends upon the informa-          and fidelity of the output signal. Sample rate (usually specified
tion available about the DUT and its input requirements;           in terms of megasamples or gigasamples per second),
whether there is a need to add distortion, error signals, or       denotes the maximum clock or sample rate at which the
other variables. Typical methods include:                          instrument can operate. The Nyquist Sampling Theorem
                                                                   states that the sampling frequency, or clock rate, must be
     Creating brand new signals for circuit stimulus and testing
                                                                   more than twice that of the highest spectral frequency com-
     Synthesizing an unavailable real-world signal captured
                                                                   ponent of the generated signal to ensure accurate signal
     from an oscilloscope or a logic analyzer
                                                                   reproduction. Since complex waveforms can have high-fre-
     Generating ideal or stressed reference signals for industry
                                                                   quency information in their pulse edges and transients, a
     standards with specific tolerances
                                                                   faster sample rate will enable the accurate reproduction of
The ability of a signal generator to accurately replicate a        a complex signal.
desired signal depends on a few different performance
criteria: channel count, memory depth, sample rate, band-          Bandwidth
width and availability of a sequence controller.                   The signal generator’s bandwidth is an analog term that
                                                                   exists independently of its sample rate. The analog band-
Channel Count                                                      width of a signal generator’s output circuitry must be suffi-
Typically, AWGs and AFGs have one to four outputs. In              cient to handle the maximum frequency that its sample rate
some AWGs, these main sampled analog outputs are supple-           will support. In other words, there must be enough band-
mented by separate marker outputs to aid the triggering            width to pass the highest frequencies and transition times
of external instruments and synchronous digital outputs that       that can be clocked out of the memory, without degrading
present sample-by-sample data in digital form.                     signal characteristics.




24    www.tektronix.com/signal_integrity
                                                                                                            Fundamentals of Signal Integrity



Sequence Controller
It’s often necessary to create long waveform files to fully exer-
cise the DUT. Where portions of the waveforms are repeated,
a waveform sequencing function can save a lot of tedious,
memory-intensive waveform programming effort.
Sequencing allows a large number of “virtual” waveform
cycles to be stored in the instrument’s memory. The wave-
form sequencer borrows instructions from the computer
world: loops, jumps, etc. These instructions, which reside in a
sequence memory separate from the waveform memory,
cause specified segments of the waveform memory to
repeat. With a sequence controller, a waveform of almost
unlimited length can be generated.
The signal generator is the stimulus source that combines
with an acquisition instrument to make up the two elements
of a complete measurement solution. The two tools flank the
input and output terminals of the DUT as shown in Figure 21.
In its various configurations, the signal generator can provide
stimulus signals in the form of things like analog waveforms,
digital data patterns, modulation, intentional distortion and
noise. To make effective design, characterization, or trou-
bleshooting measurements, it’s important to consider both
elements of the solution.




                                                                    Figure 20. Most measurements require a solution made up of a signal generator
                                                                    paired with an acquisition instrument. Triggering connectivity simplifies capturing
                                                                    the DUT output signal.




                                                                                                              www.tektronix.com/signal_integrity          25
Primer



Summary
Signal integrity measurements have become a critical step
in the process of developing digital systems. The design
engineer is tasked with isolating and eliminating these
problems anywhere in the system.
A powerful and complete measurement tool set is needed
to do that; One that has the bandwidth and time-saving
features to properly address high-speed signal deviations.

These tools include digitizing oscilloscopes,
mixed signal oscilloscopes, logic analyzers, real-
time spectrum analyzers, time-domain reflec-
tometry solutions, signal generators, high-fidelity
probes and analysis software.
Innovative measurement solutions such as high-density
compression probes, application-specific jitter software and
integrated logic analyzer/oscilloscope waveform viewing
have emerged to help designers deal with problems that
affect signal integrity. Using these powerful tools, the engineer
can quickly locate and trace faults back to their source.
Until recently, unseen signal integrity problems were often
the cause of schedule delays and reliability issues with new
digital products. Now the designer has the measurement
solutions to overcome even the toughest signal integrity
challenges.
                                                                    Figure 21. A complete tool set for signal integrity measurements may include an
                                                                    oscilloscope, logic analyzer, real-time spectrum analyzer, time-domain reflectometer,
                                                                    signal generator, probes and analysis software.




26   www.tektronix.com/signal_integrity
Fundamentals of Signal Integrity




 www.tektronix.com/signal_integrity   27
                                                        Contact Tektronix:
                                        ASEAN / Australasia (65) 6356 3900
                                                       Austria +41 52 675 3777
Balkans, Israel, South Africa and other ISE Countries +41 52 675 3777
                                                           Belgium 07 81 60166
                                                     Brazil +55 (11) 3759 7600
                                                      Canada 1 (800) 661-5625
       Central East Europe, Ukraine and the Baltics +41 52 675 3777
                               Central Europe & Greece +41 52 675 3777
                                                      Denmark +45 80 88 1401
                                                      Finland +41 52 675 3777
                                                 France +33 (0) 1 69 86 81 81
                                                Germany +49 (221) 94 77 400
                                                  Hong Kong (852) 2585-6688
                                                         India (91) 80-42922600
                                                           Italy +39 (02) 25086 1
                                                        Japan 81 (3) 6714-3010
                                           Luxembourg +44 (0) 1344 392400
       Mexico, Central/South America & Caribbean 52 (55) 54247900
                   Middle East, Asia and North Africa +41 52 675 3777
                                             The Netherlands 090 02 021797
                                                              Norway 800 16098
                           People’s Republic of China 86 (10) 6235 1230
                                                       Poland +41 52 675 3777
                                                           Portugal 80 08 12370
                                         Republic of Korea 82 (2) 6917-5000
                                              Russia & CIS +7 (495) 7484900
                                                South Africa +27 11 206 8360
                                                       Spain (+34) 901 988 054
                                                          Sweden 020 08 80371
                                                 Switzerland +41 52 675 3777
                                                      Taiwan 886 (2) 2722-9622
                          United Kingdom & Ireland +44 (0) 1344 392400
                                                          USA 1 (800) 426-2200
                For other areas contact Tektronix, Inc. at: 1 (503) 627-7111
                                         Contact List Updated 04 August 2009




         For Further Information
         Tektronix maintains a comprehensive, constantly expanding
         collection of application notes, technical briefs and other
         resources to help engineers working on the cutting edge of
         technology. Please visit www.tektronix.com

        Copyright © 2008, Tektronix. All rights reserved. Tektronix products are covered
        by U.S. and foreign patents, issued and pending. Information in this publication
        supersedes that in all previously published material. Specification and price
        change privileges reserved. TEKTRONIX and TEK are registered trademarks
        of Tektronix, Inc. All other trade names referenced are the service marks,
        trademarks or registered trademarks of their respective companies.
        11/09 Internal/WWW                                                  54W-22137-1


==========================================
FILE: mt-094.pdf
==========================================

                                                                                  MT-094
                                                                                TUTORIAL

                           Microstrip and Stripline Design

INTRODUCTION

Much has been written about terminating PCB traces in their characteristic impedance, to avoid
signal reflections. However, it may not be clear when transmission line techniques are
appropriate.

A good guideline to determine when the transmission line approach is necessary for logic signals
is as follows:

Terminate the transmission line in its characteristic impedance when the one-way propagation
delay of the PCB track is equal to or greater than one-half the applied signal rise/fall time
(whichever edge is faster).

For example, a 2 inch microstrip line over an Er = 4.0 dielectric would have a delay of about 270
ps. Using the above rule strictly, termination would be appropriate whenever the signal rise time
is less than approximately 500 ps.

A more conservative rule is to use a 2 inch (PCB track length)/nanosecond (rise/fall time) rule. If
the signal trace exceeds this trace-length/speed criterion, then termination should be used.

For example, PCB tracks for high-speed logic with rise/fall time of 5 ns should be terminated in
their characteristic impedance if the track length is equal to or greater than 10 inches (where
measured length includes meanders).

In the analog domain, it is important to note that this same 2 inch/nanosecond guideline should
also be used with op amps and other circuits, to determine the need for transmission line
techniques. For instance, if an amplifier must output a maximum frequency of fmax, then the
equivalent risetime tr is related to this fmax. This limiting risetime, tr, can be calculated as:

                                               tr = 0.35/fmax                                 Eq. 1

The maximum PCB track length is then calculated by multiplying tr by 2 inch/nanosecond. For
example, a maximum frequency of 100 MHz corresponds to a risetime of 3.5 ns, so a 7-inch or
more track carrying this signal should be treated as a transmission line.

DESIGNING CONTROLLED IMPEDANCES TRACES ON PCBS

A variety of trace geometries are possible with controlled impedance designs, and they may be
either integral to or allied to the PCB pattern. In the discussions below, the basic patterns follow
those of the IPC, as described in standard 2141A (see Reference 1).




Rev.0, 01/09, WK                            Page 1 of 7
                                                                                   MT-094
Note that the figures below use the term "ground plane". It should be understood that this plane
is in fact a large area, low impedance reference plane. In practice it may actually be either a
ground plane or a power plane, both of which are assumed to be at zero ac potential.

The first of these is the simple wire-over-a-plane form of transmission line, also called a wire
microstrip. A cross-sectional view is shown in Figure 1. This type of transmission line might be
a signal wire used within a breadboard, for example. It is composed simply of a discrete
insulated wire spaced a fixed distance over a ground plane. The dielectric would be either the
insulation wall of the wire, or a combination of this insulation and air.

                                                     D
                                  WIRE




                                                DIELECTRIC         H




                              GROUND PLANE



Figure 1: A Wire Microstrip Transmission Line With Defined Impedance is Formed
                by an Insulated Wire Spaced From a Ground Plane

The impedance of this line in ohms can be estimated with Eq. 2. Here D is the conductor
diameter, H the wire spacing above the plane, and εr the dielectric constant.

                                                     60   ⎡ 4H ⎤
                                         Zo (Ω ) =     ln ⎢ ⎥ .                           Eq. 2
                                                     εr ⎣ D ⎦

For patterns integral to the PCB, there are a variety of geometric models from which to choose,
single-ended and differential. These are covered in some detail within IPC standard 2141A (see
Reference 1), but information on two popular examples is shown here.

Before beginning any PCB-based transmission line design, it should be understood that there are
abundant equations, all claiming to cover such designs. In this context, "Which of these are
accurate?" is an extremely pertinent question. The unfortunate answer is, none are perfectly so!
All of the existing equations are approximations, and thus accurate to varying degrees,
depending upon specifics. The best known and most widely quoted equations are those of
Reference 1, but even these come with application caveats.

Reference 2 has evaluated the Reference 1 equations for various geometric patterns against test
PCB samples, finding that predicted accuracy varies according to target impedance. The
equations quoted below are from Reference 1, and are offered here as a starting point for a
design, subject to further analysis, testing and design verification. The bottom line is, study
carefully, and take PCB trace impedance equations with a proper dose of salt.



                                             Page 2 of 7
                                                                                     MT-094
MICROSTRIP PCB TRANSMISSION LINES

For a simple two-sided PCB design where one side is a ground plane, a signal trace on the other
side can be designed for controlled impedance. This geometry is known as a surface microstrip,
or more simply, microstrip.

A cross-sectional view of a two-layer PCB illustrates this microstrip geometry as shown in
Figure 2.

                                  TRACE
                                                    W
                                                             T


                                                DIELECTRIC          H




                               GROUND PLANE



Figure 2: A Microstrip Transmission Line with Defined Impedance is Formed by a
       PCB Trace of Appropriate Geometry, Spaced from a Ground Plane

For a given PCB laminate and copper weight, note that all parameters will be predetermined
except for W, the width of the signal trace. Eq. 3 can then be used to design a PCB trace to match
the impedance required by the circuit. For the signal trace of width W and thickness T, separated
by distance H from a ground (or power) plane by a PCB dielectric with dielectric constant εr, the
characteristic impedance is:

                                          87         ⎡ 5.98H     ⎤
                            Zo (Ω ) =              ln ⎢                                     Eq. 3
                                        ε r + 1.41 ⎣ (0.8W + T )⎥⎦

Note that in these expressions, measurements are in common dimensions (mils).

These transmission lines will have not only a characteristic impedance, but also capacitance.
This can be calculated in terms of pF/in as shown in Eq. 4.

                                                 0.67(ε r + 1.41)
                              Co (pF/in ) =                                                 Eq. 4
                                              ln[5.98H (0.8W + T )]

As an example including these calculations, a 2-layer board might use 20-mil wide (W),
1 ounce (T=1.4) copper traces separated by 10-mil (H) FR-4 (εr = 4.0) dielectric material. The
resulting impedance for this microstrip would be about 50 Ω. For other standard impedances, for
example the 75-Ω video standard, adjust "W" to about 8.3 mils.




                                              Page 3 of 7
                                                                                       MT-094
SOME MICROSTRIP GUIDELINES

This example touches an interesting and quite handy point. Reference 2 discusses a useful
guideline pertaining to microstrip PCB impedance. For a case of dielectric constant of 4.0 (FR-
4), it turns out that when W/H is 2/1, the resulting impedance will be close to 50 Ω (as in the first
example, with W = 20 mils).

Careful readers will note that Eq. 3 predicts Zo to be about 46 Ω, generally consistent with
accuracy quoted in Reference 2 (>5%). The IPC microstrip equation is most accurate between 50
and 100 Ω, but is substantially less so for lower (or higher) impedances.

The propagation delay of the microstrip line can also be calculated, as per Eq. 5. This is the one-
way transit time for a microstrip signal trace. Interestingly, for a given geometry model, the
delay constant in ns/ft is a function only of the dielectric constant, and not the trace dimensions
(see Reference 6). Note that this is quite a convenient situation. It means that, with a given PCB
laminate (and given εr), the propagation delay constant is fixed for various impedance lines.

                                    t pd (ns/ft ) = 1.017 0.475ε r + 0.67                      Eq. 5

This delay constant can also be expressed in terms of ps/in, a form which will be more practical
for smaller PCBs. This is:

                                    t pd (ps/in ) = 85 0.475ε r + 0.67                         Eq. 6

Thus for an example PCB dielectric constant of 4.0, it can be noted that a microstrip's delay
constant is about 1.63 ns/ft, or 136 ps/in. These two additional rules-of-thumb can be useful in
designing the timing of signals across PCB trace runs.

SYMMETRIC STRIPLINE PCB TRANSMISSION LINES

A method of PCB design preferred from many viewpoints is a multi-layer PCB. This
arrangement embeds the signal trace between a power and a ground plane, as shown in the cross-
sectional view of Figure 3. The low-impedance ac-ground planes and the embedded signal trace
form a symmetric stripline transmission line.

As can be noted from the figure, the return current path for a high frequency signal trace is
located directly above and below the signal trace on the ground/power planes. The high
frequency signal is thus contained entirely inside the PCB, minimizing emissions, and providing
natural shielding against incoming spurious signals.




                                            Page 4 of 7
                                                                                       MT-094


                                                     DIELECTRIC
                                                                        H
                                                    W
                               GROUND,
                                POWER                           T           B
                               PLANES
                                                                        H
                                               EMBEDDED
                                                 TRACE




  Figure 3: A Symmetric Stripline Transmission Line With Defined Impedance is
  Formed by a PCB Trace of Appropriate Geometry Embedded Between Equally
                     Spaced Ground and/or Power Planes

The characteristic impedance of this arrangement is again dependent upon geometry and the εr of
the PCB dielectric. An expression for ZO of the stripline transmission line is:


                                 Zo (Ω ) =
                                              60
                                                    ln
                                                         ⎡ 1.9(B ) ⎤ .                        Eq. 7
                                               εr        ⎢⎣ (0.8W + T )⎥⎦

Here, all dimensions are again in mils, and B is the spacing between the two planes. In this
symmetric geometry, note that B is also equal to 2H + T. Reference 2 indicates that the accuracy
of this Reference 1 equation is typically on the order of 6%.

Another handy guideline for the symmetric stripline in an εr = 4.0 case is to make B a multiple of
W, in the range of 2 to 2.2. This will result in an stripline impedance of about 50 Ω. Of course
this rule is based on a further approximation, by neglecting T. Nevertheless, it is still useful for
ballpark estimates.

The symmetric stripline also has a characteristic capacitance, which can be calculated in terms of
pF/in as shown in Eq. 8.

                                                           1.41(ε r )
                               Co (pF/in ) =                                .                 Eq. 8
                                                ln[3.81H (0.8W + T )]

The propagation delay of the symmetric stripline is shown in Eq. 9.

                                         t pd (ns/ft ) = 1.017 ε r                            Eq. 9

or, in terms of ps:

                                             t pd (ps/in ) = 85 ε r                          Eq. 10




                                                Page 5 of 7
                                                                                      MT-094
For a PCB dielectric constant of 4.0, it can be noted that the symmetric stripline's delay constant
is almost exactly 2 ns/ft, or 170 ps/in.

SOME PROS AND CONS OF EMBEDDING TRACES

The above discussions allow the design of PCB traces of defined impedance, either on a surface
layer or embedded between layers. There of course are many other considerations beyond these
impedance issues.

Embedded signals do have one major and obvious disadvantage—the debugging of the hidden
circuit traces is difficult to impossible. Some of the pros and cons of embedded signal traces are
summarized in Figure 4.

                      NOT EMBEDDED                               EMBEDDED
          Route                                    Power
          Power                                    Route
          Ground                                   Route
          Route                                    Ground

                    Advantages
                      z Signal traces shielded and protected
                      z Lower impedance, thus lower emissions and crosstalk
                      z Significant improvement > 50MHz
                    Disadvantages
                      z Difficult prototyping and troubleshooting
                      z Decoupling may be more difficult
                      z Impedance may be too low for easy matching

   Figure 4: The Pros and Cons of Not Embedding Vs. the Embedding of Signal
                       Traces in Multi-Layer PCB Designs

Multi-layer PCBs can be designed without the use of embedded traces, as is shown in the left-
most cross-sectional example. This embedded case could be considered as a doubled two-layer
PCB design (i.e., four copper layers overall). The routed traces at the top form a microstrip with
the power plane, while the traces at the bottom form a microstrip with the ground plane. In this
example, the signal traces of both outer layers are readily accessible for measurement and
troubleshooting purposes. But, the arrangement does nothing to take advantage of the shielding
properties of the planes.

This non embedded arrangement will have greater emissions and susceptibility to external
signals, vis-a-vis the embedded case at the right, which uses the embedding, and does take full
advantage of the planes. As in many other engineering efforts, the decision of embedded vs. not-
embedded for the PCB design becomes a tradeoff, in this case one of reduced emissions vs. ease
of testing.



                                            Page 6 of 7
                                                                                                       MT-094

REFERENCES:

    1.   Standard IPC-2141A, "Controlled Impedance Circuit Boards and High Speed Logic Design," 2004,
         Institute for Interconnection and Packaging Electronic Circuits, 3000 Lakeside Drive, 309 S, Bannockburn,
         IL 60015, 847-615-7100.

    2.   Eric Bogatin, BTS015, PCB Impedance Design: Beyond the IPC Recommendations, BeTheSignal.com.

    3.   Eric Bogatin, Signal Integrity – Simplified, Prentice Hall PTR, 2003, ISBN-10: 0130669466, ISBN-13:
         978-0130669469.

    4.   Andrew Burkhardt, Christopher Gregg, Alan Staniforth, "Calculation of PCB Track Impedance," Technical
         Paper S-19-5, presented at the IPC Printed Circuits Expo '99 Conference, March 14–18, 1999.

    5.   Brian C. Wadell, Transmission Line Design Handbook, Artech House, Norwood, MA, 1991, ISBN: 0-
         89006-436-9.

    6.   William R. Blood, Jr., MECL System Design Handbook (HB205/D, Rev. 1A May 1988), ON
         Semiconductor, August, 2000.

    7.   Hank Zumbahlen, Basic Linear Design, Analog Devices, 2006, ISBN: 0-915550-28-1. Also available as
         Linear Circuit Design Handbook, Elsevier-Newnes, 2008, ISBN-10: 0750687037, ISBN-13: 978-
         0750687034. Chapter 12

    8.   Walt Kester, Analog-Digital Conversion, Analog Devices, 2004, ISBN 0-916550-27-3, Chapter 9. Also
         available as The Data Conversion Handbook, Elsevier/Newnes, 2005, ISBN 0-7506-7841-0, Chapter 9.

    9.   Walter G. Jung, Op Amp Applications, Analog Devices, 2002, ISBN 0-916550-26-5, Chapter 7. Also
         available as Op Amp Applications Handbook, Elsevier/Newnes, 2005, ISBN 0-7506-7844-5. Chapter 7.



Copyright 2009, Analog Devices, Inc. All rights reserved. Analog Devices assumes no responsibility for customer
product design or the use or application of customers’ products or for any infringements of patents or rights of others
which may result from Analog Devices assistance. All trademarks and logos are property of their respective holders.
Information furnished by Analog Devices applications and development tools engineers is believed to be accurate
and reliable, however no responsibility is assumed by Analog Devices regarding technical accuracy and topicality of
the content provided in Analog Devices Tutorials.




                                                     Page 7 of 7


==========================================
FILE: pcb-design-guidelines-for-reduced-emi.pdf
==========================================

PCB Design Guidelines for
     Reduced EMI


              Guided By:
              Prof. Ruchi Gajjar

              Prepared By:
              Shukla Jay (13MECE17)
                            Outline
• Power Distribution for Two-Layer Boards
• Gridding Power Traces on Two-Layer Boards
• Ferrite Bead
• Board Zoning
• Signal Traces
• Different Noises
• Common Mode Noise
• Differential Mode Noise
• Shielding
• Conclusion
• References

                                              2
    Power Distribution for Two-Layer Boards
1. Single-Point Distribution
• Each active component has its own separate power and ground
• Remain separate until they meet at a single reference point




                                                                3
    Power Distribution for Two-Layer Boards
2. Multi-Point Distribution
• Connections in daisy-chain fashion with 0-V reference points
• Potential for common impedance coupling




                                                                 4
    Power Distribution for Two-Layer Boards
3. Star Distribution
• Much like single point
• All points reference the same fixed point
• Which is located centrally by about the same length of traces
• The point where the separate traces begin is near the center of
  the board, and each trace goes in its own direction, with the
  resulting trace length equal to that of all the others




                                                                    5
Power Distribution for Two-Layer Boards




                                          6
    Gridding Power Traces on Two-Layer Boards
•    Gridding:- The network of orthogonal connections between
     traces carrying ground
•    Same noise reduction as on four-layer boards
•    Emulates the ground plane of a four-layer board by providing
     a ground return path under each of the signal traces
•    Lowers the impedance between the microcomputer and the
     voltage regulation
•    Gridding is done by expanding any ground traces and using
     ground-fill patterns to create a network of connections to
     ground across the PCB



                                                                    7
  Gridding Power Traces on Two-Layer Boards
• PCB has most of the topside traces running vertically and most
  of the bottom traces running horizontally




                                                                   8
                         Ferrite Bead
• A  passive electric component that                    suppresses   high
 frequency noise in electronic circuits




        Fig.1. Ferrite-Bead Placement Closest to the Noise Source
                                                                            9
                      Board Zoning
• Basic meaning as board floor planning, which is the process of
  defining the general location of components on the blank PCB
  before drawing in any traces
• The process of placing like functions on a board in the same
  general area, as opposed to mixing them together
• High speed logic nearer to power supply
• Less chances to pollute other signal traces
• Power supply-high speed logic-slower components-analog
  components




                                                               10
Board Zoning




               11
                      Signal Traces
1. Capacitive and Inductive Crosstalk:-
  • Keeping RF-noise-carrying traces that are connected to the
    microcomputer away from other signals so they do not pick
    up noise
  • Signals that may become victims of noise should have their
    return ground run underneath them, which serves to reduce
    their impedance, thus reducing the noise voltage and any
    radiating area
  • Never run noisy traces on the outside edge of the board
  • If possible, group a number of noisy traces together
    surrounded by ground traces


                                                             12
                      Signal Traces
  • Keep non-noisy traces away from areas on the board were
     they could pick up noise, such as connectors, oscillator
     circuits, relays, and relay drivers
2. Antenna Factor Length Rules:-
   • For Federal Communication Commission (FCC) limits,
     trace length becomes important when it is greater than 1/10
     of the wavelength
3. Series termination, Transmission lines:-
   • To provide critical damping to achieve the highest possible
     data transmission rates with the least-possible overshoot



                                                               13
                   Different Noises
1. Common Mode Noise
2. Differential Mode Noise




                                      14
                 Common Mode Noise
• Common-mode noise is a big problem in cables, but the fault
  does not lie in the cable, it lies in the connections on the board
  that the signals and returns tie to that form the common
  impedance.
• Common-mode noise is corrected either at the source, by
  reducing the impedance of the common node, or reduced by
  placing a ferrite bead around the entire cable.




                                                                   15
                Differential Mode Noise
• Differential-mode noise (the useful noise of an edge transition)
  should first be reduced to the maximum (slowest) allowable
  rise and fall times and should occur at only the minimum
  needed frequency.
• The noise radiated is due to the loop of the signal and its return.
• This loop is minimized by having as many returns as possible
  and by twisting each signal and return pair.
• The latter causes field cancellation at some distance away, in
  the same manner as routing power over ground.




                                                                    16
             Shielding




Fig.2. Mounting Filter Capacitors for External I/Os
                                                      17
                         Conclusion
• Selection of semiconductor components that produce low
  electromagnetic radiation
• Large loops of signal and corresponding ground-return lines
  that carry high frequencies must be avoided
• Filtering of critical lines, such as the supply line, ensures that
  high-frequency currents do not leave the PCB
• Eliminates antennas that can radiate electromagnetic energy
• Shielding of the total system is not required if we follow this
  rules




                                                                   18
                       References
[1] Texas Instruments, “PCB Design Guidelines for Reduced
 EMI”, 1999.
[Online] Available: http://www.ti.com/lit/an/szza009/szza009.pdf




                                                               19


==========================================
FILE: samtec-signal-integrity-handbook.pdf
==========================================

Syntax Warning: Invalid Font Weight
SIGNAL INTEGRITY
   HANDBOOK




Reference for the Selection of High-Performance Interconnects
        for Signal Integrity Optimized System Design
     SIGNAL INTEGRITY
FOR HIGH-PERFORMANCE SYSTEM DESIGN

 The 5G /6G Network, High-Performance Computing, Artificial Intelligence and Auto "2.0" industries are driving
 new architectures that demand previously unimaginable transmission speeds, bandwidths, frequencies and
 densities – all while balancing scalability, power and thermal management concerns, and of course, cost.




5G/6G NETWORK                            HPC                           AI / ML                       AUTO 2.0




 NEXT GENERATION SYSTEM SI CHALLENGES

 Interconnect solutions that support bleeding edge speeds are a necessary component of next generation
 high-performance systems. Those
 capabilities, however, can be rendered
 ineffective unless they are part of a
 well-designed and optimized system.
 A holistic approach to system design –
 particularly as speeds, bandwidths and
 densities increase – is a necessity.




 FULL SYSTEM OPTIMIZATION... FROM SILICON-TO-SILICON™

 The purpose of this handbook is to provide a reference for those with little or no signal integrity (SI) experience
 who are tasked with selecting a high-speed interconnect. The information included has been carefully developed
 by Samtec's industry-leading Signal Integrity Engineers to help facilitate informed decisions when specifying
 components that will affect a system’s signal integrity.

 For additional assistance with complex system design challenges, Samtec provides high-level design and
 engineering support both at the component level and system level - from bare die, to IC package, to PCB, to
 connectors and cables, and back again. To discuss your specific application, please contact sig@samtec.com or
 learn more about Samtec's signal integrity capabilities at samtec.com/s2s.
Table of Contents
I. SIGNAL INTEGRITY FUNDAMENTALS                    | 4-5            VI. CHANNEL PERFORMANCE METRIC                   | 13

       i.      What is Signal Integrity?
                                                                     VII. MODEL CONSIDERATIONS              | 14-15
       ii.     Single-Ended Signals

       iii. Differential Signals                                         i.    Simulation Tools

                                                                         ii.   Boundaries
II. SIGNALING TERMS              | 6
                                                                         iii. Validation
       i.      NRZ & PAM4                                                iv. Encrypted 3D Components

III. FREQUENCY DOMAIN & S-PARAMETERS | 7-9                           VIII. SYSTEM ANALYSIS        | 16-17
       i.      Insertion Loss                                            i.    Eye Diagram
       ii.     Return Loss                                               ii.   Channel Operating Margin (COM)
       iii. Crosstalk
                                                                     IX. SELECTING A CONNECTOR              | 18-19
       iv. Mode Conversion
                                                                         i.    Contact Spacing
       v.      Electromagnetic Interference
                                                                         ii.   Pin Mapping
       vi. Voltage Standing Wave Ratio (VSWR)

                                                                     X. BREAKOUT REGION DESIGN               | 20
IV. TIME DOMAIN              | 10-12
                                                                         i.    Constraints
       i.      Impedance
                                                                         ii.   Outside the BOR
       ii.     Propagation Delay and Skew

       iii. Rise Time and Dispersion                                 XI. SIGNAL INTEGRITY IN RF SYSTEMS             | 21

       iv. Apparent Impedance

                                                                   22 | Signal Integrity Tools & Support
V. SINGLESyntax Warning: Invalid Font Weight
Syntax Warning: Invalid Font Weight
 VALUE METRICS                | 13
                                                                   24 | Reference Materials & Further Reading
 i.          Effective Return Loss (ERL)                           26 | Acronyms & Abbreviations

 ii.         Integrated Crosstalk Noise / Return Loss              27 | Copyright, Trademarks & Patents



                                       Signal Integrity for High-Performance System Design                                   3
        I             Signal Integrity Fundamentals
Anytime an electrical signal is transmitted, signal integrity (SI) is a concern. Water circuits are subject to limited flow along the
water path. In a analogous manner, electrical circuits are subject to attenuation along the signal path (see Figure 1). At its most
basic level, SI ensures that a signal is transmitted from “Point A” to “Point B” with sufficient quality (or integrity) to allow effective
communication. As a term, SI typically applies to baseband signals that are transmitted using an interconnect, such as a cable,
printed circuit board (PCB) trace, or transmission line, and it also applies to broadband applications, such as those operating at
RF or microwave and millimeter wave frequencies (see "Signal Integrity in RF Systems" p. 21).


i. What is Signal Integrity?
SI needs to be considered throughout the entire system and component design process. Unlike in the past, interconnects can
no longer be treated as an afterthought. As rise times get shorter and clock frequencies increase, connectors and cables once
considered electrically transparent can have a significant effect on the quality of a system’s transmitted signal. Factors such as
crosstalk, return loss, insertion loss, and electromagnetic interference (EMI) can all play significant roles in determining what
interconnect solution is optimal for a given application. Digital interfaces use one of two types of signaling: single-ended or
differential signaling, and each has its own effects on SI.




                        Figure 1. As water circuits are subject to reduced flow along the water path. Electrical circuits
                                               are subject to attenuation along the signal path.




4                               Signal Integrity Handbook | Signal Integrity Fundamentals
ii.      Single-Ended Signals
Typically used in low-speed protocol designs, a single-ended signal is transmitted down a transmission line as a pulse
referenced between a signal conductor and a return path. The return path is often referred to as “ground,” but at higher
frequencies, the return path should be considered a critical part of the transmission line. The return path in a single-ended
system might be a ground plane under a microstrip trace, an adjacent signal pin in a connector, or the outer tape shield of
a cable. It is very challenging to achieve high data rates using single-ended signaling. Typically, data rates for single-ended
signals range from approximately DC (e.g., reset signals, LED lights) up to 8.4 Gbps (e.g., DDR memory, UCIe™).




iii.     Differential Signals
A differential signal consists of two wires, each carrying two separate pulses that switch in opposite directions. For example,
one pulse is switching from logic level 1 to 0 while the other pulse is switching from logic level 0 to 1. If a differential signal
is perfectly symmetrical or balanced, it will propagate effectively on two identical conductors, 180 degrees out of phase and
canceling the effects of symmetrically applied noise (see Figure 2).

In order to reduce interference and extend the capabilities of high-speed circuits, many interfaces have adopted a differential
signaling architecture rather than single-ended signaling. Differential signals in PCB designs are more resilient against coupling
with nearby magnetic fields (crosstalk), allowing for longer lengths and higher speeds in dense designs.




                                                                                                           Figure 2. In differeSyntax Warning: Invalid Font Weight
ntial
                                                                                                           signaling, because the
                                                                                                           two signals propagate
                                                                                                           180 degrees out of
                                                                                                           phase, they are resistant
                                                                                                           to the influence of noise,
                                                                                                           and the signal at the
                                                                                                           receiver matches the one
                                                                                                           from the sender.




                               Signal Integrity Handbook | Signal Integrity Fundamentals                                                5
       II             Signaling Terms
All interconnect products and signaling standards are defined by data rate or bandwidth capabilities, communicating the
number of bits transferred. The definitions related to these specifications are:

Bandwidth and Data Rate                                                    within an interconnect and not just the capability of a single lane.
                                                                           For example, 800 Gb Ethernet may describe eight lanes operating
Data rate references the number of bits transferred per second.
                                                                           at 100 Gbps. Use caution and context to verify data rate statements.
Bandwidth refers to the frequency spectrum required to transmit
those bits.
                                                                           Unit Interval

Baud Rate                                                                  The length of a single bit transition.
Number of signal units per second or data rate divided by number
                                                                             Unit Interval =
of bits per baud (e.g. 56 Gbps PAM4 signaling has a baud rate of                               Nyquist
28 Gbps i.e. 56 Gbps / log2(4) = 28 GBaud).
                                                                           *Computed the same way for NRZ or PAM4.
Nyquist Frequency
                                                                           Bit Error Ratio (BER)
Fastest switching speed of an interface or baud rate, divided by 2:
– Nyquist Frequency for 28 Gbps NRZ is 14 GHz                              A measure of errors occurring on a complete link. It may be a
                                                                           measured or simulated value. BER = # errors/# of bits transmitted.
– Nyquist Frequency for 56 PAM4 is 14 GHz
                                                                           Signaling standards provide minimum limits most often 1e-12
                                                                           or 1e-15. However, in some cases, detector error ratio (DER) is
Aggregate Data Rate
                                                                           specified, which details the error tolerance prior to error correction
Describes the summation of the data rates of all the individual lanes      encoding. Examples of DER targets are 1e-4 and 1e-6.



i. NRZ & PAM4
For the last few decades, high-speed
links in the data center and compute
environment have used two voltage levels
in signaling, with low voltage representing
binary 0, and high voltage representing
binary 1. This scheme is also known
as non-return to zero (NRZ) or pulse
amplitude modulation 2-level (PAM2).

As Nyquist frequency increases to a higher
data rate, loss and reflection beSyntax Warning: Invalid Font Weight
come a
challenge. A shift to four-level signaling
(pulse amplitude modulation 4-level;
PAM4) encodes data in the amplitude and
                                                        Figure 3. Eye diagrams for NRZ (top) versus PAM4 (bottom) show the increased
doubles the data rate for signals operating
                                                      complexity of signal analysis and illustrate the sensitivity of PAM4 signals to crosstalk.
at the same Nyquist frequency as PAM2.

Each of the four voltage levels corresponds
to one of four bit-sequences (00, 01, 10, 11), providing two bits on the space previously occupied by one, yet not increasing
operating frequency.

Unfortunately, PAM4 signaling is more sensitive to noise sources such as reflection and crosstalk (see Figure 3). This is due to the
reduced signal amplitude (1/3 of NRZ), effectively reducing the signal-to-noise ratio. The highest speed standards operating at
NRZ/PAM2 are 28 and 32 Gbps. Above this data rate, PAM4 is typically used, beginning at 56 and 64 Gbps and beyond.



6                                         Signal Integrity Handbook | Signaling Terms
      III            Frequency Domain & S-Parameters
S-parameters, also known as scattering parameters, are a
unified set of frequency-domain performance characteristics
that can be used to completely define the properties of an
electrical device.

S-parameters can be generated from a simulation, or they
can be measured with a vector network analyzer (VNA).
S-parameters are treated like a black box between input and
outputs: the performance through is described; however, the
contents are hidden. This makes S-parameters an ideal way to
share characteristics while protecting intellectual property.

The total number of available S-parameters for characterizing a
specific electrical device is determined by its number of ports.
                                                                         Figure 4: S-parameter measurements give an indication of the
S-parameter models may be used to make performance
                                                                        electrical device’s performance, in terms of insertion loss, return
charts or can be used directly in full channel simulations.              loss, and crosstalk. This figure identifies three relationships of
From S-parameters, numerous SI characteristics can be                                interest in a six-port device under test.
extracted including insertion loss, return loss, and crosstalk
(see Figure 4).

Characterizations in the frequency domain are not specific to a particular data rate. Interpretation depending on frequencies of
interest is left to the reader. The following sections provide a guide.




i. Insertion Loss
In the frequency domain, the transferred signal
through a medium is characterized as insertion loss
(IL). In a two-port device under test (DUT), insertion
loss is the magnitude of S21 in an S-parameter matrix
and expressed in dB, where the nomenclature "21"
(expressed as "two-one") refers to the signal observed
at port 2 when stimulated at port 1.

Insertion loss is expressed as a negative number for
attenuation and as a positive number for gain. It is
expressed in dB as the ratio of output to input.

In some cases, industry specifications for insertion loss          Figure 5: Example of connector performance where insertion loss
must be satisfied for components or complete channels.                        performance target is highlighted in green.

Often component bandwidth is defined as the point where insertion loss crosses -3 dB. However, for high-speed applications,
this rule is less applicable. It is not uncommon to require -1 to -2 dB insertion loss from a small component (like a connector) at
Nyquist frequency (see Figure 5).

For larger components, like cables or even packages, insertion loss is significant and a wholistic assessment, channel insertion
loss must be evaluated against interface requirements.




                           Signal Integrity Handbook | Frequency Domain & S-ParSyntax Warning: Invalid Font Weight
ameters                                                   7
    III           Frequency Domain & S-Parameters (continued)

ii. Return Loss                                                           Crosstalk power sum is the combination of multiple crosstalk
                                                                          responses in an effort to describe the total crosstalk noise in a
Return loss (RL) is a measurement of reflected noise in a                 system (see Figure 9). It may be separated as NEXT and FEXT
single port due to impedance mismatch against a reference                 power sums.
value (see Figure 6). As device impedance becomes further
mismatched to the reference impedance, return loss increases              iv. Mode Conversion
in the positive direction. Reference impedances are most often
50 Ω, 46.25 Ω or 42.5 Ω, depending on the application.                    Mixed modes are undesirable energy lost from or added to
                                                                          the differential signal. They can be measured at the system
iii. Crosstalk                                                            or component level. SDC, or differential-to-common mode
                                                                          conversion, is the amount of transmitted differential signal that
Crosstalk is unwanted coupled noise that a signal lane                    remains when the positive and negative signals of the pair are
experiences from other nearby lanes or sources. Every part                subtracted. Similarly, SCD is common-to-differential mode and
of the interconnect, from chip to chip, is a potential source of          represents noise sources added to the differential signal that
crosstalk. Most applications desire crosstalk levels of -40 dB            remain after subtraction.
through Nyquist frequency (see Figure 7).
                                                                          For a perfectly balanced differential pair, SCD & SDC are zero.
There are two types of crosstalk of concern in high-speed                 Imbalances and skew within the pair lead to mixed modes
systems, near-end crosstalk (NEXT) and far-end crosstalk (FEXT)           that can be observed as through, reflected, or coupled noise.
(see Figure 8). NEXT is the measure of crosstalk coupling from            Sometimes specifications provide limits for mixed modes.
transmitting (Tx) lanes onto nearby receiving (Rx) lanes. NEXT
is most critical when coupling sources (vias, connectors, etc.)           v. Electromagnetic Interference
occur near the transmitting source (where Tx signal levels are
the highest and the Rx signal levels are the smallest).                   Electromagnetic interference (EMI) refers to the electrical
                                                                          noise that is emitted to other electrical devices that are
FEXT relates to signals traveling in the same direction. For              operating nearby.
example, FEXT is the noise that a transmitting lane experiences
from other transmitting lanes. It is generally viewed in the              Because of the serious nature of electromagnetic
context of the length and loss of the channel. With FEXT, both            compatibility (EMC) issues, many governments require EMI
the crosstalk levels and signal levels are attenuating together           compliance testing of active electronic systems. In the US,
before reaching the receiver.                                             regulations are administered by the Federal Communications




     Figure 6: As a rule of thumb, RL values of less than -15 dB in the            Figure 7: Crosstalk is measured in dB as the ratio of sent to
    frequency band of interest are desirable, and a value of -15 dB is             received noise; smaller (negative) numbers represent less
                             typically sufficient.                                                crosstalk (which is desirable).



8                             Signal ISyntax Warning: Invalid Font Weight
Syntax Warning: Invalid Font Weight
ntegrity Handbook | Frequency Domain & S-Parameters
Commission (FCC). Military applications may require more           VSWR is a term commonly used in RF and microwave
stringent testing.                                                 environments. It is often specified as a “one number
                                                                   rating,” especially for coaxial connectors. In such cases, the
Techniques to mitigate EMI include routing PCBs internally         impedance mismatches within the terminated connector
as stripline and grounded caging/ shielding around external        system will be the dominant electrical characteristic limiting
connectors.                                                        its performance in a high-frequency system. Performance
                                                                   data for a coaxial connector might simply be provided as
vi. Voltage Standing Wave Ratio                                    “VSWR 1.20.” This is shorthand for an implied maximum
                                                                   VSWR of 1:1.20 of the connector when used in a system with
Another way of characterizing the effects of impedance
                                                                   an appropriate impedance, and across the frequency band
mismatch in the frequency domain is voltage standing
                                                                   of interest.
wave ratio (VSWR; pronounced “viz-wer”). Impedance
discontinuities within a terminated cable connector and/or         Since VSWR and return loss are both related to impedance,
terminated PCB connector (terminated connector system) will        VSWR can provide quick insight into the amount of voltage
cause partial reflections of a traveling wave. These reflections   that is reflected into a transmitter from a terminated
will either interfere constructively (add to the magnitude         interconnect system. Return loss (measured in dB) provides
when in phase) or interfere negatively (out of phase) with the     similar insight into the ratio of the transmitted power to the
original traveling wave. The resultant wave is called a standing   reflected power and thus the eventual level of a signal that is
wave as it does not actually travel along the transmission         transmitted through the same interconnect system.
line. VSWR describes the ratio between these maximum and
minimum voltages measured at a given point before the
terminated connector system within the transmission line.




                                                                                       Figure 8: FEXT and NEXT result from
                                                                                       different signal paths. In applications,
                                                                                       designers seek to isolate transmit
                                                                                       and receive lanes from each other to
                                                                                       minimize NEXT and FEXT.




                                                                                       Figure 9: Power sums are often used
                                                                                       for industry specifications to restrict the
                                                                                       total allowable noise. In this case, the
                                                                                       desired total FEXT is below -40 dB.




                           Signal Integrity Handbook | Frequency Domain & S-Parameters                                               9
       IV              Time Domain
Analysis in the time domain reveals the pertinent behavior of an interconnect and is specific to a given data rate. The
advantage of time domain analysis is that it provides spatial resolution and can inform us about behavior at every location
throughout the topology.



i. Impedance                                                        point in the transmission path where there is a change in
                                                                    impedance the signal “sees.” These types of reflections are
Impedance (Ω) is a measure of the behavior of the                   also called inter-symbol interference (ISI).
interconnect. It is influenced by signal conductor and reference
                                                                    Time domain reflectometry (TDR) is a common diagnostic
conductor surface area, the gap between them, and the
                                                                    used to review impedance throughout a structure; it can be
dielectric property of whatever is between them (air, plastic,
                                                                    measured or simulated. A step response is provided at an
etc). Impedance is a function of inductance and capacitance,
                                                                    input, reflected voltage is observed, and the ratio of reflected
and is highly influenced by conductor surface area. The
                                                                    voltage to input voltage (reflection coefficient) is converted to
impedance value affects return loss.
                                                                    characteristic impedance. In fact, the TDR plot identifies the
For high-speed interfaces, impedance is measured as an              physical location of impedance discontinuities known by their
instantaneous (2D) value, called characteristic impedance.          delay. A desirable TDR plot is smooth and depicts a gradual
Systems are generally designed to meet an impedance target.         change in impedance (see Figure 10). Note: TDR results are
Often these system impedance targets apply to the individual        subject to the rise time used. The rise time used should be
components or the PCB traces in an attempt to better match          appropriate for the signaling standard.
the system impedance.
                                                                    Connectors are generally not characterized at a specific
In practice, the difficult to control pieces of the interconnect,   impedance; in fact, it is expected that impedance could vary
such as vias, surface mount (SMT) pads, and ball grid array         as much as 20%, depending on the data rate and application.
balls, are lower in impedance. This can require a lower             For connectors, then, overall impedance is characterized by
impedance design of components and routing in order to              return loss performance. Since return loss is referenced to a
yield better signal integrity in the system. Some typical system    specific value (100 Ω, 92.5 Ω, or 85 Ω), it captures the overall
impedances are shown in Table 1. 		                                 severity of the discontinuities in the component.

                                                                    It is common practice to renormalize a measurement
     Impedance Requirements for Common High-Speed Signals           or simulation from 100 to 92.5/85 ohms, thereby better
         Interface         Impedance (Ω)           Mode             representing the performance for the intended application.
                                                                    Give care to reading TDR and return loss plots by verifying the
        PCI Express®             85             Differential
                                                                    reference impedance that was used.
           SATA                  85             Differential
          Clocks               85, 100          Differential        All measurements for products such as RF connectors,
                                                                    adaptors, and cables are precision tuned to 50 ohms and
         Ethernet                100            DiSyntax Warning: Invalid Font Weight
Syntax Warning: Invalid Font Weight
fferential
                                                                    interoperate with little impedance discontinuity. For this
       DDR, DQ, DQS             40, 50         Single-Ended
                                                                    reason, measurements and models are most often referenced
  Miscellaneous Signals         50, 55         Single-Ended         to 50 ohms, 75 ohms single-ended, or 100 ohms differentially.
           USB                   85             Differential        Components that are not designed for 100 ohms may then
                                                         Table 1
                                                                    appear poor, showing a mismatch against the equipment
                                                                    output or reference.
While PCB routing is generally uniform, vertical components
(such as connectors, vias, and sockets) have a variable
impedance because of their complex geometry. Mismatches
in impedance throughout an interconnect create reflections
and degrade performance. This discontinuity occurs at every




10                                       Signal Integrity Handbook | Time Domain
           Figure 10: This figure shows an example of two TDR responses from a PCIe® system: one model with the PCB trace at
           85 Ω and the other at 100 Ω. Note the physical locations on the bottom of the graph and their subsequent effect on
                          the system’s characteristic impedance. This graph shows larger discontinuities at 100 Ω.




ii. Propagation Delay & Skew
Propagation delay is defined as the amount of time it takes for a signal to propagate through an interconnect path. Knowing
the propagation delay of the various signal paths can be critical for system timing analysis for some interfaces.

Skew is defined as the difference in propagation delay between multiple wires. For a single-ended bus, skew between data
and a clock may be important. In a differential pair, skew between the two wires composing the pair is critical. Between
differential pairs, skew may be less stringent, and requirements vary by interface.

Within a differential pair, skew leads to increased insertion loss, impedance mismatch, crosstalk, and EMI. Sources of skew may
include bends in PCB routing, PCB routing parallel to glass bundles called “fiber weave skew,” right-angle connectors, and
cable assemblies physical length mismatch.




iii. Rise Time & Dispersion
Rise time is the rate at which a signal changes from low to high. It is usually defined between 10 and 90% (or 20 and 80%) of
the total voltage range. For high-speed interfaces, rise time is related to data rate.

As a rule of thumb, rise time is 25% of the unit interval. So, a 10 Gbps signal contains the same signal content as a 25 ps rise
time: 0.25 * ( 1 / 10E 9 ). The rise time is the same for 28 Gbps NRZ and 56 Gbps PAM4 signals as they share the same Nyquist
frequency and unit intervals (~36 ps). For this case, rise time = 9 ps, unit interval = 36 ps, and Nyquist frequency is 14 GHz.

Time domain characterizations require a rise time input, most commonly TDR. Rise time used for TDR should be related to
the data rate of interest. It is important to note that rise time degrades as a signal passes through the interconnect due to
dispersion. Dispersion is the spread of signal due to changes in propagation delay across frequencies in PCB dielectrics.
Receiver equalization is designed to compensate for dispersion.



                                        Signal Integrity Handbook | Time Domain                                                 11
     IV         Time Domain (continued)

iv. Apparent Impedance
Apparent impedance is the effective impedance of a component when measured or used at a specific signal rise time or frequency,
in a specific impedance environment. As rise times get slower and the frequency bandwidth goes lower, the effective, or apparent,
impedance of a component moves closer to the impedance level of the circuit inSyntax Warning: Invalid Font Weight
 which the component is being used.

At slow rise times, the device will appear to have an impedance value close to the reference or system impedance. But as rise times
decrease (in other words, as edge rates get faster), the measured impedance values begin to move toward the true characteristic
impedance of the component. At an infinitely short rise time, we would measure the true characteristic impedance of a device.

This effect is important when seeking an interconnect solution for a system with an impedance other than the reference impedance
used in the characterization process. In those instances, the impedance values at the fastest rise times on the TDR impedance
profile should be used as an approximation of the interconnect’s “true” characteristic impedance (see Figure 11).




               Figure 11: Measured TDR Differential Impedance for a Samtec NovaRay® 7 mm stack height from high-speed
                         characterization reports with three apparent impedances at 30, 50 and 100 ps rise times.




12                                      Signal Integrity Handbook | Time Domain
       V             Single Value Metrics

i. Effective Return Loss (ERL)                                     ii. Integrated Crosstalk Noise &
Effective return loss (ERL) is a figure of merit representing
                                                                       Integrated Return Loss (ICN & IRL)
measured RL and is a single value. ERL is the amount of            Integrated crosstalk noise (ICN) and integrated return loss
digital signal returned which is statistically reduced to          (IRL) are single numbers used to characterize the total noise
an effective value at the test point. It may address both          in a system or component. To achieve this, a weighting
compensable and un-compensable ISI and is computed from            filter is configured to the data rate of interest, focusing only
RL (see description of return loss, page 8).                       on applicable frequencies. Once filtered, the response is
                                                                   integrated into a single number expressed in mV. Many
The concept of ERL was introduced during the specification
                                                                   standards use ICN calculated from the crosstalk power sum
development of the IEEE 802.3 50 Gbps Ethernet Standard.
                                                                   for compliance, including IEEE, OIF, PCIe®, and USB. For
The intent of this metric is to control variations in system
                                                                   reflections, IRL is used for USB cable compliance.
performance due to excessive reflections that occur when
pieces of the system are designed and budgeted separately
but later expected to work together in high volume.
                                                                                       ADDITIONAL RESOURCES
As the name implies, ERL is related to the return loss of a
device, channel, or component in that energy is injected
into a port and the return signal is analyzed; this is like echo
pinging into the scattering parameter. The injected signal is
a unit pulse that represents a single symbol. The histogram
of this return signature is then combined with a histogram
of a collection of random symbols to create a single value
property. Often this combination is done with the cumulative
                                                                          gEEk® spEEk Webinar:            Samtec White Paper:
distribution of the stochastic nature of symbol reflections.               "What is ERL & How is it     "Characterizing High-Speed
The value is reported in dB and as a necessity requires a data                  Computed?"              Digital Interfaces: Reflecting
rate and symbol error rate.                                                                                    on Reflections"




      VI             Samtec Channel Performance Metric
Recognizing that it is impSyntax Warning: Invalid Font Weight
Syntax Warning: Invalid Font Weight
ortant to consider an interconnect
as part of the system, Samtec offers a Channel Performance                             ADDITIONAL RESOURCES
Metric (CPM) for its products that provides a recommended
maximum data rate based on system complexity. This chart
is displayed in the catalog and product’s web page.

Samtec CPM is calculated using full end-to-end channel
simulation including PCB, packages, reflections, and
crosstalk. Maximum data rate is determined when a
minimum BER threshold is reached.
                                                                          Samtec Blog Article:            Samtec Blog Article:
                                                                       "High-Speed Connector Rating     "New Protocol Capabilities for
                                                                         Accounts for Entire System"   High-Performance Interconnects"




                 Signal Integrity Handbook | Single Value Metrics & Channel Performance Metric                                           13
     VII            Model Considerations
i. Simulation Tools
There are many modeling tools to enable electrical behavior characterization. These include 2D, 2.5D, 3D, and hybrid field-solving
tools that focus on the multiphysics of larger structures broken down to simpler nodal coarse static or dynamic mesh solutions.

There are also system-level characterization analysis tools based on building schematics and libraries, including scripted
programmed functionalities that allow engineers to bring models from concept to realization (see Figure 12).




                                                                                              Figure 12: Various simulation
                                                                                              tools enable electrical model
                                                                                              characterization, including 2.5D
                                                                                              wave EM solvers (top left), 3D
                                                                                              field solvers (top right), and
                                                                                              system analysis tools (bottom).




ii. Boundaries
Understanding a model’s boundary is important when interpreting frequency or time domain reports. Models can vary in terms
of the impedance and duration of PCB routing that is included. For example, if the pads or vertical transitions of the PCB or
breakout region (BOR) are not included, performance may further degrade when they are added. Comparing products with
different extents of the interconnect included may lead to incorrect conclusions. Clear documentation should indicate the
physical location of model ports.

In some instances, connector models do not include PCB breakout areas. This enables modeling of application specific stack-
up and breakout needs separately. Simulation tools provide functions to cascade S-parameters, combining separate connector
and PCB models (see Figure 13).



iii. Validation
Several criteria are often checked to determine model or measurement quality for use in system analysis, including passivity,
causality, and reciprocity. Definitions of these terms are provided in the IEEE 370-2020 standard. Software to evaluate these
limits is provided by IEEE 370-2020 and is also being implemented in several commercial tools.

Model bandwidth, or maximum frequency available for a given model, needs to meet or exceed the spectrum for which energy
exists for a given data rate. Therefore, a minimum range of 1.5x to 3x Nyquist frequency is recommended to account for the
higher frequency harmonics contained in the signal energy.



14                                Signal Integrity Handbook | Model Considerations
             Figure 13: This diagram shows connector models (red and blue) that can be combined with PCB, Tx and Rx models
               (green) within a simulaSyntax Warning: Invalid Font Weight
tion tool to capture a unique stack up design. Samtec ExaMAX® (EBTM /EBCF Series) and
                                                   AcceleRate® (ARC / ARF6 Series) are shown.




iv. Encrypted 3D Components
Encrypted 3D components within 3D field solver tools allow for a better collaboration space between component-level and
assembly-level designs while protecting the intellectual property of the component manufacturer. As data rates increase, it
becomes more important to have accurate system-level
models of the entire signal channel from package die to
package die with the precise plane of reference match.                             ADDITIONAL RESOURCES

Samtec’s encrypted 3D components, for instance, have all of
the specifications with corresponding material properties,
physical structure attributes, points of contact, wipe distance,
and deflections incorporated in the model.

Designers can use encrypted models in their workspace,
directly on their board designs, with their own parameters
and launches.                                                                        Video:                        Video:
                                                                              How to Encrypt ANSYS®        ANSYS® 3D SI Models for
                                                                                 3D Components              Samtec Interconnects




                                   Signal Integrity Handbook | Model Considerations                                                  15
     VIII           System Analysis
During a system’s design phase, obtaining an assessment of SI performance of the complete channel design may be required
before moving on to the development of a physical prototype. To support this system-level assessment, a design team needs
electrical simulation models, usually in the form of S-parameters, and a particular physical protocol and topology expectation to
execute channel simulation.

Simulation of an entire link can be done in a number of available tools. Many standards offer simulation tools preloaded with
transmitter and receiver configurations. This includes the free, open-source tool Seasim for PCI Express® channels and the
channel operating margin (COM) algorithm for IEEE and OIF. If specific silicon is known, IBIS-AMI models (which can be used
in commercial tools such as ADS) may be obtained to represent the actual noise levels, which may be better than specification
limits. Channel simulation can require product eye diagrams, COM results, or BER.



i. Eye Diagram
                                                                                                                Slew Rate = tan( )
An eye diagram is a characterization of system level
performance. Eye patterns are generated by sending                                 Rise
continuous streams of data from a transmitter to a receiver                                                   EH
                                                                                   Edge
and overlaying the received bits upon one another. Over
time, the received data builds to resemble an eye.

Negative SI effects in the transmission path can cause the
signal to distort, which over time, will cause the eye to
                                                                                                    EW
"close." Specifications may define a minimum eye mask
template, which can be placed on the amount of open area                                            1 UI
as an aid to determine compliance (see Figure 14). Eye
diagram specifications are used for the entire interconnect       Figure 14: Sample eye diagram. The red diamond is the eye mask, and
path, or subsets of the path, but are not used for smaller         the blue lines show the received bits. (EH: Eye Height, EW: Eye Width,
components like connectors or cables.                                                         UI: Unit Interval)




ii. Channel Operating Margin (COM)

During the development of 25 Gbps Ethernet
signaling in IEEE 802.3, a need Syntax Warning: Invalid Font Weight
Syntax Warning: Invalid Font Weight
arose to help                               ADDITIONAL RESOURCES
unify the budgeting capability of transmitter,
receiver, and channel specifications. The
previously recommended frequency domain
masks were abandoned in favor of time domain
specification of the system. This time domain-
based specification is known as COM.

COM is a figure of merit for a channel
derived from a measurement of its scattering             Free Software:         gEEk® spEEk Webinar:         gEEk® spEEk Webinar:
parameters. It is related to the ratio of a             Request a Copy of            "IEEE COM for             "Mechanics of Running
calculated signal amplitude to a calculated            Samtec's COM Code            Channel Analysis"                COM"

noise amplitude at a receiver input.




16                                   Signal Integrity Handbook | System Analysis
Transmitters (represented by "n") are used to transfer
data between physical layers (PHYs). There are "n"
near-end crosstalk paths, and "n-1" far-end crosstalk
paths going into a victim receiver, as illustrated in
Figure 15. The specific number of paths depend on
the number supported lanes.

COM is computed using defined path calculations and
a specified procedure. In addition to S-parameters,
COM accepts parameter values such as signaling
rate, frequency (min, max and step), and the device
package model to use in the computation (see Figure
16). For convenience, and to ensure consistency in
computational results, the COM procedure has been
implemented in a MATLAB® script. An accompanying
spreadsheet referred to as "COM configuration file" is
used to load the parameter values into the MATLAB                      Figure 15: COM is related to the ratio of a calculated signal
procedure script.                                                   amplitude to a calculated noise amplitude at a receiver input, and it
                                                                    depends on the number of transmitters. This image shows NEXT and
As opposed to an eye diagram, COM operates as a                                       FEXT paths in a sample system.
budget for insertion loss, insertion loss deviation (ILD),
crosstalk, and SerDes parameters.




              Figure 16: COM voltage injection and voltage measurement points. COM is computed from a voltage injection point
                          (VIP) to voltage measurement point (VMP) from provided measured S-parameters TP0 to TP5.




                                       Signal Integrity Handbook | System Analysis                                                          17
      IX             Selecting a Connector
Connector solutions generally fall into two categories: open-pin-field and assigned signals. Open-pin-field offers the best
flexibility to place signals, grounds, or power in any location. Selections with assigned signals usually have superior SI
performance due to specially designed ground structures. Cabled connectors may also have assigned positions to properly
connect the twinax ground shield.

Many parameters critical to high-speed connector performance will vary significantly depending upon the pin assignment and
form factor. An open-pin-field connector will have improved crosstalk performance when two grounds are placed between
signals (SSGGSS) as compared to a single ground (SSGSS). A design with a smaller pitch may favor system placement because
of its greater density; however, performance could be reduced as higher crosstalk is incurred due to proximity. This is not
always true due to innovative designs, so it is critical to refer to SI characterization reports to make the best decisions.



i. Contact Spacing
As the distance between contacts increases, inductive and capacitive coupling decrease. This effect can be observed in an
electromagnetic field plot by noting the reduced number and density of field lines connecting the two conductors. For example, a
connector with terminals spaced on a 0.80 mm pitch will typically have better crosstalk performance than one with a 0.50 mm pitch.
Syntax Warning: Invalid Font Weight
Syntax Warning: Invalid Font Weight
In differential pair systems, increasing the distance between adjacent pairs minimizes coupling and, in some cases, eliminates the
need for interstitial grounds, so total signal density can be increased (see Figure 17).




        ERX8 Series, 30 Position                                                                               ERX5 Series, 30 Position




                                   Separate with Greater Pitch Spacing    Separate with Interstitial Spacing



                       Figure 17: Recommended PCB Layout footprint for Samtec Edge Rate® (ERX8 and ERX5 Series)
                            with 0.80 mm pitch and 0.50 mm pitch, greater pitch spacing, and interstitial spacing.




18                                    Signal Integrity Handbook | Selecting a Connector
ii. Pin Mapping
By assigning pins between signals as return paths (grounds), unwanted coupling between signal pins can be minimized. A 1:1
signal-to-ground ratio is typically used in the industry. So, pin mapping for single-ended applications would then be SGSG, while
differential pair applications would use DP-G-DP-G. These pin assignments generally provide a good performance vs. density
trade-off.

To increase isolation, more return paths could be added between signals. For example, optimal solution mappings could have
a 1:2 signal-to-ground ratio. Differential solutions would then use DP-G-G-DP while single-ended applications would use SGGS.
These can be directed either vertically or horizontally depending on the connector solution. This approach, however, will reduce
the signal density of the interconnect (see Figure 18).




                       Figure 18: Single-ended 1:1 pattern (above) and differential pair 1:2 optimal horizontal pattern
                                    (below) from Samtec’s SEARAY™ high-speed characterization report.




                                   Signal Integrity Handbook | Selecting a Connector                                           19
        X             Connector Breakout Region Design
High-speed performance of PCB-mount connectors must be considered in the context of the application in a real-world
environment. “Connector-only” data can be useful for comparing the relative performance between two similar connectors, but it
may be very far removed from the performance practically obtainable in an actual application. This is mainly because of the PCB
traces and ground planes in the vicinity of the connector. This region is often referred to as the breakout region (BOR), because, in
this area, traces are “broken out” from an optimized, consistent transmission line environment and routed as required to attach to
the connector terminals. If not done correctly, system performance can suffer. BOR/launch must be carefully designed to allow for
the best possible high-frequency performance.



i. Constraints                                                       ii. Outside the BOR
When designing a BOR, it is important to first consider the          Once the BOR has been finalized, it is time to consider
limitations of the design and then improve the performance           factors for routing across larger areas of the PCB:
around these limitations:
                                                                     •   A number of techniques can help minimize skew within a
•    What is the intended routing direction? Right-angle                 differential pair due to differences in dielectric property
     connectors, for example, typically only allow routing in            of glass and resin in the PCB:
     the direction opposite to the cable. What makes the most             –    Board routing should have a trace pitch that is the
     sense for the use case?                                                   same as the fiber weave in the board.

•    Does this connector have a single ground (GND) or                    –    Routing at non-orthogonal angles can reduce fiber
     double GND positions between signals in a row? This will                  weave skew. The design shSyntax Warning: Invalid Font Weight
ould avoid using angles
     affect crosstalk performance and routing that must travel                 within +/- 10 degrees of the orthogonal directions
     through rows of vias. If routing through a row of vias, it is             on the panel because of manufacturing variations
     critical to design around the routing path early.                         between the orthogonal directions of the fiberglass
                                                                               and those of the copper trace etch (see Figure 19).
•    How much space do I have left to add GND vias for
                                                                     •   Length matching the traces within a signal pair is critical.
     shielding, and where can I place them to shield crosstalk
                                                                         It is best to do this by having an equal number of left
     most effectively?
                                                                         and right turns as a trace routes across the board.
                                                                         Length matching structures like ‘serpentine’ traces are
•    Large open areas should be avoided in the BOR because
                                                                         acceptable but should be avoided if the signal can be
     they can resonate. GND vias can be placed to break up
                                                                         balanced by matching left and right turns.
     and limit the size of dielectric cavities. Larger cavities
     resonate at lower frequencies, so the importance of this is     •   Thieving or copper balancing is placed throughout the
     bandwidth dependent.                                                board to keep the dielectric thickness consistent through
                                                                         a uniform copper density.
•    After the overall layout of the vias and routing has been
     established, the signal vias can be impedance optimized         •   Routing length across the board should be kept as short
     by changing the distance between the edges of the GND               as possible within reason. Longer traces increase signal
     planes and the sides of the signal vias. The cut outs in the        loss and reduce the signal bandwidth.
     GND planes that allow signal vias to transition through
     layers are known as anti-pads, and the anti-pad diameters
     are tuned to optimize via impedance.




                                                                         Figure 19: An example of routing style to avoid fiber weave effect.



20                           Signal Integrity Handbook | Connector Breakout Region Design
      XI            Signal Integrity in RF Systems
While digital and RF/microwave cables and connectors tend to be application specific, there are a number of similar concerns
for designers of high-speed digital and high-frequency systems. High-speed digital designers, therefore, may find some value in
the analysis of RF techniques.

Additionally, it is possible to use cables and connectors designed for RF/microwave applications for high-speed digital
applications, so some comparison of similar terms might be useful. While a full discussion of RF is beyond the scope of this
document, below is a brief listing of some RF terms and how they are analogous to SI ones.

As mentioned above, VSWR is one characteristic that is commonly used to specify RF cables and is related to return loss. Others
include cable propagation velocity (which is related to time delay in a digital application), RF phase matching (which is analogous
to skew), attenuation (which is analogous to insertion loss), and RF cable shielding (which is analogous to isolation and crosstalk).

There is much to consider when selecting a high-speed interconnect. For additional assistance, see the resources suggested
and/or contact sig@samtec.com.




                              SiSyntax Warning: Invalid Font Weight
Syntax Warning: Invalid Font Weight
gnal Integrity Handbook | Signal Integrity in RF Systems                                          21
SIGNAL INTEGRITY TOOLS & SUPPORT

Samtec Signal Integrity Engineers address next generation system design challenges with industry-leading expertise in high-
performance interconnect systems, along with testing and validation services, system optimization support, and easy-to-use
design and development tools. Contact sig@samtec.com to discuss your specific application.




SIGNAL INTEGRITY SERVICES & SUPPORT

Frontline Engineering Services                Technical Application Support                   Industry Standards Support

•    High Data Rate Simulations               •   Signal/Power Integrity Expertise            •   Member/Participant of 30+ Industry,
                                                                                                  Corporate & De Facto Standards
•    Channel Analysis                         •   Testing, Validation & Analysis
                                                                                              •   Compatible/compliant products
•    Signal Integrity Models                  •   Full Channel SI Analysis/Optimization           include: VITA, PICMG®, PCIe®, CXL,
                                                                                                  IEEE, OIF, SFF-SIG, PC/104™, PISMO™,
•    PCB & Breakout Region (BOR) Designs      •   PCB Layout & Routing Assistance                 SATA, USB and more

•    Connector Selection                      •   Full System Design Support                  •   Visit samtec.com/standards




ONLINE DESIGN & DEVELOPMENT TOOLS

•    Innovative product search, connector     •   Large Technical Library offers free 3D      •   Semiconductor & T+M partnerships
     builder and simulation tools that help       models, prints, footprints, test reports,       demonstrate next gen 112/224 Gbps
     streamline the design process                white papers, application notes, etc.           PAM4 interconnect solutions




TESTING & VALIDATION CAPABILITIES

Design Qualification Testing (DQT)            Severe Environment Testing (SET)                Signal Integrity Screening

Standard testing undergone by all             Additional testing evaluates whether            VNA-based test system screens for
Samtec products to verify the product         select products are suitable for rugged         manufacturing process anomalies that
design meets our intent.                      and/or harsh environments and other             could lead to SI degradation in higher
                                              extreme applications. samtec.com/SET            data rate products.
Extended Life Product™ (E.L.P.™)

Rigorous testing that evaluates contact       Leakage Testing
resistance including 10 year Mixed            Platform developed for applications
Flowing Gas (MFG) and High Mating             with higher voltage levels & extremely
Cycles (250 to 2,500). samtec.com/ELP         sensitive current leakage specifications.




22                                Signal Integrity Handbook | samtec.com/signalintegrity
Samtec-designed Evaluation & Development Kits simplify the design process and reduce time to market. Kits are available
for many of our high-performance connector sets, high-speed cable assemblies and optical solutions. Custom kits are also
available. Visit samtec.com/kits or contact kitsandboards@samtec.com for a full list of availability.




FPGA DEVELOPMENT BOARDS




        VITA 57.4 FMC+              VITA 57.4 FMC+ Extender Card           VITA 57.4 FMC+               FMC+ HSPC Loopback Card
      HSPC Loopback Card                                              25/28 Gbps FireFly™ Module         Supporting Xilinx® Virtex®
                                                                                                         UltraScale™+ VCU118 Kit




SIGNAL INTEGRITY EVALUATION KITS




  ExaMAX® High-Speed Backplane         Generate™ High-Speed             GenerateSyntax Warning: Invalid Font Weight
Syntax Warning: Invalid Font Weight
Syntax Warning: Invalid Font Weight
™ Differential Pair     AcceleRate® HD High-Density
      System (EBTF/EBTM)            Edge Card Socket (HSEC6-DV)       Edge Card Socket (HSEC8-DP)          Arrays (ADM6/ADF6)




ExaMAX® Backplane       AcceleRate® Flyover®      NovaRay® Flyover® Extreme          Flyover® QSFP              Bulls Eye® 70 GHz
   Cable System       Slim Direct Attach Cable   Density & Performance Cable   Double Density Cable System      High-Performance
 (EBCM/EBTF-RA)         System (ARC6/ARF6)         System (NVAC/NVAM-C)         (FQSFP-DD to NVAC/ARC6)        Test System (BE70A)




                                      Signal Integrity Handbook | samtec.com/kits                                               23
REFERENCE & FURTHER READING


     Articles / Papers:
     Boesing, D., New High-Speed Connector Rating that Accounts for Entire System, Samtec Blog (2016)

     Burns, M., Samtec Releases New Protocol Capabilities for High-Performance Interconnect, Samtec Blog (2018)

     Channel Design,"2014 IEEE International Symposium on Electromagnetic Compatibility (EMC)," Raleigh, NC,
     2014, pp. 648-653

     Edwards, A., 3D Components and Service Strategy, Signal Integrity Journal, August 31, 2021

     Gore, B., IEEE Channel Operating Margin (COM) For Channel Analysis, Samtec gEEk® spEEk (2020)

     Gore, B. and R. Mellitz, "An Exercise in Applying Channel Operating Margin (COM) for 10GBASE-KR Channel
     Design," 2014 IEEE International Symposium on Electromagnetic Compatibility (EMC), 2014

     Gore, B., "25 Gbps Ethernet Channel Design in Context: Channel Operating Margin (COM)," SI Symposium,
     Penn State Harrisburg, 2016

     Krooswyk, S., Component Crosstalk Characterization by ICN, Samtec gEEk® spEEk (2020)

     Krooswyk, S. and M. Rengarajan, "Don’t Judge a Bit Just By Its Fourier: 112G PAM4 Component Optimization
     and Selection," DesignCon 2019

     Love, J., High Bandwidth Connectors: Sorting Out What Matters, Signal Integrity Journal, April 19 2022

     McMorrow, S., Practical Use of ERL to Optimize Interconnect/BOR Design, Samtec gEEk® spEEk (2020)

     Mellitz, R., Mechanics of Running COM, Samtec gEEk® spEEk (2021)

     Mellitz, R., Effective Return Loss and How it is Computed, Samtec gEEk® spEEk (2020)

     Mellitz, R., A. Ran, M. Li and V. Ragavassamy, "Channel Operating Margin (COM): Evolution of Channel
     Specifications for 25 Gbps and Beyond," DesignCon 2013

     Mellitz, R. and E. Sayre, "Effective Return Loss for 112G and 56G PAM 4," DesignCon 2018

     Niehoff, B., What is PAM4? Understanding NRZ and PAM4 Signaling, Samtec Blog (2020)

     Simonovich, B., "A Guide for Single-Ended to Mixed-Mode S-parameter Conversions," Signal Integrity Journal,
     July 31, 2020

     Trobough, N., "RF to Digital: Extreme Coaxial Cable Requirements," Signal Integrity Journal, April 7, 2022




24                               Signal Integrity Handbook | Reference Materials
Books:
Bogatin, E., Signal and Power Integrity – Simplified (Signal Integrity Library, 3rd edition) (2017)

Bogatin, E., Bogatin’s Practical Guide to Transmission Line Design and Characterization for Signal Integrity
Applications (2020)

Hall, S.H. and H. L. Heck, Advanced Signal Integrity for High-Speed Digital Designs, IEEE Press, 2009

Huray, P., The Foundations of Signal Integrity (2009)

Pupalaikis, P., S-Parameters for Signal Integrity (2020)

Zhang, H., S. Krooswyk and J. Ou, High Speed Digital Design: Design of High Speed Interconnects and
Signaling (2015)




                             Signal Integrity Handbook | Reference Materials                                   25
ACRONYMS & ABBREVIATIONS

—B—                                                            —N—
BER    bit error ratio                                         NEXT near-end crosstalk
BOR    breakout region                                         NRZ    non-return to zero


—C—                                                            —O—
COM    channel operating margin                                OIF    Optical InterSyntax Warning: Invalid Font Weight
networking Forum


— D—                                                           —P—
DDR    double-data rate (refers to memory)                     PAM2 pulse amplitude modulation 2-level
DUT    device under test                                       PAM4 pulse amplitude modulation 4-level
                                                               PCB    printed circuit board
—E—                                                            PHY    physical layer
EMC    electromagnetic compatibility
EMI    electromagnetic interference                            —R—
ERL    effective return loss                                   RL     return loss
                                                               Rx     receive
—F—
FCC    Federal Communications Commission (USA)                 —S—
FEXT   far-end crosstalk                                       SI     signal integrity
                                                               SMT    surface mount
—G—
GND    ground                                                  —T—
                                                               TDR    time domain reflectometer/reflectometry
—I—                                                            Tx     transmit
ICN    integrated crosstalk noise
IEEE   Institute of Electrical and Electronics Engineers       —U—
IL     insertion loss                                          UCIe™ Universal Chiplet Interconnect Express
ILD    insertion loss deviation
IRL    integrated return loss                                  —V—
ISI    inter-symbol interference                               VNA    vector network analyzer
                                                               VSWR voltage standing wave ratio
—L—
LED    light-emitting diode




26                                Signal Integrity Handbook | Reference Materials
COPYRIGHTS, TRADEMARKS & PATENTS


Product names used herein are trademarks of their respective owners. All information and material in this publication are
property of Samtec, Inc. All related rights are reserved. Samtec, Inc. does not authorize customers to make copies of the
content for any use.


Terms of Use
Use of this publication is limited to viewing the pages for evaluation or purchase. No permission is granted to the user to
copy, print, distribute, transmit, display in public, or modify the contents of this document in any way.


Disclaimer
The information in this publication may change without notice. All materials published here are “As Is” and without implied
or express warranties. Samtec, Inc. does not warrant that this publication will be without error, or that defects will be
corrected. Samtec, Inc. makes every effort to present our customers an excellent and useful publication, but we do not
warrant or represent the use of the materials here in terms of its accuracy, reliability or otherwise. Therefore, you agree that
all access and use of this publication’s content is at your own risk.


Patents
Multiple patents are issued and pending.


Updated Documentation
Please contact sig@samtec.com to get access to the latest Signal Integrity documentation, and to ensure that you have the
latest version of this document.



NEITHER SAMTEC, INC. NOR ANY PARTY INVOLVED IN CREATING, PRODUCING, OR DELIVERING THIS
PUBLICATION SHALL BE LIABLE FOR ANY DIRECT, INCIDENTAL, CONSEQUENTIAL, INDIRECT, OR PUNITIVE
DAMAGES ARISING OUT OF YOUR ACCESS, USE OR INABILITY TO ACCESS OR USE THIS PUBLICATION, OR
ANY ERRORS OR OMISSIONS IN ITS CONTENT.


PCI-SIG®, PCI Express® and the PCIe® design marks are registered trademarks and/or service marks of PCI-SIG.
ExaMAX® is a registered trademark of AFCI.




                                                                                                   SIGNAL INTEGRITY HANDBOOK
                                                                                     © April 2025, Samtec, Inc. All rights reserved.




                                              Signal Integrity Handbook | Legal                                                    27
       Scan the code to find
    your Samtec location or visit
      samtec.com/locations




SUDDEN SERVICE®

    www.samtec.com
ISO-9001 and/or IATF 16949 Certified

     © APRIL 2025, SAMTEC INC.


==========================================
FILE: scaa082a.pdf
==========================================

                                                                                                             Application Report
                                                                                   SCAA082A – November 2006 – Revised August 2017


High-Speed Layout Guidelines

Alexander Weiler, Alexander Pakosta, and Ankur Verma ........................................................ Clock Drivers

                                                                  ABSTRACT
       This application report addresses high-speed signals, such as clock signals and their routing, and gives
       designers a review of the important coherences. With some simple rules, electromagnetic interference
       problems can be minimized without using complicated formulas and expensive simulation tools. Section 1
       gives a short introduction to theory, while Section 2 focuses on practical PCB design rules. Either section
       can be read independently.


                                                                    Contents
       1      Theoretical Overview ........................................................................................................ 1
              1.1     Electromagnetic Interference and Electromagnetic Compatibility ............................................ 1
              1.2     Clock Signals ........................................................................................................ 2
              1.3     Transmission Lines ................................................................................................. 3
              1.4     Crosstalk ............................................................................................................. 8
              1.5     Differential Signals .................................................................................................. 8
              1.6     Return Current and Loop Areas .................................................................................. 8
       2      Practical PCB Design Rules ................................................................................................ 9
              2.1     PCB Considerations During the Circuit Design ................................................................. 9
              2.2     Board Stackup....................................................................................................... 9
              2.3     Power and Ground Planes ....................................................................................... 10
              2.4     Decoupling Capacitors............................................................................................ 13
              2.5     Traces, Vias, and Other PCB Components .................................................................... 14
              2.6     Clock Distribution .................................................................................................. 17
       3      Summary .................................................................................................................... 19
       4      References .................................................................................................................. 19
Trademarks
       All trademarks are the property of their respective owners.

1      Theoretical Overview
       Some basic understanding is desirable to effectively use the PCB design rules given in this document. It is
       then easy to identify the undesirable effects that can arise and how to avoid them. The reason PCB layout
       becomes more and more important is because of the trend to faster, higher integrated, smaller form
       factors, and lower power electronic circuits. The higher the switching frequencies are, the more radiation
       occurs on a PCB. With good layout, many EMI problems can be minimized to meet the required
       specifications.

1.1    Electromagnetic Interference and Electromagnetic Compatibility
       Electromagnetic interference (EMI) is radio frequency energy that interferes with the operation of an
       electronic device. This radio frequency energy can be produced by the device itself or by other devices
       nearby.
       Electromagnetic compatibility (EMC) is the ability of an electronic product to operate without causing EMI
       that would interfere with other equipment and without being affected by EMI from other equipment or the
       environment.


SCAA082A – November 2006 – Revised August 2017                                                        High-Speed Layout Guidelines           1
Submit Documentation Feedback
                                            Copyright © 2006–2017, Texas Instruments Incorporated
Theoretical Overview                                                                                                   www.ti.com

       The goal is to reduce EMI to meet the requirements given by the Federal Communication Commission
       (FCC) or the International Special Committee on Radio Interference (CISPR)
       A basic EMI model is shown in Figure 1. Every device acts as a source and simultaneously as a sink. It
       can cause interference through a coupling path and can be affected by interference through the coupling
       path. The coupling can be:
       • Capacitive
       • Inductive
       • Galvanic
       • Radiated power

                          Sink                                                                       Source


                                                         Coupling Path


                        Source                                                                       Sink


                                  Figure 1. Model of Electromagnetic Interference

       There is not just one coupling mechanism present, but rather a combination of them. With proper PCB
       layout, however, these effects can be reduced.

1.2    Clock Signals
       Figure 2 illustrates the time and the frequency domain of a clock signal. Ideally, it is a square wave., but in
       reality, it is not possible to change from low level to high level (and vice versa) in an infinite short time.
       Due to the rise and fall time, it has the shape of a trapezoid in the time domain. By means of the Fourier
       series, the trapezoid consists of a series of sine and cosine signals with different frequency and
       magnitude. The discrete frequency components have an envelope as is shown in the lower diagram of
       Figure 2. An important aspect is that in the frequency domain the amplitude of the higher frequency
       harmonics depends on the rise and fall time of the signal. The longer the rise time, the smaller the
       magnitude of the harmonics. For example, the harmonics of a 100-MHz clock signal are not negligible,
       especially the third and fifth. In this case, consideration also should be made with frequencies up to 500
       MHz. With the CDCE906 from Texas Instruments, the user can set different rise and fall times to reduce
       the amplitude of the harmonics. However, take care to ensure these times do not violate the slew rate
       specifications of the driven devices.




2      High-Speed Layout Guidelines                                                  SCAA082A – November 2006 – Revised August 2017
                                                                                                    Submit Documentation Feedback
                                       Copyright © 2006–2017, Texas Instruments Incorporated
www.ti.com                                                                                                   Theoretical Overview




                        Figure 2. Time Domain and Frequency Domain of a Clock Signal


1.3    Transmission Lines
       If the lengths of traces are in the range of the signal's wavelength, then the user has to consider the
       effects of transmission lines. The problems that a user must deal with are time delay, reflections, and
       crosstalk. To get a better understanding of these problems and where and how they arise, it is useful to
       know what transmission lines are. They are simply the traces on a PCB and depend on the length and the
       frequency of the signals passing through them.
       Many different structures of trace routing are possible on a PCB. Two common structures are shown in
       Figure 3. On the left, a microstrip structure is illustrated, and on the right, a stripline technique. A
       microstrip has one reference, often a ground plane, and these are separated by a dielectric. A stripline has
       two references, often multiple ground planes, and are surrounded with the dielectric.




                          Figure 3. Structure and Dimension of Microstrip and Stripline

       The following sections describe some important properties of transmission lines which are significant for
       PCB design. Many software tools are available to calculate the properties of the several transmission line
       structures. In this application report, the freeware AppCAD from Agilent is used so that the reader can
       become familiar with these properties. Figure 4 shows the two structures, microstrip (top) and stripline
       (bottom). The dimensions, the material, and the frequency are in each case shown on the left. The results
       that are used in the following sections can be seen on the right. Table 1 defines the symbols used in
       Figure 3 and Figure 4.




SCAA082A – November 2006 – Revised August 2017                                                  High-Speed Layout Guidelines   3
Submit Documentation Feedback
                                        Copyright © 2006–2017, Texas Instruments Incorporated
Theoretical Overview                                                                                                            www.ti.com

                               Table 1. Description of the Symbols Used in Figures 3 and 4
              SYMBOL                                                          DESCRIPTION
       H                   Height of the dielectric
       W                   Width of the trace
       L                   Length of the trace
       Frequency           The frequency on which the calculations are based
       Z0                  Characteristic impedance of the trace
       1.0 Wavelength      Wavelength λ of the trace at the given frequency and the given effective dielectric
                                3      10 8 mńs
                           l+
                                    Ǹå
                                       eff  ƒ
       VP                  Velocity of the signal on this trace with the given dimensions and frequency relative to the speed of light. The
                           absolute velocity is calculated by VP,.absolute = VP,.relative × 3 × 108 m/s
       εeff                Combination of the several dielectrics which surrounds the microstrip
       W/H                 Ratio between trace width and trace length




4      High-Speed Layout Guidelines                                                       SCAA082A – November 2006 – Revised August 2017
                                                                                                         Submit Documentation Feedback
                                            Copyright © 2006–2017, Texas Instruments Incorporated
www.ti.com                                                                                                   Theoretical Overview




                   Figure 4. Calculation of Properties of Microstrip and Stripline (AppCAD)




SCAA082A – November 2006 – Revised August 2017                                                  High-Speed Layout Guidelines   5
Submit Documentation Feedback
                                        Copyright © 2006–2017, Texas Instruments Incorporated
Theoretical Overview                                                                                                           www.ti.com

1.3.1      Signal Speed and Propagation Delay Time
        A signal cannot pass through a trace with infinite speed. The maximum speed is the speed of light with 3
        × 108 m/s. For a certain trace length, the signal needs a certain time to pass it, and this is called the
        propagation delay time. The standard medium for the speed of light is air. For another medium, the
        dielectric in a PCB environment, the speed is different than that of the speed of light in air. The formula for
        the speed on a stripline is:
                    3 108 mńs
              V+
                         Ǹå r
                                                                                                                                        (1)
        So, the speed is a function of the dielectric which surrounds the trace. For a microstrip, it is more
        complicated because the trace is not surrounded by one dielectric. There are at least two: the substrate
        under the trace and the air above the trace. If the PCB contains a solder mask, a third medium would be
        present. Therefore, the calculation of an effective εr is necessary before determining the signal speed. It
        depends on the width of the microstrip and the distance to the reference plane. In this case, the speed is a
        function of the present dielectric, the trace width, and its distance to the reference plane [12].
        The signal speed and the propagation delay time, respectively, on a signal trace are important when:
        • Timing and skew requirements must be met (clock distribution, buses, and so forth)
        • Differential traces were used (for example, LVDS)

1.3.1.1     Examples
        The following parameters are the same in each case:
           length = 100 mm; thickness = 35 μm; height = 1.5 mm; εr = 4.6 (FR4); frequency = 300 MHz
        In Table 2, the dependency of signal speed on the trace width at the microstrip structure is shown. Using a
        stripline, the signal speed is not a function of the trace width. The same is valid for the height.

                                      Table 2. Comparison of Propagation Delay Time
                                            WIDTH              εr,eff          VP,relative       VP,absolute       Pd (1)
                                            [mm]                                                 [mm/ns]       [ps/100 mm]
                      Microstrip 1            0.5             3.046             0.573                171.9        581.7
                      Microstrip 2             1              3.165             0.562                168.6        593.1
                       Stripline 1            0.5               4.6             0.466                139.8        715.3
                       Stripline 2             1                4.6             0.466                139.8        715.3
               (1)
                     Pd is the propagation delay time in ps on the mentioned line with A 100-mm length.
                     Pd +         1         100 mm
                            171.9 mmńns



1.3.2      Characteristic Impedance, Reflections, and Termination
        Another property of a transmission line is the characteristic impedance, Z0. The microstrip in Figure 4 has
        for the given attributes a characteristic impedance Z0 = 105 Ω, and the stripline Z0 = 55 Ω. If there are any
        impedance changes in the signal chain (source – trace – vias – connectors – sink, and so forth),
        reflections occur. These reflections cause over- and undershoots. The two extreme are a transmission line
        with an open end (R = ∞) and a shorted end (R = 0 Ω). The reflection coefficient ρ is the dimension which
        expresses the relationship between the impedance of the transmission line and the impedance of the
                                                 R * Z0
                                            ò+          .
        source or sink. It is calculated as      R ) Z 0 For the two mentioned cases, the reflection coefficient
        becomes ρ = +1 for an open end and ρ = –1 for a shorted end. The value 1 means that the complete
        signal reflects at this impedance change and goes back to the source. To avoid this, the reflection
        coefficient must be ρ = 0 to get no reflections. This is the case if the impedance at the source has the
        same value as the characteristic impedance of the transmission line.




6       High-Speed Layout Guidelines                                                         SCAA082A – November 2006 – Revised August 2017
                                                                                                            Submit Documentation Feedback
                                             Copyright © 2006–2017, Texas Instruments Incorporated
www.ti.com                                                                                                   Theoretical Overview

       In Figure 5, the case with an open end (high-impedance input stage of the sink) is simulated. The clock
       source has an output of 3.3 V and an impedance of 25 Ω. The red line (dotted) is the ideal shape of the
       clock output. The green one (dashed) is the real signal at the clock's output and the blue line is at the end
       of the transmission line. The reflection is the cause of these over- and undershoots. The maximum voltage
       at the trace end is approximately 4.4 V instead of 3.3 V, and the minimum voltage is approximately –1 V
       instead of 0 V. These circumstances can damage the input stage of the source and sink.




                         Figure 5. Over- and Undershoots Due to Incorrect Termination

       A receiver often has a high-impedance input. To avoid these over- and undershoots, the reflections must
       be reduced. Therefore, a proper termination is required. The most common termination techniques follow:
       • Series termination
       • Parallel termination
       • Thevenin termination
       • AC termination



SCAA082A – November 2006 – Revised August 2017                                                  High-Speed Layout Guidelines   7
Submit Documentation Feedback
                                        Copyright © 2006–2017, Texas Instruments Incorporated
Theoretical Overview                                                                                                     www.ti.com

       Each of them has advantages and disadvantages, and the designer has to trade off which one is the best
       solution for his design.
       References: [8], [9]

1.4    Crosstalk
       The mutual influence of two parallel, nearby routed traces is called crosstalk. One is called the aggressor
       (this trace carries the signal) and the other is called the victim (this trace is influenced by the aggressor).
       Due to the electromagnetic field, the victim is influenced by an inductive and a capacitive coupling. They
       generate a forward and a backward current in the victim trace whereas in a homogenous environment (for
       example, stripline) the two induced currents cancel each other. In a microstrip environment, the forward
       current of the inductive coupling tends to be larger than the influence of the capacitive coupling. To
       minimize the effects on crosstalk on adjacent traces, keep them at least 2 times the trace width apart.
       Transmission lines coupled through a media have crosstalk associated with them. There are two types of
       crosstalk: forward crosstalk and backward crosstalk. Forward crosstalk travels in same direction as the
       aggressor. It grows with length and increasing aggressor dV/dt, whereas the backward crosstalk travels in
       the opposite direction as the aggressor and depends only on the aggressor amplitude. Make sure to
       measure the crosstalk between channels v/s frequency. IEEE802.3KR specifies Insertion Loss Crosstalk
       Ratio (ICR) that sums the crosstalk and plot it using S21.
       References: [1], [2], [3], [4], [5]

1.5    Differential Signals
       In the case of differential signals, the negative effect of crosstalk is a positive one. The signals on each
       trace are in theory exactly equal in magnitude and opposite in their sign. So, their electromagnetic fields
       cancel each other and the return current on the ground plane, as well. To achieve this, the traces for both
       signals must have the same length so that the propagation delay times are equal. The receiver is sensitive
       to the differences of the signals and not to an absolutely level reference, for example, to ground. If any
       signal radiated equally into both differential traces, the receiver would not recognize it. Therefore, the
       designer has to make sure that radiation affects both traces equally. This can be realized by routing the
       differential traces as close as possible.
       References: [1], [6], [7]

1.6    Return Current and Loop Areas
       An electrical circuit must always be a closed loop. Up to now, only the signal path was discussed but not
       the path back to the source – the return current. With DC, the return current takes the way back with the
       lowest resistance (Figure 6a). With a higher frequency, the return current flows along the lowest
       impedance (Figure 6b). This is directly beside the signal.




                                   Figure 6. Return Current and Resulting Loop Area

8      High-Speed Layout Guidelines                                                    SCAA082A – November 2006 – Revised August 2017
                                                                                                      Submit Documentation Feedback
                                         Copyright © 2006–2017, Texas Instruments Incorporated
www.ti.com                                                                                                   Practical PCB Design Rules

       If this return path, mostly the ground plane, has a slot, the return current has to take another way and this
       results in a loop area (Figure 6c). The larger the area, the more radiation and EMI problems occur. The
       designer has to make sure that the return current can flow directly underneath the signal trace. One
       solution is to place a 0-Ω resistor over the slot (Figure 6d). Another is to route the signal the same way as
       the return current flows. The best solution is to avoid any slots in the ground reference plane.

2      Practical PCB Design Rules
       Because many things can affect transmission lines, EMI problems can occur. To reduce these problems,
       good PCB design is important, and with some simple design rules, the PCB designer can minimize these
       problems. It is important to make prudent decisions during new circuit design, like the minimum number of
       layers. The easiest way to get a good, new design is to copy the recommended design from the TI
       evaluation modules (EVM).
       A good PCB layout starts with the circuit design. Do not postpone considerations about the layout. One of
       the most important aspects affecting the layout is the location of each functional block. Keep their devices
       and their traces together.

2.1    PCB Considerations During the Circuit Design
       •     What is the highest frequency and fastest rise time in the system?
       •     What are the electrical specifications at the inputs and outputs of the sinks and sources?
       •     Are there sensitive signals to route – for example, think about controlled impedance, termination,
             propagation delay on a trace (clock distribution, buses, etc.)?
       •     Is a microstrip adequate for the sensitive signals, or is it essential to use stripline technique?
       •     How many different supply voltages exist? Does each supply voltage need its own power plane, or is it
             possible to split them?
       •     Create a diagram with the functional groups of the system – for example, transmitter path, receiver
             path, analog signals, digital signals, and so forth
       •     Are there any interconnections between at least two independent functional groups? Take special care
             of them. Think about the return current and crosstalk to other traces.
       •     Clarify the minimum width, separation and height of a trace with the PCB manufacturer. What's the
             minimum distance between two layers? What about the minimum drill and the requirements of vias? Is
             it possible to use blind vias and buried vias?
       Equipped with this information, a designer can do a lot of basic design.

2.2    Board Stackup
       There is no fundamental information about how many layers should be used and how the board stackup
       should look. Again, the easiest way the get good results is to use the design from the EVMs of Texas
       Instruments. The magazine Elektronik Praxis [11] has published an article with an analysis of different
       board stackups. These are listed in Table 3 and Table 4.
       Generally, the use of microstrip traces needs at least two layers, whereas one of them must be a GND
       plane. Better is the use of a four-layer PCB, with a GND and a VCC plane and two signal layers. If the
       circuit is complex and signals must be routed as stripline, because of propagation delay and/or
       characteristic impedance, a six-layer stackup should be used.

                                 Table 3. Possible Board Stackup on a Four-Layer PCB
                                      Model 1                     Model 2                       Model 3                   Model 4
                 Layer 1                SIG                         SIG                          SIG                        GND
                 Layer 2                SIG                         GND                          GND                        SIG
                 Layer 3                VCC                         VCC                          SIG                        VCC
                 Layer 4                GND                         SIG                          VCC                        SIG
               Decoupling               Good                        Good                         Bad                        Bad
                  EMC                   Bad                         Bad                          Bad                        Bad


SCAA082A – November 2006 – Revised August 2017                                                            High-Speed Layout Guidelines   9
Submit Documentation Feedback
                                        Copyright © 2006–2017, Texas Instruments Incorporated
Practical PCB Design Rules                                                                                                         www.ti.com


                               Table 3. Possible Board Stackup on a Four-Layer PCB (continued)
                                           Model 1                     Model 2                        Model 3                  Model 4
            Signal integrity                 Bad                         Bad                            Good                    Bad
           Self disturbance               Satisfaction               Satisfaction                    Satisfaction               High


                                        Table 4. Possible Board Stackup on a Six-Layer PCB
                                Model 1            Model 2             Model 3             Model 4                  Model 5       Model 6
           Layer 1                SIG                SIG                 GND                  SIG                     SIG           SIG
           Layer 2                SIG                GND                 VCC                 GND                     GND           GND
           Layer 3               VCC                 VCC                 SIG                 VCC                     VCC           VCC
           Layer 4               GND                 VCC                 SIG                  SIG                    GND           GND
           Layer 5                SIG                GND                 VCC                 GND                    Not used        SIG
           Layer 6                SIG                SIG                 GND                  SIG                     SIG           SIG
          Decoupling             Good                Good                Good                Good                    Good          Good
             EMC                  Bad                Good            Satisfaction         Satisfaction               Good          Good
        Signal integrity          Bad                Good                Bad                 Good                    Good          Bad


      To determine the right board stackup, consider the following points:
      • Define the location of each section on the board by means of the functional diagram. Try to keep the
         devices together to avoid interaction (crosstalk, influence of noise) between two separate blocks (like
         transmitter–receiver or analog–digital).
      • At which functional block is which supply voltage used?
      • It is necessary in high-speed designs to have at least one complete ground plane as a reference for
         microstrip traces for sensitive signals.
      • With a complete power plane as close as possible to the ground plane, it is possible to create
         capacitive coupling between them to get low impedance at high frequencies. This reduces the amount
         on small decoupling capacitors at the power pins of the devices. The closer the planes, the less
         impedance is present [13].

2.3   Power and Ground Planes
      As previously mentioned, a complete ground plane in high-speed design is essential. Additionally, a
      complete power plane is recommended as well. In a complex system, several regulated voltages can be
      present. The best solution is for every voltage to have its own layer and its own ground plane. But this
      would result in a huge number of layers just for ground and supply voltages. What are the alternatives?
      Split the ground planes and the power planes? In a mixed-signal design, for example, using data
      converters, the manufacturer often recommends splitting the analog ground and the digital ground to avoid
      noise coupling between the digital part and the sensitive analog part.
      Take care when using split ground planes because:
      • Split ground planes act as slot antennas and radiate.
      • A routed trace over a gap creates large loop areas, because the return current cannot flow beside the
         signal, and the signal can induce noise into the nonrelated reference plane (Figure 7).
      • With a proper signal routing, crosstalk also can arise in the return current path due to discontinuities in
         the ground plane. Always take care of the return current (Figure 10).
      Figure 7: Do not route a signal referenced to digital ground over analog ground and vice versa. The return
      current cannot take the direct way along the signal trace and so a loop area occurs. Furthermore, the
      signal induces noise, due to crosstalk (dotted red line) into the analog ground plane.




10    High-Speed Layout Guidelines                                                         SCAA082A – November 2006 – Revised August 2017
                                                                                                          Submit Documentation Feedback
                                             Copyright © 2006–2017, Texas Instruments Incorporated
www.ti.com                                                                                            Practical PCB Design Rules




             Figure 7. Loop Area and Crosstalk Due to Poor Signal Routing and Ground Splitting

       Figure 8: Do not let one ground plane pass another ground plane to get connected to the common ground
       (a). Every ground plane must have its own path to the common ground to reduce noise (b).




        Figure 8. Poor and Good Placement of the Common Ground in a Split Ground Environment

       Figure 9: The use of a complete ground plane is a better solution. Place the devices by function and route
       their signals only in their region. If any interconnection between analog and digital occurs, be careful with
       crosstalk and the return current path.




SCAA082A – November 2006 – Revised August 2017                                                  High-Speed Layout Guidelines   11
Submit Documentation Feedback
                                        Copyright © 2006–2017, Texas Instruments Incorporated
Practical PCB Design Rules                                                                                             www.ti.com




     Figure 9. Good Placement of Different Functional Blocks Without the Need of a Split Ground Plane

       Figure 10: If the trace routing of two signals is done properly, it is still possible to induce noise in the return
       current path by means of crosstalk. In this case, a loop area and crosstalk in the return current path have
       been created.
       • If possible, use a continuous ground plane; do not split them. This can be achieved by a proper
          placement selection. Again, create functional blocks, and place and route them together. By doing this,
          the traces of a digital part cannot influence any trace of the analog part if these sections do not cross
          each other.
       If split ground planes are essential:
       • Do not route signals over a gap. Always strive for the return current flow with the smallest loop area.
       • Connect split ground planes only at one point. More common ground connections can create ground
           loops, and this increases radiation.
       • The return current of a subsystem (for example, an analog system or transmitter path) must not be in
           the path of the other subsystem (digital system or receiver path). The return current should flow directly
           to the common ground point (Figure 8).
       • Power planes should only reference their own ground plane. They should not overlap with another
           ground plane. This leads to capacitive coupling between the power plane and a not-referenced ground
           plane. Noise can couple into the other system.
       • Do not connect bypass capacitors between a power plane and an unrelated ground plane. Again,
           noise can be coupled from one supply system into the other. This mistake can occur in the circuit
           design section.




                             Figure 10. Crosstalk Induced by the Return Current Path


12     High-Speed Layout Guidelines                                                  SCAA082A – November 2006 – Revised August 2017
                                                                                                    Submit Documentation Feedback
                                       Copyright © 2006–2017, Texas Instruments Incorporated
www.ti.com                                                                                            Practical PCB Design Rules

2.4    Decoupling Capacitors
       Decoupling capacitors between the power pin and ground pin of the device ensure low AC impedance to
       reduce noise and to store energy. To reach low impedance over a wide frequency range, several
       capacitors must be used. This is why, a real capacitor consists of its capacitance and a parasitic
       inductance and resistance. Therefore, every real capacitor behaves as a resonant circuit. The capacitive
       characteristics are only valid up to its self-resonant frequency (SRF). Above the SRF, the parasitic effects
       dominate, and the capacitor acts as an inductor. With the use of several capacitors with different values,
       low AC impedance over a wide frequency range can be provided.




      Figure 11. Impedance of Different Capacitors Over a Wide Frequency Range and the Resulting
                                 Impedance of Their Parallel Connection

       Figure 11 shows this context. Capacitors with high values have low impedance in the lower frequency
       range and a low SRF, whereas small-valued capacitors have their SRF in the upper frequency range. This
       depends on the equivalent series resistance (ESR) and the equivalent series inductance (ESL). A good
       combination of several capacitors leads to a low impedance over a wide frequency range. This is shown
       with the Cparallel curve in Figure 11. The gap (increase of the impedance) at around 60 MHz is the result
       of a missing capacitance. If there were a value between 100 nF and 10 nF, the Cparallel curve would not
       increase.
       As previously mentioned, a power and GND plane can represent a capacitance that ensures low
       impedance at high frequencies. Therefore, a well-designed board stackup can minimize the number of
       capacitors required having low-capacitance values.
       General rules for placing capacitors:
       • Place the lowest valued capacitor as close as possible to the device to minimize the inductive influence
         of the trace. This is especially important for small capacitor values, because the inductive influence of
         the trace is not negligible anymore.
       • Place the lowest valued capacitor as close as possible to the power pin/power trace of the device.
       • Connect the pad of the capacitor directly with a via to the ground plane. Use two or three vias to get a
         low-impedance connection to ground. If the distance to the ground pin of the device is short enough,
         you can connect it directly.
       • Make sure that the signal must flow along the capacitor.




SCAA082A – November 2006 – Revised August 2017                                                  High-Speed Layout Guidelines   13
Submit Documentation Feedback
                                        Copyright © 2006–2017, Texas Instruments Incorporated
Practical PCB Design Rules                                                                                              www.ti.com




                                                        Poor Bypassing




                                                         Good Bypassing
                  Figure 12. Poor and Good Placement and Routing of Bypass Capacitors

      The decoupling or the bypass capacitance must provide the high frequency components of the current.
      For example for Advanced Driver Assistance Systems (ADAS), the camera current fluctuates between
      active and blanking periods. Hence, bypass capacitors must take care of the ripple due to non-uniform
      current within a clock cycle, handle load transients, and filter any noise that could cause the high speed
      signal to be corrupted. Parallel capacitors are used to give wideband low impedance.

2.5   Traces, Vias, and Other PCB Components
      A right angle in a trace can cause more radiation. The capacitance increases in the region of the corner,
      and the characteristic impedance changes. This impedance change causes reflections.
      • Avoid right-angle bends in a trace and try to route them at least with two 45° corners. To minimize any
          impedance change, the best routing would be a round bend (see Figure 13).
      • Separate high-speed signals (for example, clock signals) from low-speed signals and digital from
          analog signals; again, placement is important.
      • To minimize crosstalk not only between two signals on one layer but also between adjacent layers,
          route them with 90° to each other.




                                     Figure 13. Poor and Good Right Angle Bends

      The use of vias is essential in most routings, but the designer has to be careful when using them. They
      add additional inductance and capacitance, and reflections occur due to the change in the characteristic
      impedance. Vias also increase the trace length.
      • Avoid vias in differential traces. If it is impossible to avoid them, use vias in both traces or compensate
         the delay also in the other trace.




14    High-Speed Layout Guidelines                                                    SCAA082A – November 2006 – Revised August 2017
                                                                                                     Submit Documentation Feedback
                                        Copyright © 2006–2017, Texas Instruments Incorporated
www.ti.com                                                                                            Practical PCB Design Rules




                              Figure 14. Loop Areas Caused by Poor Via Placement

       Figure 14 illustrates another problem with vias – loop areas. The designer has to make sure that the
       return current can flow ideally underneath (beside) the signal trace. A good way to realize this is to add
       some ground vias around the signal via. This is a similar structure to a coaxial line. Take care if the new
       layer has another distance to the reference plane; this can cause reflections due to an impedance change.
       Figure 15 shows how good via placement avoids loop areas if there is need for multiple vias.




SCAA082A – November 2006 – Revised August 2017                                                  High-Speed Layout Guidelines   15
Submit Documentation Feedback
                                        Copyright © 2006–2017, Texas Instruments Incorporated
Practical PCB Design Rules                                                                                            www.ti.com




                                     Figure 15. Poor and Good Via Placement

      Figure 15: Because of wrong via placement, especially with bus signals, slots in the ground plane can
      arise. Further, the return current can create a loop area when placing the vias in the wrong direction.
      Three different routings are shown on the left. On the right, some traces are masked out to see how the
      return current (green trace) will flow.



16    High-Speed Layout Guidelines                                                  SCAA082A – November 2006 – Revised August 2017
                                                                                                   Submit Documentation Feedback
                                      Copyright © 2006–2017, Texas Instruments Incorporated
www.ti.com                                                                                            Practical PCB Design Rules

       In Figure 16, a four-layer stackup can be seen. The signal changes from layer 1 to layer 2. The via passes
       through all four layers. Thus, we get the structure of an open-end transmission line with no termination
       and thereby a 100% reflection. Due to the length of the stub, a delay also occurs. The worst case is now
       that the two signals (original one → red and reflected one → gray) on layer 2 have a phase shift of 180°,
       and so they cancel each other. The phase shift is due to the delay which arises from the stub length. The
       time delay is twice the stub length divided by the signal speed. To avoid this problem, use blind vias or
       buried vias.




                                  Figure 16. Reflection Caused by Stubs in a Via

       Tips for routing traces and the use of vias:
       • Do not use right-angle bends on traces with controlled impedance and fast rise time, respectively.
       • Route the traces orthogonally to each other on adjacent layers to avoid coupling.
       • To minimize crosstalk, the distance between two traces should be approximately 2 to 3 times the width
          of the trace.
       • Differential traces should be routed as close as possible to get a high coupling factor. As a result of
          this, influenced noise is then a common-mode noise and is not a problem for a differential input stage.
       • Do not use vias on traces with sensitive signals, if unnecessary.
       • Be careful with the return current when changing the layers. Use ground vias around the signal via to
          make sure that the return current can flow as close as possible to the signal (see Figure 14).
       • Do not create slots, for example in the ground plane, by using closely placed vias (see Figure 15).
       • Consider stubs created by vias. If necessary, use blind vias or buried vias (see Figure 16).
       Micro strip implementation for traces can have high crosstalk and are not recommended for high-speed
       digital systems. Stripline traces inherently have zero crosstalk and minimize the EMI/EMC (see An
       EMC/EMI system-design and testing methodology for FPD-Link III SerDes (SLYT719) for more
       information). Striplines require vias because traces have to buried inside the PCB. Vias do offer some
       parasitic inductance in the path, however, good news is that the impedance of a properly designed via can
       be controlled to avoid any reflections on the line. Before concluding that vias are good, consider another
       scenario in which a PCB via is passing through completely through the printed-circuit board. If the trace
       connections are made at one end of the via that leaves a stub on the other side. This stub would look like
       a capacitor on the TDR plot and can create resonance phenomena. At the quarter wave frequency, the
       open-ended stub looks like a short and produces nulls of transmission. Thus, the designer must back drill
       such vias after the PCB is fabricated. The dangling via stub can be trimmed by drilling from the back side.

2.6    Clock Distribution
       Figure 17 shows four possible clock distribution circuits. The problems in Figure 17a are the enormous
       reflections at the branches and the different trace length to the devices. Because of the delay, it is
       possible that the system cannot function properly. To avoid the reflection at the branches, do not use them
       (see Figure 17b). Route the signal in a chain from one device to the other and realize a proper
       termination. Be careful with the delay. In a high-speed environment, it is possible that the data, sent from
       device A to device B, is out of date when the clock signal arrives at device B. A star connection as shown




SCAA082A – November 2006 – Revised August 2017                                                  High-Speed Layout Guidelines   17
Submit Documentation Feedback
                                        Copyright © 2006–2017, Texas Instruments Incorporated
Practical PCB Design Rules                                                                                                       www.ti.com

       in Figure 17c is a good solution to minimize the delay. A clock driver is used to distribute the clock signals
       to the different devices. To minimize the skew, the same trace length for every clock signal should be
       used. Figure 17d illustrates a solution for a complex system. A main clock feeds several clock drivers.
       Again, to reach low skew, implement delay-time compensation and use a proper termination to avoid
       reflections.
       • Be careful with trace length in a clock distribution layout. Consider the delay for each trace. The best
           solution is to route these signals with the same length.
       • Avoid branches to reduce reflections. Use a clock driver to distribute the signal to every device and
           consider a proper termination.




            Clock
            Driver




      a)                Clock                                            c)



                                                                                      Clock                            Clock
                                                                                      Driver                           Driver




                                                                                                    Impedance
                                                                                                     Matching
            A                                                             Clock       Clock                            Clock
                                                                         Generator    Driver                           Driver

                                                                        Matching of
                                                                        Line Length

                                data-line



           Clock
           Driver                                        B



                                                         1 nF
                Clock
      b)                                                 100 W          d)


                                       Figure 17. Poor and Good Clock Distribution on a PCB




18     High-Speed Layout Guidelines                                                            SCAA082A – November 2006 – Revised August 2017
                                                                                                              Submit Documentation Feedback
                                               Copyright © 2006–2017, Texas Instruments Incorporated
www.ti.com                                                                                                               Summary

3      Summary
       This document presents an introduction to designing a PCB, a complex topic. However, the rules
       presented in this introduction can assist the designer in creating proper PCB designs. The higher the
       signal frequency with which the designer must contend, the more complicated will be the PCB design.
       Complicated PCB designs require a deep knowledge, experience, and simulation tools. However, it is not
       always necessary to route traces as short as possible, differential signals as close as possible, or to avoid
       crosstalk as much as possible. Rather, it depends on the signal on the trace. Basically, the designer must
       know which are the sensitive parts in the circuit or where problems due to reflections can occur. With this
       knowledge, a good placement of the devices can be made. Because placement is such an important step
       in high-speed design, the designer will do well to always keep it and the return current in mind.

4      References
       1. High-Speed DSP Systems Design Reference Guide (SPRU889)
       2. Crosstalk, Part 1: The conversion we wish would stop, Douglas Brooks,
          http://www.ultracad.com/articles/crosstlk.pdf
       3. Crosstalk, Part 2: How loud is your crosstalk?, Douglas Brooks,
          http://www.ultracad.com/articles/crosstlk.pdf
       4. Crosstalk, EMI and differential Z, Douglas Brooks,
          http://www.ultracad.com/articles/crossemianddifferentialz.pdf
       5. Crosstalk, Part 1: Understanding Forward vs Backward, Douglas Brooks,
          http://www.ultracad.com/mentor/mentor%20crosstalk%20part1.pdf
       6. Differential Impedance: What's the difference, Douglas Brooks,
          http://www.ultracad.com/articles/diff_z.pdf
       7. Differential Signals, Douglas Brooks, http://www.ultracad.com/articles/differentialrules.pdf
       8. Adjusting signal timing (part 1), Douglas Brooks,
          http://www.ultracad.com/mentor/mentor%20signal%20timing1.pdf
       9. Transmission line termination, Douglas Brooks,
          http://www.ultracad.com/mentor/transmission%20line%20terminations.pdf
       10. EMV-Design Richtlinien, B.Foeste/s.Oeing, ISBN: 3-7723-5499-8, Franzis
       11. Elektronik-Praxis: Die Leiterplatte 2010, Ausgabe 11/06, P72-77
       12. Microstrip propagation times – slower than we think, Douglas Brooks,
          http://www.ultracad.com/mentor/microstrip%20propagation.pdf
       13. Design for minimizing electromagnetic interference in high frequency RF and digital boards and
          systems, Dr. Eric Bogatin, www.bethesignal.com
       14. Ankur Verma, An EMC/EMI system-design and testing methodology for FPD-Link III SerDes
          (SLYT719), 2Q’ 2017, Analog Applications Journal




SCAA082A – November 2006 – Revised August 2017                                                  High-Speed Layout Guidelines   19
Submit Documentation Feedback
                                        Copyright © 2006–2017, Texas Instruments Incorporated
Revision History                                                                                                                           www.ti.com


                                                               Revision History
NOTE: Page numbers for previous revisions may differ from page numbers in the current version.

Changes from Original (November 2006) to A Revision ................................................................................................ Page

•    Added content to Crosstalk section ..................................................................................................... 8
•    Added content to Decoupling Capacitors section ................................................................................... 13




20       Revision History                                                                       SCAA082A – November 2006 – Revised August 2017
                                                                                                               Submit Documentation Feedback
                                                 Copyright © 2006–2017, Texas Instruments Incorporated
                          IMPORTANT NOTICE FOR TI DESIGN INFORMATION AND RESOURCES

Texas Instruments Incorporated (‘TI”) technical, application or other design advice, services or information, including, but not limited to,
reference designs and materials relating to evaluation modules, (collectively, “TI Resources”) are intended to assist designers who are
developing applications that incorporate TI products; by downloading, accessing or using any particular TI Resource in any way, you
(individually or, if you are acting on behalf of a company, your company) agree to use it solely for this purpose and subject to the terms of
this Notice.
TI’s provision of TI Resources does not expand or otherwise alter TI’s applicable published warranties or warranty disclaimers for TI
products, and no additional obligations or liabilities arise from TI providing such TI Resources. TI reserves the right to make corrections,
enhancements, improvements and other changes to its TI Resources.
You understand and agree that you remain responsible for using your independent analysis, evaluation and judgment in designing your
applications and that you have full and exclusive responsibility to assure the safety of your applications and compliance of your applications
(and of all TI products used in or for your applications) with all applicable regulations, laws and other applicable requirements. You
represent that, with respect to your applications, you have all the necessary expertise to create and implement safeguards that (1)
anticipate dangerous consequences of failures, (2) monitor failures and their consequences, and (3) lessen the likelihood of failures that
might cause harm and take appropriate actions. You agree that prior to using or distributing any applications that include TI products, you
will thoroughly test such applications and the functionality of such TI products as used in such applications. TI has not conducted any
testing other than that specifically described in the published documentation for a particular TI Resource.
You are authorized to use, copy and modify any individual TI Resource only in connection with the development of applications that include
the TI product(s) identified in such TI Resource. NO OTHER LICENSE, EXPRESS OR IMPLIED, BY ESTOPPEL OR OTHERWISE TO
ANY OTHER TI INTELLECTUAL PROPERTY RIGHT, AND NO LICENSE TO ANY TECHNOLOGY OR INTELLECTUAL PROPERTY
RIGHT OF TI OR ANY THIRD PARTY IS GRANTED HEREIN, including but not limited to any patent right, copyright, mask work right, or
other intellectual property right relating to any combination, machine, or process in which TI products or services are used. Information
regarding or referencing third-party products or services does not constitute a license to use such products or services, or a warranty or
endorsement thereof. Use of TI Resources may require a license from a third party under the patents or other intellectual property of the
third party, or a license from TI under the patents or other intellectual property of TI.
TI RESOURCES ARE PROVIDED “AS IS” AND WITH ALL FAULTS. TI DISCLAIMS ALL OTHER WARRANTIES OR
REPRESENTATIONS, EXPRESS OR IMPLIED, REGARDING TI RESOURCES OR USE THEREOF, INCLUDING BUT NOT LIMITED TO
ACCURACY OR COMPLETENESS, TITLE, ANY EPIDEMIC FAILURE WARRANTY AND ANY IMPLIED WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, AND NON-INFRINGEMENT OF ANY THIRD PARTY INTELLECTUAL
PROPERTY RIGHTS.
TI SHALL NOT BE LIABLE FOR AND SHALL NOT DEFEND OR INDEMNIFY YOU AGAINST ANY CLAIM, INCLUDING BUT NOT
LIMITED TO ANY INFRINGEMENT CLAIM THAT RELATES TO OR IS BASED ON ANY COMBINATION OF PRODUCTS EVEN IF
DESCRIBED IN TI RESOURCES OR OTHERWISE. IN NO EVENT SHALL TI BE LIABLE FOR ANY ACTUAL, DIRECT, SPECIAL,
COLLATERAL, INDIRECT, PUNITIVE, INCIDENTAL, CONSEQUENTIAL OR EXEMPLARY DAMAGES IN CONNECTION WITH OR
ARISING OUT OF TI RESOURCES OR USE THEREOF, AND REGARDLESS OF WHETHER TI HAS BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.
You agree to fully indemnify TI and its representatives against any damages, costs, losses, and/or liabilities arising out of your non-
compliance with the terms and provisions of this Notice.
This Notice applies to TI Resources. Additional terms apply to the use and purchase of certain types of materials, TI products and services.
These include; without limitation, TI’s standard terms for semiconductor products http://www.ti.com/sc/docs/stdterms.htm), evaluation
modules, and samples (http://www.ti.com/sc/docs/sampterms.htm).


                             Mailing Address: Texas Instruments, Post Office Box 655303, Dallas, Texas 75265
                                            Copyright © 2017, Texas Instruments Incorporated


==========================================
FILE: swpa222a.pdf
==========================================

                                                                                   Application Report
                                                                             SWPA222A – November 2012




                                             Power Delivery Network Analysis
Erwan Petillon                                                                 HW Systems Solutions

                                             ABSTRACT
      The purpose of the Application Note (APN) is to present the flow, the environment settings
      and TI requirements used to perform the analysis of critical power nets of a platform using
      an application processor. In complement to the APN, a package including all necessary
      data to perform a PDN analysis of the OMAP4430 Blaze processor board are attached
      (layout, stack-up, schematic….)
      The Power Delivery Network (PDN) performance is measured by extracting of the Printed
      Circuit Board (PCB) 3 parameters, DC resistivity, capacitor loop inductance and target
      impedance decoupling.
      The application note explained each parameter theoretically and detailed the environment,
      set-up for the parameters extraction and comparisons to TI recommendations. To
      conclude each parameter sections, PDN extraction results of the OMAP4430 Blaze
      processor board with some general layout recommendations are presented.

                                           Document History
           Version             Date                   Author                       Notes
                 1.0        August 2012              E. Petillon                First release
                 A         November 2012             E. Petillon         Numerous typo corrections.




                               WARNING: EXPORT NOTICE
Recipient agrees to not knowingly export or re-export, directly or indirectly, any product or
technical data (as defined by the U.S., EU, and other Export Administration Regulations)
including software, or any controlled product restricted by other applicable national
regulations, received from Disclosing party under this Agreement, or any direct product of such
technology, to any destination to which such export or re-export is restricted or prohibited by
U.S. or other applicable laws, without obtaining prior authorization from U.S. Department of
Commerce and other competent Government authorities to the extent required by those laws.
This provision shall survive termination or expiration of this Agreement.
According to our best knowledge of the state and end-use of this product or technology, and in
compliance with the export control regulations of dual-use goods in force in the origin and
exporting countries, this technology is classified as follows:

US ECCN: 3E991
EU ECCN: EAR99

And may require export or re-export license for shipping it in compliance with the applicable
regulations of certain countries.




                                                                                                      1
SWPA222A


                                                                 Contents
1     Generals ........................................................................................................................................ 3
2     DC resistance ............................................................................................................................... 4
3     Capacitor Loop inductance ......................................................................................................... 7
4     Target impedance....................................................................................................................... 10
5     OMAP4430 Blaze processor board PDN analysis. ................................................................... 13




                                                          Figures
Figure 1: Power Delivery Network model ........................................................................................... 3
Figure 2: DC resistance ....................................................................................................................... 4
Figure 3: DC resistance extraction flow ............................................................................................. 5
Figure 4: VCORE1_OMAP_MPU OMAP4430 Blaze OMAP4430 processor board. ........................... 6
Figure 5: VCORE1_OMAP_MPU voltage mapping ............................................................................. 7
Figure 6: Loop inductance principle ................................................................................................... 8
Figure 7: Capacitors loop inductance extraction flow ...................................................................... 8
Figure 8: Capacitors Loop inductance on VCORE1_OMAP_MPU .................................................... 9
Figure 9: Target impedance extraction flow..................................................................................... 10
Figure 10: VCORE1_OMAP_MPU OMAP4430 Blaze processor board ZTARGET response ......... 12
Figure 11: Different ZTARGET responses of VCORE2_OMAP_IVAUD net .................................... 13




                                           Tables
Table 1: OMAP4430 Blaze processor board stack-up ....................................................................... 4
Table 2: DC resistance OMAP4430 blaze processor board............................................................... 6
Table 3: DC resistance OMAP4430 blaze processor board with GND return path included ........... 6
Table 5: DC resistivity OMAP4430 PDN requirements ...................................................................... 7
Table 6: Loop Inductance OMAP4430 PDN requirements ................................................................. 9
Table 7: Target Impedance OMAP4430 PDN requirements ............................................................. 11
Table 8: OMAP4430 Blaze processor board ZTARGET results....................................................... 11




2                   Power Delivery Network Analysis
                                                                                            SWPA222A
1 Generals
   PDN performances were not considered as major criteria in the early of the PCB designs. In
   today’s platform with lower voltage, higher current, smaller voltage noise margin, PDN
   performances should be estimated early in the PCB design and optimized to meet the device
   specification.
   The objective of a PDN is to supply a clean and stable voltage to the device. However the PDN
   is not ideal due to the parasitic added by the elements constituting the power network. Figure 1
   presents a break-down model of a complete PDN network from Voltage Resource Manager
   (VRM) to the Application Processor (AP).




                              Figure 1: Power Delivery Network model

   This APN focuses on the analysis of the PCB and the decoupling capacitors strategy used.
   To extract the PDN performances of the PCB layout, you will need:
      • Platform Schematic.
      • PCB Layout out.
      • PCB Stack-up with dielectric properties (Dk and Df), refer to Table 1.
      • S-parameters capacitors models from manufacturer.
      • Power Integrity (PI) tool.
   PDN results for the OMAP4430 blaze processor board were extracted using nVolt from Nimbic.


                                     Thickness            Dielectric properties
                             In um         In mils       Dk             Df
                   L1          5           0.197
                   prepreg     50          1.969         4.5           0.035
                   L2          35          1.378




                                                                        Power Delivery Network Analysis   3
SWPA222A

                    prepreg       50            1.969         4.5       0.035
                    L3            35            1.378
                    prepreg       60            2.362         4.5       0.035
                    L4            35            1.378
                    prepreg       140           5.512         4.5       0.035
                    L5            17            0.669
                    prepreg       304           11.969        4.5       0.035
                    L6            17            0.669
                    prepreg       140           5.512         4.5       0.035
                    L7            35            1.378
                    prepreg       60            2.362         4.5       0.035
                    L8            35            1.378
                    prepreg       50            1.969         4.5       0.035
                    L9            35            1.378
                    prepreg       50            1.969         4.5       0.035
                    L10            5            0.197
                    Total        1158         45.5905512
                            Table 1: OMAP4430 Blaze processor board stack-up



2 DC resistance
    DC resistance is determined by the geometry of the net, its material conductivity, refer to Figure
    2.




                                          Figure 2: DC resistance



    Once DC resistance is determined, IR drop can be calculated with Ohm’s law.
                                               𝐷𝐶 𝐼𝑅 𝑑𝑟𝑜𝑝 = 𝑅𝑑𝑐 . 𝐼
    An IR drop of 0.5%-2.5% of the nominal voltage is tolerated depending on the total system-level
    margin allowed for proper device functionality and sense line position.




4           Power Delivery Network Analysis
                                                                                          SWPA222A
TI specifies in the Data Manual (DM) a board DC resistance budget, from VRM to OMAP balls
for critical power nets.
Due to the shape geometry complexity, vias and multilayer’s used during the net routing, it is
difficult to calculate manually the DC resistance. Numerous Signal Integrity (SI) or Layout EDA
tools extract the DC resistance.
To extract DC resistance, you will need:
   • Platform Schematic.
   • PCB Layout out.
   • PCB Stack-up.
   • DC resistance extracting tool.

Figure 3 describe the flow used by most of the tool to extract DC resistance. In TI PDN analysis,
the lumped methodology is preferred; each power and GND pins of VRM and AP are grouped.




                            Figure 3: DC resistance extraction flow




                                                                      Power Delivery Network Analysis   5
SWPA222A




              Figure 4: VCORE1_OMAP_MPU OMAP4430 Blaze OMAP4430 processor board.

     Table 2 presents the DC resistivity analysis of VCORE1_OMAP_MPU, VCORE2_OMAP_IVAUD
     and VCORE2_OMAP_CORE nets.


Net Name                Volt      Max Current       TI recommendations             Extracted resistance    Max Irdrop
                         (v)          (A)                  (mOhm)                        (mOhm)              (mV)
VCORE1_OMAP_MPU         1.38         1.45                      14                         8.45               12.25
VCORE2_OMAP_IVAUD       1.26          0.7                      29                         13.80               9.66
VCORE3_OMAP_CORE         1.1         0.85                     13.75                       18.34              15.58
                          Table 2: DC resistance OMAP4430 blaze processor board


     In this configuration, DC resistivity is measured between VRM and OMAP balls. GND return path
     (GND plane) is not included as its effect is minor as it is shown in Table 3.


                        Current             Loop Resistance            OMAP balls             V+ (Volts)     V- (Volts)
                        (Amps)                  (Ohms)                Voltage(Volts)

VCORE1_OMAP_MPU           1.45                0.00860495                 1.36729               1.36775      0.000459935
VCORE2_OMAP_IVAUD         0.7                 0.0139813                  1.24986               1.25032      0.000459935
VCORE3_OMAP_CORE          0.85                0.0185016                  1.08394                 1.0844     0.000459935
           Table 3: DC resistance OMAP4430 blaze processor board with GND return path included



     Other tool offers the possibility to map current and voltage distribution over the power nets and
     GND return path, refer to Figure 5.




6            Power Delivery Network Analysis
                                                                                                 SWPA222A




                              Figure 5: VCORE1_OMAP_MPU voltage mapping

     Table 4 presents maximum DC resistivity of OMAP4430 for 1GHz and 1.2GHz operation.


                                 PDN IMPEDANCE CHARACTERISTICS                           MAXIMUM LOOP
                                                                   PCB RESISTANCE
                                                                                         INDUCTANCE PER
       PARAMETERS                                                  BETWEEN SPMS
                                 IMPEDANCE        FREQUENCY OF                         CAPACITOR (WITHOUT
                                                                     and OMAP
                                TARGET (mΩ)      INTEREST (MHz)                             ESL) (nH)
VCORE3_OMAP_CORE                    122               48               13.75                    1
VCORE1_OMAP_MPU     1GHz            93                40                14                     0.7
                    1.2GHz          71                28                10                     0.7
VCORE2_OMAP_IVAUD                   194               46                29                      1

                             Table 4: DC resistivity OMAP4430 PDN requirements

     General recommendations for minimizing DC resistivity:
       • Shorten the length of the power nets trace by optimizing VRM and AP placement but also
           their balls positioning.
       • Widen the power nets trace.
       • Avoid discontinuity in power nets trace by inserting other signal nets or matrix of vias with
           their associated anti-pads (Swiss cheese effect) within the power nets.
       • Avoid via starvation by determining maximum current carrying capacity and numbers of
           transitional via.



3 Capacitor Loop inductance
     The loop inductance is a parameter quantifying the effectiveness of a decoupling capacitor.
     Figure 6 represents the different loop inductances added to the capacitor ESL.




                                                                             Power Delivery Network Analysis   7
SWPA222A




                                    Figure 6: Loop inductance principle

     Figure 7 shows a typical flow for capacitors Z-parameters extraction. Once Z-parameters is
    extracted, the loop inductance of a capacitor is determined by
                                              𝐼𝑚𝑎𝑔𝑖𝑛𝑎𝑟𝑦 𝑍𝑝𝑜𝑤𝑒𝑟,𝑔𝑛𝑑 𝑝𝑎𝑑𝑠 𝑜𝑓 𝑐𝑎𝑝𝑠
                                   𝐿𝑒𝑓𝑓 =
                                                        2𝜋 ∗ 𝐹𝑟𝑒𝑞


    Where Leff is the effective loop inductance,
           Zpower , gnd pads of caps represents the Z-response of the port defined across the power and
    ground pads of the corresponding capacitors,
    Typically, capacitors loop inductance is determined at a frequency of 50 MHz.




                           Figure 7: Capacitors loop inductance extraction flow




8           Power Delivery Network Analysis
                                                                                               SWPA222A
     TI specifies in the Data Manual (DM) a maximum capacitor loop inductance, for example Table 5
     refers to OMAP4430 PDN requirements. Following this requirement will help significantly to meet
     TI target impedance decoupling requirement, refer to section 4 for more details.


                                PDN IMPEDANCE CHARACTERISTICS                          MAXIMUM LOOP
                                                                 PCB RESISTANCE
                                                                                       INDUCTANCE PER
       PARAMETERS                                                BETWEEN SPMS
                                IMPEDANCE        FREQUENCY OF                        CAPACITOR (WITHOUT
                                                                   and OMAP
                               TARGET (mΩ)      INTEREST (MHz)                            ESL) (nH)
VCORE3_OMAP_CORE                   122               48              13.75                    1
VCORE1_OMAP_MPU     1GHz           93                40               14                     0.7
                    1.2GHz          71               28               10                     0.7
VCORE2_OMAP_IVAUD                  194               46               29                      1

                           Table 5: Loop Inductance OMAP4430 PDN requirements

     To extract capacitors loop inductance, you will need:
        • Platform Schematic.
        • PCB Layout out.
        • PCB Stack-up.
        • Loop inductance extracting tool.
     Figure 8 presents the loop inductance results of all decoupling capacitors on
     VCORE1_OMAP_MPU at 50 MHz. All capacitors loop inductances are below recommendations.




                     Figure 8: Capacitors Loop inductance on VCORE1_OMAP_MPU

     It is also interesting to extract VRM loop inductance and compare it to DM specification.
     General recommendations for minimizing capacitors loop inductance:
       • Keep the power and ground plane pair as close to the TOP and BOTTOM surfaces.
       • Placing power and ground plane pairs closer to the surface where the capacitor is
           mounted.
       • Avoid discontinuity in power or GND planes to provide continuous return path for return
           current.



                                                                           Power Delivery Network Analysis   9
SWPA222A
          •   Use via-in-pads for capacitors.
          •   Place vias as close to AP balls.
          •   Place decoupling capacitors closed to AP.
          •   Select capacitors with small footprint to minimize ESL.


4 Target impedance
To complete the PDN analysis, it is necessary to determine the target impedance of the overall power
net. Target impedance extraction is achieved using the Frequency Domain Target Impedance Method
(FDTIM ).and the objective is to maintain the target spectrum below the Z target value (Ztarget) from DC
to Fmax.
The Ztarget value is determined by:
                                                  𝑉𝑜𝑙𝑡𝑎𝑔𝑒 𝑅𝑎𝑖𝑙 ∗ % 𝑅𝑖𝑝𝑝𝑙𝑒
                                      𝑍𝑡𝑎𝑟𝑔𝑒𝑡 =
                                                     0.5 ∗ 𝐼𝑚𝑎𝑥 𝑡𝑟𝑎𝑛𝑠𝑖𝑒𝑛𝑡


FMAX is the point in frequency after which adding a reasonable number of decoupling capacitors does
not bring down the power rail impedance |ZEFF| below the target impedance (ZTARGET ) due to the
dominance of the parasitic planar spreading inductance and package inductances.

Figure 9 presents a typical flow for a Target impedance extraction.




                                   Figure 9: Target impedance extraction flow

      TI specifies, in the DM, an impedance target (ZTARGET) and a frequency range (FMAX). Table 6
      refers to OMAP4430 PDN requirements.




10             Power Delivery Network Analysis
                                                                                                         SWPA222A

                                    PDN IMPEDANCE CHARACTERISTICS                                 MAXIMUM LOOP
                                                                        PCB RESISTANCE
                                                                                                  INDUCTANCE PER
       PARAMETERS                                                       BETWEEN SPMS
                                     IMPEDANCE       FREQUENCY OF                               CAPACITOR (WITHOUT
                                                                          and OMAP
                                    TARGET (mΩ)     INTEREST (MHz)                                   ESL) (nH)
VCORE3_OMAP_CORE                        122              48                    13.75                     1
VCORE1_OMAP_MPU     1GHz                93               40                     14                      0.7
                    1.2GHz              71               28                      10                     0.7
VCORE2_OMAP_IVAUD                       194              46                      29                     1

                           Table 6: Target Impedance OMAP4430 PDN requirements

     To determine target impedance response, you will need:
        • Platform Schematic.
        • PCB Layout out.
        • PCB Stack-up.
        • S-parameters capacitors models from manufacturer.
        • Target impedance (S-parameters) extracting tool.


     During the PDN analysis it is important to capture the decoupling frequency achieved for the
     required target impedance but also the target impedance achieved at the required decoupling
     frequency.
     Table 7 resumes the target impedance results achieved on OMAP4430 Blaze processor board.
     Figure 10 represents the complete target impedance response of the VCORE1_OMAP_MPU net
     on OMAP4430 blaze processor board.


                            TI recommendations                 OMAP4430 Blaze processor board results
                                                                                            At TI
        Net Name                                         At TI        Reached
                            Value       Frequency                                      recommended       Reached
                                                    recommended      frequency
                            (mΩ)          (MHz)                                          frequency      value (mΩ)
                                                      value (mΩ)       (MHz)
                                                                                           (MHz)
    VCORE1_OMAP_MPU          93               40        93              49.2                 40               75
   VCORE2_OMAP_IVAUD         194              46        194              86                46                 98
   VCORE3_OMAP_CORE          122              48        122             48.4               48                 122

                           Table 7: OMAP4430 Blaze processor board ZTARGET results




                                                                                  Power Delivery Network Analysis    11
SWPA222A




           Figure 10: VCORE1_OMAP_MPU OMAP4430 Blaze processor board ZTARGET response

     Recommendations for improving target impedance response are similar to the recommendations
     to reduce the capacitors loop inductances. It is clear that reducing or removing capacitors with
     high loop inductance could help improving the ZTARGET response.
     If resonant peak appears before the required decoupling frequency then the decoupling strategy
     should be modified, add or replace a capacitor by the appropriate value to remove or decrease
     the resonant peak.
     Figure 11 represents various target impendence responses with different decoupling strategy,
     only bulks capacitors, only 100nF capacitors, no capacitors.




12           Power Delivery Network Analysis
                                                                                         SWPA222A




                 Figure 11: Different ZTARGET responses of VCORE2_OMAP_IVAUD net



5   OMAP4430 Blaze processor board PDN analysis.
    A complete package to perform the PDN analysis of OMAP4430 Blaze processor board is
    attached to the application note. Use the Adobe paperclip icon to access the files below:


       •   OMAP4430 processor board Schematic (750-2165-001-SCH_REVB_PDN_only.pdf).
       •   PCB Layout out (720-2165-002_RevA_PDN_only.brd)
       •   PCB Stack-up with dielectric properties (Dk and Df) attached in the excel sheet.
       •   S-parameters capacitors models used for target impedance extraction.
       •   Excel sheet (TI-blaze4430_rev720-2165-002_results.xlsx) resuming the PDN results of
           VCORE1_OMAP_MPU, VCORE2_OMAP_IVAUD and VCORE3_OMAP_CORE
           extracted using nVolt tool.




                                                                    Power Delivery Network Analysis   13
                                                              IMPORTANT NOTICE
Texas Instruments Incorporated and its subsidiaries (TI) reserve the right to make corrections, enhancements, improvements and other
changes to its semiconductor products and services per JESD46, latest issue, and to discontinue any product or service per JESD48, latest
issue. Buyers should obtain the latest relevant information before placing orders and should verify that such information is current and
complete. All semiconductor products (also referred to herein as “components”) are sold subject to TI’s terms and conditions of sale
supplied at the time of order acknowledgment.
TI warrants performance of its components to the specifications applicable at the time of sale, in accordance with the warranty in TI’s terms
and conditions of sale of semiconductor products. Testing and other quality control techniques are used to the extent TI deems necessary
to support this warranty. Except where mandated by applicable law, testing of all parameters of each component is not necessarily
performed.
TI assumes no liability for applications assistance or the design of Buyers’ products. Buyers are responsible for their products and
applications using TI components. To minimize the risks associated with Buyers’ products and applications, Buyers should provide
adequate design and operating safeguards.
TI does not warrant or represent that any license, either express or implied, is granted under any patent right, copyright, mask work right, or
other intellectual property right relating to any combination, machine, or process in which TI components or services are used. Information
published by TI regarding third-party products or services does not constitute a license to use such products or services or a warranty or
endorsement thereof. Use of such information may require a license from a third party under the patents or other intellectual property of the
third party, or a license from TI under the patents or other intellectual property of TI.
Reproduction of significant portions of TI information in TI data books or data sheets is permissible only if reproduction is without alteration
and is accompanied by all associated warranties, conditions, limitations, and notices. TI is not responsible or liable for such altered
documentation. Information of third parties may be subject to additional restrictions.
Resale of TI components or services with statements different from or beyond the parameters stated by TI for that component or service
voids all express and any implied warranties for the associated TI component or service and is an unfair and deceptive business practice.
TI is not responsible or liable for any such statements.
Buyer acknowledges and agrees that it is solely responsible for compliance with all legal, regulatory and safety-related requirements
concerning its products, and any use of TI components in its applications, notwithstanding any applications-related information or support
that may be provided by TI. Buyer represents and agrees that it has all the necessary expertise to create and implement safeguards which
anticipate dangerous consequences of failures, monitor failures and their consequences, lessen the likelihood of failures that might cause
harm and take appropriate remedial actions. Buyer will fully indemnify TI and its representatives against any damages arising out of the use
of any TI components in safety-critical applications.
In some cases, TI components may be promoted specifically to facilitate safety-related applications. With such components, TI’s goal is to
help enable customers to design and create their own end-product solutions that meet applicable functional safety standards and
requirements. Nonetheless, such components are subject to these terms.
No TI components are authorized for use in FDA Class III (or similar life-critical medical equipment) unless authorized officers of the parties
have executed a special agreement specifically governing such use.
Only those TI components which TI has specifically designated as military grade or “enhanced plastic” are designed and intended for use in
military/aerospace applications or environments. Buyer acknowledges and agrees that any military or aerospace use of TI components
which have not been so designated is solely at the Buyer's risk, and that Buyer is solely responsible for compliance with all legal and
regulatory requirements in connection with such use.
TI has specifically designated certain components as meeting ISO/TS16949 requirements, mainly for automotive use. In any case of use of
non-designated products, TI will not be responsible for any failure to meet ISO/TS16949.
Products                                                           Applications
Audio                                www.ti.com/audio              Automotive and Transportation      www.ti.com/automotive
Amplifiers                           amplifier.ti.com              Communications and Telecom         www.ti.com/communications
Data Converters                      dataconverter.ti.com          Computers and Peripherals          www.ti.com/computers
DLP® Products                        www.dlp.com                   Consumer Electronics               www.ti.com/consumer-apps
DSP                                  dsp.ti.com                    Energy and Lighting                www.ti.com/energy
Clocks and Timers                    www.ti.com/clocks             Industrial                         www.ti.com/industrial
Interface                            interface.ti.com              Medical                            www.ti.com/medical
Logic                                logic.ti.com                  Security                           www.ti.com/security
Power Mgmt                           power.ti.com                  Space, Avionics and Defense        www.ti.com/space-avionics-defense
Microcontrollers                     microcontroller.ti.com        Video and Imaging                  www.ti.com/video
RFID                                 www.ti-rfid.com
OMAP Applications Processors         www.ti.com/omap               TI E2E Community                   e2e.ti.com
Wireless Connectivity                www.ti.com/wirelessconnectivity


                             Mailing Address: Texas Instruments, Post Office Box 655303, Dallas, Texas 75265
                                            Copyright © 2012, Texas Instruments Incorporated


==========================================
FILE: szza009.pdf
==========================================

PCB Design Guidelines
  For Reduced EMI




          SZZA009
        November 1999




                        1
                                         IMPORTANT NOTICE

    Texas Instruments and its subsidiaries (TI) reserve the right to make changes to their products
    or to discontinue any product or service without notice, and advise customers to obtain the latest
    version of relevant information to verify, before placing orders, that information being relied on
    is current and complete. All products are sold subject to the terms and conditions of sale supplied
    at the time of order acknowledgement, including those pertaining to warranty, patent
    infringement, and limitation of liability.

    TI warrants performance of its semiconductor products to the specifications applicable at the
    time of sale in accordance with TI’s standard warranty. Testing and other quality control
    techniques are utilized to the extent TI deems necessary to support this warranty. Specific testing
    of all parameters of each device is not necessarily performed, except those mandated by
    government requirements.

    CERTAIN APPLICATIONS USING SEMICONDUCTOR PRODUCTS MAY INVOLVE
    POTENTIAL RISKS OF DEATH, PERSONAL INJURY, OR SEVERE PROPERTY OR
    ENVIRONMENTAL DAMAGE (“CRITICAL APPLICATIONS”). TI SEMICONDUCTOR
    PRODUCTS ARE NOT DESIGNED, AUTHORIZED, OR WARRANTED TO BE SUITABLE FOR
    USE IN LIFE-SUPPORT DEVICES OR SYSTEMS OR OTHER CRITICAL APPLICATIONS.
    INCLUSION OF TI PRODUCTS IN SUCH APPLICATIONS IS UNDERSTOOD TO BE FULLY
    AT THE CUSTOMER’S RISK.

    In order to minimize risks associated with the customer’s applications, adequate design and
    operating safeguards must be provided by the customer to minimize inherent or procedural
    hazards.

    TI assumes no liability for applications assistance or customer product design. TI does not
    warrant or represent that any license, either express or implied, is granted under any patent right,
    copyright, mask work right, or other intellectual property right of TI covering or relating to any
    combination, machine, or process in which such semiconductor products or services might be
    or are used. TI’s publication of information regarding any third party’s products or services does
    not constitute TI’s approval, warranty or endorsement thereof.




                          Copyright  1999, Texas Instruments Incorporated




2
                                                                                      Contents
                                                                                          Title                                                                                     Page
ABSTRACT . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1
1 Background . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1
     1.1 RF Sources . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1
     1.2 Surface-Mount Devices vs Through-Hole Components . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1
     1.3 Static Pins vs Active Pins vs Inputs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1
     1.4 Basic Loops . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2
          1.4.1 Proportionality of Loops and Dipoles . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3
     1.5 Differential vs Common Mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3
2 Board Layout . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4
    2.1 Grounds and Power . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4
         2.1.1 Inductance . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4
         2.1.2 Two-Layer vs Four-Layer Boards . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4
         2.1.3 Microcomputer Grounds in One- and Two-Layer Designs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5
         2.1.4 Signal Return Grounds . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5
         2.1.5 Analog vs Digital vs High Power . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5
         2.1.6 Analog Power-Supply Pins and Analog Reference Voltages . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6
         2.1.7 Power Plane Do’s and Dont’s for Four-Layer Boards . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6
         2.2 Power Distribution for Two-Layer Boards . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7
         2.2.1 Single-Point vs Multipoint Distribution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7
         2.2.2 Star Distribution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7
         2.2.3 Gridding to Create Planes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7
         2.2.4 Bypassing and Ferrite Beads . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9
         2.2.5 Keeping Noise Close to the Chip . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11
         2.3 Board Zoning . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12
    2.4 Signal Traces . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
         2.4.1 Capacitive and Inductive Crosstalk . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
         2.4.2 Antenna Factor Length Rules . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
         2.4.3 Series Termination, Transmission Lines . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
         2.4.4 Impedance Matching at Inputs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
    2.5 Cables and Connectors . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
         2.5.1 Differential-Mode and Common-Mode Noise . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
         2.5.2 Crosstalk Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
         2.5.3 Number of Returns . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
         2.5.4 I/O Recommendations for Off-PCB Signals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
         2.5.5 Keeping Noise and Electrostatic Discharge (ESD) Out . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
    2.6 Other Layout Issues . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
         2.6.1 Front-Panel PCB with Keypad and Display in Automotive and Consumer Applications . . . . . . . . . . . . . 15
         2.6.2 Layout for Susceptibility . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16
         2.6.3 Autorouters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16
3 Shielding . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
     3.1 How It Works . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
     3.2 Grounding the Shield . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
     3.3 Cables and Bypassing to the Shield . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
     3.4 Slot Antennas: Cooling Slots and Seams . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18
4 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18
5 Literature . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19


                                                                                                                                                                                         iii
                                                                         List of Illustrations
Figure                                                                                Title                                                                                    Page
     1    Signals Below 50 kHz Are Not EMI Concerns . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2
     2    Examples of Loops . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3
     3    Differential vs Common-Mode Noise . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4
     4    Microcomputer Ground . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5
     5    Layout Considerations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6
     6    Power Distribution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7
     7    Gridding Power Traces on Two-Layer Boards . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8
     8    Gridding of Ground Fills and Traces to Form a Ground Plane . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9
     9    Ferrite-Bead Placement Closest to the Noise Source . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
     10   Board Zoning . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12
     11   MOS Buffer Simplified Schematic . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
     12   Front-Panel Gridding to Form Two Ground Planes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16
     13   Mounting Filter Capacitors for External I/Os . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18



                                                                              List of Tables
Table                                                                                 Title                                                                                    Page
     1    Termination Characteristics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13




iv
                                                          ABSTRACT
General layout guidelines for printed circuit boards (PCB), which exist in relatively obscure documents, are summarized. Some
guidelines apply specifically to microcontrollers; however, the guidelines are intended to be general, and apply to virtually all
modern CMOS integrated circuits. This document covers most known and published layout techniques as applied in a
low-noise, unshielded environment. Efforts have been made to target two-layer boards, and the maximum acceptable noise
level is assumed to be 30 dB, or greater, more stringent than FCC Part 15. This level seems to be the upper limit of acceptable
noise in European and U.S. automotive markets.
This document does not always explain the why’s of a given technique because it is intended only as a reference document,
not a teaching aid. The reader is cautioned against making the assumption that although on a prior design a given technique
was not applied and the unit had acceptable performance, that the technique is not useful. Over time, as IC devices increase
in speed and density, every method to isolate and reduce noise will be required.

                                                        1 Background

                                                       1.1 RF Sources
Design guidelines to be discussed concern radio-frequency (RF) noise from the microcomputer. This noise is generated inside
the device and is coupled out in many different possible ways. The noise is present on all outputs, inputs, power supply, and
ground at all times. Potentially, every pin on the microcomputer can be a problem.
The biggest problem is noise from the integrated-circuit (IC) input/output (I/O) pins. Because the area covered by traces
connected to them on the PCB form a large antenna. These pins also connect to both internal and external cables. The noise
from clock switching within the IC appears as ‘‘glitches” on a static output. The glitch is caused by the common impedance
of the output pin and the clock drivers, that is, the shared pins that supply each power and ground. The synchronous nature of
most devices causes all current-switching events to occur at the same time, making a large noise spike containing RF energy.
The second most-important contributor is the power-supply system, which includes the voltage regulation and the bypassing
capacitors at both the regulator and at the microcomputer. These circuits are the source of all the RF energy in the system, as
they feed the clocked circuits inside the IC with the current required for switching.
The third noise source is the oscillator circuit, where the oscillator swings rail to rail. In addition to the fundamental frequency,
harmonics are introduced on the output side because the output buffer is digital, which squares the sine wave. Also, any noise
caused by internal operations, such as the clock buffers, appears on the output. If proper separation is maintained between the
crystal and its tank circuits from other components and traces on the PCB, and the loop areas are kept small, there should be
no problems with this noise source. But it has been shown that if ICs or passive components, such as the main VBatt series
inductor, are placed close to the crystal, harmonics of the crystal can couple and propagate.
The primary focus in this application report is on the first and second previously described noise sources. The way to deal with
the third noise source has been addressed. Also, critical information is disclosed on board zoning (floor planning) and shielding.

                         1.2 Surface-Mount Devices vs Through-Hole Components
Surface-mount devices (SMD) are better than leaded devices in dealing with RF energy because of the reduced inductances
and closer component placements available. The latter is possible due to the reduced physical dimensions of SMDs. This is
critical to two-layer board design, where maximum effectiveness from noise-control components is needed. Generally, leaded
capacitors all go self-resonant (become more inductive than capacitive) at about 80 MHz. Because noise above 80 MHz needs
to be controlled, serious questions should be asked if a design is to be executed only with through-hole components.

                                      1.3 Static Pins vs Active Pins vs Inputs
As mentioned previously, all lines have noise from the processor, to some degree. The total noise from a pin depends on how
much noise the microcomputer provides it and its function in the system. For example, an output pin has the noise from the
microcomputer’s power rails and the noise capacitively coupled from adjacent pins and the substrate. If the pin’s function is
the system clock, that too is noise. Even if the pin were static at a one or zero level, one would still have to contend with noise
from inside the chip.




                                                                                                                                   1
In the case of an I/O pin in the input mode, the capacitance of the unused output transistors transfers noise from both power
rails to the pin. The amount of noise is based on the impedance of whatever is connected to the pin. The higher the impedance,
the more noise comes out of the microcomputer. That is why unused inputs should be tied to the lowest-impedance rail: ground,
by direct short, if possible.
With respect to switching output signals, basically, only worry about signals that make an edge transition at a rate greater than
50 kHz (see Figure 1). If a pin changes its state at a rate of less than once per 100 instructions, this is acceptable because the
contribution from switching is negligible. If the pin toggles, and toggles back on the next instruction, and remains static for
100 instructions, it, too, is acceptable because it contains the same amount of energy as in the previous example.
                                                               20 µs


                                10 µs


                              1 µs




                                                     No need to Filter




                       5 µs                       5 µs                       5 µs                       5 µs




                                        100-kHz Clock Function May Need to Filter


                               Figure 1. Signals Below 50 kHz Are Not EMI Concerns

                                                      1.4 Basic Loops
Every edge transition that is sent from the microcomputer to another chip is a current pulse. The current pulse goes to the
receiving device, exits through that device’s ground pin, then returns via the ground traces, to the ground pin of the
microcomputer (see Figure 2). The pulse does not exit the ground lead of the receiving device and return to the battery, but
travels in a loop to where it originates. Loops exist everywhere. Any noise voltage and its associated current travels the path(s)
of lowest impedance back to the place where it was generated. This is a very powerful concept, because it allows you to mitigate
noise propagation by controlling the shape and impedance of the return path.
A loop can be a signal and its return path, the bypassing loop between power and ground and the active devices inside the
microcomputer, the oscillator crystal and its driver in the microcomputer, as well as the loop from the power supply or voltage
regulator to the bypassing capacitors. Other more difficult loops are actually ambient field loops. For example, the crystal itself
radiates energy that can be coupled into a wire running nearby. Then, the wire contains noise that tries to get back to the crystal
loop. That may involve a very long and convoluted path, which serves as another antenna for noise from the crystal.




2
                                         Shield




                                                                   Microcomputer




         Bypass loop: A-B-C-D-E                     Internal Radiation Loop NP, Radiates to Q, Q-R-D-C
         Signal loop: F-G-H-D-C                     Xtal loop: K-J-M-L

                                               Figure 2. Examples of Loops

1.4.1 Proportionality of Loops and Dipoles
Loops and dipoles are antennas. Their radiating efficiency increases up to 1/4 wavelength (λ) of the frequency of interest.
Geometrically, that means, in the case of a loop, that the larger the laid-out area of the loop, the stronger the radiation until one
or both legs of the loop reach 1/4 wavelength. In the dipole, the longer the antenna, the more radiation, until the length of the
antenna reaches 1/4 wavelength. At 1 MHz, 1/4 λ = 75 m. At 300 MHz, 1/4 λ = 25 cm, or about 10 inches.

                                          1.5 Differential vs Common Mode
Differential-mode noise is the noise of a signal as it travels down its trace to the receiving device, then back along the return
path (see Figure 3). There is a differential voltage between the two wires. This is the type of noise that every signal must make
in order to do its job. Make sure there is no more noise than needed to get the job done, in terms of both frequency content (rise
and fall times) and the magnitude of the current. In common mode, a voltage travels down both the signal and return lines at
the same time. There is no differential between the signal and its return. The voltage is caused by an impedance that is common
to both the signal and the return. Common impedance noise is the most common source of noise in most microcomputer-based
systems that are not using external memories.




                                                                                                                                   3
                                                   Signal
                                   Signal
                                                                                                           Load
                                   Source
                                                   Return



                     Differential-mode noise is the ‘‘noise” voltage when a signal travels to its lead and returns. An
                     output switching is an example of differential-mode noise.




                                                                Signal
                            Signal                Signal
                                                                                                           Load
                            Source                Source
                                                                Return


                                                       Current from the second signal source causes a drop across this
                                                       impedance, which causes a voltage on both signal and return.



                     Common-mode noise is the noise voltage that travels down both the signal and return
                     caused by a voltage drop across a shared impedance. Ground bounce on outputs is an
                     example of common-mode noise.

                               Figure 3. Differential-Mode vs Common-Mode Noise

                                                        2 Board Layout

                                                  2.1 Grounds and Power
The only non-dc current that should flow in the power routing of the PCB is the current required to replenish the bypassing
capacitor. High-frequency current used inside the microcomputer that is switched on the input clock edges should come from
the bypassing capacitors, not from the power supply.

2.1.1 Inductance
Inductance increases with increasing length, and decreases (at a slower rate) with increasing width of the conductor. In power
routing, the inductance makes voltage drops that radiate and propagate.
Because it is not desirable for any trace to radiate RF energy, any trace carrying RF energy should be as low an inductance as
possible:
      • On a two-layer board, for both power and ground, the length-to-width ratio should not exceed 3:1 for any traces
          between the IC and the voltage source.
      • Power and ground should be run directly over each other, which reduces impedance and minimizes loop area.
2.1.2 Two-Layer vs Four-Layer Boards
A two-layer board can achieve 95% of the effectiveness of a four-layer board by emulating what makes a four-layer board
better:
      • Make an extra effort to route ground underneath power.
      • Grid power and ground, but be careful not to create unneeded common impedance connections or to violate an
         intended isolation, such as between high-power and digital grounds. See section 2.2.3, Gridding to Create Planes.
      • Route returns for direct connections to the processor I/Os directly under the signal trace. Gridding is a
         space-effective way of doing this. See section 2.2.3, Gridding to Create Planes.
      • Under the microcomputer, build a solid plane for ground that bypassing components and the oscillator loop can be
         tied to. Tie this ground to the ground pin and the power-supply bypass capacitor. This is called a microcomputer
         ground, which is discussed in section 2.1.3.




4
2.1.3 Microcomputer Grounds in One- and Two-Layer Designs
A microcomputer ground is a ground area on the bottom layer underneath the microcomputer that becomes a ground island
for the noise made by the microcomputer. This area should extend about 1/4 inch outside the outline of the device and tie to
the microprocessor ground. Ground connections for the power-supply bypassing capacitors and any bypassing capacitors on
the pins also should tie to this ground. Additionally, the ground area should extend out and around the through holes for the
oscillator leads, and the bypass capacitors tied in to provide the smallest possible loop area when viewed from the top. See
Figure 4 for an example.




                                                                              Ferrite             VCC Bypass
                             ECP88                                            Bead                 Capacitors




                                                                      OSC
                                                                    Capacitors




                         Top Side                                                       Bottom Side

                                           Figure 4. Microcomputer Ground
The topside traces are shown in dotted line form on the bottom side diagram for alignment purposes. Notice how the oscillator
capacitors lay back over the traces between the device and the crystal. This eliminates loop area. The same is true for the
placement of the ferrite bead and Vcc bypass capacitor, being centrally located with the main power lead running almost directly
under the lead finger for the ground.

2.1.4 Signal Return Grounds
As mentioned previously in section 1.4, a loop is made by a signal, and the ground return path from the receiver device back
to the signal source. Signal return paths present the most difficult design problem in PCB layout.
It would be difficult to route a ground return underneath each trace connected to a signal pin on the microcomputer. But, this
is exactly what the ground plane of a four-layer board does. No matter where the traces run, there is always a ground return
path running underneath it.
The closest approximation to having a ground plane in a two-layer board comes from gridding the ground, as described in
section 2.2.3. As stated previously, radiation from the signal traces is the primary concern. Reducing the loop area by routing
the return for the signal underneath the signal trace is most effective way of dealing with this problem. Therefore, creating a
ground grid is the most important thing to do (after floor planning) in laying out the PCB.

2.1.5 Analog vs Digital vs High Power
Digital ground and power carry the RF energy that needs to be contained, so it is best to isolate it from any other power and
ground, either analog, high power, or other unrelated trace. If noise from the microcomputer or any other circuit gets on an
isolated ground, it can be returned by careful placement of a small RF capacitor in the 470 – 1000 pF range. Choosing the
location of the capacitor is by trial and error, and is best done in the screen room.



                                                                                                                              5
2.1.6 Analog Power-Supply Pins and Analog Reference Voltages
The reference voltage of an analog-to-digital (A/D) converter integrated into a microcomputer does supply a very small amount
of clocked current; however, it is not enough to be concerned about from a noise-emissions standpoint. Most applications have
the analog Vss/Vcc tied to the digital Vss1/Vcc1 pins, which does not change significantly the noise characteristics of the A/D
nor the radiated emissions, provided the power distribution is built to guidelines in sections 2.1.1 through 2.1.4.

2.1.7 Power Plane Do’s and Don’ts for Four-Layer Boards
The reasons for reduced noise from four-layer boards were mentioned in section 2.1.2. The following guidelines should
maintain the advantages gained in the four-layer board.
     • Pay utmost attention to how the holes and cutouts in the planes are done. They break up the plane and, therefore,
          cause increases in loop areas (see A and B in Figure 5).
     • Avoid buried traces in the ground plane. If you have to use them, put them in the +V plane.
     • When making through holes for 100-mil-center-spacing leads in the plane, place a small trace between each pin.
          Breaking up the plane with a row of holes is much better than having a long slot (see C and D in Figure 5).
     • When splitting up the ground plane to make, for example, a digital and power ground, make sure that the signals
          connected to the microcomputer are still located entirely over the digital ground. Extending signal traces beyond
          the power ground hurts because the power ground does not work to reduce the loop area for digital noise signals.




                                                                 Ground Plane


                                                      B
                                                                  A

                                                                      C

                                                                      D




      A   POOR – Buried trace cuts ground plane into two parts    C   POOR – Slot formed by 100-mil spacing cuts up
                                                                      ground plane and focuses slot antenna radiation into
                                                                      that connection
      B   BETTER – Buried trace around the perimeter              D   BETTER – Ground plane extends between 100-mil
          Best solution is no trace at all in the ground plane        centers

                                                Figure 5. Layout Considerations




6
                                   2.2 Power Distribution for Two-Layer Boards
2.2.1 Single-Point vs Multipoint Distribution
In a true single-point power-distribution system, each active component has its own separate power and ground, and these
traces would remain separate until they meet at a single reference point. In multipoint systems, the connections are made in
a daisy-chain fashion, so there are multiple 0-V reference points. It is clear that multipoint systems have the potential for
common impedance coupling. While implementing a single-point system may be impossible, a combination of single point
for devices generating RF and multipoint for everything else serves to reduce noise. The best scheme possible has a single point
that ties together the regulator ground, microcomputer ground, battery negative, and chassis or shield (see Figure 6).

2.2.2 Star Distribution
Star distribution is much like single point. It looks like all points reference the same fixed point, which is located centrally,
by about the same length of traces. Additionally, that same reference point may be attached, via a large single trace, to its source,
which is not centrally located. Therefore, the major differences to single point are:
      • The single reference point on a star can be a longer trace, instead of a point
      • The point where the separate traces begin is near the center of the board, and each trace goes in its own direction,
            with the resulting trace length equal to that of all the others.
      • The star is best applied to something like a system clock in a high-speed computer board. The signal originates on
            the edge connector and proceeds to the center of the board, where it then splits and goes to each place it is needed.
            Since it effectively originates at the center of the board, the delay in the signal from one area of the board to another
            is minimal. The name star sometimes is used to refer to single point, making the above clarification necessary.
   USER USER USER USER USER USER                                        USER USER USER USER USER USER




                    Source                                                                 Source
                  Single Point                                                            Multipoint


                      USER
        USER                       USER

                                                                                                              Trace Type


      USER                           USER                                                          Power              Signal



                                                                             Single Point              Best            O.K.

       USER                            USER
                                                                             Star                      O.K.            Best

                                                                             Multipoint            Worst              Worst
                  Source ‘‘Star”

                                                Figure 6. Power Distribution

2.2.3 Gridding to Create Planes
Gridding is the most critical design technique for two-layer boards. Much like a power utility grid, gridding is a network of
orthogonal connections between traces carrying ground. It effectively creates a ground plane, which provides the same noise
reduction as on four-layer boards. It serves two purposes:
      • Emulates the ground plane of a four-layer board by providing a ground return path under each of the signal traces
      • Lowers the impedance between the microcomputer and the voltage regulation



                                                                                                                                   7
Gridding is done by expanding any ground traces and using ground-fill patterns to create a network of connections to ground
across the PCB. For example, a PCB has most of the topside traces running vertically and most of the bottom traces running
horizontally (see Figure 7). This already is working against having the return run directly under signal. First, every ground trace
is expanded to fill up as much of the empty PCB space as possible. Then, all the remaining empty space is filled with ground.
Place through holes where top-side traces cross bottom-side traces. Then do the same to the ground-fill patterns. Ground-fill
patterns make a better contribution to the grid if they are tied to ground at both ends. A ground-fill-pattern geometry connected
at only one point is just a ground shield, but if connected at two or more points, it becomes a conductor, and, therefore, becomes
a contributor in the grid.
      • Grid as much as possible on a two-layer board. Look for places where small changes in the layout would allow
           another connection to be made in the grid.
      • Use as many through holes as can physically fit.
      • Lines do not have to be orthogonal, or of the same width.
                                         +V     GND                          +V    GND                        +V      GND


     Upper-layer power traces




                                                                                                               Vias




                         GND

                    +V



                                                                                                           GND
                                                                                                     +V
                                              Lower-layer power traces

                               Figure 7. Gridding Power Traces on Two-Layer Boards
An example of gridding ground only to achieve the effect of a ground plane is shown in Figure 8. Note how the changes made
in order to implement this were minor, indicating how a small effort can have a large payback.




8
                    Figure 8. Gridding of Ground Fills and Traces to Form a Ground Plane
In the example in Figure 8, A and B represent the top and bottom sides, respectively, of a simple two-layer board. The +V traces
and all interconnects have been deleted, leaving only the ground fill and ground traces, along with the vias between the front
and back. Figure 8C is a simple stick diagram of the ground routing for the board. Each stick, or leg, represents the path of the
ground conductor, as if the conductor has been shrunk down to a minimum-width trace. The top-side traces are represented
by the dashed line, and the bottom-side traces by the solid line. It is easy to see in this diagram that most traces are dead ends.
Most traces are connected at only one end. In Figure 8D, most of the single-ended traces have been removed. The result is a
sparsely connected pattern that represents how ground is routed over the entire board. Excluding points W, X, Y, and Z in
Figure 8D, there is only one path between any two points anywhere on the routing.
In Figures 8E, 8F, 8G, and 8H, the design has been modified very slightly, to achieve a gridded ground. In Figures 8E and 8F,
the addition of some traces, shown in solid black, and slightly moving some geometries, as indicated by the arrows, has created
an extensive network of interconnections that creates the desired grid. This is shown by the stick diagram of ground in
Figure 8G. Closing the gaps around the mounting holes also contributes to the network. No longer are whole traces connected
at only one end. Now, they connect at both ends, and form a more complete conductor. Figure 8H shows the density of the grid,
which contrasts to the openness of Figure 8D. Also, notice how, in Figure 8H, no traces are dropped because they connect only
at one end. Only one trace has this problem, and it is part of a geometry already connected in three other locations. This
interconnected network is the goal of gridding ground. The result is nearly as effective as an actual ground plane.

2.2.4 Bypassing and Ferrite Beads
Bypassing between the +V and ground at the microcomputer is critical because the intent is for the capacitance to supply the
current used in the device for switching. If the current is not available in the bypassing loop, because of too much inductance,
the laws of physics say that the current should come to the lowest impedance, which then is from the leads connecting to the
power supply. The distributed capacitance of the power routing becomes the source for the higher frequencies. Thus, the ferrite
bead blocks the sourcing of RF current from the power line connection, forcing the microcomputer to live off the current
available inside the ferrite bead.




                                                                                                                                 9
It is of the utmost importance to realize, and always keep in mind, that the power-routing purpose is only to replenish the charge
in the bypassing capacitor, and that the bypassing capacitor should supply all currents at or above the oscillator frequency.
Keeping RF off the power distribution traces is accomplished using these measures (see Figure 9):
        • Use a ferrite bead and a bypassing capacitor (0.1 µF or 0.01 µF), placing the capacitors inside the ferrite bead. Place
             a 1000-pF capacitor outside the ferrite bead, creating a PI filter. The ground connection for this capacitor should
             be the microground. However, if there is a lot of noise on this point, the capacitor could couple that noise back onto
             the +V line.
        • The ferrite bead is used only on +V, not on ground. If a through-hole ferrite bead is used, it is mounted with the
             exposed lead connected to +V.
        • Apply the 3:1 length-to-width rule for traces in the bypassing loop, to minimize impedance in this high-frequency
             path.
        • Make the bypassing loops as small as possible in area and length. When tying the bypass capacitors for the oscillator
             or +V supply, try to extend the microcomputer ground rather than running a trace. Try to run any trace back over
             (or under) any other segment of the loop to reduce the radiating area when viewed from the top of the board.
        • It is acceptable and beneficial to use ferrite beads and the same bypassing values on four-layer boards. The 1000-pF
             capacitor may not be needed on four-layer boards, but it should be drawn in the initial design, and deleted later if
             screen-room testing shows that it is not needed.


                                                                                     Noisy side radiates




                                         Quiet Side                   Noisy Side



                                                      Quiet side does not radiate.




                                             Quiet Side                   Noisy Side

                          Figure 9. Ferrite-Bead Placement Closest to the Noise Source




10
2.2.5 Keeping Noise Close to the Chip
The following applies to pins that are used for simple digital I/O, not for pins used in the memory-expansion bus. The goal
here is not so much to reduce the noise of the edge switching, but to mute the noise of the clock glitches when the pin is static.
Noise on the pins is coupled internal to the device through many paths that can change as the pin function changes. For example,
the input pin in a keyboard scan has capacitively coupled noise from both the substrate and the power rails. Also, because it
is high impedance, any ambient fields couple efficiently. When the key is pushed, the pin has a new set of noise sources because
the signal line’s impedance has changed. Thus, it is difficult to effectively develop a matrix of all possibilities; therefore, the
following is recommended:
       • Put a 50 –100-Ω resistor in series with every output pin, and 35 – 50-Ω resistor on every input pin. If the system
           design calls for higher series resistance, use that value. Higher resistances are better for outputs, but usually do not
           improve characteristics of inputs. Place the resistor as close as possible to the microcomputer, overlapping the
           microcomputer ground if possible.
       • Bypass any pin on the microcomputer to ground using a 1000-pF capacitor, provided the edge rate needed for the
           signal line is not faster than 100 ns. On outputs and pins that the system uses for both input and output, ground for
           the capacitor should be the microcomputer ground. The other end of the capacitor should be tied to the receiver side,
           not the microcomputer side, of the series resistor. Placing the capacitor inside the resistor makes the load seen by
           the microcomputer look like a short when it switches, which is not desirable. If adding the capacitor has to be traded
           off against placing the series resistor, because of space limitations, place only the resistor.
       • On pins used for input only, place the capacitor inside, on the microcomputer side, of the resistor to reduce the loop
           area. Then, high frequencies originating in the microcomputer on the pin see less impedance to ground through the
           capacitor than through the resistor.
       • Resets and interrupts are special functions, thus care must be taken not to reduce functionality.
       • Do not apply any of the above remedies to oscillator pins. If proper spacing between the oscillator components and
           other unrelated components and traces is maintained, there should not be a need for oscillator signal conditioning.
       • Unused pins should be configured as inputs and tied directly to the microcomputer ground. It is recommended that
           the watchdog be enabled to correct the unlikely event in which a device is disturbed, loses its program counter, and
           executes code to make the input become an output with a high level.
These rules take up space and add components, and so are not well accepted in production. The goal is to implement all rules
on all I/O pins, but if that is not possible, then rank order the candidates least likely to cause noise and remove the application
of these rules one pin at a time.
Filtering priorities from most needed to least needed are:
       • Signals leaving the enclosure (see section 3.3, Cables and Bypassing to the Shield)
       • Signals leaving the PCB to other boards inside the enclosure
       • Signals staying on the PCB with high-impedance loads (i.e., driving another MOS input or open circuit)
       • Pins of parallel I/O port designed to support high-speed data transfer, e.g., between the microcomputer and an
           external memory, need filtering over the remaining I/O pins, because of their faster rise and fall times.
When the design is complete and first prototypes are built, an hour or two in the screen room removing each of the filtering
components one at a time, identifies which are or are not needed to get the desired EMI level.




                                                                                                                                11
                                                       2.3 Board Zoning
Board zoning has the same basic meaning as board floor planning, which is the process of defining the general location of
components on the blank PCB before drawing in any traces. Board zoning goes a little bit further in that it includes the process
of placing like functions on a board in the same general area, as opposed to mixing them together (see Figure 10). High-speed
logic, including micros, are placed close to the power supply, with slower components located farther away, and analog
components even farther still. With this arrangement, the high-speed logic has less chance to pollute other signal traces. It is
especially important that oscillator tank loops be located away from analog circuits, low-speed signals, and connectors. This
applies both to the board, and the space inside the box containing the board. Do not design in cable assemblies that fold over
the oscillator or the microcomputer after final assembly, because they can pick up noise and carry it elsewhere.
In prioritizing component placement, the most important things to do in PCB design are:
      • Locate the microcomputer next to the voltage regulator, and the voltage regulator next to where VBatt enters the
            board.
      • Built a gridded or solid ground between the three (forming a single-point ground), and tie the shield at that point.
                           CHASSIS HARNESS




                                                                                                     ANALOG




       V
                                  Microcomputer
                                                           XTAL




       R
       E
       G




     Chassis harness, microcomputer regulator are all in the same area. Wide
     ground fields interconnect all three, forming single-point ground reference.




                                                                                                Front Panel

                                                   Figure 10. Board Zoning




12
                                                   2.4 Signal Traces
2.4.1 Capacitive and Inductive Crosstalk
Capacitive and inductive crosstalk occur between traces that run parallel for even a short distance. In capacitive coupling, a
rising edge on the source causes a rising edge on the victim. In inductive coupling, the voltage change on the victim is in the
opposite direction as the changing edge on the source. Most instances of crosstalk are capacitive. The amount of noise on the
victim is proportional to the parallel distance, the frequency, the amplitude of the voltage swing on the source, and the
impedance of the victim, and inversely proportional to the separation distance. Measures that reduce crosstalk are:
       • Keeping RF-noise-carrying traces that are connected to the microcomputer away from other signals so they do not
           pick up noise.
       • Signals that may become victims of noise should have their return ground run underneath them, which serves to
           reduce their impedance, thus reducing the noise voltage and any radiating area.
       • Never run noisy traces on the outside edge of the board.
       • If possible, group a number of noisy traces together surrounded by ground traces.
       • Keep non-noisy traces away from areas on the board were they could pick up noise, such as connectors, oscillator
           circuits, relays, and relay drivers.
Most EMI-related crosstalk problems center around the crystal, when the victim is located too close. No unrelated components
should be closer than 1 inch to the crystal.

2.4.2 Antenna Factor Length Rules
Normally, for Federal Communication Commission (FCC) limits, trace length becomes important when it is greater than 1/10
of the wavelength. For military standard limits, that number becomes 1/20 to 1/30 of the wavelength. For automotive and
consumer two-layer boards, 1/50 of the wavelength begins to be critical, particularly in unshielded applications. That says
traces longer than 4 inches can be a problem for FM-band noise. In these cases, some form of termination is recommended
to prevent ringing.

2.4.3 Series Termination, Transmission Lines
The main purpose of termination is to provide critical damping to achieve the highest possible data transmission rates with the
least-possible overshoot. When applied to most microcontroller systems, however, the focus changes to taking out as much
total differential-mode noise as possible while allowing system functionality. Below is a table of different methods of
termination and the main characteristics of each method.
                                         Table 1. Termination Characteristics
                                       Parallel        Thevenin         Series            AC            Active
   Power dissipation                     high            high             low           medium          medium
   Number of components                   1                2               1               2               1
   Adds delay                             no              no              yes             no              no

Note that CMOS is an under-damped technology, which means that you always have to be on guard for ringing and overshoot.
Use some form of termination if any of the following conditions are present:
      • A signal trace is more than 1 foot long.
      • A signal goes to a cable that leaves the shielded enclosure.
      • Any ringing is present.
Series resistance is an inexpensive solution to termination and ringing problems, and is the preferred method for
microcomputer-based systems where minimizing the differential-mode noise is also a concern.




                                                                                                                            13
2.4.4 Impedance Matching at Inputs
The input to a CMOS device looks like a series inductance of about 5 – 40 nH, which leads to about 5 pF in parallel, with about
5 MΩ to the grounded substrate (see Figure 11). This is a very high impedance, and can lead to lots of ringing and other noise
if the device driving the input is not matched in some fashion to the higher impedance. This is the complement of the situation
of section 2.4.3, where attention is paid to the microcomputer’s output because of the under-damped nature of the load it drives.
Here, the microcomputer is the under-damped load, and ringing and overshoot are real possibilities. More than likely, some
form of termination will be required, and again, the series resistance is the most likely solution. Resistance placed at the driver
increases the output impedance, as seen by the trace and the input pin, thus matching the high impedance of the input.
If the input is connected to an open trace, such as the open line to a switch, a pullup or pulldown resistor is recommended. While
this increases the amount of current switched when the input is activated, it reduces the impedance at all other times. This
reduces the trace’s chances of being a victim of coupled noise.
                                                                                                      Vdd


                                                                                                      >1 MΩ
        Device Pin              5 – 40 nH                      2 – 20 Ω               1 – 5 pF                  Signal
        Connects
                                                                                                               Goes into
        to PCB
                                                                                                                Device
                                                                                                     >1 MΩ

                                       1 – 2 pF                                      1 – 5 pF




                                  Lead Finger               Input and
                                 and Bond Wire              Bond Wire                Input Gate


                                     Figure 11. MOS Buffer Simplified Schematic

                                              2.5 Cables and Connectors
A well-designed two-layer board, and most four-layer boards, have minimal radiation. The problem at the system level is the
radiation due to cables interconnecting the PCB with any off-board support function, other processor, or display and keypad
PCBs. Because usually there is only one ground wire between boards, that one inductive wire has to return all of the RF energy
carried onto the second PCB by the other wires. If there is any impedance in the single ground wire, a portion of the RF energy
does not return to the microcomputer’s PCB via the ground wire, but rather through a radiated path. The energy radiates off
the second board and couple back to the first, but, during the process, that radiation also can add noise in other locations in
the system, as well as become direct radiation measured in the screen room. The key corrective action is to ensure the conducted
path for the return has a very low RF impedance.

2.5.1 Differential-Mode and Common-Mode Noise
Common-mode noise is a big problem in cables, but the fault does not lie in the cable, it lies in the connections on the board
that the signals and returns tie to that form the common impedance. Common-mode noise is corrected either at the source, by
reducing the impedance of the common node, or reduced by placing a ferrite bead around the entire cable.
Differential-mode noise (the useful noise of an edge transition) should first be reduced to the maximum (slowest) allowable
rise and fall times and should occur at only the minimum needed frequency. The noise radiated is due to the loop of the signal
and its return. This loop is minimized by having as many returns as possible and by twisting each signal and return pair. The
latter causes field cancellation at some distance away, in the same manner as routing power over ground.

2.5.2 Crosstalk Model
Crosstalk in a cable is the same as in the PCB. Noise is coupled from the source onto quiet victim signals. Therefore, run
clocking or other high-speed wires twisted with their own separate return. Crosstalk is a problem in cables over 2-meters long,
and can be a problem in cables as short as 6 inches.




14
2.5.3 Number of Returns
It is common practice in the computer industry to have at least one ground for every nine other signal lines in a cable or harness.
With higher speeds, this ratio is moving toward 1:5. These higher speeds are not limited to data rates, but also to harmonic
content. Use these guidelines in designing signal and return lines:
        • The best practice is to have one ground return for each signal in the cable, as a twisted pair.
        • Never run less than one ground return for every nine signal lines, even if it is just the jumper cable to the front-panel
          display in a completely sealed metal box.
        • If the cable is over one foot long, it should have one ground return line for four signal lines.
        • When possible, there should be a solid metal bracket, used as a mechanical brace, soldered between the two boards,
          to serve as a mounting bracket and as a robust RF ground return.

2.5.4 I/O Recommendations for Off-PCB Signals
The PCB should have a large ground area tied to the enclosure shield that serves as the ground for the bypassing capacitors
on each of the wires entering or leaving the enclosure. These capacitors provide final filtering of microcomputer noise, but
also are intended to filter to the shield any noise picked up on the cable outside the box. See section 3.3, Cables and Bypassing
to the Shield.

2.5.5 Keeping Noise and Electrostatic Discharge (ESD) Out
Noise and ESD incident on the cable are intended to pass through the bypass capacitor at the cable on the PCB and out to the
shield (chassis). Therefore, the ground from the capacitor to shield should be wide (3:1) and bonded securely to the shield,
preferably by two or more screws. The bypass capacitor value should be less than 1000 pF, so the effective series resistance
(ESR) is minimum in the 50 – 500-MHz range. Lead length of axial devices would be a factor in the ESR, so surface-mount
components are preferred.

                                                2.6 Other Layout Issues
2.6.1 Front-Panel PCB with Keypad and Display in Automotive and Consumer Applications
In multi-PCB applications, a front-panel PCB, which carries the display and the keyboard, is part of the shielding enclosure.
It also can be a source of emissions. The goal here is to make the ground return for the noise of the microcomputer, and to create
an effective extension of the shield over the front of the box. This can be done by defining all lines on one side of the board
to run one way, and the other side to run at 90 degrees (see Figure 12). Then, interspersed among the signals for keyboard and
matrix, are the lines that make up two separate gridded ground planes: one that serves as the ground return and one that serves
as part of the shield. The latter should securely contact the chassis at each corner and every two inches along the edge. The
return ground plane should tie to the microcomputer’s ground plane, preferably using something heavy, like soldered-in metal
braces. This prevents the impedance between the controller and the front-panel PCB from being a major problem.




                                                                                                                                15
                              Front-Side Shield Ground
                              Front-Side Controller Ground

                              Back Shield Ground
                              Back-Side Controller Ground




                               Mounting bracket
                               solder point




                           Figure 12. Front-Panel Gridding to Form Two Ground Planes

2.6.2 Layout for Susceptibility
Susceptibility (called immunity in Europe) occurs as incident electric or magnetic fields couple onto signal traces. Because
the coupled signal is alternating current, the sine wave is superimposed on voltage already present on the trace. At the input
to a microcomputer, that voltage is rectified, and causes a dc offset voltage on the pin. When this dc voltage gets large enough
to shift the input away from the switching-point voltage, the intended switching function is no longer seen by the
microcomputer. If the input is the oscillator, the device suddenly has no clocks. If the input is reset, the device may go into reset
and stay there until the disturbing field is removed.
The physics of susceptibility are the same as for emissions, only applied in reverse. Large loop areas pick up more signal, just
as they would radiate more signal. Therefore, the things you do to keep a signal immune from radiation are the same as those
to keep it from radiating.
The most important pins for immunity are those that affect program control: the oscillator, reset, interrupts, and any input pins
used for program branching. Apply the same rules as for reducing radiation from these pins. By far, most susceptibility problems
are associated with the loop defined by the oscillator pins, the crystal, the crystal bypass capacitors, and the path between the
bypass-capacitor ground connection and the ground of the microcomputer.
Also, be careful of ground bounce (common impedance coupling) of circuits that may generate these more critical signals. If
the ground path has high impedance, it may cause the driving circuit’s reference voltage to shift, causing that input to the
microcomputer (RESET, OSC) to be outside the switching range of the microcomputer.

2.6.3 Autorouters
Autorouters for PCBs do not take any noise reduction actions; therefore, care should be taken in their use. Power and ground
routing, as well as signals that impact susceptibility, should be laid out by hand. Any signal with clocked data, such as low
address bits in a memory expansion bus, should be next. Only signals with switching rates below 50 kHz can be left safely to
the autorouter. Even then, every signal should be checked for EMI issues. Routing near the crystal, and the crystal and tank
circuit itself, should be checked. Finally, the ground traces should be gridded.




16
                                                         3 Shielding

                                                     3.1 How It Works
When an incident electric field traveling in the air hits a metal surface, the metal causes the penetrating field strength to
decrease. The metal causes the field to be replaced with conduction currents that flow in the metal close to the surface. A very
small (exponential decay) amount of the field does pass through, but for emissions, this is never a problem. The metal chassis
serves as a shield. The fields from all the radiating surfaces inside it are blocked and kept inside the box, with the only noise
coming from the cables or wires that enter or exit the box and from holes or slots made in the box.
If a metal enclosure is to be used, its shielding effect should be utilized. However, it is always better to reduce the noise inside
the box than to rely on the shielding effectiveness.

                                                3.2 Grounding the Shield
The shield has the difficult job of providing a terminating or conducting surface for direct ESD hits, ambient fields, and internal
fields, as well as noise carried on the cables entering and exiting the chassis. To do this well, the shield should be thought of
as an RF conducting plane, with the least number of breaks and impedance’s between the source of the RF currents and the
ground reference point. The ground reference point should be the single point, as mentioned earlier, that ties together the
regulator ground, the microcomputer ground, and battery negative.

                                      3.3 Cables and Bypassing to the Shield
The PCB should have a large separate ground area tied to the enclosure shield which serves as the ground for the I/O bypassing
capacitors (see Figure 13). These capacitors provide final filtering of system noise, but also are intended to filter noise picked
up on the cable outside the box. The value of the capacitor should be below 1000 pF, more likely about 470 pF. The connection
to the chassis is an RF path requiring 3:1 length to width.




                                                                                                                                 17
                                                                                                                GOOD




                                                                                           Large ground on both sides
                                                                                           reduces impedance, a good
                                                                                           starting point for the 0-V
                                                                                           reference point for the power
                                                                                           supply.
        SHIELD




                                                                                        Bottom Side
                            Top Side

                                                                                                                 BAD




                                                                                           Narrow traces increase
                                                                                           impedance, which reduces
                                                                                           filtering effectiveness.




                               Figure 13. Mounting Filter Capacitors for External I/Os

                                  3.4 Slot Antennas: Cooling Slots and Seams
Slots antennas are formed by long thin gaps in the shielding material, such as at the seams between the two pieces of the box,
and at the front-panel interface. These slots are very effective radiators. It is important that some form of contact assurance
be used, such as dimpling, or using alternating fingers, to insure contact between the two surfaces. No slot should be more than
4 inches long. Cooling slots should not be used. For emissions reasons, only small round holes should be used if ventilation
is needed.

                                                         4 Summary
The design of systems that generate low electromagnetic interference is not a mystery, but requires application of well-known
engineering techniques. The design begins with the selection of semiconductor components that produce low electromagnetic
radiation. However, in many cases, other criteria, such as the required performance of the semiconductor component, may be
in contradiction with low interference. The main task is the design of a PCB that eliminates antennas that can radiate
electromagnetic energy. Even if this can be achieved sometimes, large loops of signal and corresponding ground-return lines
that carry high frequencies must be avoided. Therefore, a careful positioning of the integrated circuits is essential to achieve
short interconnect lines.
In the next step, a close ground grid is placed over the printed circuit board. This grid ensures that return lines are close to the
signal lines, thus keeping the effective antenna area small. A ground plane in a multilayer board provides this feature. By using
this technique, low electromagnetic emission can be achieved with low design effort. However, some cost-sensitive
applications allow two-layer PCBs only. Nevertheless, in this case, careful layout provides nearly the same performance as
a multilayer board.



18
Finally, filtering of critical lines, such as the supply line, ensures that high-frequency currents do not leave the PCB.
By applying the rules presented in this report, shielding of the total system is not required. Experience and careful work by
the design engineer are much more effective than sophisticated computer-aided design tools.

                                                       5 References
      1.   Printed-Circuit-Board Layout for Improved Electromagnetic Compatibility, October 1996, Application Report,
           literature number SDYA011.
      2.   Electromagnetic Emission from Logic Circuits, November 1998, Application Report, literature number SZZA007.
      3.   Texas Instruments Internet Web Page at http://www.ti.com




                                                                                                                            19


==========================================
FILE: tutorial.pdf
==========================================

19/11/2024
THIS PAGE INTENTIONALLY LEFT BLANK
                                                  Introduction



PCB design software. It provides all the guides, step-by-step nstructions,
detailed descriptions of typical work ing principles, and all the insights and
essentials to succeed as an electronic
engineer in DipTrace. This tutorial will be a useful tool for both professionals
and beginners in the engineering field.
In the Part I, II, and III we will create a simple schematic and PCB, then
practice in creating new components and work ing with libraries in the Part IV,
and, finally, practice in using more advanced features in the Part V.
For a quick answer, please refer to the corresponding Help document ("Help \
<DipTrace module> Help" from the main menu).
Created for DipTrace version 5.1. November 2024.
                                                                                                                                             Contenido                       3




Table of Contents
                                                                                                                                                                                     0

  Part I Creating a simple schematic                                                                                                                                                5
      1 Establishing
           ...................................................................................................................................
                           schematic size and placing titles                                                                                   5
      2 Configuring
          ...................................................................................................................................
                         libraries                                                                                                            9
      3 Designing
         ...................................................................................................................................
                       schematic                                                                                                             10
      4 Converting
         ...................................................................................................................................
                         to PCB                                                                                                              26

 Part II Designing a PCB                                                                                                                                                         27
      1 Preparing
         ...................................................................................................................................
                       to route                                                                                                              27
      2 Autorouting
         ................................................................................................................................... 34
      3 Working
         ...................................................................................................................................
                     with layers                                                                                                             38
      4 Working
         ...................................................................................................................................
                     with vias                                                                                                               41
      5 Net
         ...................................................................................................................................
             classes                                                                                                                         44
      6 Manual
         ...................................................................................................................................
                   routing                                                                                                                   47
      7 Measuring
         ...................................................................................................................................
                        trace length                                                                                                         59
      8 Selecting
         ...................................................................................................................................
                      objects by type/layer                                                                                                  60
      9 Placing
          ...................................................................................................................................
                    text and graphics                                                                                                         63
     10 Copper
         ...................................................................................................................................
                   pour                                                                                                                      66
     11 Locking
         ...................................................................................................................................
                    objects                                                                                                                  75
     12 Design
         ...................................................................................................................................
                  verification                                                                                                               76
     13 Layout
         ...................................................................................................................................
                  information                                                                                                                80
     14 Panelizing
         ................................................................................................................................... 81
     15 Printing
         ................................................................................................................................... 83

 Part III Generating files for manufacturing                                                                                                                                     85
      1 DXF
         ................................................................................................................................... 85
      2 Gerber
         ...................................................................................................................................
                  RS-274X                                                                                                                    87
      3 Gerber
         ...................................................................................................................................
                  X2                                                                                                                         92
      4 N/C
          ...................................................................................................................................
              Drill file (Excellon)                                                                                                           93
      5 ODB++
         ................................................................................................................................... 94
      6 Order
         ...................................................................................................................................
                PCB                                                                                                                          95

 Part IV Creating Component Libraries                                                                                                                                            97
      1 Designing
         ...................................................................................................................................
                       a pattern library                                                                                                     97
                 Custom izing
                           ..........................................................................................................................................................
                                   Pattern Editor                                                                                                                                     98
                 Create/Save
                           ..........................................................................................................................................................
                                 library                                                                                                                                              99
                 Designing
                         ..........................................................................................................................................................
                              a resistor (pattern)                                                                                                                                  100
                     Manually
                          ......................................................................................................................................................... 100
                     Attaching
                          .........................................................................................................................................................
                                   a 3D model                                                                                                                                       108
                     Automatically
                          .........................................................................................................................................................
                                         (Pattern Generator)                                                                                                                        109
                 Designing
                         ..........................................................................................................................................................
                              BGA-144/13x13                                                                                                                                         112
                     Manually
                          ......................................................................................................................................................... 112
4      DipTrace Tutorial


                    Designing
                         .........................................................................................................................................................
                                  BGA Automatically                                                                                                                                118
                Designing
                        ..........................................................................................................................................................
                             SOIC-28 pattern                                                                                                                                       121
     2 Designing
       ...................................................................................................................................
                       a component library                                                                                                 124
                Custom izing
                         ..........................................................................................................................................................
                                  Com ponent Editor                                                                                                                                 124
                Designing..........................................................................................................................................................
                             a resistor (com ponent)                                                                                                                                126
                Designing..........................................................................................................................................................
                             a capacitor                                                                                                                                            128
                Designing..........................................................................................................................................................
                             VCC and GND sym bols                                                                                                                                   134
                Designing..........................................................................................................................................................
                             a m ulti-part com ponent                                                                                                                               137
                Using additional
                         ..........................................................................................................................................................
                                        fields                                                                                                                                      145
                Designing..........................................................................................................................................................
                             PIC18F24K20                                                                                                                                            147
                SPICE settings
                         .......................................................................................................................................................... 154
                Library verification
                         .......................................................................................................................................................... 155
                Placing parts
                         .......................................................................................................................................................... 157

Part V Other features and tools                                                                                                                                             161
     1 Connecting
       ................................................................................................................................... 161
                Buses and..........................................................................................................................................................
                              bus connectors                                                                                                                                        161
                Net ports.......................................................................................................................................................... 167
                Connecting
                         ..........................................................................................................................................................
                                w ithout w ires                                                                                                                                     168
                Connection
                         ..........................................................................................................................................................
                                Manager in Schem atic and PCB Layout                                                                                                                172
     2 Looking
       ...................................................................................................................................
                    up components                                                                                                          173
     3 Reference
       ...................................................................................................................................
                       Designators                                                                                                         176
     4 Placement
       ...................................................................................................................................
                        and autorouting                                                                                                    179
     5 Layer
       ...................................................................................................................................
                stack                                                                                                                      189
     6 High-speed
       ...................................................................................................................................
                         nets and differential signals                                                                                     194
                Length m..........................................................................................................................................................
                           atching                                                                                                                                                 194
                Signal delay
                        .......................................................................................................................................................... 199
                Create a..........................................................................................................................................................
                         differential pair                                                                                                                                         200
                Differential
                        ..........................................................................................................................................................
                              pair routing/editing                                                                                                                                 203
                Phase tuning
                        ..........................................................................................................................................................
                                  a differential pair                                                                                                                              208
                Differential
                        ..........................................................................................................................................................
                              Pair Manager                                                                                                                                         212
                Define paired
                        ..........................................................................................................................................................
                                  pads                                                                                                                                             213
     7 Renew
       ...................................................................................................................................
                  layout by schematic                                                                                                      215
     8 Back
       ...................................................................................................................................
               annotate                                                                                                                    216
     9 Hierarchical
       ...................................................................................................................................
                          schematic                                                                                                        218
    10 NGSPICE
       ...................................................................................................................................
                      simulation                                                                                                           228
    11 Saving/loading
       ...................................................................................................................................
                               design rules                                                                                                234
    12 Electrical
       ...................................................................................................................................
                      Rule Check                                                                                                           235
    13 Checking
       ...................................................................................................................................
                      net connectivity                                                                                                     237
    14 Fanout
       ................................................................................................................................... 239
    15 Via
       ...................................................................................................................................
            Shielding                                                                                                                      243
    16 Via
       ...................................................................................................................................
            Stitching                                                                                                                      244
    17 Bill
       ...................................................................................................................................
            of Materials (BOM)                                                                                                             247
    18 Importing/exporting
        ...................................................................................................................................
                                        netlists                                                                                            251
    19 3D
        ...................................................................................................................................
            preview and export                                                                                                              253
    20 DipTrace
       ...................................................................................................................................
                     Links                                                                                                                 257
                                                            Creating a simple schematic       5



1     Creating a simple schematic
      In this part of the tutorial, you will learn how to create a simple schematic and generate a
      PCB (Printed Circuit Board) using the DipTrace software.
      Let's start from the schematic. Open DipTrace Schematic, go to "Start / All Programs /
      DipTrace / Schematic" in the Windows OS or use DipTrace Launcher on MacOS.
      Once started, you can adjust graphics mode (View/ Graphics Mode): Open GL, being the
      most universal, is set by default; you can switch to Direct 3D mode, which is faster, but
      more dependent on hardware/drivers/versions; try Windows GDI, if you are working on
      older machine.
      Black background is used by default as the most eye-friendly, but we will switch to a white
      one as it's more acceptable for printing this tutorial. To change the color scheme or define
      custom colors go to "View / Colors" main menu item. We'll select white background from
      the Template drop-down list.
      Component Editor and Pattern Editor use the color settings of Schematic Capture and
      PCB Layout respectively.
      Notice that relative sizes of program panels in the screenshots may differ from what you
      see on the screen due to resolution limitations applied in this PDF tutorial.
      Sometimes we will hide the Design Manager (which is on the right side of the screen) to
      add more design space, but if you have high-resolution screen you don't have to do this.
      Select "View / Toolbars / Design Manager" from the main menu to show/hide the Design
      Manager panel or press Ctrl+2 default hotkeys.
      Some schematic and PCB examples presented in this tutorial are designed exclusively
      as a demonstration cases of the tools being used, they are not necessarily working
      prototypes.

1.1   Establishing schematic size and placing titles
      We'll start with establishing the size of the schematic sheet and placing the drawing
      frame, go to "File/ Titles and Sheet Setup" from the main menu, and select ANSI A from
      the Sheet Template drop-down box. Then go to the bottom of the dialog and check
      Display Titles and Display Sheet items. Press OK.
6     DipTrace Tutorial




    Notice that you can show/hide titles and sheet on the design area by selecting "View /
    Display Titles" and "View / Display Sheet" from the main menu.
    Now press the Minus Sign (-) hotkey to zoom out until you can see the drawing frame.
    Plus and Minus signs (+) (-) hotkeys, the mouse wheel, and the scale box on the
    Instruments toolbar allow for zooming on the schematic. Hover over the required area for
    more precise zooming. Notice that you can hide the Design Manager panel on the right (
    Ctrl+2 hotkeys) to get more space on the design area.




                                                                           © 2024 Novarm Software
                                                        Creating a simple schematic        7




To enter text into the title field, simply hover over that field with the mouse (the field
highlights green), then left-click it to open the field properties pop-up dialog box, select or
type in the text (field content), define alignment (Left, Center or Right), and the font.
In our case type in "Astable Flip Flop" text, then press the Font button and set the font
size to 12. Then click OK to close the dialog box and apply changes.
8      DipTrace Tutorial




    You can enter multi-line text into the title block fields. This text will be saved only for the
    current project. If you need to create a custom title template with predefined texts, please
    refer to Title Block Editor (more details in Schematic Help Title Block Editor topic).




    To zoom on the title block, hover over it with the mouse, and press the Plus Sign (+) or



                                                                                © 2024 Novarm Software
                                                            Creating a simple schematic        9



      scroll the mouse wheel.

      Let's practice with different zoom options for a while. Click on the button (Zoom
      Window) and draw a rectangle on the design area where you want to zoom.

      To return to previous scale and position, use     button (Undo Scale). Press and hold
      the right mouse button to pan on the design area.
      Go to "File / Save As" from the main menu, type in the file name, and make sure that file is
      in the directory that you need. Click Save.

1.2   Configuring libraries

                         DipTrace has a single cross-module library management system.
                         Libraries are organized to standard and custom library groups with
                         multi-level search filters ensuring that correct components can be
                         found quickly. The Place Component panel has all necessary tools to
                         place components and manage libraries. To adjust the panel width,
                         right-click on it and select preferred option or just hover over the panel
                         border and drag it.

                                             Configuring library groups

                         Press                             (<Current Library Group>) there are
                         three default library groups:
                         Components (all standard libraries, sorted alphabetically by
                         component type and manufacturer);
                         User Components (add/delete libraries to/from this library group).
                         Empty by default;
                         Project Libraries (auto-generated library with all components of the
                         current circuit). It is empty if no schematic file is open.

                         Let's group all libraries that we will need for our project into a single
                         library group. Select User Components library group, then press the

                                                    and select Add Library to "User
                         Components". In the pop-up dialog box select Components library
                         group from the Add from Group list. The Components library group
                         contains all standard DipTrace component libraries. Select General
                         (non-IPC), Objects Symbols and Transistors NPN libraries, use Ctrl
                          key for multiple selection. Press OK when ready.
  10      DipTrace Tutorial




       Now the selected libraries have appeared in the User Components library group and we
       are ready to start designing the schematic.

                                    Add library from a separate file

       To add a new library to the DipTrace library system, check Add from File checkbox in
       the Add Library to <Library group> dialog box and select the file on your computer. You
       can also use the Library Setup dialog box to get access to the comprehensive library
       system settings ("User Components (<Current library group>) / Library Setup" on the
       Place Component panel).

       Notice that Library Setup panel allows for configuring both pattern and component library
       groups, though pattern libraries are invisible in the Schematic.

       More information in the DipTrace Help ("Help/ Schematic Help" from the main menu),
       Working with Libraries section.

1.3    Designing schematic
       In this section of the tutorial we will show the basic principles of working in the Schematic
       module of DipTrace PCB Design Environment.
       Please turn ON the grid (if it was turned OFF) with F11 hotkey. Change the grid size to 0.1
       inch, you can select it from the drop-down list of grids on the Instruments toolbar, or press
       the Ctrl + Plus Sign (+) hotkeys to increase, or Ctrl + Minus Sign (-) to decrease the grid
       size.
       Notice that you can add new sizes by selecting "View / Customize Grid" from the main
       menu. Precision of grid and all values used in the project can be defined in View/
       Precision dialog. Measurement units can be changed in the "View/ Units" main menu item
       or with Shift+U shortcut. We will use only default keyboard shortcuts in this tutorial. Go to
       "Tools/ HotKey Settings" to restore the defaults or change shortcuts.
       Now let's start creating the circuit. Select Transistors NPN library from the User



                                                                                 © 2024 Novarm Software
                                                     Creating a simple schematic      11



Components library group on the Place Component panel.
                             Search component in libraries
                                     Once the library is selected, scroll down the
                                     component list to find 2N2221AL transistor or use the
                                     search filters. Select "Objects/ Find Component"
                                     from the main menu or press
                                     button.
                                     In the pop-up dialog box make sure that Transistors
                                     NPN library is set as a search area, then type in
                                     "2N2221AL" into the Name field, and press Apply
                                     Filter. Now only components containing 2N2221AL
                                     appear in the component list. The filters button now
                                     shows that the filter is ON. All other components are
                                     hidden.

Close the Search Filters dialog box.
Notice that you can expand the search results by entering a part of the component name
as well as filter components by RefDes, value, pattern, manufacturer, datasheet, or
additional fields, use the   and       buttons to add or delete the search filters.
                                   Placing components
Click on the transistor in the list and move your mouse pointer to the design area. Left-
click once to place one transistor. Right-click to disable the component placement mode.
12      DipTrace Tutorial



     Drag and drop component if you need to move it to another location on the design area.
     To select several objects, press and hold the Ctrl key, then left-click on each object that
     you want to add to the selection or move the mouse to the upper-left corner of the group,
     hold down the left mouse button and move cursor to the lower-right corner, then release
     the mouse button to select all objects inside the rectangle (press Ctrl key to invert
     selection). Now you can move all these objects at a time.
     Sometimes it is necessary to change the reference designator of the component. Hover
     over the component with the mouse pointer, right-click it, and select the top item (Q1)
     from the submenu. In the pop-up dialog box type in a new RefDes if needed. We will keep
     "Q1".




     We need two transistors for the schematic, select 2N2221AL in the component list again,
     and place it on the design area. If you have changed the reference designator you don’t
     need to rename the second transistor, it happens automatically. If you want to rotate the
     component before placing it on the design area, press Space or R default keyboard
     shortcuts.




     You can activate Snap to Grid option, if it's disabled (View/ Snap to Grid or Alt + F11), this
     will align the newly placed components by the grid. Grid Snap status is displayed on the
     status bar in the bottommost part of the screen.
     When the search filter is active, you can see only certain (filtered) components of the


                                                                               © 2024 Novarm Software
                                                      Creating a simple schematic        13



library. Press Filter ON button on the Place Component panel, then press Cancel Filter
in the pop-up dialog box to turn the filtering OFF. Now close the search filters dialog box.
Select General (non-IPC) library, find RES400 resistor, and place it on the design area. If
you prefer metric units, switch units with Shift+U combination or select the Units in View
submenu, however, we will keep inches as these are the most suitable units for the
current project.




                                    Copy components
We need 4 resistors for this project. You can place them manually, like Q1 and Q2
transistors, but this time we select one resistor on the design area and copy it three
times. There are two ways to copy a component:
1. Once a component is selected, go to "Edit/ Copy" from the main menu or right-click on
the component, and select Copy from the submenu (Ctrl+C hotkeys), then select "Edit/
Paste" three times, or right-click on the design area, and select Paste (Ctrl+V hotkeys)
from the submenu.
2. Copy Matrix. This option is good for bulk copying. Select resistor, then go to "Edit/ Copy
Matrix" from the main menu (or press Ctrl+M hotkeys).
14     DipTrace Tutorial




     In the Matrix dialog box set the number of columns and rows ("2" columns and "2" rows
     to get 4 resistors) and spacing (1 inch for columns and 0.4 inch for rows is good), click
     OK. Now you can see four resistors on the design area:




     Move resistors to a proper location, like in the picture below (use mouse or arrows on the
     keyboard for orthogonal moving), and rotate components 90 degrees (use Space or R
     shortcuts to rotate selected components). Another method to rotate an object is by using
     the "Edit / Rotate" main menu item or right-clicking on the object and selecting Rotate
     from the submenu.
     Notice that you can pan design with the right mouse button or the mouse wheel: move
     mouse arrow to the design area, hold down the right mouse button or the mouse wheel,
     and pan.




                                                                            © 2024 Novarm Software
                                                     Creating a simple schematic      15




                                 Components' markings
The reference designators of Q1 and Q2 transistors have inappropriate locations, we
need their RefDes to be under the component symbols. To change the RefDes location,
select both transistors, right-click on one of them, and select Properties from the
submenu. In the pop-up dialog box open Part Markings tab, and select Bottom from the
Align drop-down for RefDes.
Let's display component names for these transistors too. To do that, in Name line select
Show from Show drop-down and Corner from Align drop-down. This will show the
names of selected components. Notice that reference designators are already displayed
as primary markings. Common means using common Schematic settings for all
components (defined in View/ Component Markings).
If you want to set precise position of a marking, select Position from the Align drop-down -

Position column will become active, press         button to set X and Y coordinates and
rotation angle for the corresponding Markings.
16     DipTrace Tutorial




     Press OK.




     You can show or hide pin numbers for the entire circuit by selecting "View / Pin Numbers /


                                                                            © 2024 Novarm Software
                                                       Creating a simple schematic        17



Show" from the main menu, if they are not displayed yet. To change pin display settings
for the selected part, right-click it, and select Pin Numbers from the submenu.
However, if you're still not satisfied with location of RefDes, numbers, pin names or any
other markings, you can move them around visually with a special move tool. Select
"View/ Move Part Texts" from the main menu or press F10. For precise moving it's better
to disable Snap to Grid option (Alt +F11 hotkey). You can move and rotate part markings
like separate objects with R or "Space" shortcuts.
"View/ Part Markings" menu item allows the user to change common settings of part
markings. Common settings are applied to all schematic parts, except those with custom
properties.

Use Undo or Redo tools (              buttons) if you are not satisfied with the changes
you've made. The DipTrace saves up to 50 steps. Remember to save schematic into a
file. Select "File / Save" from the main menu or press the Save button on the Standard
toolbar. If the current schematic has never been saved, the Save As dialog box will pop
up to define the file name and location. If the file already exists, clicking the Save button or
pressing Ctrl+S hotkeys is enough. You can use the "File/ Save As" dialog box to save the
same file under a different name, for example, in order to backup it.




                                    Create connections
Connect pin 1 of R1 resistor to pin 2 (base) of transistor Q1. You need to make sure that

you are in the default mode (        button is pressed). Hover with the mouse arrow over the
bottom pin of R1 resistor, and left-click it - Place Wire mode will be activated
automatically. Then move the mouse arrow down to the base pin of the Q1 transistor, and
left-click it to connect the wire and create the connection between R1 and Q1.
Now we need to mirror the Q2 transistor, this will make schematic easier to understand.
First, return to the default mode by right-clicking on a empty spot, then right-click on the
transistor, and select "Flip/ Horizontal" from the submenu.
18     DipTrace Tutorial




     Connect R4 to pin 2 (base) of Q2, R2 to pin 3 of Q1, and R3 to pin 3 of Q2, like in the
     picture below. You can move components or wires to get straight lines, this is not
     important for electrical connectivity, but necessary to make schematic well-organized and
     easy to understand. If you don't like the automatic wire placement mode, you can turn it
     OFF on the Place Wire panel of the Design Manager to your right-hand side. Set
     Manual in the Route Mode section or just press the M hotkey. Place Wire panel is only
     visible in the wire placement mode.




                                                                           © 2024 Novarm Software
                                                     Creating a simple schematic       19




Now select CAP100RP from the General (non-IPC) library and place it twice to the design.




Flip C2 capacitor, select "Flip/ Horizontal" from the right-click submenu. C2 capacitor's
20      DipTrace Tutorial



     positive pin should be facing right.
     We need to place two capacitors between the transistors Q1 and Q2 with respect to their
     polarities.
     You might need to move some components to give enough space for the capacitors and
     connections.
     Move resistors a bit upwards, and select Q2, R3, R4 and related wires in order to move
     them to the right a little bit. Draw a selection box around these objects by holding down the
     left mouse button.




     Right-click to deselect all, if you are in the Default mode, or double right-click if you are in
     another mode (first click to disable an active mode and the second click to deselect all).
     Connect the positive pin of the C1 to pin 2 of the Q1: left-click the C1 positive pin and left-
     click on the wire between the R1 and Q1, the small circle appears if wires are properly
     connected.
     Then connect C1 pin 2 and C2 pins like in the picture below.




                                                                                  © 2024 Novarm Software
                                                   Creating a simple schematic    21




Scroll down the components list of General (non-IPC) library on the Place Component
panel to find LED component, and place two of them onto the schematic. Then change
the reference designators to "LED1" and "LED2" (right-click on the component, and select
the first item from the submenu), rotate these parts with R hotkey or Space (pressed
three times). Probably, you'll need to move and rotate the RefDes with the Move Part
Texts tool (F10 shortcut). Then connect LEDs to transistors like in the picture below.
22     DipTrace Tutorial




     Place a battery symbol SOURCE_BATTERY2 component from the Objects Symbols,
     change its RefDes if you need, and complete the circuit by connecting the remaining pins
     (see the picture). Make sure that you see small black circles where two wires connect, if
     not, then wires are not connected.
     Notice that you can align components in rows or columns automatically respective to
     each other, just select the components that you want to align, right-click on one of them,
     select Align Objects from the submenu, and set up the alignment tool properly. However,
     it's not needed for the current schematic.




                                                                            © 2024 Novarm Software
                                                     Creating a simple schematic      23




If you want to move existing wire, hover over it with your mouse (the net should highlight
and the mouse cursor shows possible directions), then left-click on the wire and move it
while holding the left mouse button.
Notice that if you are in the Place Wire mode and you click on the existing wire, you start
creating a new wire, not editing an existing one. The Place Wire mode is enabled
automatically when you left-click on any component pin.
If some objects do not highlight when you hover over them with the mouse, right-click on
any free spot on the design area to switch to the Default mode. If you want to delete a
wire, right-click it to open the submenu, and select Delete Wire. To delete a wire
segment, select Delete Line from the same submenu. You can use the Undo to return
to the previous state of the circuit.
Now we will add resistance values "10kΩ" for all resistors on this schematic. Since "Ω" is
a Unicode character, it doesn't work in vector fonts, which are set by default in DipTrace.
We need to switch TrueType fonts for part markings in order to use the Unicode
characters. Go to "View / Part Markings". In the pop-up select True Type font. Since
TrueType characters look a bit different from Vector ones, you might need to adjust the
font size - press Font Settings button and and set 8 pt size.
Notice that there are various ways to enter special characters. We recommend to copy
symbols from the Character Map ("Start / All Programs / Accessories / System Tools /
Character Map" in Windows OS), and paste them in the DipTrace.
24     DipTrace Tutorial




     Now select all resistors, then right-click on one of them, and select Properties from the
     submenu. In the Parameters tab type "47 kΩ" into the Value field. Now open Part
     Markings tab. In Show column select Show from the drop-down for Value, click OK.




                                                                            © 2024 Novarm Software
                                                       Creating a simple schematic        25




As you remember, we took the battery component from the Objects Symbols library. All
components in this library don't have patterns, they are just symbols (pattern preview field
on the Place Component panel says "No Pattern"). But in order to proceed to the PCB
layout stage, you should attach the related pattern to this symbol. If left blank, DipTrace
will not be able to show this component on the circuit board and an error dialog box will
pop up.
Hover over the battery symbol, right-click it, and select Attached Pattern from the
submenu. In the pop-up dialog box you can see the list of all components of the current
circuit in the left part of the dialog box, make sure "B1-SOURCE_BATTERY2" is selected
(you can see the battery symbol in the preview field).
Select Patterns library group from the Pattern Libraries drop-down list on the right. This
library group contains all standard DipTrace pattern libraries separately from the symbols.
Select Batteries library from the list and find PANASONIC_BR-1225_VCN pattern in the
pattern list at the bottom-right of the dialog box (use the search filters if you want). In most
cases, DipTrace automatically assigns pin-to-pad connections according to the pad
numbers, but this is not the case with this battery symbol.
Positive pad is usually square shaped and negative is round. Click on the corresponding
row in the Pin to Pad Table, and type in related pad number in the Pad Number column
(NEG pin should refer to Pad #2, POS pin – to Pad #1).
You can visually set pin to pad connections, just left-click on the pin in the symbol preview
field, and then on the corresponding pad in the pattern preview field.
  26      DipTrace Tutorial




       Press OK when ready to close the Attach Pattern dialog box.
       Notice that some symbols in the libraries are intentionally made without attached patterns
       (for example, VCC, GND or other logical connectors, Net Ports).
       Our schematic is now ready to become a PCB. Do not forget to save the schematic,
       select "File / Save" from the main menu or click on the Save button or simply Ctrl+S.
       You can print schematic or save it in BMP or JPG file. To print in PDF, you need to install
       any of the free PDF printers widely available online, and select it in the printer selection
       dialog box.
       Select "File / Preview" from the main menu, in the pop-up dialog box customize the
       preview, and press Print All to print all schematic sheets, or press Print Current Sheet
       to print the selected sheet, press Save to create a BMP/JPG/PNG file with defined
       resolution.

1.4    Converting to PCB
       You can open DipTrace schematic files (*.dch) in PCB Layout module, but if you want to
       save your time, select "File / Convert to PCB" or press Ctrl+B hotkeys directly in the
       Schematic. In the pop-up dialog box you can use Schematic rules or load rules from any
       other PCB layout file. When you press OK, the schematic will open in the PCB Layout.
                                             In case of incorrect exit from the program or if you
                                             somehow forgot to save the project, it is possible to
                                             recover the latest schematic by selecting "File /
                                             Recover Schematic" in the Schematic or "File /
                                             Recover Board" in the PCB Layout module.


       If you want to hide the Design Manager to get more space on the design area, press
       Ctrl+2 hotkeys or uncheck "View /Toolbars / Design Manager" main menu item.




                                                                                © 2024 Novarm Software
                                                                         Designing a PCB       27



2     Designing a PCB

2.1   Preparing to route
      The routing itself is one of the final stages of board design, but its quality greatly depends
      on the preparation.

      Right after converting to the PCB, the circuit looks chaotic. Press   button on the
      Placement toolbar or select "Placement / Arrange Components" from the main menu, all
      components will be placed near the design center (blue line cross) and arranged
      according to the placement settings.




      You can use Auto-placement or Placement by list features after converting to PCB. These
      are very convenient and useful tools which allow the user to get advantages of both
      automatic and manual placement modes. We will place components automatically in Part
      III 179 of this tutorial with more complex circuits.
                                         Component markings
      Make sure that reference designators are visible. Select "View / Component Markings"
      from the main menu. In the pop-up you can set up display parameters for reference and
      other designators of all components of the current project, except those with individual
      settings, in the Silk Screen and/ or Assembly Layers. In Show column tick the parameters
      you want to be shown; we'll select only RefDes. You can leave Auto alignment mode and
      let DipTrace select the best alignment option for markings or select another mode
      (Center, Top, Bottom, Left, Right, Corner). Uncheck Rotate Markings with Component if
      you want marking to maintain its position when a component is rotated.
28     DipTrace Tutorial




     For the PCB Layout we recommend vector font in most cases. Switch to TrueType,
     because only TrueType fonts support Unicode and non-Latin characters.
     To change the font parameters of the marking text, press Font Settings button. You can
     choose any size, but don't make it too big (we'll set 5 pt).




     To define custom component marking parameters for the selected components, right-
     click on one of them, select Properties from the submenu, then select the Markings tab
     in the pop-up dialog box. You'll be able to define, which Markings to show, how to align
     them as well as their position, rotation angle and font size for both Silk Screen and
     Assembly layers.
     Remember that you can use the move tool – F10 or "View / Move Component Texts". This
     option allows for moving and rotating (90 degree step) any text object on the board.
                                       Manual placement
     Now distribute the components manually, according to your preferences and design rules.
     It is a good practice to keep power supply components in one area and functional blocks
     in another. Apply appropriate layout rules and differential signaling for high frequency
     circuits. Notice that we use 0.05 inch (1.27 mm) grid; you can change it using a drop-
     down list on the Instruments toolbar. Select "View / Units / Inch" main menu item to
     change the measurement units or press Shift+U. You can configure precision of all the
     values used in the current project as well as set grid minimum size and precision. To do
     that, open a dialogue-box by selecting Precision item in View submenu.


                                                                           © 2024 Novarm Software
                                                                Designing a PCB       29



Create a layout similar to the one in the picture below, with resistors at the top and LEDs
at the bottom of the board. Drag and drop components to move them on the board. Press
Space or R default hotkeys to rotate selected components by 90 degrees. If you need to
rotate by a different angle, select components, then right-click on one of them, and
choose Define Angle or Free Rotate for precise and visual rotation respectively.




                                    Aligning objects
                             This project is simple and guidelines that appear while
                             moving components will help you align them, but you can
                             also use the Align Objects tool to organize components in
                             rows and columns automatically. For example, select four
                             resistors (use the box selection or the Ctrl key to select
                             multiple objects at a time), then right-click on one of them,
                             and select Align Objects from the submenu. In the pop-up
                             dialog box, set Horizontal direction, check the Distribute
                             Equally and Spacing checkboxes and enter 0.55 inch in the
                             Spacing field. The Align By section of this dialog box does
                             not matter to us because we are aligning similar footprints.
                             Press Apply.
                             Press F12 to optimize visual appearance of the connection
                             lines on the screen (this does not change the net structure).


                              Changing the net structure
We're going to practice in changing the net structure on the board, adding and removing
connections. Blue thin lines between pads show logic connections, these lines are called
"ratlines".
30      DipTrace Tutorial



     Hover over any pad with the mouse, right-click it, and select Delete from Net, the pad will
     disappear from the net. This pad is no longer connected with a blue line.




     You can create a pad-to-pad connections visually. Select "Objects / Place Ratline" from

     main menu or press         button on the objects toolbar. Then hover the mouse pointer
     over unconnected pad, left-click it, and move your mouse to any other pad (connected or
     unconnected), and left-click it. A new wire or a new net (in case if both pads were
     unconnected), represented as a thin blue line (ratline) will appear. To delete an existing
     connection, just select Delete Net from the right-click submenu on the pad.
     If you would like to add a pad to some net without creating a connection visually on the
     design area, hover over the pad with the mouse, right-click it, and select Add to Net/
     Select from List, then select net from the list of all nets of the project or select the option
     Add to Net/ Select by Mouse Pointer to point the required net with the mouse cursor on
     the design area.
     However, the most convenient way to add, delete or rename nets, as well as add or delete
     pads to/from the nets is the Connection Manager. Select "Route / Connection Manager"
     from the main menu to launch it. Connection manager is easy to use.




                                                                               © 2024 Novarm Software
                                                                  Designing a PCB       31



                               Select a net from the Net drop-down list and you will see all
                               pads of the net in the table; you can easily delete any one of
                               them. If you want to connect some pad to the net, select a
                               component and its pad, using the drop-down menus at the
                               bottom of the dialog box, and press Add button.
                               If you have changed the net structure, please press Undo
                               until previous design is restored. Close the Connection
                               Manager. By the way, if you lose design or schematic
                               because of incorrect exit from the program, use "File /
                               Recover Board" in the PCB Layout and "File / Recover
                               Schematic" in the Schematic to recover the latest project
                               version.
                               To protect the net structure from accidental change, select
                               "Route / Lock Net Structure" in the main menu.



                                       Board outline
We haven’t determined the board outline yet. If you launch the autorouter, it will create an
appropriate rectangle board automatically, but in real life electronic designer usually has
certain board requirements well before starting the project. You can create a relatively
simple board polygon directly in the DipTrace or import it from the DXF file (if its shape is
complex).

Select "Objects / Place Board Outline" or press          button on the Routing toolbar, then
place the board outline by left clicking the key points on the design area. Right-click in the
final point of the polygon, and select Enter from the submenu or press Enter on the
keyboard. For this design we require a simple rectangle board about 2.5 x 2.5 inches, see
the picture below (notice that the origin point is hidden with F1 hotkey).
If necessary, you can create arcs in the board outline by selecting Arc from the right-click
submenu while drawing the polygon. You can also select the most convenient Arc Mode
(Start-Center-Angle; Start-End-Radius; Start-End-Middle Point) to build the arc from the
submenu.
32     DipTrace Tutorial




     You can insert new points (right-click/ Insert Point) into the completed board outline
     polygon or move each point/ entire polygon on the design area. Point coordinates appear
     as a hint when the cursor hovers over it.
     Another way to draw a board outline is to place a shape or a series of shapes (lines,
     polylines, arcs) so that they form a continuous contour in the Board Cutout layer (it
     should be selected from a drop-down on the Drawing toolbar), then right-click on the
     shape and select Convert to Board Outline.
     There is one more way to create a board polygon that does not involve drawing it on the
     design area. Select "Objects / Board Points" from the main menu.
                                   In this dialog box you can Add, Insert and Delete key points.
                                   Coordinates are shown and can be edited in absolute or
                                   incremental mode.
                                   If you check the Arc checkbox for some point, that point will
                                   become a middle point of an arc and the neighboring points
                                   will become the arc's first and end points.
                                   For rectangular boards, check Create Rectangular Board
                                   box and simply define the first point (base), width and
                                   height of the board.



     It is also possible to make circular and rectangular boards with rounded corners
     automatically.
     Press OK to apply changes or Cancel to close the dialog box.
     You can use "Objects / Delete Board" from the main menu, if you want to delete the
     outline polygon.


                                                                            © 2024 Novarm Software
                                                                    Designing a PCB       33



                                         Origin point
Correct board origin is important, because it is the reference point and beginning of the
coordinates for the circuit board. Bottom-left corner of the board outline is the best place.
If you strictly followed the instructions given before in this tutorial, then you should see two
blue lines crossing exactly there. However, in the case you do not see the origin point or it
is not in the bottom-left corner of the board, select "View / Origin" from the main menu or
press F1 hotkey to show it. If the position is wrong, go to "View / Define Origin / By Mouse

Pointer" from the main menu or press        button on the Instruments toolbar, and left-
click on the design area (DipTrace helps to target on the key points).




Now all coordinates in the PCB Layout will be displayed and edited relatively to the origin
but you can change the origin's position at any moment.
Notice that coordinates of components on the board are calculated by pattern's origin
point. It is defined in the Pattern Editor. To show or hide an origin of the selected
component/s or to change its display mode, right-click on one of them, and select
Pattern Origin from the submenu.
                                        Board cutout
DipTrace allows the designer to create board cutout polygons. You can create a cutout of
any shape but in our case, we will make a simple rectangle cutout between LEDs and
transistors just to show you how to do this.
                                      Select Board Cutout layer in the drop-down list on
                                      the drawing toolbar, then choose the rectangle
                                      drawing tool, and draw a rectangle cutout on the
                                      board on the design area. Pan, zoom and change the
                                      grid size for precise drawing. Board cutout is now
                                      ready.
  34      DipTrace Tutorial




       There is another way to create cutouts. Just draw a shape on any layer of the board or
       import it from the DXF file, then right-click on the shape, and select Properties from the
       submenu. In the pop-up dialog box, select Board Cutout from the Type drop-down list,
       and press OK.
       Notice that board cutout does not visually differ from the board outline, you should be
       careful not to place a cutout instead of an outline.
                                            Route Keepout
       Route keepout is an area on the board not intended for any copper. Autorouter does not
       draw traces there, and the program will report errors, if you draw them manually in the
       keepout area. Board cutout shape does not have a clearance parameter like the board
       outline.
                                         The route keepout around the board cutout will do the
                                         job. This allows for the clearance between the copper
                                         and the cutout. Since we plan to have copper traces only
                                         on the bottom layer, switch to Bottom layer with 2
                                         hotkey, then select Route Keepout layer in the drop-
                                         down list on the Drawing toolbar, and select the
                                         Rectangle tool. Draw a rectangle which is a bit bigger
                                         than the cutout, like in the picture on the left. Change the
                                         grid size to 0.025 in for comfortable drawing. Then
                                         switch back to the top layer (press 1 hotkey).


2.2    Autorouting
       Now it is time to route the printed circuit board. DipTrace has a high-quality shape-based
       autorouter and the Grid Router suitable for simple PCBs and single-layer boards with
       jumper wires. Our project can be routed on a single layer (usually it is the bottom one).


                                                                                © 2024 Novarm Software
                                                                  Designing a PCB      35



Single-layer boards usually have longer traces, but give many other benefits for
prototyping. Longer traces do not affect the project this simple.
Select "Route / Current Autorouter" from the main menu, and choose Shape Router, it's
the best option for complex and simple designs (unless you need jumper wires). Go to
"Route / Autorouter Setup" from the main menu to set up the autorouter.
Notice that autorouter settings depend on selected router (different panels for different
autorouters).
In the Shape Router Setup dialog box (which is selected now) go to the Settings tab,
check Use Priority Layer Directions box, select Top in the list of layers, and set Off in
the Direction: drop-down list below. This means that autorouter will not create any
traces on the Top layer. Press OK to apply changes.




If you want to route a board with jumper wires you need to select the Grid Router, and
check Allow Jumper Wires box in the Autorouter Setup dialog box. In our case, we don
't need that.
Select "Route / Route Setup" from the main menu. In the pop-up dialog box, you can
change the trace width and clearance between traces for default net class and the
diameter of vias for default via style. Route Setup dialog box is the quickest way to
change these parameters, but more complex projects would require using several net
classes and via styles. You can press All Classes... and All Styles... buttons to access
the respective dialogs. We will discuss Net Classes 44 and Via Styles 41 later in this
tutorial.
36      DipTrace Tutorial




     If you are new to DipTrace, we strongly recommend you to use the settings like in the
     picture above for this tutorial project, it will help to avoid any misunderstandings and errors
     later. Press OK to close this dialog box and apply changes, then set the grid size back to
     0.05 inch.
     Now it's time to route the circuit board. Select "Route / Run Autorouter" from the main
     menu. You'll get something like in the picture below. Your layout doesn't have to be exactly
     like the one shown, so don't be confused if you are new to PCB design and some traces
     don't coincide with the picture.
     Notice that the color of the traces depends on the layer color. We will change it in the next
     topic of this tutorial.




                                                                                © 2024 Novarm Software
                                                                 Designing a PCB       37




                                     Automatic DRC
DipTrace has several verification options on different levels of PCB design. For example,
Design Rule Check (DRC). It verifies object sizes, length/phase parameters of high-
speed nets, and clearances between different objects according to user-defined rules.
The DRC results are shown in the error-report list. Violations are marked with red and
magenta circles directly on the design area. Design Rule Check in DipTrace operates in
regular (offline) and Real-Time modes. If Real-Time DRC is active, you've probably
noticed some red circles while moving components and creating traces. But it should be
OFF by default, therefore we will discuss verification procedures later.
Regular or Offline DRC (Design Rule Check) runs automatically after autorouting. This
project is very simple and you shouldn't get any errors, if there are some, make
corrections and relaunch the DRC by selecting "Verification / Check Design Rules" from

the main menu or press          button on the instruments toolbar. To change design rules,
select "Verification / Design Rules" from the main menu. To hide error circles on the
design area, select "Verification / Hide Errors". To disable automatic DRC after
autorouting, uncheck the corresponding checkbox in the "Route / Current Autorouter"
main menu item.
Select "File / Save" from the main menu, in the pop-up dialog box define the folder, type in
the name of the file and press Save.
Notice that now you can skip all topics till the Printing 83 , because your PCB is actually
ready for output, but if you want to learn some basic useful features of the DipTrace PCB
Layout, we don't recommend to skip those.
  38      DipTrace Tutorial



2.3    Working with layers
       The traces are in lower contrast, because they are on the Bottom layer of the board, while
       the Top layer is active. We can see those traces because the Contrast layer display
       mode and 50% opacity between the layers are default settings.
                                                 Look at the Layers tab on the Design Manager
                                                 (press Ctrl+2 hotkeys if the Design Manager panel
                                                 is hidden).
                                                 First of all, you can organize the layers to your
                                                 convenience here by selecting the priority layers
                                                 and arranging their order in the list. Press
                                                 button and tick the layers you want to be displayed
                                                 in the Priority column. Use arrow buttons in the
                                                 Order column to move the layers up and down
                                                 the list. We are going to leave all the Layers
                                                 displayed.



       If you want to switch to another layer, double click it in the list or press the corresponding
       hotkey, or you can also use T and B keys for top and bottom layers respectively. Active
       layer can also be changed in the list box near the DRC control buttons.
       We double click the Bottom layer in the list to activate it. Make sure you click on the layer
       name (text) in the list, not on the blue check mark or elsewhere. Click on the colored
       rectangle right next to the Bottom layer and select a color in the pop-up dialog box. Press
       OK to set the bottom layer color. You can change colors of other layers, if you like.




       All layers are divided into two basic types: Signal layers and Non-Signal layers. DipTrace
       user can easily add, delete, and edit both. Our project is a simple circuit board with two


                                                                                  © 2024 Novarm Software
                                                                  Designing a PCB          39



signal layers: Top and Bottom. But as you can see in the list, there are much more of
them. Assembly, Silk, Paste, Mask, etc. are non-signal layers. DipTrace creates them
automatically on both sides of the board (and gives corresponding names to each of them
depending on their side of the circuit board - Top Silk, Bottom Paste etc.). Each layer
carries a special type of information.
Top/Bottom Silk are silkscreen layers, all texts and graphical information are automatically
added there. Top/Bottom Mask and Paste layers contain information about solder mask
and solder paste application zones. Some non-signal layers are necessary for correct
board manufacturing, others provide additional functionality, for example, when drilling
PCBs at home. More information about each layer in the Gerber Output 87 topic of this
tutorial.
                                       Signal layers
Traces and copper pours can be created only on signal layers. There are two types of
signal layers: Signal and Plane. Signal layers usually contain traces and sometimes
copper pours, while Plane layers are inner (inside the board), they contain one or several
copper pours. Autorouter can create traces only on signal layers.
                               If you want to add, edit, create or delete a layer, go to

                               "Route / Layer Setup" or press        button on the Layers
                               tab on the Design Manager. In the Signal / Plane tab of
                               the pop-up dialog box, you can specify the name, type,
                               color etc. of each signal or plane layer. Notice that you can't
                               change some parameters for certain layers.

We will add a new plane layer called "Tutorial Layer" just to show you how it works. Press
Add button in the Layers dialog box, then enter the layer name, select type and color.
Press OK to create a new layer, now it appears in the list. Plane layers can be connected
to one of the nets, usually Ground or Power, in our case it is unconnected. You can also
define a single size for all pad rings on the layer. All pads on inner layers are always round
.
40      DipTrace Tutorial




     Press the Close button to close the Layers dialog box, as you can see the Tutorial Layer
     is already on the layers panel, between Top and Bottom layers.
     Right-click on any layer in the list to open a submenu for quick editing of the list and
     layers. Click on the color rectangle to quickly change the color of the corresponding layer.




     Insert Another plane layer and Call it Tutorial Layer 2.




                                                                              © 2024 Novarm Software
                                                                         Designing a PCB       41



                                           Non-Signal layers
                                             Customizable non-signal layers are used for various
                                             engineering purposes. They improve speed and total
                                             convenience of electronic design in DipTrace. If you
                                             need to create a non-signal layer, select the Non-
                                             Signal tab in the Layers dialog box ("Route / Layer
                                             Setup" from the main menu), then press the Add
                                             button, enter layer name, select color and layer side:
                                             None, Top or Bottom. None means that layer will not
                                             be locked to some specific side of the board.
                                             We do not need any custom non-signal layers.
                                             Close this dialog box.
                                             There are some quick-access buttons on the
                                             Layers tab of the Design Manager:




                – Add Layer;

               – Layer Setup;

                           – layer display mode;

              – contrast level setup.
      Remember to use 1,2,3, ... hotkeys to quickly change an active signal/ plane layer.
      Notice that in DipTrace you see the bottom layer of the circuit board like if it was
      transparent. Pick "View / Mirror" from the main menu to mirror entire circuit board. Now
      you see how the bottom layer actually looks like. However, this is not necessary, because
      Gerber Export automatically creates the correct copper layout on the bottom layer.
      Delete non-signal layer if you have created one, we don't need it for this project. But do not
      delete custom plane layers. Save the design.

2.4   Working with vias
      DipTrace supports through and blind/buried vias (if divided by physical properties). Vias
      are also divided by two logical types that don't depend on their physical properties:
      Trace Vias (regular vias), which are technically parts of the traces and appear
      automatically when you move trace segment to another layer;
      Static Vias (similar to pads), which are placed manually, they have much more variable
      properties than trace vias.
      All vias in DipTrace, disregarding their logical type, are organized to Via Styles.
      We don't need a lot of different via styles for the current project, but we will add some in
      order to teach you the basic principles of working with vias.
      Let's create two additional via styles: one with blind/buried vias of the same size as the
42      DipTrace Tutorial



     Default via style (0.039 inch-diameter and 0.02-inch hole), and the other via style for
     through vias of bigger diameter. Go to "Route / Via styles" and check if Default via style
     has aforementioned parameters. Change them if you need. Then press Add button to add
     a new via style. It will appear under the Default one. Left-click it, and type in the name,
     change via type to Blind/Buried, and specify the layers involved (top and bottom layer of
     the via). In our case, we make blind vias from Top layer to Tutorial Layer. Specify via
     properties like in the picture below. Blind vias are impossible on printed circuit boards with
     only two layers, that is why we did not delete tutorial layers from the previous topic of this
     tutorial.




     Now add one more through via style called "Tutorial ViaStyle2", and enter 0.065 inch outer
     and 0.03 inch hole diameters. Press OK.


                                              Trace vias
     Now unroute one of the nets (we will route it manually). We have chosen the net that
     connects resistors' pads with the battery.
     Switch to the Bottom layer, then right-click on the net that you want to unroute, and select
     Unroute Net from the submenu.
     Go to "Route / Manual Routing / Add Trace" from the main menu or press the Tilde Sign
     (~) hotkey. Left-click on the first pad (R1:2), to start routing a trace and draw it to some
     point between the R1 and R2. Use V hotkey and select Tutorial ViaStyle2 from the pop-
     up menu to apply it to the vias that will be created when changing layers. Auto means that
     DipTrace will use a via style that takes less space on the board, but in our case, we select
     the style with bigger vias (Tutorial Via Style2). Let's check Via Preview option on the
     Routing panel (alternatively, E button can be used). You can see that a circle, meeting
     the parameters of the selected via style, has appeared at the tip of the trace. Now left-click
     to set a trace segment between the pads, then right-click, and select "Segment Layer /
     Top" from the drop-down submenu (if you're routing on the bottom layer and vice versa).


                                                                               © 2024 Novarm Software
                                                                  Designing a PCB       43



Trace via will appear automatically. Disable via preview with E hotkey and continue routing
on the opposite side of the board to another pad, and then left-click it. Create one more
segment between the R2 and R3 components. Notice that trace color is defined by the
layer color. Do not route the entire net all the way to the battery.




                                        Static vias

You can use         button to place a new static via on the design area or you make one
directly from a trace via - just right-click on it, and select Convert Via to Static. Then
specify which vias to convert: Current via, Selected segments etc. Static vias behave
almost like pads.
If you change the parameters of some via style, all vias of that style, even those on the
design area, will change automatically.
We can change style, type, diameter of the static via and apply new settings to the current
or selected vias or nets in the Via Properties dialog box. Right-click on one or several vias
(or nets with static or trace vias), and select Via Properties from the submenu, make
some changes, and press OK. If there is no via style with the parameters you've entered,
DipTrace will ask if you want to create a new via style.
  44      DipTrace Tutorial




       You can convert static vias back to trace vias, right-click on the static via, and select
       Convert to Trace Via from the submenu, and select, which vias to convert. If you've
       placed a static via directly on the design area, you can not convert it to trace via.
       Delete all vias, unroute the net again and route the trace on a single layer, but do not use
       the Undo tool, because this will delete custom via styles.

2.5    Net classes
       All nets in DipTrace are organized to Net classes. Net classes allow the user to apply
       numerous parameters to any net with one click. Net classes work with manual and
       automatic routing (Autorouters). Specify net class parameters before routing nets.
       We are going to practice in working with net classes using the same project, therefore,
       we need to completely unroute it first. Go to "Route / Unroute All" from the main menu.
       Then select "Route / Net Classes" from the main menu to open the Net Classes dialog
       box. You can see that only Default net class is available and all nets belong to this class.
       Press Add button and a new net class appears in the list of all net classes, right under the
       Default. Left-click it, and type in the name.
       In the Class Properties tab, specify trace parameters and clearance value. In our case,
       we will make traces of a new net class significantly larger (0.03 in) with 0.05 clearance.
       Notice that asterisk symbol (*) in the input field means that it is a default value.
       If you uncheck All Layers, the list under this checkbox becomes active, allowing different
       trace parameters on different layers of the board. We don't need this now.
       Uncheck Use All Styles checkbox in the Via Styles section, and choose, which via styles
       you want to use with this net class. Just press << and >> buttons to add or delete via
       styles to/from the list of the active ones. The        button allows the user to preview


                                                                                  © 2024 Novarm Software
                                                                  Designing a PCB     45



parameters of each via style. We have allowed only custom via styles for this net class
(see the picture below).
New net class exists, but it does not have any sense if no nets belong to it. So we're going
to add nets. In the lower-right of the Net Classes dialog box, you can see the list of all
project nets and the name of the current net class of each net in the brackets. In our case,
it is Default net class. Select one or several nets with Ctrl key, and press the
button to add them to the net class (Class Nets list right above).




As you can see, the Tutorial NetClass contains one net (Net 7 in our case) with .03 inch
trace width.
The Clearance Details button allows you to set different clearances depending on the
type of the objects. Press Class to Class... to specify clearance between the nets of
different net classes. Class to class clearance is used by DRC and has priority over
regular net class clearances. Make sure Use Clearance in DRC item is unchecked, and
press OK to close the Net Classes dialog box and save changes.
                              Autorouting with net classes
Now you have two different net classes, one net belongs to Tutorial Net Class and the
rest – to Default. It's time to route the board with autorouter, select "Route / Run
Autorouter" from the main menu or press Ctrl+F9 hotkeys and you'll get something like in
the picture below. As you can see, the traces on the PCB have different width, because
they belong to different net classes with different parameters.
46      DipTrace Tutorial




     Now unroute the board again ("Route / Unroute All"), open the Net Classes dialog box and
     reassign Net 7 from Tutorial NetClass to Default class (use the           button). Press
     OK, then launch autorouter again and you'll get the circuit board with all traces of the
     same width. Tutorial NetClass still exists, but it doesn't do anything because no nets
     belong to it.
                                 Manual routing with net classes
     Select the Bottom layer, and left-click on one of the nets (for example, Net 6 between the
     resistors and the battery), you'll see the Net Properties panel on the Design Manager on
     the right. In the Net Class drop-down list select Tutorial Net Class. Then right-click on the
     same net and select Unroute Net from the submenu. Now press the Tilde Sign (~)
     hotkey to activate manual routing mode, left-click on the first pad (R1:2), and create a
     trace to another pad (R2:2) left-click it to create a trace segment. You'll notice that the
     trace is much wider because it belongs to another net class.
     Notice that DipTrace allows for changing the net class of the routed net, but in order to
     apply changes, the net has to be unrouted and routed again.




                                                                               © 2024 Novarm Software
                                                                       Designing a PCB       47




      We don't need that trace width diversity on the board. Please Undo (Ctrl+Z) several
      times or manually delete all custom net classes, via styles, and inner layers to get the
      layout right after autorouting.
      Save the project ("File / Save" from the main menu).

2.6   Manual routing
      Simple projects like ours can be routed automatically, but for complex boards, manual
      routing is a must. Actually, the entire board can be routed manually, but because of low
      speed of manual routing a combination of the two methods is usually the best choice for
      complex projects. This allows the designer not only to get a working prototype, but also to
      accomplish the project in reasonable terms. Critical nets are routed manually and the rest
      – with autorouter.
      Our simple board is already good enough, but we're not done with practicing yet.
      Moreover, sometimes you may need to correct traces after the autorouter.
                                        Manual routing panel
      Manual routing offers complete control over your design and allows you to make
      adjustments that automated tools might miss. However, with this flexibility comes the
      responsibility of carefully managing any rule violations you may introduce. DipTrace helps
      streamline this process with interactive tools, allowing you to push traces, validate your
      design in real time or block actions that would conflict with your design rules.

      To access these features, click the Route Manual button           . The Routing panel will
      appear on the left. Let’s explore some of the Basic Interactive tools.
      The Push Traces tool automatically shifts existing traces, making it easier to route the
      current net optimally. To try this out, enable Push Traces on the Routing panel and click
48     DipTrace Tutorial



        button to its right. This opens the Interactive Routing Setup dialog, which can also be
     accessed via Route > Interactive Routing in the main menu. In the drop-down menu
     under Interactive for Manual Routing, select Push Traces.
     Make sure that both Push Trace Vias and Push Static Vias options are checked. This
     will enable the software to relocate vias while routing.
     Next, let’s configure the Jump Over Other Objects feature, which determines how far
     the software will search for placement options jumping over obstacles on the board. Set
     this distance to 0.5 inches.
     Our project is quite simple, however, more complex designs may require fine-tuning. You
     can enable Reduce Pad Clearance for Smaller Pad Pitch if needed, and choose
     whether the Allowed Clearance to Pads will be governed by Net Class or Design
     Rules.
     Once you've made these adjustments, press OK to apply the settings.




     Right-click on one of the nets and select Unroute Net from the submenu. In this
     example, we've chosen Net 6, but feel free to select any net you prefer. The Unroute Net
     command will apply to all selected nets.
     Now, left-click on any pad belonging to the unrouted net and begin routing a trace toward
     existing routed traces. You’ll notice that as you route, DipTrace automatically pushes and
     reroutes existing traces to accommodate the new path. In some cases, routed traces will
     jump over other objects on the board to make room for the new one.




                                                                             © 2024 Novarm Software
                                                                   Designing a PCB       49




Disable the Push Traces option to explore the next interactive feature: Show Errors.
When enabled, any routing errors will be highlighted in real time with red circles as you
route or edit traces. If the Follow Rules option is also activated, DipTrace will prevent any
violations of your pre-set design rules while routing.
Let’s continue working with Net 6. Left-click on any pad associated with it and intentionally
route a trace over other existing traces. You’ll notice red circles appear to indicate errors.
Now, enable the Follow Rules option, and you’ll see that any trace segment violating the
design rules turns into a dotted line, preventing you from placing it.
50      DipTrace Tutorial




     The rules defined in DRC are applied. DRC will be discussed in more detail later 76 Now
     right-click and select Cancel from the submenu or press Esc key to eliminate the trace
     we tried to route.


     It's time to practice more in manual routing. Note that in the Routing Mode list (on the
     Routing panel) you can specify the group of trace segments that you are going to need for
     routing, therefore, you will be able to select the current segment not from the list of all
     segments, but from the list of segments of one mode. To do this, you should customize
     My Routing Mode.
     Select All Segments routing mode, then left-click in the Current segment field and
     select 3-point Arc. Left-click on one of the pads of the unrouted net, then left-click on the
     second pad and move the mouse to adjust the radius of the arc and fix it with a left click.




                                                                               © 2024 Novarm Software
                                                                 Designing a PCB         51




Our project is very simple, but when working on a more complex one you may find it quite
handy to fix only one part of polyline and rounded line segments when routing a trace.
Enable Fix Single line option on the Routing panel or use D hotkey, if you want the
software to place only the first part of the segment and leave the second one in the routing
mode. You can change Route mode to 90/45 Lines to check out this option.
Do not try to change the net class of the existing net on the Routing panel, net class
should be defined in the Net Properties or Net Classes dialog boxes before routing.
Notice that you cannot change net class of the existing net on the Routing Panel. This
change will be ignored and applied only to a newly created net. Don't forget that net exists
irrelative of whether it is routed or not.
We have only one net class to avoid confusion and concentrate on the subject.
DipTrace allows changing the layer of the trace being routed. Undo the arc segment or
right-click on it and select Unroute Segment from the submenu, you can also select the
segment and hit Del hotkey. Set 90/45 Lines routing mode, left-click on the first pad
(R1:2) and draw a trace to some point between the first and the second (R2:2) pad, left-
click to anchor it. Now activate Via Preview by pressing E hotkey. Use V key to change
Style of the trace via that will be placed automatically when routing layer is changed.
52     DipTrace Tutorial




     Press 1 to change the layer and E to disable Via Preview. Connect the trace to the R2:2
     pad.




                                                                           © 2024 Novarm Software
                                                                 Designing a PCB      53




On the Routing panel, you can choose, which nets to highlight. If you highlight only the
current net – no other nets will glow, even if you touch them with a new trace.
You can undo by pressing the U hotkey while routing. Notice that there are hotkeys that
will make manual routing really easy and quick.
F - enable/ disable Follow Rules option,
M – switch between routing modes,
S – change current segment,
D – fix only the first angle-forming segment of polylines and rounded lines,
W – set trace width,
T – switch to Top layer,
B – switch to Bottom layer,
L – change segment layer,
J – switch to jumper wire or back (if you are in Bottom layer, jumper will be placed to Top
and vice versa),
V – toggle between via styles,
E – preview trace via before placement,
A – angle step,
54      DipTrace Tutorial



     H – highlight net,
     P – pause routing; once the routing is paused, you can edit the layout and then resume
     routing by hitting P key again,
     1 – 0 in the top of keyboard – switching between layers (up to 9).
     Go to "Tools / Hotkey Settings" from the main menu to view and change the hotkeys.
     Refer to the PCB Layout Help document ("Help / PCB Layout Help") for more details about
     custom keyboard shortcuts and manual routing.
     Now please Undo (Ctrl+Z) several times or change the layout to the state after
     autorouting (no net classes, via styles, new layers etc.).
                                             Editing modes
     You already know how to create traces ("Route / Manual Routing / Add Trace" from the

     main menu or pressing         button; left-click on the first pad to start routing, and another
     click on the next pad to create a trace). Always make sure that a correct layer (Bottom in
     our case) is selected.

     Editing traces is a bit different. Press      button or simply left-click on the trace and drag
     it to another location and drop it. The Edit Traces mode allows the user to move traces,
     respecting 45- or 90-degree angles. This is very convenient for almost any design, but
     sometimes you might need traces editing tool with more capabilities. Go to "Route /

     Manual Routing / Free Edit Trace" from the main menu or press              button on the Route
     toolbar. Now you can edit traces without any restrictions.

     Don't forget to set the grid size (with the          drop-down on the Standard toolbar
     or Ctrl+Plus Sign and Ctrl+ Minus Sign hotkeys). To configure the list of available grids,
     select "View / Customize Grid" from the main menu. F11 hotkey hides or shows the grid
     on the design area. You can adjust grid precision and set minimum grid size value in a
     dialogue, which pops-up when selecting "View/ Precision" item from the main menu.
     Remember, if you don't know which tool you are working with, right-click a couple times on
     a empty spot on the design area and DipTrace will return to the Default mode.
                                                 Nodes
     Any routed net is divided to traces (often called "tracks"). Trace is a copper track between
     two pads of the net. Trace (track) consists of segments. A segment is a route between
     two nodes. Node is a point on the route, which divides a trace into segments (red dot or a
     small square in the picture below). The designer can move existing nodes, add new ones
     or delete them. This gives more flexibility while editing traces. Left-click on a trace
     segment, and press N hotkey to add a new node in the selected place, then left-click it
     and drag to some point outside the board outline (Free Edit Mode in the picture below).




                                                                                 © 2024 Novarm Software
                                                                  Designing a PCB      55




Undo free editing and right-click on the design area to return to default mode. If you don't
need some node anymore, you can delete it – right-click on the node, and select Delete
Node from the submenu. In the same submenu, you can change the name, color, width,
and the layer of the net, trace or segment etc.
56     DipTrace Tutorial




                                           Change layer
     DipTrace allows moving an existing net (trace or trace segment) to another layer - right-
     click on a trace segment of some net, and select "Segment Layer / Top" or use the
     Segment Layer drop-down list in the Net Properties panel on the Design Manager.
     Trace vias appear automatically. You can choose several segments of the same or
     different nets with Ctrl or Shift buttons and change their properties at a time.
     Note that you can use Tab hotkey to toggle between the selection of a segment, a trace or
     the entire net.




                                                                             © 2024 Novarm Software
                                                                  Designing a PCB       57




Now return that segment back to the Bottom layer, and select the bottom layer.
                                         Teardrops
DipTrace allows creating teardrops, which are basically drop-shaped features at the
junction of vias, pads and traces.The main purpose of teardrops is to enhance structural
integrity in presence of thermal or mechanical stresses during fabrication as well as to
enlarge manufacturing tolerances.
In PCB Layout you can define teardrop parameters as a function of the pad/ via or trace
size and apply them to the selected object/-s.
Let's see, how to use this feature. Right-click on Net 6 on the design area or in the list of
nets on the Design Manager panel and select Teardrops from the submenu. In the pop-
up dialog tick Through-Hole Pads and Vias and set Length to 50% and Connection to
90% of pad size. We are not going to set teardrop parameters for SMD pads and trace to
trace junctions because they are not any in our project. In the Apply to drop-down select
Current Net.
58      DipTrace Tutorial




     You can see that junctions between the traces and all through-hole pads, belonging to the
     Net 6, are now shaped like a drop.




     Note that you can also add teardrops to individual pads or vias - just use a similar dialog,
     launched from the right-click submenu of the respective objects, to set their parameters.



                                                                              © 2024 Novarm Software
                                                                        Designing a PCB       59



      Undo teardrops.

2.7   Measuring trace length
      DipTrace allows for easy and convenient trace measuring. The current project is simple,
      therefore we don't need to use this tool, but if you design high-speed circuits with
      differential pair signaling, trace length becomes very important. This tool is often used with
      trace length matching tools 194 , which we will review later.
      Notice that hint of each trace can be configured to display its length: select Add Object
      Details in the View/ Display Hint submenu.
      Please select several traces (you can use box selection or Ctrl button). Right-click on one
      of selected traces, and choose Show Trace Length from the submenu.




      You will see the small boxes with trace length values near all pads of the selected nets,
      they are also highlighted when hovering over the trace with a mouse cursor. Values are in
      the current measurement units (inches in our case), they change in real-time when you
      edit the trace.
  60      DipTrace Tutorial




       Notice that DipTrace can calculate a phase shift considering layer stackup 189 (via height)
       and the length of bonding wires inside a component (determined by the Signal Delay 199 ).
       By default, DipTrace does not consider these values for trace length calculation. If you
       want to consider them, go to "High Speed / Length Matching" from the main menu, then
       press    button, and check Enable Layer Stackup and Enable Pad Delay in the
       Length and Phase Measurement Settings dialog box.
       Now please hide the trace length boxes, using the net submenu (uncheck the same item)
       or Undo tool.

2.8    Selecting objects by type/layer
       Sometimes it is necessary to select all objects on one layer or exclusively components,
       nets, vias etc. With the current layout, it is very easy to do with the mouse and Ctrl key,
       but what if the layout is very complex?
       Select "Edit / Edit Selection" from the main menu.




                                                                                © 2024 Novarm Software
                                                                   Designing a PCB        61




Check Components item, and click OK – all components are selected now.
Let's make it a bit harder and model a real-life situation, when we need to select only
unconnected vias in the predefined area of the board.
First of all, deselect components with a right-click on an empty spot. Then place several
static vias and connect only some of them to nets randomly, while leaving a couple of

vias unconnected. Use "Objects / Place Static Via" from the main menu or            button to

place vias and "Objects / Place Ratline" or         button – to create connections visually.
Left-click on the via, and then left-click on the pad to add via to the pad's net.
Now define selection area using the box selection. This box represents an area where we
plan to select unconnected vias so we will not include all vias of the layout to this
selection. Notice that we are on the Bottom layer, where we have all the traces.
62      DipTrace Tutorial




     All objects in the box are selected. We need to extract only non-connected vias from the
     selection. Open "Edit / Edit Selection" dialog box, choose Action: Keep Selected, check
     only Vias checkbox (other boxes should be unchecked), and then select Not Connected
     from the Vias drop-down list. Click OK and only unconnected vias stay selected.
     The next step could be connecting those vias to some net, all at a time. In real life, this
     feature can be used to connect ground net to plane/copper pours. Right-click on one of
     selected vias (it should be highlighted in red), select "Add to Net / Selected Vias" from the
     submenu, and specify the net in the pop-up dialog box.




                                                                               © 2024 Novarm Software
                                                                       Designing a PCB       63




      Choose some net from the list, and click OK. All vias will be connected. Remove all static
      vias from the board and return the circuit board to the previous state (select all vias and
      press Del key or Undo).

2.9   Placing text and graphics
      With DipTrace you can add texts, shapes, and logos in BMP, DXF, JPEG or PNG formats
      directly on the board and export them to Gerber.
      First, you have to select the layer where you're going to place graphics, usually, it's a
      silkscreen layer (Top Silk in our case). PCB Layout allows the user to change layers with
      two drop-down lists on the toolbar and in the Layers tab on the Design Manager panel.
      Double click Top Silk in the Layers tab of the Design Manager panel or select it from a
      drop-down.
      Note that a drop-down list on the Drawing toolbar allows you to select any non-signal or
      Signal / Plane layer for placing graphics. If you have selected Signal / Plane layer, all
      shapes, texts and logos will appear on current signal/plane layer, which is specified with
      the drop-down list on the Route toolbar.
64      DipTrace Tutorial




     Let's make the board polygon a little bit bigger to place additional text at the top. Drag and
     drop upper-left and upper-right vertices of the board outline a little bit upwards. Make sure
     you click on the vertex point, not on the outline. DipTrace makes visual editing very easy
     with appropriate grid size.




                                                                                © 2024 Novarm Software
                                                                   Designing a PCB       65



You can move the board outline. Left-click on the line (not the vertex), then drag and drop
it.
Remember that if you can not highlight and edit certain objects, probably, you are not in
the default mode. Therefore, right-click on a free area to cancel the current mode. Objects
located on inactive layers of the board can’t be edited unless you are in the Contrast Edit
layer display mode (View/ Layer Display/ Contrast Edit).

Press       button, left-click where you would like to place text, type it in, and press Enter
to move to the next line. Right-click on a free spot to return to default mode.
Use the mouse or arrow keys to move the text object on the design area. When a text
object is selected, font settings, font type (Vector, TrueType), and text layer can be
changed in the Text Properties tab on the Design Manager, or with the right-click
submenu. Use vector font, because it is directly exported to Gerber. For Unicode and
Non-English characters select TrueType fonts, however, these export to Gerber as small
lines (created by a special recognition algorithm).
Some PCB manufacturers do not accept TrueType text objects in copper layers.




The text object is on the silk layer, it inherits the layer's color. If you need to change the
text color, move the text object to the Top Assembly layer and then change Top Assembly
color.
You can change all the parameters of the text object any time. Right-click it, and select
Properties from the submenu.
  66      DipTrace Tutorial




       In the pop-up dialog box you can edit the text and its display parameters as well as
       rotation angle, location and coordinates of the anchor point. Select text object Type from
       the drop-down and move the object to another layer or define different properties (for
       example, create a route keepout used for autorouting, etc.). In our case, we just leave that
       text on the Top Silk layer.
       Note that Invert Text option allows to place text as void in silk screen or copper pour.
       You can add shapes to assembly, mask, paste, signal, route keepout, board outline and
       cutout layers. The properties of the placed shapes can be defined via Shape Properties
       dialog box.

2.10   Copper pour
       Copper Pour is used as a low-impedance conductor for Power and Ground nets. Pours
       are usually located on inner layers of the board, but they can be placed on top and bottom
       sides as well.
                                            Place copper pour
       Select the Bottom layer, then go to "Objects / Place Copper Pour" from the main menu or

       press        button on the Elements toolbar. Now you can draw a copper pour polygon
       borderline by defining its key points on the design area, then right-click on the last point of
       the polygon, and select Enter from the submenu to finish drawing. We need a copper
       pour that covers the entire bottom layer of the board. You can draw a precise polygon
       manually or create a random shape (for example, like in the picture below) and use the
       Depending on Board feature (Place Copper Pour dialog/ Border tab), which will pour the
       entire layer automatically, regardless of the initial shape. Place Copper Pour dialog box
       pops up when you select Enter from the submenu upon placing a copper pour border.



                                                                                  © 2024 Novarm Software
                                                                 Designing a PCB       67



You can change the grid size up and down to your convenience at any point of copper
pour placing/ editing.




This dialog box has three tabs: Pouring, Connectivity, and Border.
Pouring tab allows you to specify different non-solid fills for the copper pour, clearance
width, line width, line spacing, island removal options, pour priority, and current state
(poured or unpoured). You can also apply net clearances as copper pour clearances by
checking the corresponding item. DipTrace has shape-based copper pour system.
Connectivity tab – here you can connect copper pour to the net, select thermals and
change their settings. DipTrace supports separate thermals for SMD pads. The Hide Net
Ratlines regime can automatically show ratlines only for unconnected traces or other if
specified.
Border tab allows you to define the border points and build the copper outline
automatically.
Check Depending on Board checkbox and keep all other settings like in the picture
above. The Snap to Board checkbox means that copper pour will resize depending on
the board outline. Click OK to place a copper pour.
68     DipTrace Tutorial




     Board outline clearance specified in the copper pour settings is not applied to board
     cutouts. Always use route keepout to allow for a certain clearance between the copper
     pour and cutout, like we did before.
     Copper pour can be in two states: Poured and Unpoured. The second state is often used
     for editing because only the copper pour border is visible in the Unpoured state. To
     change the copper pour state right-click on the copper outline (not on the copper
     pour body), select State from the submenu, and choose the item you need.
     As you can see, we have a copper pour, but it is not connecting any net. Now we will
     practice and connect two different nets using two copper pours on the Bottom layer.
     Copper pour priority option will help us to achieve our goal.
                                      Connect copper pour
     Unroute one of the nets (for example, Net 6, which connects resistors to the battery),
     right-click on the trace, and select Unroute Net from the submenu. Remember the net
     name ("Net 6"). Right-click on the copper pour border, and select Properties from the
     submenu. Go to the Connectivity tab, and select Connect to Net: Net 6, then select
     appropriate thermals (for example, 4 spoke), and press OK to update the copper pour.
     Notice that you should click directly on the copper pour border (not on the copper body or
     the board outline) in order to open copper pour properties dialog box.




                                                                            © 2024 Novarm Software
                                                                   Designing a PCB       69




You can see that connection lines (ratlines) are hidden now and the net (Net 6) is
connected to the copper pour with thermals of selected type (4-spoke thermals).
Now we will place the second copper pour. Select another net that we will connect with a
copper pour (for example, Net 2 that connects R3:1, C1:2, and Q2:3 ) and unroute it, then
right-click on the edge of existing copper pour, and open the Copper Pour Properties
dialog box. Select Current State: Unpoured, but do not close this dialog yet.
                                        Pour priority
Now it's time to change the pour priority for the existing copper polygon. Specify: Pour
priority: 1 in the Pouring tab.
You can enter any value, depending on how many copper pours you plan to have on this
layer. A lower value means higher priority, therefore copper pour with Pour Priority: 0 will
have higher priority than Pour Priority: 1.
Notice that two different-net copper pours with the same priority level will intersect. Real-
time Design Rule Check will show numerous errors in this case.
Press OK to apply new settings. Notice that in unpoured state ratlines are displayed
automatically. Make sure Net 2 is unrouted, then select copper pour placement tool
("Objects / Place Copper Pour"), and draw the second polygon that covers pads of the
Net 2, like in the picture below. You can change the grid size for convenience.
70     DipTrace Tutorial




     In the pop-up dialog box connect the second copper pour to Net 2, and specify the thermal
     type (4 Spoke should be fine). Press OK to close the dialog box and create a copper pour
     polygon.




     Now select Net 6 copper pour, which is unpoured now. Right-click on its border, and


                                                                           © 2024 Novarm Software
                                                                  Designing a PCB       71



select "State / Poured" from the submenu. You will see that two copper pours connecting
two different nets are independent and Net 6 copper changed according to the Net 2
polygon which has higher priority level.




                                         Thermals
Some pads require custom thermal connections that will be different from the copper
pour's thermals. Right-click on a pad (when the pad is highlighted), and select Thermal
Settings from the submenu, then check Use Custom Settings checkbox, and select a
new thermal connection.
Some pads can become unconnected after placing a copper pour, because of selected
thermal type and the layout structure (net connectivity check will report this), so selecting
separate thermal settings for pads will help you to fix those issues.
72      DipTrace Tutorial




     After changing thermal settings click OK to close the dialog box, then right-click on the
     copper pour border, and choose Update from the submenu to see these changes
     applied.
     Select "Objects / Update All Copper Pours" from the main menu to update all copper
     pours at a time.
     We'll try different thermals for pads to show you how it works.




                                                                              © 2024 Novarm Software
                                                              Designing a PCB      73




In the picture above, you can see that one pad has 4-Spoke 45-degrees thermal, another
one is connected directly, and the third pad has 2-spoke 90-degrees thermal connection.
                      When the copper pours are used as Ground and Power planes,
                      SMD vias usually connect to them by fanouts. You can create
                      fanouts manually with the Fanout 239 feature or automatically by
                      Shape Router.

                      We have decided to remove all unconnected parts of both copper
                      pours. Go to the Properties of each copper pour and check
                      Unconnected item in the Island Removal section of the Pouring
                      tab. Press OK.

Let's see how to make a text etched in the copper pour. Switch to the Top layer, where we
placed a text earlier. Right-click on the text object and open Properties dialog. In The
pop-up select Type - Signal, Layer - Bottom and tick Invert Text box. Click OK.
74      DipTrace Tutorial




     Now we'll have to switch to the Bottom layer and update the copper pour for the changes
     to take effect.You can see that the text has been placed as void in the copper and it's
     flipped (you can disable Flip Text Automatically option in the View menu for the text to be
     displayed without flipping on the Bottom Layer).




                                                                              © 2024 Novarm Software
                                                                         Designing a PCB       75



       Undo the changes until the text is back in the Top Silk layer or just change the settings in
       the Text Properties dialog. Save the project.

2.11   Locking objects
       Sometimes while making changes to the schematic or PCB, you need to lock some
       objects so you don't change them accidentally. Let's see how to do this in the DipTrace.
       Switch to the Top layer, select several objects, right-click on one of them, and click Lock
       Selected from the submenu.




       Notice that locked objects have their selection rectangles in lower contrast (in our case
       the color is similar to the copper pour, so we've made only current layer visible (with the
       drop-down list on the Layers panel). "Locked" text appears in the hint of the locked
       objects, you are unable to move, resize or edit them without unlocking first.
  76      DipTrace Tutorial




       Now please unlock all objects, select all with Ctrl+A, and unlock ("Edit / Unlock Selected"
       from the main menu or Ctrl+Alt+L keyboard combination).
       You can lock all the components after placing them on the top or bottom side of the board.
       Select "Edit / Lock Components / Top or Bottom" to lock the components on the
       respective layer (to unlock - just select the same item to disable it). Using this mode you
       can do the routing without worrying about changing something accidentally.
       Return to the contrast layer display mode using the drop-down on the Layers tab (Design
       Manager).

2.12   Design verification
       DipTrace has several verification procedures united in the Verification main menu item.
       We recommend using all three of them: DRC, Net Connectivity Check, and Compare
       PCB to Schematic.
                                      DRC (Design Rules Check)
       This feature is one of the most important verifications. It allows the user to check
       clearances between objects, control allowable object sizes, and differential pair
       parameters according to the set of design rules.
       DRC works in regular (offline) and real-time modes. Real-time DRC checks all user's
       actions on the go. For example, when you move some component or create a new trace
       too close to another object, Real-time DRC shows red circles, which means that the
       clearance between these objects (trace, pad, copper pour) is smaller than the specified
       target value.
       If the Real-time DRC function is not activated, you will not see errors until you start DRC
       manually in the regular mode by selecting "Verification / Check Design Rules" from the


                                                                                 © 2024 Novarm Software
                                                                 Designing a PCB       77



main menu or by pressing F9 hotkey. Error list or "No Errors Found" message will pop up.
Most likely the current PCB has no errors because it is very simple.
Now select "Verification / Design Rules" to set up design constraints. There are four tabs
in the pop-up dialog box: Clearances, Sizes, Real-time DRC, and Options.
Clearances. Specify object-to-object clearances. Uncheck All Layers item, select a layer
from the list below, and define object-to-object clearances to be applied on a particular
PCB layer.
Notice that clearance settings are NOT applied to nets with custom net class clearance (i.
e. when Use Clearance in DRC option in Net Classes dialog box is checked) or Class-to-
Class settings.
Check Same Net Clearance checkbox, and enter respective values, if you want to check
the clearances between certain objects of the same net.
Sizes. Specify minimum and maximum allowed sizes for different elements on different
layers.
Real-time DRC. Customize real-time DRC. You can turn it ON/OFF for specific actions,
for example, manual routing, creating / editing, and moving objects. If you uncheck
Enable Real-time DRC item, real-time verification will be turned OFF. However, enabling
Show Errors option on the Routing panel will activate design rule check during manual
routing, even if Enable Real-time DRC is unchecked - errors will be shown with red
circles. Also, activated Follow Rules option will control that all design rules are followed
and will not allow routing trace segments, if some violations are detected.
If you uncheck all secondary items in the corresponding tab, and leave only Enable Real-
Time DRC item active, you will see errors right after completing a certain action, not while
performing it. For example, if Moving objects item is checked, you will see errors before
moving component to a new location, if this option is unchecked – you will see errors right
after moving it, still no need to launch DRC separately. If Enable Real-Time DRC is
unchecked, you will not see any errors (unless you enable Show Errors option for manual
routing), till you start DRC manually.
Options. Set up other options.
78     DipTrace Tutorial




     For this tutorial example, please turn OFF the size verification and Real-time DRC by
     unchecking the corresponding items. Make sure that Check clearances and Show a list
     of errors... checkboxes are checked. Keep settings like in the picture above (these
     values are quite small, but still within technical capabilities of most PCB houses).
     Open the Options tab and make sure that Class-to-Class Rules, Length Matching,
     Copper Pours, or whatever objects you want to be verified are checked. Now let's try to
     see how DRC works in a regular mode. Even if the real-time DRC was ON during the
     design process, we recommend verifying project with regular-mode DRC at least once
     before exporting to Gerbers, just to make sure that everything is fine. Press OK to apply
     changes and close the dialog box.
     Our project does not have errors, therefore we will create them intentionally. Select
     Bottom layer ("B" hotkey), switch OFF the grid (F11 hotkey), and move some trace until it
     touches the copper pour or another trace. Go to "Verification / Check Design Rules" or
     just press F9 hotkey to launch DRC. The list of errors will pop up automatically.




                                                                             © 2024 Novarm Software
                                                                   Designing a PCB       79




Errors can be sorted by layers. You can see the description of each error including the
current value and the target value. Left click on the error in the list and DipTrace will show
where to change the target constraint in the Rule Details section. Press Localize to see
selected error on the design area and fix it. Red circle means a clearance error, magenta
circle – size error.
Move the trace back to its original location without closing the error-report dialog, and then
press Run DRC button. This time everything is OK and No Errors Found message
appears.
                                  Net connectivity check
This verification allows the user to check if all nets are properly connected. For such
simple design this feature is not necessary, but if you have a larger board with many
layers, pins, copper pours, and shapes, net connectivity verification becomes really
useful. It checks the entire design and displays the list of broken and merged nets. Please
select "Verification / Check Net Connectivity" from the main menu, and click OK in the
pop-up dialog box. Most probably, your design will not have connectivity errors and you will
see the No Errors message. More information about Net connectivity check 237 .
                                 Comparing to Schematic
This procedure allows you to check if PCB corresponds to the source Schematic file.
Verification shows the net structure errors and unknown components. Select
"Verification / Compare to Schematic" from the main menu then choose source
Schematic file, and press OK. If your net structure was not changed and has no errors,
you will see the "No Errors Found" message, otherwise, the list of errors will pop up.
Net connectivity check and Comparing to Schematic features work fast and provide an
easy-to-understand user interface with reliable functionality.
  80     DipTrace Tutorial



2.13   Layout information
       What about counting the number of pins or the board area? Select "File / Layout
       Information" from the main menu in the PCB Layout module.




       Here you can preview the number of different objects, layers, board and hole sizes.
       Press    button in the Holes section to open the Hole Sizes dialog box. Press Show
       on Board button to highlight holes by size directly on the design area.




       Close the dialog box, and save the layout.




                                                                              © 2024 Novarm Software
                                                                       Designing a PCB     81



2.14   Panelizing
       With DipTrace you can panelize similar or different boards on a single layout.


                                           Panelize project
       If you need several copies of the same PCB, select "Tools / Panelizing" from the main
       menu or press       button on the Standard toolbar.




       We will make 12 copies of this circuit board, 3 columns and 4 rows. Since our board is of
       a regular shape and does not have any parts overlapping the edge, we will use V-Scoring
       to facilitate the panel break-off. “Board to Board Spacing" will be zero (however, always
       check the requirements of your manufacturer).Tick Add Edge Rail checkbox and enter
       0.2 in for each side to add a frame along the perimeter of the panel and make sure it’s
       suitable for industrial assembly. Click OK.
82     DipTrace Tutorial




     We can see only boxes with "#" text on the design area, but you can check the final layout
     in the Print Preview dialog box ("File / Preview" from the main menu), while printing or
     exporting to manufacturing formats.
     It is possible to exclude some objects from panelizing (for example, holes or shapes). To
     exclude any object from panelization, right-click it, and check Do Not Panelize. This item
     is available only if Panelizing is active.




                                                                            © 2024 Novarm Software
                                                                       Designing a PCB      83



       Notice that panelizing works only if PCB has a board outline.
       For more details about panelization for Tab-Routing panels as well as V-Scoring and Tab-
       Routing combined, please consult PCB Layout Help.
       Now open the Panelizing dialog box and change the number of columns and rows to "1"
       to remove copies and let us practice with panelizing different boards on a single layout.
                                     Panelize different projects
       Check "Edit / Keep RefDes while Pasting" item from the main menu, then select all
       objects (Ctrl+A) of your layout, and press Ctrl+C to copy them, then right-click on an
       empty spot on the design area (this will be an upper-left corner of the second board), and
       select Paste from the submenu.




       We got the second copy of our PCB (but it can be a different PCB, if you want).
       Reference designators will not change.
       Notice that you need to create a common board outline and board cutouts; additionally,
       non-signal layers may be required for correct manufacturing. More information at our
       YouTube channel.
       If Keep RefDes while Pasting item is checked, pin limitation of your DipTrace edition
       (Free, Lite, Standard, Extended) does not apply, so you can easily panelize several 300
       pin layouts even with DipTrace Freeware.

2.15   Printing
       We recommend using the Print Preview dialog box to print PCBs, select "File / Preview"

       from the main menu or press        button on the Standard toolbar. Notice that we did not
84      DipTrace Tutorial



     describe creating titles in the Designing a PCB section of this tutorial. If you want to
     display titles, select "File / Titles and Sheet" from the main menu, and select ANSI A in
     the Sheet Template drop-down list, then check Display Titles, and close the dialog box
     before opening the Print Preview dialog box.
     More detailed information about Titles and Sheets as well as creating and editing titles
     with the Title Block Editor in the DipTrace Help ("Help / PCB Layout Help" from the main
     menu).
     Use Print Scale drop-down list or Zoom In / Zoom Out buttons to change the scale of the
     layout on the sheet and press       button to move design on the sheet.
     In the upper-left, you can select current Signal/Plane layer and layer display mode. If you
     want to get a mirrored PCB or text, check Mirror or Flip Text checkboxes (the Flip Text
     box is disabled if "View / Flip Text Automatically" main menu option is ON).
     Press Print button to print the layout. Press Save if you want to save an image to PNG,
     BMP or JPEG file. The small button with colors to the left from the "Zoom Out" tool allows
     the user to define print colors ("View / Colors.../ Print Colors" from the main menu).
     Notice that only layers with default color depend on the color scheme.
     For printing all in black and white without changing layer colors, check Print in Black only
     box.




     For hobbyist's attention. Be aware that laser printers often introduce some degree of
     dimensional distortion due to heat expansion of the paper. It depends on your laser printer
     and the quality of the paper used. For most people, it's not important. However, one way
     to cope with this issue is to preheat paper by running it through the printer, without printing


                                                                                © 2024 Novarm Software
                                                                           Designing a PCB        85



      on it (for example, you can print just a dot in the corner). For ink-jet printers, this is not an
      issue since ink-jet technology does not heat paper. Laser printers do not always visibly
      distort images but you have to be ready that this can happen. You can use the
      Calibration feature in the Print Preview dialog box to minimize heat distortions.
      There are two methods of prototyping a PCB at home: using a TT (Toner Transfer) or UV
      exposure. TT is definitely a method for a laser printer, and UV exposure is better with ink-
      jet printers.
      Close the Print Preview dialog box and Undo several times to remove the second PCB
      and return the board without panelization. Then save the layout.


3     Generating files for manufacturing

3.1   DXF
      DXF output allows for exporting data to many CAD / CAM programs which support DXF
      import (AutoCAD and others).
                                                DXF export
      To export the circuit board to DXF format, select "File / Export / DXF" from the main
      menu, select layer from the list of all layers, and check/uncheck the corresponding boxes
      to show/hide different objects on this layer (text, pictures, vias, etc.). Set up the offset
      (distance between zero and the bottom-left corner of the board: design origin or custom
      value), mask and paste layers if needed. You can save each layer into a separate DXF
      file, but in order to export entire board into a single multi-layer DXF, press Select All
      button.
      Notice that "Edge_Top" and "Edge_Bottom" are not selected. Technically these are not
      the physical layers of your circuit board. They are exported only if you are going to
      manufacture the board using milling method.
      Press Export button, specify the name of the file, location, and save the circuit board into
      a DXF file.
86      DipTrace Tutorial




     All layers of the board will be exported into a single DXF file. You can open it with AutoCAD
     or another program that reads AutoCAD DXF.


                               Export for milling (DXF and G-Code)
     Milling method is convenient and cheap for non-complex boards.
     Notice that copper pours (unlike thermals) are not considered when exporting edges for
     milling.
     Select "File/ Export/ DXF" to open the DXF Export dialog box, then select Edge_Bottom
     layer, because all traces of our PCB are on the Bottom layer (if you have traces in the top
     layer, select Edge_top), check Mirror checkbox to mirror the design (for the bottom
     layer). This will allow us to see the actual bottom side of the board. You can leave default
     values if you're not familiar with specific milling settings or define the Edge Width
     parameter. Center line of the milling will be calculated as a half of the Edge Width value.
     Milling depth depends on the edge width and the instrument angle.
     Press Export button, and save the DXF file.




                                                                              © 2024 Novarm Software
                                                      Generating files for manufacturing      87




      The edge exported from the DipTrace is a set of polylines with defined width. DipTrace
      checks design before export and if object-to-object clearances are less than the edge
      width, DipTrace shows a warning message and enables the designer to correct errors.
      Notice that CAD programs usually show polylines with sharp angles, but when you mill the
      board or simulate milling with a CAM program, everything will look rounded because of the
      instrument radius.
      CNC drilling machines work with G-Code files. Convert your edge from the DXF format to
      G-Code, using ACE converter, FlatCAM (both are free) or another software.
      Please Undo several times to return the copper pour if you deleted one.

3.2   Gerber RS-274X
      DipTrace allows the user to export a circuit board to Gerber format, accepted by almost
      all PCB manufacturers around the world.
      Select "File / Export / Gerber..." from the main menu. In the Export Gerber dialog box
      select a layer from the list (multiple selection - Ctrl or Shift) and use the corresponding
      check boxes in the Objects section to specify, which objects will be exported to Gerber.
88     DipTrace Tutorial




     Press the Preview button to preview the selected layer. Unlike DXF, all layers should be
     exported to Gerber format separately, one layer per file. The image below shows the
     bottom layer of our PCB in the Gerber preview dialog box. You can zoom in and out.
     Press Close button to close the preview dialog box.




                                                                           © 2024 Novarm Software
                                                Generating files for manufacturing        89



Press Export All and DipTrace will offer you several options to generate output files: zip
archive with Gerber files only, zip archive with Gerber files and NC Drill (remember that
PCB houses need Gerber and N/C Drill files 93 to manufacture your PCB) or files for
each layer separately. Once you export those, you can send them out for manufacturing.
                                       Gerber layers
1. Top Assembly – this is assembly layer, it includes all shapes/texts placed on the Top
Assembly as well as objects defined in the "View / Add to Assembly" main menu item.
2. Top Silk – includes pattern shapes, texts and all other shapes and texts placed in the
Top Silk layer. Do not change these settings, and press Preview. Notice that if you use
the TrueType fonts, some parts of the text can be invisible (depends on the font and size).
3. Top Mask – this is a solder mask layer. It is generated automatically, based on pads,
custom pad settings, and common Solder Mask Swell parameter, defined in the Export
Gerber dialog box. This layer also includes shapes placed in the solder mask layer. We
should uncheck the Vias box (exclude vias from the export) because vias are usually
covered with the solder mask. To change custom solder mask settings for pads, right-
click on the pad, and select Mask / Paste Settings from the submenu.
4. Top Paste – this layer is used for SMD pads only, so we can check Paste Mask for
SMD Pads only.
5. Signal layers (Top, Bottom, etc.) – these are copper layers. Please check the Vias
checkbox for all of them and preview each one to make sure that layers are correct.
Notice that Pad/Via Holes item in the Objects section should be checked only if you plan
to drill holes manually (not using a PCB house). If Pad/Via Holes check box is checked,
two Gerber layers will be created inside one Gerber file: Positive Drawing and Hole
Clearing. The second layer is used to remove artifacts over the drill holes. Manufacturers
prefer Gerber files without pad/via holes.
6. Bottom Paste, Mask, Silk and Assembly layers are just like their analogs from the top
side. By default all text objects in Bottom layers are flipped – "View / Flip Text
Automatically" option from the main menu.
7. Board Outline layer includes the outline of the board or panel, if the board is
panelized.
8. V-Scoring - contains V-scoring pattern, if this type of panelization is used for the
design.
9. Board layer includes the board as a filled polygon.
10. Top/Bottom Dimensions – layers created specially for dimensions. These layers are
blank in our case because the current project does not have any dimensions on the
design area. Top / Bottom Dimensions can help some manufacturers to avoid mistakes in
sizes.
Notice that NOT all layers are necessary for successful board manufacturing. It depends
on your project and additional features that you order.
90      DipTrace Tutorial



                                            Other settings
     The Offset parameter in DXF, Gerber, N/C drill, and Pick and Place export dialog boxes is
     the distance between the zero and the bottom-left corner of the board. You can use a
     custom value or design origin (check the corresponding item or enter values in the Offset
     section of the Gerber export dialog box).
     Press Files button in the upper-right corner of the Export Gerber dialog box, define
     filename and extension for each Gerber layer, and include or exclude certain layer/s from
     exporting when you press the Export All button. Select a layer in the list, and type in a
     new name and extension. Layer name and project name tags are supported. You can
     also adjust how to export NC Drill files in Export All Options section; those settings will be
     applied if you chose to export both Gerber and NC Drill files together in one archive. We
     will not change anything, keep the <layer> tag – all files will be named as layers. Press
     OK.




                                       Drill Symbols (Legend)
     Some PCB houses require Drill Symbols. DipTrace allows you to export them as a
     separate Gerber file. Check the Drill Symbols checkbox in the Export Gerber dialog
     box, then press Set Symbols button. In the pop-up dialog box, you need to manually
     assign each hole with the symbol from the list in the right side or press the Auto button to
     assign all symbols automatically. Close this dialog box.




                                                                               © 2024 Novarm Software
                                           Generating files for manufacturing    91




Now check the Add Comments checkbox, and press Preview. You will see the drill
symbols and a table with hole parameters.
  92      DipTrace Tutorial



       Close the preview panel, and press Export layer to save Drill Symbols in the file. Drill
       symbols will be exported in a separate file just like any other Gerber layer. If apertures are
       not defined, DipTrace will ask you to set them automatically.
       Uncheck the Drill Symbols checkbox when done, otherwise, you will get a blank file/
       preview while exporting silk, assembly, signal layers, etc.
       DipTrace allows the user to export any texts, fonts, and Unicode symbols (even Chinese
       hieroglyphs) as well as images (company logo, etc.) to Gerber format. All those objects
       are vectorized.
       We recommend checking Gerber files with third-party viewer, before sending them for
       manufacturing. The best option is to use the same software (or a free viewer) as your
       board manufacturer, because some programs may read Gerber files a bit differently from
       the official RS-274X specification.
       We tried to take into account specifics of different manufacturing software in DipTrace
       Gerber export feature, but verifying files is a very good practice.
       If you don't know what software your manufacturer uses, we recommend Pentalogix
       Viewmate, it has strict RS-274X conformity.

3.3    Gerber X2
       Gerber X2 is the latest evolution of the Gerber format and DipTrace was one of the first
       electronic CAD systems with Gerber X2 support. If your PCB manufacturer accepts
       Gerber X2 files, you can completely enjoy the benefits that format gives to an engineer.
       Gerber X2 stores information about PCB stackup order, a function of each layer, PCB
       attributes and pad functionality.
       Select "File / Export / Gerber X2" from the main menu in the PCB Layout. Since Gerber X2
       is compatible with Gerber RS-274X 87 , the dialog boxes are identical and exporting
       procedures do not differ from the ones described in the Gerber Output 87 topic of this
       tutorial.




                                                                                 © 2024 Novarm Software
                                                      Generating files for manufacturing      93




      However, Gerber X2 saves comprehensive drill layout in the Gerber-formatted file (not just
      Drill Symbols, like Gerber RS-274X). To export drills, check Drills checkbox, select all
      copper layers (they should be selected by default) to export through holes, then press
      Export All button and select one of the options - Zip Archive: Gerber X2 or All Files
      Separately - to export all holes of the project automatically into the corresponding Gerber
      file/s. Each type of the hole goes into a separate Gerber Drill file. Note, however, that most
      manufacturers still require drills in the N/C Excellon format. You can export both Gerber
      X2 and NC Drill files simultaneously - press Export All button and select the respective
      option.
      Check with your PCB house if it accepts Gerber X2.

3.4   N/C Drill file (Excellon)
      If you order board manufacturing at a PCB house, you need to provide Gerber and N/C
      Drill files. Select "File / Export /N/C Drill" from the main menu, then press the Auto
      button to define the tools. Press Files button, if you want to configure default names of NC
      Drill files. Hit Export All button to save all necessary files automatically. Use the Preview
      button to visually check the layout.
  94      DipTrace Tutorial




       If you want to export just the holes of a certain type separately from the other, select the
       layer pair of the via style, and press Export.
       Remember that you can also export both Gerber and NC Drill files in one click in the
       Gerber export dialog.
       Notice that for through holes all layers should be selected, for Blind/Buried vias – only top
       and bottom layers involved in the via style.

3.5    ODB++
       DipTrace allows the user to export circuit boards into ODB++ format for manufacturing.
       Select "File / Export / ODB++" from the main menu in the PCB Layout. In the pop-up
       dialog box you can check or uncheck certain PCB layers for exporting, change default
       solder mask swell and paste mask parameters with respective fields and checkboxes,
       edit the offset values. The export mode can be defined by choosing between CAM350 and
       Mentor Graphics ODB++. For Mentor Graphics option, ODB++ 8.1 version is available.
       Default settings usually work for most cases so do not change them unless it's really
       needed.




                                                                                 © 2024 Novarm Software
                                                     Generating files for manufacturing      95




      If As Compressed file item is checked, DipTrace will zip all ODB++ files into a single file
      for sending out to the board manufacturer. Press Export and specify a folder, where
      you'd like to save the output files. You can preview ODB++ files with a free Mentor
      Graphics ODB++ Viewer.

3.6   Order PCB
      For those who doesn't want to look for a PCB house to manufacture a circuit board,
      DipTrace allows for a simple ordering tool with Bay Area Circuits, our partner PCB
      manufacturer in California. No need to export Gerber or N/C Drill files, enter a few details
      and manufactured board will be delivered to your place. Go to "File / Order PCB" from the
      main menu in DipTrace PCB Layout, review the board parameters, specify quantity,
      manufacturing time, shipping address, name, phone, email, and some additional details.
      The price will be calculated automatically.
96      DipTrace Tutorial




     Press Place Order button to open the order page in your web browser, review the total
     cost, including shipping. Online payment is done via PayPal.
     DRC checks your PCB automatically. If there are errors, we recommend to carefully
     review and fix them. Please do not allow for any ambiguity, especially related to Solder
     Mask and Solder Paste settings. Describe it in the Comments section, or contact Bay
     Area Circuits to clarify any of the questions that you think may arise.
     Email: support@bacircuits.com
     855-811-1975 FREE (toll free)
     510-933-9000 (local)
     510-933-9001 (fax)
     Corporate Headquarters
     44358 Old Warm Springs Blvd
     Fremont, CA 94538
     Congratulations! You have finished designing a simple project with DipTrace.
     Please, save your schematic and PCB files if you want.
     P.S. Do not forget to uncheck the Use Priority Layer Directions check box in the
     Autorouter Setup dialog box if you plan to route 2+ layer boards.




                                                                             © 2024 Novarm Software
                                                           Creating Component Libraries        97



4     Creating Component Libraries
      In this part of the tutorial we will show how to create component and pattern libraries. In
      most cases you can find appropriate pattern in DipTrace standard libraries and attach it to
      a new component, but for demonstration purposes we will create a new pattern from
      scratch.
      Important:
      In this tutorial we often refer to components as patterns or footprints (if talking about the
      PCB Layout), while in the Schematic components are often called symbols, component
      symbols, or schematic symbols, all these mean the same physical electronic
      component.
      A regular component in DipTrace consists of a schematic symbol, a pattern drawing and,
      possibly, a 3D model. All three represent the same entity, but on different stages of the
      design: schematic capture, PCB Layout, and 3D visualization/export respectively.
      Components and attached patterns are saved together in the files with *.eli extension.
      Components are always stored in libraries. If if you need to create just a single
      component, you have to create a separate library for it or ad it to an existing user library.
      DipTrace also allows access to patterns separately from the components. Patterns are
      also stored in libraries. Pattern libraries are saved with *.lib extension. No surprise, these
      files are only accessible in the PCB Layout and Pattern Editor.
      *.wrl, *.3ds, *.iges, and *.step files store 3D models. Patterns and schematic symbols can
      exist as separate stand-alone parts, but correct component always have all of them
      properly connected.
      Different schematic symbols can have the same pattern (footprint) attached to each of
      them and vice versa, for example the same resistor can be in through-hole and SMD
      packages.
      DipTrace has two separate programs Component Editor and Pattern Editor for designing
      components. Component Editor is used to manage components – draw schematic
      symbol and connect them with pattern drawings (footprints). However, pattern drawing is
      not editable in the Component Editor, Pattern Editor should be used instead.
      Read Working with libraries topic in the Component and Pattern Editor Help documents
      for more details.

4.1   Designing a pattern library
      Open DipTrace Pattern Editor, i.e. go to "Start / All Programs / DipTrace / Pattern Editor"
      on Windows machine or use DipTrace Launcher on MacOS.
      If you create a new component it is always better to start with drawing a PCB footprint
      (pattern), which you can assign to a certain schematic symbol in the Component Editor. If
      you know that the pattern is already available in the standard pattern libraries, you can
      proceed directly to the Component Editor to draw the schematic symbol, attach that
      existing pattern, and save complete component in the component library (*.eli file).
      However, we will start from the footprint design just to show you, how to do that and give
      you a full perspective of the design process.
      There are two ways to create patterns - manually and automatically (using Pattern
   98      DipTrace Tutorial



        Generator). We will go through both methods of creation of patterns for a through-hole
        and a surface-mount device.

4.1.1   Customizing Pattern Editor
        First of all, we need to show a center point and X, Y-axes, select "View / Display Origin"
        from the main menu or press F1 hotkey (if it is not displayed yet). Notice that you can
        change the origin at any time while designing a pattern ("View / Define Origin / ..." from the

        main menu or press        button on the Instruments toolbar). Origin is a zero point of the
        pattern when you place, rotate, or change pattern's position by coordinates in the PCB
        Layout.
        You can configure the precision level by defining the number of decimal places (up to ten)
        for all the values used in the project by units and set the minimum grid size and grid
        precision for the current units, using Precision of Values dialogue-box ("View /
        Precision…").
        Please note that high precision rates are used only at designing stage. When the project
        is saved into a file, precision up to 0.001 mil is applied.
        Pattern Properties panel in the upper-left of the design area allows the engineer to design
        patterns by types or templates, define pattern attributes, attach 3D model, and change
        default pad settings. The panel can be hidden, minimized or moved during pattern design.
        To minimize the panel, click the arrow button in its upper-left corner. To expand the panel,
        left-click on its border and drag it.To hide/show this panel select "View / Toolbars / Pattern
        Properties" from the main menu.




        Use the Plus Sign (+) and Minus Sign (-) hotkeys or the mouse wheel for zooming in and
        out in the Component and Pattern Editors or change scale in the scale box on the
        Instruments toolbar. Go to "View / Pad Numbers /..." to show/hide the pad numbers.



                                                                                  © 2024 Novarm Software
                                                            Creating Component Libraries       99



        You can also choose to display a standard or detailed hint (with pad/hole dimensions) for
        the objects on the design area ("View/ Display Hint").
        Notice that hint is also shown in the bottom-left corner of the screen.

4.1.2   Create/Save library
                                              Create a library

        Press                             / New Library on the Library Manager panel on the left
        side of the screen. In the pop-up dialog box enter the library name, hint, and select the
        library group. You can't save a library outside any of the library groups. We recommend
        creating new libraries in the User Patterns library group offered by default. Press OK.




        A name of your library will appear on the Library Manager panel, User Patterns library
        group becomes selected automatically. Now save the newly created library in a separate
        file.
                                                Save library
                                                       Once a library has been created you need to
                                                       save it in the file. Select "Library / Save"
                                                       from the main menu. We recommend
                                                       saving user libraries in the "Documents/
                                                       DipTrace/My Libraries" folder for Windows,
                                                       which is offered by default, however, you
                                                       can select another location (Mac users
                                                       should save custom libraries in another
                                                       location because you can accidentally lose
                                                       the "My Libraries" folder when uninstalling
                                                       the software).



        DipTrace does not allow saving user libraries in the folder with standard libraries.
        Type in the file name (not shown in DipTrace), and press Save.
        Now we have "My Library (Patterns)" pattern library saved on your computer. Notice that
        file has *.lib extension, meaning that this is a pattern library.
   100       DipTrace Tutorial



4.1.3     Designing a resistor (pattern)
          We will design the first pattern of our library, it is going to be a resistor with 400 mils lead
          spacing. First, let's see, how to create it manually and then move on to the automatic
          generation of the pattern.

4.1.3.1   Manually

          To start, we'll have to name the pattern and fill in the basic description fields. Type "RES
          400" into the Name field, "R" – into the RefDes field and "47kΩ" – into the Value field on
          the Pattern Properties panel. In DipTrace Pattern and Component Editors, you need to
          define just a basic RefDes (not a number index). For example, when you place several
          resistors: R1, R2, R3, etc., the designators will be assigned automatically. Use Windows
          Special Characters Map to find and copy/paste special symbols for Ohms, Farads etc.




          For this pattern, we have used the Free style, but it is faster to use Lines instead. You'll
          see how to use this option in one of the subsequent topics.
                                                   Placing pads
          Please make sure that 0.05-inch grid is selected (change measurement units in the "View
          / Units" main menu item or with Shift+U hotkeys) then minimize the Pattern Properties
          panel. For convenience, you can activate Snap to Grid option in View menu. Select the

          Place Pad tool (      button on the Objects toolbar) and left-click on the design area to
          place two pads like in the picture below. Right-click to exit placement mode.
          Note: for through-hole pads Pattern Editor applies color settings defined in PCB ("View/
          Colors"), that's why they are colored black in our case instead of blue.




                                                                                       © 2024 Novarm Software
                                                    Creating Component Libraries       101




Let's place a dimension line, this will make editing more simple and visual. Select
"Objects / Place Dimension / Horizontal" from the main menu or Place Dimension /
Horizontal tool on the Objects toolbar, left-click in the center of the first pad, then in the
center of the second pad, move the mouse pointer a bit upwards, and click one more time
to place a dimension line. The key points of the object are highlighted when you hover over
them with your mouse. Dimension pointer is attached to the key point, it recounts
parameters automatically, when you move or resize objects.
102      DipTrace Tutorial



      Right-click on the dimension line, and select Properties from the submenu if you want to
      change Layer, Units, Arrow Size etc. Drag and drop the dimension line like a regular
      object if needed.
      Move the pads so that the spacing between them is 0.4 inches.
                                                  Layers
      On the right side of the screen, there is a layer list. All signal and non-signal layers of the
      pattern are displayed here. The panel facilitates layer management: you can show/hide a
      layer on the design area by clicking on the corresponding blue check mark, change layer
      color (a left-click on the color rectangle) and quickly select the layer for object placement.

      Let's short list the layers, press button below the list of layers. In the pop-up, select
      Top Dimensions, Top Silk, Top Comp Outline, Top Mask, Top Paste, Top, Bottom layers
      in the Priority column. You can change the position of the layers in the list by using arrow
      buttons in the Order column, but we'll leave the order of layers as it is. Click OK to close
      the dialog. Pres Show Priority Layers Only to display only previously selected layers in
      the list.




                                                                                 © 2024 Novarm Software
                                                    Creating Component Libraries        103



                                      Pad properties
                                   Pads can have default or custom properties. Default are
                                   applied to all pads of the pattern, custom – only to
                                   selected pad/s. To change default pad settings, select
                                   "Pattern / Standard Pad Properties" from the main
                                   menu or press Standard Pad Properties button on
                                   the Pattern Properties panel. In the pop-up dialog box,
                                   you can change the pad shape: Ellipse, Obround,
                                   Rectangle, D-Shape or Polygon (click Points for
                                   polygonal pad customization). Corner Radius can be
                                   defined for Rectangle pads. You can make round or
                                   obround holes and change the hole diameter (for
                                   Through pads only).

Pad templates allow the user to quickly apply selected parameters in different dialog
boxes of the Pattern Editor and PCB Layout.
Change pad Type to Surface, shape to Rectangle, width to 0.08, height to 0.059, and
corner radius - 20%, then click OK to apply changes. You can also change the
measurement units (mil is 1/1000 inches).




Notice that you can select the side for the surface pads, i.e. place them on the bottom
side of the PCB. Select pad(s), right-click on one of them, and select Change Side from
the submenu. Select the current side for placing new pads and shapes on the Objects
toolbar (drop-down box with the "Top" text) or on the Layers panel.
We need the first pad to have custom pad properties. Right-click on the first pad, and
select Properties from the submenu (if the pad is not highlighted while hovering over it,

you're not in the default mode – right-click on any free spot or press    on the Objects
104     DipTrace Tutorial



      toolbar). In the pop-up Pad <Number> dialog box, select the Type / Dimensions tab, and
      uncheck Use Pattern's Standard Pad Properties box to enable pad’s custom settings.
                                           Polygon pads
      Let's create a hexagonal-shaped pad. The fastest way to achieve that would be selecting
      an appropriate (Polygon1) template, but let's practice a bit. Do not assign any template,
      change type to Through-Hole, shape to Polygon, width and height to 0.09 inch and pad
      hole diameter to 0.04 inch, then press Points to open the Polygon Points dialog box.
      Here you can create regular or custom polygon shapes that are not available in the
      templates drop-down list.
      Select: Regular, 8 Sides, and specify 0.045-inch Radius. Edit custom shapes with the
      table below or visually in the preview field (drag and drop the polygon's points).




      Press OK to apply the polygon shape.
      You can change pad coordinates and angle in the Number / Position tab of this dialog
      box, but do not do that. Press OK. Changes will apply to all selected pads.




                                                                             © 2024 Novarm Software
                                                   Creating Component Libraries      105




There is also another way to create polygon pads, select the Polygon tool on the Drawing
toolbar and draw a shape directly on the design area. Make sure that the shape is on the
signal layer (select Signal from the drop-down list on the Drawing toolbar or on the Layers
Panel prior to drawing or change shape layer in the shape properties dialog box after
placement – right-click on the shape and select Properties from the submenu). When the
shape on the signal layer is ready, right-click it, and select Convert to pad from the
submenu. This options is visible only for Polygon drawing tool.
Please define the following properties for the pads:
the first pad – 0.09x0.09, Through-Hole, Rectangle, hole – Round, diameter – 0.04;
the second pad – 0.09x0.09, Through-Hole, Obround, hole – Round, diameter – 0.04.
Now let's place a silkscreen for this resistor. Click Rectangle button on the Drawing
panel, make sure Top Silk layer is selected. Place a rectangle by clicking in two key
points on the design area. Note that DipTrace displays size parameters while placing a
shape.
106      DipTrace Tutorial




      Now disable the rectangle placement mode (right-click on the free spot or press
      button).
      Silk shape looks a bit small for this pattern. There are several ways to change it: 1) right-
      click on the shape, select Properties, and enter new Width and Height values in the pop-
      up dialog box; 2) drag-and-drop shape's key points (to use this option disable Snap to Grid
      option in the View menu to be able to place shape between the grid points or change the
      grid size). We will use the last method. Let's change the grid size to 0.025 inch with
      Ctrl+Minus Sign hotkeys or with the grid box on the Instruments toolbar, then hover over
      rectangle's key points, and resize the shape (the mouse cursor shows possible
      directions).




                                                                               © 2024 Novarm Software
                                                       Creating Component Libraries        107




Center the pattern by selecting "Edit / Center Pattern" from the main menu or Ctrl+Alt+C.
To show pad numbers, select "View/ Pad Numbers/ Show".
The resistor is ready.




Try to rotate and mirror the first pattern of your library, select "Edit / Rotate Pattern" to
rotate and "Edit / Vertical Flip", "Edit / Horizontal Flip" to mirror it.
   108       DipTrace Tutorial



          Press Save on the Standard toolbar. We will attach 3D model for this resistor in the next
          topic of this tutorial.

4.1.3.2   Attaching a 3D model

          There are three options for attaching a 3D model in DipTrace: you can use a STEP file
          with a 3D model of your component; apply a model from Pattern Generator (works for
          patterns created with this tool); or create a model by component outline (this option works
          best for surface-mount devices since a 3D shape with defined parameters is created to
          mimic an SMD).
          We are going to use the first option now.
          Please make sure that you have downloaded and installed free 3D Models package from
          the DipTrace official website, which contains more than 10 000 3D models for various
          components.
          When a component footprint (pattern) is ready, we can attach a 3D Model. Press
                          button on the Pattern Properties panel. In the pop-up dialog box press All
          Models button and the list of all available 3D models will pop up, 3D models are sorted by
          libraries. We will probably find an appropriate resistor model in the _General library.
          Scroll it down to find the res-10.16_5.1x2.5.step model, left-click it, and it will appear over
          the footprint. Sometimes you might need to map a 3D model respective to the footprint
          (see below).




                                             Mapping a 3D model
          DipTrace automatically places a 3D model to fit the pattern's drawing, however,
          sometimes you may need to adjust 3D model location or the scale. Just enter appropriate
          values into the corresponding fields on the 3D Model Properties section (shift, rotation
          angle, and scale for each axis). In our case, we see that we need to rotate the resistor 90
          degrees and shift it up a bit. Specify 90-degree Z Angle and 0.03 inch Z Shift. You can
          rotate a 3D model by three axes, zoom in / out, and pan 3D Model preview with the mouse
          (left, right and wheel clicks). You can also use side and isometric view buttons for quick


                                                                                     © 2024 Novarm Software
                                                             Creating Component Libraries       109



          change of 3D display perspective or rotate the model by three axis with the wheels at the
          bottom of the window.




          Press OK to attach a 3D model, and then save the pattern library. More details about
          DipTrace 3D Module 253 later in this tutorial and in the DipTrace Help ("Help / Pattern
          Editor Help" from the main menu).

4.1.3.3   Automatically (Pattern Generator)



                                       There's one more way to create a pattern. And now we'll
                                       explore how to make a footprint automatically. But before we
                                       start, let's add a new Pattern project to our library. Make sure
                                       My Library (Patterns) in User Patterns ( or Other Libraries)
                                       group is selected. Go to Pattern menu and select Add New to
                                       "My Library (Patterns)" library.
                                       Next, we have to launch Pattern Generator.To do that select
                                       IPC-7351 from the Style drop-down on Pattern Properties
                                       panel. Once selected, IPC-7315 Pattern Generator button
                                       appears right below. Click it to start the Generator.




          In Pattern Generator we'll make a footprint for HVR37 resistor with copper termination
          wire, using this datasheet.
110      DipTrace Tutorial



      First, select Through Hole device type. Next, choose Axial from the Family list on the left
      side of the dialog.
      Now move on to the central part of the Pattern Generator window. Here we'll have to enter
      all the key parameters. In the SubFamily drop-down select Resistor. Set measuring units
      in the bottommost part of the window to mm.
      Now open the datasheet on page 2 for dimensions. Check Package View images to find
      the required parameters.
      The first cell - Pitch - is colored green, meaning that this value is optional. We are going
      to leave it empty and let DipTrace calculate the value.
      Fill in the remaining Required cells colored red: Amax - 4 mm (this value is not available in
      the datasheet, so we will assume that A = E = resistor diameter), bmin - 0.67 mm, bmax
      - 0.73 mm, Dmax - 12 mm, Emax - 4 mm.
      Basically, those values are enough to generate a footprint with all other parameters set by
      default.
      For more details on customization of parameters for component generation, please see
      Pattern Editor Help manual.




      Press Recalculate button and DipTrace will calculate Pattern Dimensions (see the right-
      hand area of the Generator) based on IPC-7351 Standard, however, you can always
      change the calculated values for the ones recommended by the manufacturer.
      The software has also generated a Standard Pattern Name, you can edit it or opt for using
      a Unique Pattern Name. Let's choose the latter option. Type-in HVR37 and make sure to
      choose a Manufacturer from the list, in our case it's Vishay. Note that Use Unique Pattern
      Name option requires specifying a manufacturer, otherwise the pattern will not be
      generated.


                                                                                © 2024 Novarm Software
                                                Creating Component Libraries     111




Press Recalculate button again and then OK - and DipTrace will generate the pattern
with a 3D model.
   112      DipTrace Tutorial



4.1.4     Designing BGA-144/13x13
4.1.4.1   Manually


          Press                            , then select Add New Pattern to My Library (Patterns)
          Library on the Library Manager panel. This will add an empty pattern to the library. The
          pattern is selected. We will create BGA-144/13x13 (x0.8_10x10) pattern using available
          pattern types and automatic pad numeration. Maximize the Pattern Properties panel and
          type in the pattern's name.




          Press      , if you want to add Name Description and Unique Name for your pattern.
          Change units to mm, press Shift+U hotkeys. Change the Grid size to 0.635 mm.
          Go to "Pattern / Standard Pad Properties" from the main menu and set: Type: Surface,
          Shape: Ellipse, Width: 0.45 mm, Height: 0.45 mm. Press OK to apply changes to
          default pad properties. On the Pattern Properties panel set: Style: Matrix, Columns: 13,
          Rows: 13, X Pad Spacing: 0.8 mm, Y Pad Spacing: 0.8 mm. 13x13 pad matrix and pad
          spacing dimensions appear on the design area.




                                                                                © 2024 Novarm Software
                                                 Creating Component Libraries      113




Click     button on the Pattern Properties panel to prevent accidental changes.
Minimize the Pattern Properties panel. Pan design area if necessary with the right
mouse button or zoom with the mouse wheel. For the BGA-144/13x13 pattern, we should
delete 5x5 rectangle of pads in the center, like in the picture below. Select these pads
using the box selection (move mouse to the upper-left corner, hold down the left mouse
button, move to the bottom-right and release the button), then press Delete key on the
keyboard to delete selected pads.
114     DipTrace Tutorial



      Select "View / Pad Numbers / Show" from the main menu to display pad numbers. Notice
      that our matrix has 1 – 169 numbers with some missing numbers in the center. This is
      not right. BGA pads should be A1, A2, A3 etc. Select all pads (Ctrl+A or a box selection),
      right-click on one of the pads, and choose Pad Array Numbers from the submenu. In the
      pop-up dialog box, select Type: BGA Matrix, keep other settings, and press OK button.




      Now pad numeration is correct.




                                                                             © 2024 Novarm Software
                                                    Creating Component Libraries      115



Notice that for Contour type of numeration the first pad will be the one you right-clicked
on. This allows the user to numerate contour pads (QUAD patterns) starting from the
upper-left, center or any other pad of the pattern.
Now draw a silkscreen for the pattern (like in the picture below), using the tools on the
Drawing toolbar. Change grid size with Ctrl+Plus Sign, Ctrl+Minus Sign or turn it OFF/ON
with F11 hotkey. You can move objects by dragging and dropping them.




BGA pattern is ready. You can attach a 3D model now.
                              Attaching 3D Model from file
In the situations, where there is no exact model in the standard 3D model libraries, you
can use similar ones because usually we don't need 100% precision for a 3D model.
DipTrace allows the user to attach any 3D models in *.3ds, *.wrl, *.step, and *.iges
formats to any footprint. You can download models from the component manufacturers'
websites or create them in any 3D CAD.

Press                button on the Pattern Properties panel.
If you have an appropriate model on your computer click    button, select 3D model file
on your computer, and press Open. You can also enter 3D model's disk address, and
press Load Model button – a 3D model will appear in the preview area. Change 3D
Model Properties in case the model does not correspond exactly to the footprint.
For example, we have decided to take the bga-144_12x12x1.27_17x17.step 3D model
from the BGA library in the standard 3D model package and scale it down a bit to fit the
footprint (see the picture below).
116      DipTrace Tutorial




      Try to enter different values into various fields and you will understand how to adjust
      model location. Press OK. Notice that                  button glows green when the pattern
      has a 3D model attached.
      Save the pattern library (Ctrl+S or Save button on the standard toolbar).
                             Creating 3D Model by component outline
      Another option is to create a 3D model by component outline. This is a particularly handy
      option, especially for SMD components. To place the outline, go to Objects/ Precize
      Shape Placement. In the pop-up set the following parameters: Shape Type - Rectangle;
      Layer - Top Outline; Anchor Point - Center; Height and Width - 11 mm and click Place
      .




                                                                                © 2024 Novarm Software
                                                 Creating Component Libraries    117




Once the outline is placed, press 3D Model button on Component Properties panel. In
the pop-up, select By Component Outline option in the drop-down list at the top of the
window, and set Model Height 1 mm. DipTrace will place a 3D shape, following the
outline of the footprint. Click OK.
   118       DipTrace Tutorial




4.1.4.2   Designing BGA Automatically

          Now we are going to use Pattern Generator to create a BGA footprint automatically.
          Let's create a pattern for a 16-Channel, Current-Input Analog-to-Digital Converter, using
          this datasheet.
          First, we have to add a new Pattern to our library. Make sure My Library (Patterns) in User
          Patterns group is selected. Go to Pattern menu and select Add New to "My Library
          (Patterns)" library.
          Next, launch Pattern Generator - select IPC-7351 from the Style drop-down on Pattern
          Properties panel. Once selected, IPC-7315 Pattern Generator button appears right below.
          Click it to start the Generator.
          Select the Family: Surface Mount/ BGA. Press Clear button if the cells in the Drawing
          Data tab are filled with example values. Here we'll have to enter all the key parameters of
          the device. Set measuring units in the bottommost part of the window to mm.
          Now open the datasheet on page 27 for dimensions.




                                                                                   © 2024 Novarm Software
                                                Creating Component Libraries   119




Check Package View images to find the necessary parameters.
Fill in the Required cells colored red:
Pin Count: D - 8, E - 8.
Pitch: 0.8 mm.
Pin Numbering: A1-B1-C1... in Row.
Terminal Type: Collapsing Ball.
Amax - 1.45 mm.
There's no the required bnom value, so let's enter bmin - 0.41 mm and bmax - 0.51 mm
and let DipTrace calculate the value.
D/E min - 7.9 mm, D/E max - 8.1 mm.
120     DipTrace Tutorial




      Those values are enough to generate a footprint with all other parameters set by default.
      Press Recalculate and the OK button.




      For more details on customization of parameters for component generation, please see
      Pattern Editor Help manual.


                                                                             © 2024 Novarm Software
                                                          Creating Component Libraries     121



        DipTrace has also generated a 3D model of the device. You can check it by clicking 3D
        Model button on Pattern Properties panel.




4.1.5   Designing SOIC-28 pattern
        Now that you are familiar with all the basics, we can practice creating a component
        manually according to a datasheet. It's gonna be the simple Microchip PIC18F24K20
        component with SOIC-28 pattern.
        When you start creating a component from a scratch, and you don't have an appropriate
        pattern, always start from the pattern creation and then proceed to component's symbol.
        We start from making a pattern. Add a new pattern to the library ("Pattern / Add New
        Pattern To "My Library (Patterns)" Library" from the main menu), then enter the name –
        "SOIC-28" and RefDes – "IC".
        Select Style: Lines on the Pattern Properties panel, and set Number of Pads: 28. In
        our case pads are way too small for this pattern.
122      DipTrace Tutorial




      We should define correct pad spacing, line spacing, and pad settings. You can find SOIC-
      28 (7.50 mm) footprint dimensions on the Microchip package specifications PDF at the
      Microchip's website (page 197 in the latest revision at the moment of writing this tutorial)
      or you can take the SOIC-28 pattern from standard DipTrace libraries as an example.
      Define default pad settings (press Standard Pad Properties button to open the dialog
      box): Type: Surface, Shape: Rectangle, Width: 0.6 mm, Height: 2 mm. Press OK.
      Then specify Pad Spacing: 1.27 mm and Line Spacing: 9.4 mm on the Pattern
      Properties panel.




                                                                              © 2024 Novarm Software
                                                    Creating Component Libraries      123




Pad numbers are correct, we don't need to renumber them. Lock pattern properties to
avoid accidental changes. Draw a silkscreen (like in the picture below), using line/polyline
and arc tools found on the Drawing toolbar (turn ON/OFF the grid, change grid size, and
hide Pattern Properties panel if you need).




Datasheet requires the pattern to be rotated 90 degrees – select "Edit / Rotate Pattern"
from the main menu or Ctrl+Alt+R. Attach soic-28_300mil.step 3D model from the
_General 3D Models category.
   124      DipTrace Tutorial



         We will attach this pattern to PIC18F24K20 component, which we will create in the
         Component Editor 147 later in this tutorial.
         Remember that you can easily create the same pattern and 3D model using Pattern
         Generator.
         Save this library and close the Pattern Editor.

4.2      Designing a component library
         Open DipTrace Component Editor, i.e. go to "Start / All Programs / DipTrace / Component
         Editor" in Windows or use DipTrace Launcher on MacOS.
         Component Editor allows the user to create / edit and manage components and libraries
         in DipTrace. Component Editor allows attaching component's pattern to the symbol, but it
         doesn't allow pattern editing – use the Pattern Editor 97 .

4.2.1    Customizing Component Editor
         Customizing Component Editor is almost the same as customizing the Pattern Editor.
         Select "View / Display Origin" from the main menu to show a zero point and X, Y axes (or
         press F1) if you can't see the origin point. Component Properties panel in the upper-left
         side of the design area can be minimized or hidden using the buttons on the panel and in
         the main menu.
         On the Component Properties panel, you can define the symbol style (4 styles available):
         Free (without any specific properties), 2 sides, IC-2 sides, IC-4 sides. The only difference
         between "2 sides" and "IC-2 sides" is a rectangle shape (IC Symbol) for the last one.
         The fields that might look unfamiliar are the Part Type field and the Part field. The part
         type can be Normal, Power and GND or Net Port. A component can contain only one
         Power and GND part (if you prefer to hide all power nets of your schematic, then all power
         pins should be in this part). Net Port is a single-part component, we use net ports to
         connect wires logically. Net ports are usually applied to Ground or Power nets and
         schematics with flexible structure (we will design such component later).
         The Part field indicates the current part of a multi-part component.




                                                                                  © 2024 Novarm Software
                                                    Creating Component Libraries      125




If you need to define pin settings before creating a component, select "Objects / Pin
Placement Setup" from the main menu. We will not change these parameters now, but
notice that length and X, Y spacing should be divisible by the grid step to create all key
points on the grid. We recommend using 0.1-inch grid.
   126      DipTrace Tutorial



4.2.2    Designing a resistor (component)
         Like in the Pattern Editor, first, we need to create a new library because DipTrace won't let
         you add new components to the standard libraries.
                                               Create library

         Press                    , then select New Library, in the pop-up dialog box enter the
         library name, hint, and select the library group. We recommend saving this library in the
         User Components library group, offered by default. Press OK.




         We will design a resistor using the Free style and visual pin placement. Define component
         name, RefDes, and value "47kΩ", use the corresponding fields on the Component
         Properties panel. Save the Library on your computer: press the Save button on the
         Standard toolbar, select location (except the folder with standard libraries), enter a file
         name, and press Save.
         After specifying these attributes, please minimize the panel, using the arrow in its upper-
         left corner.




                                                                                  © 2024 Novarm Software
                                                    Creating Component Libraries       127




                                        Place pins

Select the Place Pin tool on the Objects toolbar (      button), then move the mouse
cursor to the design area, and place two pins with left clicks. Rotate one pin 180 degrees,
(select it, and press R twice), make sure that pins are placed by the 0.1-inch grid. Now
change the grid to 0.05 inch, select the Rectangle tool, and place graphics for the
resistor. DipTrace will show the dimensions of the shape while you are placing it.




Notice that you can move pin(s) using the drag-and-drop method. If you want to move or
rotate several pins, select them first.
You can use the Align Objects tool for automatically placing several objects in a row or
column. Select objects on the design area, then select Align Objects from the submenu
to set up alignment direction and spacing.
                                      Attach pattern
The symbol of the resistor is ready, but the component is not ready yet. We should attach
a pattern to this symbol, otherwise, we will not be able to generate the circuit board from
the schematic with this resistor. Select "Component / Attached Pattern" from the main
menu or press Pattern on the Component Properties panel. We need to connect this
symbol drawing with a pattern drawing created before in the Pattern Editor. Select User
Patterns (see "Designing Resistor (pattern)" 100 topic of this tutorial). There should be
only one library in that group (My Library (Patterns)). Select it, and select RES 400 pattern
that we've created earlier.
Notice that DipTrace automatically creates pin-to-pad connections by numbers. You can
review and reassign them if necessary. Connections should be like in the picture below.
   128      DipTrace Tutorial



         To create or redefine pin-to-pad connections, hover over the pin, left-click it, then move
         the mouse to the corresponding pad, and left-click it to connect them. To delete a
         connection, right-click on the pin or pad, and select Disconnect pin from pad item from
         the submenu. When you move the cursor over one of connected pins/pads, both are
         highlighted. If a component is more complex, use the Pin to Pad table (select pin and
         type in the corresponding pad number into the Number field below).




         Pin numbers (therefore component's pin to pad connections) can be changed with the
         Pin Manager (select "Component /Pin Manager" from the main menu) or in the Pin
         Properties dialog box.
         If the current pattern is wrong, you can undo to the previous one or delete it by pressing
         the corresponding buttons (Previous Pattern, New Pattern). Change pattern side with the
         corresponding drop-down list.

         All components of the library are in the left part of the dialog box, this allows the user to
         attach patterns to several components at a time. However, we don't need this now. Our
         Library has only one component.
         Everything looks good. Press OK to close the Attached Pattern dialog box. The resistor is
         ready and contains both schematic part and PCB pattern with 3D Model.
         Save the component library.
         Notice that this is the file with *.eli extension, this means that this is component library file.

4.2.3    Designing a capacitor
         Select "Component / Add New to "My Library" from the main menu to add a new
         component to the library.


                                                                                      © 2024 Novarm Software
                                                   Creating Component Libraries       129



We will design a capacitor using the 2 sides component style (Style box on the
Component Properties panel); type in the component's name "CAP", RefDes – "C", Value
– "2µF" . Change component width and pin spacing to 0.1 inch, left and right pins to "1".




Now please minimize the Component Properties panel, change the grid size to 0.0125
inch, and draw the capacitor's graphics, using three lines and one arc (it's convenient to
use Start-End-Radius mode, Counter-Clockwise for placing an arc in this case).
130     DipTrace Tutorial




      Show pin names for the component symbol, select pins (or select all using Ctrl+A
      hotkeys), right-click on one of them, and choose Pin Properties from the submenu. In
      the Pin Properties dialog box, check the Show Name box, and press OK.




                                                                          © 2024 Novarm Software
                                                   Creating Component Libraries       131



Now you can see the pin names but they are in wrong places (probably overlaying each
other) and you need to move them. Select "View / Move Text Tool" from the main menu or
press F10, then hover over the pin names, and drag them to new locations one-by-one,
then right-click to return to the Default mode.
Notice that you can use such method to move pin names, numbers and part attributes in
Schematic.




You can show inversion line in the pin name, just hover over the pin with your mouse,
right-click, and select Pin Name from the submenu, type in "normal ~invert" text, and
press OK, then move the pin name using the move tool (F10 hotkey). The Tilde Symbol
(~) in the pin name starts and ends the inversion, so using it you can define the inversion
for separate parts (signals) in the pin names.
132     DipTrace Tutorial




      You probably don’t need to see the pin names for simple passive components like
      capacitors.
      Select "Component / Pin Manager" from the main menu to open the Pin Manager dialog
      box and change "normal ~invert" pin name back to "1". Now hide pin names for both pins:
      select pin row in the table, and uncheck Show Name box at the bottom of the dialog box.
      Close the Pin Manager.
      Notice that you can change pin numbers (i.e. related pads), coordinates, length, type, and
      electric type of pins in the Pin Manager dialog box.




                                                                             © 2024 Novarm Software
                                                  Creating Component Libraries     133



In the Component Editor you can set individual show/hide pin numbers settings for current
component ("Component / Pin Numbers" from the main menu) and common program
settings (the same as in the Schematic) in "View / Pin Numbers / Show" from the main
menu.
Let's show capacitor's pin numbers. If you need to move pin numbers, use the move tool (
F10).




The next step is attaching a pattern to the capacitor. Open Component Properties panel
and press Pattern button. We did not create a pattern drawing for this component
because we will take an appropriate pattern from the standard DipTrace libraries. Select
the Patterns library group, then select Cap Electrolytic Radial library below, and
CAPPRD500W60D1050H1450 from the list of patterns. You can use the search filters.
Pin-to-pad connections assigned automatically are good.
   134     DipTrace Tutorial




         Press OK. The capacitor is ready. Save the changes.

4.2.4    Designing VCC and GND symbols
         In this part, we will practice in creating net ports by designing VCC and GND symbols.
                                                   VCC

         Press                           , then select Add New Component to "My Library", type
         in "VCC" in the Name field on the Component Properties panel, and select Net Port in
         the Part Type drop-down list.




                                                                               © 2024 Novarm Software
                                                      Creating Component Libraries        135




Minimize the Component Properties panel, then press the Place Pin                button on the
Objects toolbar and place a single pin, rotate it vertically (select it, and press R hotkey).
Select the line tool on the Drawing toolbar and draw a line like in the picture below.
136      DipTrace Tutorial




      Hide the pin number if it is visible, select "Component / Pin Numbers / Hide" from the main
      menu. Pin number for the single-pin component looks kind of weird. VCC symbol is ready.
                                                 GND
      Now add one more component (Ctrl+Ins hotkeys), and create a GND symbol the same
      way like the VCC symbol.
      Select "Edit / Center Symbol" or press Ctrl+Alt+C for GND because in our case its origin
      is not in the center, so you have to center it to make component's origin hidden by default
      in the Schematic. Use 0.012-inch grid to draw a GND symbol's graphics.




                                                                              © 2024 Novarm Software
                                                          Creating Component Libraries      137




        Notice that net ports do not need patterns. This special type of components is used only
        in Schematic to connect wires without visual connections, net ports do not exist on the
        circuit board.
        Save the library file.

4.2.5   Designing a multi-part component
        Despite being represented as a single physical package on the circuit board, some
        electronic components has multi-part schematic symbols. Building a multi-part schematic
        symbol involves a bit different technique.
                                           Creating a symbol
        We will design a simple multi-part component with four "And-Not" symbols, a power part,
        and attach DIP-14 pattern, which is available in the standard libraries.
        Add a new component to the library, i.e. select "Component / Add New To "My Library"
        Library" from the main menu. Enter the name and Reference Designator.
138     DipTrace Tutorial




                                           Creating parts
      DipTrace allows for creating multi-part components using separate or similar parts. The
      only difference between these is that similar parts share the same layout of pins and
      symbol drawing, except the pin numbers (i.e. related pads). We will proceed with similar
      parts, which, by the way, can be grouped later in the Schematic.
      Each part of the multi-part component can be Normal, Power and Ground, or Net Port.
      Power parts and power nets can be hidden in the schematic capture. Only one power part
      per component is used.
      We will design a component with 4 similar AndNot gates (parts) and one power part that
      has a different layout (created separately from the similar parts). Select "Component /
      Create Similar Parts" from the main menu, type "4" in the pop-up dialog box, and press
      OK to apply. Tabs with the part names have appeared in the bottom-left of the design
      area (like sheets in the Schematic).
      Similar parts are created based on the currently selected part. They share the same
      name and layout of pins.




                                                                            © 2024 Novarm Software
                                                     Creating Component Libraries        139




Now you can see the following 4 parts: Part 1 (1), Part 1 (2), Part 1 (3), and Part 1 (4). All
similar parts have the same part name. Change it to "AN" in the Part field on the
Component Properties panel.
The power part for the component is missing. Power part has a symbol different from the
logic gates, this is why we will create it as a separate part (not in the "AN" group of similar
parts). Select "Component / Add New Part" from the main menu to add a single part to the
component, select new part tab (Part 1) in the bottom-left of the design area, and rename
it to "PWR".
Notice that new part is a separate part and does not belong to "AN" group.
Start designing a component with the power part. On the Component Properties panel
specify Style: IC - 2 sides, Width: 0.3 inch, Height: 0.25 in, Left Pins: 2, Right Pins: 0,
then select Power and Gnd from the Part Type drop-down list. Make general component
pin numbers visible ("View / Pin Numbers / Show" from the main menu), if they are
hidden.
140     DipTrace Tutorial




      Press the Pin Manager button on the Component Properties panel, and change pin
      names to "VCC" and "GND", pin numbers to "14" and "7", electric type to Power, the
      Show Name box should be checked for both pins. Notice that you can change Type,
      Show Name and Length parameters for multiple pins at the same time.




      Pin Manager dialog box itself and the width of the rows are resizable. These settings are
      saved when you close the program.



                                                                             © 2024 Novarm Software
                                                     Creating Component Libraries       141



Now press OK to close the Pin Manager dialog box. Then minimize the Component
Properties panel and see the first ready part of the component.




Design the other parts of the multi-part component: select one of the AN parts, maximize
the Component Properties panel, and define the following parameters: Style: IC-2
sides, Width: 0.2 in, Height: 0.25 in, Left Pins: 2, Right pins: 1. Now minimize the
Component Properties panel again.

Select the text tool on the drawing toolbar (      button), hover over the symbol, left-click,
and type "&" character, then right-click to place the text and return to the default mode
(see the picture below). Move the text if you need.
142      DipTrace Tutorial




      Right pin of a typical "And - Not" (Not And) part should be inverted or "Dot" type. Right-click
      on the third pin, select Pin Properties from the submenu, in the pop-up dialog box
      specify Type: Dot. Click OK to apply changes and close the dialog box.
      Notice that you don’t need to draw another AN parts of the component if they were created
      as a group of similar parts, they will inherit the layout of the first part of the "AN" group.




                                                                                © 2024 Novarm Software
                                                    Creating Component Libraries       143




Select AN (3) or AN (4) part just to make sure that parts are the same. All parts in the
group are absolutely identical, but require pin renumbering.
                                       Pin Manager
Select "Component / Pin Manager" from the main menu. In the Pin Manager dialog box
select part (using the drop-down list in the upper-right), define pin numbers, then select
next part and so on, until you define pin numbers for all AN parts. Use the Down arrow
button or Enter to quickly switch to the next pin when you're typing in the Number or Name
fields.
Don't forget that pin #7 is used in the GND part, therefore you should skip it while
renumbering pins of the functional parts, going from pin #6 straight to the pin #8.
Please set correct Electric type (2 input pins and one output pin) for one of the parts and
the other parts will inherit this automatically. Click OK.
144      DipTrace Tutorial




      The next step is attaching a related pattern to the multi-part component. Press the
      Pattern button on the Component Properties panel. In the Attached pattern dialog box
      select the Patterns library group (library group with all standard pattern libraries), then
      select DIP Pitch 2.54mm library and DIP793W45P254L1955H393Q14 pattern in there
      (use filters if you like).
      Notice that you don’t need to specify pin-to-pad connections, they have been assigned
      automatically and should be correct, because we've specified correct pin numbers in the
      Pin Manager (this is why pin number array was not straight).
      Select different parts (drop-down list below the preview field) and visually check
      connections to ensure that they are all right. Press OK to attach pattern and close this
      dialog box.




                                                                               © 2024 Novarm Software
                                                                Creating Component Libraries   145




        Multi-part component is ready. Save the library file.

4.2.6   Using additional fields
        Name, RefDes, Value, Manufacturer, and Datasheet are default component fields in the
        DipTrace, usually, these are what most users will ever need, but sometimes additional
        description or other information is necessary. In this case, you can use additional fields.
        Select "Component / Default Additional Fields" from the main menu. This dialog box
        allows you to specify default additional fields and their values. For example, we need to
        have the link for one more datasheet online: type in "Datasheet #2" into the Name box,
        specify Type: Link, enter the web address, and click Add button. Now this additional field
        will apply only to all new components that you will create. If you want to add this
        additional field to all existing and future components in this library, then press the Add to
        All button.
146      DipTrace Tutorial




      Now all components in this library will have this additional field with the datasheet link.

      Close Default Additional Fields dialog box. Select                      , then select
      Add New Component to "My Library" or press Ctrl+Ins. Click Additional fields button
      to see the list of all additional fields for a new component.




                                                                                 © 2024 Novarm Software
                                                          Creating Component Libraries      147




        It has the added Datasheet field.
        Now make sure that Untitled component is selected on the Library Manager panel, right-
        click it, and select Delete Components or simply press Ctrl+Del to delete it. You can
        also select several components and delete them at a time.
        You can assign custom additional fields to the component, just press the Additional
        Fields button on the Component Properties panel and practice a bit.
                                     Additional fields in Schematic
        Right-click on the component with links to the datasheets on the design area in DipTrace
        Schematic, and select Links from the right-click submenu, the web browser will pop up
        automatically. You can assign additional fields as component markings for all or only for
        selected components in the DipTrace Schematic.

4.2.7   Designing PIC18F24K20
        In this part of the Tutorial we will create a PIC18F24K20 component according to the
        datasheet and attach SOIC-28 pattern that was created before 121 .
        Go to the Microchip website and search "PIC18F24K20", then select "Download
        datasheet". Or use the direct link (however we don't guarantee that it works at the
        moment you read this tutorial). Go to "Pin Diagrams", the first diagram is what we need.
        In the DipTrace Component Editor and add a new component (Ctrl+Insert), type in the
        name "PIC18F24K20", RefDes and manufacturer, then specify Style: IC - 2 sides, Left
        Pins: 14, Right Pins: 14.
148     DipTrace Tutorial




      DipTrace allows the user to enter pin names manually or import them from external
      BSDM file ("Library / Import / Add BSDL Pinlist" from the main menu). We will do this
      manually. Press the Pin Manager button on the Component Properties panel and enter
      pin names from the pin diagram in the datasheet found online. Notice that you can resize
      the pin manager panel and change the width of the columns (we made the Name column
      wider to see the full pin names). Also when you entered the pin name, just press Enter to
      switch to the next pin name easily.




                                                                            © 2024 Novarm Software
                                                    Creating Component Libraries       149




After entering all pin names, specify electric types for pins, and check the Show Name
box for all pins of the component. Notice that you can select as many rows as you need
and change certain properties at a time. Press OK.
Our symbol has inappropriate look, width is too small with pin names overlaying.




On the Component Properties panel change width to 1.9 inches and height to 2 inches.
Pin names still overlay a bit, but we will regroup pins which will probably fix this. We made
an IC a bit bigger because it will make it easier to do the pin regrouping. Change grid to
150      DipTrace Tutorial



      0.1 inch and place pins by this grid (select all pins, right-click, and select Snap to Grid
      from the submenu).




                                      Make buses (Group pins)
      We need to group pins logically. First, we will make the busses – select "Component /
      Make Buses from Pins" from the main menu. This feature allows the user to extract
      buses based on the pin names and group pins by buses. In the pop-up dialog box, you
      can define possible bus dividers. By default, only "/" is selected and it is OK for the current
      component, however, some manufacturers use different dividers.
      Press Extract button and you will see available buses and number of pins for each of
      them. Select RA, RB, and RC buses using Ctrl key. Change Bus to Bus spacing to 1.3
      inches, because pin names are quite long.




                                                                                © 2024 Novarm Software
                                                Creating Component Libraries    151




Press Make button to make the buses and close the dialog box. DipTrace sorts wires by
buses to the left from the IC symbol.
152      DipTrace Tutorial



      There are some pins that do not belong to the selected buses (4 pins left on the symbol).
      Select them, use Ctrl and box selection, then move pins away from the symbol, for
      example, to the bottom, because we need to place the busses first.




      Place buses to the IC rectangle like in the picture below. Use box selection to select a
      bus, then drag it. Press Shift+R to rotate the bus and Shift+F to flip pins, or select these
      commands from the pin submenu (right-click on one of bus pins). Move the rest of pins to
      the IC rectangle (press R to rotate selected object/pin).




                                                                              © 2024 Novarm Software
                                                   Creating Component Libraries       153




Sometimes you need to place pins by electric type, select "View / Pin Colors by EType"
from the main menu and the software assigns different colors for pins of different electric
types.

Press      button on the Component Properties panel to lock properties.
The final step is attaching SOIC-28 pattern to the component. Press the Pattern button
on the Component Properties panel and select SOIC-28 pattern from My library (we've
created it before 121 ). Select your library group, then select My Library (Patterns) and
SOIC-28 from the list below. All pin names and pin numbers are already there. You can
check pin to pad connections in the table. We don't need to change anything. Just press
OK.
   154      DipTrace Tutorial




         PIC18F24K20 component is ready! Save the library.

4.2.8    SPICE settings
         With DipTrace you can export schematics into LT Spice to simulate it and see how the
         circuit works. We will review the simulation step later, for now, we need to define correct
         SPICE settings for the component, otherwise, the Spice simulation for this component will
         not work. Now we will specify that our CAP component is a capacitor with some value, so
         it will work in the SPICE netlist. Select CAP on the Library Manager, then select
         "Component / Spice Settings" from the main menu. Set: Model Type: Capacitor, then
         double click in the Parameters table in the Value cell (the value reads "1uF" text) and
         enter a new value – "23 µF" (DipTrace supports Unicode characters). Press Enter or just
         move focus to another field.
         In the Template field, you can see how this part looks in the SPICE netlist language. In
         our case, pin-to-signal map is correct, however, if you need to edit it, enter signal names
         into the table on the left side of the Spice Settings dialog box. The list of available signals
         is right below that table.




                                                                                     © 2024 Novarm Software
                                                           Creating Component Libraries          155




        Capacitor is a very simple component, we don't need specific text file model to let the
        simulation software know how this component works (model type and capacity is just
        fine). However, for transistors, you can load models from external files (usually SPICE
        models are available on the manufacturers' websites) or enter model text manually if you
        know how to do that (see SPICE Language documentation for details). Also, there is a
        SubSkt Model Type, which allows the user to enter/load model of almost any part as a
        program.
        Press Get Spice Model from Library button to load existing Spice settings from another
        DipTrace component.
        Notice that this dialog box is also available in the Schematic Capture, you can define
        Spice settings after completing or while drawing the schematic.
        Library design is ready. Click OK to apply changes and close the Spice settings. Save the
        library file.

4.2.9   Library verification
        It is very important to verify library for the most common types of errors. We've
        investigated the work of our library designers and added an automatic error verification to
        the Component Editor.
        In the Component Editor select "Library / Check "My Library" Library" from the main menu.
        In this dialog box, you can see the total number of components/parts/pins in your library
        and all possible errors.
156      DipTrace Tutorial




      The following errors can be found automatically:
      1. Components without patterns – search components without patterns. Keep in mind that
      some components may have only schematic symbol intentionally.
      2. Similar components – search components with similar names. Notice that library
      should be sorted ("Library / Sort Components in <current library>" from the main menu) to
      enable correct verification.
      3. Similar pin numbers – two or more pins have similar numbers (connected to the same
      pad). This is probably a mistake in the component, please press the       button and check
      pin numbers for the listed component.
      4. Shorted pins – pins are shorted by internal pad-to-pad connections.
      5. Unconnected pins – pins do not have the corresponding pattern pads. It's not always an
      error.
      6. Unconnected pads – some pads of the pattern are not used (no corresponding pins). It
      is not always an error.
      7. Through pads without holes – verifies components for the through pads without a hole.
      In the majority of cases this is a mistake in SMD pattern, please check if pads do really
      have the surface type selected.
      8. Undefined pins – some pins have "Undefined" electric property.
      9. Pin superposition - some pins superimpose on the symbol, in the majority of cases
      this is a mistake made while placing the pins.

      To see details (list of components and pins) press        button next to the corresponding
      mistake. You can save the list of errors can as a text file.
      Save changes and close the Component Editor.



                                                                               © 2024 Novarm Software
                                                            Creating Component Libraries       157



4.2.10 Placing parts
                                                Schematic
       Open the Schematic module, i.e. go to "Start / All Programs / DipTrace / Schematic" in
       the Windows OS or use the DipTrace Launcher if working on MacOS. Select My Library
       from the User Libraries library group. Place a couple of resistors and capacitors to the
       design area. Just left-click on the component on the Place Component panel and left-
       click on the design area. If the origin is shown, press F1 to hide it. Usually, you don't need
       the origin point for designing schematic.
       Notice that you can place components using "Objects / Place Component" dialog box or

       with the      button on the Objects toolbar.
       Notice that the colors of components, selections, etc., depend on the color template and
       user preferences.
                                   Multi-part component placement
                            Select multipart component (ANdNot4X). DipTrace always shows that
                            the current component is multi-part or a net port in the symbol
                            preview field on the Place Component panel (<the number of parts>
                            or "Net Port" text). We have created AndNot 4X with four similar parts
                            and a power part. You can place all parts as a single item or each

                            part separately, use the                         button. Switch to
                            AN(4) to place each component part one-by-one or PWR to place
                            only the power part. If Auto PWR/GND item is checked, component's
                            power part automatically appears on the design area when you place
                            the first logic part of the component.
                            Select AN(4), leave Auto PWR/GND checked, and place AndNot4X
                            component part by part. DipTrace automatically selects the next part
                            from the part group and places the power symbol for the component.

       Notice that program will automatically switch to the next part when all parts had been
       placed. Make sure you place parts only with RefDes from 1.1 to 1.4, like in the picture
       below.
158     DipTrace Tutorial




                                       As you can see the similar parts of the multipart
                                       component are already grouped inside the part selection
                                       drop-down list. Deactivate "View / Group Similar Parts"
                                       item in the main menu to ungroup parts. If this item is
                                       checked, all logic parts of the component (AN(4) in this
                                       case) will be grouped inside the All Parts pop-up menu.
                                       If unchecked, you will be able to select and place each
                                       AN part separately.

                                     Connection via net ports
      Net Ports are single-part components used to establish connection between nets without
      wires. DipTrace Standard Libraries contain all the most popular net ports, but you can
      also create new ones in the Component Editor. Net Port components have no patterns
      attached since these elements are used only in Schematic to connect wires without visual
      connections, and do not exist on the circuit board. Net ports are usually applied to Ground
      or Power nets and schematics with flexible structure.

      Let's practice using Net Ports. Make sure that you have two complete AndNot
      components on the design area (IC1 and IC2) with two power symbols. Now we'll try
      using the net ports. Select VCC and GND net port symbols from the library, and place two
      of each to the schematic. Connect pins like in the picture below.
      Notice that two wires connected to the same pins of the same-type net port are connected
      to a single net automatically.




                                                                             © 2024 Novarm Software
                                                   Creating Component Libraries          159




To rename net which connects VCC pins, right-click on the wire, and select the first item
from the submenu or right-click on the pin, and select the Net Name.
Notice that you can change part names directly in Schematic (on the Component
Properties dialog box).
Schematic allows the user to:
1) Connect pins to nets without wires (right-click on the pin, select Add to Net, then
select net, check Connect without wire, and press OK);
2) Merge nets by name (check Connect Nets by Name check box in the Net Properties
dialog box);
3) Connect pins to the net with similar name automatically (check Connect Net to Pins
by Name checkbox in the Net Properties dialog box). The last method is the fastest way
to connect VCC, GND (if you plan to hide power nets and parts), CLK, etc. More
information later 168 in this tutorial. Close the Schematic. Do not save the changes.
                                       PCB Layout
Open DipTrace PCB Layout module, i.e., go to "Start / All Programs / DipTrace / PCB
Layout" on Windows or use the DipTrace Launcher on MacOS.
As you already know, correct component always includes at least a schematic symbol
(for Schematic) and attached pattern (for PCB Layout). Schematic works only with
symbols, while PCB Layout allows to select component libraries and place component's
patterns on the board. If you have selected component library and there are components
without attached patterns, you can not place them on the board. Notice that there is the
Patterns library group for convenience, which allows the user to place patterns as
separate entities (no schematic symbols attached).
160      DipTrace Tutorial



      Select User Patterns library group and My Libraries (Patterns) library. You will see that
      all the patterns that we have created during the lessons of this tutorial are available here.
      Now select My Library from the User Components library group. As you remember, we
      did not attach patterns only to net ports, therefore we can not place them on the circuit
      board in the PCB Layout. All other components work just fine because they all have
      attached patterns.
      Place some components of the library to the design area, excluding the VCC and GND
      (select component on the Place Component panel and left-click on the design area to
      place it), then return to My Library (Patterns) from the User Patterns library group and
      place BGA-144/13x13 pattern, which we did not attach to any of the symbols, therefore it
      is not available in the component library.
      Change common marking settings to show RefDes and Name ("View / Component
      Markings; in Show column check RefDes and Name; Align - Auto). For individual
      customizations, right-click on the component, select Properties, select the Markings tab.
      Select Bottom Side in the drop-down list on the Objects toolbar if you want to place
      components on the opposite side of the board. For existing components, you can change
      side with the right-click submenu. For example, the R3 resistor is on the bottom side (see
      the picture below).




      You can change pad properties for a separate pad or entire pattern directly in the PCB
      Layout. Let's change one of the resistor pads. Hover over the pad you want to change (it
      should be highlighted), right-click it, and select Pad Properties from the submenu. In the
      pop-up dialog box uncheck the Use Pattern's Standard Pad Properties checkbox for
      custom pad settings or press Pattern's Standard Pad Properties button to change
      default pad settings for the pattern. To edit pattern pad properties, right-click on a pattern
      (not a pad) and select Standard Pad Properties from the submenu.



                                                                                 © 2024 Novarm Software
                                                               Creating Component Libraries         161




        Notice that if pattern's origin is different from the pattern's center position, the software will
        show it while placing that pattern.
        You can show/hide the pattern origin for all selected components: right-click one of them,
        and select Pattern Origin from the submenu. Try to rotate different components and you
        will see that the pattern origin is actually the center of rotation. When hovering over the
        pattern you will see the coordinates of the pattern, which are actually the coordinates of
        the pattern's origin.


5       Other features and tools
        This part of the tutorial includes the description of important DipTrace features not
        reviewed above. We consider that the reader already knows how to accomplish basic
        tasks in DipTrace. Therefore, we can move on to more complex stuff.

5.1     Connecting
5.1.1   Buses and bus connectors
        Now we'll learn how to use buses and connect sheets with bus connectors in the
        Schematic. You can work with the circuit from the previous subsection of this tutorial or
        create a new schematic with random components for practicing.
                                                 Create a bus

        Select "Objects / Circuit / Place Bus" from the main menu or press         button on the
        Objects toolbar, then draw a bus line on the design area by defining its key points. Right-
        click, and select Enter to finish bus placement. Right-click on a free space to switch to
162     DipTrace Tutorial



      the Default mode. Hover over some pin with the mouse, left-click it, and move the mouse
      pointer to the bus, and left-click again to create a wire.
      In the pop-up dialog box, you can define a name of a new net or connect a wire to one of
      existing nets (which are already connected to that bus).




      We did not connect the wire to the existing net. This is why we have seven separate
      wires-nets (Net 0 – Net 6) not connected to each other via the bus. Fortunately, you can
      change the wire-to-bus connections at any moment, just move the mouse cursor to the
      wire segment connected to the bus, right-click, and select Bus Connection from the
      submenu.




                                                                             © 2024 Novarm Software
                                                        Other features and tools    163




In the pop-up dialog box connect Net 6 to Net 2 (select Net 2 from the list of the bus
wires). Now there is no Net 6 anymore. We have a single Net 2 connected via the bus.




Add a new sheet to the schematic, select "Edit / Add Sheet" from the main menu or
164      DipTrace Tutorial



      press Ctrl+Ins hotkeys. You can see the list of sheets as tabs at the bottom-left corner of
      the design area. Select Sheet 2. The multi-sheet and hierarchical structure 218 is
      described later in the corresponding section of this tutorial.




      You can rename, move, delete, or insert new schematic sheets, right-click on the sheet in
      bottom-left of the design area and select appropriate action from the submenu.
                                           Bus connector

      Press         button on the Objects toolbar and place a bus connector on the Sheet 2 (it
      should have "Port 0" name), then select Sheet 1, and place one more bus connector there
      (it will be named "Port 1" automatically). Now connect the existing bus to the Port 1
      connector: select the bus tool, left-click on the bus and draw the line to the bus connector
      (blue circle in the center of the connector) and left-click it to finalize.
      Notice that bus connector glows green if the bus is properly connected to it, blue circle
      means that there is no connection.




                                                                              © 2024 Novarm Software
                                                           Other features and tools    165




Notice that two bus connectors on different sheets are still unconnected (they should
have the same name in order to be connected).
Rename Port 1, hover over it with the mouse cursor, right-click it, select the first item from
the submenu, and rename bus connector to "Port 0" (as you remember we've placed
"Port 0" on the Sheet 2). Press OK. You can see that the a has appeared around the
port's name. That means that this bus connector is connected to another bus connector.
In our case, the connector from the Sheet 1 is connected to the connector on the Sheet 2.
Notice that designer can connect more than two bus connectors by defining the same
names to all of them.
166      DipTrace Tutorial




      Select Sheet 2, and create a bus connected to the Port 0.
      Notice that the name of the bus on this sheet is the same as on the first sheet, i.e. this is
      a common bus. Now you can place random electronic components on the second sheet
      (for example AD1856RZ from IC Data Acq DAC library) and connect their pins to the nets
      on the first sheet via the bus.




                                                                                © 2024 Novarm Software
                                                                Other features and tools   167




5.1.2   Net ports
        We tried using single-pin net ports before 157 in order to create VCC and GND
        connections. This is the most common application of such components in real life, but
        sometimes multi-pin net port is a more comfortable design solution.
        Make sure there are unconnected pins on the Sheet 2. Select the Net Ports library from
        the Components library group on the Place Component panel, find Bus_Port_Out 8
        component, and place it on the design area.
        Make connections from the component pins to the pins of the Bus Port, then position
        Bus_Port_Out8 component on the Sheet 1, and connect some nets to it. Notice that net
        names connected to the same pins of Bus Port 8 on Sheet 1 and Sheet 2 are the same, i.
        e. all wires connected to pin 1 of the Bus_Port 8 are connected to a single net, the same
        with other pins. You can connect or disconnect ports (i.e. change schematic structure) by
        renaming them.
   168     DipTrace Tutorial




5.1.3    Connecting without wires
         As you already know, DipTrace allows the user to connect pins visually (wires, buses)
         and logically (without wires, by name, with net ports).
                                     Connecting pins without wires
         You can connect pins logically without wires. In this case, pins do not depend on the sheet
         or part location.
         Hover over an unconnected pin with the mouse, right-click it, and select Add to Net from
         the submenu. In the pop-up dialog box select a net from the drop-down list, and check
         Connect without Wire checkbox, then press OK. In the picture below you can see two
         pins connected without wires.




                                                                                © 2024 Novarm Software
                                                       Other features and tools    169




                              Connecting pins by name
Now find a blank spot on the design area where we will try to connect pins to a net by
name. Place a single GND symbol from the Net Ports library, and create a small wire
from the GND's pin. Move the mouse a bit upwards, and press Enter, like in the picture
below, to create a wire segment. Now right-click on the wire segment connected to the
GND net port, and select Properties from the submenu.
In the Net Properties dialog box rename net to "GND," and check Connect Net to Pins
by Name checkbox. Press OK to apply changes.
DipTrace automatically connects all unconnected pins with the corresponding name to
this net.
170     DipTrace Tutorial




      Select IC Data Acq DAC library, and find 173 AD420AR-32 component (press

                               button, type "AD420AR-32" into the name field and press Apply
      Filter). Place several AD420AR-32 components on the design area.
      Notice that all GND pins of the placed components are automatically connected to the
      GND net without wires due to active Connect Net to Pins option in the Net Properties
      dialog box. This feature is the easiest way to connect pins with the same names for the
      entire schematic. Usually applied to POWER, GND, CLK pins or even data buses.




                                                                            © 2024 Novarm Software
                                                       Other features and tools   171




                                Connect nets by name
DipTrace allows the user to connect nets on different sheets without net ports or buses.
Remember the name of some net that you have on the first sheet (for example, Net 3),
then go to Sheet 2, and right-click on the net you want to connect to Net 3. Then select
Properties from the submenu, type in "Net 3", check Connect Nets by Name checkbox,
and press OK.
   172     DipTrace Tutorial




         This feature works like a regular net renaming. When you enter the net name that already
         exists anywhere on the schematic, DipTrace asks if you want to connect these nets by
         name.
         Notice that you can not connect nets by name on different levels of hierarchy.
         For hierarchy, you can create global nets. We will learn how to use them later in the
         Hierarchical Schematic 218 topic of this tutorial.

5.1.4    Connection Manager in Schematic and PCB Layout
         Connection Manager is another DipTrace tool which allows the user to create/edit/delete
         connections in Schematic and PCB Layout. Select "Objects / Connection Manager" from
         the main menu in Schematic or "Route/ Connection Manager" in the PCB Layout.




                                                                                © 2024 Novarm Software
                                                             Other features and tools   173



                                           Open connection manager in Schematic. Select a
                                           net from the drop-down list, and you'll see all pins
                                           of the selected net. You can easily add/delete pins
                                           to/from the net. To add new pins to the net, select
                                           a component and its pin with the corresponding
                                           drop-down lists, and press Add button. Notice that
                                           only unconnected pins are available in these drop-
                                           down menus, so if you can not find a pin that you
                                           need, it is probably already connected to another
                                           net. Use       button to create a new net,
                                           button to rename the current net, and        to
                                           delete it.
                                           Press OK to apply changes and close the
                                           Connection Manager or press Cancel to close
                                           it and maintain the net structure unchanged.




5.2   Looking up components
      DipTrace 4.X includes 170,000+ components in the standard libraries, and we
      continuously expand them. Components are sorted by types. The cross-module library
      management system with custom library groups and search filters allows the user to
      seek through the libraries and quickly find what he needs.
                                         Search filters
      Go to "Objects / Find Component" from the main menu in the Schematic or press
                          button on the Place Component panel to customize the search
      filters.
                                                In the pop-up dialog box specify the search
                                                area: All Libraries, current library group or
                                                current library, and type in the name or part
                                                of the name of the component. DipTrace
                                                allows for filtering components by RefDes,
                                                Value, Pattern, Manufacturer, Datasheet or
                                                Additional Fields. Press       or      buttons
                                                next to the corresponding search filter to add
                                                or delete the search filter respectively. Use
                                                the drop-down list to select search
                                                parameter.




      As you can see in the picture, we search for 24LC256 memory with "U" RefDes.
174      DipTrace Tutorial



      Press Apply Filter. You can stop the search at any moment by pressing Stop Filter
      button. As soon as the search is completed, only filtered components that correspond to
      the search filters are visible on the Place Component panel. The state of the search filters
      is always displayed on the Place Component panel – "Filter ON/OFF." To disable the
      search filters, open the search filters dialog box, and press Cancel Filter.
      You can redirect the search with the entered parameters to SnapEDA database by
      pressing Search at SnapEDA button (see detailed description below).
      If some component is not available neither in the standard libraries nor in SnapEDA
      database, you can press New Part Request button to place an order for its design by
      DipTrace engineering team.


                                          Place component
      You can find and place components with the Place Component dialog box ("Objects/
      Place Component" from the main menu in Schematic). There are two sections in the pop-
      up dialog box: Libraries and Components. Select library group from the drop-down list,
      then select a library, and, finally, select component from the corresponding list. Press
      Filter ON/OFF button to customize and apply the search filters.
      "Objects / Place Component" dialog box is similar in the PCB Layout.
      For example, we need a component that contains "232" in its name, but we do not
      remember the other characters, letters or even a possible library. Press Filter ON/OFF
      button, select Search area: All Libraries, type in "232" in the Name field of the filters
      dialog box, and press Apply Filter. DipTrace has found 490 components with "232" in
      their name. Components are in the list right below. Select a component, now you see its
      schematic symbol, press Display Pattern to see its associated footprint.




                                                                              © 2024 Novarm Software
                                                         Other features and tools   175




Add more search filters to narrow the results. Press Search at SnapEDA button redirect
the search with the entered parameters to SnapEDA database.
Press Place button and left-click on the design area to place the selected component or
check Place by Coordinates checkbox and enter exact coordinates, where you want that
component. This dialog box has all necessary tools to work with multi-part components
as well.


                                  SnapEDA database
DipTrace features and integrated tool that allows searching SnapEDA CAD database in all
the modules. To launch the search dialog in PCB Layout go to Objects/ Search Parts at
SnapEDA. Register a free account with SnapEDA - and you are ready to go. Let's look up
an amplifier; enter LM358 in the Search line and press      . Select   LM358DG4
component from the results list.
  176     DipTrace Tutorial




        Now press Place Component button to place the pattern to your design. Alternatively,
        you can press Save to Library button to save it to an existing user library or create a new
        one. Remember that you cannot change standard libraries, so make sure to select a user
        library on the Place Component panel before saving the component.
        Note that Download 3D Model button is active, which means that a 3D model for this
        component is available in the database. Press it and save a .step file to your computer.
        3D model is attached to the component automatically, however, it's recommended to
        check its position relative to the footprint and map it, if necessary.



5.3     Reference Designators
        Now we'll work with schematic examples located in the "Documents/ DipTrace/
        Examples" folder. Open Schematic_2.dch file.
        This project demonstrates application of various DipTrace features. However, we will
        experiment with some basic principles of working with Reference Designators in the
        Schematic.
        This Schematic contains 23 capacitors from C1 to C24 (C19 is missing).
                                            Optimize RefDes
        While editing a principal circuit, sometimes you need to insert or delete components. Let's
        add a capacitor to the schematic, select HAK222KBACRBKR component from
        Capacitors Ceramic Disk library and place it on the design area. We want "C5" RefDes
        for this component, but the software automatically assigned the "C19" RefDes, because


                                                                                © 2024 Novarm Software
                                                         Other features and tools    177



C19 was missing and C5 existed on the schematic. Change the RefDes: right-click on
this capacitor, and select the first item from the submenu, enter "C5", and press OK. The
warning message suggests to rename the component and shift the RefDes numeration,
press Yes.




The C19 capacitor is now C5 and the old C5 became C6 and so on till C18 capacitor
which is C19 now. See the design manager panel to the right to find out that C19
reference designator is not missing anymore because you have inserted C5 and C5 –

C18 RefDes indexes were shifted ( use      button to sort the components in the list).
Now we have the correct array of RefDes indexes for all capacitors.


Now rename the C5 capacitor to C30, then check the list of capacitor designators on the

Design Manager (Ctrl+2 to show/hide the Design Manager, press            button to sort the
components in the list) – C5 and capacitors with C25 till C29 indexes are missing. To
correct this issue, right-click on any capacitor, and select Optimize RefDes, then select
RefDes "C" – C30 becomes C24. The reason is simple – while optimizing the RefDes,
DipTrace removes all empty places in the designator index array. Therefore C6–C24
become C5–C23, and C30 becomes C24.
178     DipTrace Tutorial




                                       RefDes renumbering
      What if we need to renumber Reference Designators in a very easy way that makes it
      simple to navigate through the schematic? Select "Tools / RefDes Renumbering..." from
      the main menu. In the pop-up dialog box do not change the First Index (starting point of
      renumbering) and Page Step (if page step = 100, the designators on the second page
      are R101, R102, IC101, etc.). Now specify the renumbering direction: in rows or columns,
      and choose how DipTrace is going to count components while renumbering. There are
      components of different sizes and shapes. If we choose Top-left in the Component
      Position section of the dialog box, DipTrace renumbers components, based on the
      position of the top-left corner of each component. If you choose Origin, the software
      considers component's origin to determine its position.
      Notice that renumbering always goes from left to right and from top to bottom of the
      circuit.
      Press OK to renumber all components.




                                                                             © 2024 Novarm Software
                                                                Other features and tools     179




      If you need to renumber only the designators of components of selected type, right-click
      on one of the components, and select RefDes Renumbering from the submenu. You
      see a typical RefDes Renumbering dialog box, but this time you can apply renumbering
      to the current RefDes.
      RefDes Renumbering works the same in the PCB Layout.
      Close DipTrace Schematic without saving progress and launch the PCB Layout module.

5.4   Placement and autorouting
      DipTrace has advanced placement features and integrated auto-placer. This makes
      placement and layout optimization much easier.
      Launch the PCB Layout module, select "File/ Open", and select "C:
      \Users\<UserName>\Documents\DipTrace\Examples\Schematic_4.dch" and use the
      schematic rules for this layout. You get something like in the picture below. The layout is
      chaotic because components are placed just like their symbols in the schematic.
      Manually arranging components would be a waste of time, this is why we recommend
      using the automatic arrangement, but, first, let's place a board outline.
180     DipTrace Tutorial




                                             DXF import
      We'll now import a board outline from a DXF file. Select "File/ Import / DXF" from the main
      menu and open "C:\Users\<UserName>\Documents\DipTrace\Examples\outline.dxf" file.
      In the pop-up dialog box, you can see a DXF file that will become the board outline. Select
      Board Outline DXF layer, and specify Convert to: Board Outline in a drop-down list
      below.




                                                                              © 2024 Novarm Software
                                Other features and tools    181




When importing component drawings or an entire layout from
the DXF format, you can Fill closed areas and cut holes using
Embedded polygons (usually DXF designs are made from the
outlines without fills). This feature works for copper and mask/
paste layers only.
If you are importing pads in signal layer, then you can check the
Pads in Signal Layers checkbox, and press              button to
specify what shapes should be automatically converted into
pads and their possible dimensions.


Select Import mode: Add to add board outline to existing layout,
make sure inches are selected, and press Import button in the
upper-right corner.
The board outline appears on the design area, but components
are still messed. Select "Placement/ Placement Setup" from the
main menu:
182     DipTrace Tutorial




      Check Place Components Outside the Board Outline checkbox to arrange
      components near the board outline. Keep other settings like in the picture above. Click OK

      to apply changes and press    button on the Placement toolbar or select "Placement/
      Arrange Components" from the main menu.




      All components are now located in one place near the board outline.
      Notice that Arrange components feature is not the same as Auto-placement.
      Automatic placement creates a layout with a minimum possible total length of
      connections between the pads of components. Arrange Components feature simply
      brings all components to one place and makes it easier to work with them.
      However, in real life manual placement is widely used, because most of the time we have


                                                                            © 2024 Novarm Software
                                                       Other features and tools    183



certain places for certain components. DipTrace allows the user to combine automatic
and manual placement on a single circuit board.
                                   Placement by list
Select "Placement / Placement by List" from the main menu, then in the pop-up dialog box
select component from the list (left-click it), move the mouse to the board outline, and
click inside the board outline to place the selected component there.




Component disappears from the list after placement (the list shows only those
components that are outside the board outline). Position U1, U2, U3, J1, J8 and J12
components manually, like in the picture below. You can optimize connection lines with
F12 hotkey or uncheck the Ratlines item on the Objects tab on the Design Manager to
hide the ratlines. Close the Placement by List dialog box when done.
184      DipTrace Tutorial




                                          Place selected by list
      Another way to place components in an organized manner is the "Place Selected by List" function.
      This tool allows you to select components in the related schematic and automatically get them
      organized into a list for placement in the PCB Layout module.

      First, we are going to make sure that the Cross Selection is enabled. Navigate to Edit/ Cross
      Selection, and in the pop-up dialog, mark Enabled. The related schematic should already be
      correctly set since we started this project from an existing schematic file.




      Next, launch Schematic Capture and open the Schematic_4.dch project from C:
      \Users<UserName>\Documents\DipTrace\Examples\Schematic_4.dch. Select components RN1 and
      RN2 in the schematic — these will automatically be selected in the PCB Layout.




                                                                                    © 2024 Novarm Software
                                                        Other features and tools    185




Now, go to Placement/ Place Selected by List, which will bring up a window listing the
selected elements, ready for placement.




Simply drag the components from the list onto the board to place them. Once done, you
can select another batch of components in the schematic, press the update button to
refresh the list, and continue placing additional components. For this tutorial, however,
we'll place just these two components using this function, as shown in the picture below.
186     DipTrace Tutorial




                                  Custom component clearance
      Default component clearance is set with X and Y spacings in the Placement Setup
      dialog box. We need all other components to be at least 20 mm away from the U3
      component. Therefore, we will set a custom clearance for this component. Right-click on
      the U3, and select Properties from the submenu, then open the Other tab, and define:
      Use: Custom and Value: 0.79 inches (approx. 20 mm). Click OK to close the dialog box
      and apply custom clearance.




      Now select all components which are already on the circuit board, and lock them (Ctrl+L
      hotkeys).



                                                                           © 2024 Novarm Software
                                                          Other features and tools     187



                                     Auto-placement
We do not have special requirements for other components. Therefore, we can place
them automatically with 5 mm spacings. Change measurement units (Shift+U keyboard
shortcut). Select "Placement / Placement Setup" from the main menu, change X Spacing
and Y Spacing to 5 mm, and set 3 mm board spacing. Make sure that Allow Pattern
Rotation checkbox is checked (sometimes it is better to turn it OFF, for example, for
single-sided boards with jumper wires). Uncheck Place Components Outside the
Board Outline and make sure Use Pattern Spacings item is checked, this allows the
program to use 20 mm (0.79 in) custom clearance of the U3 component. We do not
recommend to check Increase Placement Quality option now (you can try it later).

Press OK to apply changes, and then press        button on the Placement toolbar or
select "Placement / Run Auto-placement" from the main menu. DipTrace looks for the
best location for each component. You will get something like in the picture below (notice
that Design Manager panel is hidden (Ctrl+2 hotkeys), the ratlines are also hidden).




Some connections are not optimal because we have placed large components manually.
If you auto-place the entire board, you can get better results, but usually, this is not the
option in real life.
It's clearly visible that there is no component on the board closer than 20 mm to the U3
because of the custom clearance.
                              Autorouting with net classes
Check via properties in the "Route / Via Styles" main menu item. One via style is enough
for this project (we'll use 1.2 mm via with 0.6 mm hole). Now we need to create a
separate net class for Power and Ground nets because traces of these nets should be a
bit wider. Select "Route / Net Classes" from the main menu. All nets belong to the Default
188      DipTrace Tutorial



      class. Press Add button to create a new net class, then select it from the list, and enter
      its name ("POWER"). Specify: Trace Width: 0.6 mm, Clearance: 0.6 mm. Press
      Clearance Details button and in the pop-up dialog box set Trace to Pad: 0.5 mm. Now
      press OK. Select VCC and GND nets from the list of all nets of the project in the lower-
      right corner of the dialog box (use Ctrl key for multiple selection) and add them to the
      POWER net class (press             button above the list).




      Now select Default net class, and specify the following parameters: Trace Width: 0.4 mm
      , Clearance: 0.4 mm, Trace to Pad: 0.3 mm. Use all via styles for both net classes (as
      you remember, we have only one via style). Press OK to close the Net Classes dialog
      box. Make sure that Shape Router is active ("Router / Current Autorouter / Shape
      Router"), then go to the Autorouter Setup dialog box, and in the Settings tab uncheck
      Use Priority Layer Directions.

      Now press Ctrl+F9 or the        on the Route toolbar to launch the autorouter. In a few
      seconds you will get the results. Change layer colors if you want.




                                                                              © 2024 Novarm Software
                                                               Other features and tools    189




      A detailed description of the autorouter settings is available in the PCB Layout Help
      ("Help / PCB Layout Help" from the main menu). If you still have some unrouted nets,
      Undo, change trace width/clearance, placement or other settings, then launch autorouter
      again. However, if you have followed the beforementioned instructions you should not get
      any problems.

5.5   Layer stack
      DipTrace allows for comprehensive control over the stack of conducting and insulating
      PCB layers in the Layer Stackup dialog box and generates a stack table that clearly
      documents the PCB stack for manufacturing engineers.

      Launch DipTrace PCB Layout module and open the PCB_6.dip file from the "Documents/
      DipTrace/Examples" folder. It is a 4-layer circuit board. Select "Route / Layer Setup" from

      the main menu or press        button on the Layers tab, then press the Layer Stackup
      button in the Layers dialog box.
      In the Layer Stackup dialog box, you can see the table which represents a printed circuit
      board's cross-section. In our case, DipTrace has automatically selected the 4 Layers
      Default Stackup in the Template drop-down list because this design has two signal
      layers.
190      DipTrace Tutorial




      There are many variations of PCB stacks on the market, but default stackups available in
      the software are usually the most common and thus the cheapest ones. However, you
      can create any stack. As you can see from the list, this 4-layer stackup is based on a
      single FR-4 core and additional prepregs to separate copper layers. For this tutorial, we
      will create a 4-layer stack based on two FR-4 core layers and capable of conducting large
      currents (like in the picture below). This stackup is a bit rare because of certain hole-
      plating difficulties, but it is a good example.




      First of all, let's change the copper thickness to 2 Oz to conduct large currents. Usually, it
      is the thickest copper that does not skyrocket the manufacturing price and is available at
      most PCB houses in stock. Left-click on the layer #1 Top in the list, and select Copper
      2Oz material from the Material drop-down list, then do the same for all conducting layers.
      Because the copper layers become thicker, the overall board thickness of the circuit


                                                                                © 2024 Novarm Software
                                                          Other features and tools    191



board is recalculated automatically.




Notice that you can use Shift + U hotkeys to change the measurement units on the go. All
values are instantly recalculated.

Now left-click on the Prepreg layer right below the layer #1 Top, and change its material to
FR-4 substrate, then select another dielectric Prepreg 2113 layer, and move it down the
stack (press the Move Down button). Now left-click on the FR-4 layer below the layer #2
Gnd, and move it down. The final steps are deleting one of the prepregs left, and moving
the other prepreg up the list because we want to have double-layered 2113 prepregs
separating the copper layers (like in the picture).
192      DipTrace Tutorial




      The final stage is documenting the layer stackup in the Gerber file for a PCB house.
      Press Place Table. In the pop-up dialog box, select a non-signal layer for placing the
      layer stackup table (Top Assembly layer is the best choice); you can change fonts,
      measurement units and preview the total dimensions of the Layer Stackup table.

      Press Place, and left-click on the design area to place a Layer Stackup table on that spot.
      The thickness of the layers in the stack influences the via height and is taken into account
      by phase tune 208 and trace length measuring 194 tools. Hence, the software can ask if you
      want to consider the stackup of layers for trace length calculation (if it is not considered
      yet).




                                                                              © 2024 Novarm Software
                                                        Other features and tools    193




Notice that the table is automatically updated. You can use Shift + U hotkeys to change
measurement units on the go. All values are instantly recalculated.

The color of the table depends on the color of the PCB layer. Now the manufacturing
engineer can understand which layer stackup you prefer. However, it is better to consult
your PCB house before making changes to the layer stack.

Don't save any changes in the PCB_6.dip file.

                           Add new materials to the stackup

                                          If you can not find the material you need in the
                                          list of available materials in the Layer
                                          Stackup dialog box, press the Edit Materials
                                          button. The Layer Materials dialog box pops
                                          up, here you can add new and change
                                          properties of existing materials (Type,
                                          Thickness, and Dielectric Constant). All
                                          materials are divided into three basic types:
                                          Conductor, Plane, and Dielectric. Use the
                                          corresponding buttons to add/delete /edit
                                          materials.
Check Variable Thickness box to allow for changing the layer thickness directly in the
Layer Stackup dialog box.
   194      DipTrace Tutorial



5.6      High-speed nets and differential signals
5.6.1    Length matching
         One of the core challenges with routing high-speed nets is controlling that certain critical
         signals arrive at correct time. To achieve signal synchronization, the copper tracks needs
         to be roughly the same length.
         DipTrace has an elegant solution for matching trace lengths that helps when routing high-
         speed data buses or any critical signals that require precise timing.
         We will use one of the standard DipTrace PCB examples for practice. Launch DipTrace
         PCB layout, and open the "BGA_Autorouter.dip" file from the "Documents/DipTrace/
         Examples" folder.
         If you're routing a high-speed bus, we recommend creating a separate net class for the
         bus. This will automatically create a DRC length matching rule. However, you can also
         select several nets and generate the length matching rule for the DRC without creating a
         net class.
                                          Length matching a bus
         First of all, we need to create a separate net class that hosts all the nets that we need to
         length match (Net 306 - Net 310). In this case, we have the "Memory" net class with
         several nets connecting the U6 FPGA with the U14 memory module. When all traces are
         added to the net class, check the Length Matching by Class check box to create a new
         length matching rule verified by the DRC.




         You can compare traces against the Fixed Length parameter or against each other with
         required Tolerance. Don't change the default tolerance value and let's say we need
         approximately 30-mm traces. Enter "30" in the Fixed Length field (the tolerance value


                                                                                  © 2024 Novarm Software
                                                             Other features and tools     195



automatically changes to 1.27 mm, which means a range of 2.57 mm over and under the
fixed length). Press OK to create the net class and the rule.
Select "High Speed / Length Matching" from the main menu or right-click on the track, and
select Length Matching, then Open Length Matching from the submenu. In the pop-up
dialog box, select Memory (actual name of the net class) in the Rule drop-down list. All
nets of the memory data bus, which we assigned to the Memory net class, appear right
below. Some of the nets are highlighted in red to show the length tolerance violation. Left-
click a net in the list to show it on the design area or hover over a net to highlight it. In our
case, there are four nets that should be edited to comply with the rule.




The most efficient way to make traces longer is drawing meanders.
                                        Add Meanders

Select "High Speed / Add Meander" from the main menu or press              on the High Speed
toolbar. Now hover over the trace, and drag and drop to draw a meander. Meanders are
created one at a time. Move the mouse cursor to the right and create more meanders.
The software helps to create meanders of the same size. Drag and drop meanders' lower
vertices while holding the left mouse button to get something like in the picture below.
196      DipTrace Tutorial




      You can notice that the length of the trace is recalculated in real time. Once the trace
      length is around 30 mm ± 1.27 mm, the net is not highlighted in red anymore.




      DipTrace can consider via height (derived from the layer stackup) 189 and pad signal delay
      199 when calculating the trace length. Press the corresponding    button in the Length
      Matching dialog box, and check Enable Layer Stackup and Enable Pad Delay check
      boxes. Since there are traces crossing between layers, some of them might fall outside
      the length matching tolerance and will require more or bigger meanders.
                                            Edit Meanders

      To push meanders along the trace segment, press the       button (if not in the Add
      Meander mode already), left-click on the trace segment opposite the preferred direction,
      and drag and drop meanders.




      Notice that you can also move meanders along the traces and change meander's

      amplitude in the regular Edit Traces mode (        button).
      By default, the gap between each meander is defined by the net class clearance. To set


                                                                               © 2024 Novarm Software
                                                         Other features and tools    197



custom meander gap, right-click on the trace, and select Meander Gap from the
submenu. In the pop-up dialog box, check Value, enter a new gap (for example 0.3 mm),
and press OK.
Notice that it's better to avoid any sharp angles when routing traces of high-speed nets.




Fix all other errors by adding meanders and editing other traces.
                                 Length matching nets
You don't have to create a new net class to length match some nets, just right-click on a
trace segment or net in the list of nets on the Design Manager panel, and select "Length
Matching / Add Selected Nets" to launch the Length Matching dialog box. You can also
select several segments of different nets, and select "Length Matching / Compare
Selected Nets Only" from the net submenu. In the Length Matching dialog box, you can
compare nets against each other or against a fixed length.
198     DipTrace Tutorial




      You have to create a new rule (press Create New Rule, and enter a name in the pop-up
      dialog); otherwise, the DRC does not verify the length matching constraints.




      Press OK to create a rule.


                                                                         © 2024 Novarm Software
                                                                 Other features and tools    199



        You can also add new nets to the comparison with Add Net/Pads button.
        If you work with nets that have more than two pads and you want to length match only
        certain track of the net (trace between two pads), select the corresponding pads from the
        drop-downs after selecting the net in the Add Nets/ Pads dialog-box.

5.6.2   Signal delay
        Bond wires are the wires inside electronic component's package that connect pads to the
        die. These wires introduce a signal delay, which should be accounted for in high-speed
        designs. Manufacturers report this in-device pad signal delay in the datasheets in
        picosecond time or as a length.

        Pad signal delay value is considered for phase tuning and trace length matching and is
        added to the total length of the traces. We recommend setting up signal delays when
        designing a component in DipTrace Component Editor, but you can also set delays in the
        Schematic and directly in the PCB Layout.

        To set pad signal delay in the PCB Layout, right-click on the component and select Pad
        Signal Delay from the submenu or right-click on the pad and select Signal Delay. Select
        the pad from the list (if not selected already), and enter a signal delay in mm, mils, or
        inches right below (use Shift + U hotkeys to change the measurement units on the go).




        Select if you want to apply signal delay parameter only to the selected component or to all
        components with the same name on the circuit board. Press OK to apply changes. If
        DipTrace is not using Pad Signal Delay value for trace length and phase calculation, it
        drops a warning message that suggests you apply pad signal delay values to trace length
        calculation, press Yes in the Warning dialog box.

        You can turn ON/OFF the considering of pad signal delay for trace length calculation, just
   200      DipTrace Tutorial



         go to "High Speed / Length Matching" from the main menu, press button at the top of
         the pop-up Length Matching dialog box and check/uncheck Enable Pad Delay item.

5.6.3    Create a differential pair

         Differential pair signaling is a method of transmitting high-frequency signals using two
         tightly coupled tracks on the circuit board. One track carries the signal and the other one
         carries an equal but opposite image of the same signal. Differential pairs are EMI immune,
         they generate less noise than single-track connections and, basically, are the only
         acceptable way of transmitting information at high speed.

         Open DipTrace Schematic, and go to "Objects / Net Classes" from the main menu. In
         DipTrace, all differential pair parameters are governed by net classes, and the program
         does not allow the user to create differential pairs outside of them. We need to create a
         new special-type net class for differential pairs. Press Add button in the Net Classes
         dialog box, then type in the name of the net class (for example, "Diff_Class_1"), and
         change Type to Differential Pair. Now you can enter specific differential pair routing
         parameters.




         Enter the trace width for tracks of the pair, the primary gap between the tracks, and
         clearance to other objects on the PCB (for example, 0.009 inch, like in the picture above).
         You can leave default values in other fields. Notice that the net class is empty (because
         the design is empty itself).

         Press OK to close the Net Classes dialog box and apply changes.

         Now we need to populate our schematic with components for practicing with differential
         pairs. We have ATSAM4LC8BA-UUR (IC MCU Atmel ARM library) flash memory module
         and EPM7128AETC100-7 (IC Embedded CPLD library) chip on the design area, but


                                                                                 © 2024 Novarm Software
                                                           Other features and tools     201



differential pair declaration can be assigned to any nets between any components. So,
you can use any components of your choice. Create two nets which will eventually
become a differential pair. For example, we have Net 0 connecting the D1 pin of the flash
memory to pin#13 of the CPLD-component and Net 1 – connecting C3 to pin#14.




Now press           button or select "Objects / High Speed / Define Differential Pair" from the
main menu. In the pop-up dialog box, specify the positive and negative net of the
differential pair. For example, we select Net 0 in the Positive Net drop-down and Net 1 in
the Negative Net drop-down. You can also pinpoint nets directly on the design area by
pressing        or      buttons and left clicking on the nets or their pins.
Since we have only one differential pair net class, the program automatically assigned
Diff_Class_1 to this differential pair. Net class properties are right below. Press Edit Net
Classes if you want to open the Net Classes dialog box and change differential pair
properties.
202     DipTrace Tutorial




      Press OK. Net 0 and Net 1 are a differential pair, these nets are renamed to DiffPair_P
      and DiffPair_N respectively and marked with special symbols on the design area. You can
      hover over one net with the mouse and the other net of the pair highlights. You can display
      net names on the design area if you right-click on each net, and select Display Name
      from the submenu.




      Now let's switch this design to the PCB Layout stage and practice more in customizing,
      routing, and verifying differential pairs. Proceed to the next topic of the tutorial.


                                                                             © 2024 Novarm Software
                                                                   Other features and tools    203



5.6.4   Differential pair routing/editing

        Notice that built-in DipTrace autorouter does not support differential pairs. We
        recommend routing these nets manually or with external autorouters.

        Select "File / Convert to PCB" from the main menu in the DipTrace Schematic, and
        proceed with the schematic rules. In the PCB Layout, move components closer together.
        You can see that differential pair is also marked with a special symbol, like in the
        schematic. You can see that ratlines are twisted, it's possible to route the differential pair
        like that, but it would be much easier to rotate the U2 pattern to eliminate the twist. Select
        the component, and press R hotkey two times to rotate the component 180 degrees. Now
        we're almost ready to start the routing, but, first, we need to go to the Net Classes dialog
        box to check if we have acceptable routing parameters. Select "Route / Net Classes" from
        the main menu, then select Diff_Class_1 net class.

        Differential pair routing parameters. DipTrace allows the user to specify various
        differential pair routing parameters. DRC takes these values as routing constraints when
        verifying the PCB. You can specify the maximum uncoupled length for two traces of the
        differential pair, length tolerance between the traces, dynamic phase tolerance (length
        difference between corresponding segments of each track), and phase error length which
        means that DRC will report any phase shift as an error only if it occurs on the track
        segment longer than the Error Length value. Let's change the Dynamic Phase
        Tolerance to 0.04 and Dynamic Phase Error Length to 0.3 inch. Leave default values
        in other fields.

        Since we have some small-pitch BGA footprints on the board, we can estimate that our
        differential pair with 0.009 inch wide tracks, gap and clearance is too big to be routed.
        DipTrace allows the user to define neck parameters which can be easily applied to
        differential pairs while routing in tight spaces. Press Neck Parameters button.
204     DipTrace Tutorial



      In the small pop-up dialog enter 0.004 inch width and gap, and 0.1 inch as the maximum
      neck length. This means that necked segment longer than 0.1 inch will be reported as an
      error by the DRC. Press OK to apply neck parameters, and then press OK to close the
      Net Classes dialog box.

      Let's create one more differential pair directly in the PCB Layout. First, we need to

      create a couple more nets with Place Ratline tool       . For example, like in the picture
      below.




      Then press Define Differential pair button (        on the High Speed toolbar). Define
      Differential Pair dialog box shows up (this dialog is the same as in the Schematic
      module), pinpoint the positive and negative nets, change color for convenience (red in our
      case,) and apply the same Diff_Class_1 net class to this differential pair. Press OK and
      the second differential pair with custom color appears on the design area.

      Now press         button on the Route toolbar, or go to "Route / Manual Routing / Add
      Trace" from the main menu, and left-click on any pad of the differential pair two tracks
      starts to appear simultaneously. Routing a differential pair is very similar to routing a
      single net 47 . Ratlines show the direction where to lead the traces. Continue from the U1
      component to the U2, and left-click on the corresponding U2 component's pad. The
      second trace of the pair will be automatically connected to another pad. You can change
      the routing layer, route mode, current trace segment, and other routing parameters on the
      Routing panel, with the corresponding hotkeys (noted in the brackets on the Routing
      panel) or with the right-click submenu on the go.

      If you want to change an active trace of the pair that you route, select Change Control
      Trace from the right-click submenu while routing.




                                                                              © 2024 Novarm Software
                                                          Other features and tools     205




                                   Single-track routing


In real life, you will often face more complex layout situations. Press        button on the
Route toolbar, or go to "Route /Manual Routing / Add Trace" from the main menu. On the
Routing panel you can customize the set of the segments that will be used during
routing. Select My Routing Mode and press              button; in the menu tick 90 > 45, 45 >
90 and free line segments, press OK. Now click on the Current Segment image and
select Free Line (press S hotkey two times). Start routing the first differential pair from
U2 to U1. You will notice that BGA pitch is very small and now is the time to apply the
trace necking defined earlier in the Net Class properties. When approaching the U1, left-
click to place the trace segments, and then right-click, and select Neck-down Segment
from the submenu to reduce the width of both tracks and the gap between the traces
according to the neck parameters. Left-click again closer to the U1 component to create a
small narrow segment (orange traces are routed). Now the tracks are small enough to fit
the BGA's pitch, but you still can't finish routing the pair automatically. Hover over the
terminal pad to see that the traces offered by the program are unacceptable.
206      DipTrace Tutorial




      Routing each trace of the differential pair will allow you to succeed in this situation. Right-
      click, select Route Single Trace from the submenu or press Z hotkey, then change
      current segment to regular lines with a 45-degree angle on the Routing panel (or just
      press S hotkey), then left-click on the terminal pad of the trace. DipTrace will switch to the
      second trace of the pair for routing. Left-click on the second pad to complete the
      differential pair.




                                                                                 © 2024 Novarm Software
                                                             Other features and tools   207




If you want to change the trace of the pair that you are routing, select Change Control
Trace from the right-click submenu.

                                Controlling the trace length

Controlling the total length of each trace is very important for successful high-speed
routing. Right-click on any trace of the differential pair, and select Show Trace Length
from the submenu, the total length of each track of the differential pair will appear right
next to the pads of the differential pair in the current measurement units. To hide the trace
length, select the same item from the same right-click submenu again. In our case, the
trace length is hidden to keep design more empty and easy-to-understand.

                                   Edit differential pairs

Right-click on the differential pair, and select a required action from the submenu. You can
unroute tracks or separate segments, change the color of the differential pair, the layer of
the traces or segments, delete differential pair declaration from the nets, remove necking,
and much more. There are two distinct editing modes applied to differential pairs: regular
editing and single track editing. Each one can be in a regular or free style. For example,

press      button on the Route toolbar, then drag and drop differential pair's traces to
another location. Notice that two tracks move respecting the differential pair gap. You can

also use the Free edit tool (     button) in some situations.
   208      DipTrace Tutorial




         The other mode is similar to single-track routing because it allows the designer to edit

         each trace of the differential pair separately from the other. Press         button on the High
         Speed toolbar, and move one track of the pair further away.




         Single-track free edit mode (            button on the High Speed toolbar) behaves in a
         similar way to the regular Free edit mode, but applies only to one trace of the pair. You
         can practice more with differential pairs and change the layer of the trace segment. Right-
         click on the longest differential pair's segment, and select "Segment Layer / Bottom". Two
         traces will move to the bottom layer. Vias will appear automatically.

         Please undo the last changes to return the red differential pair to its initial state.

5.6.5    Phase tuning a differential pair

         We have Real-time DRC OFF, this is why we do not see any errors on the design area.
         Turn it ON, and launch the DRC 76 in the regular mode to see the error-report dialog box.
         DRC checks all clearances and sizes against the target values defined in the
         "Verification / Design Rules" main menu item. DRC also takes differential pair properties
         from the Net Classes dialog box as design constraints. In our case, we have three errors
         related to the differential pair. When you click on the error in the list, you see the
         description of each violation, including the current and the target values. Rule Details
         section right below the list shows where the target values are defined.




                                                                                     © 2024 Novarm Software
                                                            Other features and tools     209




Move the DRC Error-report dialog box a bit, so that it does not obstruct the view over the
design area, and start fixing the errors. First of all, let's make the necked differential pair
segment a bit shorter, as we can see only 0.1 inch is allowed by the necking constraint in

the differential pair net class. Press the Edit Traces      button on the Route toolbar,
then hover over the place where traces become narrow, the mouse cursor should appear
as a left-right arrow parallel to the traces. Now drag and drop the wide trace segments
closer to the terminal pads to make the necked traces shorter, like in the picture below.

You can apply single-trace editing tool (   button on the High Speed toolbar), if you can't
succeed without an error while moving two traces simultaneously.
210      DipTrace Tutorial




      The second error reports that we have phase tolerance violation and it happened on the
      trace segment that is longer than Dynamic Phase Error Length value in the Net Class
      parameters. We need to make the shorter trace a bit longer to fix the phase shift. We'll fix

      the error with Phase Tune tool. Press          button on the High Speed toolbar or go to
      "High Speed /Differential Pair Tools / Phase Tune" from the main menu. In the pop-up
      dialog box, you can check which track needs phase tuning. Hover over the bottom track of
      the differential pair with the mouse cursor and notice that Forward Point Phase Lead
      value is highlighted in red and the software suggests to add or increase the meander at
      the opposite trace.




                                                                               © 2024 Novarm Software
                                                          Other features and tools    211




Now hover over the opposite trace. We see that the signal in the upper trace is a bit faster
than in the lower one. Left-click on the upper trace, and move the mouse cursor up while
holding the left mouse button to create a meander. Release the mouse button when the
meander is ready. Because there is a backward point phase lead on this trace, you need
to have a meander closer to the U1 component, but not too close to avoid very sharp
turns that are bad for the signal. Don't make a meanders too big. They have to be just
enough to fix the phase shift and not to cause any "uncoupled length" errors.
   212      DipTrace Tutorial




         Press Run DRC to check the design again and make sure that all errors are fixed.

         If you hover over a trace segment with the mouse and find out that some phase lead
         violation is still shown in Phase Tune for Differential Pairs dialog, but DipTrace does not
         report it as an error upon running DRC, it means the segment is shorter than Dynamic
         Phase Error Length value set in the Net Class parameters. So, you still have a phase
         shift, but it occurs on a relatively short trace segment well within the tolerance limits.

         You can edit meander size anytime later, just press         button on the Route toolbar, and
         drag and drop the meander's tip.
         Notice that DipTrace can calculate a phase shift considering layer stackup 189 (via height)
         and the length of bonding wires inside a component (determined by the Signal Delay 199 ).
         By default, DipTrace does not consider these values. If you want to consider them, press
             button in the Phase Tune for Differential Pairs dialog box, and check the
         corresponding items in the pop-up dialog box. However, this is not important in our case,
         because there are no differential pairs crossing the layers in our design.

5.6.6    Differential Pair Manager
         If you have a complex design with lots of differential pairs, it becomes hard to manage
         them directly on the design area. DipTrace has Differential Pair Manager which allows for
         easy managing/editing/deleting differential pairs. Select "High Speed / Differential Pair
         Manager" from the main menu. In the pop-up dialog box, set specific net class in the Net
         Class drop-down to display only the pairs of the net class, or select All Classes to show
         all pairs of the design in the list right below. However, this does not make any difference in
         our case, because we have only two differential pairs of the same net class.


                                                                                   © 2024 Novarm Software
                                                                   Other features and tools      213




        Press Add to open Define Differential Pair dialog box and create a new differential pair,
        or select existing one from the list and modify its name, color, nets, net class, etc. Right
        below you can see the Class Properties and Pair values if this differential pair is routed.
        Red-highlighted value is the violation. In our case Phase shift on selected differential pair
        is bigger than the tolerance, but it is not considered an error unless there is a Phase Error
        Length violation.

5.6.7   Define paired pads
        On rare occasions for the circuit boards with lots of various differential pair pads located
        very close to each other, DipTrace might not be able to draw two traces and finish routing
        the pair. In this case, you will get a warning message that offers to use Define Paired
        Pads feature.




        Here is a typical situation. We have R6 and R10 pads that belong to the positive net and
        R11, R7 pads of the negative net of the differential pair. It is possible that the software in
        such case can terminate the second trace on the R7 pad (not on the R11), or either drop
        the warning message.
214     DipTrace Tutorial




      To fix this issue, you need to group the pads. Go to "High Speed / Define Paired Pads"
      from the main menu. In the pop-up dialog box use the Differential Pair drop-down list to
      select the pair. You can press Update button to let the program find pads automatically,
      or check Manually checkbox and define the pair of pads using the lists right below.
      We have one pair of pads on the side of the J1 connector (J1:2 and J1:3). Select R10:1
      from the Positive Net list and R11:1 from the Negative Net list, because we want the
      differential pair to terminate on these pads. Then press the left arrow button to add
      selected pads to the Paired Pads list, and press OK to apply changes.




      Now route the differential pair. Everything works fine because the software clearly knows,


                                                                             © 2024 Novarm Software
                                                               Other features and tools    215



      where you want to connect the differential pair nets. Finally, draw two traces from the R6
      and R7 pads to their respective nets.




5.7   Renew layout by schematic
      Sometimes electronic designer needs to make important changes to the circuit board, for
      example, to add a new net or a component. We always recommend to start implementing
      those changes in the Schematic, but they do not automatically appear in the PCB Layout,
      you need to launch Renew Design from Schematic to automatically update existing
      circuit board according to the schematic.
      If you made changes in the Schematic and want to bring them to PCB Layout, select
      "File / Renew Design from Schematic" from the main menu in DipTrace PCB Layout,
      then select one of available renewing modes:
      1) By components means using the hidden IDs to determine component-to-pattern links
      – this mode works only if the circuit was created in DipTrace Schematic. Renewing by
      components doesn't depend on Reference Designators, therefore, they can differ in the
      schematic and on the PCB.
      2) By RefDes means that component-to-pattern links are determined only by Reference
      Designators. Components must have the same reference designators on the circuit
      board and in the schematic.
      3) Related Schematic means renewing by components from a related schematic file (go
      to "File / Layout Information" from the main menu if you don't remember the source-
      schematic file).
      Now select the schematic file, and press Open. DipTrace will keep component
      placement and current routing on the circuit board. New components appear near the
      board outline ready for placement.
  216     DipTrace Tutorial



5.8     Back annotate
        Back Annotation allows the user to update schematic according to the PCB file. This
        feature is useful when you've made changes directly on the circuit board and want to keep
        the layout and schematic synchronized. Use it with caution, because the Back Annotation,
        unlike the Renewing from Schematic 215 , has certain limitations.
        Launch DipTrace PCB Layout module, then open "PCB_2.dip" file from the "Examples"
        folder. Use Design Manager to find C8 and C10 capacitors. Right-click on the
        components in the list, and select the first item from the submenu to change the
        reference designators of C8 and C10 capacitors to C28 and C30. Select "File / Save As"
        and save this PCB as another file, for example, "PCB_2_ver1".




        Close the PCB Layout and open Schematic Capture again (notice that you can open it
        directly from the PCB Layout by selecting "Tools / Schematic" from the main menu.
        Open "Schematic_2.dch" file and find C8 and C10 components. You can use the Design
        Manager or press Ctrl+F, then type in "C8", and press Enter to find the component. C8
        capacitor appears highlighted in the center of the screen.




                                                                              © 2024 Novarm Software
                                                         Other features and tools      217




Notice that you can minimize the Find Object dialog box by clicking the arrow in its
upper-left corner and use this dialog while editing the circuit.
Zoom on the design area to see C8 and C10 components better. PCB_2 is the circuit
board related to Schematic_2, but as you remember we have renamed C8 and C10
capacitors directly on the board. Of course, we can rename that components manually in
the schematic or use the Back Annotate feature.
Go to "File / Back Annotate" from the main menu, and select the PCB file where we saved
modified copy of the PCB_2 board ("PCB_2_ver1" in our case), then press Open. Now
you can see that all designators in the Schematic (in our case C28 and C30) are changed
according to the PCB.
Notice that net names and net classes are also back annotated from the PCB, but this
feature has limitation and is not capable of adding new nets or components.
  218      DipTrace Tutorial




5.9     Hierarchical schematic
        We will design a very simple two-level hierarchical schematic just to show you how this
        feature works in Schematic and PCB Layout modules of the DipTrace.
                                            Hierarchy blocks
        Launch DipTrace Schematic. Hierarchy blocks are associated with sheets, so, first of all,
        we have to add two sheets to the blank schematic, select "Edit / Add Sheet" from the
        main menu twice. Then specify that additional sheets are hierarchical blocks, not just
        regular schematic sheets, select the second sheet in the bottom-left corner of the design
        area, and go to "Edit / Sheet Type / Hierarchy Block" from the main menu. Do the same
        for the third sheet.
        Select main (the first) sheet, and place several components there (for example, three
        MAX6050AEUR-T components from the IC PMIC Voltage References library). This will be
        the main circuit. It doesn't have any hierarchy blocks yet.
        Select the second sheet, then go to "Object / Hierarchy / Place Connector" from the main

        menu or press       button on the Objects toolbar, and place several hierarchy
        connectors to the second sheet (notice that you can not place hierarchy connectors to
        non-hierarchical sheets).
        These connectors are the inputs and outputs of the hierarchy block, position and rotation
        of the connectors is the location of the hierarchy block pins on the main sheet.
        Place eight connectors, four on the left side and four on the right. Add two diodes from
        the Diodes RF library, connect them to the connectors, leave some free space for the
        upcoming hierarchy block of the second level. Use R hotkey to rotate hierarchy
        connectors.


                                                                                © 2024 Novarm Software
                                                       Other features and tools    219




Select Sheet 3, and create the second hierarchy block here. Place several hierarchy
connectors (two on the sides and two at the bottom), add couple components (for
example, two AD1856RZ components from IC Data Acq DAC library), and connect
them.
Notice that you can rename hierarchy connectors in the right-click submenu (select the
first item from the drop-down menu). Connector name will be the name of the block's pin
on the main circuit.
220      DipTrace Tutorial




      DipTrace supports multi-level hierarchy, i.e. hierarchy blocks can be inserted into the
      main circuit and into each other as many times as needed.

      Select Sheet 2, then go to "Objects / Hierarchy / Place Block" or press          button on the
      Objects toolbar. In the pop-up dialog box containing the list of available hierarchy blocks,
      select Sheet 3, and place two blocks (Sheet 3) into the second sheet (Sheet 2). Use R to
      rotate blocks.
      Notice that you can place Sheet 2 inside itself or make a closed loop of hierarchy blocks,
      but it is an error. To avoid this situation, use "Verification / Check Hierarchy" from the main
      menu. DipTrace PCB Layout also checks hierarchy for closed loops and displays the
      warning message when you open schematic with hierarchical errors.
      We are not making any closed loops right now, just place two Sheet 3 blocks into the
      Sheet 2, and connect them to connectors like in the picture below.




                                                                                © 2024 Novarm Software
                                                               Other features and tools   221




You can rename hierarchy blocks just like regular sheets, right-click on the corresponding
sheet tab in the bottom-left of the design area, and select Rename from the submenu.
Select the main sheet, and place hierarchy blocks to the main circuit (for example, add
two Sheet 2 blocks and one Sheet 3, like in the picture below). Connect hierarchy blocks
with other components of a schematic.
Notice that hierarchy blocks are similar to regular components, they have pins and you
can rotate or move them around the design area.
This circuit is not a real-life project, it's just a demo example for this tutorial.
222      DipTrace Tutorial




                                             Global nets
      As you already know 168 , pins on different levels of hierarchy can not be connected with a
      single net, unless it is a special-type net called "global". Global nets exist on different
      levels of hierarchy and do not depend on the hierarchical structure of the schematic.
      Return to Sheet 3, and place a ground (GND) net port from the Net Ports library, then
      connect it to DGND pins of U4 and U5 components. Notice that the net has automatically
      become global.




                                                                              © 2024 Novarm Software
                                                         Other features and tools    223




Select Sheet 1 (the main circuit), and place GND net port there, then connect it (create a
wire from the net port to some free GND pin). You'll notice that this net now becomes Net
30 (Global). We have a single global net on two hierarchical levels. We can continue this
net into Sheet 1 etc. Rename net to "GND".
Notice that the same net ports anywhere on the circuit are automatically connected to a
single net (Global – if in the hierarchy).
You already know how to connect nets by name 168 , creating global nets does not differ
much. Right-click on a random net, and select Properties from the submenu. In the pop-
up dialog box check Global Net for Hierarchy, and Connect Nets by Name
checkboxes. Type in the name of the global net that already exists, and press OK.
                             Hierarchy in the PCB Layout
Convert this hierarchical schematic to PCB. Press Ctrl+B, and select Use Schematic
Rules. In the PCB Layout module components that were in the hierarchy blocks are

superimposing each other, arrange 179 them with        button on the Placement toolbar).
Notice that all components have the same reference designators as in the Schematic +
the hierarchical block index.
Go to "View / Component Markings and mark RefDes in the Show column to display the
reference designators if they are hidden.
224     DipTrace Tutorial




      Right-click on one of the components that belongs to a hierarchy block, and select
      Properties from the submenu. Notice that component involved in the hierarchy has an
      additional field with each hierarchy block RefDes and component RefDes (path). This
      additional field is used while updating the PCB by RefDes ("File / Renew Design from
      Schematic" from the main menu).




      DipTrace works with hierarchy circuits in the PCB Layout module. You can automatically
      arrange components by hierarchy blocks and apply routing and component
      placement from one block to another similar block. On the printed circuit board all
      components, regardless of their hierarchy level, are on the same layer.
      Select "Route / Hierarchy" from the main menu. There are two hierarchical sheets
      available (the same as in the Schematic). Select Sheet 2, and you will see two actual
      hierarchy blocks (because Sheet 2 was inserted two times into the main circuit in the


                                                                            © 2024 Novarm Software
                                                           Other features and tools     225



Schematic). Select Sheet 3 and you will see five blocks inside it (because Sheet 3 was
inserted two times into each Sheet 2 hierarchy block, and inserted once directly into the
main circuit in the Schematic). Notice that the name of the block of higher hierarchical
level is listed in the brackets. When you select a hierarchical block from the list, you can
see components and nets that belong to this block on the right in the Block Content
field.




None of the blocks is routed so far.
First of all, we need to arrange components by blocks on the circuit board, select
hierarchy block in the list and DipTrace highlights its components on the design area.
226      DipTrace Tutorial




      Press Select Block button to arrange components by selected hierarchy blocks.
      We will arrange components of the two hierarchy blocks on the board, select Block3 and
      Block4 from the Sheet 2 (use Ctrl to select two blocks at a time), press Select Blocks
      button, and then press OK to close the dialog box and apply arrangement. Now the two
      blocks of components are clearly visible on the design area. We will work with Block 3,
      which is right below the Block 4.
      Change the layout of components in the Block 3 and route traces automatically, do not
      route global nets. Since GND is a global net, we need to exclude the GND net from the
      autorouting. Right-click on GND net in the list on the Design Manager panel, select Net
      Properties from the submenu, and in the pop-up dialog box specify Auto-route Mode:
      Don't Route. Press OK to apply.
      Notice that global nets should be routed only after finishing routing and arranging
      components in the hierarchy blocks.
      Now let's route the traces, right-click on component pad, and select Route Net from the
      submenu or right-click on the component, and select Route Traces to route all nets of
      this component. The autorouter automatically creates a rectangular board outline. Edit
      traces manually, if you need.
      Notice that we didn't autoroute the entire board: only the traces inside the Block 3, some
      connections to Block 4, traces to components from the main schematic sheet.




                                                                               © 2024 Novarm Software
                                                         Other features and tools    227




              Copy placement and routing between hierarchical blocks
Go to "Route / Hierarchy" from the main menu, select Sheet 2 again. This time, Block 3 is
routed. Select Block 3 from the Routed list, and Block 4 from the Non Routed list, then
press Copy Placement and Routing button to apply Block 3 placement and routing to
the Block 4.
If you have routed many traces from Block 3 to Block 4, the Block 4 can appear in the
Routed list in the hierarchy dialog box. Just select it, and press Unroute, then apply
routing and placement.
Let's also apply placement and routing to Block 5 without closing the Hierarchy dialog
box. Select Block 5 on the Sheet 3, and then select one of the routed blocks, then press
Copy Placement and Routing button again. Now press OK to apply routing.
Routed blocks are next to the board outline, use box selection to move them on the design
area.
Notice that DipTrace did not copy traces heading outside selected hierarchical block.
  228      DipTrace Tutorial




5.10    NGSPICE simulation
        DipTrace features a built-in NGSPICE simulator and allows the user to define SPICE
        settings for the components in the Schematic Capture and Component Editor modules.
        We are going to run a simulation of the Astable Flip Flop circuit, but before that we have to
        make sure that SPICE models have been defined for all the components of the
        schematic.
                                                 SPICE Model
        Launch DipTrace Schematic, and open "C:\
        Users\<UserName>\Documents\DipTrace\Examples\Spice\Astable_Flip_Flop_Spice.
        dch" file. We have already defined all the SPICE settings for this circuit. However, let's
        review a couple of the components just to learn how to set up SPICE models. Right-click
        on the C2 capacitor, and select SPICE Model from the submenu. Spice settings for
        capacitors are pretty simple: select Model Type: Capacitor, enter values into the
        parameters table (in our case "22µF "), and specify positive and negative pins (enter
        values into the pin-to-signal table in the central part of the dialog box, the list of available
        signals is right below). Notice that you can enter parameters directly into the table cells.
        The Template field shows how this component is represented in the SPICE netlist. You
        can scroll that field to the right if it is long. Make sure that settings are like in the picture
        below.




                                                                                      © 2024 Novarm Software
                                                          Other features and tools     229




Select another model type, for example, a Current Source. The user can specify a
function for this model type. Use the Function drop-down list and select PWL(). In the
pop-up dialog box enter the number of points for PWL function, and click OK. Now you
can enter the values for each point in the Parameters table. Different functions require
different parameters (amplitude, phase, etc.). See detailed description in the SPICE
language documentation.
Now return to the Capacitor model type, and discard any changes.
                                Setting up SPICE Model
Capacitors do not require additional model description, but transistors do. Select Q1
transistor from the list of All Schematic Parts, now you can see that for transistor there is
also a Model tab near the Parameters tab, select it. Now you can enter the model text or
load the SPICE model from an external file (Load and Save buttons). Some component
manufacturers publish SPICE models for their components on the web.
230      DipTrace Tutorial




      Notice that you can get all SPICE settings from another DipTrace library (use Get Spice
      Model from Library button) or apply the current settings to All Similar Parts of the
      Component or Schematic (Apply to Other Parts button).
      There is no valid SPICE model for the power source (battery) in the
      Astable_Flip_Flop_Spice.dch file, we should define it. Click on the B1 component in the
      list of All Schematic Parts. You can see that the component has the Voltage Source
      model type, but no valid function. Set Function: PULSE(), then specify the following
      parameters in the table below: Pulse V2=5, Pulse PW=20s, Pulse PER=30s. Keep other
      parameters, and press OK. Now we have the voltage source that produces 5V during the
      first 20 seconds, then there is a 10-second interval. Now everything is ready for
      simulation.
                                           SPICE Simulation
      Once SPICE models of the components are defined, we can run a simulation. Go to
      "Tools/ SPICE Simulator". In the left part of the pop-up window you can see several tabs
      for simulations of different types. The last one is Digital. Select it Transient tab and set
      Start Time: 5, Step: 0.1 s, Stop Time: 20 s. GND Net is selected correctly. Now press
      Run Simulation Button, after that select a couple of signals (I (LED 1) and I (LED 2), for
      example) in All Signals list, use    button to add a selected signal to the simulation graph
      and     to remove it.




                                                                                © 2024 Novarm Software
                                                                 Other features and tools        231




The tracks show that LEDs flash on and off alternately, which means that the circuit
works fine.
For more details about SPICE simulation please see Schematic Help.
                                     Digital Spice Simulation

To run a SPICE simulation for a digital circuit in DipTrace, the process is straightforward and similar
to simulating analog circuits.

For this tutorial, we'll use a pre-made schematic from the DipTrace examples. Start by opening the "
Synchronous SR Latch" project, which can be found by default at C:
\User\Documents\DipTrace\Examples\Spice\Synchronous SR Latch.dch.
232      DipTrace Tutorial


      Before diving into the simulation, make sure SPICE models are configured for all components in your
      circuit. Right-click on U1:1 and select SPICE model from the submenu. In the pop-up window make
      sure that Digital:Nand model is selected. Note that in addition to basic models, DipTrace also
      supports more advanced behavioral models, including analog, hybrid, and digital types.




      Once all models are correctly defined, you can move forward with the digital SPICE simulation.
      Navigate to the Tools menu and select SPICE Simulator.




                                                                                     © 2024 Novarm Software
                                                                  Other features and tools        233


In the SPICE Simulator window, you'll notice several tabs in the upper left corner, each
corresponding to different types of simulations. For our purposes, select the Digital tab. Next,
configure the simulation parameters: set the Start Time to 0, the Step to 10ms, and the Stop Time
to 3s. Make sure that the GND Net is selected correctly.

Now, you're ready to run the simulation. Click the Run Simulation button to initiate the process.
After the simulation runs, you'll want to visualize the results. In the All Signals list, select the
signals you wish to display. Use the      button to add the selected signals to the simulation graph. If
you need to remove any signals from the graph, simply use the         button.

Unlike the analog simulator, where signals are drawn one on top of the other in an appropriate scale,
digital signals are displayed in multiple rows. This allows you to track the changes of several signals
simultaneously. In more complex circuits with buses (e.g., D0..D7), you can display a hex value
instead of drawing each bit separately (using the Group Buses option).

This process allows you to analyze the behavior of your digital circuit in a detailed and interactive
way, providing valuable insights for refining your design.



                                       Export SPICE netlist
 In DipTrace you can also export a SPICE Netlist to run a simulation using, for instance,
LT Spice, which is free simulation software of a good quality.
                              Select "File / Export / Spice Netlist" from the main menu. In the
                              small pop-up dialog box select GND from the GND Net drop-
                              down list. Specify Commands: .TRAN 0s 30s 0.1s to simulate
                              the circuit from 0s to 30s with 0.1s step. Notice that you can
                              define/change commands directly in the simulation software.
                              Click OK and save the *.cir netlist file. Launch the SPICE
                              simulator that you have. We will use LT Spice as an example
                              (download it at Linear Technologies website).

Select "File / Open" and open the *.cir netlist that you just saved (notice that you should
select correct Files of Type). Now you can see the netlist in the text format. Select
"Simulate / Run" from the LT Spice main menu, and close the error-log dialog. Select
"Plot Settings / Visible Traces", and choose I(D_led1) to see electrical current on LED1.
This component works during the first 20 seconds, then has 10 sec interval. Select other
signals to see how they work.
  234     DipTrace Tutorial




5.11    Saving/loading design rules
        In the Converting to PCB 26 topic of this tutorial, we mentioned that you could use
        Schematic rules or load rules from any PCB layout project while converting schematic to
        the PCB. No need to specify all layers, net classes, via styles, and design constraints
        again. Let's see how it works.
        Create a new layout, select "File / New" from the main menu or press Ctrl+N hotkeys. In
        the pop-up dialog box, you can choose to create an empty layout or use settings from the
        previous project.




                                                                              © 2024 Novarm Software
                                                                   Other features and tools     235




       Check Use Rules and Settings from Previous Layout, press Browse, and select the
       *.dip file of the circuit board that contributes its settings for a new layout. Press OK. In our
       case, we have selected the *.dip file of the project that we have created in the first part of
       this tutorial. Layer colors and some DRC settings have changed.
       In the DipTrace PCB Layout, you can save settings in the special file, separately from the
       layout itself. Just go to "Route /Save Rules" from the main menu, enter the file name, and
       press Save. Now you can use rules and settings from this file while creating new
       projects. Go to "Route / Load Rules" and choose the *.dip or *.rul file.
       Please add some via styles, a new net class with random parameters, GND and PWR
       inner layers and save this as a *.rul file. We will use it later in the Fanout 239 topic.

5.12   Electrical Rule Check
       Electrical Rule Check (ERC) feature is one of the main verification features in DipTrace.
       ERC checks the circuit for pin type conflicts, unconnected and superimposing pins as
       well as one-pin nets and short circuits.
       Launch DipTrace Schematic and open Schematic_2.dch from the "Documents/DipTrace/
       Examples" folder. Define electrical rules, select "Verification / Electrical Rule Setup" from
       the main menu. In the pop-up dialog box specify incompatible pin-to-pin connections and
       the program's reaction to them (error, no error or warning, depending on the color) by
       clicking in the grid cells with green, yellow and red squares.
       Pin Type checkbox in the Rules to Check section means checking pin-to-pin
       connections defined in the grid;
       Not Connected Pins – the program searches for unconnected pins;
236      DipTrace Tutorial



      Pin Superimposing – the program searches for pins overlaying each other;
      Only One Pin in Net – the program reports nets with only one pin, i.e. net that makes no
      sense. It can be a potential error in the net structure;
      Nets With Single Pin – the software searches for nets that include only one pin.
      Short Circuit – the program reports any connections between Power and GND nets. Let
      the software know which net is POWER and which one is GROUND in the Power Pins
      for SC section below.




      Press OK to close the dialog box.
      Now select "Verification / Electrical Rule Check (ERC)" from the main menu. If you verify
      "Schematic_2.dch" file, according to the rules from the picture above, you should get
      many error reports in the list: one warning for Bidirectional to Output connection and a lot
      of Not Connected pin errors. To localize error on the schematic design area, double-click
      it in the list (or press Localize). You can fix errors without closing the ERC report dialog
      box. Press Run ERC button to start verification again.




                                                                               © 2024 Novarm Software
                                                                Other features and tools     237




       ERC does not report errors for pins, which are intentionally unconnected. Right-click on
       one of these pins, and select Not Connected from the submenu. Alternatively, you can
       uncheck the corresponding item in the ERC settings dialog box, but then the possibility of
       an error increases, because all unconnected pins are now OK, even if it is not supposed
       to be that way.

5.13   Checking net connectivity
       This type of verification allows the user to check if all nets on the circuit board are
       connected. Net connectivity check reports broken connections and isolated copper areas
       (not depending on the connection type: traces, thermals, shapes, or copper pours).
       Launch the PCB Layout module, and open "PCB_2.dip" file from the "C:\
       Users\<UserName>\Documents\DipTrace\Examples" folder. Go to "Verification / Check
       Net Connectivity" from the main menu. In the pop-up dialog box you define the objects that
       will be considered as connectors by the verification algorithm, typically we recommend to
       keep all checkboxes checked. Press OK to launch verification.
       The circuit board does not have any unconnected nets. Therefore, we will make two
       errors intentionally.

       Close the error-log dialog box, press         button on the Route toolbar, then move the
       mouse to the trace that connects C16:2 to the via and GND copper pour in the Bottom
       layer, right-click on this small trace segment, and select Unroute Trace from the
       submenu. This is going to be our first error.
238      DipTrace Tutorial




      Isolated copper pour area is the second error that we are about to commit. Double click
      on the Bottom layer, then pan to the bottom-right corner of the circuit board, and draw a
      couple of shapes (arcs or lines) to isolate one of the vias, and don't forget to update the
      copper pour (right-click on the copper pour's outline, and select Update from the
      submenu).




                                                                               © 2024 Novarm Software
                                                                   Other features and tools     239



       The picture shows a simple situation when it's very easy to find the mistake, but most
       errors of this type (isolated copper pour areas and non-connected pins) usually go
       unnoticed on complex circuit boards.
       Go to "Verification / Check Net Connectivity" from the main menu, and click OK in the
       pop-up dialog box. The verification reports a broken-net error. Click on the error in the list,
       and check error Details. We have Net 7 broken to 4 unconnected areas, scroll down the
       Details section of the Connectivity Check Results dialog box to see all unconnected
       areas of the net and component pads sorted by areas. Area 1 is the biggest, it is the main
       part of the copper pour, the second area is that C16 capacitor's pad which trace we
       unrouted at the beginning of this topic, the Area 3 and Area 4 appeared as the result of
       isolating the part of the copper pour at the bottom-right of the circuit board.




       You don't have to close the Connectivity Check Results dialog box to fix errors, just
       move it a bit.
       Sometimes it's hard to understand how to find and fix errors on the design area. We
       recommend using the Design Manager for easy navigation. Just scroll down the list of
       components and double click on the component in the list to highlight it on the design
       area.
       You can also save the net connectivity error report into the text file.

5.14   Fanout
       Fanout allows the user to automatically connect pads of the selected components (BGA,
       SOIC, QUAD) or SMD pads of the selected net to inner plane layers with vias of a certain
       style.
       Open the PCB Layout module or if it is already open, select "File/ New" from the main
240      DipTrace Tutorial



      menu. Load rules from the *.rul file that we created at the end of Saving/Loading Design
      Rules 234 topic of this tutorial. It should have the default, through-hole, and blind/buried via
      styles, custom net class, and two inner plane layers.
                                          Fanout a component
      Now select Patterns library group, it contains all patterns available in standard DipTrace
      libraries. Notice that these are just the patterns without schematic symbols. Place one
      PLCC20P127_990X990X457L203X43N from the PLCC Pitch 1.27mm Square library and
      two BGA100CP50_10X10_600X600X100B30N from the BGA Pitch 0.50 mm library. We
      will use these patterns for demonstration, but you can select another patterns/
      components for practicing with fanout.
      Right-click on the PLCC pattern, and select Fanout from the submenu. In the pop-up
      dialog box specify: Pattern Type: SOIC/QUAD, Placement: Outside, Pads: Left (this
      means that only the left row of the pads will have fanout vias), and make sure that Use
      Connected Pads Only checkbox is unchecked (because we want to have fanout vias for
      all pads of the component, regardless of whether they are connected or not).
      Select different Via Styles for the pads on the top and bottom side of the board (inactive if
      there are no pads on that side). Preview parameters of the existing via styles by pressing
      the Via Styles... button. In our case we have three via styles: one with through-holeU vias,
      another with blind/buried vias and the Default via style with relatively big vias. Select the
      one which fits the size of the current component (Default via style in our case).




                                                                                  © 2024 Novarm Software
                                                       Other features and tools    241



                                  Press OK, and vias will appear outside the left pad
                                  line of the PLCC pattern. Right-click on the same
                                  pattern, and select Fanout again. Now we will place
                                  zigzag vias for the top pads. Set: Placement: Zig-zag
                                  and Pads: Top, keep other settings, and click OK.
                                  Now we will make through-hole vias for one of the
                                  BGA patterns and blind/buried vias for another. Make
                                  sure that you have the corresponding via styles first.
                                  BGAs will need smaller vias (we used 0.3 mm vias
                                  with 0.15 mm holes for this example).



Right-click on the first BGA pattern, and select Fanout from the submenu, specify
Pattern Type: BGA – All pads and select custom via style with through-hole vias. Press
OK.
Now select the second BGA package. Right-click it, and choose Fanout from the
submenu. Set Pattern Type: BGA - By rows. This allows the user to apply different via
styles to different pad rows of the same pattern or even exclude some rows from the
fanout. Left-click on the row number, and select Via Style from the drop-down list.
242      DipTrace Tutorial



                                                                       We will not create vias for
                                                                       rows #1 and #2; you can
                                                                       use different via styles for
                                                                       different rows. Press OK.
                                                                       We can see, that for the
                                                                       first BGA pattern all pads
                                                                       are connected to vias, for
                                                                       the second pattern first
                                                                       two rows are without vias,

      because these are usually connected on the top layer of the board.
                                              Fanout net
      We will connect several SMD pads to the GND plane layer using the Fanout feature.
      Place several SMD and a couple of through-hole patterns on the design area. Create a net
      that connects some pins of these components (we suppose this is our GND net that we
      should connect to the GND plane layer). Select "Objects / Place Ratline" from the main

      menu or press        button on the Objects toolbar to create ratlines (connections).
      Rename net to "GND" if you want. Check the Ratlines item on the Design Manager's
      Objects tab if you don't see the ratlines on the design area.
      Make sure that there is a via style with blind/buried vias from Top to GND layer, then right-
      click on one of the connected pads (not on the pattern), and select Fanout from the
      submenu. In the pop-up dialog box select appropriate via style, and click OK. Now all SMD
      pads of selected net have vias connecting them to the GND inner plane layer, where we
      have placed a copper pour 66 connected to GND net.




                                                                               © 2024 Novarm Software
                                                                        Other features and tools         243



5.15   Via Shielding
       Via Shielding is a technique used in PCB design to improve signal integrity and isolate sections of
       the board operating at different frequencies. This is achieved by placing rows of vias along a trace,
       which helps protect sensitive signals from interference and crosstalk.

       Please note that the Via Shielding tool functions only when there is a copper pour on both the layer
       where the trace is selected and on at least one other layer. Additionally, both the copper pours and
       the shielding vias must be connected to the same net for the tool to work properly.

       To get started, let's open the "Differential_Pairs" example project in DipTrace. Once the project is
       loaded, select Net 14, which can be done either by clicking directly on the board or by finding it in
       the list of Nets on the Design Manager panel. After selecting Net 14, simply right-click and choose
       Via Shielding from the menu. If you prefer using the main menu, you can also find this option
       under Objects > Via Tools > Net Via Shielding.




                                     We are going to shield only the selected segment of the trace, so in
                                     the pop-up dialog choose Add Vias to: Selected Segments. For the
                                     via style, we have a few options. We can select any style available in
                                     the project from the Via Style drop-down menu, but for this tutorial,
                                     we'll stick with the Default style. If you want to review, modify, or even
                                     create a new via style, you can do so by pressing the Via Styles
                                     button.

                                     Next, let’s ensure that the vias are properly connected by setting the
                                     Via Net to GND. This will connect the shield vias to the ground net,
                                     providing the necessary isolation.




       Moving on to the Via Placement parameters, we’ll set the Trace to Via Gap and Via Spacing to
  244      DipTrace Tutorial


        0.5 mm. This ensures that the vias are closely spaced for effective shielding. To add an extra layer of
        protection, we’ll mark the Add Second Row option, placing a second row of vias parallel to the first.
        We’ll set the spacing between these rows to 0.5 mm as well and enable the Stagger Alternate Row
        option to arrange the vias in a staggered pattern, which enhances the shielding effect.

        Finally, to keep everything organized, we’ll mark the Group Vias by Trace Segments option. This
        ensures that the vias are grouped according to the trace segments they are shielding, making the
        design both effective and easy to manage.

        Once all the settings are configured, click OK, and DipTrace will shield the selected net with vias,
        respecting the parameters you've set and adhering to the PCB design rules.




        Note that the via shielding algorithm is designed to prevent DRC errors, which may result in some
        vias being omitted from the via shielding array.

        Undo the changes to restore the project and prepare it to practice the use of Via Stitching feature.


5.16    Via Stitching
        Via stitching is a technique used to improve the electrical performance and structural integrity of a
        PCB by connecting copper pours on different layers through a grid of vias. This helps with grounding,
        thermal management, and signal integrity by reducing impedance and minimizing interference.

        DipTrace provides two options for via stitching: stitching the entire board or a specific area only. Let’s
        begin with stitching the whole board.

        In the "Differential_Pairs" example project, navigate to Objects > Via Tools > Board Via Stitching.
        In the pop-up dialog, you can choose one of the existing via styles or press the Via Styles button to
        review, modify, or create a new via style. For this example, we'll use the Default style. Ensure that
        the Via Net corresponds to the copper pours' net, which is GND in this case.




                                                                                           © 2024 Novarm Software
                                                                Other features and tools        245




Next, we are going to configure the Via Placement parameters. Set ViaGrid to 2 mm, and mark
Stagger Alternate Row to arrange vias in a staggered pattern. Since copper pours cover the entire
board in this project, we don't need to mark the "Stitch overlapping copper areas only" option, though
it’s useful when dealing with separate copper areas on different layers.

The "Exclude copper pours with higher priority" option prevents stitching copper pours of
different priorities, which can be beneficial in more complex designs, but since all our copper pours
have the same priority, we can leave it unchecked.

Finally, check Group Vias to keep the stitching vias organized. Click OK, and DipTrace will
automatically check the design rules and stitch the entire copper pour area with vias.
246      DipTrace Tutorial




      Now let's undo those changes and explore how Area Via Stitching works.

      Navigate to Objects > Via Tools > Area Via Stitching. To define the area for stitching, left-click on
      the copper pour to place anchor points and outline the shape. Once you’ve outlined the desired area,
      right-click on the final point and select Enter.




      The Via Stitching dialog will appear. We can keep all the previous settings unchanged and simply
      click OK. DipTrace will then stitch the defined area of the copper pour with vias according to the



                                                                                     © 2024 Novarm Software
                                                               Other features and tools    247


       parameters we've set.




5.17   Bill of Materials (BOM)
       In DipTrace a bill of materials can be generated in the Schematic and PCB Layout
       modules.This tool is similar in both modules, but has more advanced options in PCB, so
       let’s see it in more detail.
       Open Banana_Pi.dip project from DipTrace examples (C:
       \Users\Documents\DipTrace\Examples). To create a bill of materials for a printed circuit
       board, select "File/ Export/ Bill of Materials" from the main menu.
248     DipTrace Tutorial




      The Bill of Materials dialog allows the user to customize columns and rows, add
      interactive autoapdating tables to the existing project, save BOM in HTML, Excel CSV or
      text format with the required table configuration.
      To begin with, let’s see how to create and configure several Assembly Variants for the
      same board. Press        button, in the pop-up window press Add and enter the name of
      the assembly variant. Select any cell in the Variant column and remove blue checkmarks
      for the parts you don’t want to appear in the BOM of a certain prototype. You can use
      quick-selection buttons at the bottom of the window: All - to select all components, SMD -
      to select surface mount components only, Through-Hole - to select all through-hole
      components.




                                                                             © 2024 Novarm Software
                                                        Other features and tools   249




Several variants can be configured at once. When done, click OK to save them. Once
created, the Assembly Variants will appear in the drop-down list. Default variant
represents the original layout and is not editable.
Next, let’s configure, how the information will be organized by Rows and Columns in the
BOM table.
In the Group Rows by drop-down select Components. Use the checkboxes below to add
a header, row number, and total quantity of the components.
In the Columns section on the right add columns to the BOM file with the settings like in
the picture below. Select the corresponding item (Name, RefDes, Value, Quantity, etc.)
from the Show: drop-down list, and press Add button. You can change the order of the
items using arrow buttons, add or delete columns from the table. Besides, you can select
how the data will be aligned and also specify the width of the columns.
250      DipTrace Tutorial




      If you are going to place a BOM table directly in the project, use Table section of the dialog
      to set font parameters and row height. Press Set Font button to customize the font
      settings. Use only TrueType fonts for Unicode characters.
      When you are done with configuring the BOM table you have four different options to
      create it.
      1. Place a Table on the design area. To do that, press Place Table button, and left-click on
      the design area, where you want the top left corner of the table to be located. An
      interactive table with all the components will be placed in the Top Assembly Layer.The
      components selected in the table are highlighted on the board. The table is updated
      automatically, so can keep editing your layout after placing the table - all subsequent
      changes will be included into the report.
      2. Interactive BOM within PCB Layout - a pop-up table corresponding to the column and
      row settings will appear. The components selected in the table are highlighted on the
      board. Press Localize for DipTrace to center the component from the selected row on the
      design area.
      3. Export to File. The BOM files are available in 2 formats: Excel CSV and files with *.bom
      extension. When exporting to file, DipTrace will ask you to set a Column Divider and
      decide whether to use Quotation Marks for values or not. Please notice that you can add
      custom rows and columns to the BOM file in any spreadsheet editor.
      4. Export HTML - this option provides for easy BOM sharing and revision outside DipTrace
      environment. Save HTML file and then open it in your browser.




                                                                                © 2024 Novarm Software
                                                                Other features and tools    251




       Use buttons in the top-right corner to configure BOM generation parameters, table and
       layout display mode.

       U (Ungroup) - show each component of the circuit board in the BOM separately.
       NL (Netlist) - generate a list of all the nets of the circuit.
       N (Component Name) - group components in the BOM table by component name.
       NV (Component Name and Value) - group components in the BOM table by component
       name and value.
       NP (Component Name and Pattern) - group components in the BOM table by component
       name and pattern.
       NVP (Component Name, Value and Pattern) - group components in the BOM table by
       component name, value and pattern.

       BOM - show BOM table only.
       LR - display BOM on the left and layout on the right.
       TB - display BOM in the upper and layout in the lower part of the window.

       T - show BOM and layout of the top side of the board only.
       TB - show BOM and layout of both, top and bottom sides.
       B - show BOM and layout of the bottom side of the board only.




5.18   Importing/exporting netlists
       DipTrace allows the user to import and export netlist files of various formats (Accel,
       Allegro, Mentor, OrCAD, PADS, P-CAD, Protel, Tango). Netlist export can be used to
       review schematic net structure or board design in other software.

                                             Export netlist

       To export netlist from the DipTrace Schematic, select "File / Export / Netlist" from the
       main menu, select the netlist format, specify folder and file name, and press OK to save
252      DipTrace Tutorial



      the netlist file.




                                              Import netlist
      DipTrace PCB Layout allows for importing netlists created in other software. We will
      import Tango netlist as an example. Launch the PCB Layout, create a new project, and
      select "File / Import / Netlist / Tango" from the main menu, then select "tango_1.net" file
      from "C:\Users\<UserName>\Documents\DipTrace\Examples" folder.
      As you already know, all components are represented by patterns on the circuit board.
      The first step while importing the netlist is to make sure that each component has its
      pattern. Check all patterns in the File Components list:
      RefDes column shows component RefDes in the netlist,
      Name column shows component's name,
      Pattern Name column shows pattern's name from the netlist,
      Pattern column shows attached pattern in the DipTrace libraries. If it is blank, the
      component does not have a pattern.
      Press Add button to add new pattern libraries that contain the required patterns. For
      example, add Cap Chip Inch library to find a pattern for C 225 components. Add several
      libraries at a time with "Shift" and "Ctrl" hotkeys. DipTrace standard libraries are in the "C:
      \Program Files\DipTrace\Lib" folder and user libraries – in the "Documents/DipTrace/My
      Libraries" folder by default.
      Select a library, and press Assign all Patterns by Names – the software will find and
      assign patterns with the corresponding names automatically.
      Sometimes DipTrace is not able to find all the patterns, because of partially or completely
      different pattern names in the DipTrace libraries and in the netlist. In this case, the
      designer should find and assign all patterns manually. Select a component in the File



                                                                                 © 2024 Novarm Software
                                                                Other features and tools        253



       Components list, then select a library and a pattern from the respective lists. Now press
       Attach to Component button to attach pattern to the component according to the
       component's RefDes, name, or pattern name. For example, we will attach CAP_2225_N
       pattern to all components with CAP 225 pattern.




       The asterisk symbol (*) after the pattern name in the list means that this pattern was
       connected manually.
       Click Import button when all components have correct patterns.

5.19   3D preview and export
       DipTrace PCB Layout module features built-in real-time 3D visualization with STEP and
       VRML export. This tool allows the user to visually check the circuit board with all
       components installed and export the PCB model to mechanical CAD programs for
       developing the device housing etc.
       Download and install 3D model libraries from the DipTrace website. Components
       without 3D models appear only as footprints on the circuit board in the 3D mode.
       Launch PCB Layout then go to "File / Open" (or press Ctrl+O) and select "C:

       \Users\<UserName>\Documents\DipTrace\Examples\PCB_6.dip", then press
       button on the Standard toolbar. The Attached 3D Models dialog box will pop up.
       DipTrace checks if all components have 3D models and tries to find correct models for
       components without them.
       See 3D preview and export section in the PCB Layout Help ("Help / PCB Layout Help"
       from the main menu) for more details.
254     DipTrace Tutorial




      You can change colors of the background, board, solder mask, copper and silk screen
      display options, just press Redraw to implement the changes.
      Press OK, and you'll see a 3D model of the circuit board. You can rotate the circuit board
      model by three axes, move it with your mouse, zoom in and out with the mouse wheel,
      etc.
      Note that the general settings of the mask are defined in the Gerber export window 92 .




                                              3D export




                                                                             © 2024 Novarm Software
                                                         Other features and tools    255



                                                          DipTrace 3D Preview module
                                                          allows the user to export 3D
                                                          model of the board to STEP (*.
                                                          step) and VRML 2.0 formats (*.
                                                          wrl) supported by most
                                                          mechanical CAD software.
                                                          When in the DipTrace 3D
                                                          preview & export module,
                                                          press Export STEP. In the pop-
                                                          up dialog box, specify which
                                                          objects to include in the
                                                          exported model (Board,
                                                          Package models, Pad holes),
                                                          and whether to export the model
                                                          as a solid body or as parts.

Press OK to specify a filename and folder. We recommend exporting a project as a Solid
body in STEP format.
Notice that exporting holes dramatically slows the process.
To export the board model to VRML format, press Export VRML button, select which
objects to include in the exported model, set the units, press OK, and define the file
location.
                    Previewing and mapping component 3D model

Press         button in the Attached 3D Models dialog box or right-click on any
component on the design area in the PCB Layout, and select 3D Model from the
submenu. In the pop-up dialog box, you can rotate a 3D model by three axes, zoom in and
out, move the model by holding the right mouse button, and change colors of the preview.
If you need to change a 3D model, press All Models>> button, and select a 3D model
from the list of all available models sorted by pattern libraries.

To attach a 3D model from the separate file, press the  button to specify the path to
the file on your computer. DipTrace supports 3DS, VRML, STEP, and IGES files.

If Pattern Generator was used to create the 3D model you can preview it by selecting IPC-
7351 Model Generator option from the drop-down in the upper part of the dialogue.

3D model can also be automatically generated based on the component outline - by
Component Outline option. To use this option, an outline of the footprint has to be placed
in Pattern Editor. After that you only have to specify the model height and DipTrace will
create a 3D shape to mimic a device.
DipTrace automatically places a 3D model to fit the pattern's drawing, but sometimes you
may need to adjust a 3D model location or its scale. Just enter appropriate values into the
corresponding fields (shift, angle, and scale for each axis). Changes apply instantly.
Check out Attaching a 3D model topic of this tutorial and PCB Layout Help for more
details about mapping a 3D model.
256      DipTrace Tutorial




      Press OK to close the 3D Model dialog box.
                                         Search 3D models
      Go to "Tools / 3D Preview / Patterns and Models Search", in the pop-up dialog box you
      can change the search accuracy and active search folders.
      In the Pattern Search section, you can select the level of conformity that will be used by
      DipTrace while searching for the models (more strict requirements mean less possible
      models found). Press Search 3D Models... to check the results.
      If you have 3D models in other folders on your machine, you need to let the software know
      that it should search 3D models in those folders, just add a new folder to the 3D Model
      Folders list. By default, all 3D models are in the "models3d" folder inside the "DipTrace"
      directory.
      Notice that standard 3D libraries are not included in the DipTrace installation package.
      You need to download them from the DipTrace website.
      We recommend attaching 3D Models in the Pattern Editor when making footprints.




                                                                              © 2024 Novarm Software
                                                                 Other features and tools    257




5.20   DipTrace Links
       DipTrace official website.
       FAQ.
       How to install DipTrace.
       DipTrace Support Portal.
       DipTrace Sales.
       Download the latest version (go to "Help / About" if you don't know your current version).
       Order DipTrace.
       Download Libraries.
       DipTrace YouTube Cannel
       DipTrace Forum – suggest new features, discuss DipTrace and share your experience.
       DipTrace PCB Design Service.
258   DipTrace Tutorial




                          © 2021 Novarm Software


